{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/*\n * Copyright (c) 2014-2017 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { AbstractLayout, graphics, HtmlComponent, MenuBarLayout, Planner, scout, scrollbars } from '../index';\nimport $ from 'jquery';\n\nvar PlannerLayout = /*#__PURE__*/function (_AbstractLayout) {\n  _inherits(PlannerLayout, _AbstractLayout);\n\n  var _super = _createSuper(PlannerLayout);\n\n  function PlannerLayout(planner) {\n    var _this;\n\n    _classCallCheck(this, PlannerLayout);\n\n    _this = _super.call(this);\n    _this.planner = planner;\n    return _this;\n  }\n\n  _createClass(PlannerLayout, [{\n    key: \"layout\",\n    value: function layout($container) {\n      var menuBarSize,\n          $header = this.planner._header.$container,\n          $scale = this.planner.$scale,\n          $grid = this.planner.$grid,\n          menuBar = this.planner.menuBar,\n          $yearContainer = this.planner._yearPanel.$container,\n          menuBarHeight = 0,\n          gridHeight = 0,\n          yearContainerHeight = 0,\n          gridTop = 0,\n          scaleTop = 0,\n          htmlMenuBar = HtmlComponent.get(menuBar.$container),\n          htmlContainer = this.planner.htmlComp,\n          containerSize = htmlContainer.availableSize().subtract(htmlContainer.insets());\n\n      if (menuBar.$container.isVisible()) {\n        menuBarSize = MenuBarLayout.size(htmlMenuBar, containerSize);\n        htmlMenuBar.setSize(menuBarSize);\n        menuBarHeight = menuBarSize.height;\n\n        if (menuBar.position === 'top') {\n          scaleTop += menuBarHeight;\n        }\n      }\n\n      if ($header.isVisible()) {\n        scaleTop += graphics.size($header).height;\n      }\n\n      $scale.css('top', scaleTop);\n      gridTop += scaleTop + graphics.size($scale).height;\n      $grid.css('top', gridTop);\n      yearContainerHeight = scaleTop + $yearContainer.cssMarginY();\n      gridHeight = gridTop + $grid.cssMarginY();\n\n      if (menuBar.$container.isVisible() && menuBar.position === 'bottom') {\n        yearContainerHeight += menuBarHeight;\n        gridHeight += menuBarHeight;\n      }\n\n      $yearContainer.css('height', 'calc(100% - ' + yearContainerHeight + 'px)');\n      $grid.css('height', 'calc(100% - ' + gridHeight + 'px)');\n\n      this._updateMinWidth();\n\n      this._layoutScaleLines(); // immediate update to prevent flickering, due to reset in layoutScaleLines\n\n\n      scrollbars.update(this.planner.$grid, true);\n      this.planner.layoutYearPanel();\n    }\n    /**\n     * Min width is necessary for horizontal scrollbar\n     */\n\n  }, {\n    key: \"_updateMinWidth\",\n    value: function _updateMinWidth() {\n      var minWidth = this._minWidth(),\n          $scaleTitle = this.planner.$scaleTitle,\n          $timeline = this.planner.$timeline;\n\n      if (!$timeline) {\n        // May be null if no view range is rendered\n        return;\n      }\n\n      $timeline.css('min-width', minWidth);\n      minWidth += $scaleTitle.outerWidth(true);\n      this.planner.resources.forEach(function (resource) {\n        resource.$resource.css('min-width', minWidth);\n      });\n    }\n    /**\n     * Positions the scale lines and set to correct height\n     */\n\n  }, {\n    key: \"_layoutScaleLines\",\n    value: function _layoutScaleLines() {\n      var height,\n          $smallScaleItems,\n          $largeScaleItems,\n          scrollLeft,\n          $timelineSmall = this.planner.$timelineSmall,\n          $timelineLarge = this.planner.$timelineLarge;\n\n      if (!$timelineSmall) {\n        // May be null if no view range is rendered\n        return;\n      }\n\n      $smallScaleItems = $timelineSmall.children('.scale-item');\n      $largeScaleItems = $timelineLarge.children('.scale-item'); // First loop through every item and set height to 0 in order to get the correct scrollHeight\n\n      $largeScaleItems.each(function () {\n        var $scaleItemLine = $(this).data('scale-item-line');\n        $scaleItemLine.cssHeight(0);\n      });\n      $smallScaleItems.each(function () {\n        var $scaleItemLine = $(this).data('scale-item-line');\n\n        if ($scaleItemLine) {\n          $scaleItemLine.cssHeight(0);\n        }\n      }); // also make sure there is no scrollbar anymore which could influence scrollHeight\n\n      scrollbars.reset(this.planner.$grid); // Loop again and update height and left\n\n      height = this.planner.$grid[0].scrollHeight;\n      scrollLeft = this.planner.$scale[0].scrollLeft;\n      $largeScaleItems.each(function () {\n        var $scaleItem = $(this),\n            $scaleItemLine = $scaleItem.data('scale-item-line');\n        $scaleItemLine.cssLeft(scrollLeft + $scaleItem.position().left).cssHeight(height);\n      });\n      $smallScaleItems.each(function () {\n        var $scaleItem = $(this),\n            $scaleItemLine = $scaleItem.data('scale-item-line');\n\n        if ($scaleItemLine) {\n          $scaleItemLine.cssLeft(scrollLeft + $scaleItem.position().left).cssHeight(height);\n        }\n      });\n    }\n  }, {\n    key: \"_minWidth\",\n    value: function _minWidth() {\n      var $scaleItemsLarge = this.planner.$timelineLarge.children('.scale-item'),\n          $scaleItemsSmall = this.planner.$timelineSmall.children('.scale-item'),\n          numScaleItemsLarge = $scaleItemsLarge.length,\n          numScaleItemsSmall = $scaleItemsSmall.length,\n          displayMode = Planner.DisplayMode,\n          cellInsets = graphics.insets($scaleItemsSmall, {\n        includeBorder: false\n      }),\n          minWidth = numScaleItemsSmall * cellInsets.horizontal(); // no matter what, this width must never be deceeded\n\n      if (this.planner.displayMode === displayMode.DAY) {\n        return Math.max(minWidth, numScaleItemsLarge * 52);\n      }\n\n      if (scout.isOneOf(this.planner.displayMode, displayMode.WORK_WEEK, displayMode.WEEK)) {\n        return Math.max(minWidth, numScaleItemsLarge * 160);\n      }\n\n      if (this.planner.displayMode === displayMode.MONTH) {\n        return Math.max(minWidth, numScaleItemsSmall * 23);\n      }\n\n      if (this.planner.displayMode === displayMode.CALENDAR_WEEK) {\n        return Math.max(minWidth, numScaleItemsSmall * 23);\n      }\n\n      if (this.planner.displayMode === displayMode.YEAR) {\n        return Math.max(minWidth, numScaleItemsSmall * 90);\n      }\n    }\n  }]);\n\n  return PlannerLayout;\n}(AbstractLayout);\n\nexport { PlannerLayout as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/planner/PlannerLayout.js"],"names":["AbstractLayout","graphics","HtmlComponent","MenuBarLayout","Planner","scout","scrollbars","$","PlannerLayout","planner","$container","menuBarSize","$header","_header","$scale","$grid","menuBar","$yearContainer","_yearPanel","menuBarHeight","gridHeight","yearContainerHeight","gridTop","scaleTop","htmlMenuBar","get","htmlContainer","htmlComp","containerSize","availableSize","subtract","insets","isVisible","size","setSize","height","position","css","cssMarginY","_updateMinWidth","_layoutScaleLines","update","layoutYearPanel","minWidth","_minWidth","$scaleTitle","$timeline","outerWidth","resources","forEach","resource","$resource","$smallScaleItems","$largeScaleItems","scrollLeft","$timelineSmall","$timelineLarge","children","each","$scaleItemLine","data","cssHeight","reset","scrollHeight","$scaleItem","cssLeft","left","$scaleItemsLarge","$scaleItemsSmall","numScaleItemsLarge","length","numScaleItemsSmall","displayMode","DisplayMode","cellInsets","includeBorder","horizontal","DAY","Math","max","isOneOf","WORK_WEEK","WEEK","MONTH","CALENDAR_WEEK","YEAR"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2014-2017 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {AbstractLayout, graphics, HtmlComponent, MenuBarLayout, Planner, scout, scrollbars} from '../index';\nimport $ from 'jquery';\n\nexport default class PlannerLayout extends AbstractLayout {\n\n  constructor(planner) {\n    super();\n    this.planner = planner;\n  }\n\n  layout($container) {\n    var menuBarSize,\n      $header = this.planner._header.$container,\n      $scale = this.planner.$scale,\n      $grid = this.planner.$grid,\n      menuBar = this.planner.menuBar,\n      $yearContainer = this.planner._yearPanel.$container,\n      menuBarHeight = 0,\n      gridHeight = 0,\n      yearContainerHeight = 0,\n      gridTop = 0,\n      scaleTop = 0,\n      htmlMenuBar = HtmlComponent.get(menuBar.$container),\n      htmlContainer = this.planner.htmlComp,\n      containerSize = htmlContainer.availableSize()\n        .subtract(htmlContainer.insets());\n\n    if (menuBar.$container.isVisible()) {\n      menuBarSize = MenuBarLayout.size(htmlMenuBar, containerSize);\n      htmlMenuBar.setSize(menuBarSize);\n      menuBarHeight = menuBarSize.height;\n      if (menuBar.position === 'top') {\n        scaleTop += menuBarHeight;\n      }\n    }\n\n    if ($header.isVisible()) {\n      scaleTop += graphics.size($header).height;\n    }\n    $scale.css('top', scaleTop);\n    gridTop += scaleTop + graphics.size($scale).height;\n    $grid.css('top', gridTop);\n\n    yearContainerHeight = scaleTop + $yearContainer.cssMarginY();\n    gridHeight = gridTop + $grid.cssMarginY();\n\n    if (menuBar.$container.isVisible() && menuBar.position === 'bottom') {\n      yearContainerHeight += menuBarHeight;\n      gridHeight += menuBarHeight;\n    }\n\n    $yearContainer.css('height', 'calc(100% - ' + yearContainerHeight + 'px)');\n    $grid.css('height', 'calc(100% - ' + gridHeight + 'px)');\n\n    this._updateMinWidth();\n    this._layoutScaleLines();\n    // immediate update to prevent flickering, due to reset in layoutScaleLines\n    scrollbars.update(this.planner.$grid, true);\n    this.planner.layoutYearPanel();\n  }\n\n  /**\n   * Min width is necessary for horizontal scrollbar\n   */\n  _updateMinWidth() {\n    var minWidth = this._minWidth(),\n      $scaleTitle = this.planner.$scaleTitle,\n      $timeline = this.planner.$timeline;\n\n    if (!$timeline) {\n      // May be null if no view range is rendered\n      return;\n    }\n\n    $timeline.css('min-width', minWidth);\n    minWidth += $scaleTitle.outerWidth(true);\n    this.planner.resources.forEach(function(resource) {\n      resource.$resource.css('min-width', minWidth);\n    });\n  }\n\n  /**\n   * Positions the scale lines and set to correct height\n   */\n  _layoutScaleLines() {\n    var height, $smallScaleItems, $largeScaleItems, scrollLeft,\n      $timelineSmall = this.planner.$timelineSmall,\n      $timelineLarge = this.planner.$timelineLarge;\n\n    if (!$timelineSmall) {\n      // May be null if no view range is rendered\n      return;\n    }\n\n    $smallScaleItems = $timelineSmall.children('.scale-item');\n    $largeScaleItems = $timelineLarge.children('.scale-item');\n\n    // First loop through every item and set height to 0 in order to get the correct scrollHeight\n    $largeScaleItems.each(function() {\n      var $scaleItemLine = $(this).data('scale-item-line');\n      $scaleItemLine.cssHeight(0);\n    });\n    $smallScaleItems.each(function() {\n      var $scaleItemLine = $(this).data('scale-item-line');\n      if ($scaleItemLine) {\n        $scaleItemLine.cssHeight(0);\n      }\n    });\n    // also make sure there is no scrollbar anymore which could influence scrollHeight\n    scrollbars.reset(this.planner.$grid);\n\n    // Loop again and update height and left\n    height = this.planner.$grid[0].scrollHeight;\n    scrollLeft = this.planner.$scale[0].scrollLeft;\n    $largeScaleItems.each(function() {\n      var $scaleItem = $(this),\n        $scaleItemLine = $scaleItem.data('scale-item-line');\n      $scaleItemLine.cssLeft(scrollLeft + $scaleItem.position().left)\n        .cssHeight(height);\n    });\n    $smallScaleItems.each(function() {\n      var $scaleItem = $(this),\n        $scaleItemLine = $scaleItem.data('scale-item-line');\n      if ($scaleItemLine) {\n        $scaleItemLine.cssLeft(scrollLeft + $scaleItem.position().left)\n          .cssHeight(height);\n      }\n    });\n  }\n\n  _minWidth() {\n    var $scaleItemsLarge = this.planner.$timelineLarge.children('.scale-item'),\n      $scaleItemsSmall = this.planner.$timelineSmall.children('.scale-item'),\n      numScaleItemsLarge = $scaleItemsLarge.length,\n      numScaleItemsSmall = $scaleItemsSmall.length,\n      displayMode = Planner.DisplayMode,\n      cellInsets = graphics.insets($scaleItemsSmall, {\n        includeBorder: false\n      }),\n      minWidth = numScaleItemsSmall * cellInsets.horizontal(); // no matter what, this width must never be deceeded\n\n    if (this.planner.displayMode === displayMode.DAY) {\n      return Math.max(minWidth, numScaleItemsLarge * 52);\n    }\n    if (scout.isOneOf(this.planner.displayMode, displayMode.WORK_WEEK, displayMode.WEEK)) {\n      return Math.max(minWidth, numScaleItemsLarge * 160);\n    }\n    if (this.planner.displayMode === displayMode.MONTH) {\n      return Math.max(minWidth, numScaleItemsSmall * 23);\n    }\n    if (this.planner.displayMode === displayMode.CALENDAR_WEEK) {\n      return Math.max(minWidth, numScaleItemsSmall * 23);\n    }\n    if (this.planner.displayMode === displayMode.YEAR) {\n      return Math.max(minWidth, numScaleItemsSmall * 90);\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
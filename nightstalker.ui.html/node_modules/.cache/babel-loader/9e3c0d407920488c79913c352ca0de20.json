{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { arrays, Device, FileInput, HtmlComponent, scout, SingleLayout, strings, ValueField } from '../../../index';\n\nvar FileChooserButton = /*#__PURE__*/function (_ValueField) {\n  _inherits(FileChooserButton, _ValueField);\n\n  var _super = _createSuper(FileChooserButton);\n\n  function FileChooserButton() {\n    var _this;\n\n    _classCallCheck(this, FileChooserButton);\n\n    _this = _super.call(this);\n    _this.button = null;\n    _this.fileInput = null;\n    _this.acceptTypes = null;\n    _this.maximumUploadSize = FileInput.DEFAULT_MAXIMUM_UPLOAD_SIZE;\n    return _this;\n  }\n\n  _createClass(FileChooserButton, [{\n    key: \"_init\",\n    value: function _init(model) {\n      _get(_getPrototypeOf(FileChooserButton.prototype), \"_init\", this).call(this, model);\n\n      this.button = scout.create('Button', {\n        parent: this,\n        label: this._buttonLabel(),\n        iconId: this.iconId,\n        labelHtmlEnabled: this.labelHtmlEnabled\n      });\n      this.button.on('click', this._onButtonClick.bind(this));\n      this.fileInput.on('change', this._onFileChange.bind(this));\n      this.on('propertyChange', function (event) {\n        if (event.propertyName === 'enabledComputed') {\n          // Propagate \"enabledComputed\" to inner widgets\n          this.button.setEnabled(event.newValue);\n          this.fileInput.setEnabled(event.newValue);\n        }\n      }.bind(this));\n    }\n    /**\n     * Initializes the file input before calling set value.\n     * This cannot be done in _init because the value field would call _setValue first\n     */\n\n  }, {\n    key: \"_initValue\",\n    value: function _initValue(value) {\n      this.fileInput = scout.create('FileInput', {\n        parent: this,\n        acceptTypes: this.acceptTypes,\n        text: this.displayText,\n        enabled: this.enabledComputed,\n        maximumUploadSize: this.maximumUploadSize,\n        visible: !Device.get().supportsFile()\n      });\n\n      _get(_getPrototypeOf(FileChooserButton.prototype), \"_initValue\", this).call(this, value);\n    }\n  }, {\n    key: \"_buttonLabel\",\n    value: function _buttonLabel() {\n      return this.label;\n    }\n  }, {\n    key: \"_render\",\n    value: function _render() {\n      this.addContainer(this.$parent, 'file-chooser-button has-icon');\n      this.addLabel();\n      var $field = this.$parent.makeDiv();\n      var fieldHtmlComp = HtmlComponent.install($field, this.session);\n      this.button.render($field);\n      fieldHtmlComp.setLayout(new SingleLayout(this.button.htmlComp));\n      this.fileInput.render($field);\n      this.addField($field);\n      $field.setTabbable(false);\n      this.addStatus();\n    }\n  }, {\n    key: \"setDisplayText\",\n    value: function setDisplayText(text) {\n      _get(_getPrototypeOf(FileChooserButton.prototype), \"setDisplayText\", this).call(this, text);\n\n      this.fileInput.setText(text);\n\n      if (!text) {\n        this.fileInput.clear();\n      }\n    }\n    /**\n     * @override\n     */\n\n  }, {\n    key: \"_readDisplayText\",\n    value: function _readDisplayText() {\n      return this.fileInput.text;\n    }\n    /**\n     * @override\n     */\n\n  }, {\n    key: \"_renderLabel\",\n    value: function _renderLabel() {\n      this._renderEmptyLabel();\n    }\n  }, {\n    key: \"_onButtonClick\",\n    value: function _onButtonClick(event) {\n      this.fileInput.browse();\n    }\n  }, {\n    key: \"setLabel\",\n    value: function setLabel(label) {\n      _get(_getPrototypeOf(FileChooserButton.prototype), \"setLabel\", this).call(this, label);\n\n      this.button.setLabel(this._buttonLabel());\n    }\n  }, {\n    key: \"setIconId\",\n    value: function setIconId(iconId) {\n      this.setProperty('iconId', iconId);\n      this.button.setIconId(iconId);\n    }\n  }, {\n    key: \"setAcceptTypes\",\n    value: function setAcceptTypes(acceptTypes) {\n      this.setProperty('acceptTypes', acceptTypes);\n      this.fileInput.setAcceptTypes(acceptTypes);\n    }\n  }, {\n    key: \"setFileExtensions\",\n    value: function setFileExtensions(fileExtensions) {\n      this.setProperty('fileExtensions', fileExtensions);\n      var acceptTypes = arrays.ensure(fileExtensions);\n      acceptTypes = acceptTypes.map(function (acceptType) {\n        return acceptType.indexOf(0) === '.' ? acceptType : '.' + acceptType;\n      });\n      this.setAcceptTypes(strings.join(',', acceptTypes));\n      this.fileInput.acceptTypes = this.acceptTypes;\n    }\n  }, {\n    key: \"setMaximumUploadSize\",\n    value: function setMaximumUploadSize(maximumUploadSize) {\n      this.setProperty('maximumUploadSize', maximumUploadSize);\n      this.fileInput.setMaximumUploadSize(maximumUploadSize);\n    }\n  }, {\n    key: \"_onFileChange\",\n    value: function _onFileChange(event) {\n      this.setValue(arrays.first(event.files));\n    }\n    /**\n     * @override\n     */\n\n  }, {\n    key: \"_validateValue\",\n    value: function _validateValue(value) {\n      this.fileInput.validateMaximumUploadSize(value);\n      return value;\n    }\n    /**\n     * @override\n     */\n\n  }, {\n    key: \"_formatValue\",\n    value: function _formatValue(value) {\n      return !value ? '' : value.name;\n    }\n    /**\n     * @override\n     */\n\n  }, {\n    key: \"getFocusableElement\",\n    value: function getFocusableElement() {\n      return this.button.getFocusableElement();\n    }\n  }]);\n\n  return FileChooserButton;\n}(ValueField);\n\nexport { FileChooserButton as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/form/fields/filechooserbutton/FileChooserButton.js"],"names":["arrays","Device","FileInput","HtmlComponent","scout","SingleLayout","strings","ValueField","FileChooserButton","button","fileInput","acceptTypes","maximumUploadSize","DEFAULT_MAXIMUM_UPLOAD_SIZE","model","create","parent","label","_buttonLabel","iconId","labelHtmlEnabled","on","_onButtonClick","bind","_onFileChange","event","propertyName","setEnabled","newValue","value","text","displayText","enabled","enabledComputed","visible","get","supportsFile","addContainer","$parent","addLabel","$field","makeDiv","fieldHtmlComp","install","session","render","setLayout","htmlComp","addField","setTabbable","addStatus","setText","clear","_renderEmptyLabel","browse","setLabel","setProperty","setIconId","setAcceptTypes","fileExtensions","ensure","map","acceptType","indexOf","join","setMaximumUploadSize","setValue","first","files","validateMaximumUploadSize","name","getFocusableElement"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {arrays, Device, FileInput, HtmlComponent, scout, SingleLayout, strings, ValueField} from '../../../index';\n\nexport default class FileChooserButton extends ValueField {\n\n  constructor() {\n    super();\n\n    this.button = null;\n    this.fileInput = null;\n\n    this.acceptTypes = null;\n    this.maximumUploadSize = FileInput.DEFAULT_MAXIMUM_UPLOAD_SIZE;\n  }\n\n  _init(model) {\n    super._init(model);\n\n    this.button = scout.create('Button', {\n      parent: this,\n      label: this._buttonLabel(),\n      iconId: this.iconId,\n      labelHtmlEnabled: this.labelHtmlEnabled\n    });\n    this.button.on('click', this._onButtonClick.bind(this));\n\n    this.fileInput.on('change', this._onFileChange.bind(this));\n    this.on('propertyChange', function(event) {\n      if (event.propertyName === 'enabledComputed') {\n        // Propagate \"enabledComputed\" to inner widgets\n        this.button.setEnabled(event.newValue);\n        this.fileInput.setEnabled(event.newValue);\n      }\n    }.bind(this));\n  }\n\n  /**\n   * Initializes the file input before calling set value.\n   * This cannot be done in _init because the value field would call _setValue first\n   */\n  _initValue(value) {\n    this.fileInput = scout.create('FileInput', {\n      parent: this,\n      acceptTypes: this.acceptTypes,\n      text: this.displayText,\n      enabled: this.enabledComputed,\n      maximumUploadSize: this.maximumUploadSize,\n      visible: !Device.get().supportsFile()\n    });\n\n    super._initValue(value);\n  }\n\n  _buttonLabel() {\n    return this.label;\n  }\n\n  _render() {\n    this.addContainer(this.$parent, 'file-chooser-button has-icon');\n    this.addLabel();\n\n    var $field = this.$parent.makeDiv();\n    var fieldHtmlComp = HtmlComponent.install($field, this.session);\n    this.button.render($field);\n\n    fieldHtmlComp.setLayout(new SingleLayout(this.button.htmlComp));\n    this.fileInput.render($field);\n    this.addField($field);\n    $field.setTabbable(false);\n\n    this.addStatus();\n  }\n\n  setDisplayText(text) {\n    super.setDisplayText(text);\n    this.fileInput.setText(text);\n    if (!text) {\n      this.fileInput.clear();\n    }\n  }\n\n  /**\n   * @override\n   */\n  _readDisplayText() {\n    return this.fileInput.text;\n  }\n\n  /**\n   * @override\n   */\n  _renderLabel() {\n    this._renderEmptyLabel();\n  }\n\n  _onButtonClick(event) {\n    this.fileInput.browse();\n  }\n\n  setLabel(label) {\n    super.setLabel(label);\n    this.button.setLabel(this._buttonLabel());\n  }\n\n  setIconId(iconId) {\n    this.setProperty('iconId', iconId);\n    this.button.setIconId(iconId);\n  }\n\n  setAcceptTypes(acceptTypes) {\n    this.setProperty('acceptTypes', acceptTypes);\n    this.fileInput.setAcceptTypes(acceptTypes);\n  }\n\n  setFileExtensions(fileExtensions) {\n    this.setProperty('fileExtensions', fileExtensions);\n    var acceptTypes = arrays.ensure(fileExtensions);\n    acceptTypes = acceptTypes.map(function(acceptType) {\n      return acceptType.indexOf(0) === '.' ? acceptType : '.' + acceptType;\n    });\n    this.setAcceptTypes(strings.join(',', acceptTypes));\n    this.fileInput.acceptTypes = this.acceptTypes;\n  }\n\n  setMaximumUploadSize(maximumUploadSize) {\n    this.setProperty('maximumUploadSize', maximumUploadSize);\n    this.fileInput.setMaximumUploadSize(maximumUploadSize);\n  }\n\n  _onFileChange(event) {\n    this.setValue(arrays.first(event.files));\n  }\n\n  /**\n   * @override\n   */\n  _validateValue(value) {\n    this.fileInput.validateMaximumUploadSize(value);\n    return value;\n  }\n\n  /**\n   * @override\n   */\n  _formatValue(value) {\n    return !value ? '' : value.name;\n  }\n\n  /**\n   * @override\n   */\n  getFocusableElement() {\n    return this.button.getFocusableElement();\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
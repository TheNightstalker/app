{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { arrays, HtmlComponent, KeyStrokeContext, scout, strings, TabAreaLayout, TabAreaLeftKeyStroke, TabAreaRightKeyStroke, Widget } from '../../../index';\n\nvar TabArea = /*#__PURE__*/function (_Widget) {\n  _inherits(TabArea, _Widget);\n\n  var _super = _createSuper(TabArea);\n\n  function TabArea() {\n    var _this;\n\n    _classCallCheck(this, TabArea);\n\n    _this = _super.call(this);\n    _this.tabBox = null;\n    _this.tabs = [];\n    _this.displayStyle = TabArea.DisplayStyle.DEFAULT;\n    _this._tabItemPropertyChangeHandler = _this._onTabItemPropertyChange.bind(_assertThisInitialized(_this));\n    _this._tabPropertyChangeHandler = _this._onTabPropertyChange.bind(_assertThisInitialized(_this));\n    _this.ellipsis = null;\n    _this.$selectionMarker = null;\n    return _this;\n  }\n\n  _createClass(TabArea, [{\n    key: \"_init\",\n    value: function _init(options) {\n      _get(_getPrototypeOf(TabArea.prototype), \"_init\", this).call(this, options);\n\n      this.tabBox = options.tabBox;\n      this.ellipsis = scout.create('EllipsisMenu', {\n        parent: this,\n        cssClass: 'overflow-tab-item unfocusable',\n        iconId: null,\n        inheritAccessibility: false,\n        text: '0' // Initialize with the normal value to prevent unnecessary layout invalidation by the TabAreaLayout if ellipsis menus is not visible\n\n      });\n    }\n    /**\n     * @override\n     */\n\n  }, {\n    key: \"_createKeyStrokeContext\",\n    value: function _createKeyStrokeContext() {\n      return new KeyStrokeContext();\n    }\n    /**\n     * @override\n     */\n\n  }, {\n    key: \"_initKeyStrokeContext\",\n    value: function _initKeyStrokeContext() {\n      _get(_getPrototypeOf(TabArea.prototype), \"_initKeyStrokeContext\", this).call(this);\n\n      this.keyStrokeContext.registerKeyStroke([new TabAreaLeftKeyStroke(this), new TabAreaRightKeyStroke(this)]);\n    }\n  }, {\n    key: \"_render\",\n    value: function _render() {\n      this.$container = this.$parent.appendDiv('tab-area');\n      this.htmlComp = HtmlComponent.install(this.$container, this.session);\n      this.htmlComp.setLayout(new TabAreaLayout(this));\n      this.ellipsis.render(this.$container);\n      this.$selectionMarker = this.$container.appendDiv('selection-marker');\n    }\n  }, {\n    key: \"_renderProperties\",\n    value: function _renderProperties() {\n      _get(_getPrototypeOf(TabArea.prototype), \"_renderProperties\", this).call(this);\n\n      this._renderTabs();\n\n      this._renderSelectedTab();\n\n      this._renderHasSubLabel();\n\n      this._renderDisplayStyle();\n    }\n    /**\n     * @override FormField.js\n     */\n\n  }, {\n    key: \"_remove\",\n    value: function _remove() {\n      _get(_getPrototypeOf(TabArea.prototype), \"_remove\", this).call(this);\n\n      this._removeTabs();\n    }\n  }, {\n    key: \"setSelectedTabItem\",\n    value: function setSelectedTabItem(tabItem) {\n      this.setSelectedTab(this.getTabForItem(tabItem));\n    }\n  }, {\n    key: \"getTabForItem\",\n    value: function getTabForItem(tabItem) {\n      return arrays.find(this.tabs, function (tab) {\n        return tab.tabItem === tabItem;\n      }, this);\n    }\n  }, {\n    key: \"setSelectedTab\",\n    value: function setSelectedTab(tab) {\n      this.setProperty('selectedTab', tab);\n    }\n  }, {\n    key: \"_setSelectedTab\",\n    value: function _setSelectedTab(tab) {\n      if (this.selectedTab) {\n        this.selectedTab.setSelected(false);\n      }\n\n      if (tab) {\n        tab.setSelected(true);\n      }\n\n      this._setProperty('selectedTab', tab);\n\n      this._setTabbableItem(tab);\n    }\n  }, {\n    key: \"_renderSelectedTab\",\n    value: function _renderSelectedTab() {\n      // force a relayout in case the selected tab is overflown. The layout will ensure the selected tab is visible.\n      if (this.selectedTab && this.selectedTab.overflown) {\n        this.invalidateLayoutTree();\n      }\n    }\n  }, {\n    key: \"isTabItemFocused\",\n    value: function isTabItemFocused(tabItem) {\n      return this.getTabForItem(tabItem).isFocused();\n    }\n  }, {\n    key: \"focusTabItem\",\n    value: function focusTabItem(tabItem) {\n      this.focusTab(this.getTabForItem(tabItem));\n    }\n  }, {\n    key: \"focusTab\",\n    value: function focusTab(tabItem) {\n      tabItem.focus();\n    }\n  }, {\n    key: \"setTabItems\",\n    value: function setTabItems(tabItems) {\n      this.setProperty('tabs', tabItems);\n\n      this._updateHasSubLabel();\n\n      this.invalidateLayoutTree();\n    }\n  }, {\n    key: \"_setTabs\",\n    value: function _setTabs(tabItems) {\n      var tabsToRemove = this.tabs.slice(),\n          tabs = tabItems.map(function (tabItem) {\n        var tab = this.getTabForItem(tabItem);\n\n        if (!tab) {\n          tab = scout.create('Tab', {\n            parent: this,\n            tabItem: tabItem\n          });\n          tabItem.on('propertyChange', this._tabItemPropertyChangeHandler);\n          tab.on('propertyChange', this._tabPropertyChangeHandler);\n        } else {\n          arrays.remove(tabsToRemove, tab);\n        }\n\n        return tab;\n      }, this); // un-register model listeners\n\n      tabsToRemove.forEach(function (tab) {\n        tab.tabItem.off('propertyChange', this._tabItemPropertyChangeHandler);\n      }, this);\n\n      this._removeTabs(tabsToRemove);\n\n      this._setProperty('tabs', tabs);\n    }\n  }, {\n    key: \"_renderTabs\",\n    value: function _renderTabs() {\n      this.tabs.slice().reverse().forEach(function (tab, index, items) {\n        if (!tab.rendered) {\n          tab.render();\n        }\n\n        tab.$container.on('blur', this._onTabItemBlur.bind(this)).on('focus', this._onTabItemFocus.bind(this));\n        tab.$container.prependTo(this.$container);\n        tab.$container.on('blur', this._onTabItemBlur.bind(this)).on('focus', this._onTabItemFocus.bind(this));\n      }, this);\n    }\n  }, {\n    key: \"_removeTabs\",\n    value: function _removeTabs(tabs) {\n      tabs = tabs || this.tabs;\n      tabs.forEach(function (tab) {\n        tab.remove();\n      });\n    }\n  }, {\n    key: \"setDisplayStyle\",\n    value: function setDisplayStyle(displayStyle) {\n      this.setProperty('displayStyle', displayStyle);\n    }\n  }, {\n    key: \"_renderDisplayStyle\",\n    value: function _renderDisplayStyle() {\n      this.$container.toggleClass('spread-even', this.displayStyle === TabArea.DisplayStyle.SPREAD_EVEN);\n      this.invalidateLayoutTree();\n    }\n  }, {\n    key: \"_onTabItemFocus\",\n    value: function _onTabItemFocus() {\n      this.setFocused(true);\n    }\n  }, {\n    key: \"_onTabItemBlur\",\n    value: function _onTabItemBlur() {\n      this.setFocused(false);\n    }\n  }, {\n    key: \"_updateHasSubLabel\",\n    value: function _updateHasSubLabel() {\n      var items = this.tabs || [];\n\n      this._setHasSubLabel(items.some(function (item) {\n        return strings.hasText(item.subLabel);\n      }));\n    }\n  }, {\n    key: \"_setHasSubLabel\",\n    value: function _setHasSubLabel(hasSubLabel) {\n      if (this.hasSubLabel === hasSubLabel) {\n        return;\n      }\n\n      this._setProperty('hasSubLabel', hasSubLabel);\n\n      if (this.rendered) {\n        this._renderHasSubLabel();\n      }\n    }\n  }, {\n    key: \"_renderHasSubLabel\",\n    value: function _renderHasSubLabel() {\n      this.$container.toggleClass('has-sub-label', this.hasSubLabel);\n      this.invalidateLayoutTree();\n    }\n  }, {\n    key: \"selectNextTab\",\n    value: function selectNextTab(focusTab) {\n      this._moveSelectionHorizontal(true, focusTab);\n    }\n  }, {\n    key: \"selectPreviousTab\",\n    value: function selectPreviousTab(focusTab) {\n      this._moveSelectionHorizontal(false, focusTab);\n    }\n  }, {\n    key: \"_moveSelectionHorizontal\",\n    value: function _moveSelectionHorizontal(directionRight, focusTab) {\n      var tabItems = this.tabs.slice(),\n          $focusedElement = this.$container.activeElement(),\n          selectNext = false;\n\n      if (!directionRight) {\n        tabItems.reverse();\n        selectNext = $focusedElement[0] === this.ellipsis.$container[0];\n      }\n\n      tabItems.forEach(function (item, index) {\n        if (selectNext && item.visible && !item.overflown) {\n          this.setSelectedTab(item);\n\n          this._setTabbableItem(item);\n\n          if (focusTab) {\n            item.focus();\n          }\n\n          selectNext = false;\n          return;\n        }\n\n        if ($focusedElement[0] === item.$container[0]) {\n          selectNext = true;\n        }\n      }, this);\n\n      if (directionRight && selectNext && this.ellipsis.isTabTarget()) {\n        this._setTabbableItem(this.ellipsis);\n\n        if (focusTab) {\n          this.ellipsis.focus();\n        }\n      }\n    }\n  }, {\n    key: \"_setTabbableItem\",\n    value: function _setTabbableItem(tabItem) {\n      var tabItems = this.tabs;\n\n      if (tabItem) {\n        // clear old tabbable\n        this.ellipsis.setTabbable(false);\n        tabItems.forEach(function (item) {\n          item.setTabbable(false);\n        });\n        tabItem.setTabbable(true);\n      }\n    }\n  }, {\n    key: \"_onTabPropertyChange\",\n    value: function _onTabPropertyChange(event) {\n      if (event.propertyName === 'selected') {\n        this.setSelectedTab(event.source);\n      }\n    }\n  }, {\n    key: \"_onTabItemPropertyChange\",\n    value: function _onTabItemPropertyChange(event) {\n      if (event.propertyName === 'visible') {\n        this.invalidateLayoutTree();\n      }\n\n      if (event.propertyName === 'subLabel') {\n        this._updateHasSubLabel();\n      }\n    }\n  }]);\n\n  return TabArea;\n}(Widget);\n\n_defineProperty(TabArea, \"DisplayStyle\", {\n  DEFAULT: 'default',\n  SPREAD_EVEN: 'spreadEven'\n});\n\nexport { TabArea as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/form/fields/tabbox/TabArea.js"],"names":["arrays","HtmlComponent","KeyStrokeContext","scout","strings","TabAreaLayout","TabAreaLeftKeyStroke","TabAreaRightKeyStroke","Widget","TabArea","tabBox","tabs","displayStyle","DisplayStyle","DEFAULT","_tabItemPropertyChangeHandler","_onTabItemPropertyChange","bind","_tabPropertyChangeHandler","_onTabPropertyChange","ellipsis","$selectionMarker","options","create","parent","cssClass","iconId","inheritAccessibility","text","keyStrokeContext","registerKeyStroke","$container","$parent","appendDiv","htmlComp","install","session","setLayout","render","_renderTabs","_renderSelectedTab","_renderHasSubLabel","_renderDisplayStyle","_removeTabs","tabItem","setSelectedTab","getTabForItem","find","tab","setProperty","selectedTab","setSelected","_setProperty","_setTabbableItem","overflown","invalidateLayoutTree","isFocused","focusTab","focus","tabItems","_updateHasSubLabel","tabsToRemove","slice","map","on","remove","forEach","off","reverse","index","items","rendered","_onTabItemBlur","_onTabItemFocus","prependTo","toggleClass","SPREAD_EVEN","setFocused","_setHasSubLabel","some","item","hasText","subLabel","hasSubLabel","_moveSelectionHorizontal","directionRight","$focusedElement","activeElement","selectNext","visible","isTabTarget","setTabbable","event","propertyName","source"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {arrays, HtmlComponent, KeyStrokeContext, scout, strings, TabAreaLayout, TabAreaLeftKeyStroke, TabAreaRightKeyStroke, Widget} from '../../../index';\n\nexport default class TabArea extends Widget {\n\n  constructor() {\n    super();\n    this.tabBox = null;\n    this.tabs = [];\n    this.displayStyle = TabArea.DisplayStyle.DEFAULT;\n\n    this._tabItemPropertyChangeHandler = this._onTabItemPropertyChange.bind(this);\n    this._tabPropertyChangeHandler = this._onTabPropertyChange.bind(this);\n    this.ellipsis = null;\n\n    this.$selectionMarker = null;\n  }\n\n  static DisplayStyle = {\n    DEFAULT: 'default',\n    SPREAD_EVEN: 'spreadEven'\n  };\n\n  _init(options) {\n    super._init(options);\n    this.tabBox = options.tabBox;\n\n    this.ellipsis = scout.create('EllipsisMenu', {\n      parent: this,\n      cssClass: 'overflow-tab-item unfocusable',\n      iconId: null,\n      inheritAccessibility: false,\n      text: '0' // Initialize with the normal value to prevent unnecessary layout invalidation by the TabAreaLayout if ellipsis menus is not visible\n    });\n  }\n\n  /**\n   * @override\n   */\n  _createKeyStrokeContext() {\n    return new KeyStrokeContext();\n  }\n\n  /**\n   * @override\n   */\n  _initKeyStrokeContext() {\n    super._initKeyStrokeContext();\n    this.keyStrokeContext.registerKeyStroke([\n      new TabAreaLeftKeyStroke(this),\n      new TabAreaRightKeyStroke(this)\n    ]);\n  }\n\n  _render() {\n    this.$container = this.$parent.appendDiv('tab-area');\n    this.htmlComp = HtmlComponent.install(this.$container, this.session);\n    this.htmlComp.setLayout(new TabAreaLayout(this));\n\n    this.ellipsis.render(this.$container);\n\n    this.$selectionMarker = this.$container.appendDiv('selection-marker');\n  }\n\n  _renderProperties() {\n    super._renderProperties();\n    this._renderTabs();\n    this._renderSelectedTab();\n    this._renderHasSubLabel();\n    this._renderDisplayStyle();\n  }\n\n  /**\n   * @override FormField.js\n   */\n  _remove() {\n    super._remove();\n    this._removeTabs();\n  }\n\n  setSelectedTabItem(tabItem) {\n    this.setSelectedTab(this.getTabForItem(tabItem));\n  }\n\n  getTabForItem(tabItem) {\n    return arrays.find(this.tabs, function(tab) {\n      return tab.tabItem === tabItem;\n    }, this);\n  }\n\n  setSelectedTab(tab) {\n    this.setProperty('selectedTab', tab);\n  }\n\n  _setSelectedTab(tab) {\n    if (this.selectedTab) {\n      this.selectedTab.setSelected(false);\n    }\n    if (tab) {\n      tab.setSelected(true);\n    }\n    this._setProperty('selectedTab', tab);\n    this._setTabbableItem(tab);\n  }\n\n  _renderSelectedTab() {\n    // force a relayout in case the selected tab is overflown. The layout will ensure the selected tab is visible.\n    if (this.selectedTab && this.selectedTab.overflown) {\n      this.invalidateLayoutTree();\n    }\n  }\n\n  isTabItemFocused(tabItem) {\n    return this.getTabForItem(tabItem).isFocused();\n  }\n\n  focusTabItem(tabItem) {\n    this.focusTab(this.getTabForItem(tabItem));\n  }\n\n  focusTab(tabItem) {\n    tabItem.focus();\n  }\n\n  setTabItems(tabItems) {\n    this.setProperty('tabs', tabItems);\n    this._updateHasSubLabel();\n    this.invalidateLayoutTree();\n  }\n\n  _setTabs(tabItems) {\n    var tabsToRemove = this.tabs.slice(),\n      tabs = tabItems.map(function(tabItem) {\n        var tab = this.getTabForItem(tabItem);\n        if (!tab) {\n          tab = scout.create('Tab', {\n            parent: this,\n            tabItem: tabItem\n          });\n          tabItem.on('propertyChange', this._tabItemPropertyChangeHandler);\n          tab.on('propertyChange', this._tabPropertyChangeHandler);\n        } else {\n          arrays.remove(tabsToRemove, tab);\n        }\n        return tab;\n      }, this);\n\n    // un-register model listeners\n    tabsToRemove.forEach(function(tab) {\n      tab.tabItem.off('propertyChange', this._tabItemPropertyChangeHandler);\n    }, this);\n\n    this._removeTabs(tabsToRemove);\n    this._setProperty('tabs', tabs);\n  }\n\n  _renderTabs() {\n    this.tabs.slice().reverse().forEach(function(tab, index, items) {\n      if (!tab.rendered) {\n        tab.render();\n      }\n      tab.$container\n        .on('blur', this._onTabItemBlur.bind(this))\n        .on('focus', this._onTabItemFocus.bind(this));\n      tab.$container.prependTo(this.$container);\n      tab.$container\n        .on('blur', this._onTabItemBlur.bind(this))\n        .on('focus', this._onTabItemFocus.bind(this));\n    }, this);\n  }\n\n  _removeTabs(tabs) {\n    tabs = tabs || this.tabs;\n    tabs.forEach(function(tab) {\n      tab.remove();\n    });\n  }\n\n  setDisplayStyle(displayStyle) {\n    this.setProperty('displayStyle', displayStyle);\n  }\n\n  _renderDisplayStyle() {\n    this.$container.toggleClass('spread-even', this.displayStyle === TabArea.DisplayStyle.SPREAD_EVEN);\n    this.invalidateLayoutTree();\n  }\n\n  _onTabItemFocus() {\n    this.setFocused(true);\n  }\n\n  _onTabItemBlur() {\n    this.setFocused(false);\n  }\n\n  _updateHasSubLabel() {\n    var items = this.tabs || [];\n    this._setHasSubLabel(items.some(function(item) {\n      return strings.hasText(item.subLabel);\n    }));\n  }\n\n  _setHasSubLabel(hasSubLabel) {\n    if (this.hasSubLabel === hasSubLabel) {\n      return;\n    }\n    this._setProperty('hasSubLabel', hasSubLabel);\n    if (this.rendered) {\n      this._renderHasSubLabel();\n    }\n  }\n\n  _renderHasSubLabel() {\n    this.$container.toggleClass('has-sub-label', this.hasSubLabel);\n    this.invalidateLayoutTree();\n  }\n\n  selectNextTab(focusTab) {\n    this._moveSelectionHorizontal(true, focusTab);\n  }\n\n  selectPreviousTab(focusTab) {\n    this._moveSelectionHorizontal(false, focusTab);\n  }\n\n  _moveSelectionHorizontal(directionRight, focusTab) {\n    var tabItems = this.tabs.slice(),\n      $focusedElement = this.$container.activeElement(),\n      selectNext = false;\n    if (!directionRight) {\n      tabItems.reverse();\n      selectNext = $focusedElement[0] === this.ellipsis.$container[0];\n    }\n\n    tabItems.forEach(function(item, index) {\n      if (selectNext && item.visible && !item.overflown) {\n        this.setSelectedTab(item);\n        this._setTabbableItem(item);\n        if (focusTab) {\n          item.focus();\n        }\n        selectNext = false;\n        return;\n      }\n      if ($focusedElement[0] === item.$container[0]) {\n        selectNext = true;\n      }\n    }, this);\n\n    if (directionRight && selectNext && this.ellipsis.isTabTarget()) {\n      this._setTabbableItem(this.ellipsis);\n      if (focusTab) {\n        this.ellipsis.focus();\n      }\n    }\n  }\n\n  _setTabbableItem(tabItem) {\n    var tabItems = this.tabs;\n    if (tabItem) {\n      // clear old tabbable\n      this.ellipsis.setTabbable(false);\n      tabItems.forEach(function(item) {\n        item.setTabbable(false);\n      });\n      tabItem.setTabbable(true);\n    }\n  }\n\n  _onTabPropertyChange(event) {\n    if (event.propertyName === 'selected') {\n      this.setSelectedTab(event.source);\n    }\n  }\n\n  _onTabItemPropertyChange(event) {\n    if (event.propertyName === 'visible') {\n      this.invalidateLayoutTree();\n    }\n    if (event.propertyName === 'subLabel') {\n      this._updateHasSubLabel();\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
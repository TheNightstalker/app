{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { Device, HtmlComponent, scout, Widget } from '../index';\n\nvar IFrame = /*#__PURE__*/function (_Widget) {\n  _inherits(IFrame, _Widget);\n\n  var _super = _createSuper(IFrame);\n\n  function IFrame() {\n    var _this;\n\n    _classCallCheck(this, IFrame);\n\n    _this = _super.call(this);\n    _this.location = null;\n    _this.sandboxEnabled = true;\n    _this.sandboxPermissions = null;\n    _this.scrollBarEnabled = true;\n    _this.trackLocation = false; // Iframe on iOS is always as big as its content. Workaround it by using a wrapper div with overflow: auto\n    // Don't wrap it when running in the chrome emulator (in that case isIosPlatform returns false)\n\n    _this.wrapIframe = Device.get().isIosPlatform();\n    _this.$iframe = null;\n    _this._loadHandler = _this._onLoad.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(IFrame, [{\n    key: \"_render\",\n    value: function _render() {\n      var cssClass = 'iframe ' + Device.get().cssClassForIphone();\n\n      if (this.wrapIframe) {\n        this.$container = this.$parent.appendDiv('iframe-wrapper');\n        this.$iframe = this.$container.appendElement('<iframe>', cssClass);\n      } else {\n        this.$iframe = this.$parent.appendElement('<iframe>', cssClass);\n        this.$container = this.$iframe;\n      }\n\n      this.htmlComp = HtmlComponent.install(this.$container, this.session);\n    }\n    /**\n     * @override ValueField.js\n     */\n\n  }, {\n    key: \"_renderProperties\",\n    value: function _renderProperties() {\n      _get(_getPrototypeOf(IFrame.prototype), \"_renderProperties\", this).call(this);\n\n      this._renderScrollBarEnabled();\n\n      this._renderSandboxEnabled(); // includes _renderSandboxPermissions()\n\n\n      this._renderLocation(); // Needs to be after _renderScrollBarEnabled and _renderSandboxEnabled, see comment in _renderScrollBarEnabled\n\n\n      this._renderTrackLocation();\n    }\n  }, {\n    key: \"setLocation\",\n    value: function setLocation(location) {\n      this.setProperty('location', location);\n    }\n  }, {\n    key: \"_renderLocation\",\n    value: function _renderLocation() {\n      // Convert empty locations to 'about:blank', because in Firefox (maybe others, too?),\n      // empty locations simply remove the src attribute but don't remove the old content.\n      var location = this.location || 'about:blank';\n      this.$iframe.attr('src', location);\n    }\n  }, {\n    key: \"setTrackLocation\",\n    value: function setTrackLocation(trackLocation) {\n      this.setProperty('trackLocation', trackLocation);\n    }\n  }, {\n    key: \"_renderTrackLocation\",\n    value: function _renderTrackLocation(trackLocation) {\n      if (this.trackLocation) {\n        this.$iframe.on('load', this._loadHandler);\n      } else {\n        this.$iframe.off('load', this._loadHandler);\n      }\n    }\n  }, {\n    key: \"_onLoad\",\n    value: function _onLoad(event) {\n      if (!this.rendered) {\n        // check needed, because this is an async callback\n        return;\n      }\n\n      if (this.trackLocation) {\n        var doc = this.$iframe[0].contentDocument;\n\n        if (!doc) {\n          // Doc can be null if website cannot be loaded or if website is not from same origin\n          return;\n        }\n\n        var location = doc.location.href;\n\n        if (location === 'about:blank') {\n          location = null;\n        }\n\n        this._setProperty('location', location);\n      }\n    }\n  }, {\n    key: \"setScrollBarEnabled\",\n    value: function setScrollBarEnabled(scrollBarEnabled) {\n      this.setProperty('scrollBarEnabled', scrollBarEnabled);\n    }\n  }, {\n    key: \"_renderScrollBarEnabled\",\n    value: function _renderScrollBarEnabled() {\n      this.$container.toggleClass('no-scrolling', !this.scrollBarEnabled); // According to http://stackoverflow.com/a/18470016, setting 'overflow: hidden' via\n      // CSS should be enough. However, if the inner page sets 'overflow' to another value,\n      // scroll bars are shown again. Therefore, we add the legacy 'scrolling' attribute,\n      // which is deprecated in HTML5, but seems to do the trick.\n\n      this.$iframe.attr('scrolling', this.scrollBarEnabled ? 'yes' : 'no'); // re-render location otherwise the attribute change would have no effect, see\n      // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-iframe-sandbox\n\n      if (this.rendered) {\n        this._renderLocation();\n      }\n    }\n  }, {\n    key: \"setSandboxEnabled\",\n    value: function setSandboxEnabled(sandboxEnabled) {\n      this.setProperty('sandboxEnabled', sandboxEnabled);\n    }\n  }, {\n    key: \"_renderSandboxEnabled\",\n    value: function _renderSandboxEnabled() {\n      if (this.sandboxEnabled) {\n        this._renderSandboxPermissions();\n      } else {\n        this.$iframe.removeAttr('sandbox');\n        this.$iframe.removeAttr('security');\n      } // re-render location otherwise the attribute change would have no effect, see\n      // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-iframe-sandbox\n\n\n      if (this.rendered) {\n        this._renderLocation();\n      }\n    }\n  }, {\n    key: \"setSandboxPermissions\",\n    value: function setSandboxPermissions(sandboxPermissions) {\n      this.setProperty('sandboxPermissions', sandboxPermissions);\n    }\n  }, {\n    key: \"_renderSandboxPermissions\",\n    value: function _renderSandboxPermissions() {\n      if (!this.sandboxEnabled) {\n        return;\n      }\n\n      this.$iframe.attr('sandbox', scout.nvl(this.sandboxPermissions, '')); // re-render location otherwise the attribute change would have no effect, see\n      // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-iframe-sandbox\n\n      if (this.rendered) {\n        this._renderLocation();\n      }\n    }\n  }]);\n\n  return IFrame;\n}(Widget);\n\nexport { IFrame as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/iframe/IFrame.js"],"names":["Device","HtmlComponent","scout","Widget","IFrame","location","sandboxEnabled","sandboxPermissions","scrollBarEnabled","trackLocation","wrapIframe","get","isIosPlatform","$iframe","_loadHandler","_onLoad","bind","cssClass","cssClassForIphone","$container","$parent","appendDiv","appendElement","htmlComp","install","session","_renderScrollBarEnabled","_renderSandboxEnabled","_renderLocation","_renderTrackLocation","setProperty","attr","on","off","event","rendered","doc","contentDocument","href","_setProperty","toggleClass","_renderSandboxPermissions","removeAttr","nvl"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {Device, HtmlComponent, scout, Widget} from '../index';\n\nexport default class IFrame extends Widget {\n\n  constructor() {\n    super();\n\n    this.location = null;\n    this.sandboxEnabled = true;\n    this.sandboxPermissions = null;\n    this.scrollBarEnabled = true;\n    this.trackLocation = false;\n    // Iframe on iOS is always as big as its content. Workaround it by using a wrapper div with overflow: auto\n    // Don't wrap it when running in the chrome emulator (in that case isIosPlatform returns false)\n    this.wrapIframe = Device.get().isIosPlatform();\n    this.$iframe = null;\n    this._loadHandler = this._onLoad.bind(this);\n  }\n\n  _render() {\n    var cssClass = 'iframe ' + Device.get().cssClassForIphone();\n    if (this.wrapIframe) {\n      this.$container = this.$parent.appendDiv('iframe-wrapper');\n      this.$iframe = this.$container.appendElement('<iframe>', cssClass);\n    } else {\n      this.$iframe = this.$parent.appendElement('<iframe>', cssClass);\n      this.$container = this.$iframe;\n    }\n    this.htmlComp = HtmlComponent.install(this.$container, this.session);\n  }\n\n  /**\n   * @override ValueField.js\n   */\n  _renderProperties() {\n    super._renderProperties();\n    this._renderScrollBarEnabled();\n    this._renderSandboxEnabled(); // includes _renderSandboxPermissions()\n    this._renderLocation(); // Needs to be after _renderScrollBarEnabled and _renderSandboxEnabled, see comment in _renderScrollBarEnabled\n    this._renderTrackLocation();\n  }\n\n  setLocation(location) {\n    this.setProperty('location', location);\n  }\n\n  _renderLocation() {\n    // Convert empty locations to 'about:blank', because in Firefox (maybe others, too?),\n    // empty locations simply remove the src attribute but don't remove the old content.\n    var location = this.location || 'about:blank';\n    this.$iframe.attr('src', location);\n  }\n\n  setTrackLocation(trackLocation) {\n    this.setProperty('trackLocation', trackLocation);\n  }\n\n  _renderTrackLocation(trackLocation) {\n    if (this.trackLocation) {\n      this.$iframe.on('load', this._loadHandler);\n    } else {\n      this.$iframe.off('load', this._loadHandler);\n    }\n  }\n\n  _onLoad(event) {\n    if (!this.rendered) { // check needed, because this is an async callback\n      return;\n    }\n\n    if (this.trackLocation) {\n      var doc = this.$iframe[0].contentDocument;\n      if (!doc) {\n        // Doc can be null if website cannot be loaded or if website is not from same origin\n        return;\n      }\n      var location = doc.location.href;\n      if (location === 'about:blank') {\n        location = null;\n      }\n      this._setProperty('location', location);\n    }\n  }\n\n  setScrollBarEnabled(scrollBarEnabled) {\n    this.setProperty('scrollBarEnabled', scrollBarEnabled);\n  }\n\n  _renderScrollBarEnabled() {\n    this.$container.toggleClass('no-scrolling', !this.scrollBarEnabled);\n    // According to http://stackoverflow.com/a/18470016, setting 'overflow: hidden' via\n    // CSS should be enough. However, if the inner page sets 'overflow' to another value,\n    // scroll bars are shown again. Therefore, we add the legacy 'scrolling' attribute,\n    // which is deprecated in HTML5, but seems to do the trick.\n    this.$iframe.attr('scrolling', (this.scrollBarEnabled ? 'yes' : 'no'));\n\n    // re-render location otherwise the attribute change would have no effect, see\n    // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-iframe-sandbox\n    if (this.rendered) {\n      this._renderLocation();\n    }\n  }\n\n  setSandboxEnabled(sandboxEnabled) {\n    this.setProperty('sandboxEnabled', sandboxEnabled);\n  }\n\n  _renderSandboxEnabled() {\n    if (this.sandboxEnabled) {\n      this._renderSandboxPermissions();\n    } else {\n      this.$iframe.removeAttr('sandbox');\n      this.$iframe.removeAttr('security');\n    }\n    // re-render location otherwise the attribute change would have no effect, see\n    // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-iframe-sandbox\n    if (this.rendered) {\n      this._renderLocation();\n    }\n  }\n\n  setSandboxPermissions(sandboxPermissions) {\n    this.setProperty('sandboxPermissions', sandboxPermissions);\n  }\n\n  _renderSandboxPermissions() {\n    if (!this.sandboxEnabled) {\n      return;\n    }\n    this.$iframe.attr('sandbox', scout.nvl(this.sandboxPermissions, ''));\n    // re-render location otherwise the attribute change would have no effect, see\n    // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-iframe-sandbox\n    if (this.rendered) {\n      this._renderLocation();\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { Dimension, graphics, HtmlEnvironment, PopupLayout, SmartFieldPopup } from '../../../index';\n/**\n * The popup layout is different from other layouts, since it can determine its own size\n * when the autoSize flag is set to true. Otherwise it uses the given size, like a regular\n * layout. The autoSize feature is used, when a child of the SmartFieldPopupLayout invalidates the\n * tree up to the popup. Since the popup is a validate root it must re-layout itself.\n * However: the size of the popup dependes on the field it belongs to.\n *\n *  The proposal-chooser DIV is not always present.\n */\n\nvar SmartFieldPopupLayout = /*#__PURE__*/function (_PopupLayout) {\n  _inherits(SmartFieldPopupLayout, _PopupLayout);\n\n  var _super = _createSuper(SmartFieldPopupLayout);\n\n  function SmartFieldPopupLayout(popup) {\n    var _this;\n\n    _classCallCheck(this, SmartFieldPopupLayout);\n\n    _this = _super.call(this, popup);\n    _this.animating = false;\n    _this.doubleCalcPrefSize = false;\n    return _this;\n  }\n\n  _createClass(SmartFieldPopupLayout, [{\n    key: \"layout\",\n    value: function layout($container) {\n      var size,\n          popupSize,\n          htmlProposalChooser = this._htmlProposalChooser(); // skip layout while CSS animation is running (prefSize would not work while animation is running)\n\n\n      if (this.animating) {\n        this.popup.htmlComp.$comp.oneAnimationEnd(function () {\n          this.popup.revalidateLayout();\n        }.bind(this));\n        return;\n      }\n\n      _get(_getPrototypeOf(SmartFieldPopupLayout.prototype), \"layout\", this).call(this, $container);\n\n      popupSize = this.popup.htmlComp.size();\n      size = popupSize.subtract(this.popup.htmlComp.insets());\n      htmlProposalChooser.setSize(size);\n\n      if (this.popup.htmlComp.layouted) {\n        // Reposition because opening direction may have to be switched if popup gets bigger\n        // Don't do it the first time (will be done by popup.open), only if the popup is already\n        // open and gets layouted again\n        this.popup.position();\n      } else if (SmartFieldPopup.hasPopupAnimation()) {\n        // don't use animation on crappy browsers like IE\n        // This code here is a bit complicated because:\n        // 1. we must position the scrollTo position before we start the animation\n        //    because it looks ugly, when we jump to the scroll position after the\n        //    animation has ended\n        // 2. we must first layout the popup with the table/tree correctly because\n        //    revealSelection doesn't work when popup has not the right size or is\n        //    not visible. That's why we must set the visibility to hidden.\n        // 3. we wait for the layout validator until the popup layout is validated\n        //    which means the scroll position is set correctly. Then we make the\n        //    popup visible again and start the animation (which shrinks the popup\n        //    to 1px height initially.\n        this.animating = true;\n        this.popup.htmlComp.$comp.css('visibility', 'hidden');\n        this.popup.session.layoutValidator.schedulePostValidateFunction(function () {\n          this.popup.htmlComp.$comp.css('visibility', '');\n          this.popup.htmlComp.$comp.addClassForAnimation('animate-open');\n          this.popup.htmlComp.$comp.oneAnimationEnd(function () {\n            this.animating = false;\n\n            this.popup._onAnimationEnd();\n          }.bind(this));\n        }.bind(this));\n      }\n    }\n    /**\n     * @override AbstractLayout.js\n     */\n\n  }, {\n    key: \"preferredLayoutSize\",\n    value: function preferredLayoutSize($container, options) {\n      var prefSize,\n          htmlProposalChooser = this._htmlProposalChooser(),\n          fieldBounds = graphics.offsetBounds(this.popup.smartField.$field);\n\n      if (htmlProposalChooser) {\n        prefSize = htmlProposalChooser.prefSize(options);\n        prefSize = prefSize.add(this.popup.htmlComp.insets());\n      } else {\n        prefSize = new Dimension(HtmlEnvironment.get().formColumnWidth, HtmlEnvironment.get().formRowHeight * 2);\n      }\n\n      prefSize.width = Math.max(fieldBounds.width, prefSize.width);\n      prefSize.height = Math.max(15, Math.min(350, prefSize.height)); // at least some pixels height in case there is no data, no status, no active filter\n\n      if (prefSize.width > this._maxWindowSize()) {\n        prefSize.width = this._maxWindowSize();\n      }\n\n      return prefSize;\n    }\n  }, {\n    key: \"_htmlProposalChooser\",\n    value: function _htmlProposalChooser() {\n      var proposalChooser = this.popup.proposalChooser;\n\n      if (!proposalChooser) {\n        return null;\n      }\n\n      return proposalChooser.htmlComp;\n    }\n  }, {\n    key: \"_maxWindowSize\",\n    value: function _maxWindowSize() {\n      return this.popup.$container.window().width() - 2 * this.popup.windowPaddingX;\n    }\n  }]);\n\n  return SmartFieldPopupLayout;\n}(PopupLayout);\n\nexport { SmartFieldPopupLayout as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/form/fields/smartfield/SmartFieldPopupLayout.js"],"names":["Dimension","graphics","HtmlEnvironment","PopupLayout","SmartFieldPopup","SmartFieldPopupLayout","popup","animating","doubleCalcPrefSize","$container","size","popupSize","htmlProposalChooser","_htmlProposalChooser","htmlComp","$comp","oneAnimationEnd","revalidateLayout","bind","subtract","insets","setSize","layouted","position","hasPopupAnimation","css","session","layoutValidator","schedulePostValidateFunction","addClassForAnimation","_onAnimationEnd","options","prefSize","fieldBounds","offsetBounds","smartField","$field","add","get","formColumnWidth","formRowHeight","width","Math","max","height","min","_maxWindowSize","proposalChooser","window","windowPaddingX"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {Dimension, graphics, HtmlEnvironment, PopupLayout, SmartFieldPopup} from '../../../index';\n\n/**\n * The popup layout is different from other layouts, since it can determine its own size\n * when the autoSize flag is set to true. Otherwise it uses the given size, like a regular\n * layout. The autoSize feature is used, when a child of the SmartFieldPopupLayout invalidates the\n * tree up to the popup. Since the popup is a validate root it must re-layout itself.\n * However: the size of the popup dependes on the field it belongs to.\n *\n *  The proposal-chooser DIV is not always present.\n */\nexport default class SmartFieldPopupLayout extends PopupLayout {\n\n  constructor(popup) {\n    super(popup);\n\n    this.animating = false;\n    this.doubleCalcPrefSize = false;\n  }\n\n  layout($container) {\n    var size, popupSize,\n      htmlProposalChooser = this._htmlProposalChooser();\n\n    // skip layout while CSS animation is running (prefSize would not work while animation is running)\n    if (this.animating) {\n      this.popup.htmlComp.$comp.oneAnimationEnd(function() {\n        this.popup.revalidateLayout();\n      }.bind(this));\n      return;\n    }\n\n    super.layout($container);\n\n    popupSize = this.popup.htmlComp.size();\n    size = popupSize.subtract(this.popup.htmlComp.insets());\n    htmlProposalChooser.setSize(size);\n\n    if (this.popup.htmlComp.layouted) {\n      // Reposition because opening direction may have to be switched if popup gets bigger\n      // Don't do it the first time (will be done by popup.open), only if the popup is already\n      // open and gets layouted again\n      this.popup.position();\n    } else if (SmartFieldPopup.hasPopupAnimation()) { // don't use animation on crappy browsers like IE\n      // This code here is a bit complicated because:\n      // 1. we must position the scrollTo position before we start the animation\n      //    because it looks ugly, when we jump to the scroll position after the\n      //    animation has ended\n      // 2. we must first layout the popup with the table/tree correctly because\n      //    revealSelection doesn't work when popup has not the right size or is\n      //    not visible. That's why we must set the visibility to hidden.\n      // 3. we wait for the layout validator until the popup layout is validated\n      //    which means the scroll position is set correctly. Then we make the\n      //    popup visible again and start the animation (which shrinks the popup\n      //    to 1px height initially.\n      this.animating = true;\n      this.popup.htmlComp.$comp.css('visibility', 'hidden');\n\n      this.popup.session.layoutValidator.schedulePostValidateFunction(function() {\n        this.popup.htmlComp.$comp.css('visibility', '');\n        this.popup.htmlComp.$comp.addClassForAnimation('animate-open');\n        this.popup.htmlComp.$comp.oneAnimationEnd(function() {\n          this.animating = false;\n          this.popup._onAnimationEnd();\n        }.bind(this));\n      }.bind(this));\n    }\n  }\n\n  /**\n   * @override AbstractLayout.js\n   */\n  preferredLayoutSize($container, options) {\n    var prefSize,\n      htmlProposalChooser = this._htmlProposalChooser(),\n      fieldBounds = graphics.offsetBounds(this.popup.smartField.$field);\n\n    if (htmlProposalChooser) {\n      prefSize = htmlProposalChooser.prefSize(options);\n      prefSize = prefSize.add(this.popup.htmlComp.insets());\n    } else {\n      prefSize = new Dimension(\n        HtmlEnvironment.get().formColumnWidth,\n        HtmlEnvironment.get().formRowHeight * 2);\n    }\n\n    prefSize.width = Math.max(fieldBounds.width, prefSize.width);\n    prefSize.height = Math.max(15, Math.min(350, prefSize.height)); // at least some pixels height in case there is no data, no status, no active filter\n\n    if (prefSize.width > this._maxWindowSize()) {\n      prefSize.width = this._maxWindowSize();\n    }\n\n    return prefSize;\n  }\n\n  _htmlProposalChooser() {\n    var proposalChooser = this.popup.proposalChooser;\n    if (!proposalChooser) {\n      return null;\n    }\n    return proposalChooser.htmlComp;\n  }\n\n  _maxWindowSize() {\n    return this.popup.$container.window().width() - (2 * this.popup.windowPaddingX);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
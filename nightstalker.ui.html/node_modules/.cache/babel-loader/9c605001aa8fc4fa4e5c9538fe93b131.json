{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/*\n * Copyright (c) 2014-2017 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { AbstractLayout, Dimension, FormField, graphics, HtmlComponent, HtmlEnvironment, Rectangle } from '../../../index';\n\nvar TabBoxHeaderLayout = /*#__PURE__*/function (_AbstractLayout) {\n  _inherits(TabBoxHeaderLayout, _AbstractLayout);\n\n  var _super = _createSuper(TabBoxHeaderLayout);\n\n  function TabBoxHeaderLayout(tabBoxHeader) {\n    var _this;\n\n    _classCallCheck(this, TabBoxHeaderLayout);\n\n    _this = _super.call(this);\n    _this.tabBoxHeader = tabBoxHeader;\n\n    _this._initDefaults();\n\n    _this.htmlPropertyChangeHandler = _this._onHtmlEnvironmenPropertyChange.bind(_assertThisInitialized(_this));\n    HtmlEnvironment.get().on('propertyChange', _this.htmlPropertyChangeHandler);\n\n    _this.tabBoxHeader.one('remove', function () {\n      HtmlEnvironment.get().off('propertyChange', this.htmlPropertyChangeHandler);\n    }.bind(_assertThisInitialized(_this)));\n\n    return _this;\n  }\n\n  _createClass(TabBoxHeaderLayout, [{\n    key: \"_initDefaults\",\n    value: function _initDefaults() {\n      this.fieldStatusWidth = HtmlEnvironment.get().fieldStatusWidth;\n    }\n  }, {\n    key: \"_onHtmlEnvironmenPropertyChange\",\n    value: function _onHtmlEnvironmenPropertyChange() {\n      this._initDefaults();\n\n      this.tabBoxHeader.invalidateLayoutTree();\n    }\n  }, {\n    key: \"layout\",\n    value: function layout($container) {\n      //\n      var htmlContainer = HtmlComponent.get($container),\n          tabArea = this.tabBoxHeader.tabArea,\n          tabAreaMargins = tabArea.htmlComp.margins(),\n          tabAreaPrefSize,\n          menuBar = this.tabBoxHeader.menuBar,\n          menuBarMargins = menuBar.htmlComp.margins(),\n          menuBarMinumumSize,\n          $status = this.tabBoxHeader.tabBox.$status,\n          statusSizeLarge = new Dimension(),\n          insets = htmlContainer.insets(),\n          containerSize = htmlContainer.availableSize({\n        exact: true\n      }).subtract(htmlContainer.insets()),\n          clientArea = new Rectangle(insets.left, insets.top, containerSize.width, containerSize.height),\n          left = clientArea.x;\n      menuBarMinumumSize = menuBar.htmlComp.prefSize({\n        widthHint: 0\n      });\n\n      if (this.tabBoxHeader.tabBox.statusPosition === FormField.StatusPosition.TOP && $status && $status.isVisible()) {\n        statusSizeLarge.height = $status.outerHeight(true);\n        statusSizeLarge.width = this.fieldStatusWidth + graphics.margins($status).horizontal();\n      }\n\n      tabAreaPrefSize = tabArea.htmlComp.prefSize({\n        widthHint: clientArea.width - menuBarMinumumSize.width - menuBarMargins.horizontal() - statusSizeLarge.width,\n        exact: false\n      }); // layout tabItemsBar\n\n      tabArea.htmlComp.setBounds(new Rectangle(clientArea.x + tabAreaMargins.left, insets.top + tabAreaMargins.top, tabAreaPrefSize.width, clientArea.height - tabAreaMargins.vertical()));\n      menuBar.htmlComp.layout.collapsed = tabArea.htmlComp.layout.overflowTabs.length > 0; // layout menuBar\n\n      menuBar.htmlComp.setBounds(new Rectangle(left + tabAreaPrefSize.width + tabAreaMargins.horizontal() + menuBarMargins.left, insets.top + menuBarMargins.top, clientArea.width - tabAreaPrefSize.width - tabAreaMargins.horizontal() - menuBarMargins.horizontal() - statusSizeLarge.width, clientArea.height - menuBarMargins.vertical())); // layout status\n\n      if (this.tabBoxHeader.tabBox.statusPosition === FormField.StatusPosition.TOP && $status && $status.isVisible()) {\n        $status.cssWidth(this.fieldStatusWidth).cssRight(insets.left).cssHeight(clientArea.height - graphics.margins($status).vertical()).cssLineHeight(clientArea.height - graphics.margins($status).vertical());\n      }\n    }\n  }, {\n    key: \"preferredLayoutSize\",\n    value: function preferredLayoutSize($container, options) {\n      var htmlContainer = HtmlComponent.get($container),\n          insets = htmlContainer.insets(),\n          wHint = (options.widthHint || htmlContainer.availableSize().width) - htmlContainer.insets().horizontal(),\n          prefSize = new Dimension(),\n          $status = this.tabBoxHeader.tabBox.$status,\n          statusSizeLarge = new Dimension(),\n          tabArea = this.tabBoxHeader.tabArea,\n          tabAreaMargins = tabArea.htmlComp.margins(),\n          tabAreaPrefSize,\n          menuBar = this.tabBoxHeader.menuBar,\n          menuBarMargins = menuBar.htmlComp.margins(),\n          menuBarMinumumSize,\n          menuBarPrefSize;\n      menuBarMinumumSize = menuBar.htmlComp.prefSize({\n        widthHint: 0\n      });\n\n      if (this.tabBoxHeader.tabBox.statusPosition === FormField.StatusPosition.TOP && $status && $status.isVisible()) {\n        statusSizeLarge.height = $status.outerHeight(true);\n        statusSizeLarge.width = this.fieldStatusWidth + graphics.margins($status).horizontal();\n        prefSize.width += statusSizeLarge.width;\n        prefSize.height = Math.max(prefSize.height, statusSizeLarge.height);\n      }\n\n      tabAreaPrefSize = tabArea.htmlComp.prefSize({\n        widthHint: wHint - menuBarMinumumSize.width - menuBarMargins.horizontal() - tabAreaMargins.horizontal() - statusSizeLarge.width\n      });\n      prefSize.width += tabAreaPrefSize.width + tabAreaMargins.horizontal();\n      prefSize.height = Math.max(prefSize.height, tabAreaPrefSize.height + tabAreaMargins.vertical());\n      menuBarPrefSize = menuBar.htmlComp.prefSize({\n        widthHint: wHint - tabAreaPrefSize.width - tabAreaMargins.horizontal() - menuBarMargins.horizontal() - statusSizeLarge.width\n      });\n      prefSize.width += menuBarPrefSize.width + menuBarMargins.horizontal();\n      prefSize.height = Math.max(prefSize.height, menuBarPrefSize.height + menuBarMargins.vertical());\n      return prefSize.add(insets);\n    }\n  }]);\n\n  return TabBoxHeaderLayout;\n}(AbstractLayout);\n\nexport { TabBoxHeaderLayout as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/form/fields/tabbox/TabBoxHeaderLayout.js"],"names":["AbstractLayout","Dimension","FormField","graphics","HtmlComponent","HtmlEnvironment","Rectangle","TabBoxHeaderLayout","tabBoxHeader","_initDefaults","htmlPropertyChangeHandler","_onHtmlEnvironmenPropertyChange","bind","get","on","one","off","fieldStatusWidth","invalidateLayoutTree","$container","htmlContainer","tabArea","tabAreaMargins","htmlComp","margins","tabAreaPrefSize","menuBar","menuBarMargins","menuBarMinumumSize","$status","tabBox","statusSizeLarge","insets","containerSize","availableSize","exact","subtract","clientArea","left","top","width","height","x","prefSize","widthHint","statusPosition","StatusPosition","TOP","isVisible","outerHeight","horizontal","setBounds","vertical","layout","collapsed","overflowTabs","length","cssWidth","cssRight","cssHeight","cssLineHeight","options","wHint","menuBarPrefSize","Math","max","add"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2014-2017 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {AbstractLayout, Dimension, FormField, graphics, HtmlComponent, HtmlEnvironment, Rectangle} from '../../../index';\n\nexport default class TabBoxHeaderLayout extends AbstractLayout {\n\n  constructor(tabBoxHeader) {\n    super();\n    this.tabBoxHeader = tabBoxHeader;\n\n    this._initDefaults();\n\n    this.htmlPropertyChangeHandler = this._onHtmlEnvironmenPropertyChange.bind(this);\n    HtmlEnvironment.get().on('propertyChange', this.htmlPropertyChangeHandler);\n    this.tabBoxHeader.one('remove', function() {\n      HtmlEnvironment.get().off('propertyChange', this.htmlPropertyChangeHandler);\n    }.bind(this));\n  }\n\n  _initDefaults() {\n    this.fieldStatusWidth = HtmlEnvironment.get().fieldStatusWidth;\n  }\n\n  _onHtmlEnvironmenPropertyChange() {\n    this._initDefaults();\n    this.tabBoxHeader.invalidateLayoutTree();\n  }\n\n  layout($container) { //\n    var htmlContainer = HtmlComponent.get($container),\n      tabArea = this.tabBoxHeader.tabArea,\n      tabAreaMargins = tabArea.htmlComp.margins(),\n      tabAreaPrefSize,\n      menuBar = this.tabBoxHeader.menuBar,\n      menuBarMargins = menuBar.htmlComp.margins(),\n      menuBarMinumumSize,\n      $status = this.tabBoxHeader.tabBox.$status,\n      statusSizeLarge = new Dimension(),\n      insets = htmlContainer.insets(),\n      containerSize = htmlContainer.availableSize({\n        exact: true\n      }).subtract(htmlContainer.insets()),\n      clientArea = new Rectangle(insets.left, insets.top, containerSize.width, containerSize.height),\n      left = clientArea.x;\n\n    menuBarMinumumSize = menuBar.htmlComp.prefSize({\n      widthHint: 0\n    });\n\n    if (this.tabBoxHeader.tabBox.statusPosition === FormField.StatusPosition.TOP && $status && $status.isVisible()) {\n      statusSizeLarge.height = $status.outerHeight(true);\n      statusSizeLarge.width = this.fieldStatusWidth + graphics.margins($status).horizontal();\n    }\n\n    tabAreaPrefSize = tabArea.htmlComp.prefSize({\n      widthHint: clientArea.width - menuBarMinumumSize.width - menuBarMargins.horizontal() - statusSizeLarge.width,\n      exact: false\n    });\n\n    // layout tabItemsBar\n    tabArea.htmlComp.setBounds(new Rectangle(\n      clientArea.x + tabAreaMargins.left,\n      insets.top + tabAreaMargins.top,\n      tabAreaPrefSize.width,\n      clientArea.height - tabAreaMargins.vertical()\n    ));\n\n    menuBar.htmlComp.layout.collapsed = tabArea.htmlComp.layout.overflowTabs.length > 0;\n    // layout menuBar\n    menuBar.htmlComp.setBounds(new Rectangle(\n      left + tabAreaPrefSize.width + tabAreaMargins.horizontal() + menuBarMargins.left,\n      insets.top + menuBarMargins.top,\n      clientArea.width - tabAreaPrefSize.width - tabAreaMargins.horizontal() - menuBarMargins.horizontal() - statusSizeLarge.width,\n      clientArea.height - menuBarMargins.vertical()\n    ));\n\n    // layout status\n    if (this.tabBoxHeader.tabBox.statusPosition === FormField.StatusPosition.TOP && $status && $status.isVisible()) {\n      $status.cssWidth(this.fieldStatusWidth)\n        .cssRight(insets.left)\n        .cssHeight(clientArea.height - graphics.margins($status).vertical())\n        .cssLineHeight(clientArea.height - graphics.margins($status).vertical());\n    }\n\n  }\n\n  preferredLayoutSize($container, options) {\n    var htmlContainer = HtmlComponent.get($container),\n      insets = htmlContainer.insets(),\n      wHint = (options.widthHint || htmlContainer.availableSize().width) - htmlContainer.insets().horizontal(),\n      prefSize = new Dimension(),\n      $status = this.tabBoxHeader.tabBox.$status,\n      statusSizeLarge = new Dimension(),\n      tabArea = this.tabBoxHeader.tabArea,\n      tabAreaMargins = tabArea.htmlComp.margins(),\n      tabAreaPrefSize,\n      menuBar = this.tabBoxHeader.menuBar,\n      menuBarMargins = menuBar.htmlComp.margins(),\n      menuBarMinumumSize,\n      menuBarPrefSize;\n\n    menuBarMinumumSize = menuBar.htmlComp.prefSize({\n      widthHint: 0\n    });\n\n    if (this.tabBoxHeader.tabBox.statusPosition === FormField.StatusPosition.TOP && $status && $status.isVisible()) {\n      statusSizeLarge.height = $status.outerHeight(true);\n      statusSizeLarge.width = this.fieldStatusWidth + graphics.margins($status).horizontal();\n\n      prefSize.width += statusSizeLarge.width;\n      prefSize.height = Math.max(prefSize.height, statusSizeLarge.height);\n    }\n\n    tabAreaPrefSize = tabArea.htmlComp.prefSize({\n      widthHint: wHint - menuBarMinumumSize.width - menuBarMargins.horizontal() - tabAreaMargins.horizontal() - statusSizeLarge.width\n    });\n\n    prefSize.width += tabAreaPrefSize.width + tabAreaMargins.horizontal();\n    prefSize.height = Math.max(prefSize.height, tabAreaPrefSize.height + tabAreaMargins.vertical());\n\n    menuBarPrefSize = menuBar.htmlComp.prefSize({\n      widthHint: wHint - tabAreaPrefSize.width - tabAreaMargins.horizontal() - menuBarMargins.horizontal() - statusSizeLarge.width\n    });\n\n    prefSize.width += menuBarPrefSize.width + menuBarMargins.horizontal();\n    prefSize.height = Math.max(prefSize.height, menuBarPrefSize.height + menuBarMargins.vertical());\n\n    return prefSize.add(insets);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
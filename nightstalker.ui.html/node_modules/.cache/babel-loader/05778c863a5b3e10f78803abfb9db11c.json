{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/*\n * Copyright (c) 2014-2020 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { ModelAdapter } from '../index';\n\nvar DesktopAdapter = /*#__PURE__*/function (_ModelAdapter) {\n  _inherits(DesktopAdapter, _ModelAdapter);\n\n  var _super = _createSuper(DesktopAdapter);\n\n  function DesktopAdapter() {\n    var _this;\n\n    _classCallCheck(this, DesktopAdapter);\n\n    _this = _super.call(this);\n\n    _this._addRemoteProperties(['benchVisible', 'navigationVisible', 'navigationHandleVisible', 'headerVisible', 'geolocationServiceAvailable', 'inBackground']);\n\n    return _this;\n  }\n\n  _createClass(DesktopAdapter, [{\n    key: \"_goOffline\",\n    value: function _goOffline() {\n      this.widget.goOffline();\n    }\n  }, {\n    key: \"_goOnline\",\n    value: function _goOnline() {\n      this.widget.goOnline();\n    }\n  }, {\n    key: \"_onWidgetHistoryEntryActivate\",\n    value: function _onWidgetHistoryEntryActivate(event) {\n      this._send('historyEntryActivate', {\n        deepLinkPath: event.deepLinkPath\n      });\n    }\n  }, {\n    key: \"_onWidgetFormActivate\",\n    value: function _onWidgetFormActivate(event) {\n      if (event.form && !event.form.modelAdapter) {\n        return; // Ignore ScoutJS forms\n      }\n\n      this._sendFormActivate(event.form);\n    }\n  }, {\n    key: \"_sendFormActivate\",\n    value: function _sendFormActivate(form) {\n      var eventData = {\n        formId: form ? form.modelAdapter.id : null\n      };\n\n      this._send('formActivate', eventData, {\n        coalesce: function coalesce(previous) {\n          // Do not coalesce if formId was set to null by the previous event,\n          // this is the only way the server knows that the desktop was brought to front\n          return this.target === previous.target && this.type === previous.type && !(previous.formId === null && this.formId !== null);\n        }\n      });\n    }\n  }, {\n    key: \"_logoAction\",\n    value: function _logoAction(event) {\n      this._send('logoAction');\n    }\n  }, {\n    key: \"_onWidgetEvent\",\n    value: function _onWidgetEvent(event) {\n      if (event.type === 'formActivate') {\n        this._onWidgetFormActivate(event);\n      } else if (event.type === 'historyEntryActivate') {\n        this._onWidgetHistoryEntryActivate(event);\n      } else if (event.type === 'logoAction') {\n        this._logoAction(event);\n      } else if (event.type === 'cancelForms') {\n        this._onWidgetCancelAllForms(event);\n      } else {\n        _get(_getPrototypeOf(DesktopAdapter.prototype), \"_onWidgetEvent\", this).call(this, event);\n      }\n    }\n  }, {\n    key: \"_onFormShow\",\n    value: function _onFormShow(event) {\n      var form,\n          displayParent = this.session.getModelAdapter(event.displayParent);\n\n      if (displayParent) {\n        form = this.session.getOrCreateWidget(event.form, displayParent.widget);\n        form.setDisplayParent(displayParent.widget);\n        var hasPendingFormActivateEvent = this.session.asyncEvents.some(function (event) {\n          return event.type === 'formActivate' && event.target === this.id;\n        }, this);\n\n        if (!hasPendingFormActivateEvent) {\n          this.addFilterForWidgetEvent(function (widgetEvent) {\n            return widgetEvent.type === 'formActivate' && widgetEvent.form === form;\n          });\n        }\n\n        this.widget.showForm(form, event.position);\n      }\n    }\n  }, {\n    key: \"_onFormHide\",\n    value: function _onFormHide(event) {\n      var form,\n          displayParent = this.session.getModelAdapter(event.displayParent);\n\n      if (displayParent) {\n        form = this.session.getModelAdapter(event.form);\n        this.widget.hideForm(form.widget);\n      }\n    }\n  }, {\n    key: \"_onFormActivate\",\n    value: function _onFormActivate(event) {\n      var form = this.session.getWidget(event.form);\n      this.widget.activateForm(form);\n    }\n  }, {\n    key: \"_onWidgetCancelAllForms\",\n    value: function _onWidgetCancelAllForms(event) {\n      event.preventDefault();\n      var formIds = [];\n\n      if (event.forms) {\n        formIds = event.forms.map(function (form) {\n          return form.modelAdapter.id;\n        });\n      }\n\n      this._send('cancelForms', {\n        formIds: formIds\n      });\n    }\n  }, {\n    key: \"_onMessageBoxShow\",\n    value: function _onMessageBoxShow(event) {\n      var messageBox,\n          displayParent = this.session.getModelAdapter(event.displayParent);\n\n      if (displayParent) {\n        messageBox = this.session.getOrCreateWidget(event.messageBox, displayParent.widget);\n        messageBox.setDisplayParent(displayParent.widget);\n        displayParent.widget.messageBoxController.registerAndRender(messageBox);\n      }\n    }\n  }, {\n    key: \"_onMessageBoxHide\",\n    value: function _onMessageBoxHide(event) {\n      var messageBox,\n          displayParent = this.session.getModelAdapter(event.displayParent);\n\n      if (displayParent) {\n        messageBox = this.session.getModelAdapter(event.messageBox);\n        displayParent.widget.messageBoxController.unregisterAndRemove(messageBox.widget);\n      }\n    }\n  }, {\n    key: \"_onFileChooserShow\",\n    value: function _onFileChooserShow(event) {\n      var fileChooser,\n          displayParent = this.session.getModelAdapter(event.displayParent);\n\n      if (displayParent) {\n        fileChooser = this.session.getOrCreateWidget(event.fileChooser, displayParent.widget);\n        fileChooser.setDisplayParent(displayParent.widget);\n        displayParent.widget.fileChooserController.registerAndRender(fileChooser);\n      }\n    }\n  }, {\n    key: \"_onFileChooserHide\",\n    value: function _onFileChooserHide(event) {\n      var fileChooser,\n          displayParent = this.session.getModelAdapter(event.displayParent);\n\n      if (displayParent) {\n        fileChooser = this.session.getModelAdapter(event.fileChooser);\n        displayParent.widget.fileChooserController.unregisterAndRemove(fileChooser.widget);\n      }\n    }\n  }, {\n    key: \"_onOpenUri\",\n    value: function _onOpenUri(event) {\n      this.widget.openUri(event.uri, event.action);\n    }\n  }, {\n    key: \"_onOutlineChanged\",\n    value: function _onOutlineChanged(event) {\n      var outline = this.session.getOrCreateWidget(event.outline, this.widget);\n      this.widget.setOutline(outline);\n    }\n  }, {\n    key: \"_onAddNotification\",\n    value: function _onAddNotification(event) {\n      var notification = this.session.getOrCreateWidget(event.notification, this.widget);\n      this.widget.addNotification(notification);\n    }\n  }, {\n    key: \"_onRemoveNotification\",\n    value: function _onRemoveNotification(event) {\n      this.widget.removeNotification(event.notification);\n    }\n  }, {\n    key: \"_onOutlineContentActivate\",\n    value: function _onOutlineContentActivate(event) {\n      this.widget.bringOutlineToFront();\n    }\n  }, {\n    key: \"_onRequestGeolocation\",\n    value: function _onRequestGeolocation(event) {\n      if (navigator.geolocation) {\n        var success = function (position) {\n          this._send('geolocationDetermined', {\n            latitude: position.coords.latitude,\n            longitude: position.coords.longitude\n          });\n        }.bind(this);\n\n        var error = function (error) {\n          this._send('geolocationDetermined', {\n            errorCode: error.code,\n            errorMessage: error.message\n          });\n        }.bind(this);\n\n        navigator.geolocation.getCurrentPosition(success, error);\n      }\n    }\n  }, {\n    key: \"onModelAction\",\n    value: function onModelAction(event) {\n      if (event.type === 'formShow') {\n        this._onFormShow(event);\n      } else if (event.type === 'formHide') {\n        this._onFormHide(event);\n      } else if (event.type === 'formActivate') {\n        this._onFormActivate(event);\n      } else if (event.type === 'messageBoxShow') {\n        this._onMessageBoxShow(event);\n      } else if (event.type === 'messageBoxHide') {\n        this._onMessageBoxHide(event);\n      } else if (event.type === 'fileChooserShow') {\n        this._onFileChooserShow(event);\n      } else if (event.type === 'fileChooserHide') {\n        this._onFileChooserHide(event);\n      } else if (event.type === 'openUri') {\n        this._onOpenUri(event);\n      } else if (event.type === 'outlineChanged') {\n        this._onOutlineChanged(event);\n      } else if (event.type === 'outlineContentActivate') {\n        this._onOutlineContentActivate(event);\n      } else if (event.type === 'addNotification') {\n        this._onAddNotification(event);\n      } else if (event.type === 'removeNotification') {\n        this._onRemoveNotification(event);\n      } else if (event.type === 'requestGeolocation') {\n        this._onRequestGeolocation(event);\n      } else {\n        _get(_getPrototypeOf(DesktopAdapter.prototype), \"onModelAction\", this).call(this, event);\n      }\n    }\n  }]);\n\n  return DesktopAdapter;\n}(ModelAdapter);\n\nexport { DesktopAdapter as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/desktop/DesktopAdapter.js"],"names":["ModelAdapter","DesktopAdapter","_addRemoteProperties","widget","goOffline","goOnline","event","_send","deepLinkPath","form","modelAdapter","_sendFormActivate","eventData","formId","id","coalesce","previous","target","type","_onWidgetFormActivate","_onWidgetHistoryEntryActivate","_logoAction","_onWidgetCancelAllForms","displayParent","session","getModelAdapter","getOrCreateWidget","setDisplayParent","hasPendingFormActivateEvent","asyncEvents","some","addFilterForWidgetEvent","widgetEvent","showForm","position","hideForm","getWidget","activateForm","preventDefault","formIds","forms","map","messageBox","messageBoxController","registerAndRender","unregisterAndRemove","fileChooser","fileChooserController","openUri","uri","action","outline","setOutline","notification","addNotification","removeNotification","bringOutlineToFront","navigator","geolocation","success","latitude","coords","longitude","bind","error","errorCode","code","errorMessage","message","getCurrentPosition","_onFormShow","_onFormHide","_onFormActivate","_onMessageBoxShow","_onMessageBoxHide","_onFileChooserShow","_onFileChooserHide","_onOpenUri","_onOutlineChanged","_onOutlineContentActivate","_onAddNotification","_onRemoveNotification","_onRequestGeolocation"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2014-2020 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {ModelAdapter} from '../index';\n\nexport default class DesktopAdapter extends ModelAdapter {\n\n  constructor() {\n    super();\n    this._addRemoteProperties(['benchVisible', 'navigationVisible', 'navigationHandleVisible', 'headerVisible', 'geolocationServiceAvailable', 'inBackground']);\n  }\n\n  _goOffline() {\n    this.widget.goOffline();\n  }\n\n  _goOnline() {\n    this.widget.goOnline();\n  }\n\n  _onWidgetHistoryEntryActivate(event) {\n    this._send('historyEntryActivate', {\n      deepLinkPath: event.deepLinkPath\n    });\n  }\n\n  _onWidgetFormActivate(event) {\n    if (event.form && !event.form.modelAdapter) {\n      return; // Ignore ScoutJS forms\n    }\n    this._sendFormActivate(event.form);\n  }\n\n  _sendFormActivate(form) {\n    var eventData = {\n      formId: form ? form.modelAdapter.id : null\n    };\n\n    this._send('formActivate', eventData, {\n      coalesce: function(previous) {\n        // Do not coalesce if formId was set to null by the previous event,\n        // this is the only way the server knows that the desktop was brought to front\n        return this.target === previous.target && this.type === previous.type &&\n          !(previous.formId === null && this.formId !== null);\n      }\n    });\n  }\n\n  _logoAction(event) {\n    this._send('logoAction');\n  }\n\n  _onWidgetEvent(event) {\n    if (event.type === 'formActivate') {\n      this._onWidgetFormActivate(event);\n    } else if (event.type === 'historyEntryActivate') {\n      this._onWidgetHistoryEntryActivate(event);\n    } else if (event.type === 'logoAction') {\n      this._logoAction(event);\n    } else if (event.type === 'cancelForms') {\n      this._onWidgetCancelAllForms(event);\n    } else {\n      super._onWidgetEvent(event);\n    }\n  }\n\n  _onFormShow(event) {\n    var form,\n      displayParent = this.session.getModelAdapter(event.displayParent);\n\n    if (displayParent) {\n      form = this.session.getOrCreateWidget(event.form, displayParent.widget);\n      form.setDisplayParent(displayParent.widget);\n\n      var hasPendingFormActivateEvent = this.session.asyncEvents.some(function(event) {\n        return event.type === 'formActivate' && event.target === this.id;\n      }, this);\n      if (!hasPendingFormActivateEvent) {\n        this.addFilterForWidgetEvent(function(widgetEvent) {\n          return (widgetEvent.type === 'formActivate' && widgetEvent.form === form);\n        });\n      }\n\n      this.widget.showForm(form, event.position);\n    }\n  }\n\n  _onFormHide(event) {\n    var form,\n      displayParent = this.session.getModelAdapter(event.displayParent);\n\n    if (displayParent) {\n      form = this.session.getModelAdapter(event.form);\n      this.widget.hideForm(form.widget);\n    }\n  }\n\n  _onFormActivate(event) {\n    var form = this.session.getWidget(event.form);\n    this.widget.activateForm(form);\n  }\n\n  _onWidgetCancelAllForms(event) {\n    event.preventDefault();\n    var formIds = [];\n    if (event.forms) {\n      formIds = event.forms.map(function(form) {\n        return form.modelAdapter.id;\n      });\n    }\n    this._send('cancelForms', {\n      formIds: formIds\n    });\n  }\n\n  _onMessageBoxShow(event) {\n    var messageBox,\n      displayParent = this.session.getModelAdapter(event.displayParent);\n\n    if (displayParent) {\n      messageBox = this.session.getOrCreateWidget(event.messageBox, displayParent.widget);\n      messageBox.setDisplayParent(displayParent.widget);\n      displayParent.widget.messageBoxController.registerAndRender(messageBox);\n    }\n  }\n\n  _onMessageBoxHide(event) {\n    var messageBox,\n      displayParent = this.session.getModelAdapter(event.displayParent);\n\n    if (displayParent) {\n      messageBox = this.session.getModelAdapter(event.messageBox);\n      displayParent.widget.messageBoxController.unregisterAndRemove(messageBox.widget);\n    }\n  }\n\n  _onFileChooserShow(event) {\n    var fileChooser,\n      displayParent = this.session.getModelAdapter(event.displayParent);\n\n    if (displayParent) {\n      fileChooser = this.session.getOrCreateWidget(event.fileChooser, displayParent.widget);\n      fileChooser.setDisplayParent(displayParent.widget);\n      displayParent.widget.fileChooserController.registerAndRender(fileChooser);\n    }\n  }\n\n  _onFileChooserHide(event) {\n    var fileChooser,\n      displayParent = this.session.getModelAdapter(event.displayParent);\n\n    if (displayParent) {\n      fileChooser = this.session.getModelAdapter(event.fileChooser);\n      displayParent.widget.fileChooserController.unregisterAndRemove(fileChooser.widget);\n    }\n  }\n\n  _onOpenUri(event) {\n    this.widget.openUri(event.uri, event.action);\n  }\n\n  _onOutlineChanged(event) {\n    var outline = this.session.getOrCreateWidget(event.outline, this.widget);\n    this.widget.setOutline(outline);\n  }\n\n  _onAddNotification(event) {\n    var notification = this.session.getOrCreateWidget(event.notification, this.widget);\n    this.widget.addNotification(notification);\n  }\n\n  _onRemoveNotification(event) {\n    this.widget.removeNotification(event.notification);\n  }\n\n  _onOutlineContentActivate(event) {\n    this.widget.bringOutlineToFront();\n  }\n\n  _onRequestGeolocation(event) {\n    if (navigator.geolocation) {\n      var success = function(position) {\n        this._send('geolocationDetermined', {\n          latitude: position.coords.latitude,\n          longitude: position.coords.longitude\n        });\n      }.bind(this);\n      var error = function(error) {\n        this._send('geolocationDetermined', {\n          errorCode: error.code,\n          errorMessage: error.message\n        });\n      }.bind(this);\n      navigator.geolocation.getCurrentPosition(success, error);\n    }\n  }\n\n  onModelAction(event) {\n    if (event.type === 'formShow') {\n      this._onFormShow(event);\n    } else if (event.type === 'formHide') {\n      this._onFormHide(event);\n    } else if (event.type === 'formActivate') {\n      this._onFormActivate(event);\n    } else if (event.type === 'messageBoxShow') {\n      this._onMessageBoxShow(event);\n    } else if (event.type === 'messageBoxHide') {\n      this._onMessageBoxHide(event);\n    } else if (event.type === 'fileChooserShow') {\n      this._onFileChooserShow(event);\n    } else if (event.type === 'fileChooserHide') {\n      this._onFileChooserHide(event);\n    } else if (event.type === 'openUri') {\n      this._onOpenUri(event);\n    } else if (event.type === 'outlineChanged') {\n      this._onOutlineChanged(event);\n    } else if (event.type === 'outlineContentActivate') {\n      this._onOutlineContentActivate(event);\n    } else if (event.type === 'addNotification') {\n      this._onAddNotification(event);\n    } else if (event.type === 'removeNotification') {\n      this._onRemoveNotification(event);\n    } else if (event.type === 'requestGeolocation') {\n      this._onRequestGeolocation(event);\n    } else {\n      super.onModelAction(event);\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
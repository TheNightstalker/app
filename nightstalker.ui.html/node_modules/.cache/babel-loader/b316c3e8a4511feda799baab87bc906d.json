{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/*\n * Copyright (c) 2014-2017 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { Device, FormField, HtmlComponent, HtmlEnvironment, scout, Status, strings, tooltips, Widget } from '../../../index';\n\nvar Tab = /*#__PURE__*/function (_Widget) {\n  _inherits(Tab, _Widget);\n\n  var _super = _createSuper(Tab);\n\n  function Tab() {\n    var _this;\n\n    _classCallCheck(this, Tab);\n\n    _this = _super.call(this);\n    _this.label = null;\n    _this.subLabel = null;\n    _this.selected = false;\n    _this.overflown = false;\n    _this._preventTabSelection = false;\n    _this.$label = null;\n    _this.$subLabel = null;\n    _this._tabPropertyChangeHandler = _this._onTabPropertyChange.bind(_assertThisInitialized(_this));\n    _this._statusMouseDownHandler = _this._onStatusMouseDown.bind(_assertThisInitialized(_this));\n    _this._desktopPropertyChangeHandler = _this._onDesktopPropertyChange.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Tab, [{\n    key: \"_init\",\n    value: function _init(options) {\n      _get(_getPrototypeOf(Tab.prototype), \"_init\", this).call(this, options);\n\n      this.visible = this.tabItem.visible;\n      this.label = this.tabItem.label;\n      this.subLabel = this.tabItem.subLabel;\n      this.cssClass = this.tabItem.cssClass;\n      this.marked = this.tabItem.marked;\n      this.tooltipText = this.tabItem.tooltipText;\n      this.fieldStatus = scout.create('FieldStatus', {\n        parent: this,\n        visible: false\n      });\n      this.fieldStatus.on('statusMouseDown', this._statusMouseDownHandler);\n      this.tabItem.on('propertyChange', this._tabPropertyChangeHandler);\n    }\n  }, {\n    key: \"_destroy\",\n    value: function _destroy() {\n      _get(_getPrototypeOf(Tab.prototype), \"_destroy\", this).call(this);\n\n      this.tabItem.off('propertyChange', this._tabPropertyChangeHandler);\n      this.fieldStatus.off('statusMouseDown', this._statusMouseDownHandler);\n    }\n  }, {\n    key: \"_render\",\n    value: function _render() {\n      this.$container = this.$parent.appendDiv('tab-item');\n      this.htmlComp = HtmlComponent.install(this.$container, this.session);\n      this.$title = this.$container.appendDiv('title');\n      this.$label = this.$title.appendDiv('label');\n      tooltips.installForEllipsis(this.$label, {\n        parent: this\n      });\n      this.$subLabel = this.$title.appendDiv('sub-label');\n      tooltips.installForEllipsis(this.$subLabel, {\n        parent: this\n      });\n      this.fieldStatus.render();\n      this.fieldStatus.$container.cssWidth(HtmlEnvironment.get().fieldStatusWidth);\n      this.$container.on('mousedown', this._onTabMouseDown.bind(this));\n      this.session.desktop.on('propertyChange', this._desktopPropertyChangeHandler);\n    }\n  }, {\n    key: \"_renderProperties\",\n    value: function _renderProperties() {\n      _get(_getPrototypeOf(Tab.prototype), \"_renderProperties\", this).call(this);\n\n      this._renderVisible();\n\n      this._renderLabel();\n\n      this._renderSubLabel();\n\n      this._renderTabbable();\n\n      this._renderSelected();\n\n      this._renderMarked();\n\n      this._renderOverflown();\n\n      this._renderTooltipText();\n\n      this._renderErrorStatus();\n    }\n  }, {\n    key: \"_renderVisible\",\n    value: function _renderVisible() {\n      _get(_getPrototypeOf(Tab.prototype), \"_renderVisible\", this).call(this);\n\n      this._updateStatus();\n    }\n  }, {\n    key: \"setLabel\",\n    value: function setLabel(label) {\n      this.setProperty('label', label);\n    }\n  }, {\n    key: \"_renderLabel\",\n    value: function _renderLabel(label) {\n      this.$label.textOrNbsp(this.label);\n      this.invalidateLayoutTree();\n    }\n  }, {\n    key: \"setSubLabel\",\n    value: function setSubLabel(subLabel) {\n      this.setProperty('subLabel', subLabel);\n    }\n  }, {\n    key: \"_renderSubLabel\",\n    value: function _renderSubLabel() {\n      this.$subLabel.textOrNbsp(this.subLabel);\n      this.invalidateLayoutTree();\n    }\n  }, {\n    key: \"setTooltipText\",\n    value: function setTooltipText(tooltipText) {\n      this.setProperty('tooltipText', tooltipText);\n    }\n  }, {\n    key: \"_renderTooltipText\",\n    value: function _renderTooltipText() {\n      this.$container.toggleClass('has-tooltip', strings.hasText(this.tooltipText));\n\n      this._updateStatus();\n    }\n  }, {\n    key: \"setErrorStatus\",\n    value: function setErrorStatus(errorStatus) {\n      this.setProperty('errorStatus', errorStatus);\n    }\n  }, {\n    key: \"_renderErrorStatus\",\n    value: function _renderErrorStatus() {\n      var hasStatus = !!this.errorStatus,\n          statusClass = hasStatus ? 'has-' + this.errorStatus.cssClass() : '';\n\n      this._updateErrorStatusClasses(statusClass, hasStatus);\n\n      this._updateStatus();\n    }\n  }, {\n    key: \"_updateErrorStatusClasses\",\n    value: function _updateErrorStatusClasses(statusClass, hasStatus) {\n      this.$container.removeClass(FormField.SEVERITY_CSS_CLASSES);\n      this.$container.addClass(statusClass, hasStatus);\n    }\n  }, {\n    key: \"_updateStatus\",\n    value: function _updateStatus() {\n      var visible = this._computeVisible(),\n          status = null,\n          autoRemove = true,\n          initialShow = false;\n\n      this.fieldStatus.setVisible(visible);\n\n      if (!visible) {\n        return;\n      }\n\n      if (this.errorStatus) {\n        status = this.errorStatus;\n        autoRemove = !status.isError();\n        initialShow = true;\n      } else {\n        status = scout.create('Status', {\n          message: this.tooltipText,\n          severity: Status.Severity.OK\n        });\n      }\n\n      this.fieldStatus.update(status, null, autoRemove, initialShow);\n    }\n  }, {\n    key: \"_computeVisible\",\n    value: function _computeVisible() {\n      return this.visible && !this.overflown && (this.errorStatus || strings.hasText(this.tooltipText));\n    }\n  }, {\n    key: \"setTabbable\",\n    value: function setTabbable(tabbable) {\n      this.setProperty('tabbable', tabbable);\n    }\n  }, {\n    key: \"_renderTabbable\",\n    value: function _renderTabbable() {\n      this.$container.setTabbable(this.tabbable && !Device.get().supportsOnlyTouch());\n    }\n  }, {\n    key: \"select\",\n    value: function select() {\n      this.setSelected(true);\n    }\n  }, {\n    key: \"setSelected\",\n    value: function setSelected(selected) {\n      this.setProperty('selected', selected);\n    }\n  }, {\n    key: \"_renderSelected\",\n    value: function _renderSelected() {\n      this.$container.select(this.selected);\n      this.$container.setTabbable(this.selected && !Device.get().supportsOnlyTouch());\n    }\n  }, {\n    key: \"setMarked\",\n    value: function setMarked(marked) {\n      this.setProperty('marked', marked);\n    }\n  }, {\n    key: \"_renderMarked\",\n    value: function _renderMarked(marked) {\n      this.$container.toggleClass('marked', this.marked);\n    }\n  }, {\n    key: \"setOverflown\",\n    value: function setOverflown(overflown) {\n      this.setProperty('overflown', overflown);\n    }\n  }, {\n    key: \"_renderOverflown\",\n    value: function _renderOverflown() {\n      this.$container.toggleClass('overflown', this.overflown);\n\n      this._updateStatus();\n    }\n  }, {\n    key: \"_remove\",\n    value: function _remove() {\n      this.session.desktop.off('propertyChange', this._desktopPropertyChangeHandler);\n\n      _get(_getPrototypeOf(Tab.prototype), \"_remove\", this).call(this);\n    }\n  }, {\n    key: \"_onDesktopPropertyChange\",\n    value: function _onDesktopPropertyChange(event) {\n      // switching from or to the dense mode requires clearing of the tab's htmlComponent prefSize cache.\n      if (event.propertyName === 'dense') {\n        this.invalidateLayout();\n      }\n    }\n  }, {\n    key: \"_onTabMouseDown\",\n    value: function _onTabMouseDown(event) {\n      if (this._preventTabSelection) {\n        this._preventTabSelection = false;\n        return;\n      } // ensure to focus the selected tab before selecting the new tab.\n      // The selection of a tab will remove the content of the previous selected tab.\n      // Problem: If the previous is the focus owner the focus will be transfered to body what ends in a scroll top.\n\n\n      this.setTabbable(true);\n      this.$container.focus();\n      this.select(); // When the tab is clicked the user wants to execute the action and not see the tooltip\n\n      if (this.$label) {\n        tooltips.cancel(this.$label);\n        tooltips.close(this.$label);\n      }\n\n      if (this.$subLabel) {\n        tooltips.cancel(this.$subLabel);\n        tooltips.close(this.$subLabel);\n      }\n    }\n  }, {\n    key: \"_onStatusMouseDown\",\n    value: function _onStatusMouseDown(event) {\n      // Prevent switching tabs when status gets clicked\n      // Don't use event.preventDefault, otherwise other mouse listener (like tooltip mouse down) will not be executed as well\n      this._preventTabSelection = true; // Prevent focusing the tab\n\n      event.preventDefault();\n    }\n  }, {\n    key: \"_onTabPropertyChange\",\n    value: function _onTabPropertyChange(event) {\n      if (event.propertyName === 'visible') {\n        this.setVisible(event.newValue);\n      } else if (event.propertyName === 'label') {\n        this.setLabel(this.tabItem.label);\n      } else if (event.propertyName === 'subLabel') {\n        this.setSubLabel(this.tabItem.subLabel);\n      } else if (event.propertyName === 'cssClass') {\n        this.setCssClass(this.tabItem.cssClass);\n      } else if (event.propertyName === 'marked') {\n        this.setMarked(this.tabItem.marked);\n      } else if (event.propertyName === 'errorStatus') {\n        this.setErrorStatus(event.newValue);\n      } else if (event.propertyName === 'tooltipText') {\n        this.setTooltipText(event.newValue);\n      }\n    }\n  }]);\n\n  return Tab;\n}(Widget);\n\nexport { Tab as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/form/fields/tabbox/Tab.js"],"names":["Device","FormField","HtmlComponent","HtmlEnvironment","scout","Status","strings","tooltips","Widget","Tab","label","subLabel","selected","overflown","_preventTabSelection","$label","$subLabel","_tabPropertyChangeHandler","_onTabPropertyChange","bind","_statusMouseDownHandler","_onStatusMouseDown","_desktopPropertyChangeHandler","_onDesktopPropertyChange","options","visible","tabItem","cssClass","marked","tooltipText","fieldStatus","create","parent","on","off","$container","$parent","appendDiv","htmlComp","install","session","$title","installForEllipsis","render","cssWidth","get","fieldStatusWidth","_onTabMouseDown","desktop","_renderVisible","_renderLabel","_renderSubLabel","_renderTabbable","_renderSelected","_renderMarked","_renderOverflown","_renderTooltipText","_renderErrorStatus","_updateStatus","setProperty","textOrNbsp","invalidateLayoutTree","toggleClass","hasText","errorStatus","hasStatus","statusClass","_updateErrorStatusClasses","removeClass","SEVERITY_CSS_CLASSES","addClass","_computeVisible","status","autoRemove","initialShow","setVisible","isError","message","severity","Severity","OK","update","tabbable","setTabbable","supportsOnlyTouch","setSelected","select","event","propertyName","invalidateLayout","focus","cancel","close","preventDefault","newValue","setLabel","setSubLabel","setCssClass","setMarked","setErrorStatus","setTooltipText"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2014-2017 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {Device, FormField, HtmlComponent, HtmlEnvironment, scout, Status, strings, tooltips, Widget} from '../../../index';\n\nexport default class Tab extends Widget {\n\n  constructor() {\n    super();\n\n    this.label = null;\n    this.subLabel = null;\n    this.selected = false;\n    this.overflown = false;\n    this._preventTabSelection = false;\n\n    this.$label = null;\n    this.$subLabel = null;\n    this._tabPropertyChangeHandler = this._onTabPropertyChange.bind(this);\n    this._statusMouseDownHandler = this._onStatusMouseDown.bind(this);\n    this._desktopPropertyChangeHandler = this._onDesktopPropertyChange.bind(this);\n  }\n\n  _init(options) {\n    super._init(options);\n    this.visible = this.tabItem.visible;\n    this.label = this.tabItem.label;\n    this.subLabel = this.tabItem.subLabel;\n    this.cssClass = this.tabItem.cssClass;\n    this.marked = this.tabItem.marked;\n    this.tooltipText = this.tabItem.tooltipText;\n\n    this.fieldStatus = scout.create('FieldStatus', {\n      parent: this,\n      visible: false\n    });\n    this.fieldStatus.on('statusMouseDown', this._statusMouseDownHandler);\n\n    this.tabItem.on('propertyChange', this._tabPropertyChangeHandler);\n  }\n\n  _destroy() {\n    super._destroy();\n    this.tabItem.off('propertyChange', this._tabPropertyChangeHandler);\n    this.fieldStatus.off('statusMouseDown', this._statusMouseDownHandler);\n  }\n\n  _render() {\n    this.$container = this.$parent.appendDiv('tab-item');\n    this.htmlComp = HtmlComponent.install(this.$container, this.session);\n    this.$title = this.$container.appendDiv('title');\n    this.$label = this.$title.appendDiv('label');\n    tooltips.installForEllipsis(this.$label, {\n      parent: this\n    });\n\n    this.$subLabel = this.$title.appendDiv('sub-label');\n    tooltips.installForEllipsis(this.$subLabel, {\n      parent: this\n    });\n\n    this.fieldStatus.render();\n    this.fieldStatus.$container.cssWidth(HtmlEnvironment.get().fieldStatusWidth);\n\n    this.$container.on('mousedown', this._onTabMouseDown.bind(this));\n    this.session.desktop.on('propertyChange', this._desktopPropertyChangeHandler);\n  }\n\n  _renderProperties() {\n    super._renderProperties();\n    this._renderVisible();\n    this._renderLabel();\n    this._renderSubLabel();\n    this._renderTabbable();\n    this._renderSelected();\n    this._renderMarked();\n    this._renderOverflown();\n    this._renderTooltipText();\n    this._renderErrorStatus();\n  }\n\n  _renderVisible() {\n    super._renderVisible();\n    this._updateStatus();\n  }\n\n  setLabel(label) {\n    this.setProperty('label', label);\n  }\n\n  _renderLabel(label) {\n    this.$label.textOrNbsp(this.label);\n    this.invalidateLayoutTree();\n  }\n\n  setSubLabel(subLabel) {\n    this.setProperty('subLabel', subLabel);\n  }\n\n  _renderSubLabel() {\n    this.$subLabel.textOrNbsp(this.subLabel);\n    this.invalidateLayoutTree();\n  }\n\n  setTooltipText(tooltipText) {\n    this.setProperty('tooltipText', tooltipText);\n  }\n\n  _renderTooltipText() {\n    this.$container.toggleClass('has-tooltip', strings.hasText(this.tooltipText));\n    this._updateStatus();\n  }\n\n  setErrorStatus(errorStatus) {\n    this.setProperty('errorStatus', errorStatus);\n  }\n\n  _renderErrorStatus() {\n    var hasStatus = !!this.errorStatus,\n      statusClass = hasStatus ? 'has-' + this.errorStatus.cssClass() : '';\n    this._updateErrorStatusClasses(statusClass, hasStatus);\n    this._updateStatus();\n  }\n\n  _updateErrorStatusClasses(statusClass, hasStatus) {\n    this.$container.removeClass(FormField.SEVERITY_CSS_CLASSES);\n    this.$container.addClass(statusClass, hasStatus);\n  }\n\n  _updateStatus() {\n    var visible = this._computeVisible(),\n      status = null,\n      autoRemove = true,\n      initialShow = false;\n    this.fieldStatus.setVisible(visible);\n    if (!visible) {\n      return;\n    }\n    if (this.errorStatus) {\n      status = this.errorStatus;\n      autoRemove = !status.isError();\n      initialShow = true;\n    } else {\n      status = scout.create('Status', {\n        message: this.tooltipText,\n        severity: Status.Severity.OK\n      });\n    }\n    this.fieldStatus.update(status, null, autoRemove, initialShow);\n  }\n\n  _computeVisible() {\n    return this.visible && !this.overflown && (this.errorStatus || strings.hasText(this.tooltipText));\n  }\n\n  setTabbable(tabbable) {\n    this.setProperty('tabbable', tabbable);\n  }\n\n  _renderTabbable() {\n    this.$container.setTabbable(this.tabbable && !Device.get().supportsOnlyTouch());\n  }\n\n  select() {\n    this.setSelected(true);\n  }\n\n  setSelected(selected) {\n    this.setProperty('selected', selected);\n  }\n\n  _renderSelected() {\n    this.$container.select(this.selected);\n    this.$container.setTabbable(this.selected && !Device.get().supportsOnlyTouch());\n  }\n\n  setMarked(marked) {\n    this.setProperty('marked', marked);\n  }\n\n  _renderMarked(marked) {\n    this.$container.toggleClass('marked', this.marked);\n  }\n\n  setOverflown(overflown) {\n    this.setProperty('overflown', overflown);\n  }\n\n  _renderOverflown() {\n    this.$container.toggleClass('overflown', this.overflown);\n    this._updateStatus();\n  }\n\n  _remove() {\n    this.session.desktop.off('propertyChange', this._desktopPropertyChangeHandler);\n    super._remove();\n  }\n\n  _onDesktopPropertyChange(event) {\n    // switching from or to the dense mode requires clearing of the tab's htmlComponent prefSize cache.\n    if (event.propertyName === 'dense') {\n      this.invalidateLayout();\n    }\n  }\n\n  _onTabMouseDown(event) {\n    if (this._preventTabSelection) {\n      this._preventTabSelection = false;\n      return;\n    }\n\n    // ensure to focus the selected tab before selecting the new tab.\n    // The selection of a tab will remove the content of the previous selected tab.\n    // Problem: If the previous is the focus owner the focus will be transfered to body what ends in a scroll top.\n    this.setTabbable(true);\n    this.$container.focus();\n\n    this.select();\n\n    // When the tab is clicked the user wants to execute the action and not see the tooltip\n    if (this.$label) {\n      tooltips.cancel(this.$label);\n      tooltips.close(this.$label);\n    }\n    if (this.$subLabel) {\n      tooltips.cancel(this.$subLabel);\n      tooltips.close(this.$subLabel);\n    }\n  }\n\n  _onStatusMouseDown(event) {\n    // Prevent switching tabs when status gets clicked\n    // Don't use event.preventDefault, otherwise other mouse listener (like tooltip mouse down) will not be executed as well\n    this._preventTabSelection = true;\n    // Prevent focusing the tab\n    event.preventDefault();\n  }\n\n  _onTabPropertyChange(event) {\n    if (event.propertyName === 'visible') {\n      this.setVisible(event.newValue);\n    } else if (event.propertyName === 'label') {\n      this.setLabel(this.tabItem.label);\n    } else if (event.propertyName === 'subLabel') {\n      this.setSubLabel(this.tabItem.subLabel);\n    } else if (event.propertyName === 'cssClass') {\n      this.setCssClass(this.tabItem.cssClass);\n    } else if (event.propertyName === 'marked') {\n      this.setMarked(this.tabItem.marked);\n    } else if (event.propertyName === 'errorStatus') {\n      this.setErrorStatus(event.newValue);\n    } else if (event.propertyName === 'tooltipText') {\n      this.setTooltipText(event.newValue);\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
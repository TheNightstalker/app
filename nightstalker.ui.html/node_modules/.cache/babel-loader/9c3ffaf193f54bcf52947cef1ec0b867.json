{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { AbortKeyStroke, BoxButtons, ClickActiveElementKeyStroke, clipboard, CopyKeyStroke, Device, FocusAdjacentElementKeyStroke, FocusRule, Form, GlassPaneRenderer, HtmlComponent, keys, KeyStrokeContext, MessageBoxLayout, objects, Status, strings, Widget } from '../index';\n\nvar MessageBox = /*#__PURE__*/function (_Widget) {\n  _inherits(MessageBox, _Widget);\n\n  var _super = _createSuper(MessageBox);\n\n  function MessageBox() {\n    var _this;\n\n    _classCallCheck(this, MessageBox);\n\n    _this = _super.call(this);\n    _this.severity = null;\n    _this.body = null;\n    _this.cancelButtonText = null;\n    _this.header = null;\n    _this.hiddenText = null;\n    _this.html = null;\n    _this.noButtonText = null;\n    _this.yesButtonText = null;\n    _this.$content = null;\n    _this.$header = null;\n    _this.$body = null;\n    _this.$buttons = null;\n    _this.$yesButton = null;\n    _this.$noButton = null;\n    _this.$cancelButton = null;\n    _this._$abortButton = null;\n    _this.displayParent = null;\n    return _this;\n  }\n\n  _createClass(MessageBox, [{\n    key: \"_init\",\n    value: function _init(model) {\n      _get(_getPrototypeOf(MessageBox.prototype), \"_init\", this).call(this, model);\n\n      this._setDisplayParent(this.displayParent);\n    }\n    /**\n     * @override\n     */\n\n  }, {\n    key: \"_createKeyStrokeContext\",\n    value: function _createKeyStrokeContext() {\n      return new KeyStrokeContext();\n    }\n    /**\n     * @override\n     */\n\n  }, {\n    key: \"_initKeyStrokeContext\",\n    value: function _initKeyStrokeContext() {\n      _get(_getPrototypeOf(MessageBox.prototype), \"_initKeyStrokeContext\", this).call(this);\n\n      this.keyStrokeContext.registerKeyStroke([new CopyKeyStroke(this), new FocusAdjacentElementKeyStroke(this.session, this), new ClickActiveElementKeyStroke(this, [keys.SPACE, keys.ENTER]), new AbortKeyStroke(this, function () {\n        return this._$abortButton;\n      }.bind(this))]);\n    }\n  }, {\n    key: \"_render\",\n    value: function _render() {\n      this.$container = this.$parent.appendDiv('messagebox').on('mousedown', this._onMouseDown.bind(this)).on('copy', this._onCopy.bind(this));\n      var $handle = this.$container.appendDiv('drag-handle');\n      this.$container.draggable($handle);\n      this.$content = this.$container.appendDiv('messagebox-content');\n      this.$header = this.$content.appendDiv('messagebox-label messagebox-header');\n      this.$body = this.$content.appendDiv('messagebox-label messagebox-body');\n      this.$html = this.$content.appendDiv('messagebox-label messagebox-html prevent-initial-focus');\n      this.$buttons = this.$container.appendDiv('messagebox-buttons').on('copy', this._onCopy.bind(this));\n      var boxButtons = new BoxButtons(this.$buttons, this._onButtonClick.bind(this));\n      this._$abortButton = null; // button to be executed when abort() is called, e.g. when ESCAPE is pressed\n\n      if (this.yesButtonText) {\n        this.$yesButton = boxButtons.addButton({\n          text: this.yesButtonText,\n          option: MessageBox.Buttons.YES\n        });\n        this._$abortButton = this.$yesButton;\n      }\n\n      if (this.noButtonText) {\n        this.$noButton = boxButtons.addButton({\n          text: this.noButtonText,\n          option: MessageBox.Buttons.NO\n        });\n        this._$abortButton = this.$noButton;\n      }\n\n      if (this.cancelButtonText) {\n        this.$cancelButton = boxButtons.addButton({\n          text: this.cancelButtonText,\n          option: MessageBox.Buttons.CANCEL\n        });\n        this._$abortButton = this.$cancelButton;\n      }\n\n      this._installScrollbars({\n        axis: 'y'\n      }); // Render properties\n\n\n      this._renderIconId();\n\n      this._renderSeverity();\n\n      this._renderHeader();\n\n      this._renderBody();\n\n      this._renderHtml();\n\n      this._renderHiddenText(); // Prevent resizing when message-box is dragged off the viewport\n\n\n      this.$container.addClass('calc-helper');\n      var naturalWidth = this.$container.width();\n      this.$container.removeClass('calc-helper');\n      this.$container.css('min-width', Math.max(naturalWidth, boxButtons.buttonCount() * 100));\n      boxButtons.updateButtonWidths(this.$container.width());\n      this.htmlComp = HtmlComponent.install(this.$container, this.session);\n      this.htmlComp.setLayout(new MessageBoxLayout(this));\n      this.htmlComp.validateLayout();\n      this.$container.addClassForAnimation('animate-open');\n      this.$container.select(); // Render modality glasspanes\n\n      this._glassPaneRenderer = new GlassPaneRenderer(this);\n\n      this._glassPaneRenderer.renderGlassPanes();\n    }\n  }, {\n    key: \"get$Scrollable\",\n    value: function get$Scrollable() {\n      return this.$content;\n    }\n  }, {\n    key: \"_postRender\",\n    value: function _postRender() {\n      _get(_getPrototypeOf(MessageBox.prototype), \"_postRender\", this).call(this);\n\n      this._installFocusContext();\n    }\n  }, {\n    key: \"_remove\",\n    value: function _remove() {\n      this._glassPaneRenderer.removeGlassPanes();\n\n      this._uninstallFocusContext();\n\n      _get(_getPrototypeOf(MessageBox.prototype), \"_remove\", this).call(this);\n    }\n  }, {\n    key: \"_installFocusContext\",\n    value: function _installFocusContext() {\n      this.session.focusManager.installFocusContext(this.$container, FocusRule.AUTO);\n    }\n  }, {\n    key: \"_uninstallFocusContext\",\n    value: function _uninstallFocusContext() {\n      this.session.focusManager.uninstallFocusContext(this.$container);\n    }\n  }, {\n    key: \"_renderIconId\",\n    value: function _renderIconId() {// TODO [7.0] bsh: implement\n    }\n  }, {\n    key: \"_renderSeverity\",\n    value: function _renderSeverity() {\n      this.$container.removeClass('severity-error');\n\n      if (this.severity === Status.Severity.ERROR) {\n        this.$container.addClass('severity-error');\n      }\n    }\n  }, {\n    key: \"_renderHeader\",\n    value: function _renderHeader() {\n      this.$header.html(strings.nl2br(this.header));\n      this.$header.setVisible(this.header);\n    }\n  }, {\n    key: \"_renderBody\",\n    value: function _renderBody() {\n      this.$body.html(strings.nl2br(this.body));\n      this.$body.setVisible(this.body);\n    }\n  }, {\n    key: \"_renderHtml\",\n    value: function _renderHtml() {\n      this.$html.html(this.html);\n      this.$html.setVisible(this.html); // Don't change focus when a link is clicked by mouse\n\n      this.$html.find('a, .app-link').attr('tabindex', '0').unfocusable();\n    }\n  }, {\n    key: \"_renderHiddenText\",\n    value: function _renderHiddenText() {\n      if (this.$hiddenText) {\n        this.$hiddenText.remove();\n      }\n\n      if (this.hiddenText) {\n        this.$hiddenText = this.$content.appendElement('<!-- \\n' + this.hiddenText.replace(/<!--|-->/g, '') + '\\n -->');\n      }\n    }\n  }, {\n    key: \"_onMouseDown\",\n    value: function _onMouseDown() {\n      // If there is a dialog in the parent-hierarchy activate it in order to bring it on top of other dialogs.\n      var parent = this.findParent(function (p) {\n        return p instanceof Form && p.isDialog();\n      });\n\n      if (parent) {\n        parent.activate();\n      }\n    }\n  }, {\n    key: \"_setCopyable\",\n    value: function _setCopyable(copyable) {\n      this.$header.toggleClass('copyable', copyable);\n      this.$body.toggleClass('copyable', copyable);\n      this.$html.toggleClass('copyable', copyable);\n    }\n  }, {\n    key: \"copy\",\n    value: function copy() {\n      this._setCopyable(true);\n\n      var myDocument = this.$container.document(true);\n      var range = myDocument.createRange();\n      range.selectNodeContents(this.$content[0]);\n      var selection = this.$container.window(true).getSelection();\n      selection.removeAllRanges();\n      selection.addRange(range);\n      myDocument.execCommand('copy');\n    }\n  }, {\n    key: \"_onCopy\",\n    value: function _onCopy(event) {\n      var ie = Device.get().isInternetExplorer();\n      var clipboardData = ie ? this.$container.window(true).clipboardData : objects.optProperty(event, 'originalEvent', 'clipboardData');\n\n      if (clipboardData) {\n        // Internet Explorer only allows plain text (which must have data-type 'Text')\n        if (!ie) {\n          var htmlText = strings.join('<br/>', this.$header[0].outerHTML, this.$body[0].outerHTML, this.$html[0].outerHTML, this.hiddenText);\n          clipboardData.setData('text/html', htmlText);\n        }\n\n        var dataType = ie ? 'Text' : 'text/plain';\n        var plainText = strings.join('\\n\\n', this.$header.text(), this.$body.text(), this.$html.text(), this.hiddenText);\n        clipboardData.setData(dataType, plainText);\n        this.$container.window(true).getSelection().removeAllRanges();\n\n        this._setCopyable(false);\n\n        clipboard.showNotification(this);\n        event.preventDefault(); // We want to write our data to the clipboard, not data from any user selection\n      } // else: do default\n\n    }\n  }, {\n    key: \"_onButtonClick\",\n    value: function _onButtonClick(event, option) {\n      this.trigger('action', {\n        option: option\n      });\n    }\n  }, {\n    key: \"setDisplayParent\",\n    value: function setDisplayParent(displayParent) {\n      this.setProperty('displayParent', displayParent);\n    }\n  }, {\n    key: \"_setDisplayParent\",\n    value: function _setDisplayParent(displayParent) {\n      this._setProperty('displayParent', displayParent);\n\n      if (displayParent) {\n        this.setParent(this.findDesktop().computeParentForDisplayParent(displayParent));\n      }\n    }\n    /**\n     * Renders the message box and links it with the display parent.\n     */\n\n  }, {\n    key: \"open\",\n    value: function open() {\n      this.setDisplayParent(this.displayParent || this.session.desktop);\n      this.displayParent.messageBoxController.registerAndRender(this);\n    }\n    /**\n     * Destroys the message box and unlinks it from the display parent.\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      if (this.displayParent) {\n        this.displayParent.messageBoxController.unregisterAndRemove(this);\n      }\n\n      this.destroy();\n    }\n    /**\n     * Aborts the message box by using the default abort button. Used by the ESC key stroke.\n     */\n\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      if (this._$abortButton && this.session.focusManager.requestFocus(this._$abortButton)) {\n        this._$abortButton.click();\n      }\n    }\n    /**\n     * @override Widget.js\n     */\n\n  }, {\n    key: \"_attach\",\n    value: function _attach() {\n      this.$parent.append(this.$container);\n\n      _get(_getPrototypeOf(MessageBox.prototype), \"_attach\", this).call(this);\n    }\n    /**\n     * @override Widget.js\n     */\n\n  }, {\n    key: \"_detach\",\n    value: function _detach() {\n      this.$container.detach();\n\n      _get(_getPrototypeOf(MessageBox.prototype), \"_detach\", this).call(this);\n    }\n  }]);\n\n  return MessageBox;\n}(Widget);\n\n_defineProperty(MessageBox, \"Buttons\", {\n  YES: 'yes',\n  NO: 'no',\n  CANCEL: 'cancel'\n});\n\nexport { MessageBox as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/messagebox/MessageBox.js"],"names":["AbortKeyStroke","BoxButtons","ClickActiveElementKeyStroke","clipboard","CopyKeyStroke","Device","FocusAdjacentElementKeyStroke","FocusRule","Form","GlassPaneRenderer","HtmlComponent","keys","KeyStrokeContext","MessageBoxLayout","objects","Status","strings","Widget","MessageBox","severity","body","cancelButtonText","header","hiddenText","html","noButtonText","yesButtonText","$content","$header","$body","$buttons","$yesButton","$noButton","$cancelButton","_$abortButton","displayParent","model","_setDisplayParent","keyStrokeContext","registerKeyStroke","session","SPACE","ENTER","bind","$container","$parent","appendDiv","on","_onMouseDown","_onCopy","$handle","draggable","$html","boxButtons","_onButtonClick","addButton","text","option","Buttons","YES","NO","CANCEL","_installScrollbars","axis","_renderIconId","_renderSeverity","_renderHeader","_renderBody","_renderHtml","_renderHiddenText","addClass","naturalWidth","width","removeClass","css","Math","max","buttonCount","updateButtonWidths","htmlComp","install","setLayout","validateLayout","addClassForAnimation","select","_glassPaneRenderer","renderGlassPanes","_installFocusContext","removeGlassPanes","_uninstallFocusContext","focusManager","installFocusContext","AUTO","uninstallFocusContext","Severity","ERROR","nl2br","setVisible","find","attr","unfocusable","$hiddenText","remove","appendElement","replace","parent","findParent","p","isDialog","activate","copyable","toggleClass","_setCopyable","myDocument","document","range","createRange","selectNodeContents","selection","window","getSelection","removeAllRanges","addRange","execCommand","event","ie","get","isInternetExplorer","clipboardData","optProperty","htmlText","join","outerHTML","setData","dataType","plainText","showNotification","preventDefault","trigger","setProperty","_setProperty","setParent","findDesktop","computeParentForDisplayParent","setDisplayParent","desktop","messageBoxController","registerAndRender","unregisterAndRemove","destroy","requestFocus","click","append","detach"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {\n  AbortKeyStroke,\n  BoxButtons,\n  ClickActiveElementKeyStroke,\n  clipboard,\n  CopyKeyStroke,\n  Device,\n  FocusAdjacentElementKeyStroke,\n  FocusRule,\n  Form,\n  GlassPaneRenderer,\n  HtmlComponent,\n  keys,\n  KeyStrokeContext,\n  MessageBoxLayout,\n  objects,\n  Status,\n  strings,\n  Widget\n} from '../index';\n\nexport default class MessageBox extends Widget {\n\n  constructor() {\n    super();\n\n    this.severity = null;\n    this.body = null;\n    this.cancelButtonText = null;\n    this.header = null;\n    this.hiddenText = null;\n    this.html = null;\n    this.noButtonText = null;\n    this.yesButtonText = null;\n    this.$content = null;\n    this.$header = null;\n    this.$body = null;\n    this.$buttons = null;\n    this.$yesButton = null;\n    this.$noButton = null;\n    this.$cancelButton = null;\n    this._$abortButton = null;\n    this.displayParent = null;\n  }\n\n  static Buttons = {\n    YES: 'yes',\n    NO: 'no',\n    CANCEL: 'cancel'\n  };\n\n  _init(model) {\n    super._init(model);\n    this._setDisplayParent(this.displayParent);\n  }\n\n  /**\n   * @override\n   */\n  _createKeyStrokeContext() {\n    return new KeyStrokeContext();\n  }\n\n  /**\n   * @override\n   */\n  _initKeyStrokeContext() {\n    super._initKeyStrokeContext();\n\n    this.keyStrokeContext.registerKeyStroke([\n      new CopyKeyStroke(this),\n      new FocusAdjacentElementKeyStroke(this.session, this),\n      new ClickActiveElementKeyStroke(this, [\n        keys.SPACE, keys.ENTER\n      ]),\n      new AbortKeyStroke(this, function() {\n        return this._$abortButton;\n      }.bind(this))\n    ]);\n  }\n\n  _render() {\n    this.$container = this.$parent.appendDiv('messagebox')\n      .on('mousedown', this._onMouseDown.bind(this))\n      .on('copy', this._onCopy.bind(this));\n\n    var $handle = this.$container.appendDiv('drag-handle');\n    this.$container.draggable($handle);\n\n    this.$content = this.$container.appendDiv('messagebox-content');\n    this.$header = this.$content.appendDiv('messagebox-label messagebox-header');\n    this.$body = this.$content.appendDiv('messagebox-label messagebox-body');\n    this.$html = this.$content.appendDiv('messagebox-label messagebox-html prevent-initial-focus');\n    this.$buttons = this.$container.appendDiv('messagebox-buttons')\n      .on('copy', this._onCopy.bind(this));\n\n    var boxButtons = new BoxButtons(this.$buttons, this._onButtonClick.bind(this));\n    this._$abortButton = null; // button to be executed when abort() is called, e.g. when ESCAPE is pressed\n    if (this.yesButtonText) {\n      this.$yesButton = boxButtons.addButton({\n        text: this.yesButtonText,\n        option: MessageBox.Buttons.YES\n      });\n      this._$abortButton = this.$yesButton;\n    }\n    if (this.noButtonText) {\n      this.$noButton = boxButtons.addButton({\n        text: this.noButtonText,\n        option: MessageBox.Buttons.NO\n      });\n      this._$abortButton = this.$noButton;\n    }\n    if (this.cancelButtonText) {\n      this.$cancelButton = boxButtons.addButton({\n        text: this.cancelButtonText,\n        option: MessageBox.Buttons.CANCEL\n      });\n      this._$abortButton = this.$cancelButton;\n    }\n\n    this._installScrollbars({\n      axis: 'y'\n    });\n\n    // Render properties\n    this._renderIconId();\n    this._renderSeverity();\n    this._renderHeader();\n    this._renderBody();\n    this._renderHtml();\n    this._renderHiddenText();\n\n    // Prevent resizing when message-box is dragged off the viewport\n    this.$container.addClass('calc-helper');\n    var naturalWidth = this.$container.width();\n    this.$container.removeClass('calc-helper');\n    this.$container.css('min-width', Math.max(naturalWidth, boxButtons.buttonCount() * 100));\n    boxButtons.updateButtonWidths(this.$container.width());\n\n    this.htmlComp = HtmlComponent.install(this.$container, this.session);\n    this.htmlComp.setLayout(new MessageBoxLayout(this));\n    this.htmlComp.validateLayout();\n\n    this.$container.addClassForAnimation('animate-open');\n    this.$container.select();\n\n    // Render modality glasspanes\n    this._glassPaneRenderer = new GlassPaneRenderer(this);\n    this._glassPaneRenderer.renderGlassPanes();\n  }\n\n  get$Scrollable() {\n    return this.$content;\n  }\n\n  _postRender() {\n    super._postRender();\n    this._installFocusContext();\n  }\n\n  _remove() {\n    this._glassPaneRenderer.removeGlassPanes();\n    this._uninstallFocusContext();\n    super._remove();\n  }\n\n  _installFocusContext() {\n    this.session.focusManager.installFocusContext(this.$container, FocusRule.AUTO);\n  }\n\n  _uninstallFocusContext() {\n    this.session.focusManager.uninstallFocusContext(this.$container);\n  }\n\n  _renderIconId() {\n    // TODO [7.0] bsh: implement\n  }\n\n  _renderSeverity() {\n    this.$container.removeClass('severity-error');\n    if (this.severity === Status.Severity.ERROR) {\n      this.$container.addClass('severity-error');\n    }\n  }\n\n  _renderHeader() {\n    this.$header.html(strings.nl2br(this.header));\n    this.$header.setVisible(this.header);\n  }\n\n  _renderBody() {\n    this.$body.html(strings.nl2br(this.body));\n    this.$body.setVisible(this.body);\n  }\n\n  _renderHtml() {\n    this.$html.html(this.html);\n    this.$html.setVisible(this.html);\n    // Don't change focus when a link is clicked by mouse\n    this.$html.find('a, .app-link')\n      .attr('tabindex', '0')\n      .unfocusable();\n  }\n\n  _renderHiddenText() {\n    if (this.$hiddenText) {\n      this.$hiddenText.remove();\n    }\n    if (this.hiddenText) {\n      this.$hiddenText = this.$content.appendElement('<!-- \\n' + this.hiddenText.replace(/<!--|-->/g, '') + '\\n -->');\n    }\n  }\n\n  _onMouseDown() {\n    // If there is a dialog in the parent-hierarchy activate it in order to bring it on top of other dialogs.\n    var parent = this.findParent(function(p) {\n      return p instanceof Form && p.isDialog();\n    });\n    if (parent) {\n      parent.activate();\n    }\n  }\n\n  _setCopyable(copyable) {\n    this.$header.toggleClass('copyable', copyable);\n    this.$body.toggleClass('copyable', copyable);\n    this.$html.toggleClass('copyable', copyable);\n  }\n\n  copy() {\n    this._setCopyable(true);\n    var myDocument = this.$container.document(true);\n    var range = myDocument.createRange();\n    range.selectNodeContents(this.$content[0]);\n    var selection = this.$container.window(true).getSelection();\n    selection.removeAllRanges();\n    selection.addRange(range);\n    myDocument.execCommand('copy');\n  }\n\n  _onCopy(event) {\n    var ie = Device.get().isInternetExplorer();\n    var clipboardData = ie ? this.$container.window(true).clipboardData : objects.optProperty(event, 'originalEvent', 'clipboardData');\n\n    if (clipboardData) {\n      // Internet Explorer only allows plain text (which must have data-type 'Text')\n      if (!ie) {\n        var htmlText = strings.join('<br/>',\n          this.$header[0].outerHTML,\n          this.$body[0].outerHTML,\n          this.$html[0].outerHTML,\n          this.hiddenText);\n        clipboardData.setData('text/html', htmlText);\n      }\n      var dataType = ie ? 'Text' : 'text/plain';\n      var plainText = strings.join('\\n\\n',\n        this.$header.text(),\n        this.$body.text(),\n        this.$html.text(),\n        this.hiddenText);\n      clipboardData.setData(dataType, plainText);\n      this.$container.window(true).getSelection().removeAllRanges();\n      this._setCopyable(false);\n      clipboard.showNotification(this);\n      event.preventDefault(); // We want to write our data to the clipboard, not data from any user selection\n    }\n    // else: do default\n  }\n\n  _onButtonClick(event, option) {\n    this.trigger('action', {\n      option: option\n    });\n  }\n\n  setDisplayParent(displayParent) {\n    this.setProperty('displayParent', displayParent);\n  }\n\n  _setDisplayParent(displayParent) {\n    this._setProperty('displayParent', displayParent);\n    if (displayParent) {\n      this.setParent(this.findDesktop().computeParentForDisplayParent(displayParent));\n    }\n  }\n\n  /**\n   * Renders the message box and links it with the display parent.\n   */\n  open() {\n    this.setDisplayParent(this.displayParent || this.session.desktop);\n    this.displayParent.messageBoxController.registerAndRender(this);\n  }\n\n  /**\n   * Destroys the message box and unlinks it from the display parent.\n   */\n  close() {\n    if (this.displayParent) {\n      this.displayParent.messageBoxController.unregisterAndRemove(this);\n    }\n    this.destroy();\n  }\n\n  /**\n   * Aborts the message box by using the default abort button. Used by the ESC key stroke.\n   */\n  abort() {\n    if (this._$abortButton && this.session.focusManager.requestFocus(this._$abortButton)) {\n      this._$abortButton.click();\n    }\n  }\n\n  /**\n   * @override Widget.js\n   */\n  _attach() {\n    this.$parent.append(this.$container);\n    super._attach();\n  }\n\n  /**\n   * @override Widget.js\n   */\n  _detach() {\n    this.$container.detach();\n    super._detach();\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
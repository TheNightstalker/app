{"ast":null,"code":"function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/*\n * Copyright (c) 2010-2019 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { arrays, dragAndDrop } from '../index';\nimport $ from 'jquery';\n\nvar DragAndDropHandler = /*#__PURE__*/function () {\n  function DragAndDropHandler(options) {\n    _classCallCheck(this, DragAndDropHandler);\n\n    options = options || {};\n    this.additionalDropProperties = null;\n    this.allowedTypes = null;\n    this.dropMaximumSize = null;\n    this.target = null;\n    $.extend(this, options);\n    this.supportedScoutTypes = arrays.ensure(options.supportedScoutTypes);\n    this._onDragEnterHandler = this._onDragEnter.bind(this);\n    this._onDragOverHandler = this._onDragOver.bind(this);\n    this._onDropHandler = this._onDrop.bind(this);\n  }\n\n  _createClass(DragAndDropHandler, [{\n    key: \"install\",\n    value: function install($element, selector) {\n      if (this.$element) {\n        throw new Error('Already installed.');\n      }\n\n      this.selector = selector;\n      this.$element = $element;\n      this.$element.on('dragenter', this.selector, this._onDragEnterHandler).on('dragover', this.selector, this._onDragOverHandler).on('drop', this.selector, this._onDropHandler);\n    }\n  }, {\n    key: \"uninstall\",\n    value: function uninstall() {\n      this.$element.off('dragenter', this.selector, this._onDragEnterHandler).off('dragover', this.selector, this._onDragOverHandler).off('drop', this.selector, this._onDropHandler);\n      this.$element = null;\n      this.selector = null;\n    }\n  }, {\n    key: \"_onDragEnter\",\n    value: function _onDragEnter(event) {\n      this._onDragEnterOrOver(event);\n    }\n  }, {\n    key: \"_onDragOver\",\n    value: function _onDragOver(event) {\n      this._onDragEnterOrOver(event);\n    }\n  }, {\n    key: \"_onDragEnterOrOver\",\n    value: function _onDragEnterOrOver(event) {\n      // set dropEffect to copy. otherwise outlook will move dropped mails into the deleted files folder.\n      // see: https://bugs.chromium.org/p/chromium/issues/detail?id=322605#c33\n      event.originalEvent.dataTransfer.dropEffect = 'copy';\n      dragAndDrop.verifyDataTransferTypesScoutTypes(event, this.supportedScoutTypes, this.dropType());\n    }\n  }, {\n    key: \"_onDrop\",\n    value: function _onDrop(event) {\n      if (this.supportedScoutTypes.indexOf(dragAndDrop.SCOUT_TYPES.FILE_TRANSFER) >= 0 && (this.dropType() & dragAndDrop.SCOUT_TYPES.FILE_TRANSFER) === dragAndDrop.SCOUT_TYPES.FILE_TRANSFER && // NOSONAR\n      dragAndDrop.dataTransferTypesContainsScoutTypes(event.originalEvent.dataTransfer, dragAndDrop.SCOUT_TYPES.FILE_TRANSFER)) {\n        event.stopPropagation();\n        event.preventDefault();\n        var files = event.originalEvent.dataTransfer.files;\n\n        if (files.length >= 1) {\n          this.target.session.uploadFiles(this.target, files, this.additionalDropProperties ? this.additionalDropProperties(event) : undefined, this.dropMaximumSize ? this.dropMaximumSize() : undefined, this.allowedTypes ? this.allowedTypes() : undefined);\n        }\n      }\n    }\n  }]);\n\n  return DragAndDropHandler;\n}();\n\nexport { DragAndDropHandler as default };","map":{"version":3,"sources":["C:/Tools/workspace/nightstalker/nightstalker.ui.html/node_modules/@eclipse-scout/core/src/util/DragAndDropHandler.js"],"names":["arrays","dragAndDrop","$","DragAndDropHandler","options","additionalDropProperties","allowedTypes","dropMaximumSize","target","extend","supportedScoutTypes","ensure","_onDragEnterHandler","_onDragEnter","bind","_onDragOverHandler","_onDragOver","_onDropHandler","_onDrop","$element","selector","Error","on","off","event","_onDragEnterOrOver","originalEvent","dataTransfer","dropEffect","verifyDataTransferTypesScoutTypes","dropType","indexOf","SCOUT_TYPES","FILE_TRANSFER","dataTransferTypesContainsScoutTypes","stopPropagation","preventDefault","files","length","session","uploadFiles","undefined"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2010-2019 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {arrays, dragAndDrop} from '../index';\nimport $ from 'jquery';\n\nexport default class DragAndDropHandler {\n\n  constructor(options) {\n    options = options || {};\n    this.additionalDropProperties = null;\n    this.allowedTypes = null;\n    this.dropMaximumSize = null;\n    this.target = null;\n\n    $.extend(this, options);\n    this.supportedScoutTypes = arrays.ensure(options.supportedScoutTypes);\n    this._onDragEnterHandler = this._onDragEnter.bind(this);\n    this._onDragOverHandler = this._onDragOver.bind(this);\n    this._onDropHandler = this._onDrop.bind(this);\n  }\n\n  install($element, selector) {\n    if (this.$element) {\n      throw new Error('Already installed.');\n    }\n    this.selector = selector;\n    this.$element = $element;\n    this.$element.on('dragenter', this.selector, this._onDragEnterHandler)\n      .on('dragover', this.selector, this._onDragOverHandler)\n      .on('drop', this.selector, this._onDropHandler);\n  }\n\n  uninstall() {\n    this.$element.off('dragenter', this.selector, this._onDragEnterHandler)\n      .off('dragover', this.selector, this._onDragOverHandler)\n      .off('drop', this.selector, this._onDropHandler);\n    this.$element = null;\n    this.selector = null;\n  }\n\n  _onDragEnter(event) {\n    this._onDragEnterOrOver(event);\n  }\n\n  _onDragOver(event) {\n    this._onDragEnterOrOver(event);\n  }\n\n  _onDragEnterOrOver(event) {\n    // set dropEffect to copy. otherwise outlook will move dropped mails into the deleted files folder.\n    // see: https://bugs.chromium.org/p/chromium/issues/detail?id=322605#c33\n    event.originalEvent.dataTransfer.dropEffect = 'copy';\n    dragAndDrop.verifyDataTransferTypesScoutTypes(event, this.supportedScoutTypes, this.dropType());\n  }\n\n  _onDrop(event) {\n    if (this.supportedScoutTypes.indexOf(dragAndDrop.SCOUT_TYPES.FILE_TRANSFER) >= 0 &&\n      (this.dropType() & dragAndDrop.SCOUT_TYPES.FILE_TRANSFER) === dragAndDrop.SCOUT_TYPES.FILE_TRANSFER && // NOSONAR\n      dragAndDrop.dataTransferTypesContainsScoutTypes(event.originalEvent.dataTransfer, dragAndDrop.SCOUT_TYPES.FILE_TRANSFER)) {\n      event.stopPropagation();\n      event.preventDefault();\n\n      var files = event.originalEvent.dataTransfer.files;\n      if (files.length >= 1) {\n        this.target.session.uploadFiles(this.target, files,\n          this.additionalDropProperties ? this.additionalDropProperties(event) : undefined,\n          this.dropMaximumSize ? this.dropMaximumSize() : undefined,\n          this.allowedTypes ? this.allowedTypes() : undefined);\n      }\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("jQuery"));else if("function"==typeof define&&define.amd)define(["jQuery"],t);else{var n="object"==typeof exports?t(require("jQuery")):t(e.jQuery);for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(this,(function(e){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(t,n){t.exports=e},function(e,t,n){(function(e){var n,i,r,o;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){var i,r;i=[n(1)],void 0===(r=function(e){var t={},n=function(){return navigator.userAgent.toLowerCase().indexOf("chrome")>-1},i=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},r=function(){return navigator.userAgent.toLowerCase().indexOf("safari")>-1},o=function(){return document.documentMode&&document.documentMode>=11},s=function(){this.count=0,this.pending=[]};s.prototype.incr=function(){this.count++},s.prototype.decr=function(){this.count--,this.flush()},s.prototype.whenReady=function(e){this.pending.push(e),this.flush()},s.prototype.flush=function(){0===this.count&&(this.pending.forEach((function(e){e()})),this.pending=[])};var a=function(e){this.sem=new s,this.sync=e&&e.sync,this.mapForUri=e&&e.cacheGlobally?t:{}};a.prototype.ajax=function(e,t){var n=function(){for(var e=!1,t=0;t<d.length;t++){try{e=d[t]()}catch(e){continue}break}return e}(),i=this;n.onreadystatechange=function(){4==n.readyState&&t.call(i,n,e)},n.open("GET",e,!this.sync),n.send()},a.prototype.fetchScript=function(e){e in this.mapForUri||(this.sem.incr(),this.mapForUri[e]=null,this.ajax(e,this.onScriptLoad))};var u=new RegExp("^(?:[a-z]+:)?//","i");a.prototype.onScriptLoad=function(t,n){if(200===t.status||"file://"===n.slice(0,7)&&0===t.status){var i=t.responseText.match("//# [s]ourceMappingURL=(.*)[\\s]*$","m");if(i&&2===i.length){var r=i[1],o=r.match("data:application/json;(charset=[^;]+;)?base64,(.*)");if(o&&o[2])this.mapForUri[n]=new e.SourceMapConsumer(atob(o[2])),this.sem.decr();else{if(!u.test(r)){var s,a=n.lastIndexOf("/");-1!==a&&(s=n.slice(0,a+1),r=s+r)}this.ajax(r,(function(t){(200===t.status||"file://"===r.slice(0,7)&&0===t.status)&&(this.mapForUri[n]=new e.SourceMapConsumer(t.responseText)),this.sem.decr()}))}}else this.sem.decr()}else this.sem.decr()};var l=function(e,t,n,i){for(var r,o=[],s="chrome"===i?c:f,a=0;a<e.length;a++){var u=t[a];if(u){var l=u[1],d=parseInt(u[2],10),p=parseInt(u[3],10);if(r=n[l]){var y=r.originalPositionFor({line:d,column:p});o.push(h(y.source,y.line,y.column,y.name||s(e[a])))}else o.push(h(l,d,p,s(e[a])))}else o.push(e[a])}return o};function c(e){var t=/ +at +([^ ]*).*/.exec(e);return t&&t[1]}function f(e){var t=/([^@]*)@.*/.exec(e);return t&&t[1]}var h=function(e,t,n,i){return"    at "+(i||"(unknown)")+" ("+e+":"+t+":"+n+")"},d=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];return{mapStackTrace:function(e,t,s){var u,c,f,h,d,p,y,v={},b=new a(s),g=s&&s.traceFormat;if("chrome"!==g&&"firefox"!==g){if(g)throw new Error('unknown traceFormat "'+g+'" :(');if(n()||o())g="chrome";else{if(!i()&&!r())throw new Error("unknown browser :(");g="firefox"}}"chrome"===g?(p=/^ +at.+\((.*):([0-9]+):([0-9]+)/,d=4,y=1):(p=/@(.*):([0-9]+):([0-9]+)/,d=4,y=0),u=e.split("\n").slice(y);for(var m=0;m<u.length;m++)c=u[m],s&&s.filter&&!s.filter(c)||(f=c.match(p))&&f.length===d&&(v[m]=f,(h=f[1]).match(/<anonymous>/)||b.fetchScript(h));b.sem.whenReady((function(){var e=l(u,v,b.mapForUri,g);t(e)}))}}}.apply(t,i))||(e.exports=r)},function(e,t,n){var i=n(2),r=n(3),o=n(4).ArraySet,s=n(5),a=n(7).quickSort;function u(e){var t=e;return"string"==typeof e&&(t=JSON.parse(e.replace(/^\)\]\}'/,""))),null!=t.sections?new f(t):new l(t)}function l(e){var t=e;"string"==typeof e&&(t=JSON.parse(e.replace(/^\)\]\}'/,"")));var n=i.getArg(t,"version"),r=i.getArg(t,"sources"),s=i.getArg(t,"names",[]),a=i.getArg(t,"sourceRoot",null),u=i.getArg(t,"sourcesContent",null),l=i.getArg(t,"mappings"),c=i.getArg(t,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);r=r.map(String).map(i.normalize).map((function(e){return a&&i.isAbsolute(a)&&i.isAbsolute(e)?i.relative(a,e):e})),this._names=o.fromArray(s.map(String),!0),this._sources=o.fromArray(r,!0),this.sourceRoot=a,this.sourcesContent=u,this._mappings=l,this.file=c}function c(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function f(e){var t=e;"string"==typeof e&&(t=JSON.parse(e.replace(/^\)\]\}'/,"")));var n=i.getArg(t,"version"),r=i.getArg(t,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new o,this._names=new o;var s={line:-1,column:0};this._sections=r.map((function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var t=i.getArg(e,"offset"),n=i.getArg(t,"line"),r=i.getArg(t,"column");if(n<s.line||n===s.line&&r<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=t,{generatedOffset:{generatedLine:n+1,generatedColumn:r+1},consumer:new u(i.getArg(e,"map"))}}))}u.fromSourceMap=function(e){return l.fromSourceMap(e)},u.prototype._version=3,u.prototype.__generatedMappings=null,Object.defineProperty(u.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),u.prototype.__originalMappings=null,Object.defineProperty(u.prototype,"_originalMappings",{get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),u.prototype._charIsMappingSeparator=function(e,t){var n=e.charAt(t);return";"===n||","===n},u.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},u.GENERATED_ORDER=1,u.ORIGINAL_ORDER=2,u.GREATEST_LOWER_BOUND=1,u.LEAST_UPPER_BOUND=2,u.prototype.eachMapping=function(e,t,n){var r,o=t||null;switch(n||u.GENERATED_ORDER){case u.GENERATED_ORDER:r=this._generatedMappings;break;case u.ORIGINAL_ORDER:r=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var s=this.sourceRoot;r.map((function(e){var t=null===e.source?null:this._sources.at(e.source);return null!=t&&null!=s&&(t=i.join(s,t)),{source:t,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,o)},u.prototype.allGeneratedPositionsFor=function(e){var t=i.getArg(e,"line"),n={source:i.getArg(e,"source"),originalLine:t,originalColumn:i.getArg(e,"column",0)};if(null!=this.sourceRoot&&(n.source=i.relative(this.sourceRoot,n.source)),!this._sources.has(n.source))return[];n.source=this._sources.indexOf(n.source);var o=[],s=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions,r.LEAST_UPPER_BOUND);if(s>=0){var a=this._originalMappings[s];if(void 0===e.column)for(var u=a.originalLine;a&&a.originalLine===u;)o.push({line:i.getArg(a,"generatedLine",null),column:i.getArg(a,"generatedColumn",null),lastColumn:i.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++s];else for(var l=a.originalColumn;a&&a.originalLine===t&&a.originalColumn==l;)o.push({line:i.getArg(a,"generatedLine",null),column:i.getArg(a,"generatedColumn",null),lastColumn:i.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++s]}return o},t.SourceMapConsumer=u,l.prototype=Object.create(u.prototype),l.prototype.consumer=u,l.fromSourceMap=function(e){var t=Object.create(l.prototype),n=t._names=o.fromArray(e._names.toArray(),!0),r=t._sources=o.fromArray(e._sources.toArray(),!0);t.sourceRoot=e._sourceRoot,t.sourcesContent=e._generateSourcesContent(t._sources.toArray(),t.sourceRoot),t.file=e._file;for(var s=e._mappings.toArray().slice(),u=t.__generatedMappings=[],f=t.__originalMappings=[],h=0,d=s.length;h<d;h++){var p=s[h],y=new c;y.generatedLine=p.generatedLine,y.generatedColumn=p.generatedColumn,p.source&&(y.source=r.indexOf(p.source),y.originalLine=p.originalLine,y.originalColumn=p.originalColumn,p.name&&(y.name=n.indexOf(p.name)),f.push(y)),u.push(y)}return a(t.__originalMappings,i.compareByOriginalPositions),t},l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){return this._sources.toArray().map((function(e){return null!=this.sourceRoot?i.join(this.sourceRoot,e):e}),this)}}),l.prototype._parseMappings=function(e,t){for(var n,r,o,u,l,f=1,h=0,d=0,p=0,y=0,v=0,b=e.length,g=0,m={},_={},w=[],k=[];g<b;)if(";"===e.charAt(g))f++,g++,h=0;else if(","===e.charAt(g))g++;else{for((n=new c).generatedLine=f,u=g;u<b&&!this._charIsMappingSeparator(e,u);u++);if(o=m[r=e.slice(g,u)])g+=r.length;else{for(o=[];g<u;)s.decode(e,g,_),l=_.value,g=_.rest,o.push(l);if(2===o.length)throw new Error("Found a source, but no line and column");if(3===o.length)throw new Error("Found a source and line, but no column");m[r]=o}n.generatedColumn=h+o[0],h=n.generatedColumn,o.length>1&&(n.source=y+o[1],y+=o[1],n.originalLine=d+o[2],d=n.originalLine,n.originalLine+=1,n.originalColumn=p+o[3],p=n.originalColumn,o.length>4&&(n.name=v+o[4],v+=o[4])),k.push(n),"number"==typeof n.originalLine&&w.push(n)}a(k,i.compareByGeneratedPositionsDeflated),this.__generatedMappings=k,a(w,i.compareByOriginalPositions),this.__originalMappings=w},l.prototype._findMapping=function(e,t,n,i,o,s){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[i]);return r.search(e,t,o,s)},l.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(t.generatedLine===n.generatedLine){t.lastGeneratedColumn=n.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},l.prototype.originalPositionFor=function(e){var t={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},n=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",i.compareByGeneratedPositionsDeflated,i.getArg(e,"bias",u.GREATEST_LOWER_BOUND));if(n>=0){var r=this._generatedMappings[n];if(r.generatedLine===t.generatedLine){var o=i.getArg(r,"source",null);null!==o&&(o=this._sources.at(o),null!=this.sourceRoot&&(o=i.join(this.sourceRoot,o)));var s=i.getArg(r,"name",null);return null!==s&&(s=this._names.at(s)),{source:o,line:i.getArg(r,"originalLine",null),column:i.getArg(r,"originalColumn",null),name:s}}}return{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e}))},l.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;if(null!=this.sourceRoot&&(e=i.relative(this.sourceRoot,e)),this._sources.has(e))return this.sourcesContent[this._sources.indexOf(e)];var n;if(null!=this.sourceRoot&&(n=i.urlParse(this.sourceRoot))){var r=e.replace(/^file:\/\//,"");if("file"==n.scheme&&this._sources.has(r))return this.sourcesContent[this._sources.indexOf(r)];if((!n.path||"/"==n.path)&&this._sources.has("/"+e))return this.sourcesContent[this._sources.indexOf("/"+e)]}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(e){var t=i.getArg(e,"source");if(null!=this.sourceRoot&&(t=i.relative(this.sourceRoot,t)),!this._sources.has(t))return{line:null,column:null,lastColumn:null};var n={source:t=this._sources.indexOf(t),originalLine:i.getArg(e,"line"),originalColumn:i.getArg(e,"column")},r=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions,i.getArg(e,"bias",u.GREATEST_LOWER_BOUND));if(r>=0){var o=this._originalMappings[r];if(o.source===n.source)return{line:i.getArg(o,"generatedLine",null),column:i.getArg(o,"generatedColumn",null),lastColumn:i.getArg(o,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},t.BasicSourceMapConsumer=l,f.prototype=Object.create(u.prototype),f.prototype.constructor=u,f.prototype._version=3,Object.defineProperty(f.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var n=0;n<this._sections[t].consumer.sources.length;n++)e.push(this._sections[t].consumer.sources[n]);return e}}),f.prototype.originalPositionFor=function(e){var t={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},n=r.search(t,this._sections,(function(e,t){var n=e.generatedLine-t.generatedOffset.generatedLine;return n||e.generatedColumn-t.generatedOffset.generatedColumn})),o=this._sections[n];return o?o.consumer.originalPositionFor({line:t.generatedLine-(o.generatedOffset.generatedLine-1),column:t.generatedColumn-(o.generatedOffset.generatedLine===t.generatedLine?o.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},f.prototype.hasContentsOfAllSources=function(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))},f.prototype.sourceContentFor=function(e,t){for(var n=0;n<this._sections.length;n++){var i=this._sections[n].consumer.sourceContentFor(e,!0);if(i)return i}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},f.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var n=this._sections[t];if(-1!==n.consumer.sources.indexOf(i.getArg(e,"source"))){var r=n.consumer.generatedPositionFor(e);if(r)return{line:r.line+(n.generatedOffset.generatedLine-1),column:r.column+(n.generatedOffset.generatedLine===r.line?n.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},f.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var r=this._sections[n],o=r.consumer._generatedMappings,s=0;s<o.length;s++){var u=o[s],l=r.consumer._sources.at(u.source);null!==r.consumer.sourceRoot&&(l=i.join(r.consumer.sourceRoot,l)),this._sources.add(l),l=this._sources.indexOf(l);var c=r.consumer._names.at(u.name);this._names.add(c),c=this._names.indexOf(c);var f={source:l,generatedLine:u.generatedLine+(r.generatedOffset.generatedLine-1),generatedColumn:u.generatedColumn+(r.generatedOffset.generatedLine===u.generatedLine?r.generatedOffset.generatedColumn-1:0),originalLine:u.originalLine,originalColumn:u.originalColumn,name:c};this.__generatedMappings.push(f),"number"==typeof f.originalLine&&this.__originalMappings.push(f)}a(this.__generatedMappings,i.compareByGeneratedPositionsDeflated),a(this.__originalMappings,i.compareByOriginalPositions)},t.IndexedSourceMapConsumer=f},function(e,t){t.getArg=function(e,t,n){if(t in e)return e[t];if(3===arguments.length)return n;throw new Error('"'+t+'" is a required argument.')};var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.]*)(?::(\d+))?(\S*)$/,i=/^data:.+\,.+$/;function r(e){var t=e.match(n);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function o(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function s(e){var n=e,i=r(e);if(i){if(!i.path)return e;n=i.path}for(var s,a=t.isAbsolute(n),u=n.split(/\/+/),l=0,c=u.length-1;c>=0;c--)"."===(s=u[c])?u.splice(c,1):".."===s?l++:l>0&&(""===s?(u.splice(c+1,l),l=0):(u.splice(c,2),l--));return""===(n=u.join("/"))&&(n=a?"/":"."),i?(i.path=n,o(i)):n}t.urlParse=r,t.urlGenerate=o,t.normalize=s,t.join=function(e,t){""===e&&(e="."),""===t&&(t=".");var n=r(t),a=r(e);if(a&&(e=a.path||"/"),n&&!n.scheme)return a&&(n.scheme=a.scheme),o(n);if(n||t.match(i))return t;if(a&&!a.host&&!a.path)return a.host=t,o(a);var u="/"===t.charAt(0)?t:s(e.replace(/\/+$/,"")+"/"+t);return a?(a.path=u,o(a)):u},t.isAbsolute=function(e){return"/"===e.charAt(0)||!!e.match(n)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var n=0;0!==t.indexOf(e+"/");){var i=e.lastIndexOf("/");if(i<0)return t;if((e=e.slice(0,i)).match(/^([^\/]+:\/)?\/*$/))return t;++n}return Array(n+1).join("../")+t.substr(e.length+1)};var a=!("__proto__"in Object.create(null));function u(e){return e}function l(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var n=t-10;n>=0;n--)if(36!==e.charCodeAt(n))return!1;return!0}function c(e,t){return e===t?0:e>t?1:-1}t.toSetString=a?u:function(e){return l(e)?"$"+e:e},t.fromSetString=a?u:function(e){return l(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,n){var i=e.source-t.source;return 0!==i||0!=(i=e.originalLine-t.originalLine)||0!=(i=e.originalColumn-t.originalColumn)||n||0!=(i=e.generatedColumn-t.generatedColumn)||0!=(i=e.generatedLine-t.generatedLine)?i:e.name-t.name},t.compareByGeneratedPositionsDeflated=function(e,t,n){var i=e.generatedLine-t.generatedLine;return 0!==i||0!=(i=e.generatedColumn-t.generatedColumn)||n||0!=(i=e.source-t.source)||0!=(i=e.originalLine-t.originalLine)||0!=(i=e.originalColumn-t.originalColumn)?i:e.name-t.name},t.compareByGeneratedPositionsInflated=function(e,t){var n=e.generatedLine-t.generatedLine;return 0!==n||0!=(n=e.generatedColumn-t.generatedColumn)||0!==(n=c(e.source,t.source))||0!=(n=e.originalLine-t.originalLine)||0!=(n=e.originalColumn-t.originalColumn)?n:c(e.name,t.name)}},function(e,t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,n,i,r){if(0===n.length)return-1;var o=function e(n,i,r,o,s,a){var u=Math.floor((i-n)/2)+n,l=s(r,o[u],!0);return 0===l?u:l>0?i-u>1?e(u,i,r,o,s,a):a==t.LEAST_UPPER_BOUND?i<o.length?i:-1:u:u-n>1?e(n,u,r,o,s,a):a==t.LEAST_UPPER_BOUND?u:n<0?-1:n}(-1,n.length,e,n,i,r||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&0===i(n[o],n[o-1],!0);)--o;return o}},function(e,t,n){var i=n(2),r=Object.prototype.hasOwnProperty;function o(){this._array=[],this._set=Object.create(null)}o.fromArray=function(e,t){for(var n=new o,i=0,r=e.length;i<r;i++)n.add(e[i],t);return n},o.prototype.size=function(){return Object.getOwnPropertyNames(this._set).length},o.prototype.add=function(e,t){var n=i.toSetString(e),o=r.call(this._set,n),s=this._array.length;o&&!t||this._array.push(e),o||(this._set[n]=s)},o.prototype.has=function(e){var t=i.toSetString(e);return r.call(this._set,t)},o.prototype.indexOf=function(e){var t=i.toSetString(e);if(r.call(this._set,t))return this._set[t];throw new Error('"'+e+'" is not in the set.')},o.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},o.prototype.toArray=function(){return this._array.slice()},t.ArraySet=o},function(e,t,n){var i=n(6);t.encode=function(e){var t,n="",r=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&r,(r>>>=5)>0&&(t|=32),n+=i.encode(t)}while(r>0);return n},t.decode=function(e,t,n){var r,o,s,a,u=e.length,l=0,c=0;do{if(t>=u)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(o=i.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));r=!!(32&o),l+=(o&=31)<<c,c+=5}while(r);n.value=(a=(s=l)>>1,1==(1&s)?-a:a),n.rest=t}},function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},function(e,t){function n(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function i(e,t,r,o){if(r<o){var s=r-1;n(e,(c=r,f=o,Math.round(c+Math.random()*(f-c))),o);for(var a=e[o],u=r;u<o;u++)t(e[u],a)<=0&&n(e,s+=1,u);n(e,s+1,u);var l=s+1;i(e,t,r,l-1),i(e,t,l+1,o)}var c,f}t.quickSort=function(e,t){i(e,t,0,e.length-1)}}])},"object"===s(t)&&"object"===s(e)?e.exports=o():(i=[],void 0===(r="function"==typeof(n=o)?n.apply(t,i):n)||(e.exports=r))}).call(this,n(2)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},,,function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"nvl",(function(){return l})),n.d(i,"assertParameter",(function(){return c})),n.d(i,"assertProperty",(function(){return f})),n.d(i,"isOneOf",(function(){return h})),n.d(i,"create",(function(){return d})),n.d(i,"prepareDOM",(function(){return p})),n.d(i,"installGlobalMouseDownInterceptor",(function(){return y})),n.d(i,"installSyntheticActiveStateHandler",(function(){return v})),n.d(i,"widget",(function(){return b})),n.d(i,"adapter",(function(){return g})),n.d(i,"getSession",(function(){return m})),n.d(i,"exportAdapter",(function(){return _})),n.d(i,"reloadPage",(function(){return w})),n.d(i,"addObjectFactories",(function(){return k})),n.d(i,"cloneShallow",(function(){return S})),n.d(i,"default",(function(){return O}));var r={};n.r(r),n.d(r,"scout",(function(){return O})),n.d(r,"App",(function(){return x})),n.d(r,"ErrorHandler",(function(){return I})),n.d(r,"RemoteApp",(function(){return G})),n.d(r,"Extension",(function(){return K})),n.d(r,"TypeDescriptor",(function(){return Y})),n.d(r,"ObjectFactory",(function(){return Z})),n.d(r,"LoadingSupport",(function(){return te})),n.d(r,"SimpleLoadingSupport",(function(){return ue})),n.d(r,"ModelAdapter",(function(){return fe})),n.d(r,"Widget",(function(){return de})),n.d(r,"widgets",(function(){return ye})),n.d(r,"Composite",(function(){return Se})),n.d(r,"NullWidget",(function(){return Ee})),n.d(r,"NullWidgetAdapter",(function(){return Me})),n.d(r,"arrays",(function(){return et})),n.d(r,"Call",(function(){return nt})),n.d(r,"clipboard",(function(){return ot})),n.d(r,"EventDelegator",(function(){return at})),n.d(r,"dates",(function(){return wt})),n.d(r,"defaultValues",(function(){return Pt})),n.d(r,"events",(function(){return Ft})),n.d(r,"Device",(function(){return Mt})),n.d(r,"DoubleClickSupport",(function(){return Lt})),n.d(r,"DragAndDropHandler",(function(){return Nt})),n.d(r,"dragAndDrop",(function(){return Gt})),n.d(r,"Event",(function(){return Kt})),n.d(r,"EventSupport",(function(){return Yt})),n.d(r,"fonts",(function(){return nn})),n.d(r,"icons",(function(){return sn})),n.d(r,"inspector",(function(){return an})),n.d(r,"locales",(function(){return bn})),n.d(r,"logging",(function(){return Mn})),n.d(r,"NullLogger",(function(){return Ln})),n.d(r,"mimeTypes",(function(){return Bn})),n.d(r,"models",(function(){return Vn})),n.d(r,"numbers",(function(){return Gn})),n.d(r,"RoundingMode",(function(){return Un})),n.d(r,"objects",(function(){return oi})),n.d(r,"polyfills",(function(){return si})),n.d(r,"PromiseCreator",(function(){return ui})),n.d(r,"promises",(function(){return li})),n.d(r,"Range",(function(){return fi})),n.d(r,"Status",(function(){return pi})),n.d(r,"CachedElement",(function(){return vi})),n.d(r,"PlainTextEncoder",(function(){return gi})),n.d(r,"HtmlEncoder",(function(){return _i})),n.d(r,"strings",(function(){return En})),n.d(r,"styles",(function(){return $i})),n.d(r,"TreeSet",(function(){return Mi})),n.d(r,"URL",(function(){return Li})),n.d(r,"filters",(function(){return Bi})),n.d(r,"HAlign",(function(){return Ni})),n.d(r,"aggregation",(function(){return zi})),n.d(r,"webstorage",(function(){return Gi})),n.d(r,"cookies",(function(){return Ui})),n.d(r,"ajax",(function(){return Ji})),n.d(r,"AjaxCall",(function(){return or})),n.d(r,"AjaxError",(function(){return sr})),n.d(r,"LookupCall",(function(){return ur})),n.d(r,"LookupRow",(function(){return cr})),n.d(r,"RemoteLookupCall",(function(){return br})),n.d(r,"RemoteLookupRequest",(function(){return mr})),n.d(r,"QueryBy",(function(){return _r})),n.d(r,"StaticLookupCall",(function(){return Rr})),n.d(r,"HierarchicalLookupResultBuilder",(function(){return Er})),n.d(r,"Code",(function(){return Ar})),n.d(r,"CodeType",(function(){return jr})),n.d(r,"codes",(function(){return zr})),n.d(r,"CodeLookupCall",(function(){return Jr})),n.d(r,"BackgroundJobPollingStatus",(function(){return Zr})),n.d(r,"BackgroundJobPollingSupport",(function(){return eo})),n.d(r,"BusyIndicator",(function(){return uo})),n.d(r,"RemoteEvent",(function(){return lo})),n.d(r,"Locale",(function(){return fo})),n.d(r,"PropertyChangeEventFilter",(function(){return po})),n.d(r,"Reconnector",(function(){return vo})),n.d(r,"ResponseQueue",(function(){return go})),n.d(r,"Session",(function(){return wo})),n.d(r,"UserAgent",(function(){return ko})),n.d(r,"WidgetEventTypeFilter",(function(){return Oo})),n.d(r,"Dimension",(function(){return Co})),n.d(r,"Insets",(function(){return Ro})),n.d(r,"Point",(function(){return Eo})),n.d(r,"Rectangle",(function(){return Fo})),n.d(r,"graphics",(function(){return No})),n.d(r,"HtmlEnvironment",(function(){return Vo})),n.d(r,"AbstractLayout",(function(){return zo})),n.d(r,"HtmlComponent",(function(){return Uo})),n.d(r,"LayoutConstants",(function(){return Ko})),n.d(r,"LayoutValidator",(function(){return Yo})),n.d(r,"LogicalGrid",(function(){return Jo})),n.d(r,"LogicalGridConfig",(function(){return Qo})),n.d(r,"LogicalGridData",(function(){return ts})),n.d(r,"LogicalGridLayout",(function(){return ls})),n.d(r,"LogicalGridLayoutConfig",(function(){return fs})),n.d(r,"LogicalGridLayoutInfo",(function(){return ds})),n.d(r,"AbstractGrid",(function(){return _s})),n.d(r,"HorizontalGrid",(function(){return Ps})),n.d(r,"VerticalSmartGrid",(function(){return $s})),n.d(r,"LogicalGridMatrix",(function(){return Ms})),n.d(r,"LogicalGridMatrixCell",(function(){return Ls})),n.d(r,"LogicalGridMatrixCursor",(function(){return Hs})),n.d(r,"HorizontalGridMatrix",(function(){return qs})),n.d(r,"VerticalGridMatrix",(function(){return ta})),n.d(r,"ColumnLayout",(function(){return ua})),n.d(r,"NullLayout",(function(){return ya})),n.d(r,"RowLayout",(function(){return ka})),n.d(r,"SingleLayout",(function(){return xa})),n.d(r,"FlexboxLayout",(function(){return Ma})),n.d(r,"FlexboxLayoutData",(function(){return La})),n.d(r,"SimpleTabBoxController",(function(){return Na})),n.d(r,"SimpleTabBox",(function(){return qa})),n.d(r,"SimpleTabBoxLayout",(function(){return tu})),n.d(r,"SimpleTabViewContentLayout",(function(){return uu})),n.d(r,"keys",(function(){return pu})),n.d(r,"Key",(function(){return vu})),n.d(r,"keyStrokeModifier",(function(){return gu})),n.d(r,"VirtualKeyStrokeEvent",(function(){return _u})),n.d(r,"KeyStrokeManager",(function(){return ku})),n.d(r,"KeyStrokeContext",(function(){return Ou})),n.d(r,"InputFieldKeyStrokeContext",(function(){return Fu})),n.d(r,"KeyStroke",(function(){return $u})),n.d(r,"RangeKeyStroke",(function(){return Hu})),n.d(r,"ContextMenuKeyStroke",(function(){return Yu})),n.d(r,"ClickActiveElementKeyStroke",(function(){return il})),n.d(r,"FocusAdjacentElementKeyStroke",(function(){return cl})),n.d(r,"CloseKeyStroke",(function(){return bl})),n.d(r,"AbortKeyStroke",(function(){return Ol})),n.d(r,"TabItemKeyStroke",(function(){return Fl})),n.d(r,"Accordion",(function(){return Hl})),n.d(r,"AccordionAdapter",(function(){return Kl})),n.d(r,"BoxButtons",(function(){return Yl})),n.d(r,"Carousel",(function(){return ic})),n.d(r,"CarouselLayout",(function(){return cc})),n.d(r,"Cell",(function(){return hc})),n.d(r,"CollapseHandle",(function(){return _c})),n.d(r,"FocusManager",(function(){return kc})),n.d(r,"FocusContext",(function(){return Oc})),n.d(r,"focusUtils",(function(){return Cc})),n.d(r,"FocusRule",(function(){return Pc})),n.d(r,"GlassPane",(function(){return jc})),n.d(r,"DeferredGlassPaneTarget",(function(){return Ic})),n.d(r,"GlassPaneRenderer",(function(){return Bc})),n.d(r,"IFrame",(function(){return qc})),n.d(r,"Scrollbar",(function(){return rf})),n.d(r,"scrollbars",(function(){return wf})),n.d(r,"VirtualScrolling",(function(){return Sf})),n.d(r,"Splitter",(function(){return Ff})),n.d(r,"DateFormatPatternType",(function(){return Af})),n.d(r,"DateFormatPatternDefinition",(function(){return jf})),n.d(r,"DateFormat",(function(){return If})),n.d(r,"DecimalFormat",(function(){return Bf})),n.d(r,"TextMap",(function(){return Wf})),n.d(r,"texts",(function(){return th})),n.d(r,"Tooltip",(function(){return lh})),n.d(r,"TooltipSupport",(function(){return fh})),n.d(r,"tooltips",(function(){return dh})),n.d(r,"WidgetTooltip",(function(){return wh})),n.d(r,"Action",(function(){return Eh})),n.d(r,"ActionAdapter",(function(){return Lh})),n.d(r,"ActionKeyStroke",(function(){return Uh})),n.d(r,"Box",(function(){return qh})),n.d(r,"Label",(function(){return nd})),n.d(r,"LabelAdapter",(function(){return cd})),n.d(r,"Popup",(function(){return kd})),n.d(r,"PopupAdapter",(function(){return Ed})),n.d(r,"PopupLayout",(function(){return Id})),n.d(r,"PopupManager",(function(){return Gd})),n.d(r,"PopupManagerAdapter",(function(){return Jd})),n.d(r,"PopupWithHead",(function(){return op})),n.d(r,"PopupWithHeadLayout",(function(){return dp})),n.d(r,"MobilePopup",(function(){return wp})),n.d(r,"MobilePopupLayout",(function(){return xp})),n.d(r,"TouchPopup",(function(){return Lp})),n.d(r,"TouchPopupLayout",(function(){return Up})),n.d(r,"WidgetPopup",(function(){return ty})),n.d(r,"WidgetPopupAdapter",(function(){return ay})),n.d(r,"WidgetPopupLayout",(function(){return yy})),n.d(r,"DatePicker",(function(){return Sy})),n.d(r,"DatePickerPopup",(function(){return Dy})),n.d(r,"DatePickerPopupLayout",(function(){return By})),n.d(r,"DatePickerTouchPopup",(function(){return Ky})),n.d(r,"DatePickerTouchPopupLayout",(function(){return ev})),n.d(r,"Group",(function(){return uv})),n.d(r,"GroupAdapter",(function(){return pv})),n.d(r,"GroupLayout",(function(){return wv})),n.d(r,"GroupToggleCollapseKeyStroke",(function(){return Rv})),n.d(r,"Icon",(function(){return Mv})),n.d(r,"IconDesc",(function(){return Bv})),n.d(r,"Image",(function(){return Kv})),n.d(r,"ImageLayout",(function(){return tb})),n.d(r,"Notification",(function(){return lb})),n.d(r,"NotificationAdapter",(function(){return yb})),n.d(r,"menus",(function(){return mb})),n.d(r,"MenuDestinations",(function(){return _b})),n.d(r,"Menu",(function(){return xb})),n.d(r,"EllipsisMenu",(function(){return Ib})),n.d(r,"MenuAdapter",(function(){return Wb})),n.d(r,"MenuKeyStroke",(function(){return Jb})),n.d(r,"MenuExecKeyStroke",(function(){return og})),n.d(r,"MenuItemsOrder",(function(){return ag})),n.d(r,"ComboMenu",(function(){return pg})),n.d(r,"ComboMenuAdapter",(function(){return _g})),n.d(r,"ContextMenuPopup",(function(){return Rg})),n.d(r,"ContextMenuPopupLayout",(function(){return Mg})),n.d(r,"MenuNavigationKeyStroke",(function(){return zg})),n.d(r,"MenuNavigationExecKeyStroke",(function(){return Jg})),n.d(r,"MenuExecByNumberKeyStroke",(function(){return om})),n.d(r,"MenuNavigationDownKeyStroke",(function(){return hm})),n.d(r,"MenuNavigationUpKeyStroke",(function(){return mm})),n.d(r,"SubCloseKeyStroke",(function(){return Pm})),n.d(r,"menuNavigationKeyStrokes",(function(){return Rm})),n.d(r,"ButtonAdapterMenu",(function(){return Im})),n.d(r,"FormFieldMenu",(function(){return Gm})),n.d(r,"FormFieldMenuAdapter",(function(){return Qm})),n.d(r,"MenuBox",(function(){return a_})),n.d(r,"MenuBoxLayout",(function(){return p_})),n.d(r,"MenuBar",(function(){return O_})),n.d(r,"MenuBarLayout",(function(){return D_})),n.d(r,"MenuBarLeftKeyStroke",(function(){return L_})),n.d(r,"MenuBarRightKeyStroke",(function(){return G_})),n.d(r,"MenuBarPopup",(function(){return ew})),n.d(r,"MenubarBox",(function(){return lw})),n.d(r,"MenubarBoxLayout",(function(){return vw})),n.d(r,"Calendar",(function(){return Tw})),n.d(r,"CalendarAdapter",(function(){return Aw})),n.d(r,"CalendarComponent",(function(){return Hw})),n.d(r,"CalendarComponentAdapter",(function(){return Kw})),n.d(r,"CalendarListComponent",(function(){return Yw})),n.d(r,"CalendarLayout",(function(){return nk})),n.d(r,"CalendarModeMenu",(function(){return lk})),n.d(r,"CalendarModesMenu",(function(){return bk})),n.d(r,"DateRange",(function(){return mk})),n.d(r,"YearPanel",(function(){return Pk})),n.d(r,"Lifecycle",(function(){return xk})),n.d(r,"Planner",(function(){return Lk})),n.d(r,"PlannerAdapter",(function(){return Uk})),n.d(r,"PlannerHeader",(function(){return Qk})),n.d(r,"PlannerLayout",(function(){return sS})),n.d(r,"PlannerMenuItemsOrder",(function(){return hS})),n.d(r,"FileChooser",(function(){return _S})),n.d(r,"FileChooserAdapter",(function(){return RS})),n.d(r,"FileChooserController",(function(){return ES})),n.d(r,"FileInput",(function(){return LS})),n.d(r,"Route",(function(){return NS})),n.d(r,"router",(function(){return US})),n.d(r,"Slider",(function(){return eO})),n.d(r,"SliderAdapter",(function(){return sO})),n.d(r,"SliderLayout",(function(){return dO})),n.d(r,"Mode",(function(){return wO})),n.d(r,"ModeAdapter",(function(){return PO})),n.d(r,"ModeSelector",(function(){return MO})),n.d(r,"ModeSelectorLayout",(function(){return zO})),n.d(r,"Form",(function(){return ZO})),n.d(r,"FormAdapter",(function(){return sT})),n.d(r,"FormGrid",(function(){return dT})),n.d(r,"FormLayout",(function(){return _T})),n.d(r,"FormMenuActionKeyStroke",(function(){return PT})),n.d(r,"FormMenu",(function(){return jT})),n.d(r,"FormMenuAdapter",(function(){return HT})),n.d(r,"FormMenuPopup",(function(){return XT})),n.d(r,"FormMenuPopupLayout",(function(){return rC})),n.d(r,"FormLifecycle",(function(){return hC})),n.d(r,"CancelMenu",(function(){return _C})),n.d(r,"CloseMenu",(function(){return RC})),n.d(r,"OkMenu",(function(){return MC})),n.d(r,"ResetMenu",(function(){return zC})),n.d(r,"SaveMenu",(function(){return ZC})),n.d(r,"DialogLayout",(function(){return aP})),n.d(r,"ResponsiveManager",(function(){return lP})),n.d(r,"ResponsiveHandler",(function(){return fP})),n.d(r,"GroupBoxResponsiveHandler",(function(){return _P})),n.d(r,"DesktopResponsiveHandler",(function(){return RP})),n.d(r,"TileOverviewForm",(function(){return MP})),n.d(r,"TileOverviewFormAdapter",(function(){return VP})),n.d(r,"Table",(function(){return ZP})),n.d(r,"TableAdapter",(function(){return sR})),n.d(r,"TableRow",(function(){return uR})),n.d(r,"TableMatrix",(function(){return fR})),n.d(r,"TableFooter",(function(){return _R})),n.d(r,"TableFooterLayout",(function(){return PR})),n.d(r,"TableInfoFilterTooltip",(function(){return jR})),n.d(r,"TableInfoLoadTooltip",(function(){return WR})),n.d(r,"TableInfoSelectionTooltip",(function(){return JR})),n.d(r,"TableHeader",(function(){return sx})),n.d(r,"TableHeaderMenu",(function(){return vx})),n.d(r,"TableHeaderMenuLayout",(function(){return Ox})),n.d(r,"TableHeaderMenuGroup",(function(){return Fx})),n.d(r,"TableHeaderMenuButton",(function(){return Nx})),n.d(r,"TableHeaderMenuButtonKeyStroke",(function(){return Kx})),n.d(r,"TableLayout",(function(){return tE})),n.d(r,"TableSelectionHandler",(function(){return iE})),n.d(r,"TableTileGridMediator",(function(){return hE})),n.d(r,"TableTileGridMediatorAdapter",(function(){return mE})),n.d(r,"TableRowDetail",(function(){return RE})),n.d(r,"TableRowTileMapping",(function(){return $E})),n.d(r,"TableRowTileMappingAdapter",(function(){return NE})),n.d(r,"TableTooltip",(function(){return qE})),n.d(r,"TableUpdateBuffer",(function(){return XE})),n.d(r,"TileTableHeaderGroupByLookupCall",(function(){return rD})),n.d(r,"TileTableHeaderSortByLookupCall",(function(){return hD})),n.d(r,"comparators",(function(){return yD})),n.d(r,"Column",(function(){return gD})),n.d(r,"ColumnOptimalWidthMeasurer",(function(){return _D})),n.d(r,"AlphanumericSortingStringColumn",(function(){return CD})),n.d(r,"BeanColumn",(function(){return $D})),n.d(r,"BooleanColumn",(function(){return VD})),n.d(r,"DateColumn",(function(){return XD})),n.d(r,"IconColumn",(function(){return rF})),n.d(r,"NumberColumn",(function(){return hF})),n.d(r,"SmartColumn",(function(){return _F})),n.d(r,"TableControlActionKeyStroke",(function(){return PF})),n.d(r,"TableControl",(function(){return MF})),n.d(r,"TableControlAdapter",(function(){return WF})),n.d(r,"TableControlAdapterMenu",(function(){return ZF})),n.d(r,"AggregateTableControl",(function(){return aA})),n.d(r,"AggregateTableControlAdapter",(function(){return pA})),n.d(r,"FormTableControl",(function(){return SA})),n.d(r,"FormTableControlAdapter",(function(){return xA})),n.d(r,"FormTableControlLayout",(function(){return MA})),n.d(r,"CellEditorPopup",(function(){return GA})),n.d(r,"CellEditorPopupLayout",(function(){return ZA})),n.d(r,"CellEditorCancelEditKeyStroke",(function(){return o$})),n.d(r,"CellEditorCompleteEditKeyStroke",(function(){return h$})),n.d(r,"CellEditorTabKeyStroke",(function(){return _$})),n.d(r,"AbstractTableNavigationKeyStroke",(function(){return R$})),n.d(r,"TableControlCloseKeyStroke",(function(){return j$})),n.d(r,"TableCopyKeyStroke",(function(){return V$})),n.d(r,"TableNavigationCollapseKeyStroke",(function(){return J$})),n.d(r,"TableNavigationExpandKeyStroke",(function(){return sj})),n.d(r,"TableSelectAllKeyStroke",(function(){return pj})),n.d(r,"TableStartCellEditKeyStroke",(function(){return Sj})),n.d(r,"TableRefreshKeyStroke",(function(){return Fj})),n.d(r,"TableToggleRowKeyStroke",(function(){return Nj})),n.d(r,"TableNavigationUpKeyStroke",(function(){return qj})),n.d(r,"TableNavigationDownKeyStroke",(function(){return nM})),n.d(r,"TableNavigationHomeKeyStroke",(function(){return cM})),n.d(r,"TableNavigationEndKeyStroke",(function(){return gM})),n.d(r,"TableNavigationPageUpKeyStroke",(function(){return CM})),n.d(r,"TableNavigationPageDownKeyStroke",(function(){return $M})),n.d(r,"TableFocusFilterFieldKeyStroke",(function(){return HM})),n.d(r,"TableFilter",(function(){return WM})),n.d(r,"TableUserFilter",(function(){return XM})),n.d(r,"ColumnUserFilter",(function(){return rI})),n.d(r,"DateColumnUserFilter",(function(){return hI})),n.d(r,"NumberColumnUserFilter",(function(){return _I})),n.d(r,"TextColumnUserFilter",(function(){return RI})),n.d(r,"TableTextUserFilter",(function(){return MI})),n.d(r,"TileTableHierarchyFilter",(function(){return zI})),n.d(r,"TimePicker",(function(){return ZI})),n.d(r,"TimePickerPopup",(function(){return sL})),n.d(r,"TimePickerPopupLayout",(function(){return pL})),n.d(r,"TimePickerTouchPopup",(function(){return kL})),n.d(r,"TimePickerTouchPopupLayout",(function(){return EL})),n.d(r,"Tree",(function(){return NL})),n.d(r,"TreeAdapter",(function(){return qL})),n.d(r,"TreeNode",(function(){return XL})),n.d(r,"TreeLayout",(function(){return iB})),n.d(r,"LazyNodeFilter",(function(){return oB})),n.d(r,"TreeBreadcrumbFilter",(function(){return aB})),n.d(r,"AbstractTreeNavigationKeyStroke",(function(){return yB})),n.d(r,"TreeSpaceKeyStroke",(function(){return SB})),n.d(r,"TreeNavigationUpKeyStroke",(function(){return DB})),n.d(r,"TreeNavigationDownKeyStroke",(function(){return BB})),n.d(r,"TreeNavigationEndKeyStroke",(function(){return KB})),n.d(r,"TreeCollapseAllKeyStroke",(function(){return tN})),n.d(r,"TreeCollapseOrDrillUpKeyStroke",(function(){return lN})),n.d(r,"TreeExpandOrDrillDownKeyStroke",(function(){return gN})),n.d(r,"CompactTree",(function(){return CN})),n.d(r,"CompactTreeNode",(function(){return AN})),n.d(r,"AbstractCompactTreeControlKeyStroke",(function(){return HN})),n.d(r,"CompactTreeUpKeyStroke",(function(){return qN})),n.d(r,"CompactTreeDownKeyStroke",(function(){return tH})),n.d(r,"CompactTreeLeftKeyStroke",(function(){return uH})),n.d(r,"CompactTreeRightKeyStroke",(function(){return yH})),n.d(r,"fields",(function(){return gH})),n.d(r,"AppLinkKeyStroke",(function(){return CH})),n.d(r,"FieldStatus",(function(){return jH})),n.d(r,"FormField",(function(){return GH})),n.d(r,"FormFieldAdapter",(function(){return ZH})),n.d(r,"FormFieldLayout",(function(){return sV})),n.d(r,"StatusMenuMapping",(function(){return pV})),n.d(r,"StatusMenuMappingAdapter",(function(){return _V})),n.d(r,"GridData",(function(){return kV})),n.d(r,"CompositeField",(function(){return EV})),n.d(r,"CompositeFieldAdapter",(function(){return MV})),n.d(r,"ValueField",(function(){return GV})),n.d(r,"ValueFieldAdapter",(function(){return QV})),n.d(r,"BasicField",(function(){return aW})),n.d(r,"BasicFieldAdapter",(function(){return dW})),n.d(r,"WidgetField",(function(){return wW})),n.d(r,"WidgetFieldAdapter",(function(){return PW})),n.d(r,"WidgetFieldLayout",(function(){return jW})),n.d(r,"LookupBox",(function(){return WW})),n.d(r,"LookupBoxLayout",(function(){return XW})),n.d(r,"TreeVisitResult",(function(){return JW})),n.d(r,"FormController",(function(){return QW})),n.d(r,"MessageBox",(function(){return az})),n.d(r,"MessageBoxAdapter",(function(){return yz})),n.d(r,"MessageBoxController",(function(){return bz})),n.d(r,"MessageBoxes",(function(){return mz})),n.d(r,"MessageBoxLayout",(function(){return Cz})),n.d(r,"CopyKeyStroke",(function(){return Az})),n.d(r,"AccordionField",(function(){return Hz})),n.d(r,"AccordionFieldAdapter",(function(){return Kz})),n.d(r,"BeanField",(function(){return tG})),n.d(r,"BeanFieldAdapter",(function(){return lG})),n.d(r,"BrowserField",(function(){return bG})),n.d(r,"BrowserFieldAdapter",(function(){return TG})),n.d(r,"BrowserFieldLayout",(function(){return AG})),n.d(r,"Button",(function(){return WG})),n.d(r,"ButtonLayout",(function(){return JG})),n.d(r,"ButtonAdapter",(function(){return oU})),n.d(r,"ButtonKeyStroke",(function(){return pU})),n.d(r,"CalendarField",(function(){return wU})),n.d(r,"CalendarFieldAdapter",(function(){return PU})),n.d(r,"CarouselField",(function(){return $U})),n.d(r,"CheckBoxField",(function(){return WU})),n.d(r,"CheckBoxFieldAdapter",(function(){return YU})),n.d(r,"CheckBoxToggleKeyStroke",(function(){return iK})),n.d(r,"ClipboardField",(function(){return hK})),n.d(r,"ClipboardFieldAdapter",(function(){return gK})),n.d(r,"ColorField",(function(){return TK})),n.d(r,"ColorFieldAdapter",(function(){return DK})),n.d(r,"DateField",(function(){return BK})),n.d(r,"DateFieldAdapter",(function(){return KK})),n.d(r,"DateTimeCompositeLayout",(function(){return tq})),n.d(r,"FileChooserButton",(function(){return lq})),n.d(r,"FileChooserButtonAdapter",(function(){return bq})),n.d(r,"FileChooserField",(function(){return Tq})),n.d(r,"FileChooserFieldAdapter",(function(){return Aq})),n.d(r,"FileChooserFieldBrowseKeyStroke",(function(){return Hq})),n.d(r,"FileChooserFieldDeleteKeyStroke",(function(){return Yq})),n.d(r,"GroupBox",(function(){return rY})),n.d(r,"GroupBoxGridConfig",(function(){return fY})),n.d(r,"GroupBoxAdapter",(function(){return mY})),n.d(r,"GroupBoxLayout",(function(){return PY})),n.d(r,"GroupBoxMenuItemsOrder",(function(){return xY})),n.d(r,"HtmlField",(function(){return IY})),n.d(r,"HtmlFieldAdapter",(function(){return GY})),n.d(r,"ImageField",(function(){return QY})),n.d(r,"ImageFieldAdapter",(function(){return aX})),n.d(r,"ImageFieldLayout",(function(){return yX})),n.d(r,"LabelField",(function(){return SX})),n.d(r,"LabelFieldAdapter",(function(){return DX})),n.d(r,"ListBox",(function(){return BX})),n.d(r,"ListBoxAdapter",(function(){return GX})),n.d(r,"ListBoxLayout",(function(){return JX})),n.d(r,"lookupField",(function(){return QX})),n.d(r,"LookupFieldAdapter",(function(){return sJ})),n.d(r,"ModeSelectorField",(function(){return pJ})),n.d(r,"ModeSelectorFieldAdapter",(function(){return kJ})),n.d(r,"NumberField",(function(){return EJ})),n.d(r,"NumberFieldAdapter",(function(){return LJ})),n.d(r,"Calculator",(function(){return NJ})),n.d(r,"IntegerField",(function(){return YJ})),n.d(r,"PlaceholderField",(function(){return nZ})),n.d(r,"PlaceholderFieldAdapter",(function(){return uZ})),n.d(r,"PlannerField",(function(){return yZ})),n.d(r,"PlannerFieldAdapter",(function(){return wZ})),n.d(r,"RadioButton",(function(){return EZ})),n.d(r,"RadioButtonLayout",(function(){return LZ})),n.d(r,"RadioButtonAdapter",(function(){return zZ})),n.d(r,"RadioButtonGroup",(function(){return eQ})),n.d(r,"RadioButtonGroupAdapter",(function(){return uQ})),n.d(r,"RadioButtonGroupGridConfig",(function(){return yQ})),n.d(r,"RadioButtonGroupLayout",(function(){return SQ})),n.d(r,"RadioButtonGroupLeftKeyStroke",(function(){return EQ})),n.d(r,"RadioButtonGroupRightKeyStroke",(function(){return IQ})),n.d(r,"RadioButtonKeyStroke",(function(){return GQ})),n.d(r,"SequenceBox",(function(){return QQ})),n.d(r,"SequenceBoxGridConfig",(function(){return s0})),n.d(r,"SequenceBoxLayout",(function(){return p0})),n.d(r,"SequenceBoxAdapter",(function(){return k0})),n.d(r,"SliderField",(function(){return E0})),n.d(r,"SmartField",(function(){return B0})),n.d(r,"SmartFieldAdapter",(function(){return K0})),n.d(r,"SmartFieldLayout",(function(){return t1})),n.d(r,"SmartFieldCancelKeyStroke",(function(){return c1})),n.d(r,"SmartFieldPopup",(function(){return g1})),n.d(r,"SmartFieldTouchPopup",(function(){return C1})),n.d(r,"SmartFieldPopupLayout",(function(){return $1})),n.d(r,"SmartFieldMultiline",(function(){return V1})),n.d(r,"SmartFieldMultilineAdapter",(function(){return q1})),n.d(r,"SmartFieldMultilineLayout",(function(){return n2})),n.d(r,"ProposalField",(function(){return c2})),n.d(r,"ProposalFieldAdapter",(function(){return v2})),n.d(r,"ProposalTreeNode",(function(){return O2})),n.d(r,"ProposalChooser",(function(){return F2})),n.d(r,"ProposalChooserLayout",(function(){return B2})),n.d(r,"TableProposalChooser",(function(){return U2})),n.d(r,"TableLayoutResetter",(function(){return q2})),n.d(r,"TreeProposalChooser",(function(){return t3})),n.d(r,"TreeLayoutResetter",(function(){return i3})),n.d(r,"SplitBox",(function(){return h3})),n.d(r,"SplitBoxAdapter",(function(){return _3})),n.d(r,"SplitBoxCollapseKeyStroke",(function(){return P3})),n.d(r,"SplitBoxFirstCollapseKeyStroke",(function(){return $3})),n.d(r,"SplitBoxSecondCollapseKeyStroke",(function(){return H3})),n.d(r,"SplitBoxLayout",(function(){return q3})),n.d(r,"StringField",(function(){return r5})),n.d(r,"StringFieldLayout",(function(){return h5})),n.d(r,"StringFieldAdapter",(function(){return _5})),n.d(r,"StringFieldEnterKeyStroke",(function(){return R5})),n.d(r,"StringFieldCtrlEnterKeyStroke",(function(){return M5})),n.d(r,"TabBox",(function(){return G5})),n.d(r,"TabAreaLeftKeyStroke",(function(){return Z5})),n.d(r,"TabAreaRightKeyStroke",(function(){return o4})),n.d(r,"TabBoxAdapter",(function(){return d4})),n.d(r,"TabBoxHeaderLayout",(function(){return w4})),n.d(r,"TabBoxHeader",(function(){return E4})),n.d(r,"Tab",(function(){return B4})),n.d(r,"TabArea",(function(){return q4})),n.d(r,"TabAreaLayout",(function(){return n6})),n.d(r,"TabBoxLayout",(function(){return c6})),n.d(r,"TabItem",(function(){return g6})),n.d(r,"TabItemAdapter",(function(){return O6})),n.d(r,"TabItemLayout",(function(){return D6})),n.d(r,"TableField",(function(){return N6})),n.d(r,"TableFieldAdapter",(function(){return U6})),n.d(r,"TagChooserPopup",(function(){return e9})),n.d(r,"TagChooserPopupLayout",(function(){return u9})),n.d(r,"TagField",(function(){return v9})),n.d(r,"TagFieldAdapter",(function(){return O9})),n.d(r,"TagFieldCancelKeyStroke",(function(){return A9})),n.d(r,"TagFieldEnterKeyStroke",(function(){return H9})),n.d(r,"TagFieldDeleteKeyStroke",(function(){return Y9})),n.d(r,"TagFieldNavigationKeyStroke",(function(){return i7})),n.d(r,"TagFieldOpenPopupKeyStroke",(function(){return f7})),n.d(r,"TagFieldLayout",(function(){return g7})),n.d(r,"TagFieldContainerLayout",(function(){return T7})),n.d(r,"TileField",(function(){return A7})),n.d(r,"TileFieldAdapter",(function(){return B7})),n.d(r,"TreeBox",(function(){return K7})),n.d(r,"TreeBoxAdapter",(function(){return Q7})),n.d(r,"TreeBoxLayout",(function(){return o8})),n.d(r,"TreeField",(function(){return h8})),n.d(r,"TreeFieldAdapter",(function(){return g8})),n.d(r,"WizardProgressField",(function(){return C8})),n.d(r,"WizardProgressFieldAdapter",(function(){return $8})),n.d(r,"WizardProgressFieldLayout",(function(){return V8})),n.d(r,"WrappedFormField",(function(){return J8})),n.d(r,"WrappedFormFieldAdapter",(function(){return iee})),n.d(r,"Switch",(function(){return fee})),n.d(r,"TagBar",(function(){return mee})),n.d(r,"TagBarLayout",(function(){return Cee})),n.d(r,"TagBarOverflowPopup",(function(){return $ee})),n.d(r,"Tile",(function(){return Wee})),n.d(r,"TileAdapter",(function(){return Yee})),n.d(r,"TileGrid",(function(){return rte})),n.d(r,"TileGridAdapter",(function(){return hte})),n.d(r,"TileGridGridConfig",(function(){return mte})),n.d(r,"TileGridLayout",(function(){return Pte})),n.d(r,"TileGridLayoutConfig",(function(){return jte})),n.d(r,"TileGridSelectionHandler",(function(){return Ite})),n.d(r,"TileOverviewLayout",(function(){return zte})),n.d(r,"HtmlTile",(function(){return Zte})),n.d(r,"HtmlTileAdapter",(function(){return rne})),n.d(r,"BeanTile",(function(){return hne})),n.d(r,"BeanTileAdapter",(function(){return _ne})),n.d(r,"TileAccordion",(function(){return xne})),n.d(r,"TileAccordionAdapter",(function(){return Ine})),n.d(r,"TileAccordionSelectionHandler",(function(){return zne})),n.d(r,"TileGridSelectKeyStroke",(function(){return Qne})),n.d(r,"TileGridSelectAllKeyStroke",(function(){return uie})),n.d(r,"TileGridSelectLeftKeyStroke",(function(){return vie})),n.d(r,"TileGridSelectRightKeyStroke",(function(){return Oie})),n.d(r,"TileGridSelectDownKeyStroke",(function(){return Fie})),n.d(r,"TileGridSelectUpKeyStroke",(function(){return Nie})),n.d(r,"TileGridSelectFirstKeyStroke",(function(){return qie})),n.d(r,"TileGridSelectLastKeyStroke",(function(){return nre})),n.d(r,"RemoteTileFilter",(function(){return rre})),n.d(r,"WidgetTile",(function(){return dre})),n.d(r,"WidgetTileAdapter",(function(){return mre})),n.d(r,"PlaceholderTile",(function(){return Pre})),n.d(r,"FormFieldTile",(function(){return jre})),n.d(r,"FormFieldTileAdapter",(function(){return Hre})),n.d(r,"TileButton",(function(){return Yre})),n.d(r,"TileTableField",(function(){return roe})),n.d(r,"Desktop",(function(){return poe})),n.d(r,"DesktopAdapter",(function(){return koe})),n.d(r,"DesktopLogo",(function(){return Doe})),n.d(r,"DesktopLayout",(function(){return Loe})),n.d(r,"DesktopTabBoxController",(function(){return Goe})),n.d(r,"DisableBrowserF5ReloadKeyStroke",(function(){return Zoe})),n.d(r,"PopupWindow",(function(){return ese})),n.d(r,"OpenUriHandler",(function(){return nse})),n.d(r,"DesktopBench",(function(){return hse})),n.d(r,"BenchColumn",(function(){return kse})),n.d(r,"BenchRowLayoutData",(function(){return Ese})),n.d(r,"BenchColumnLayoutData",(function(){return Fse})),n.d(r,"DesktopTabSelectKeyStroke",(function(){return Hse})),n.d(r,"DisableBrowserTabSwitchingKeyStroke",(function(){return Yse})),n.d(r,"DesktopHeader",(function(){return rae})),n.d(r,"HeaderTabBoxController",(function(){return dae})),n.d(r,"DesktopHeaderLayout",(function(){return _ae})),n.d(r,"DesktopNavigation",(function(){return Eae})),n.d(r,"DesktopNavigationHandle",(function(){return Lae})),n.d(r,"DesktopNavigationLayout",(function(){return Gae})),n.d(r,"ShrinkNavigationKeyStroke",(function(){return eue})),n.d(r,"EnlargeNavigationKeyStroke",(function(){return lue})),n.d(r,"DesktopNotification",(function(){return bue})),n.d(r,"DesktopNotificationAdapter",(function(){return Tue})),n.d(r,"OfflineDesktopNotification",(function(){return Aue})),n.d(r,"PopupBlockerHandler",(function(){return jue})),n.d(r,"PopupBlockerDesktopNotification",(function(){return Wue})),n.d(r,"DesktopToolBox",(function(){return Jue})),n.d(r,"ViewButtonActionKeyStroke",(function(){return ole})),n.d(r,"ViewButton",(function(){return dle})),n.d(r,"ViewButtonAdapter",(function(){return mle})),n.d(r,"ViewButtonBox",(function(){return Rle})),n.d(r,"ViewButtonBoxLayout",(function(){return jle})),n.d(r,"ViewMenuOpenKeyStroke",(function(){return Wle})),n.d(r,"ViewMenuPopup",(function(){return Zle})),n.d(r,"ViewMenuPopupLayout",(function(){return sce})),n.d(r,"ViewMenuTab",(function(){return pce})),n.d(r,"Page",(function(){return kce})),n.d(r,"PageWithNodes",(function(){return xce})),n.d(r,"PageWithTable",(function(){return Ice})),n.d(r,"PageTileButton",(function(){return Gce})),n.d(r,"PageTileGrid",(function(){return efe})),n.d(r,"PageTileGridSelectKeyStroke",(function(){return lfe})),n.d(r,"AutoLeafPageWithNodes",(function(){return bfe})),n.d(r,"SimpleTab",(function(){return Cfe})),n.d(r,"DesktopTab",(function(){return $fe})),n.d(r,"SimpleTabArea",(function(){return Vfe})),n.d(r,"SimpleTabAreaLayout",(function(){return Xfe})),n.d(r,"DetailTableTreeFilter",(function(){return Zfe})),n.d(r,"Outline",(function(){return ahe})),n.d(r,"OutlineAdapter",(function(){return vhe})),n.d(r,"OutlineMediator",(function(){return ghe})),n.d(r,"OutlineLayout",(function(){return Che})),n.d(r,"OutlineViewButton",(function(){return $he})),n.d(r,"OutlineViewButtonAdapter",(function(){return Hhe})),n.d(r,"OutlineTileField",(function(){return qhe})),n.d(r,"OutlineTileFieldAdapter",(function(){return ede})),n.d(r,"PageLayout",(function(){return ade})),n.d(r,"SearchOutline",(function(){return yde})),n.d(r,"SearchOutlineAdapter",(function(){return Sde})),n.d(r,"SearchOutlineLayout",(function(){return Dde})),n.d(r,"NavigateButton",(function(){return Bde})),n.d(r,"NavigateDownButton",(function(){return qde})),n.d(r,"NavigateUpButton",(function(){return npe})),n.d(r,"OutlineKeyStrokeContext",(function(){return cpe})),n.d(r,"OutlineNavigateToTopKeyStroke",(function(){return gpe})),n.d(r,"OutlineOverview",(function(){return Cpe})),n.d(r,"TileOutlineOverview",(function(){return $pe})),n.d(r,"DesktopFormController",(function(){return Wpe})),n.d(r,"FilterFieldsGroupBox",(function(){return Jpe})),n.d(r,"Resizable",(function(){return eye})),n.d(r,"UnsavedFormChangesForm",(function(){return uye})),n.d(r,"UnsavedFormsLookupCall",(function(){return yye})),n.d(r,"TileTableHeaderBox",(function(){return Oye})),n.d(r,"LoginApp",(function(){return Dye})),n.d(r,"LoginBox",(function(){return Nye})),n.d(r,"LogoutApp",(function(){return Kye})),n.d(r,"LogoutBox",(function(){return tve})),n.d(r,"BreadcrumbItem",(function(){return lve})),n.d(r,"BreadcrumbItemAdapter",(function(){return yve})),n.d(r,"BreadcrumbBar",(function(){return Sve})),n.d(r,"BreadcrumbBarLayout",(function(){return Fve})),n.d(r,"BreadcrumbBarAdapter",(function(){return Lve})),n.d(r,"BreadcrumbBarField",(function(){return Gve})),n.d(r,"BreadcrumbBarFieldAdapter",(function(){return Jve})),n.d(r,"default",(function(){return fbe}));var o=n(0),s=n.n(o),a=null,u={};function l(){for(var e,t=0;t<arguments.length&&null==(e=arguments[t]);t++);return e}function c(e,t,n){if(oi.isNullOrUndefined(t))throw new Error("Missing required parameter '"+e+"'");if(n&&!(t instanceof n))throw new Error("Parameter '"+e+"' has wrong type");return t}function f(e,t,n){var i=e[t];if(oi.isNullOrUndefined(i))throw new Error("Missing required property '"+t+"'");if(n&&!(i instanceof n))throw new Error("Property '"+t+"' has wrong type");return i}function h(e){return!(arguments.length<2)&&-1!==(2===arguments.length&&Array.isArray(arguments[1])?arguments[1]:Array.prototype.slice.call(arguments,1)).indexOf(e)}function d(e,t,n){return Z.get().create(e,t,n)}function p(e){if(e=e||document,s()("noscript",e).remove(),s()("scout-text",e).remove(),s()("scout-version",e).remove(),s()("body",e).addDeviceClass(),Mt.get().browser===Mt.Browser.CHROME){var t=s()("head > title",e);0===t.length?s()("head",e).append('<meta name="google" content="notranslate" />'):t.after('<meta name="google" content="notranslate" />')}}function y(e){e.addEventListener("mousedown",(function(e){GV.invokeValueFieldAboutToBlurByMouseDown(e.target||e.srcElement)}),!0)}function v(e){Mt.get().requiresSyntheticActiveState()&&(a=[],s()(e).on("mousedown",(function(e){for(var t=s()(e.target);t.length;)a.push(t.addClass("active")),t=t.parent()})).on("mouseup",(function(){a.forEach((function(e){e.removeClass("active")})),a=[]})))}function b(e,t){if(oi.isNullOrUndefined(e))return null;var n=e;if("string"==typeof e||"number"==typeof e){var i=scout.getSession(t);if(i)return e=En.asString(e),i.root.widget(e)}return ye.get(n)}function g(e,t){if(oi.isNullOrUndefined(e))return null;var n=scout.getSession(t);return n&&n.modelAdapterRegistry?n.modelAdapterRegistry[e]:null}function m(e){var t=x.get().sessions;if(!t)return null;if(oi.isNullOrUndefined(e))return t[0];for(var n=0;n<t.length;n++){var i=t[n];if(i.partId==e)return i}return null}function _(e,t){var n=scout.getSession(t);if(n&&n.modelAdapterRegistry){var i=n.getModelAdapter(e);if(!i)return null;var r=o(e);return function e(t,i){var r,s;t.widget._widgetProperties.forEach((function(t){var a=i[t];if(a)if(Array.isArray(a)){var u=[];a.forEach((function(t){r=n.getModelAdapter(t),s=o(t),e(r,s),u.push(s)})),i[t]=u}else r=n.getModelAdapter(a),s=o(a),e(r,s),i[t]=s})),i=t.exportAdapterData(i)}(i,r),r.type="model",r}function o(e){var t=n.getAdapterData(e);return t=s.a.extend(!0,{},t)}}function w(e){function t(){l(e.clearBody,!0)&&s()("body").html(""),setTimeout((function(){e.redirectUrl?window.location.href=e.redirectUrl:window.location.reload()}))}(e=e||{}).schedule?setTimeout(t):t()}function k(e){u=s.a.extend(u,e)}function S(e,t,n){c("template",e);var i=Object.create(Object.getPrototypeOf(e));if(Object.getOwnPropertyNames(e).forEach((function(t){i[t]=e[t]})),t)for(var r in t)i[r]=t[r];return l(n,!0)&&(i.id=Z.get().createUniqueId()),void 0===i.cloneOf&&(i.cloneOf=e),i}var O={nvl:l,assertParameter:c,assertProperty:f,isOneOf:h,create:d,prepareDOM:p,installGlobalMouseDownInterceptor:y,installSyntheticActiveStateHandler:v,widget:b,adapter:g,getSession:m,exportAdapter:_,reloadPage:w,addObjectFactories:k,objectFactories:u,cloneShallow:S};function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function C(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),e}var P=null,R=[],x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.events=this._createEventSupport(),this.initialized=!1,this.sessions=[],R.forEach((function(e){this.addListener(e)}),this),R=[],P=this,this.errorHandler=this._createErrorHandler()}return C(e,null,[{key:"addListener",value:function(e,t){var n={type:e,func:t};return P?P.events.addListener(n):R.push(n),n}},{key:"get",value:function(){return P}}]),C(e,[{key:"init",value:function(e){return e=e||{},this._prepare(e).then(this._bootstrap.bind(this,e.bootstrap)).then(this._init.bind(this,e)).then(this._initDone.bind(this,e)).catch(this._fail.bind(this,e))}},{key:"_prepare",value:function(e){return this._prepareLogging(e).done(function(){this._prepareEssentials(e),this._prepareDone(e)}.bind(this))}},{key:"_prepareEssentials",value:function(e){si.install(window),Z.get().init()}},{key:"_prepareDone",value:function(e){this.trigger("prepare",{options:e}),s.a.log.isDebugEnabled()&&s.a.log.debug("App prepared")}},{key:"_prepareLogging",value:function(e){return Mn.bootstrap()}},{key:"_bootstrap",value:function(e){e=e||{};var t=[];return this._doBootstrap(e).forEach((function(e){Array.isArray(e)?t.concat(e):e&&t.push(e)})),s.a.promiseAll(t).done(this._bootstrapDone.bind(this,e)).catch(this._bootstrapFail.bind(this,e))}},{key:"_doBootstrap",value:function(e){return[Mt.get().bootstrap(),nn.bootstrap(e.fonts),bn.bootstrap(e.localesUrl),th.bootstrap(e.textsUrl),zr.bootstrap(e.codesUrl)]}},{key:"_bootstrapDone",value:function(e){Gi.removeItem(sessionStorage,"scout:timeoutPageReload"),this.trigger("bootstrap",{options:e}),s.a.log.isDebugEnabled()&&s.a.log.debug("App bootstrapped")}},{key:"_bootstrapFail",value:function(e,t,n,i,r){if(s.a.log.isInfoEnabled()&&s.a.log.info("App bootstrap failed"),s.a.isJqXHR(t)){if(this._isSessionTimeoutStatus(t.status)){var o=r?r.url:"";return void this._handleBootstrapTimeoutError(t,o)}}else if(oi.isPlainObject(t)&&t.error&&t.error.code===wo.JsonResponseError.SESSION_TIMEOUT)return void this._handleBootstrapTimeoutError(t.error,t.url);var a=oi.argumentsToArray(arguments).slice(1);return s.a.rejectedPromise.apply(s.a,a)}},{key:"_isSessionTimeoutStatus",value:function(e){return 401===e}},{key:"_handleBootstrapTimeoutError",value:function(e,t){if(s.a.log.isInfoEnabled()&&s.a.log.info("Timeout error for resource "+t+". Reloading page..."),Gi.getItem(sessionStorage,"scout:timeoutPageReload"))throw s.a.log.isWarnEnabled()&&s.a.log.warn("Prevented automatic reload, startup will likely fail",e,t),Gi.removeItem(sessionStorage,"scout:timeoutPageReload"),new Error("Resource "+t+" could not be loaded due to a session timeout, even after a page reload");Gi.setItem(sessionStorage,"scout:timeoutPageReload",!0),O.reloadPage()}},{key:"_init",value:function(e){if(e=e||{},this._checkBrowserCompability(e))return this._initVersion(e),this._prepareDOM(),this._installErrorHandler(),this._installGlobalMouseDownInterceptor(),this._installSyntheticActiveStateHandler(),this._ajaxSetup(),this._installExtensions(),this._load(e).then(this._loadSessions.bind(this,e.session))}},{key:"_load",value:function(e){return s.a.resolvedPromise()}},{key:"_checkBrowserCompability",value:function(e){var t=Mt.get(),n=this;return s.a.log.isInfoEnabled()&&s.a.log.info("Detected browser "+t.browser+" version "+t.browserVersion),!(O.nvl(e.checkBrowserCompatibility,!0)&&!t.isSupportedBrowser())||(s()(".scout").each((function(){var t=s()(this).appendDiv(),i=oi.valueCopy(e);i.checkBrowserCompatibility=!1,t.load("unsupported-browser.html",(function(){t.find("button").on("click",(function(){t.remove(),n._init(i)}))}))})),!1)}},{key:"_initVersion",value:function(e){this.version=O.nvl(this.version,e.version,s()("scout-version").data("value"))}},{key:"_prepareDOM",value:function(){O.prepareDOM(document)}},{key:"_installGlobalMouseDownInterceptor",value:function(){O.installGlobalMouseDownInterceptor(document)}},{key:"_installSyntheticActiveStateHandler",value:function(){O.installSyntheticActiveStateHandler(document)}},{key:"_installErrorHandler",value:function(){window.onerror=this.errorHandler.windowErrorHandler}},{key:"_createErrorHandler",value:function(){return O.create("ErrorHandler")}},{key:"_ajaxSetup",value:function(){var e=this._ajaxDefaults();e&&s.a.ajaxSetup(e)}},{key:"_ajaxDefaults",value:function(){return{beforeSend:this._beforeAjaxCall.bind(this)}}},{key:"_beforeAjaxCall",value:function(e){e.setRequestHeader("X-Scout-Correlation-Id",Gn.correlationId()),e.setRequestHeader("X-Requested-With","XMLHttpRequest")}},{key:"_loadSessions",value:function(e){e=e||{};var t=[];return s()(".scout").each(function(n,i){var r=s()(i);e.portletPartId=e.portletPartId||r.data("partid")||"0";var o=this._loadSession(r,e);t.push(o)}.bind(this)),s.a.promiseAll(t)}},{key:"_loadSession",value:function(e,t){t.locale=t.locale||this._loadLocale(),t.$entryPoint=e;var n=this._createSession(t);this.sessions.push(n);var i=this._createDesktop(n.root);return this.trigger("desktopReady",{desktop:i}),n.render(function(){n._renderDesktop(),n.layoutValidator.validate(),n.focusManager.validateFocus(),n.ready=!0,this.trigger("sessionReady",{session:n}),s.a.log.isInfoEnabled()&&s.a.log.info("Session initialized. Detected "+Mt.get())}.bind(this)),s.a.resolvedPromise()}},{key:"_createSession",value:function(e){return O.create("Session",e,{ensureUniqueId:!1})}},{key:"_createDesktop",value:function(e){return O.create("Desktop",{parent:e})}},{key:"_loadLocale",value:function(){return bn.getNavigatorLocale()}},{key:"_initDone",value:function(e){this.initialized=!0,this.trigger("init",{options:e}),s.a.log.isInfoEnabled()&&s.a.log.info("App initialized")}},{key:"_fail",value:function(e,t){s.a.log.error("App initialization failed.");var n=oi.argumentsToArray(arguments).slice(1);return this.errorHandler.handle(n).then((function(e){var t=s()("body").appendDiv("startup-error");return t.appendDiv("startup-error-title").text("The application could not be started"),e.message&&t.appendDiv("startup-error-message").text(e.message),s.a.rejectedPromise.apply(s.a,n)}))}},{key:"_installExtensions",value:function(){}},{key:"_createEventSupport",value:function(){return new Yt}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}},{key:"when",value:function(e){return this.events.when(e)}}]),e}(),E=n(1),D=n.n(E);function F(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var A,j,M,I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logError=!0,this.displayError=!0,this.sendError=!1,this.windowErrorHandler=this._onWindowError.bind(this)}var t,n,i;return t=e,(n=[{key:"init",value:function(e){s.a.extend(this,e)}},{key:"_onWindowError",value:function(e,t,n,i,r){try{if(r instanceof Error)this.handle(r).catch((function(e){console.error("Error in global JavaScript error handler",e)}));else{var o=e+" at "+t+":"+n+"\n(Code J00)";this.handleErrorInfo({code:"J00",message:e,log:o})}}catch(i){throw new Error("Error in global JavaScript error handler: "+i.message+" (original error: "+e+" at "+t+":"+n+")")}}},{key:"handle",value:function(){var e=arguments;return 1===e.length&&e[0]&&("[object Arguments]"===String(e[0])||Array.isArray(e[0]))&&(e=e[0]),this.analyzeError.apply(this,e).then(this.handleErrorInfo.bind(this))}},{key:"analyzeError",value:function(e){for(var t={code:null,message:null,stack:null,mappedStack:null,debugInfo:null,log:null,error:e},n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return this._analyzeError.apply(this,[t].concat(i))}},{key:"_analyzeError",value:function(e){var t=e.error;if(t instanceof Error)return this.mapStack(t.stack).catch((function(t){return e.mappingError=t.message+"\n"+t.error.message+"\n"+t.error.stack,null})).then(function(t){return e.mappedStack=t,this._analyzeRegularError(e),e}.bind(this));if(s.a.isJqXHR(t)||Array.isArray(t)&&s.a.isJqXHR(t[0])||t instanceof sr){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return this._analyzeAjaxError.apply(this,[e].concat(i)),s.a.resolvedPromise(e)}return t?(this._analyzeOtherError(e),s.a.resolvedPromise(e)):(this._analyzeNoError(e),s.a.resolvedPromise(e))}},{key:"_analyzeRegularError",value:function(e){var t=e.error;e.code=this.getJsErrorCode(t),e.message=String(t.message||t),t.stack&&(e.stack=String(t.stack)),t.debugInfo&&(e.debugInfo=t.debugInfo);var n=e.mappedStack||e.stack,i=[];n&&-1!==n.indexOf(e.message)||i.push(e.message),n&&i.push(n),e.mappingError&&i.push(e.mappingError),e.debugInfo&&i.push("----- Additional debug information: -----\n"+e.debugInfo),e.log=et.format(i,"\n")}},{key:"_analyzeAjaxError",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o,s,a=e.error;a instanceof sr?(r=a.jqXHR,o=a.errorThrown,s=a.requestOptions):(r=(n=et.ensure(a).concat(n))[0],o=n[2],s=n[3]);var u=s?En.join(" ",s.type,s.url):"",l=r.status?En.join(" ",r.status,o):"Connection error";e.code="X"+(r.status||"0"),e.message="AJAX call"+En.box(' "',u,'"')+" failed"+En.box(" [",l,"]"),e.log=e.message,r.responseText&&(e.debugInfo="Response text:\n"+r.responseText,e.log+="\n"+e.debugInfo)}},{key:"_analyzeOtherError",value:function(e){var t=e.error,n="string"==typeof t||"number"==typeof t?String(t):null;if(e.code="P4",e.message=n||"Unexpected error",!n)try{n=JSON.stringify(t)}catch(e){n=String(t)}e.log="Unexpected error: "+n}},{key:"_analyzeNoError",value:function(e){e.code="P3",e.message="Unknown error",e.log="Unexpected error (no reason provided)"}},{key:"mapStack",value:function(e){var t=s.a.Deferred();try{D.a.mapStackTrace(e,(function(e){t.resolve(et.format(e,"\n"))}))}catch(e){return s.a.rejectedPromise({message:"Exception mapping failed",error:e})}return t.promise()}},{key:"handleErrorInfo",value:function(t){if(this.logError&&t.log){s.a.log.error(t.log);var n=e.CONSOLE_OUTPUT;s.a.log instanceof Ln&&(n=!1),n&&window&&window.console&&(window.console.error?window.console.error(t.log):window.console.log&&window.console.log(t.log))}if(x.get().sessions.length>0){var i=x.get().sessions[0];this.displayError&&this._showMessageBox(i,t.message,t.code,t.log),this.sendError&&this._sendErrorMessage(i,t.log)}return t}},{key:"getJsErrorCode",value:function(e){if(e){if("EvalError"===e.name)return"E1";if("InternalError"===e.name)return"I2";if("RangeError"===e.name)return"A3";if("ReferenceError"===e.name)return"R4";if("SyntaxError"===e.name)return"S5";if("TypeError"===e.name)return"T6";if("URIError"===e.name)return"U7"}return"J0"}},{key:"_showMessageBox",value:function(e,t,n,i){var r={header:e.optText("ui.UnexpectedProblem","Internal UI Error"),body:En.join("\n\n",e.optText("ui.InternalUiErrorMsg",t," ("+e.optText("ui.ErrorCodeX","Code "+n,n)+")"),e.optText("ui.UiInconsistentMsg","")),yesButtonText:e.optText("ui.Reload","Reload"),yesButtonAction:O.reloadPage,noButtonText:e.optText("ui.Ignore","Ignore"),hiddenText:i};e.showFatalMessage(r,n)}},{key:"_sendErrorMessage",value:function(e,t){e.sendLogRequest(t)}}])&&F(t.prototype,n),i&&F(t,i),e}();function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function N(e,t,n){return(N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=z(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=z(e);if(t){var r=z(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return W(this,n)}}function W(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}M=!0,(j="CONSOLE_OUTPUT")in(A=I)?Object.defineProperty(A,j,{value:M,enumerable:!0,configurable:!0,writable:!0}):A[j]=M;var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(o,e);var t,n,i,r=V(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).remote=!0,e}return t=o,(n=[{key:"_doBootstrap",value:function(e){return N(z(o.prototype),"_doBootstrap",this).call(this,e).concat([this._doBootstrapDefaultValues()])}},{key:"_doBootstrapDefaultValues",value:function(){Pt.bootstrap()}},{key:"_createErrorHandler",value:function(){return O.create("ErrorHandler",{sendError:!0})}},{key:"_loadSession",value:function(e,t){(t=t||{}).$entryPoint=e;var n=this._createSession(t);return x.get().sessions.push(n),n.start()}},{key:"_fail",value:function(e,t){s.a.log.error("App initialization failed",t);var n=oi.argumentsToArray(arguments).slice(1);return s.a.rejectedPromise.apply(s.a,n)}}])&&B(t.prototype,n),i&&B(t,i),o}(x);function U(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var K=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"install",value:function(e){e.forEach((function(e){O.create(e)}))}}],(n=[{key:"extend",value:function(e,t){var n=e[t],i=this;e[t]=function(){return i.extended=this,i.next=n.bind(this),i[t].apply(i,arguments)}}}])&&U(t.prototype,n),i&&U(t,i),e}();function q(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Y=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.typeDescriptor=t,this.objectType=n,this.modelVariant=i}var t,n,i;return t=e,i=[{key:"newInstance",value:function(t,n){return e.parse(t).createInstance(n)}},{key:"parse",value:function(t){var n=null,i=null;if(En.contains(t,Z.MODEL_VARIANT_SEPARATOR)){var r=t.split(Z.MODEL_VARIANT_SEPARATOR);n=o(r[0]),i=o(r[1]),et.empty(i.namespaces)&&!et.empty(n.namespaces)&&(i.namespaces=n.namespaces)}else n=o(t);return new e(t,n,i);function o(e){var t=[];if(En.contains(e,Z.NAMESPACE_SEPARATOR)){var n=e.split(Z.NAMESPACE_SEPARATOR);t=n.slice(0,n.length-1),e=et.last(n)}return function(e,t){return{name:e,namespaces:O.nvl(t,[]),toString:function(){var n=t.slice();return n.push(e),En.join(Z.NAMESPACE_SEPARATOR,n)}}}(e,t)}}}],(n=[{key:"createInstance",value:function(t){var n,i,r,o=window.scout;if(this.modelVariant?(r=this.modelVariant.name+this.objectType.name,i=this.modelVariant.namespaces):(r=this.objectType.name,i=this.objectType.namespaces),i.length)for(o=window,n=0;n<i.length;n++)if(!(o=o[i[n]]))throw this.error('Could not resolve namespace "'+i[n]+'"');if(!o[r]){if(t.variantLenient&&this.modelVariant)return new e(this.typeDescriptor,this.objectType,null).createInstance(t);throw this.error('Could not find "'+r+'" in namespace "'+i.join(".")+'"')}return new o[r](t.model)}},{key:"error",value:function(e){return new Error('Failed to create object for objectType "'+this.typeDescriptor+'": '+e)}}])&&q(t.prototype,n),i&&q(t,i),e}();function X(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uniqueIdSeqNo=0,this._registry={}}var t,n,i;return t=e,i=[{key:"get",value:function(){return Q}},{key:"_set",value:function(e){Q=e}}],(n=[{key:"_createObjectByType",value:function(e,t){if("string"!=typeof e)throw new Error("missing or invalid object type");t=t||{};var n=this._registry[e];if(n){var i=n(t.model);if(!i)throw new Error('Failed to create object for objectType "'+e+'": Factory function did not return a valid object');return i}return Y.newInstance(e,t)}},{key:"create",value:function(e,t,n){if("string"==typeof e)n=n||{};else{if(!oi.isPlainObject(e))throw new Error("Invalid arguments");if(n=t||{},!(t=e).objectType)throw new Error('Missing mandatory property "objectType" on model');e=t.objectType}n.model=t;var i=this._createObjectByType(e,n);return oi.isFunction(i.init)&&(t&&(void 0===t.id&&O.nvl(n.ensureUniqueId,!0)&&(t.id=this.createUniqueId()),t.objectType=e),i.init(t)),void 0===i.id&&O.nvl(n.ensureUniqueId,!0)&&(i.id=this.createUniqueId()),void 0===i.objectType&&(i.objectType=e),i}},{key:"createUniqueId",value:function(){return"ui"+(++this.uniqueIdSeqNo).toString()}},{key:"register",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("(ObjectFactory) registered create-function for objectType "+e),this._registry[e]=t}},{key:"unregister",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(ObjectFactory) unregistered objectType "+e),delete this._registry[e]}},{key:"get",value:function(e){return this._registry[e]}},{key:"init",value:function(){for(var e in O.objectFactories)O.objectFactories.hasOwnProperty(e)&&this.register(e,O.objectFactories[e])}}])&&X(t.prototype,n),i&&X(t,i),e}();J(Z,"NAMESPACE_SEPARATOR","."),J(Z,"MODEL_VARIANT_SEPARATOR",":");var Q=new Z;function ee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var te=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O.assertParameter("widget",t.widget),this.widget=t.widget,this.options$Container=t.$container,this.loadingIndicatorDelay=O.nvl(t.loadingIndicatorDelay,250),this._$loadingIndicator=null,this._loadingIndicatorTimeoutId=null}var t,n,i;return t=e,(n=[{key:"setLoadingIndicatorDelay",value:function(e){this.loadingIndicatorDelay=e}},{key:"_ensure$Container",value:function(){oi.isFunction(this.options$Container)?this.$container=this.options$Container():this.options$Container?this.$container=this.options$Container:this.$container=this.widget.$container}},{key:"renderLoading",value:function(){clearTimeout(this._loadingIndicatorTimeoutId),this._ensure$Container(),this.widget.isLoading()?this.loadingIndicatorDelay&&!this.widget.rendering?this._loadingIndicatorTimeoutId=setTimeout(this._renderLoadingIndicator.bind(this),this.loadingIndicatorDelay):this._renderLoadingIndicator():this._removeLoadingIndicator()}},{key:"_renderLoadingIndicator",value:function(){this._$loadingIndicator||!this.widget.rendered&&!this.widget.rendering||(this.$container.addClass("loading"),this._$loadingIndicator=this.$container.appendDiv("loading-indicator"))}},{key:"_removeLoadingIndicator",value:function(){this._$loadingIndicator&&this._$loadingIndicator.fadeOutAndRemove(function(){this._$loadingIndicator=null,this.widget.rendered&&(this.$container.removeClass("loading"),this.widget.invalidateLayoutTree())}.bind(this))}},{key:"remove",value:function(){this._$loadingIndicator&&(this._$loadingIndicator.remove(),this._$loadingIndicator=null)}}])&&ee(t.prototype,n),i&&ee(t,i),e}();function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ae(e);if(t){var r=ae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return se(this,n)}}function se(e,t){return!t||"object"!==ne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(o,e);var t,n,i,r=oe(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"_renderLoadingIndicator",value:function(){(this.widget.rendered||this.widget.rendering)&&this.$container.addClass("loading")}},{key:"_removeLoadingIndicator",value:function(){(this.widget.rendered||this.widget.rendering)&&this.$container.removeClass("loading")}}])&&ie(t.prototype,n),i&&ie(t,i),o}(te);function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialized=!1,this.attached=!1,this.destroyed=!1,this.widget=null,this._enabledBeforeOffline=!0,this._remoteProperties=[],this._widgetListener=null,this._propertyChangeEventFilter=new po,this._widgetEventTypeFilter=new Oo,this.events=new Yt}var t,n,i;return t=e,i=[{key:"modifyWidgetPrototype",value:function(){x.get().remote&&oi.replacePrototypeFunction(de,"_createChild",(function(e){return e instanceof de?e:this.modelAdapter&&"string"==typeof e?this.session.getOrCreateWidget(e,this):this._createChildOrig(e)}),!0)}}],(n=[{key:"init",value:function(e){this._init(e),this.initialized=!0}},{key:"_init",value:function(e){O.assertParameter("id",e.id),O.assertParameter("session",e.session),s.a.extend(this,e),this.session.registerModelAdapter(this)}},{key:"destroy",value:function(){this._detachWidget(),this.widget.destroy(),this.widget=null,this.session.unregisterModelAdapter(this),this.destroyed=!0}},{key:"createWidget",value:function(e,t){var n=this._initModel(e,t);return this.widget=this._createWidget(n),this._attachWidget(),this._postCreateWidget(),this.widget}},{key:"_postCreateWidget",value:function(){}},{key:"_initModel",value:function(e,t){var n=this.session.adapterExportEnabled;return e=s.a.extend(n,{},e),Pt.applyTo(e),e.parent=t,e.owner=t,e.modelAdapter=this,e.global&&(e.owner=this.session.getModelAdapter("1").widget),this._initProperties(e),e}},{key:"_initProperties",value:function(e){}},{key:"_createWidget",value:function(e){var t=O.create(e);return t._addCloneProperties(["modelClass","classId"]),t}},{key:"_attachWidget",value:function(){this._widgetListener||(this._widgetListener={func:this._onWidgetEventInternal.bind(this)},this.widget.addListener(this._widgetListener),this.attached=!0,this.events.trigger("attach"))}},{key:"_detachWidget",value:function(){this._widgetListener&&(this.widget.removeListener(this._widgetListener),this._widgetListener=null,this.attached=!1,this.events.trigger("detach"))}},{key:"goOffline",value:function(){this.widget.visitChildren((function(e){e.modelAdapter&&e.modelAdapter._goOffline()}))}},{key:"_goOffline",value:function(){}},{key:"goOnline",value:function(){this.widget.visitChildren((function(e){e.modelAdapter&&e.modelAdapter._goOnline()}))}},{key:"_goOnline",value:function(){}},{key:"isRemoteProperty",value:function(e){return this._remoteProperties.indexOf(e)>-1}},{key:"_addRemoteProperties",value:function(e){this._addProperties("_remoteProperties",e)}},{key:"_removeRemoteProperties",value:function(e){this._removeProperties("_remoteProperties",e)}},{key:"_addProperties",value:function(e,t){Array.isArray(t)?this[e]=this[e].concat(t):this[e].push(t)}},{key:"_removeProperties",value:function(e,t){t=et.ensure(t),et.removeAll(this[e],t)}},{key:"_send",value:function(e,t,n){var i={};arguments.length>2&&(null!==n&&"object"===le(n)?i=n:(i.delay=arguments[2],i.coalesce=arguments[3],i.showBusyIndicator=arguments[4])),n=i;var r=new lo(this.id,e,t);void 0!==n.coalesce&&(r.coalesce=n.coalesce),void 0!==n.showBusyIndicator&&(r.showBusyIndicator=n.showBusyIndicator),void 0!==n.newRequest&&(r.newRequest=n.newRequest),this.session.sendEvent(r,n.delay)}},{key:"_sendProperty",value:function(e,t){var n={};n[e]=t,this._send("property",n)}},{key:"addFilterForWidgetEvent",value:function(e){this._widgetEventTypeFilter.addFilter(e)}},{key:"addFilterForWidgetEventType",value:function(e){this._widgetEventTypeFilter.addFilterForEventType(e)}},{key:"addFilterForProperties",value:function(e){this._propertyChangeEventFilter.addFilterForProperties(e)}},{key:"addFilterForPropertyName",value:function(e){this._propertyChangeEventFilter.addFilterForPropertyName(e)}},{key:"_isPropertyChangeEventFiltered",value:function(e,t){return t instanceof de&&(t=t.id),this._propertyChangeEventFilter.filter(e,t)}},{key:"_isWidgetEventFiltered",value:function(e){return this._widgetEventTypeFilter.filter(e)}},{key:"resetEventFilters",value:function(){this._propertyChangeEventFilter.reset(),this._widgetEventTypeFilter.reset()}},{key:"_onWidgetPropertyChange",value:function(e){var t=e.propertyName,n=e.newValue;this._isPropertyChangeEventFiltered(t,n)||this.isRemoteProperty(t)&&(n=this._prepareRemoteProperty(t,n),this._callSendProperty(t,n))}},{key:"_prepareRemoteProperty",value:function(e,t){return t&&this.widget.isWidgetProperty(e)?Array.isArray(t)?t.map((function(e){return e.modelAdapter.id})):t.modelAdapter.id:t}},{key:"_callSendProperty",value:function(e,t){var n="_send"+En.toUpperCaseFirstLetter(e);this[n]?this[n](t):this._sendProperty(e,t)}},{key:"_onWidgetDestroy",value:function(){this.destroy()}},{key:"_onWidgetEventInternal",value:function(e){this._isWidgetEventFiltered(e)||this._onWidgetEvent(e)}},{key:"_onWidgetEvent",value:function(e){"destroy"===e.type?this._onWidgetDestroy(e):"propertyChange"===e.type&&this._onWidgetPropertyChange(e)}},{key:"_syncPropertiesOnPropertyChange",value:function(e){this._orderPropertyNamesOnSync(e).forEach((function(t){var n=e[t],i="_sync"+En.toUpperCaseFirstLetter(t);this[i]?this[i](n):this.widget.callSetter(t,n)}),this)}},{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e)}},{key:"onModelEvent",value:function(e){e&&("property"===e.type?this.onModelPropertyChange(e):this.onModelAction(e))}},{key:"onModelPropertyChange",value:function(e){this.addFilterForProperties(e.properties),this._syncPropertiesOnPropertyChange(e.properties)}},{key:"onModelAction",value:function(e){"scrollToTop"===e.type?this.widget.scrollToTop():s.a.log.warn('Model action "'+e.type+'" is not supported by model-adapter '+this.objectType)}},{key:"toString",value:function(){return"ModelAdapter[objectType="+this.objectType+" id="+this.id+"]"}},{key:"exportAdapterData",value:function(e){var t=e.modelClass;if(t){var n=Math.max(0,t.lastIndexOf("$")+1,t.lastIndexOf(".")+1);e.id=t.substring(n)}return delete e.owner,delete e.classId,delete e.modelClass,e}}])&&ce(t.prototype,n),i&&ce(t,i),e}();function he(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}x.addListener("bootstrap",fe.modifyWidgetPrototype);var de=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=null,this.owner=null,this.parent=null,this.children=[],this.initialized=!1,this.rendering=!1,this.removing=!1,this.removalPending=!1,this.rendered=!1,this.attached=!1,this.destroyed=!1,this.destroying=!1,this.enabled=!0,this.enabledComputed=!0,this.inheritAccessibility=!0,this.disabledStyle=e.DisabledStyle.DEFAULT,this.visible=!0,this.focused=!1,this.loading=!1,this.cssClass=null,this.scrollTop=null,this.scrollLeft=null,this.$container,this.animateRemoval=!1,this.animateRemovalClass="animate-remove",this._widgetProperties=[],this._cloneProperties=["visible","enabled","inheritAccessibility","cssClass"],this.eventDelegators=[],this._preserveOnPropertyChangeProperties=[],this._postRenderActions=[],this._focusInListener=this._onFocusIn.bind(this),this._parentDestroyHandler=this._onParentDestroy.bind(this),this._parentRemovingWhileAnimatingHandler=this._onParentRemovingWhileAnimating.bind(this),this._scrollHandler=this._onScroll.bind(this),this.events=this._createEventSupport(),this.events.registerSubTypePredicate("propertyChange",(function(e,t){return e.propertyName===t})),this.loadingSupport=this._createLoadingSupport(),this.keyStrokeContext=this._createKeyStrokeContext(),this.logicalGrid,this.trackFocus=!1,this._$lastFocusedElement=null,this._storedFocusedWidget=null,this._glassPaneContributions=[]}var t,n,i;return t=e,i=[{key:"getWidgetFor",value:function(e){return ye.get(e)}},{key:"cssClassAsArray",value:function(e){var t=[],n=e||"";return(n=n.trim()).length>0&&(t=n.split(" ")),t}}],(n=[{key:"init",value:function(e){var t=this._jsonModel();t&&(e=s.a.extend({},t,e)),e=e||{},e=this._prepareModel(e),this._init(e),this._initKeyStrokeContext(),this.recomputeEnabled(),this.initialized=!0,this.trigger("init")}},{key:"_prepareModel",value:function(e){return e}},{key:"_init",value:function(e){if(!e.parent)throw new Error("Parent expected: "+this);if(this.setOwner(e.owner||e.parent),this.setParent(e.parent),this.session=e.session||this.parent.session,!this.session)throw new Error("Session expected: "+this);this._eachProperty(e,function(e,t,n){void 0!==t&&(n&&(t=this._prepareWidgetProperty(e,t)),this._initProperty(e,t))}.bind(this)),this._setCssClass(this.cssClass),this._setLogicalGrid(this.logicalGrid),this._setEnabled(this.enabled)}},{key:"_initProperty",value:function(e,t){this[e]=t}},{key:"_jsonModel",value:function(){}},{key:"_createChildren",value:function(e){if(!e)return null;if(!Array.isArray(e))return this._createChild(e);var t=[];return e.forEach((function(e,n){t[n]=this._createChild(e)}),this),t}},{key:"_createChild",value:function(t){if(t instanceof e)return t;if("string"==typeof t){var n=this.widget(t);if(!n)throw new Error("Referenced widget not found: "+t);return n}return t.parent=this,O.create(t)}},{key:"_initKeyStrokeContext",value:function(){this.keyStrokeContext&&(this.keyStrokeContext.$scopeTarget=function(){return this.$container}.bind(this),this.keyStrokeContext.$bindTarget=function(){return this.$container}.bind(this))}},{key:"destroy",value:function(){if(!this.destroyed){if(this.destroying=!0,this.rendered&&(this.animateRemoval||this._isRemovalPrevented()))return this.one("remove",function(){this.destroy()}.bind(this)),void this.remove();this._destroyChildren(this.children.slice().reverse()),this.remove(),this._destroy(),this.owner._removeChild(this),this.owner=null,this.parent._removeChild(this),this.parent.off("destroy",this._parentDestroyHandler),this.parent=null,this.destroying=!1,this.destroyed=!0,this.trigger("destroy")}}},{key:"_destroy",value:function(){}},{key:"_destroyChildren",value:function(e){e&&(e=et.ensure(e)).forEach((function(e,t){this._destroyChild(e)}),this)}},{key:"_destroyChild",value:function(e){e.owner===this&&e.destroy()}},{key:"render",value:function(e){if(s.a.log.isTraceEnabled()&&s.a.log.trace("Rendering widget: "+this),!this.initialized)throw new Error("Not initialized: "+this);if(this.rendered)throw new Error("Already rendered: "+this);if(this.destroyed)throw new Error("Widget is destroyed: "+this);this.rendering=!0,this.$parent=e||this.parent.$container,this._render(),this._renderProperties(),this._renderInspectorInfo(),this._linkWithDOM(),this.session.keyStrokeManager.installKeyStrokeContext(this.keyStrokeContext),this.rendering=!1,this.rendered=!0,this.attached=!0,this.trigger("render"),this.restoreFocus(),this._postRender()}},{key:"_render",value:function(){}},{key:"_renderProperties",value:function(){this._renderTrackFocus(),this._renderEnabled(),this._renderVisible(),this._renderFocused(),this._renderCssClass(),this._renderLoading(),this._renderScrollTop(),this._renderScrollLeft()}},{key:"_postRender",value:function(){var e=this._postRenderActions;this._postRenderActions=[],e.forEach((function(e){e()}))}},{key:"remove",value:function(){this.rendered&&!this._isRemovalPrevented()&&(this.animateRemoval?this._removeAnimated():this._removeInternal())}},{key:"_isRemovalPrevented",value:function(){return this._isRemovalPending()}},{key:"_isRemovalPending",value:function(){if(this.removalPending)return!0;var e=this.parent;if(!e||e.removing||e.rendering)return!1;for(;e;){if(e.removalPending)return!0;e=e.parent}return!1}},{key:"_removeInternal",value:function(){this.rendered&&(s.a.log.isTraceEnabled()&&s.a.log.trace("Removing widget: "+this),this.removing=!0,this.removalPending=!1,this.trigger("removing"),this.$container&&this.$container.off("focusin",this._focusInListener),this._$lastFocusedElement&&(this._storedFocusedWidget=O.widget(this._$lastFocusedElement),this._$lastFocusedElement=null),this.children.slice().reverse().forEach((function(e){e.parent===this&&e.remove()}),this),this.rendered&&(this._cleanup(),this._remove(),this.$parent=null,this.rendered=!1,this.attached=!1,this.removing=!1,this.trigger("remove")))}},{key:"_removeAnimated",value:function(){Mt.get().supportsCssAnimation()&&this.$container&&!this.$container.isDisplayNone()?(this.session.desktop.destroyPopupsFor(this),this.removalPending=!0,setTimeout(function(){if(this.rendered){if(!this.animateRemovalClass)throw new Error("Missing animate removal class. Cannot remove animated.");this.$container.isVisible()&&this.$container.isEveryParentVisible()?(this.$container.addClass(this.animateRemovalClass),this.$container.oneAnimationEnd(function(){this._removeInternal()}.bind(this))):this._removeInternal()}}.bind(this)),this.parent.one("removing",this._parentRemovingWhileAnimatingHandler)):this._removeInternal()}},{key:"_onParentRemovingWhileAnimating",value:function(){this._removeInternal()}},{key:"_renderInspectorInfo",value:function(){this.session.inspector&&an.applyInfo(this)}},{key:"_linkWithDOM",value:function(){this.$container&&this.$container.data("widget",this)}},{key:"_cleanup",value:function(){this.parent.off("removing",this._parentRemovingWhileAnimatingHandler),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.keyStrokeContext),this.loadingSupport&&this.loadingSupport.remove(),this._uninstallScrollbars(),this.$container&&this.session.layoutValidator.cleanupInvalidComponents(this.$container)}},{key:"_remove",value:function(){this.$container&&(this.$container.remove(),this.$container=null)}},{key:"setOwner",value:function(e){O.assertParameter("owner",e),e!==this.owner&&(this.owner&&this.owner._removeChild(this),this.owner=e,this.owner._addChild(this))}},{key:"setParent",value:function(e){if(O.assertParameter("parent",e),e!==this.parent){if(this.rendered&&!e.rendered&&(s.a.log.isInfoEnabled()&&s.a.log.info("rendered child "+this+" is added to not rendered parent "+e+". Removing child.",new Error("origin")),this.remove()),this.parent){if(this.parent._isRemovalPending())return void this.parent.one("remove",function(){this.setParent(e)}.bind(this));this.parent.off("destroy",this._parentDestroyHandler),this.parent.off("removing",this._parentRemovingWhileAnimatingHandler),this.parent!==this.owner&&this.parent._removeChild(this)}var t=this.parent;this.parent=e,this.parent._addChild(this),this.trigger("hierarchyChange",{oldParent:t,parent:e}),this.initialized&&this.recomputeEnabled(this.parent.enabledComputed),this.parent.one("destroy",this._parentDestroyHandler)}}},{key:"_addChild",value:function(e){s.a.log.isTraceEnabled()&&s.a.log.trace("addChild("+e+") to "+this),et.pushSet(this.children,e)}},{key:"_removeChild",value:function(e){s.a.log.isTraceEnabled()&&s.a.log.trace("removeChild("+e+") from "+this),et.remove(this.children,e)}},{key:"ancestors",value:function(){for(var e=[],t=this.parent;t;)e.push(t),t=t.parent;return e}},{key:"isOrHas",value:function(e){return e===this||this.has(e)}},{key:"has",value:function(e){for(;e;){if(e.parent===this)return!0;e=e.parent}return!1}},{key:"getForm",value:function(){return ZO.findForm(this)}},{key:"findNonWrappedForm",value:function(){return ZO.findNonWrappedForm(this)}},{key:"findDesktop",value:function(){return this.session.desktop?this.session.desktop:this.findParent((function(e){return e instanceof poe}))}},{key:"setEnabled",value:function(e,t,n){this.setProperty("enabled",e),e&&t&&this.parent&&this.parent.setEnabled(!0,!0,!1),n&&this.visitChildren((function(t){t.setEnabled(e)}))}},{key:"_setEnabled",value:function(e){this._setProperty("enabled",e),this.initialized&&this.recomputeEnabled()}},{key:"recomputeEnabled",value:function(e){void 0===e&&(e=!0,this.parent&&this.parent.initialized&&void 0!==this.parent.enabledComputed&&(e=this.parent.enabledComputed));var t=this._computeEnabled(this.inheritAccessibility,e);this._updateEnabledComputed(t)}},{key:"_updateEnabledComputed",value:function(e,t){if(this.enabledComputed!==e||void 0!==t){this.setProperty("enabledComputed",e),this.rendered&&this._renderEnabled();var n=O.nvl(t,e);this.children.forEach((function(e){e.inheritAccessibility&&e.recomputeEnabled(n)}))}}},{key:"_computeEnabled",value:function(e,t){return this.enabled&&(!e||t)}},{key:"_renderEnabled",value:function(){this.$container&&(this.$container.setEnabled(this.enabledComputed),this._renderDisabledStyle())}},{key:"setInheritAccessibility",value:function(e){this.setProperty("inheritAccessibility",e)}},{key:"_setInheritAccessibility",value:function(e){this._setProperty("inheritAccessibility",e),this.initialized&&this.recomputeEnabled()}},{key:"setDisabledStyle",value:function(e){this.setProperty("disabledStyle",e),this.children.forEach((function(t){t.setDisabledStyle(e)}))}},{key:"_renderDisabledStyle",value:function(){this._renderDisabledStyleInternal(this.$container)}},{key:"_renderDisabledStyleInternal",value:function(t){t&&(this.enabledComputed?t.removeClass("read-only"):t.toggleClass("read-only",this.disabledStyle===e.DisabledStyle.READ_ONLY))}},{key:"setVisible",value:function(e){this.setProperty("visible",e)}},{key:"isVisible",value:function(){return this.visible}},{key:"_renderVisible",value:function(){this.$container&&(this.$container.setVisible(this.isVisible()),this.invalidateParentLogicalGrid())}},{key:"isEveryParentVisible",value:function(){for(var e=this.parent;e;){if(!e.isVisible())return!1;e=e.parent}return!0}},{key:"setFocused",value:function(e){this.setProperty("focused",e)}},{key:"_renderFocused",value:function(){this.$container&&this.$container.toggleClass("focused",this.focused)}},{key:"_setCssClass",value:function(e){this.rendered&&this._removeCssClass(),this._setProperty("cssClass",e)}},{key:"_removeCssClass",value:function(){this.$container&&this.$container.removeClass(this.cssClass)}},{key:"_renderCssClass",value:function(){this.$container&&this.$container.addClass(this.cssClass)}},{key:"setCssClass",value:function(e){this.setProperty("cssClass",e)}},{key:"addCssClass",value:function(t){var n=this.cssClassAsArray();e.cssClassAsArray(t).forEach((function(e){n.indexOf(e)>=0||n.push(e)}),this),this.setProperty("cssClass",et.format(n," "))}},{key:"removeCssClass",value:function(t){var n=this.cssClassAsArray(),i=e.cssClassAsArray(t);et.removeAll(n,i)&&this.setProperty("cssClass",et.format(n," "))}},{key:"toggleCssClass",value:function(e,t){t?this.addCssClass(e):this.removeCssClass(e)}},{key:"cssClassAsArray",value:function(){return e.cssClassAsArray(this.cssClass)}},{key:"_createLoadingSupport",value:function(){return null}},{key:"setLoading",value:function(e){this.setProperty("loading",e)}},{key:"isLoading",value:function(){return this.loading}},{key:"_renderLoading",value:function(){this.loadingSupport&&this.loadingSupport.renderLoading()}},{key:"pack",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.pack()}}},{key:"invalidateLayout",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.invalidateLayout()}}},{key:"validateLayout",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.validateLayout()}}},{key:"revalidateLayout",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.revalidateLayout()}}},{key:"invalidateLayoutTree",value:function(e){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.invalidateLayoutTree(e)}}},{key:"validateLayoutTree",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.validateLayoutTree()}}},{key:"revalidateLayoutTree",value:function(e){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.revalidateLayoutTree(e)}}},{key:"setLayoutData",value:function(e){if(this.rendered){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.layoutData=e}}},{key:"validateLogicalGrid",value:function(){this.logicalGrid&&this.logicalGrid.validate(this)}},{key:"invalidateLogicalGrid",value:function(e){this.initialized&&this.logicalGrid&&(this.logicalGrid.setDirty(!0),O.nvl(e,!0)&&this.invalidateLayoutTree())}},{key:"invalidateParentLogicalGrid",value:function(e){if(this.parent.invalidateLogicalGrid(!1),this.rendered&&this.htmlComp&&O.nvl(e,!0)){var t=this.htmlComp.getParent();t&&t.invalidateLayoutTree()}}},{key:"revalidateLogicalGrid",value:function(e){this.invalidateLogicalGrid(e),this.validateLogicalGrid()}},{key:"setLogicalGrid",value:function(e){this.setProperty("logicalGrid",e)}},{key:"_setLogicalGrid",value:function(e){"string"==typeof e&&(e=O.create(e)),this._setProperty("logicalGrid",e),this.invalidateLogicalGrid()}},{key:"_createEventSupport",value:function(){return new Yt}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}},{key:"when",value:function(e){return this.events.when(e)}},{key:"entryPoint",value:function(){var e=O.nvl(this.$container,this.parent.$container);if(!e||!e.length)throw new Error("Cannot resolve entryPoint, $element.length is 0 or undefined");return e.entryPoint()}},{key:"window",value:function(e){var t=this.$container||this.$parent;return t?t.window(e):e?null:s()(null)}},{key:"document",value:function(e){var t=this.$container||this.$parent;return t?t.document(e):e?null:s()(null)}},{key:"attach",value:function(){!this.attached&&this.rendered&&(this._attach(),this._installFocusContext(),this.restoreFocus(),this.attached=!0,this._postAttach(),this._onAttach(),this._triggerChildrenOnAttach(this))}},{key:"_attach",value:function(){}},{key:"_postAttach",value:function(){}},{key:"_triggerChildrenOnAttach",value:function(e){this.children.forEach((function(t){t._onAttach(),t._triggerChildrenOnAttach(e)}))}},{key:"_onAttach",value:function(){this.rendered&&this._renderOnAttach()}},{key:"_renderOnAttach",value:function(){this._renderScrollTop(),this._renderScrollLeft()}},{key:"detach",value:function(){this.rendering&&this._postRenderActions.push(this.detach.bind(this)),this.attached&&this.rendered&&!this._isRemovalPending()&&(this._beforeDetach(),this._onDetach(),this._triggerChildrenOnDetach(this),this._detach(),this.attached=!1)}},{key:"_beforeDetach",value:function(e){if(this.$container){var t=this.$container.document(!0).activeElement,n=this.$container.isOrHas(t),i=this.session.focusManager;i.isFocusContextInstalled(this.$container)?this._uninstallFocusContext():n&&i.validateFocus(Bi.outsideFilter(this.$container))}}},{key:"_triggerChildrenOnDetach",value:function(){this.children.forEach((function(e){e._onDetach(),e._triggerChildrenOnDetach(parent)}))}},{key:"_onDetach",value:function(){this.rendered&&this._renderOnDetach()}},{key:"_renderOnDetach",value:function(){}},{key:"_detach",value:function(){}},{key:"_uninstallFocusContext",value:function(){}},{key:"_installFocusContext",value:function(){}},{key:"_createKeyStrokeContext",value:function(){return null}},{key:"updateKeyStrokes",value:function(e,t){this.unregisterKeyStrokes(t),this.registerKeyStrokes(e)}},{key:"registerKeyStrokes",value:function(e){this.keyStrokeContext.registerKeyStrokes(e)}},{key:"unregisterKeyStrokes",value:function(e){this.keyStrokeContext.unregisterKeyStrokes(e)}},{key:"triggerPropertyChange",value:function(e,t,n){O.assertParameter("propertyName",e);var i=new Kt({propertyName:e,oldValue:t,newValue:n});return this.trigger("propertyChange",i),i}},{key:"_setProperty",value:function(e,t){O.assertParameter("propertyName",e);var n=this[e];oi.equals(n,t)||(this[e]=t,this.triggerPropertyChange(e,n,t).defaultPrevented&&(this[e]=n))}},{key:"setProperty",value:function(e,t){oi.equals(this[e],t)||(t=this._prepareProperty(e,t),this.rendered&&this._callRemoveProperty(e),this._callSetProperty(e,t),this.rendered&&this._callRenderProperty(e))}},{key:"_prepareProperty",value:function(e,t){return this.isWidgetProperty(e)?this._prepareWidgetProperty(e,t):t}},{key:"_prepareWidgetProperty",value:function(e,t){t=this._createChildren(t);var n=this[e];return n&&Array.isArray(t)&&(n=et.diff(n,t)),this.isPreserveOnPropertyChangeProperty(e)||(this._destroyChildren(n),this.link(t)),t}},{key:"_callRemoveProperty",value:function(e){if(this.isWidgetProperty(e)&&!this.isPreserveOnPropertyChangeProperty(e)){var t=this[e];if(t){var n="_remove"+En.toUpperCaseFirstLetter(e);this[n]?this[n]():this._internalRemoveWidgets(t)}}}},{key:"_internalRemoveWidgets",value:function(e){(e=et.ensure(e)).forEach((function(e){e.remove()}))}},{key:"_callSetProperty",value:function(e,t){var n="_set"+En.toUpperCaseFirstLetter(e);this[n]?this[n](t):this._setProperty(e,t)}},{key:"_callRenderProperty",value:function(e){var t="_render"+En.toUpperCaseFirstLetter(e);this[t]&&this[t]()}},{key:"link",value:function(e){e&&(e=et.ensure(e)).forEach((function(e,t){e.setParent(this)}),this)}},{key:"glassPaneTargets",value:function(e){var t=function(e){return et.flatMap(this._glassPaneContributions,(function(t){var n=t(e);return n?et.ensure(n):[]})).concat(this._glassPaneTargets(e))}.bind(this);return this.rendered?t(e):Ic.createFor(this,t.bind(this,e))}},{key:"_glassPaneTargets",value:function(e){return[this.$container].concat(this.session.desktop.getPopupsFor(this).reduce((function(e,t){return e.concat(t.glassPaneTargets())}),[]))}},{key:"addGlassPaneContribution",value:function(e){this._glassPaneContributions.push(e),this.trigger("glassPaneContributionAdded",{contribution:e})}},{key:"removeGlassPaneContribution",value:function(e){et.remove(this._glassPaneContributions,e),this.trigger("glassPaneContributionRemoved",{contribution:e})}},{key:"toString",value:function(){var e="";return e+="id="+this.id,e+=" objectType="+this.objectType,e+=" rendered="+this.rendered,this.$container&&(e+=" $container="+No.debugOutput(this.$container)),"Widget["+e.trim()+"]"}},{key:"ancestorsToString",value:function(e){var t="",n=this.ancestors();return e=O.nvl(e,-1),n.some((function(i,r){return e>-1&&r>=e||(r>0&&r<n.length-1&&(t+="\n"),t+=i.toString(),!1)})),t}},{key:"resolveTextKeys",value:function(e){e.forEach((function(e){th.resolveTextProperty(this,e)}),this)}},{key:"resolveIconIds",value:function(e){e.forEach((function(e){sn.resolveIconProperty(this,e)}),this)}},{key:"resolveConsts",value:function(e){e.forEach((function(e){oi.resolveConstProperty(this,e)}),this)}},{key:"_addWidgetProperties",value:function(e){this._addProperties("_widgetProperties",e)}},{key:"isWidgetProperty",value:function(e){return this._widgetProperties.indexOf(e)>-1}},{key:"_addCloneProperties",value:function(e){this._addProperties("_cloneProperties",e)}},{key:"isCloneProperty",value:function(e){return this._cloneProperties.indexOf(e)>-1}},{key:"_addPreserveOnPropertyChangeProperties",value:function(e){this._addProperties("_preserveOnPropertyChangeProperties",e)}},{key:"isPreserveOnPropertyChangeProperty",value:function(e){return this._preserveOnPropertyChangeProperties.indexOf(e)>-1}},{key:"_addProperties",value:function(e,t){(t=et.ensure(t)).forEach((function(t){if(this[e].indexOf(t)>-1)throw new Error(e+" already contains the property "+t);this[e].push(t)}),this)}},{key:"_eachProperty",value:function(e,t){var n,i,r;for(n in e)this._widgetProperties.indexOf(n)>-1||t(n,i=e[n]);for(r=0;r<this._widgetProperties.length;r++)void 0!==(i=e[n=this._widgetProperties[r]])&&t(n,i,!0)}},{key:"_removeWidgetProperties",value:function(e){Array.isArray(e)?et.removeAll(this._widgetProperties,e):et.remove(this._widgetProperties,e)}},{key:"cloneAndMirror",value:function(e){return this.clone(e,{delegateAllPropertiesToClone:!0})}},{key:"original",value:function(){for(var e=this;e.cloneOf;)e=e.cloneOf;return e}},{key:"clone",value:function(e,t){var n,i;return e=e||{},t=t||{},i=oi.extractProperties(this,e,this._cloneProperties),n=O.create(this.objectType,i),n.cloneOf=this,this._mirror(n,t),this.logicalGrid?n.setLogicalGrid(this.logicalGrid.objectType):n.setLogicalGrid(null),n}},{key:"_deepCloneProperties",value:function(e,t,n){if(!t)return e;(t=et.ensure(t)).forEach(function(t){var i=this[t],r=null;if(void 0===i)throw new Error("Property '"+t+"' is undefined. Deep copy not possible.");r=this._widgetProperties.indexOf(t)>-1?Array.isArray(i)?i.map((function(t){return t.clone({parent:e},n)})):i.clone({parent:e},n):Array.isArray(i)?i.map((function(e){return e})):i,e[t]=r}.bind(this))}},{key:"mirror",value:function(e,t){if(!(t=t||this.cloneOf))throw new Error("No target for mirroring.");this._mirror(t,e)}},{key:"_mirror",value:function(e,t){var n=et.find(this.eventDelegators,(function(t){return t.clone===e}));if(n)throw new Error("_mirror can only be called on not mirrored widgets. call unmirror first.");t=t||{},n={clone:e,originalToClone:at.create(this,e,{delegateProperties:t.delegatePropertiesToClone,delegateAllProperties:t.delegateAllPropertiesToClone}),cloneToOriginal:at.create(e,this,{delegateProperties:t.delegatePropertiesToOriginal,delegateAllProperties:t.delegateAllPropertiesToOriginal,excludeProperties:t.excludePropertiesToOriginal,delegateEvents:t.delegateEventsToOriginal})},this.eventDelegators.push(n),e.one("destroy",function(){this._unmirror(e)}.bind(this))}},{key:"unmirror",value:function(e){if(!(e=e||this.cloneOf))throw new Error("No target for unmirroring.");this._unmirror(e)}},{key:"_unmirror",value:function(e){var t=et.findIndex(this.eventDelegators,(function(t){return t.clone===e})),n=t>-1?this.eventDelegators.splice(t,1)[0]:null;n&&(n.originalToClone&&n.originalToClone.destroy(),n.cloneToOriginal&&n.cloneToOriginal.destroy())}},{key:"_onParentDestroy",value:function(e){this.destroyed||this.setParent(this.owner)}},{key:"callSetter",value:function(e,t){var n="set"+En.toUpperCaseFirstLetter(e);this[n]?this[n](t):this.setProperty(e,t)}},{key:"widget",value:function(e){return t(this)?this:this.findChild(t);function t(t){if(t.id===e)return t}}},{key:"nearestWidget",value:function(e,t){if(this.id===e)return this;for(var n=this.children.slice();n.length;){var i=n.shift();if(i.id===e)return i;if(t)for(var r=0;r<i.children.length;r++){var o=i.children[r];o.parent===i&&n.push(o)}}return null}},{key:"findParent",value:function(e){for(var t=this.parent;t;){if(e(t))return t;t=t.parent}return t}},{key:"findChild",value:function(e){var t=null;return this.visitChildren((function(n){if(e(n))return t=n,!0})),t}},{key:"setTrackFocus",value:function(e){this.setProperty("trackFocus",e)}},{key:"_renderTrackFocus",value:function(){this.$container&&(this.trackFocus?this.$container.on("focusin",this._focusInListener):this.$container.off("focusin",this._focusInListener))}},{key:"restoreFocus",value:function(){this._$lastFocusedElement?this.session.focusManager.requestFocus(this._$lastFocusedElement):this._storedFocusedWidget&&(this._storedFocusedWidget.focus(),this._storedFocusedWidget=null)}},{key:"_onFocusIn",value:function(e){if(!this.rendering){var t=s()(e.target);this.$container.has(t)&&(this._$lastFocusedElement=t)}}},{key:"focus",value:function(){return this.rendered?this.session.focusManager.requestFocus(this.getFocusableElement()):(this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1)}},{key:"focusAndPreventDefault",value:function(e){return!!this.focus()&&(e.preventDefault(),!0)}},{key:"isFocused",value:function(){return this.rendered&&Cc.isActiveElement(this.getFocusableElement())}},{key:"isFocusable",value:function(){if(!this.rendered||!this.visible)return!1;var e=this.getFocusableElement();return!!e&&s.a.ensure(e).is(":focusable")}},{key:"getFocusableElement",value:function(){return this.rendered&&this.$container?this.$container[0]:null}},{key:"_installScrollbars",value:function(e){var t=this.get$Scrollable();if(!t)throw new Error("Scrollable is not defined, cannot install scrollbars");if(!t.data("scrollable")){e=e||{};var n={parent:this};e=s.a.extend({},n,e),wf.install(t,e),t.on("scroll",this._scrollHandler)}}},{key:"_uninstallScrollbars",value:function(){var e=this.get$Scrollable();e&&e.data("scrollable")&&(wf.uninstall(e,this.session),e.off("scroll",this._scrollHandler),this.removing||(0===e[0].scrollTop&&(this.scrollTop=null),0===e[0].scrollLeft&&(this.scrollLeft=null)))}},{key:"_onScroll",value:function(){var e=this.get$Scrollable();this.scrollTop=e[0].scrollTop,this.scrollLeft=e[0].scrollLeft}},{key:"setScrollTop",value:function(e){this.getDelegateScrollable()?this.getDelegateScrollable().setScrollTop(e):this.scrollTop!==e&&(this.scrollTop=e,this.rendered&&this._renderScrollTop())}},{key:"_renderScrollTop",value:function(){var e=this.get$Scrollable();e&&null!==this.scrollTop&&(this.rendering||this.htmlComp&&!this.htmlComp.layouted&&!this.htmlComp.layouting?this.session.layoutValidator.schedulePostValidateFunction(this._renderScrollTop.bind(this)):wf.scrollTop(e,this.scrollTop))}},{key:"setScrollLeft",value:function(e){this.getDelegateScrollable()?this.getDelegateScrollable().setScrollLeft(e):this.scrollLeft!==e&&(this.scrollLeft=e,this.rendered&&this._renderScrollLeft())}},{key:"_renderScrollLeft",value:function(){var e=this.get$Scrollable();e&&null!==this.scrollLeft&&(this.rendering||this.htmlComp&&!this.htmlComp.layouted&&!this.htmlComp.layouting?this.session.layoutValidator.schedulePostValidateFunction(this._renderScrollLeft.bind(this)):wf.scrollLeft(e,this.scrollLeft))}},{key:"get$Scrollable",value:function(){return this.$container}},{key:"getDelegateScrollable",value:function(){return null}},{key:"scrollToTop",value:function(){if(this.getDelegateScrollable())this.getDelegateScrollable().scrollToTop();else{var e=this.get$Scrollable();e&&(this.rendered?wf.scrollTop(e,0):this.session.layoutValidator.schedulePostValidateFunction(this.scrollToTop.bind(this)))}}},{key:"scrollToBottom",value:function(){if(this.getDelegateScrollable())this.getDelegateScrollable().scrollToBottom();else{var e=this.get$Scrollable();e&&(this.rendered?wf.scrollToBottom(e):this.session.layoutValidator.schedulePostValidateFunction(this.scrollToBottom.bind(this)))}}},{key:"reveal",value:function(e){if(this.rendered){var t=this.$container.scrollParent();0!==t.length&&wf.scrollTo(t,this.$container,e)}}},{key:"visitChildren",value:function(e){for(var t=0;t<this.children.length;t++){var n=this.children[t];if(n.parent===this){var i=e(n);if(!0===i||i===JW.TERMINATE)return JW.TERMINATE;if(i!==JW.SKIP_SUBTREE&&(!0===(i=n.visitChildren(e))||i===JW.TERMINATE))return JW.TERMINATE}}}},{key:"isAttachedAndRendered",value:function(){return(this.rendered||this.rendering)&&this.$container.isAttached()}}])&&he(t.prototype,n),i&&he(t,i),e}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(de,"DisabledStyle",{DEFAULT:0,READ_ONLY:1});var pe=0;var ye={createUniqueId:function(e){return(e=e||"sc")+pe++},findFirstFocusableWidget:function(e,t){return!!(!t||t.rendered&&t.visible)&&et.find(e,(function(e){return e.isFocusable()}))},get:function(e){for(e=s.a.ensure(e);e&&e.length>0;){var t=e.data("widget");if(t)return t;e=e.parent()}return null},uniqueIdSeqNo:pe,updateFirstLastMarker:function(e){e.filter((function(e,t,n){return e.rendered&&e.isVisible()})).forEach((function(e,t,n){e.$container.toggleClass("first",0===t),e.$container.toggleClass("last",t===n.length-1)}))}};function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ge(e,t,n){return(ge="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ke(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ke(e);if(t){var r=ke(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return we(this,n)}}function we(e,t){return!t||"object"!==ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(o,e);var t,n,i,r=_e(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).widgets=[],e._addWidgetProperties(["widgets"]),e}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv(),this.htmlComp=Uo.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){ge(ke(o.prototype),"_renderProperties",this).call(this),this._renderWidgets()}},{key:"setWidgets",value:function(e){this.setProperty("widgets",e)}},{key:"_renderWidgets",value:function(){this.widgets.forEach((function(e){e.render()}),this),this.invalidateLayoutTree()}}])&&be(t.prototype,n),i&&be(t,i),o}(de);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=xe(e);if(t){var r=xe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Re(this,n)}}function Re(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(o,e);var t,n,i,r=Pe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["childWidget"]),e}return t=o,(n=[{key:"setChildWidget",value:function(e){this.setProperty("childWidget",e)}}])&&Te(t.prototype,n),i&&Te(t,i),o}(de);function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=je(e);if(t){var r=je(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $e(this,n)}}function $e(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(n,e);var t=Ae(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(fe);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e){return function(e){if(Array.isArray(e))return Be(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ne(e){return null==e?[]:Array.isArray(e)?e:[e]}function He(e,t){var n=!1;if(!t||0===t.length)return!1;for(var i=e.length-1;i>=0;i--)t.indexOf(e[i])>-1&&(e.splice(i,1),n=!0);return n}function Ve(e,t,n){We(e,[t],n)}function We(e,t,n){t=Ne(t),e.splice.apply(e,Le([n,0].concat(t)))}function ze(e,t){return e=Ne(e),(t=Ne(t)).every((function(t){return e.indexOf(t)>=0}))}function Ge(e){return!Array.isArray(e)||0===e.length}function Ue(e,t){e.push.apply(e,t)}function Ke(e,t,n){if(!e||!t)return-1;for(var i=0;i<e.length;i++)if(t.call(n,e[i],i,e))return i;return-1}function qe(e,t,n){var i=Ye(e,t,n);return-1===i?null:e[i]}function Ye(e,t,n){if(!e||!n)return-1;for(var i=t;i<e.length;i++){if(n(e[i],i))return i}return-1}function Xe(e,t,n){var i=Je(e,t,n);return-1===i?null:e[i]}function Je(e,t,n){if(!e||!n)return-1;for(var i=t;i>=0;i--){if(n(e[i],i))return i}return-1}function Ze(e,t,n){if(!e||0===e.length)return"";for(var i="",r=0;r<e.length;r++){var o=e[r];t&&r>0&&r<e.length&&(i+=t),n&&(o=En.encode(o)),i+=o}return i}function Qe(e,t){for(var n=0;n<e.length;n++)if(e[n][0]===t[0])return n}var et={$indexOf:Qe,$remove:function(e,t){var n=Qe(e,t);n>=0&&e.splice(n,1)},containsAll:ze,containsAny:function(e,t){return e=Ne(e),(t=Ne(t)).some((function(t){return e.indexOf(t)>=0}))},diff:function(e,t){var n=e.slice();return He(n,t),n},eachSibling:function(e,t,n){if(e&&n)for(var i=0;i<e.length;i++){var r=e[i];r!==t&&n(r,i)}},empty:Ge,ensure:Ne,equals:function(e,t){if(e===t)return!0;if(!(e&&0!==e.length||t&&0!==t.length))return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},equalsIgnoreOrder:function(e,t){return e===t||(!(e&&0!==e.length||t&&0!==t.length)||!(!e||!t)&&(e.length===t.length&&ze(e,t)))},find:function(e,t,n){var i=Ke(e,t,n);return-1===i?null:e[i]},findFrom:function(e,t,n,i){return i?Xe(e,t,n):qe(e,t,n)},findFromForward:qe,findFromReverse:Xe,findIndex:Ke,findIndexFrom:function(e,t,n,i){return i?Je(e,t,n):Ye(e,t,n)},findIndexFromForward:Ye,findIndexFromReverse:Je,first:function(e){return Array.isArray(e)?e[0]:e},flatMap:function(e,t){var n=[];return e.forEach((function(e){Ue(n,t(e))})),n},format:Ze,formatEncoded:function(e,t){return Ze(e,t,!0)},greater:function(e,t){var n=0,i=0;return e&&(n=e.length),t&&(i=t.length),n>i},hasElements:function(e){return!Ge(e)},init:function(e,t){for(var n=[],i=0;i<e;i++)n[i]=t;return n},insert:Ve,insertAll:We,insertArray:function(e,t,n){return We(e,t,n)},insertSorted:function(e,t,n){for(var i=0,r=e.length-1;i<=r;){var o=i+Math.floor((r-i)/2),s=n(e[o],t);if(s<0)i=o+1;else{if(!(s>0)){for(i=o+1;i<e.length&&0===n(e[i],t);)i++;break}r=o-1}}e.splice(i,0,t)},last:function(e){return Array.isArray(e)?e[e.length-1]:e},max:function(e){if(null==e)return Math.max.apply(Math,e);var t=e.filter(oi.isNumber);return Math.max.apply(Math,t)},min:function(e){if(null==e)return Math.min.apply(Math,e);var t=e.filter(oi.isNumber);return Math.min.apply(Math,t)},move:function(e,t,n){var i=e.splice(t,1)[0];Ve(e,i,n)},pushAll:Ue,pushIfDefined:function(e,t){t=oi.argumentsToArray(arguments).slice(1).filter((function(e){return null!=e})),e&&t.length&&e.push.apply(e,Le(t))},pushSet:function(e,t){t&&-1===e.indexOf(t)&&e.push(t)},remove:function(e,t){if(e){var n=e.indexOf(t);if(-1!==n)return e.splice(n,1),!0}return!1},removeAll:He,replace:function(e,t,n){var i=e.indexOf(t);return-1!==i&&(e[i]=n),i},union:function(e,t){var n=[],i={};return e=Ne(e),t=Ne(t),e.forEach((function(e){var t=e;"object"===Ie(e)&&(t=e.id),i[t]=e,n.push(e)})),t.forEach((function(e){var t=e;"object"===Ie(e)&&(t=e.id),t in i||n.push(e)})),n}};function tt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var nt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.retryIntervals=[],this.minCallDuration=500,this.callCounter=0,this.deferred=s.a.Deferred(),this.aborted=!1,this.pendingCall=null,this.type=null,this.name=null,this.uniqueName=null,this.logPrefix="",this.result=null}var t,n,i;return t=e,(n=[{key:"init",value:function(t){s.a.extend(this,t),"number"==typeof this.maxRetries?this.retryIntervals=et.init(this.maxRetries,0):(this.retryIntervals=this.retryIntervals?this.retryIntervals.slice():[],this.maxRetries=this.retryIntervals.length),this.uniqueName=O.nvl(this.type,"call")+"-"+e.GLOBAL_SEQ+++En.box(" ",this.name,""),this.initialized=!0}},{key:"_checkInitialized",value:function(){if(!this.initialized)throw new Error("Not initialized")}},{key:"_updateLogPrefix",value:function(){this.logPrefix=this.callCounter+"/"+(this.maxRetries+1)+" ["+this.uniqueName+"] "}},{key:"_resolve",value:function(){s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"[RESOLVE]"),this.deferred.resolve.apply(this.deferred,et.ensure(this.result))}},{key:"_reject",value:function(){s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"[REJECT]"),this.deferred.reject.apply(this.deferred,et.ensure(this.result))}},{key:"_setResult",value:function(){this.result=oi.argumentsToArray(arguments)}},{key:"call",value:function(){return this._checkInitialized(),this._call(),this.deferred.promise()}},{key:"abort",value:function(){this._checkInitialized(),this._abort()}},{key:"_call",value:function(){if(this.aborted)throw new Error("Call is aborted");this.callTimeoutId=null,this.callStartTimestamp=Date.now(),this.callCounter++,this._updateLogPrefix(),this.pendingCall=this._callImpl().always(function(){this.pendingCall=null}.bind(this)).done(this._setResultDone.bind(this)).done(this._onCallDone.bind(this)).fail(this._setResultFail.bind(this)).fail(this._onCallFail.bind(this))}},{key:"_callImpl",value:function(){throw new Error("Missing implementation: _callImpl()")}},{key:"_setResultDone",value:function(){this._setResult.apply(this,arguments)}},{key:"_setResultFail",value:function(){this._setResult.apply(this,arguments)}},{key:"_onCallDone",value:function(){this._resolve()}},{key:"_onCallFail",value:function(){if(this.aborted)return s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"Call aborted"),void this._reject();var e=this._nextRetryImpl.apply(this,arguments);if("number"!=typeof e)return s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"No retries remaining"),void this._reject();var t=Date.now()-this.callStartTimestamp,n=Math.max(this.minCallDuration-t,0),i=e+n;s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"Try again in "+i+" ms..."),this.callTimeoutId=setTimeout(this._call.bind(this),i)}},{key:"_nextRetryImpl",value:function(){return!!this.retryIntervals.length&&this.retryIntervals.shift()}},{key:"_abort",value:function(){if(this.aborted=!0,this.callTimeoutId)return s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"Cancelled scheduled retry"),clearTimeout(this.callTimeoutId),this.callTimeoutId=null,void this._reject();this._abortImpl()}},{key:"_abortImpl",value:function(){this.pendingCall&&"function"==typeof this.pendingCall.abort&&this.pendingCall.abort()}}])&&tt(t.prototype,n),i&&tt(t,i),e}();function it(e){return new pi({message:e.text("ui.CopyToClipboardSuccessStatus"),severity:pi.Severity.INFO})}function rt(e,t){O.assertParameter("parent",e),O.create("DesktopNotification",{parent:e,closable:!1,duration:1234,status:t||it(e.session)}).show()}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(nt,"GLOBAL_SEQ",0);var ot={copyText:function(e){O.assertParameter("options",e),e.parent&&!e.session&&(e.session=e.parent.session),O.assertProperty(e,"session");var t=function(e){if(navigator.clipboard)return navigator.clipboard.writeText(e.text);var t=e.parent&&e.parent.rendered?e.parent.document(!0):document,n=t.createElement("textarea");n.style.position="fixed",n.style.opacity="0.0",n.value=e.text,t.body.appendChild(n);var i=s()(n);e.session.focusManager.installFocusContext(i,Pc.AUTO),n.select();var r=s.a.Deferred();try{t.execCommand("copy")?r.resolve():r.reject()}catch(e){r.reject(e)}finally{e.session.focusManager.uninstallFocusContext(i),t.body.removeChild(n)}return r.promise()}(e);return e.parent&&O.nvl(e.showNotification,!0)?(function(e,t){var n=it(e.parent.session);t.catch((function(){var t;t=e.parent.session,n=new pi({message:t.text("ui.CopyToClipboardFailedStatus"),severity:pi.Severity.WARNING})})).then((function(){rt(e.parent,n)}))}(e,t),null):t},showNotification:rt};function st(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var at=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=i||{},this.source=t,this.target=n,this.callSetter=O.nvl(i.callSetter,!0),this.delegateProperties=i.delegateProperties||[],this.excludeProperties=i.excludeProperties||[],this.delegateEvents=i.delegateEvents||[],this.delegateAllProperties=!!i.delegateAllProperties,this.delegateAllEvents=!!i.delegateAllEvents,this._mirrorListener=null,this._destroyHandler=null,this._installSourceListener()}var t,n,i;return t=e,i=[{key:"equalsProperty",value:function(e,t,n){var i=t[e];return Array.isArray(n)&&Array.isArray(i)?et.equals(n,i):oi.equals(i,n)}},{key:"create",value:function(t,n,i){return i.delegateProperties&&i.delegateProperties.length>0||i.delegateEvents&&i.delegateEvents.length>0||i.delegateAllProperties||i.delegateAllEvents?new e(t,n,i):null}}],(n=[{key:"destroy",value:function(){this._uninstallSourceListener()}},{key:"_installSourceListener",value:function(){if(this._mirrorListener)throw new Error("source listeners already installed.");this._mirrorListener={func:this._onSourceEvent.bind(this)},this.source.events.addListener(this._mirrorListener),this._destroyHandler=this._uninstallSourceListener.bind(this),this.source.on("destroy",this._destroyHandler),this.target.on("destroy",this._destroyHandler)}},{key:"_uninstallSourceListener",value:function(){this._mirrorListener&&(this.source.events.removeListener(this._mirrorListener),this._mirrorListener=null),this._destroyHandler&&(this.source.off("destroy",this._destroyHandler),this.target.off("destroy",this._destroyHandler),this._destroyHandler=null)}},{key:"_onSourceEvent",value:function(e){"propertyChange"===e.type?this._onSourcePropertyChange(e):(this.delegateAllEvents||this.delegateEvents.indexOf(e.type)>-1)&&this.target.trigger(e.type,e)}},{key:"_onSourcePropertyChange",value:function(t){if(!(this.excludeProperties.indexOf(t.propertyName)>-1)&&(this.delegateAllProperties||this.delegateProperties.indexOf(t.propertyName)>-1)){if(e.equalsProperty(t.propertyName,this.target,t.newValue))return;this.callSetter?this.target.callSetter(t.propertyName,t.newValue):this.target.trigger(t.type,t)}}}])&&st(t.prototype,n),i&&st(t,i),e}();function ut(e){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lt(e,t,n,i){var r=new Date(e.getTime());return t&&(r.setFullYear(e.getFullYear()+t),pt(r,e)!==12*t&&r.setDate(0)),n&&(r.setMonth(e.getMonth()+n),pt(r,e)!==n+12*t&&r.setDate(0)),i&&r.setDate(e.getDate()+i),r}function ct(e,t){var n=t-e.getDay();return n<=0&&(n+=7),lt(e,0,0,n)}function ft(e,t){var n=t-e.getDay();return n>=0&&(n-=7),lt(e,0,0,n)}function ht(e,t,n){return n>0?ct(e,t):ft(e,t)}function dt(e,t){return ht(e,1,t)}function pt(e,t){var n=e.getMonth(),i=t.getMonth(),r=e.getFullYear(),o=t.getFullYear(),s=n-i;return r===o?s:12*(r-o)+s}function yt(e,t){if(e&&"number"==typeof t){var n=new Date(e.valueOf());return 4!==n.getDay()&&(n.getDay()<t&&n.setDate(n.getDate()-7),n.setDate(n.getDate()-n.getDay()+4)),n}}function vt(e,t){if(e&&"number"==typeof t){var n=new Date(e.valueOf());return n.getDay()!==t&&n.setDate(n.getDate()-(n.getDay()+7-t)%7),n}}function bt(e){if(!e)return null;var t,n="1970",i="01",r="01",o="00",s="00",a="00",u="000",l=!1,c=/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})\.(\d{3})(Z?)$/.exec(e);if(null!==c)n=c[1],i=c[2],r=c[3],o=c[4],s=c[5],a=c[6],u=c[7],l="Z"===c[8];else if(null!==(c=/^(\d{4})-(\d{2})-(\d{2})(Z?)$/.exec(e)))n=c[1],i=c[2],r=c[3],l="Z"===c[4];else{if(null===(c=/^(\d{2}):(\d{2}):(\d{2})\.(\d{3})(Z?)$/.exec(e)))throw new Error("Unparsable date: "+e);o=c[1],s=c[2],a=c[3],u=c[4],l="Z"===c[5]}return l?(t=new Date(Date.UTC(n,i-1,r,o,s,a,u)),n<100&&t.setUTCFullYear(n)):(t=new Date(n,i-1,r,o,s,a,u),n<100&&t.setFullYear(n)),t}function gt(e,t,n,i){if(!e)return null;var r,o,s;void 0===n&&(n=!0),void 0===i&&(i=!0),t?(r=En.padZeroLeft(e.getUTCFullYear(),4)+"-"+En.padZeroLeft(e.getUTCMonth()+1,2)+"-"+En.padZeroLeft(e.getUTCDate(),2),o=En.padZeroLeft(e.getUTCHours(),2)+":"+En.padZeroLeft(e.getUTCMinutes(),2)+":"+En.padZeroLeft(e.getUTCSeconds(),2)+"."+En.padZeroLeft(e.getUTCMilliseconds(),3),s="Z"):(r=En.padZeroLeft(e.getFullYear(),4)+"-"+En.padZeroLeft(e.getMonth()+1,2)+"-"+En.padZeroLeft(e.getDate(),2),o=En.padZeroLeft(e.getHours(),2)+":"+En.padZeroLeft(e.getMinutes(),2)+":"+En.padZeroLeft(e.getSeconds(),2)+"."+En.padZeroLeft(e.getMilliseconds(),3),s="");var a="";return n&&(a+=r,i&&(a+=" ")),i&&(a+=o),a+=s}function mt(e,t){if(!e&&!t)return 0;if(!e)return-1;if(!t)return 1;var n=e.getTime()-t.getTime();return n<-1?-1:n>1?1:n}function _t(e,t){return e&&(O.nvl(t,!0)&&(e=new Date(e.getTime())),e.setHours(0,0,0,0)),e}var wt={ceil:function(e,t,n){var i,r,o=O.nvl(t,30);return e&&(O.nvl(n,!0)&&(e=new Date(e.getTime())),e.setSeconds(0,0),r=parseInt((e.getMinutes()+o)/o)*o,i=e.getHours(),r>=60&&(i++,r=0),i>23&&(i=0,e.setDate(e.getDate()+1)),e.setHours(i,r)),e},combineDateTime:function(e,t){var n=new Date;return n.setHours(0,0,0,0),n.setFullYear(1970,0,1),e&&n.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t&&(n.setHours(O.nvl(t.getHours(),0)),n.setMinutes(O.nvl(t.getMinutes(),0)),n.setSeconds(O.nvl(t.getSeconds(),0)),n.setMilliseconds(O.nvl(t.getMilliseconds(),0))),n},compare:mt,compareDays:function(e,t){return(_t(e)-_t(t)-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5},compareMonths:pt,create:function(e){if(e){var t=/^(\d{4})(?:-(\d{2})(?:-(\d{2})(?: (\d{2})(?::(\d{2})(?::(\d{2})(?:\.(\d{3}))?(Z?))?)?)?)?)?/.exec(e);if(null===t)throw new Error("Unparsable date: "+e);return"Z"===t[8]?new Date(Date.UTC(t[1],(t[2]||1)-1,t[3]||1,t[4]||0,t[5]||0,t[6]||0,t[7]||0)):new Date(t[1],(t[2]||1)-1,t[3]||1,t[4]||0,t[5]||0,t[6]||0,t[7]||0)}},ensure:function(e){return e?e instanceof Date?e:bt(e):e},ensureMonday:function(e,t){return 1===e.getDay()?e:dt(e,t)},equals:function(e,t){return 0===mt(e,t)},firstDayOfWeek:vt,format:function(e,t,n){return new If(t,n).format(e)},formatDateTime:function(e,t){return new If(t,t.dateFormatPatternDefault+" "+t.timeFormatPatternDefault).format(e)},isLeapYear:function(e){return null!=e&&29===new Date(e,1,29).getDate()},isSameDay:function(e,t){return!(!e||!t)&&(e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate())},isSameMonth:function(e,t){return!(!e||!t)&&0===pt(e,t)},isSameTime:function(e,t){return!(!e||!t)&&(e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds())},newDate:function(){return new Date},orderWeekdays:function(e,t){for(var n=[],i=0;i<7;i++)n[i]=e[(i+t)%7];return n},parseJsonDate:bt,shift:lt,shiftTime:function(e,t,n,i,r){var o=new Date(e.getTime());return t&&o.setHours(e.getHours()+t),n&&o.setMinutes(e.getMinutes()+n),i&&o.setSeconds(e.getSeconds()+i),r&&o.setMilliseconds(e.getMilliseconds()+r),o},shiftToNextDayOfType:ct,shiftToNextDayAndDate:function(e,t,n){var i=new Date(e.getTime());for(i.setDate(n);i.getDay()!==t||i.getDate()!==n;)(i=lt(i,0,1,0)).setDate(n);return i},shiftToNextOrPrevDayOfType:ht,shiftToNextOrPrevMonday:dt,shiftToPreviousDayOfType:ft,timestamp:function(e,t){var n=e||new Date;return t?En.padZeroLeft(n.getUTCFullYear(),4)+En.padZeroLeft(n.getUTCMonth()+1,2)+En.padZeroLeft(n.getUTCDate(),2)+En.padZeroLeft(n.getUTCHours(),2)+En.padZeroLeft(n.getUTCMinutes(),2)+En.padZeroLeft(n.getUTCSeconds(),2)+En.padZeroLeft(n.getUTCMilliseconds(),3):En.padZeroLeft(n.getFullYear(),4)+En.padZeroLeft(n.getMonth()+1,2)+En.padZeroLeft(n.getDate(),2)+En.padZeroLeft(n.getHours(),2)+En.padZeroLeft(n.getMinutes(),2)+En.padZeroLeft(n.getSeconds(),2)+En.padZeroLeft(n.getMilliseconds(),3)},toJsonDate:gt,toJsonDateRange:function(e){return{from:gt(e.from),to:gt(e.to)}},trunc:_t,weekInYear:function(e,t){if(e){var n=1;"object"===ut(t)?void 0!==t.symbols&&void 0!==t.symbols.firstDayOfWeek?n=t.symbols.firstDayOfWeek:void 0!==t.decimalFormatSymbols&&void 0!==t.decimalFormatSymbols.firstDayOfWeek&&(n=t.decimalFormatSymbols.firstDayOfWeek):"number"==typeof t&&(n=t);var i=yt(e,n),r=new Date(i.getFullYear(),0,4),o=vt(r,n);e.getTime()<o.getTime()&&(r=new Date(i.getFullYear()-1,0,4));var s=yt(r,n),a=(i.getTime()-s.getTime())/864e5;return 1+Math.round(a/7)}}};function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var St={},Ot={};function Tt(e){Ot={},St=e.defaults||{},function e(t,n,i){if(!t)return;if(!i)throw new Error("Argument 'targetMap' must not be null");Object.keys(t).forEach((function(r){var o=[r];if(n&&(o=o.concat(n)),"object"===kt(t[r])&&e(t[r],o,i),i[r])throw new Error("Object type '"+r+"' has ambiguous parent object types.");i[r]=o}),this)}(e.objectTypeHierarchy||{},void 0,Ot),Object.keys(St).forEach((function(e){Ot[e]||(Ot[e]=[e])}),this)}function Ct(e,t){void 0!==e&&void 0!==t&&Object.keys(t).forEach((function(n){var i=n;if(En.startsWith(n,"~")&&(i=n.substring(1)),void 0===e[i])e[i]=oi.valueCopy(t[i]);else if(oi.isPlainObject(e[i])&&oi.isPlainObject(t[n]))Ct(e[i],t[n]);else if(Array.isArray(e[i])&&oi.isPlainObject(t[n]))for(var r=e[i],o=0;o<r.length;o++)oi.isPlainObject(r[o])&&Ct(r[o],t[n])}),this)}var Pt={applyTo:function e(t,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)e(t[i],n);else"object"===kt(t)&&(n=n||t.objectType)&&function(e,t){var n=Ot[t];if(!n){var i=Y.parse(t);t=i.objectType.toString(),n=Ot[t]}if(!n)return;for(var r=0;r<n.length;r++){var o=n[r],s=St[o];Ct(e,s)}}(t,n)},bootstrap:function(e){return e=e||{},e=s.a.extend({},{url:"defaultValues"},e),s.a.ajaxJson(e.url).done(Tt.bind(this))},init:Tt};function Rt(e,t,n,i){return(i=i||"")&&(i="."+i),e?t+i:n+i}function xt(e){return e&&En.startsWith(e.type,"touch")}function Et(e,t){if("function"==typeof Event){var n=new t.constructor(t.type,t);e.dispatchEvent(n)||t.preventDefault()}}var Dt,Ft={addPropagationListener:function(e,t,n,i){(n=et.ensure(n)).forEach((function(n){e.addEventListener(n,(function(e){i&&!i(e)||Et(t,e)}))}))},fixTouchEvent:function(e){if(xt(e)){var t=e.touches||(e.originalEvent?e.originalEvent.touches:null),n=t?t[0]:null;n&&(e.pageX=Math.round(n.pageX),e.pageY=Math.round(n.pageY))}},isTouchEvent:xt,onScrollStartEndDuringTouch:function(e,t,n){var i,r=!1,o=!1,s=function(e){r||(t(),r=!0),clearTimeout(i),u()},a=function(e){o=!0,u()};function u(){clearTimeout(i),i=setTimeout((function(){o&&(e.off("scroll",s),e.document().off("touchend touchcancel",a),n())}),50)}e.on("scroll",s),e.document().one("touchend touchcancel",a)},pageX:function(e){return oi.isNullOrUndefined(e.pageX)?e.originalEvent.touches[0].pageX:e.pageX},pageY:function(e){return oi.isNullOrUndefined(e.pageY)?e.originalEvent.touches[0].pageY:e.pageY},passiveOptions:function(){var e=!1;return Mt.get().supportsPassiveEventListener()&&(e={passive:!0}),e},propagateEvent:Et,touchOrMouse:Rt,touchdown:function(e,t){return Rt(e,"touchstart","mousedown",t)},touchendcancel:function(e,t){return Rt(e,"touchend touchcancel","mouseup",t)},touchmove:function(e,t){return Rt(e,"touchmove","mousemove",t)}};function At(e){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userAgent=t.userAgent,this.features={},this.system=e.System.UNKNOWN,this.type=e.Type.DESKTOP,this.browser=e.Browser.UNKNOWN,this.browserVersion=0,this.scrollbarWidth=0,this.userAgent&&(this._parseSystem(),this._parseSystemVersion(),this._parseBrowser(),this._parseBrowserVersion())}var t,n,i;return t=e,i=[{key:"get",value:function(){return Dt}}],(n=[{key:"bootstrap",value:function(){var e=[];return this.scrollbarWidth=this._detectScrollbarWidth(),this.type=this._detectType(this.userAgent),this._needsFastClick()?e.push(this._loadFastClickDeferred()):this.isIos()&&this._installActiveHandler(),e}},{key:"_needsFastClick",value:function(){return!(!this.isIos()||this.systemVersion>=9.3&&!this.isStandalone()&&this.browser!==e.Browser.UNKNOWN)}},{key:"_loadFastClickDeferred",value:function(){return this._loadScriptDeferred("fastclick-1.0.6.js",(function(){FastClick.attach(document.body),s.a.log.isInfoEnabled()&&s.a.log.info("FastClick script loaded and attached")}))}},{key:"_loadScriptDeferred",value:function(e,t){return s.a.injectScript(e).done(t)}},{key:"_installActiveHandler",value:function(){document.addEventListener("touchstart",(function(){}),!1)}},{key:"hasOnScreenKeyboard",value:function(){return this.supportsFeature("_onScreenKeyboard",function(){return this.isIos()||this.isAndroid()||this.isWindowsTabletMode()}.bind(this))}},{key:"isScrollWidthIncludingPadding",value:function(){return this.isInternetExplorer()||this.isFirefox()||this.isEdge()}},{key:"isCustomEllipsisTooltipPossible",value:function(){return this.browser!==e.Browser.SAFARI}},{key:"isIos",value:function(){return e.System.IOS===this.system}},{key:"isEdge",value:function(){return e.Browser.EDGE===this.browser}},{key:"cssClassForEdge",value:function(){return this.isEdge()?"ms-edge":""}},{key:"cssClassForIphone",value:function(){return this.isIphone()?"iphone":""}},{key:"isIphone",value:function(){return this.userAgent.indexOf("iPhone")>-1}},{key:"isInternetExplorer",value:function(){return e.Browser.INTERNET_EXPLORER===this.browser}},{key:"isFirefox",value:function(){return e.Browser.FIREFOX===this.browser}},{key:"isChrome",value:function(){return e.Browser.CHROME===this.browser}},{key:"isIosPlatform",value:function(){return/iPad|iPhone|iPod/.test(navigator.platform)}},{key:"isAndroid",value:function(){return e.System.ANDROID===this.system}},{key:"isWindowsTabletMode",value:function(){return e.System.WINDOWS===this.system&&this.systemVersion>=10&&0===this.scrollbarWidth}},{key:"isStandalone",value:function(){return!!window.navigator.standalone}},{key:"isSupportedBrowser",value:function(t,n){t=O.nvl(t,this.browser),n=O.nvl(n,this.browserVersion);var i=e.Browser;return!(t===i.INTERNET_EXPLORER&&n<11||t===i.CHROME&&n<40||t===i.FIREFOX&&n<35||t===i.SAFARI&&n<8)}},{key:"_detectType",value:function(t){return e.System.ANDROID===this.system?t.indexOf("Mobile")>-1?e.Type.MOBILE:e.Type.TABLET:e.System.IOS===this.system?t.indexOf("iPad")>-1?e.Type.TABLET:e.Type.MOBILE:this.isWindowsTabletMode()?e.Type.TABLET:e.Type.DESKTOP}},{key:"_parseSystem",value:function(){var t=this.userAgent;t.indexOf("iPhone")>-1||t.indexOf("iPad")>-1?this.system=e.System.IOS:t.indexOf("Android")>-1?this.system=e.System.ANDROID:t.indexOf("Windows")>-1&&(this.system=e.System.WINDOWS)}},{key:"_parseSystemVersion",value:function(){var t,n=e.System,i=this.userAgent;this.system===n.IOS?(t=/ OS ([0-9]+\.?[0-9]*)/,i=i.replace(/_/g,".")):this.system===n.WINDOWS&&(t=/Windows NT ([0-9]+\.?[0-9]*)/),t&&(this.systemVersion=this._parseVersion(i,t))}},{key:"_parseBrowser",value:function(){var t=this.userAgent;t.indexOf("Firefox")>-1?this.browser=e.Browser.FIREFOX:t.indexOf("MSIE")>-1||t.indexOf("Trident")>-1?this.browser=e.Browser.INTERNET_EXPLORER:t.indexOf("Edge")>-1?this.browser=e.Browser.EDGE:t.indexOf("Chrome")>-1?this.browser=e.Browser.CHROME:t.indexOf("Safari")>-1&&(this.browser=e.Browser.SAFARI)}},{key:"_parseBrowserVersion",value:function(){var t,n=e.Browser,i=this.userAgent;this.browser===n.INTERNET_EXPLORER?t=i.indexOf("MSIE")>-1?/MSIE ([0-9]+\.?[0-9]*)/:/rv:([0-9]+\.?[0-9]*)/:this.browser===n.EDGE?t=/Edge\/([0-9]+\.?[0-9]*)/:this.browser===n.SAFARI?t=/Version\/([0-9]+\.?[0-9]*)/:this.browser===n.FIREFOX?t=/Firefox\/([0-9]+\.?[0-9]*)/:this.browser===n.CHROME&&(t=/Chrome\/([0-9]+\.?[0-9]*)/),t&&(this.browserVersion=this._parseVersion(i,t))}},{key:"_parseVersion",value:function(e,t){var n=t.exec(e);if(Array.isArray(n)&&2===n.length)return parseFloat(n[1])}},{key:"supportsFeature",value:function(e,t){return void 0===this.features[e]&&(this.features[e]=t(e)),this.features[e]}},{key:"supportsOnlyTouch",value:function(){return this.supportsFeature("_onlyTouch",this.hasOnScreenKeyboard.bind(this))}},{key:"supportsTouch",value:function(){return this.supportsFeature("_touch",(function(e){return"ontouchstart"in window||window.TouchEvent||window.DocumentTouch&&document instanceof window.DocumentTouch}))}},{key:"supportsFile",value:function(){return!!window.File}},{key:"supportsFileConstructor",value:function(){return"function"==typeof File}},{key:"supportsCssAnimation",value:function(){return this.supportsCssProperty("animation")}},{key:"supportsHistoryApi",value:function(){return!(!window.history||!window.history.pushState)}},{key:"supportsCssGradient",value:function(){return this.supportsFeature("gradient",this.checkCssValue.bind(this,"backgroundImage","linear-gradient(to left, #000 0%, #000 50%, transparent 50%, transparent 100% )",(function(e){return(e+"").indexOf("gradient")>0})))}},{key:"supportsInternationalization",value:function(){return window.Intl&&"object"===At(window.Intl)}},{key:"supportsDownloadInSameWindow",value:function(){return e.Browser.FIREFOX!==this.browser}},{key:"supportsWebcam",value:function(){return this.supportsFeature("_webcam",(function(e){var t=oi.optProperty(navigator,"mediaDevices","getUserMedia");return oi.isFunction(t)}))}},{key:"hasPrettyScrollbars",value:function(){return this.supportsFeature("_prettyScrollbars",function(e){return 0===this.scrollbarWidth}.bind(this))}},{key:"canHideScrollbars",value:function(){return this.supportsFeature("_canHideScrollbars",function(e){return 0===this._detectScrollbarWidth("hybrid-scrollable")}.bind(this))}},{key:"supportsCopyFromDisabledInputFields",value:function(){return e.Browser.FIREFOX!==this.browser}},{key:"loosesFocusIfPseudoElementIsRemoved",value:function(){return e.Browser.FIREFOX===this.browser}},{key:"supportsCssProperty",value:function(t){return this.supportsFeature(t,(function(t){if(void 0!==document.body.style[t])return!0;t=t.charAt(0).toUpperCase()+t.slice(1);for(var n=0;n<e.VENDOR_PREFIXES.length;n++)if(void 0!==document.body.style[e.VENDOR_PREFIXES[n]+t])return!0;return!1}))}},{key:"supportsGeolocation",value:function(){return!!navigator.geolocation}},{key:"requiresSyntheticActiveState",value:function(){return this.isFirefox()}},{key:"supportsPassiveEventListener",value:function(){return this.supportsFeature("_passiveEventListener",(function(e){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){return t=!0,!1}});window.addEventListener("test",n,n),window.removeEventListener("test",n,n)}catch(e){t=!1}return t}))}},{key:"checkCssValue",value:function(t,n,i){if(void 0===document.body.style[t])return!1;var r=document.createElement("div");if(r.style[t]=n,i(r.style[t]))return!0;t=t.charAt(0).toUpperCase()+t.slice(1);for(var o=0;o<e.VENDOR_PREFIXES.length;o++){var s=e.VENDOR_PREFIXES[o]+t;if(void 0!==document.body.style[s]&&(r.style[s]=n,i(r.style[s])))return!0}return!1}},{key:"hasTableCellZoomBug",value:function(){return this.browser===e.Browser.CHROME}},{key:"_detectScrollbarWidth",value:function(e){var t=s()("body").appendDiv(e).attr("id","MeasureScrollbar").css("width",50).css("height",50).css("overflow-y","scroll"),n=t[0],i=n.offsetWidth-n.clientWidth;return t.remove(),i}},{key:"toString",value:function(){return"scout.Device[system="+this.system+" browser="+this.browser+" browserVersion="+this.browserVersion+" type="+this.type+" scrollbarWidth="+this.scrollbarWidth+" features="+JSON.stringify(this.features)+"]"}}])&&$t(t.prototype,n),i&&$t(t,i),e}();function It(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}jt(Mt,"VENDOR_PREFIXES",["Webkit","Moz","O","ms","Khtml"]),jt(Mt,"Browser",{UNKNOWN:"Unknown",FIREFOX:"Firefox",CHROME:"Chrome",INTERNET_EXPLORER:"InternetExplorer",EDGE:"Edge",SAFARI:"Safari"}),jt(Mt,"System",{UNKNOWN:"Unknown",IOS:"IOS",ANDROID:"ANDROID",WINDOWS:"WINDOWS"}),jt(Mt,"Type",{DESKTOP:"DESKTOP",TABLET:"TABLET",MOBILE:"MOBILE"}),x.addListener("prepare",(function(){Dt||(Dt=O.create("Device",{userAgent:navigator.userAgent}))}));var Lt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._lastPosX=null,this._lastPosY=null,this._lastTimestamp=null,this._maxDoubleClickInterval=t.maxDoubleClickInterval||500,this._maxDoubleClickDistance=t.maxDoubleClickDistance||10,this._doubleClicked=!1}var t,n,i;return t=e,(n=[{key:"mousedown",value:function(e){if(e&&"mousedown"===e.type){var t=O.nvl(e.pageX,0),n=O.nvl(e.pageY,0),i=Date.now(),r=!1;void 0!==this._lastTimestamp&&i-this._lastTimestamp<=this._maxDoubleClickInterval&&Math.max(Math.abs(t-this._lastPosX),Math.abs(n-this._lastPosY))<=this._maxDoubleClickDistance&&(r=!0),this._lastPosX=t,this._lastPosY=n,this._lastTimestamp=i,this._doubleClicked=r}}},{key:"doubleClicked",value:function(){return this._doubleClicked}}])&&It(t.prototype,n),i&&It(t,i),e}();function Bt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Nt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.additionalDropProperties=null,this.allowedTypes=null,this.dropMaximumSize=null,this.target=null,s.a.extend(this,t),this.supportedScoutTypes=et.ensure(t.supportedScoutTypes),this._onDragEnterHandler=this._onDragEnter.bind(this),this._onDragOverHandler=this._onDragOver.bind(this),this._onDropHandler=this._onDrop.bind(this)}var t,n,i;return t=e,(n=[{key:"install",value:function(e,t){if(this.$element)throw new Error("Already installed.");this.selector=t,this.$element=e,this.$element.on("dragenter",this.selector,this._onDragEnterHandler).on("dragover",this.selector,this._onDragOverHandler).on("drop",this.selector,this._onDropHandler)}},{key:"uninstall",value:function(){this.$element.off("dragenter",this.selector,this._onDragEnterHandler).off("dragover",this.selector,this._onDragOverHandler).off("drop",this.selector,this._onDropHandler),this.$element=null,this.selector=null}},{key:"_onDragEnter",value:function(e){this._onDragEnterOrOver(e)}},{key:"_onDragOver",value:function(e){this._onDragEnterOrOver(e)}},{key:"_onDragEnterOrOver",value:function(e){e.originalEvent.dataTransfer.dropEffect="copy",Gt.verifyDataTransferTypesScoutTypes(e,this.supportedScoutTypes,this.dropType())}},{key:"_onDrop",value:function(e){if(this.supportedScoutTypes.indexOf(Gt.SCOUT_TYPES.FILE_TRANSFER)>=0&&(this.dropType()&Gt.SCOUT_TYPES.FILE_TRANSFER)===Gt.SCOUT_TYPES.FILE_TRANSFER&&Gt.dataTransferTypesContainsScoutTypes(e.originalEvent.dataTransfer,Gt.SCOUT_TYPES.FILE_TRANSFER)){e.stopPropagation(),e.preventDefault();var t=e.originalEvent.dataTransfer.files;t.length>=1&&this.target.session.uploadFiles(this.target,t,this.additionalDropProperties?this.additionalDropProperties(e):void 0,this.dropMaximumSize?this.dropMaximumSize():void 0,this.allowedTypes?this.allowedTypes():void 0)}}}])&&Bt(t.prototype,n),i&&Bt(t,i),e}(),Ht={FILE_TRANSFER:1,JAVA_ELEMENT_TRANSFER:2,TEXT_TRANSFER:4,IMAGE_TRANSFER:8};function Vt(e){var t=[];return(e=et.ensure(e)).indexOf(Ht.FILE_TRANSFER)>=0&&t.push("Files"),t}function Wt(e,t){return!!zt(e.originalEvent.dataTransfer,t)&&(e.stopPropagation(),e.preventDefault(),!0)}function zt(e,t){if(t=et.ensure(t),e&&e.types){if(Array.isArray(e.types)&&et.containsAny(e.types,t))return!0;if(e.types.contains)return t.some((function(t){return e.types.contains(t)}))}return!1}var Gt={DEFAULT_DROP_MAXIMUM_SIZE:52428800,SCOUT_TYPES:Ht,dataTransferTypesContains:zt,dataTransferTypesContainsScoutTypes:function(e,t){return zt(e,Vt(t=et.ensure(t)))},handler:function(e,t){return(t=t||{}).target=e,new Nt(t)},scoutTypeToDragTypeMapping:Vt,verifyDataTransferTypes:Wt,verifyDataTransferTypesScoutTypes:function(e,t,n){t=et.ensure(t);var i=[];void 0!==n?t.forEach((function(e){(n&e)===e&&et.pushAll(i,Vt(t))})):i=Vt(t),Array.isArray(i)&&i.length>0&&Wt(e,i)}};function Ut(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Kt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultPrevented=!1,s.a.extend(this,t)}var t,n,i;return t=e,(n=[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}])&&Ut(t.prototype,n),i&&Ut(t,i),e}();function qt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Yt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventListeners=[],this._subTypePredicates=oi.createMap()}var t,n,i;return t=e,(n=[{key:"_assertFunc",value:function(e){if(!e)throw new Error("Missing callback function")}},{key:"on",value:function(e,t,n){this._assertFunc(t);var i={type:e,func:t,origFunc:n};return this.addListener(i),i}},{key:"one",value:function(e,t){this._assertFunc(t);var n=this;return this.on(e,(function i(r){n.off(e,i),t(r)}),t)}},{key:"off",value:function(e,t){if(e||t)for(var n=this._eventListeners.length-1;n>=0;n--){var i=this._eventListeners[n],r=t===i.func||t===i.origFunc,o=e===i.type;(t&&e?r&&o:t?r:o)&&this._eventListeners.splice(n,1)}}},{key:"when",value:function(e){var t=s.a.Deferred();return this.one(e,t.resolve.bind(t)),t.promise()}},{key:"addListener",value:function(e){this._eventListeners.push(e)}},{key:"removeListener",value:function(e){et.remove(this._eventListeners,e)}},{key:"count",value:function(e,t){var n=0;return this._eventListeners.forEach((function(i){e&&e!==i.type||t&&t!==i.func||n++})),n}},{key:"trigger",value:function(e,t){(t=t||{}).type=e;var n,i,r=this._eventListeners.slice();for(n=0;n<r.length;n++)(i=r[n]).type&&!o.call(this,t,i.type)||i.func(t);function o(e,t){for(var n=e.type,i=t.split(" "),r=0;r<i.length;r++){if(n===i[r])return!0;if(this._subTypeMatches(e,i[r]))return!0}return!1}}},{key:"_subTypeMatches",value:function(e,t){if(t.indexOf(":")<0)return!1;var n=t.split(":"),i=n[0],r=n[1],o=this._subTypePredicates[i];return o?o(e,r):void 0}},{key:"registerSubTypePredicate",value:function(e,t){O.assertParameter("type",e),O.assertParameter("predicate",t),this._subTypePredicates[e]=t}}])&&qt(t.prototype,n),i&&qt(t,i),e}(),Xt=s.a.Deferred(),Jt=!0;var Zt="ABC abc 123 .,_ LlIi1 oO0 !#@  ";function Qt(e){var t=(e=e||{}).fonts||[];if(Array.isArray(t)||(t=[t]),e.onComplete){var n=[];if(t.forEach((function(t){if("string"==typeof t){var i=En.splitMax(t,"|",3).map((function(e){return e.trim()}));t={family:i[0],style:i[1],testString:i[2]}}t.family=t.family||"",t.style=t.style||"",t.testString=t.testString||e.testString||Zt;var r=t.testFonts||e.testFonts||"monospace",o=s()("body").appendDiv("font-preloader").text(t.testString).css("display","block").css("visibility","hidden").css("position","absolute").css("top",0).css("left",0).css("width","auto").css("height","auto").css("margin",0).css("padding",0).css("white-space","nowrap").css("line-height","normal").css("font-variant","normal").css("font-size","20em").css("font-family",r),a=en(o);if(o.data("original-size",a),o.data("font-family",t.family),o.css("font-family","'"+t.family+"',"+r),t.style){var u=(o.attr("style")||"").trim(),l=(";"===u.substr(-1)?"":";")+(u?" ":"");o.attr("style",u+l+t.style)}en(o)!==a?o.remove():n.push(o)})),0!==n.length){var i,r,o=u,a=O.nvl(e.timeout,12e3);a&&a>=0&&(r=setTimeout((function(){clearTimeout(i),u(!1)}),a),o=function(){clearTimeout(r),u(!0)}),function e(t,r){var o=n.length;for(;o--;){var s=n[o];en(s)!==s.data("original-size")&&(n.splice(o,1),s.remove())}if(0===n.length)return void r(!0);i=setTimeout((function(){t<1e3&&(t*=1.2),e(t,r)}),t)}(50,o)}else u(!0)}function u(t){e.onComplete(t,n.map((function(e){return e.data("font-family")})))}}function en(e){var t=No.size(e,{exact:!0});return t.width+"x"+t.height}function tn(){for(var e=[],t=document.styleSheets,n=0;n<t.length;n++){var i=t[n];try{i.cssRules}catch(e){s.a.log.info("Skipped automatic font detection for style sheet "+i.href+' (access blocked by browser). Use the bootstrap argument "fonts" to manually list fonts to pre-load.');continue}for(var r=0;r<i.cssRules.length;r++){var o=i.cssRules[r];if(o.type===window.CSSRule.FONT_FACE_RULE){var a=o.style,u=a.getPropertyValue("font-family"),l=a.getPropertyValue("font-weight"),c=a.getPropertyValue("font-style"),f=a.getPropertyValue("font-variant"),h=a.getPropertyValue("font-stretch");if(u){u=u.replace(/^["']|["']$/g,"");var d=[];l&&"normal"!==l&&d.push("font-weight:"+l),c&&"normal"!==c&&d.push("font-style:"+c),f&&"normal"!==f&&d.push("font-variant:"+f),h&&"normal"!==h&&d.push("font-stretch:"+h);var p={family:u};d.length&&(p.style=d.join(";")),e.push(p)}}}}return e}var nn={TEST_FONTS:"monospace",TEST_STRING:Zt,TEST_TIMEOUT:12e3,autoDetectFonts:tn,bootstrap:function(e){return 0===(e=e||tn()).length?(Jt=!0,s.a.resolvedPromise()):(Jt=!1,Qt({fonts:e,onComplete:function(e,t){!e&&t&&t.length&&s.a.log.warn("Timeout ocurred while pre-loading the following fonts:\n\n- "+t.join("\n- ")+'\n\nRendering will now continue, but font measurements may be inaccurate. To prevent unnecessary startup delays and layout problems, check the @font-face definitions and the referenced "src" URLs or programmatically add additional font-specific characters to TEST_STRING before calling app.init().'),Jt=!0,Xt.resolve()}}),s.a.resolvedPromise())},loadingComplete:Jt,measureSize:en,preload:Qt,preloader:function(){return Xt.promise()}},rn=/\${iconId:([a-zA-Z0-9_.]*)}/;function on(e){var t,n=rn.exec(e);return n&&2===n.length&&(1===(t=n[1].split(".")).length?e=scout.icons[t]:2===t.length?e=window[t[0]].icons[t[1]]:s.a.log.warn("Invalid iconId: "+e)),e}var sn={ANGLE_DOUBLE_DOWN_BOLD:"font:",ANGLE_DOUBLE_LEFT:"font:",ANGLE_DOUBLE_LEFT_BOLD:"font:",ANGLE_DOUBLE_RIGHT:"font:",ANGLE_DOUBLE_RIGHT_BOLD:"font:",ANGLE_DOUBLE_UP_BOLD:"font:",ANGLE_DOWN:"font:",ANGLE_DOWN_BOLD:"font:",ANGLE_LEFT:"font:",ANGLE_LEFT_BOLD:"font:",ANGLE_RIGHT:"font:",ANGLE_RIGHT_BOLD:"font:",ANGLE_UP:"font:",ANGLE_UP_BOLD:"font:",ARROW_RIGHT_BOLD:"font:",AVG:"font:",AVG_BOLD:"font:",BOLD:"font:",CALENDAR:"font:",CALENDAR_BOLD:"font:",CARET_DOWN:"font:",CARET_LEFT:"font:",CARET_RIGHT:"font:",CARET_UP:"font:",CATEGORY:"font:",CATEGORY_SOLID:"font:",CHART:"font:",CHECKED_BOLD:"font:",CHEVRON_DOWN_BOLD:"font:",CHEVRON_LEFT_BOLD:"font:",CHEVRON_RIGHT_BOLD:"font:",CHEVRON_UP_BOLD:"font:",CIRCLE_BOLD:"font:",CLOCK_BOLD:"font:",COLLAPSE:"font:",ELLIPSIS_V:"font:",ELLIPSIS_V_BOLD:"font:",EXCLAMATION_MARK:"font:",EXCLAMATION_MARK_CIRCLE:"font:",FILE_SOLID:"font:",FOLDER:"font:",FOLDER_BOLD:"font:",GEAR:"font:",GRAPH_SOLID:"font:",GROUP:"font:",GROUP_PLUS:"font:",ICON_ID_REGEX:rn,INFO:"font:",ITALIC:"font:",LIGHTBULB_OFF:"font:",LIGHTBULB_ON:"font:",LIST:"font:",LIST_OL:"font:",LIST_OL_BOLD:"font:",LIST_UL:"font:",LIST_UL_BOLD:"font:",LONG_ARROW_DOWN:"font:",LONG_ARROW_DOWN_BOLD:"font:",LONG_ARROW_DOWN_PLUS:"font:",LONG_ARROW_LEFT_BOLD:"font:",LONG_ARROW_RIGHT_BOLD:"font:",LONG_ARROW_UP:"font:",LONG_ARROW_UP_BOLD:"font:",LONG_ARROW_UP_PLUS:"font:",MAX:"font:",MAX_BOLD:"font:",MENU_BOLD:"font:",MIN:"font:",MINUS:"font:",MINUS_BOLD:"font:",MIN_BOLD:"font:",PENCIL:"font:",PENCIL_BOLD:"font:",PENCIL_SOLID:"font:",PERSON_SOLID:"font:",PLUS:"font:",PLUS_BOLD:"font:",REMOVE:"font:",REMOVE_BOLD:"font:",ROTATE_LEFT_BOLD:"font:",ROTATE_RIGHT_BOLD:"font:",SEARCH:"font:",SEARCH_BOLD:"font:",SQUARE_BOLD:"font:",STAR:"font:",STAR_BOLD:"font:",STAR_MARKED:"font:",STAR_SOLID:"font:",STRIKETHROUGH:"font:",SUM:"font:",SUM_BOLD:"font:",TABLE_SORT_ASC:"font:↑",TABLE_SORT_DESC:"font:↓",TARGET:"font:",UNDERLINE:"font:",VERTICAL_DOTS:"font:",WORLD:"font:",parseIconId:function(e){var t=new Bv;if(En.startsWith(e,"font:"))if(t.iconType=Bv.IconType.FONT_ICON,e=e.substr(5),1===En.countCodePoints(e))t.font=Bv.DEFAULT_FONT,t.iconCharacter=e;else{var n=e.split(" ");t.font=n[0],t.iconCharacter=n[1]}else t.iconType=Bv.IconType.BITMAP,t.iconUrl=e;return t},resolveIconId:on,resolveIconProperty:function(e,t){var n=e[t=t||"iconId"],i=on(n);i!==n&&(e[t]=i)}};var an={applyInfo:function(e,t){e&&(t=t||e.$container)&&(t.toggleAttr("data-id",!!e.id,e.id),t.toggleAttr("data-modelclass",!!e.modelClass,e.modelClass),t.toggleAttr("data-classid",!!e.classId,e.classId))}},un={};function ln(e,t){if(t&&t.error)throw{error:t.error,url:e};cn(t)}function cn(e){e.forEach((function(e){un[e.languageTag]=new fo(e)}),this)}function fn(e){return un[e]}function hn(e){var t;return th.createOrderedLanguageTags(e).some((function(e){return!!(t=fn(e))}),this),t||null}function dn(){return navigator.language||navigator.userLanguage}function pn(){return oi.values(un)}function yn(e){return O.assertParameter("language",e),et.find(pn(),(function(t){if(t.language===e)return t}),this)}function vn(e){return e?e.split("-"):[]}var bn={bootstrap:function(e){return(e?s.a.ajaxJson(e):s.a.resolvedPromise([])).then(ln.bind(this,e))},findFirstForLanguage:yn,get:hn,getAll:pn,getAllLanguageTags:function(){return Object.keys(un)},getNavigatorLanguage:dn,getNavigatorLocale:function(){var e=dn();if(!e)return s.a.log.warn("Browser returned no language. Using default locale."),new fo;var t=hn(e);return t||(s.a.log.isInfoEnabled()&&s.a.log.info("Locale for languageTag "+e+" not found. Trying to load best match."),(t=yn(vn(e)[0]))?t:(s.a.log.isInfoEnabled()&&s.a.log.info("Still no matching locale for languageTag "+e+" found. Using default locale."),new fo))},has:function(e,t){return(t=O.nvl(t,!1))?!!fn(e):!!hn(e)},init:cn,localesMap:un,splitLanguageTag:vn},gn=null,mn=null;function _n(e){return null!=e&&("string"==typeof(e=Pn(e))&&0!==e.length&&!/^\s*$/.test(e))}function wn(e){return!_n(e)}function kn(e,t){if(null==e)return e;if("number"!=typeof t||t<1)return"";for(var n="",i=0;i<t;i++)n+=e;return n}function Sn(e,t){return null!=e&&null!=t&&(e=Pn(e),0===(t=Pn(t)).length||0!==e.length&&e.substr(0,t.length)===t)}function On(e,t){return null!=e&&null!=t&&(e=Pn(e),0===(t=Pn(t)).length||0!==e.length&&e.substr(-t.length)===t)}function Tn(e){return gn||(gn=new _i),gn.encode(e)}function Cn(e,t){if(null==e)return e;var n="";return _n(e=Pn(e))&&(n=e.charAt(0)[t]()+e.slice(1)),n}function Pn(e){return null==e||"string"==typeof e||e instanceof String?e:String(e)}function Rn(e){return wn(e)?null:e}function xn(e,t,n){return e=Rn(e),t=Rn(t),!e&&!t||!(!e||!t)&&(n?e.toLowerCase()===t.toLowerCase():e===t)}var En={asString:Pn,box:function(e,t,n){e=Pn(e),t=Pn(t),n=Pn(n);var i="";return _n(t)&&(e&&(i+=e),i+=t,n&&(i+=n)),i},contains:function(e,t){return!!e&&e.indexOf(t)>-1},count:function(e,t){return e&&null!=t?(e=Pn(e),t=Pn(t),e.split(t).length-1):0},countCodePoints:function(e){return e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length},empty:wn,encode:Tn,endsWith:On,equals:xn,equalsIgnoreCase:function(e,t){return xn(e,t,!0)},hasText:_n,insertAt:function(e,t,n){return e?(e=Pn(e),(t=Pn(t))&&("number"==typeof n||n instanceof Number)&&n>=0?e.substr(0,n)+t+e.substr(n):e):e},join:function(e,t){var n;n=t&&oi.isArray(t)?t:oi.argumentsToArray(arguments).slice(1),e=Pn(e);for(var i="",r=0;r<n.length;r++){var o=Pn(n[r]);o&&(i&&e&&(i+=e),i+=o)}return i},lowercaseFirstLetter:function(e){return Cn(e,"toLowerCase")},nl2br:function(e,t){return e?(e=Pn(e),(t=O.nvl(t,!0))&&(e=Tn(e)),e.replace(/\n/g,"<br>").replace(/\r/g,"")):e},nullIfEmpty:Rn,nvl:function(e){if(arguments.length>1)throw new Error("strings.nvl only accepts one argument. Use scout.nvl if you need to handle multiple arguments");return O.nvl(e,"")},padZeroLeft:function(e,t){return null==(e=Pn(e))||"number"!=typeof t||t<1||(e+"").length>=t?e:(kn("0",t)+e).slice(-t)},plainText:function(e,t){return mn||(mn=new gi),mn.encode(e,t)},quote:function(e){return null==e?e:(e=Pn(e)).replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},removePrefix:function(e,t){var n=e;return Sn(e,t)&&(n=e.substring(t.length)),n},removeSuffix:function(e,t){var n=e;return On(e,t)&&(n=e.substring(0,e.length-t.length)),n},repeat:kn,splitMax:function(e,t,n){if(null==e)return[];e=Pn(e),t=Pn(t),n=Number(n);var i=e.split(t);if(isNaN(n)||n<=0||n>=i.length)return i;var r=i.slice(0,n-1),o=i.slice(n-1).join(t);return r.push(o),r},startsWith:Sn,toUpperCaseFirstLetter:function(e){return e.substring(0,1).toUpperCase()+e.substring(1)},uppercaseFirstLetter:function(e){return Cn(e,"toUpperCase")}},Dn=!1,Fn=[];function An(e,t){e=O.nvl(e,"trace"),log4javascript.setShowStackTraces(!0);var n=log4javascript.getDefaultLogger();n.setLevel($n(e)),s.a.log=n,Dn=!0,t?n.getEffectiveAppenders().forEach((function(e){e.setUseDocumentWrite(!1)})):n.removeAllAppenders(),Fn.forEach((function(e){jn(e.factoryName,e.options)}),this),Fn=[]}function $n(e){if(e)switch(e=e.toLowerCase()){case"trace":return log4javascript.Level.TRACE;case"debug":return log4javascript.Level.DEBUG;case"info":return log4javascript.Level.INFO;case"warn":return log4javascript.Level.WARN;case"error":return log4javascript.Level.ERROR;case"fatal":return log4javascript.Level.FATAL}}function jn(e,t){if(Dn){var n=O.create(e,t);s.a.log.addAppender(n.create())}else Fn.push({factoryName:e,options:t})}var Mn={DEFAULT_LEVEL:"trace",addAppender:jn,bootstrap:function(e){var t=new Li,n=t.getParameter("logging"),i=t.getParameter("logLevel"),r=!(!(e=O.nvl(e,{})).enabled&&!n),o=!(!e.showPopup&&!n),a=En.nvl(e.resourceUrl);return s.a.log=new Ln,r?window.log4javascript?(An(i,o),s.a.resolvedPromise()):s.a.injectScript(a+"log4javascript-1.4.9/log4javascript.js").done(An.bind(this,i,o)):s.a.resolvedPromise()},initLog4Javascript:An,initialized:Dn,parseLevel:$n,showStackTraces:!0};function In(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ln=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"trace",value:function(){}},{key:"debug",value:function(){}},{key:"info",value:function(){this._log("info",oi.argumentsToArray(arguments))}},{key:"warn",value:function(){this._log("warn",oi.argumentsToArray(arguments))}},{key:"error",value:function(e){this._log("error",oi.argumentsToArray(arguments))}},{key:"fatal",value:function(e){this._log("fatal",oi.argumentsToArray(arguments))}},{key:"isEnabledFor",value:function(){return!1}},{key:"isTraceEnabled",value:function(){return!1}},{key:"isDebugEnabled",value:function(){return!1}},{key:"isInfoEnabled",value:function(){return!1}},{key:"isWarnEnabled",value:function(){return!1}},{key:"isErrorEnabled",value:function(){return!1}},{key:"isFatalEnabled",value:function(){return!1}},{key:"_log",value:function(e,t){var n=oi.optProperty(window,"console");if(n){var i=n["fatal"===e?"error":e];if(i){t.length>0&&(t[0]=this._formatTime()+" ["+e.toUpperCase()+"] "+t[0]);try{i.apply(n,t)}catch(e){}}}}},{key:"_formatTime",value:function(){var e=new Date;return En.padZeroLeft(e.getHours(),2)+":"+En.padZeroLeft(e.getMinutes(),2)+":"+En.padZeroLeft(e.getSeconds(),2)+"."+En.padZeroLeft(e.getMilliseconds(),3)}}])&&In(t.prototype,n),i&&In(t,i),e}();var Bn={APPLICATION_JAVASCRIPT:"application/javascript",APPLICATION_JSON:"application/json",APPLICATION_ZIP:"application/zip",IMAGE_GIF:"image/gif",IMAGE_JPEG:"image/jpeg",IMAGE_JPG:"image/jpg",IMAGE_PNG:"image/png",JAVASCRIPT:"application/javascript",JSON:"application/json",TEXT_CSS:"text/css",TEXT_HTML:"text/html",TEXT_JAVASCRIPT:"text/javascript",TEXT_PLAIN:"text/plain",ZIP:"application/zip",isJavaScript:function(e){return O.isOneOf(e,"text/javascript","application/javascript")},isTextMimeType:function(e){return O.isOneOf(e,"text/plain","text/html","text/css","text/javascript","application/javascript","application/json")}},Nn={};function Hn(e){return function(e,t){var n=Nn[e];if(!n)throw new Error("No model map entry found for id '"+e+"'");if(O.nvl(n.type,"model")!==t)throw new Error("Model '"+e+"' is not of type '"+t+"'");return s.a.extend(!0,{},n)}(e,"extension")}var Vn={init:function(e){Nn=e},extend:function(e,t){return"string"==typeof e&&(e=Hn(e)),"function"==typeof e&&(e=e()),O.assertParameter("extensions",e.extensions),e.extensions.forEach((function(n){var i,r=O.assertParameter("operation",n.operation),o=O.assertParameter("target",n.target);if(!(i=o.root?t:oi.findChildObjectByKey(t,"id",o.id)))throw new Error("Extension target not found: [extension: "+e.id+", target: "+o.id+"]");if("appendTo"===r)s.a.extend(i,n.extension);else if("insert"===r){i[o.property]=i[o.property]||[];var a=i[o.property],u=et.ensure(n.extension);!function(e,t){var n=e.before||e.after;n&&e.groupWithTarget&&t.forEach((function(e){e.groupedWith=n}))}(o,u);var l=function(e,t){var n=t.length;e.before?-1===(n=et.findIndex(t,(function(t){return t.id===e.before||t.groupedWith===e.before})))&&(n=t.length):e.after&&(-1===(n=et.findIndex(t,(function(t){return t.id===e.after||t.groupedWith===e.after})))?n=t.length:n++);s.a.isNumeric(e.index)&&(n=e.index);return n}(o,a);et.insertAll(a,u,l)}})),t},get:function(e,t){var n=e();return t&&(n.parent=t),n},getExtension:Hn,modelMap:Nn};var Wn=1;function zn(e,t){if(null==e||!t)return e;var n=e?e<0?-1:1:0,i=Math.abs(t);e=Math.abs(e);var r,o=En.asString(e);return-1!==o.indexOf("e")&&(o=e.toFixed(20)),t<0?(r=(o=En.repeat("0",i)+o).split(".",2),o=1===r.length?o.substr(0,o.length-i)+"."+o.substr(o.length-i):r[0].substr(0,r[0].length-i)+"."+r[0].substr(r[0].length-i)+r[1]):t>0&&2===(r=(o+=En.repeat("0",i)).split(".",2)).length&&(o=r[0]+r[1].substr(0,i)+"."+r[1].substr(i)),o=o.replace(/^0*(\d)/g,"$1"),Number(o)*n}var Gn={correlationId:function(e){e=e||11;for(var t="abcdefghjkmnpqrstuvwxyzABCDEFGHJKMNPQRSTUVWXYZ",n="",i=0;i<e;i++)n+=(i+1)%3==0?"23456789"[Math.floor(Math.random()*"23456789".length)]:t[Math.floor(Math.random()*t.length)];return n+"/"+Wn++},ensure:function(e){return oi.isNullOrUndefined(e)?e:Number(e)},isNumber:function(e){return"number"==typeof e&&!isNaN(e)},randomId:function(e){e=e||8;for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n="",i=0;i<e;i++)n+=t[Math.floor(Math.random()*t.length)];return n},round:function(e,t,n){if(null==e)return e;switch(e=zn(e,n=n||0),t){case Un.UP:e=e<0?-Math.ceil(Math.abs(e)):Math.ceil(e);break;case Un.DOWN:e=e<0?-Math.floor(Math.abs(e)):Math.floor(e);break;case Un.CEILING:e=Math.ceil(e);break;case Un.FLOOR:e=Math.floor(e);break;case Un.HALF_DOWN:e=e<0?Math.round(e):-Math.round(-e);break;default:e=e<0?-Math.round(Math.abs(e)):Math.round(e)}return zn(e,-n)},shiftDecimalPoint:zn,toBase62:function(e){if(void 0!==e){for(var t,n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),i="";e>=1;)i=n[e-62*(t=Math.floor(e/62))]+i,e=t;return i}}},Un={UP:"UP",DOWN:"DOWN",CEILING:"CEILING",FLOOR:"FLOOR",HALF_UP:"HALF_UP",HALF_DOWN:"HALF_DOWN",HALF_EVEN:"HALF_EVEN",UNNECESSARY:"UNNECESSARY"};function Kn(e){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var qn=/\${const:([^}]*)}/;function Yn(e){return"object"===Kn(e)&&!Jn(e)&&!Array.isArray(e)}function Xn(e){return"string"==typeof e}function Jn(e){return null==e}function Zn(e){return s.a.isFunction(e)}function Qn(e){return Array.isArray(e)}function ei(e,t){var n=[];if(e)for(var i in"function"!=typeof e.hasOwnProperty&&(t=!0),e)(t||e.hasOwnProperty(i))&&n.push(e[i]);return n}function ti(e,t){return e===t||!!(e&&t&&e.equals&&t.equals)&&e.equals(t)}function ni(e,t){var n=e[t];if(!n||"function"!=typeof n)throw new Error("Function '"+t+"' does not exist on object. Check if it has been renamed or moved.",e);return n}function ii(e){return e?Array.prototype.slice.call(e):[]}function ri(e,t){if(!Xn(e))return e;var n=qn.exec(e);if(n&&2===n.length){for(var i=n[1].split("."),r=t||window,o=0;o<i.length;o++)if(void 0===(r=r[i[o]]))return window.console.log("Failed to resolve constant '"+n[1]+"', object is undefined"),e;return r}return e}var oi={CONST_REGEX:qn,argumentsToArray:ii,checkFunctionOverrides:function(){var e=["ModelAdapter.init","ModelAdapter._init","Calendar.init"],t=["Legend:","[!] Function includes super call, and parent function uses arguments"," ~  Function includes super call, but parent function does not use arguments","    Function does not include super call","","Wrong number of arguments:"],n=["Different argument names:"];for(var i in O)if(O.hasOwnProperty(i)){var r=O[i];if("function"==typeof r&&r.parent)for(var o in r.prototype)if(r.prototype.hasOwnProperty(o)){var s=r.prototype[o];if("constructor"!==o&&r.prototype.hasOwnProperty(o)&&"function"==typeof s)for(var a=m(s),u=r.parent;u;){var l=u.prototype[o];if(u.prototype.hasOwnProperty(o)&&"function"==typeof l){for(var c=m(l),f=!1,h=0;h<c.length;h++)if(a.length<h||a[h]!==c[h]){f=!0;break}var d=i+"."+o;if(f&&-1===e.indexOf(d)){var p=d+"("+a.join(", ")+") does not correctly override "+_(l)+"."+o+"("+c.join(", ")+")",y=null!==s.toString().match(new RegExp("scout."+En.quote(i)+".parent.prototype."+En.quote(o)+".call\\(")),v=!1;if(y)for(var b=0;b<c.length;b++){var g=l.toString().match(new RegExp("[^.\\w]"+En.quote(c[b])+"[^\\w]","g"));if(null!==g&&g.length>1){v=!0;break}}p=(y?v?"[!]":" ~ ":"   ")+" "+p,a.length!==c.length?t.push(p):n.push(p)}}u=u.parent}}}return t.push(""),t.concat(n);function m(e){if("function"!=typeof e)throw new Error("Argument is not a function: "+e);var t=e.toString().replace(/\/\*.*?\*\/|\/\/.*$/gm,"").match(/^function[^(]*\((.*?)\)/m),n=[];return null!==t&&t[1].split(",").forEach((function(e,t){(e=e.trim()).length>0&&n.push(e)})),n}function _(e){for(var t in O)if(O.hasOwnProperty(t)){var n=O[t];if("function"==typeof n)for(var i in n.prototype)if(n.prototype.hasOwnProperty(i)){var r=n.prototype[i];if("constructor"!==i&&n.prototype.hasOwnProperty(i)&&"function"==typeof r&&r===e)return t}}return""}},copyOwnProperties:function(e,t,n){var i;for(i in n=et.ensure(n),e)!Object.prototype.hasOwnProperty.call(e,i)||0!==n.length&&-1===n.indexOf(i)||(t[i]=e[i]);return t},copyProperties:function(e,t,n){var i;for(i in n=et.ensure(n),e)0!==n.length&&-1===n.indexOf(i)||(t[i]=e[i]);return t},countOwnProperties:function(e){if(!Object.getPrototypeOf(e))return Object.keys(e).length;var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t},createMap:function(e){var t=Object.create(null);return e&&s.a.extend(t,e),t},equals:ti,equalsRecursive:function e(t,n){var i;if(Yn(t)&&Yn(n)){if(Zn(t.equals)&&Zn(n.equals))return t.equals(n);var r=Object.keys(t),o=Object.keys(n);if(!et.equalsIgnoreOrder(r,o))return!1;for(i=0;i<r.length;i++)if(!e(t[r[i]],n[r[i]]))return!1;return!0}if(Qn(t)&&Qn(n)){if(t.length!==n.length)return!1;for(i=0;i<t.length;i++)if(!e(t[i],n[i]))return!1;return!0}return t===n},extractProperties:function(e,t,n){return n.forEach((function(n){void 0===t[n]&&(t[n]=e[n])})),t},findChildObjectByKey:function e(t,n,i){if(null==t||"object"!==Kn(t))return null;if(t[n]===i)return t;var r;if(Array.isArray(t))for(var o=0;o<t.length;o++)if(r=e(t[o],n,i))return r;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&(r=e(t[s],n,i)))return r;return null},forEachArgument:function(e,t){return ii(e).forEach(t)},isArray:Qn,isFunction:Zn,isNullOrUndefined:Jn,isNumber:function(e){return null!==e&&!isNaN(e)&&isFinite(e)&&!isNaN(parseFloat(e))},isPlainObject:Yn,isString:Xn,keyByValue:function(e,t){return Object.keys(e)[ei(e).indexOf(t)]},mandatoryFunction:ni,optProperty:function(e){if(!e)return null;var t=arguments.length;if(t<2)return e;if(2===t)return e[arguments[1]];for(var n=1;n<t-1;n++)if(!(e=e[arguments[n]]))return null;return e[arguments[t-1]]},propertiesEquals:function(e,t,n){var i,r;for(i=0;i<n.length;i++)if(!ti(e[r=n[i]],t[r]))return!1;return!0},replacePrototypeFunction:function(e,t,n,i){var r=e.prototype;ni(r,t),i&&(r[t+"Orig"]=r[t]),r[t]=n},resolveConst:ri,resolveConstProperty:function(e,t){O.assertProperty(t,"property"),O.assertProperty(t,"constType");var n=e[t.property],i=ri(n,t.constType);n!==i&&(e[t.property]=i)},someOwnProperties:function(e,t){return et.ensure(t).some((function(t){return Object.prototype.hasOwnProperty.call(e,t)}))},someProperties:function(e,t){return et.ensure(t).some((function(t){return t in e}))},valueCopy:function e(t){if(null==t||"object"!==Kn(t))return t;var n;if(Array.isArray(t)){n=[];for(var i=0;i<t.length;i++)n[i]=e(t[i]);return n}for(var r in n={},t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=e(t[r]));return n},values:ei};var si={install:function(e){!function(e){if(e.FormData)return;e.FormData=function(){polyfill=!0,_boundary="ScoutFormData-"+Gn.randomId(50),_data=[],_crlf="\r\n"},e.FormData.prototype.append=function(e,t,n){var i=[e,t,n];_data.push(i)},e.FormData.prototype.getContent=function(){var t="";return _data.forEach((function(n){var i=n[0],r=n[1],o=n[2];if(t+="--"+_boundary+_crlf,Mt.get().supportsFile()&&r instanceof e.File){var s=r;o=o||s.name||i,t+='Content-Disposition: form-data; name="'+i+'"; filename="'+o+'"'+_crlf,t+="Content-Type: "+s.type+_crlf,t+=_crlf,t+=(s.getAsBinary?s.getAsBinary():"UNKNOWN CONTENT")+_crlf}else t+='Content-Disposition: form-data; name="'+i+'";'+_crlf,t+=_crlf,t+=r+_crlf})),t+="--"+_boundary+"--"},e.FormData.prototype.applyToAjaxOptions=function(e){e&&(e.xhr=function(){var e=s.a.ajaxSettings.xhr();return e.send=e.sendAsBinary||e.send,e},e.contentType="multipart/form-data; boundary="+_boundary,e.data=getContent())}}(e),function(e){if(Math.sign)return;Math.sign=function(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1}}()}};function ai(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ui=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.results=[],this.error=null,this.items=t,this.currentItem=0,this.aborted=!1}var t,n,i;return t=e,(n=[{key:"hasNext",value:function(){return!this.error&&!this.aborted&&this.currentItem<this.items.length}},{key:"next",value:function(){var e=this.currentItem;return this.createPromise().done(function(){this._addResults.apply(this,[e,oi.argumentsToArray(arguments)])}.bind(this)).fail(function(){this.error=arguments.length>0?arguments:new Error("Promise execution failed")}.bind(this))}},{key:"createPromise",value:function(){if(this.currentItem>=this.items.length)throw new Error("items out of bounds");var e=this._createPromise();return this.currentItem++,e}},{key:"_createPromise",value:function(){return this.items[this.currentItem]()}},{key:"_addResults",value:function(e,t){0===t.length?t=void 0:1===t.length&&(t=t[0]),this.results[e]=t}},{key:"abort",value:function(){this.aborted=!0}}])&&ai(t.prototype,n),i&&ai(t,i),e}();var li={groupwise:function(e,t){var n=s.a.Deferred();return o(t),n.promise();function i(){setTimeout(o.bind(this,t))}function r(){n.reject.apply(n,t.error)}function o(t){if(t.hasNext()){for(var o=[];o.length<e&&t.hasNext();)o.push(t.next());s.a.promiseAll(o,!0).done(i).fail(r)}else n.resolve.apply(n,t.results)}},oneByOne:function(e){var t=s.a.Deferred();return r(e),t.promise();function n(){setTimeout(r.bind(this,e))}function i(){t.reject.apply(t,e.error)}function r(e){e.hasNext()?e.next().done(n).fail(i):t.resolve.apply(t,e.results)}},parallel:function(e,t,n){n=n||0;var i=s.a.Deferred(),r=0;return u(t),i.promise();function o(){r--,setTimeout(u.bind(this,t),n)}function a(){i.reject.apply(i,t.error)}function u(t){if("pending"===i.state()){for(;t.hasNext()&&r<e;)r++,t.next().done(o).fail(a);0===r&&i.resolve.apply(i,[t.results])}}}};function ci(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fi=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.from=t,this.to=n}var t,n,i;return t=e,(n=[{key:"equals",value:function(e){return this.from===e.from&&this.to===e.to}},{key:"subtract",value:function(t){if(0===t.size())return[new e(this.from,this.to)];if(this.from>=t.from&&this.to<=t.to)return[new e(0,0)];if(t.from>=this.from&&t.to<=this.to){var n=new e(this.from,t.from),i=new e(t.to,this.to);return 0===n.size()?[i]:0===i.size()?[n]:[n,i]}return t.from>this.from&&t.from<this.to?[new e(this.from,t.from)]:this.from>t.from&&this.from<t.to?[new e(t.to,this.to)]:[new e(this.from,this.to)]}},{key:"subtractAll",value:function(t){for(var n=t.shift(),i=[this],r=[];n;)i.forEach(o.bind(n)),i=r,r=[],n=t.shift();function o(e){et.pushAll(r,e.subtract(n))}return 0===(i=i.filter((function(e){return e.size()>0}))).length&&i.push(new e(0,0)),i}},{key:"shrink",value:function(t){return 0===t.size()?new e(this.from,this.to):this.from>=t.from&&this.to<=t.to?new e(0,0):t.from>=this.from&&t.to<=this.to?new e(this.from,t.to):t.from>=this.from&&t.from<this.to?new e(this.from,t.from):this.from>t.from&&this.from<t.to?new e(t.to,this.to):t.to<this.from?new e(this.from-t.size()-1,this.to-t.size()-1):new e(this.from,this.to)}},{key:"union",value:function(t){if(this.to<t.from||t.to<this.from){var n=new e(this.from,this.to),i=new e(t.from,t.to);return 0===n.size()?[i]:0===i.size()?[n]:[n,i]}return[new e(Math.min(this.from,t.from),Math.max(this.to,t.to))]}},{key:"add",value:function(t){if(this.to<t.from||t.to<this.from){var n=new e(this.from,this.to),i=new e(t.from,t.to);if(0===n.size())return i;if(0===i.size())return n;throw new Error("Range to add has to border on the existing range. "+this+", "+t)}return new e(Math.min(this.from,t.from),Math.max(this.to,t.to))}},{key:"intersect",value:function(t){return this.to<=t.from||t.to<=this.from?new e(0,0):new e(Math.max(this.from,t.from),Math.min(this.to,t.to))}},{key:"size",value:function(){return this.to-this.from}},{key:"contains",value:function(e){return this.from<=e&&e<this.to}},{key:"toString",value:function(){return"scout.Range[from="+(null===this.from?"null":this.from)+" to="+(null===this.to?"null":this.to)+"]"}}])&&ci(t.prototype,n),i&&ci(t,i),e}();function hi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function di(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.message=null,this.severity=e.Severity.ERROR,this.code=0,s.a.extend(this,t),"string"==typeof this.severity&&(this.severity=e.Severity[this.severity.toUpperCase()]),t&&t.children&&Array.isArray(t.children)&&(this.children=t.children.map((function(t){return e.ensure(t)})))}var t,n,i;return t=e,i=[{key:"clone",value:function(e){return e?e.clone():null}},{key:"cssClassForSeverity",value:function(t){var n,i=e.Severity;switch(t){case i.OK:n="ok";break;case i.INFO:n="info";break;case i.WARNING:n="warning";break;case i.ERROR:n="error"}return n}},{key:"animateStatusMessage",value:function(e,t){if(En.endsWith(t,"...")){for(var n=e.makeSpan("ellipsis"),i=0;i<3;i++)n.append(e.makeSpan("animate-dot delay-"+i,"."));t=t.substring(0,t.length-3),e.empty().text(t).append(n)}else e.text(t)}},{key:"ensure",value:function(t){return t?t instanceof e?t:new e(t):t}},{key:"ok",value:function(t){return e._create(t,e.Severity.OK)}},{key:"info",value:function(t){return e._create(t,e.Severity.INFO)}},{key:"warn",value:function(t){return!e._warnDeprecationLogged&&window.console&&(window.console.warn||window.console.log)&&((window.console.warn||window.console.log)("scout.Status.warn() is deprecated and will be removed in a future release. Please use Status.warning() instead."),e._warnDeprecationLogged=!0),e.warning(t)}},{key:"warning",value:function(t){return e._create(t,e.Severity.WARNING)}},{key:"error",value:function(t){return e._create(t,e.Severity.ERROR)}},{key:"_create",value:function(t,n){return t="string"==typeof t?{message:t}:t||{},new e(t=s.a.extend({},t,{severity:n}))}},{key:"asFlatList",value:function(t){if(!t)return[];var n=[];return t.children&&t.children.forEach((function(t){et.pushAll(n,e.asFlatList(t))})),n.push(t),n}}],(n=[{key:"cssClass",value:function(){return e.cssClassForSeverity(this.severity)}},{key:"isValid",value:function(){return this.severity===e.Severity.OK||this.severity===e.Severity.INFO}},{key:"isError",value:function(){return this.severity===e.Severity.ERROR}},{key:"isWarning",value:function(){return this.severity===e.Severity.WARNING}},{key:"isInfo",value:function(){return this.severity===e.Severity.INFO}},{key:"isOk",value:function(){return this.severity===e.Severity.OK}},{key:"asFlatList",value:function(){return e.asFlatList(this)}},{key:"clone",value:function(){return new e(s.a.extend({},this))}},{key:"equals",value:function(t){return t instanceof e&&oi.propertiesEquals(this,t,["severity","message","invalidDate","invalidTime"])}}])&&hi(t.prototype,n),i&&hi(t,i),e}();function yi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}di(pi,"Severity",{OK:1,INFO:256,WARNING:65536,ERROR:16777216}),di(pi,"SEVERITY_CSS_CLASSES","error warning info ok"),di(pi,"_warnDeprecationLogged",!1);var vi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tagName=t,this.cachedElement=null}var t,n,i;return t=e,(n=[{key:"get",value:function(){return this.cachedElement||(this.cachedElement=document.createElement(this.tagName)),this.cachedElement}}])&&yi(t.prototype,n),i&&yi(t,i),e}();function bi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var gi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=new vi("textarea")}var t,n,i;return t=e,(n=[{key:"encode",value:function(e,t){if(t=t||{},!e)return e;e=(e=(e=(e=(e=(e=En.asString(e)).replace(/<br>|<br\/>|<\/p>|<p\/>|<\/div>|<\/li>|<\/tr>/gi,"\n")).replace(/<\/td>/gi," ")).replace(/<[^>]+>/gi,"")).replace(/^[ ]+/gm,"")).replace(/[ ]+$/gm,""),t.compact&&(e=e.replace(/\n{3,}/gm,"\n\n")),t.trim&&(e=e.trim());var n=this.cache.get();return n.innerHTML=e,n.value}}])&&bi(t.prototype,n),i&&bi(t,i),e}();function mi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=new vi("div")}var t,n,i;return t=e,(n=[{key:"encode",value:function(e){if(!e)return e;var t=this.cache.get();return t.textContent=e,t.innerHTML}}])&&mi(t.prototype,n),i&&mi(t,i),e}(),wi={},ki=null;function Si(e,t,n){var i=wi[e];t=(t=et.ensure(t)).map((function(e){return{name:e,nameCamelCase:e.replace(/-(.)/g,(function(e,t){return t.toUpperCase()}))}})),i||Oi(e,i={});var r=t.filter((function(e){return!(e.nameCamelCase in i)}));if(0===r.length)return i;var o=ki;o||((o=window.document.createElement("div")).style.display="none",window.document.body.appendChild(o),ki=o),o.className=e,n&&(o.className+=" "+n);var s=window.getComputedStyle(o);return r.forEach((function(e){i[e.nameCamelCase]=s[e.name]})),o.className="",i}function Oi(e,t){wi[e]=t}var Ti={red:0,green:0,blue:0},Ci={red:255,green:255,blue:255};function Pi(e){if(e){var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?(\d+(\.\d+)?)?/i);if(null!==t)return{red:parseInt(t[1],10),green:parseInt(t[2],10),blue:parseInt(t[3],10),alpha:parseFloat(O.nvl(t[4],1))}}}function Ri(e,t,n,i){if("string"==typeof e&&(e=Pi(e)),"string"==typeof n&&(n=Pi(n)),e||n)return t=O.nvl(t,0),i=O.nvl(i,0),e||(e=Ti,t=0),n||(n=Ti,i=0),0===t&&0===i?"rgb(0,0,0)":"rgb("+Gn.round((t*e.red+i*n.red)/(t+i))+","+Gn.round((t*e.green+i*n.green)/(t+i))+","+Gn.round((t*e.blue+i*n.blue)/(t+i))+")"}function xi(e){var t={};if(En.hasText(e))for(var n=e.split(/[-_,/.;]/),i=0;i<n.length;i++){var r=n[i].toUpperCase();"NULL"===r||"0"===r||"PLAIN"===r||("BOLD"===r?t.bold=!0:"ITALIC"===r?t.italic=!0:/^\d+$/.test(r)?t.size=r:"NULL"!==r&&(t.name=n[i]))}return t}function Ei(e){if(!e)return"";var t="";return/^[A-Fa-f0-9]{3}([A-Fa-f0-9]{3})?$/.test(e)?t="#"+e:/^[A-Za-z0-9().,%-]+$/.test(e)&&(t=e),t}function Di(e,t,n){n=n||"";var i="";e&&(i=Ei(e[En.lowercaseFirstLetter(n+"ForegroundColor")]));t&&t.css("color",i);var r="";return i&&(r+="color: "+i+"; "),r}function Fi(e,t,n){n=n||"";var i="";e&&(i=Ei(e[En.lowercaseFirstLetter(n+"BackgroundColor")]));t&&t.css("background-color",i);var r="";return i&&(r+="background-color: "+i+"; "),r}function Ai(e,t,n){n=n||"";var i="",r="",o="",s="";if(e){var a=xi(e[En.lowercaseFirstLetter(n+"Font")]);a.bold&&(i="bold"),a.italic&&(r="italic"),a.size&&(o=a.size+"pt"),a.name&&(s=a.name)}t&&t.css("font-weight",i).css("font-style",r).css("font-size",o).css("font-family",s);var u="";return i&&(u+="font-weight: "+i+"; "),r&&(u+="font-style: "+r+"; "),o&&(u+="font-size: "+o+"; "),s&&(u+="font-family: "+s+"; "),u}var $i={RGB_BLACK:Ti,RGB_WHITE:Ci,clearCache:function(){wi={}},darkerColor:function(e,t){var n=Pi(e);if(n)return t=O.nvl(t,.2),Ri(Ti,t,n,1-t)},get:Si,getSize:function(e,t,n,i,r){var o=Si(e,t,r)[n];return"auto"===o?i:s.a.pxToNumber(o)},legacyBackgroundColor:Fi,legacyFont:Ai,legacyForegroundColor:Di,legacyStyle:function(e,t,n){var i="";return i+=Di(e,t,n),i+=Fi(e,t,n),i+=Ai(e,t,n)},lighterColor:function(e,t){var n=Pi(e);if(n)return t=O.nvl(t,.2),Ri(Ci,t,n,1-t)},mergeRgbColors:Ri,modelToCssColor:Ei,parseFontSpec:xi,put:Oi,rgb:Pi,styleMap:wi,_getElement:function(){return ki}};function ji(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Mi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.array=[],this.properties=oi.createMap()}var t,n,i;return t=e,(n=[{key:"add",value:function(e){this.contains(e)||(this.array.push(e),this.array.sort(),this.properties[e]=!0)}},{key:"size",value:function(){return this.array.length}},{key:"contains",value:function(e){return e in this.properties}},{key:"last",value:function(){return this.array[this.array.length-1]}}])&&ji(t.prototype,n),i&&ji(t,i),e}();function Ii(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Li=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===t&&(t=window.location.href);var n=/^([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/.exec(t||"");this.baseUrlRaw=n[1],this.queryPartRaw=n[2],this.hashPartRaw=n[3],this.parameterMap=e._parse(this.queryPartRaw)}var t,n,i;return t=e,i=[{key:"_sorter",value:function(e,t){return null===e?-1:null===t?1:e.toString().localeCompare(t)}},{key:"_formatQueryParam",value:function(e,t){var n=encodeURIComponent(e);return null!=t&&(n+="="+encodeURIComponent(t)),n}},{key:"_addToMap",value:function(e,t,n){if(void 0===e)throw new Error("Argument 'map' must not be null");if(void 0===t)throw new Error("Argument 'key' must not be null");if(t in e){var i=e[t];Array.isArray(i)?i.push(n):e[t]=[i,n]}else e[t]=n}},{key:"_parse",value:function(t){for(var n,i,r,o=(t||"").replace(/\+/g," "),s=/([^&=]+)(=?)([^&]*)/g,a={};n=s.exec(o);)i=decodeURIComponent(n[1]),""===(r=decodeURIComponent(n[3]))&&"="!==n[2]&&(r=null),e._addToMap(a,i,r);return a}}],(n=[{key:"hasParameter",value:function(e){return this.parameterMap.hasOwnProperty(e)}},{key:"getParameter",value:function(t){if("string"!=typeof t)throw new Error("Illegal argument type: "+t);var n=this.parameterMap[t];return Array.isArray(n)?n.sort(e._sorter):n}},{key:"removeParameter",value:function(e){if("string"!=typeof e)throw new Error("Illegal argument type: "+e);return delete this.parameterMap[e],this}},{key:"setParameter",value:function(e,t){if("string"!=typeof e)throw new Error("Illegal argument type: "+e);if(""!==e)return this.parameterMap[e]=t,this}},{key:"addParameter",value:function(t,n){if("string"!=typeof t)throw new Error("Illegal argument type: "+t);if(""!==t)return e._addToMap(this.parameterMap,t,n),this}},{key:"toString",value:function(t){var n=this.baseUrlRaw;if(Object.keys(this.parameterMap).length){var i=(t=t||{}).sorter||e._sorter;if(t.alwaysFirst||t.alwaysLast){t.alwaysFirst=et.ensure(t.alwaysFirst),t.alwaysLast=et.ensure(t.alwaysLast);var r=i;i=function(e,n){var i=t.alwaysFirst.indexOf(e),o=t.alwaysFirst.indexOf(n),s=t.alwaysLast.indexOf(e),a=t.alwaysLast.indexOf(n);return-1!==i?-1===o?-1:i-o:-1!==o?1:-1!==s?-1===a?1:s-a:-1!==a?-1:r(e,n)}}n+="?"+Object.keys(this.parameterMap).sort(i).map(function(t){var n=this.getParameter(t);return Array.isArray(n)?n.map((function(i,r){return e._formatQueryParam(t,n[r])})).join("&"):e._formatQueryParam(t,n)}.bind(this)).join("&")}return this.hashPartRaw&&(n+="#"+this.hashPartRaw),n}},{key:"clone",value:function(){return new e(this.toString())}}])&&Ii(t.prototype,n),i&&Ii(t,i),e}();var Bi={ensure:function(e){return e?Array.isArray(e)?e:[e]:[]},notSameFilter:function(e){return e=e instanceof s.a?e[0]:e,function(){return this!==e}},outsideFilter:function(e){return e=e instanceof s.a?e[0]:e,function(){return this!==e&&!s.a.contains(e,this)}},returnFalse:function(){return!1},returnTrue:function(){return!0}},Ni={LEFT:"left",RIGHT:"right",CENTER:"center"};var Hi=sn.SUM_BOLD;var Vi=sn.AVG_BOLD;var Wi=sn.MIN_BOLD;var zi={avgFinish:function(e){if(e.count&&e.count>0)return 1*e.sum/e.count},avgStart:function(){return{sum:0,count:0}},avgStep:function(e,t){return"number"==typeof t&&(e.sum+=t,e.count+=1),e},avgSymbol:Vi,maxFinish:function(e){return e},maxStart:function(){return null},maxStep:function(e,t){return"number"==typeof t&&("number"==typeof e?t>e&&(e=t):e=t),e},maxSymbol:sn.MAX_BOLD,minFinish:function(e){return e},minStart:function(){return null},minStep:function(e,t){return"number"==typeof t&&("number"==typeof e?t<e&&(e=t):e=t),e},minSymbol:Wi,sumFinish:function(e){return e},sumStart:function(){return null},sumStep:function(e,t){return"number"==typeof t&&(e=(e||0)+t),e},sumSymbol:Hi};var Gi={clear:function(e){try{return e.clear()}catch(e){s.a.log.error("Error while clearing web storage: "+e)}},getItem:function(e,t){try{return e.getItem(t)}catch(e){s.a.log.error('Error while reading "'+t+'" from web storage: '+e)}},removeItem:function(e,t){try{return e.removeItem(t)}catch(e){s.a.log.error('Error while removing "'+t+'" from web storage: '+e)}},setItem:function(e,t,n){try{return e.setItem(t,n)}catch(e){s.a.log.error('Error while storing "'+t+'" in web storage: '+e)}}};var Ui={get:function(e,t){for(var n=e+"=",i=(t=t||document).cookie.split(";"),r=0;r<i.length;r++){var o=i[r].trim();if(0===o.indexOf(n))return o.substring(n.length)}return null},set:function(e,t,n,i){var r=e+"="+(t=O.nvl(t,""));if((n=O.nvl(n,-1))>-1){var o=new Date;o.setTime(o.getTime()+1e3*n),r+=";max-age="+n+";expires="+o}i&&(r+=";path="+i),document.cookie=r}};function Ki(e){return Yi(e).call()}function qi(e){return Xi(e).call()}function Yi(e){return Xi(s.a.extend({},{type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8"},e))}function Xi(e){var t=s.a.extend({},{cache:!1},e);return O.create("AjaxCall",{ajaxOptions:t},{ensureUniqueId:!1})}var Ji={createCall:Xi,createCallJson:Yi,call:qi,callJson:Ki,get:function(e,t){return qi(s.a.extend({},{url:e,type:"GET"},t))},getJson:function(e,t){return Ki(s.a.extend({},{url:e,type:"GET"},t))},post:function(e,t,n){return qi(s.a.extend({},{url:e,type:"POST",data:t},n))},postJson:function(e,t,n){return t&&"string"!=typeof t&&(t=JSON.stringify(t)),Ki(s.a.extend({},{url:e,type:"POST",data:t},n))},put:function(e,t,n){return qi(s.a.extend({},{url:e,type:"PUT",data:t},n))},putJson:function(e,t,n){return t&&"string"!=typeof t&&(t=JSON.stringify(t)),Ki(s.a.extend({},{url:e,type:"PUT",data:t},n))},remove:function(e,t){return qi(s.a.extend({},{url:e,type:"DELETE"},t))},removeJson:function(e,t){return Ki(s.a.extend({},{url:e,type:"DELETE"},t))}};function Zi(e){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function er(e,t,n){return(er="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rr(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function tr(e,t){return(tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=rr(e);if(t){var r=rr(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ir(this,n)}}function ir(e,t){return!t||"object"!==Zi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rr(e){return(rr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var or=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tr(e,t)}(o,e);var t,n,i,r=nr(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).type="ajax",e.ajaxOptions=null,e}return t=o,i=[{key:"isOfflineError",value:function(e,t,n,i){return!e.status||e.status>=12e3||502===e.status||503===e.status||504===e.status}}],(n=[{key:"init",value:function(e){if(!e)throw new Error('Missing argument "model"');if(!e.ajaxOptions)throw new Error('Missing model property "ajaxOptions"');e.name||(e.name=e.ajaxOptions.url),er(rr(o.prototype),"init",this).call(this,e)}},{key:"_callImpl",value:function(){return 1!==this.callCounter&&(this.ajaxOptions.url=new Li(this.ajaxOptions.url).setParameter("retry",this.callCounter-1).toString({alwaysLast:["retry"]})),s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+(1===this.callCounter?"--- ":"")+this.ajaxOptions.type+' "'+this.ajaxOptions.url+'"'+(1===this.callCounter?" ---":"")),s.a.ajax(this.ajaxOptions)}},{key:"_setResultFail",value:function(e,t,n){this._setResult(new sr({jqXHR:e,textStatus:t,errorThrown:n,requestOptions:this.ajaxOptions}))}},{key:"_onCallDone",value:function(e,t,n){s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"AJAX success"),er(rr(o.prototype),"_onCallDone",this).call(this,e,t,n)}},{key:"_onCallFail",value:function(e,t,n){s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"AJAX fail: type="+t+", httpStatus="+e.status+(n?' "'+n+'"':"")),er(rr(o.prototype),"_onCallFail",this).call(this,e,t,n)}},{key:"_nextRetryImpl",value:function(e,t,n){return o.isOfflineError(e,t,n,this.request)?er(rr(o.prototype),"_nextRetryImpl",this).call(this):(s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"Unexpected HTTP error"),!1)}}])&&Qi(t.prototype,n),i&&Qi(t,i),o}(nt);var sr=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jqXHR=null,this.textStatus=null,this.errorThrown=null,this.requestOptions=null,s.a.extend(this,t)};function ar(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ur=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=null,this.hierarchical=!1,this.loadIncremental=!1,this.batch=!1,this.queryBy=null,this.searchText=null,this.key=null,this.keys=null,this.parentKey=null,this.active=null}var t,n,i;return t=e,i=[{key:"ensure",value:function(t,n){return t instanceof e||(oi.isPlainObject(t)?(t.session=n,t=O.create(t)):"string"==typeof t&&(t=O.create(t,{session:n}))),t}},{key:"firstLookupRow",value:function(e){return e&&oi.isArray(e.lookupRows)?0===e.lookupRows.length?null:e.lookupRows[0]:null}}],(n=[{key:"init",value:function(e){O.assertParameter("session",e.session),this._init(e)}},{key:"_init",value:function(e){s.a.extend(this,e)}},{key:"setLoadIncremental",value:function(e){this.loadIncremental=e}},{key:"setHierarchical",value:function(e){this.hierarchical=e}},{key:"setBatch",value:function(e){this.batch=e}},{key:"textByKey",value:function(e){return oi.isNullOrUndefined(e)?s.a.resolvedPromise(""):this._textByKey(e)}},{key:"_textByKey",value:function(t){return this.cloneForKey(t).execute().then((function(t){var n=e.firstLookupRow(t);return n?n.text:""}))}},{key:"textsByKeys",value:function(e){return et.empty(e)?s.a.resolvedPromise({}):this._textsByKeys(e)}},{key:"_textsByKeys",value:function(e){return this.cloneForKeys(e).execute().then((function(e){if(!e||!oi.isArray(e.lookupRows))return{};var t={};return e.lookupRows.forEach((function(e){t[e.key]=e.text})),t}))}},{key:"getAll",value:function(){return this.queryBy=_r.ALL,this._getAll()}},{key:"_getAll",value:function(){throw new Error("getAll() not implemented")}},{key:"getByText",value:function(e){return this.queryBy=_r.TEXT,this.searchText=e,this._getByText(e)}},{key:"_getByText",value:function(e){throw new Error("getByText() not implemented")}},{key:"getByKey",value:function(e){return this.queryBy=_r.KEY,this.key=e,this._getByKey(e)}},{key:"_getByKey",value:function(e){throw new Error("getByKey() not implemented")}},{key:"getByKeys",value:function(e){return this.queryBy=_r.KEYS,this.keys=e,this._getByKeys(e)}},{key:"_getByKeys",value:function(e){throw new Error("getByKeys() not implemented")}},{key:"getByRec",value:function(e){return this.queryBy=_r.REC,this.parentKey=e,this._getByRec(e)}},{key:"_getByRec",value:function(e){throw new Error("getByRec() not implemented")}},{key:"execute",value:function(){if(_r.KEY===this.queryBy)return this._getByKey(this.key);if(_r.ALL===this.queryBy)return this._getAll();if(_r.KEYS===this.queryBy)return this._getByKeys(this.keys);if(_r.TEXT===this.queryBy)return this._getByText(this.searchText);if(_r.REC===this.queryBy)return this._getByRec(this.parentKey);throw new Error("cannot execute a non-clone LookupCall. Use one of the cloneFor*-methods before executing.")}},{key:"clone",value:function(e){return O.cloneShallow(this,e,!0)}},{key:"cloneForAll",value:function(){return this.clone({queryBy:_r.ALL})}},{key:"cloneForText",value:function(e){return this.clone({queryBy:_r.TEXT,searchText:e})}},{key:"cloneForKey",value:function(e){return this.clone({queryBy:_r.KEY,key:e})}},{key:"cloneForKeys",value:function(e){return this.clone({queryBy:_r.KEYS,keys:e})}},{key:"cloneForRec",value:function(e){return this.clone({queryBy:_r.REC,parentKey:e})}},{key:"abort",value:function(){}}])&&ar(t.prototype,n),i&&ar(t,i),e}();function lr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var cr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=null,this.text=null,this.parentKey=null,this.enabled=!0,this.active=!0,this.additionalTableRowData=null,this.cssClass=null,this.iconId=null,this.tooltipText=null,this.backgroundColor=null,this.foregroundColor=null,this.font=null}var t,n,i;return t=e,(n=[{key:"init",value:function(e){s.a.extend(this,e)}},{key:"setKey",value:function(e){this.key=e}},{key:"setText",value:function(e){this.text=e}},{key:"setParentKey",value:function(e){this.parentKey=e}},{key:"setCssClass",value:function(e){this.cssClass=e}},{key:"setAdditionalTableRowData",value:function(e){this.additionalTableRowData=e}},{key:"setIconId",value:function(e){this.iconId=e}},{key:"setTooltipText",value:function(e){this.tooltipText=e}},{key:"setBackgroundColor",value:function(e){this.backgroundColor=e}},{key:"setForegroundColor",value:function(e){this.foregroundColor=e}},{key:"setFont",value:function(e){this.font=e}},{key:"toString",value:function(){return"scout.LookupRow[key="+this.key+" text="+this.text+"]"}}])&&lr(t.prototype,n),i&&lr(t,i),e}();function fr(e){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dr(e,t){return(dr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=vr(e);if(t){var r=vr(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return yr(this,n)}}function yr(e,t){return!t||"object"!==fr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vr(e){return(vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var br=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dr(e,t)}(o,e);var t,n,i,r=pr(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).adapter=e,t.deferred=null,t}return t=o,(n=[{key:"_getAll",value:function(){return this._newDeferred(new mr(_r.ALL)),this.adapter.sendLookup(_r.ALL),this.deferred.promise()}},{key:"_getByText",value:function(e){return this._newDeferred(new mr(_r.TEXT,e)),this.adapter.sendLookup(_r.TEXT,e),this.deferred.promise()}},{key:"_getByKey",value:function(e){return this._newDeferred(new mr(_r.KEY,e)),this.adapter.sendLookup(_r.KEY,e),this.deferred.promise()}},{key:"_getByRec",value:function(e){return this._newDeferred(new mr(_r.REC,e)),this.adapter.sendLookup(_r.REC,e),this.deferred.promise()}},{key:"resolveLookup",value:function(e){if(this._belongsToLatestRequest(e)){var t=et.ensure(e.lookupRows).map((function(e){return O.create("LookupRow",e)}));e.lookupRows=t,this.deferred.resolve(e)}else s.a.log.isTraceEnabled()&&s.a.log.trace("(RemoteLookupCall#resolveLookup) ignore lookupResult. Does not belong to latest request",oi.optProperty(this.deferred,"requestParameter"))}},{key:"_belongsToLatestRequest",value:function(e){if(!this.deferred)return!1;var t=e.queryBy.toLowerCase(),n=e[t],i=new mr(e.queryBy,n);return this.deferred.requestParameter.equals(i)}},{key:"_newDeferred",value:function(e){this.deferred&&this.deferred.reject({canceled:!0}),this.deferred=s.a.Deferred(),this.deferred.requestParameter=e}}])&&hr(t.prototype,n),i&&hr(t,i),o}(ur);function gr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var mr=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!_r.hasOwnProperty(t))throw new Error("Invalid enum value");this.requestType=t,this.requestData=n}var t,n,i;return t=e,(n=[{key:"equals",value:function(t){return!!(t&&t instanceof e)&&oi.propertiesEquals(this,t,["requestType","requestData"])}}])&&gr(t.prototype,n),i&&gr(t,i),e}(),_r={ALL:"ALL",TEXT:"TEXT",KEY:"KEY",KEYS:"KEYS",REC:"REC"};function wr(e){return(wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Sr(e,t,n){return(Sr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pr(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Or(e,t){return(Or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Pr(e);if(t){var r=Pr(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Cr(this,n)}}function Cr(e,t){return!t||"object"!==wr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pr(e){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Or(e,t)}(o,e);var t,n,i,r=Tr(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).delay=0,e.data=null,e.active=!0,e}return t=o,(n=[{key:"_init",value:function(e){Sr(Pr(o.prototype),"_init",this).call(this,e),this.data||(this.data=this._data())}},{key:"refreshData",value:function(e){this.data=void 0===e?this._data():e}},{key:"_getAll",value:function(){var e=s.a.Deferred();return setTimeout(this._queryByAll.bind(this,e),this.delay),e.promise()}},{key:"_queryByAll",value:function(e){e.resolve({queryBy:_r.ALL,lookupRows:this._lookupRowsByAll()})}},{key:"_lookupRowsByAll",value:function(){return this.data.slice(0,o.MAX_ROW_COUNT+1).map(this._dataToLookupRow,this).filter(this._filterActiveLookupRow,this)}},{key:"_filterActiveLookupRow",value:function(e){return!!oi.isNullOrUndefined(this.active)||this.active===O.nvl(e.active,!0)}},{key:"_getByText",value:function(e){var t=s.a.Deferred();return setTimeout(this._queryByText.bind(this,t,e),this.delay),t.promise()}},{key:"_queryByText",value:function(e,t){var n=this._lookupRowsByText(t);this.hierarchical||e.resolve({queryBy:_r.TEXT,text:t,lookupRows:n});var i=new Er(this);(this.loadIncremental?s.a.resolvedPromise(n):i.addChildLookupRows(n)).then((function(e){return i.addParentLookupRows(e)})).done((function(n){e.resolve({queryBy:_r.TEXT,text:t,lookupRows:n})})).fail((function(e){throw e}))}},{key:"_lookupRowsByText",value:function(e){return this.data.filter((function(t){return En.startsWith(t[1].toLowerCase(),e.toLowerCase())})).map(this._dataToLookupRow,this).filter(this._filterActiveLookupRow,this)}},{key:"_getByKey",value:function(e){var t=s.a.Deferred();return setTimeout(this._queryByKey.bind(this,t,e),this.delay),t.promise()}},{key:"_queryByKey",value:function(e,t){var n=this._lookupRowByKey(t);n?e.resolve({queryBy:_r.KEY,lookupRows:[n]}):e.reject()}},{key:"_lookupRowByKey",value:function(e){var t=et.find(this.data,(function(t){return t[0]===e}));return t?this._dataToLookupRow(t):null}},{key:"_getByRec",value:function(e){var t=s.a.Deferred();return setTimeout(this._queryByRec.bind(this,t,e),this.delay),t.promise()}},{key:"_queryByRec",value:function(e,t){e.resolve({queryBy:_r.REC,rec:t,lookupRows:this._lookupRowsByRec(t)})}},{key:"_lookupRowsByRec",value:function(e){return this.data.reduce(function(t,n){return n[2]===e&&t.push(this._dataToLookupRow(n)),t}.bind(this),[]).filter(this._filterActiveLookupRow,this)}},{key:"setDelay",value:function(e){this.delay=e}},{key:"_dataToLookupRow",value:function(e){return O.create("LookupRow",{key:e[0],text:e[1],parentKey:e[2]})}},{key:"_data",value:function(){return[]}}])&&kr(t.prototype,n),i&&kr(t,i),o}(ur);function xr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Rr,"MAX_ROW_COUNT",100);var Er=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O.assertParameter("lookupCall",t),this.lookupCall=t,this._lookupRowMap={}}var t,n,i;return t=e,(n=[{key:"addParentLookupRows",value:function(e){this._fillMap(e);var t=e.map(this._addParent.bind(this));return s.a.promiseAll(t).then(function(){return oi.values(this._lookupRowMap)}.bind(this))}},{key:"_addParent",value:function(e){var t=e.parentKey;return t?this._lookupRowMap.hasOwnProperty(t)?(e=this._lookupRowMap[t],this._addParent(e)):this.lookupCall.cloneForKey(t).execute().then(function(e){var t=ur.firstLookupRow(e);return this._lookupRowMap[t.key]=t,this._addParent(t)}.bind(this)):s.a.resolvedPromise()}},{key:"_fillMap",value:function(e){e.forEach(function(e){this._lookupRowMap[e.key]=e}.bind(this))}},{key:"addChildLookupRows",value:function(e){this._fillMap(e);var t=e.map(this._addChildren.bind(this));return s.a.promiseAll(t).then(function(){return oi.values(this._lookupRowMap)}.bind(this))}},{key:"_addChildren",value:function(e){return this.lookupCall.cloneForRec(e.key).execute().then(function(e){if(e.lookupRows.length)return this.addChildLookupRows(e.lookupRows)}.bind(this))}}])&&xr(t.prototype,n),i&&xr(t,i),e}();function Dr(e){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ar=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active,this.id,this.parent,this.children=[],this.sortCode}var t,n,i;return t=e,(n=[{key:"init",value:function(e){if(O.assertParameter("id",e.id),this.active=e.active,this.id=e.id,this.sortCode=e.sortCode,this._text=e.text,this.modelClass=e.modelClass,e.texts){if(this._text)throw new Error("Either set texts or text property, not both.");var t=zr.registerTexts(this,e.texts);this._text=th.buildKey(t)}}},{key:"text",value:function(e){var t=e;return"object"===Dr(e)&&(t=e.languageTag),th.resolveText(this._text,t)}},{key:"visitChildren",value:function(e){for(var t=0;t<this.children.length;t++){var n=this.children[t],i=e(n);if(!0===i||i===JW.TERMINATE)return JW.TERMINATE;if(i!==JW.SKIP_SUBTREE&&(!0===(i=n.visitChildren(e))||i===JW.TERMINATE))return JW.TERMINATE}}}])&&Fr(t.prototype,n),i&&Fr(t,i),e}();function $r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id,this.codes=[],this.codeMap={}}var t,n,i;return t=e,i=[{key:"ensure",value:function(t){return t?t instanceof e?t:O.create("CodeType",t):t}}],(n=[{key:"init",value:function(e){if(O.assertParameter("id",e.id),this.id=e.id,this.modelClass=e.modelClass,e.codes)for(var t=0;t<e.codes.length;t++)this._initCode(e.codes[t])}},{key:"_initCode",value:function(e,t){var n=O.create(e);if(this.add(n,t),e.children)for(var i=0;i<e.children.length;i++)this._initCode(e.children[i],n)}},{key:"add",value:function(e,t){this.codes.push(e),this.codeMap[e.id]=e,t&&(t.children.push(e),e.parent=t)}},{key:"get",value:function(e){var t=this.optGet(e);if(!t)throw new Error("No code found for id="+e);return t}},{key:"optGet",value:function(e){return this.codeMap[e]}},{key:"getCodes",value:function(e){if(e){for(var t=[],n=0;n<this.codes.length;n++)this.codes[n].parent||t.push(this.codes[n]);return t}return this.codes}},{key:"visit",value:function(e){for(var t=this.codes.filter((function(e){return!e.parent})),n=0;n<t.length;n++){var i=t[n],r=e(i);if(!0===r||r===JW.TERMINATE)return JW.TERMINATE;if(r!==JW.SKIP_SUBTREE&&(!0===(r=i.visitChildren(e))||r===JW.TERMINATE))return JW.TERMINATE}}}])&&$r(t.prototype,n),i&&$r(t,i),e}(),Mr={};function Ir(e,t){if(t&&t.error)throw{error:t.error,url:e};Lr(t)}function Lr(e){e=e||{},Object.keys(e).forEach((function(t){Br(e[t])}),this)}function Br(e){(e=et.ensure(e)).forEach((function(e){e=jr.ensure(e),Mr[e.id]=e}),this)}function Nr(e,t){var n,i;if(2===t.length)n=t[0],i=t[1];else{var r=t[0].split(" ");if(2!==r.length)throw new Error('Invalid string. Must have format "[CodeType.id] [Code.id]"');n=r[0],i=r[1]}return O.assertParameter("codeTypeId",n),O.assertParameter("codeId",i),Hr(n)[e](i)}function Hr(e,t){var n=Mr[e];if(!t&&!n)throw new Error("No CodeType found for id="+e);return n}function Vr(e){return"__code."+e.id}function Wr(e){oi.values(th.textsByLocale).forEach((function(t){return t.remove(Vr(e))}))}var zr={add:Br,bootstrap:function(e){return(e?s.a.ajaxJson(e):s.a.resolvedPromise({})).then(Ir.bind(this,e))},codeType:Hr,defaultLanguage:"en",generateTextKey:Vr,get:function(e,t){return Nr("get",oi.argumentsToArray(arguments))},init:Lr,optGet:function(e,t){return Nr("optGet",oi.argumentsToArray(arguments))},registerTexts:function(e,t){var n=Vr(e);for(var i in th.get("default").remove(n),t){var r=t[i];i&&"en"===i&&(i="default"),th.get(i).add(n,r)}return n},unregisterTexts:Wr,registry:Mr,remove:function(e){(e=et.ensure(e)).forEach((function(e){"string"==typeof e&&(e=Mr[e]),e&&(e.visit((function(e){Wr(e)})),delete Mr[e.id])}),this)}};function Gr(e){return(Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ur(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Kr(e,t){return(Kr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Xr(e);if(t){var r=Xr(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Yr(this,n)}}function Yr(e,t){return!t||"object"!==Gr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xr(e){return(Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kr(e,t)}(o,e);var t,n,i,r=qr(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).codeType=null,e}return t=o,(n=[{key:"_lookupRowByKey",value:function(e){var t=zr.codeType(this.codeType,!0);return t?this._createLookupRow(t.optGet(e)):null}},{key:"_lookupRowsByAll",value:function(){return this._collectLookupRows()}},{key:"_lookupRowsByText",value:function(e){return this._collectLookupRows((function(t){var n=t.text||"";return En.startsWith(n.toLowerCase(),e.toLowerCase())}))}},{key:"_lookupRowsByRec",value:function(e){return this._collectLookupRows((function(t){return t.parentKey===e}))}},{key:"_collectLookupRows",value:function(e){var t=zr.codeType(this.codeType,!0);if(!t)return[];var n=[];return t.visit(function(t){var i=this._createLookupRow(t);e&&!e(i)||n.push(i)}.bind(this)),n}},{key:"_createLookupRow",value:function(e){return e?O.create("LookupRow",{key:e.id,text:e.text(this.session.locale),parentKey:e.parent&&e.parent.id}):null}}])&&Ur(t.prototype,n),i&&Ur(t,i),o}(Rr),Zr={STOPPED:"stopped",RUNNING:"running",FAILURE:"failure"};function Qr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var eo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled=!!t,this.status=Zr.STOPPED}var t,n,i;return t=e,(n=[{key:"setFailed",value:function(){this.status=Zr.FAILURE}},{key:"setRunning",value:function(){this.status=Zr.RUNNING}},{key:"setStopped",value:function(){this.status=Zr.STOPPED}},{key:"isFailed",value:function(){return this.status===Zr.FAILURE}},{key:"isRunning",value:function(){return this.status===Zr.RUNNING}},{key:"isStopped",value:function(){return this.status===Zr.STOPPED}}])&&Qr(t.prototype,n),i&&Qr(t,i),e}();function to(e){return(to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function no(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function io(e,t,n){return(io="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ao(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function ro(e,t){return(ro=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ao(e);if(t){var r=ao(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return so(this,n)}}function so(e,t){return!t||"object"!==to(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ao(e){return(ao=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ro(e,t)}(o,e);var t,n,i,r=oo(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).cancellable=!0,e.showTimeout=2500,e.label=null,e.details=null,e}return t=o,(n=[{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){io(ao(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new il(this,[pu.SPACE,pu.ENTER]),new bl(this,function(){return this.$cancelButton}.bind(this))])}},{key:"_init",value:function(e){io(ao(o.prototype),"_init",this).call(this,e),this.label=O.nvl(this.label,this.session.text("ui.PleaseWait_"))}},{key:"render",value:function(e){e=e||this.entryPoint(),io(ao(o.prototype),"render",this).call(this,e)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("busyindicator invisible");var e=this.$container.appendDiv("drag-handle");if(this.$container.draggable(e),this.$content=this.$container.appendDiv("busyindicator-content"),this.$label=this.$content.appendDiv("busyindicator-label"),this.$details=this.$content.appendDiv("busyindicator-details"),this.cancellable){this.$buttons=this.$container.appendDiv("busyindicator-buttons");var t=new Yl(this.$buttons);this.$cancelButton=t.addButton({text:this.session.text("Cancel"),onClick:this._onCancelClick.bind(this)}),this.$cancelButton.css("width","100%")}else this.$content.addClass("no-buttons");this._renderLabel(),this._renderDetails(),this.$container.addClass("calc-helper"),this.$container.css("min-width",this.$container.width()),this.$container.removeClass("calc-helper"),this._position(),this._busyIndicatorTimeoutId=setTimeout(function(){this.$container.removeClass("invisible").addClassForAnimation("animate-open"),this.session.focusManager.validateFocus()}.bind(this),this.showTimeout),this._glassPaneRenderer=new Bc(this),this._glassPaneRenderer.renderGlassPanes(),this._glassPaneRenderer.eachGlassPane((function(e){e.addClass("busy")}))}},{key:"_postRender",value:function(){io(ao(o.prototype),"_postRender",this).call(this),this.session.focusManager.installFocusContext(this.$container,Pc.AUTO)}},{key:"_remove",value:function(){clearTimeout(this._busyIndicatorTimeoutId),this._glassPaneRenderer.eachGlassPane((function(e){e.removeClass("busy")})),this._glassPaneRenderer.removeGlassPanes(),this.session.focusManager.uninstallFocusContext(this.$container),io(ao(o.prototype),"_remove",this).call(this)}},{key:"setLabel",value:function(e){this.setProperty("label",e)}},{key:"_renderLabel",value:function(){this.$label.text(this.label||"")}},{key:"setDetails",value:function(e){this.setProperty("details",e)}},{key:"_renderDetails",value:function(){this.$details.html(En.nl2br(this.details)).setVisible(!!this.details)}},{key:"_position",value:function(){this.$container.cssMarginLeft(-this.$container.outerWidth()/2)}},{key:"close",value:function(){this.$cancelButton&&this.session.focusManager.requestFocus(this.$cancelButton)&&(this.$cancelButton.focus(),this.$cancelButton.click())}},{key:"_onCancelClick",value:function(e){this.trigger("cancel",e)}},{key:"cancelled",value:function(){this.rendered&&(this.$label.addClass("cancelled"),this.$buttons.remove(),this.$content.addClass("no-buttons"))}}])&&no(t.prototype,n),i&&no(t,i),o}(de);var lo=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O.assertParameter("target",t),O.assertParameter("type",n),s.a.extend(this,i),this.target=t,this.type=n};function co(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=O.nvl(t,e.DEFAULT),this.languageTag=t.languageTag;var n=bn.splitLanguageTag(this.languageTag);this.language=n[0],this.country=n[1],this.displayLanguage=t.displayLanguage,this.displayCountry=t.displayCountry,this.decimalFormatPatternDefault=t.decimalFormatPatternDefault,this.decimalFormatSymbols=t.decimalFormatSymbols,this.decimalFormatPatternDefault&&this.decimalFormatSymbols&&(this.decimalFormat=new Bf(t)),this.dateFormatPatternDefault=t.dateFormatPatternDefault,this.dateFormatSymbols=t.dateFormatSymbols,this.timeFormatPatternDefault=t.timeFormatPatternDefault,this.dateFormatPatternDefault&&this.dateFormatSymbols&&(this.dateFormat=new If(t))}var t,n,i;return t=e,i=[{key:"ensure",value:function(t){return t?t instanceof e?t:new e(t):t}}],(n=null)&&co(t.prototype,n),i&&co(t,i),e}();function ho(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(fo,"DEFAULT",{languageTag:"en-US",decimalFormatPatternDefault:"#,##0.###",dateFormatPatternDefault:"MM/dd/yyyy",timeFormatPatternDefault:"h:mm a",decimalFormatSymbols:{decimalSeparator:".",groupingSeparator:",",minusSign:"-"},dateFormatSymbols:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],am:"AM",pm:"PM"}});var po=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._filterProperties={},this._propertiesFilter=this._propertiesFilter.bind(this),this.filters=[this._propertiesFilter]}var t,n,i;return t=e,(n=[{key:"addFilterForProperties",value:function(e){oi.copyProperties(e,this._filterProperties)}},{key:"addFilter",value:function(e){this.filters.push(e)}},{key:"filter",value:function(e,t){return this.filters.some((function(n){return n(e,t)}))}},{key:"addFilterForPropertyName",value:function(e){this.filters.push((function(t,n){return t===e}))}},{key:"_propertiesFilter",value:function(e,t){if(!this._filterProperties.hasOwnProperty(e))return!1;var n=this._filterProperties[e];return oi.equals(n,t)}},{key:"reset",value:function(){this._filterProperties={},this.filters=[this._propertiesFilter]}}])&&ho(t.prototype,n),i&&ho(t,i),e}();function yo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var vo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=t,this.started=!1,this.initialDelay=1e3,this.interval=3e3,this.minPingDuration=1e3}var t,n,i;return t=e,(n=[{key:"start",value:function(){this.started||(s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] start"),this.started=!0,this._schedulePing(this.initialDelay))}},{key:"stop",value:function(){this.started=!1}},{key:"_schedulePing",value:function(e){s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] schedule ping() in "+e+" ms"),setTimeout(this._ping.bind(this),e)}},{key:"_ping",value:function(){this.session.onReconnecting();var e=this.session.defaultAjaxOptions({ping:!0});s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] "+e.type+' "'+e.url+'"'),this.pingStartTimestamp=Date.now(),s.a.ajax(e).done(this._onPingDone.bind(this)).fail(this._onPingFail.bind(this))}},{key:"_onPingDone",value:function(e,t,n){s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] ping success -> connection re-established!"),this.session.onReconnectingSucceeded(),this.stop()}},{key:"_onPingFail",value:function(e,t,n){var i=function(){s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] ping failed"),this.session.onReconnectingFailed(),this._schedulePing(this.interval)}.bind(this),r=Date.now()-this.pingStartTimestamp;r<this.minPingDuration?setTimeout(i,this.minPingDuration-r):i()}}])&&yo(t.prototype,n),i&&yo(t,i),e}();function bo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var go=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=t,this.queue=[],this.lastProcessedSequenceNo=0,this.nextExpectedSequenceNo=1,this.force=!1,this.forceTimeoutId=null}var t,n,i;return t=e,(n=[{key:"add",value:function(e){var t=e&&e["#"];if(!(t&&t<=this.lastProcessedSequenceNo))if(t&&e.combined&&(this.lastProcessedSequenceNo=Math.max(t-1,this.lastProcessedSequenceNo),this.nextExpectedSequenceNo=Math.max(t,this.nextExpectedSequenceNo)),t&&0!==this.queue.length){for(var n=[],i=e,r=0;r<this.queue.length;r++){var o=this.queue[r];o["#"]&&(i&&o["#"]>t&&(n.push(e),i=null),o["#"]<=this.lastProcessedSequenceNo)||n.push(o)}i&&n.push(i),this.queue=n}else this.queue.push(e)}},{key:"process",value:function(e){e&&this.add(e);for(var t=!0,n=!1,i=[],r=0;r<this.queue.length;r++){var o=this.queue[r],s=o["#"];if(s&&(!this.nextExpectedSequenceNo||this.force||n||(n=this.nextExpectedSequenceNo!==s),n))i.push(o);else{var a=this.session.processJsonResponseInternal(o);e&&o===e&&(t=a),s&&(this.lastProcessedSequenceNo=s,this.nextExpectedSequenceNo=s+1)}}return this.queue=i,this._checkTimeout(),t}},{key:"size",value:function(){return this.queue.length}},{key:"_checkTimeout",value:function(){0===this.queue.length?(clearTimeout(this.forceTimeoutId),this.forceTimeoutId=null):this.forceTimeoutId||(this.forceTimeoutId=setTimeout(function(){try{for(var t="[",n=0;n<this.queue.length;n++)n>0&&(t+=", "),t+=En.box("#",this.queue[n]["#"])||"<none>";t+="]",this.session.sendLogRequest("Expected response #"+this.nextExpectedSequenceNo+" still missing after "+e.FORCE_TIMEOUT+" ms. Forcing response queue to process "+this.size()+" elements: "+t)}catch(e){}this.force=!0;try{this.process()}finally{this.force=!1,this.forceTimeoutId=null}}.bind(this),e.FORCE_TIMEOUT))}},{key:"prepareRequest",value:function(e){e["#ACK"]=this.lastProcessedSequenceNo}},{key:"prepareHttpRequest",value:function(e){e.headers=e.headers||{},e.headers["X-Scout-#ACK"]=this.lastProcessedSequenceNo}}])&&bo(t.prototype,n),i&&bo(t,i),e}();function mo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(go,"FORCE_TIMEOUT",1e4);var wo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$entryPoint=null,this.partId=0,this.url=new Li,this.userAgent=new ko({deviceType:Mt.get().type,touch:Mt.get().supportsOnlyTouch(),standalone:Mt.get().isStandalone()}),this.locale=null,this.textMap=new Wf,this.ready=!1,this.unloading=!1,this.unloaded=!1,this.loggedOut=!1,this.inspector=!1,this.persistent=!1,this.desktop=null,this.layoutValidator=new Yo,this.focusManager=null,this.keyStrokeManager=null,this.uiSessionId=null,this.clientSessionId=this._getClientSessionIdFromStorage(),this.forceNewClientSession=!1,this.remoteUrl="json",this.unloadUrl="unload",this.modelAdapterRegistry={},this.ajaxCalls=[],this.asyncEvents=[],this.responseQueue=new go(this),this.requestsPendingCounter=0,this.suppressErrors=!1,this.requestTimeoutCancel=5e3,this.requestTimeoutPoll=75e3,this.requestTimeoutPing=5e3,this.backgroundJobPollingSupport=new eo(!0),this.reconnector=new vo(this),this.processingEvents=!1,this.adapterExportEnabled=!1,this._adapterDataCache={},this._busy=!1,this._busyIndicator=null,this._busyIndicatorTimeoutId=null,this._deferred=null,this._fatalMessagesOnScreen={},this._retryRequest=null,this._queuedRequest=null,this.requestSequenceNo=0,this.rootAdapter=new fe,this.rootAdapter.init({session:this,id:"1",objectType:"RootAdapter"});var t=new Ee;t.session=this,t.initialized=!0,this.root=this.rootAdapter.createWidget({session:this,id:"1",objectType:"NullWidget"},t),this.events=this._createEventSupport()}var t,n,i;return t=e,(n=[{key:"init",value:function(e){var t=e||{};if(!t.$entryPoint)throw new Error("$entryPoint is not defined");this.$entryPoint=t.$entryPoint,this.partId=O.nvl(t.portletPartId,this.partId),this.forceNewClientSession=O.nvl(this.url.getParameter("forceNewClientSession"),t.forceNewClientSession),this.forceNewClientSession?this.clientSessionId=null:this.clientSessionId=O.nvl(t.clientSessionId,this.clientSessionId),this.userAgent=O.nvl(t.userAgent,this.userAgent),this.suppressErrors=O.nvl(t.suppressErrors,this.suppressErrors),t.locale&&(this.locale=fo.ensure(t.locale),this.textMap=th.get(this.locale.languageTag)),!1===t.backgroundJobPollingEnabled&&(this.backgroundJobPollingSupport.enabled=!1),s.a.extend(this.reconnector,t.reconnectorOptions),this.ajaxCallOptions=t.ajaxCallOptions,"true"!==this.url.getParameter("debug")&&"true"!==this.url.getParameter("inspector")||(this.inspector=!0),"true"===this.url.getParameter("adapterExportEnabled")&&(this.adapterExportEnabled=!0),this.focusManager=new kc({session:this,active:t.focusManagerActive}),this.keyStrokeManager=O.create("KeyStrokeManager",{session:this})}},{key:"_throwError",value:function(e){if(!this.suppressErrors)throw new Error(e)}},{key:"unregisterModelAdapter",value:function(e){delete this.modelAdapterRegistry[e.id]}},{key:"registerModelAdapter",value:function(e){if(void 0===e.id)throw new Error("modelAdapter.id must be defined");this.modelAdapterRegistry[e.id]=e}},{key:"getModelAdapter",value:function(e){return this.modelAdapterRegistry[e]}},{key:"getWidget",value:function(e){if(!e)return null;if("string"!=typeof e)throw new Error("typeof adapterId must be string");var t=this.getModelAdapter(e);return t?t.widget:null}},{key:"getOrCreateWidget",value:function(e,t,n){if(!e)return null;if("string"!=typeof e)throw new Error("typeof adapterId must be string");var i=this.getWidget(e);if(i)return i;var r=this._getAdapterData(e);if(!r){if(O.nvl(n,!0))throw new Error("no adapterData found for adapterId="+e);return null}return this.createModelAdapter(r).createWidget(r,t)}},{key:"createModelAdapter",value:function(e){var t=e.objectType,n={},i=Y.parse(t);i.modelVariant?(t=i.objectType.toString()+"Adapter"+Z.MODEL_VARIANT_SEPARATOR+i.modelVariant.toString(),n.variantLenient=!0):t=i.objectType.toString()+"Adapter";var r={id:e.id,session:this},o=O.create(t,r,n);return s.a.log.isTraceEnabled()&&s.a.log.trace("created new adapter "+o),o}},{key:"sendEvent",value:function(e,t){t=t||0,this.asyncEvents=this._coalesceEvents(this.asyncEvents,e),this.asyncEvents.push(e),this._asyncDelay=Math.min(t,O.nvl(this._asyncDelay,t)),clearTimeout(this._sendTimeoutId),this._sendTimeoutId=setTimeout(function(){this._sendTimeoutId=null,this._asyncDelay=null,this.areRequestsPending()||this._sendNow()}.bind(this),this._asyncDelay)}},{key:"_sendStartupRequest",value:function(){var e=this._newRequest({startup:!0});this.partId&&(e.partId=this.partId),this.clientSessionId&&(e.clientSessionId=this.clientSessionId),x.get().version&&(e.version=x.get().version),e.userAgent=this.userAgent,e.sessionStartupParams=this._createSessionStartupParams();var t=this.defaultAjaxOptions(e);return s.a.ajax(t).catch(function(t,n,i){this._setApplicationLoading(!1),this._processErrorResponse(t,n,i,e);var r=oi.argumentsToArray(arguments);return s.a.rejectedPromise.apply(s.a,r)}.bind(this)).then(function(e){if(this._processStartupResponse(e),e.error)return s.a.rejectedPromise(e)}.bind(this))}},{key:"_createSessionStartupParams",value:function(){var e={url:this.url.baseUrlRaw,geolocationServiceAvailable:Mt.get().supportsGeolocation()},t=this.url.parameterMap;for(var n in t)e[n]=t[n];return e}},{key:"_processStartupResponse",value:function(e){if(e.error)this._processErrorJsonResponse(e.error);else{if(Gi.removeItem(sessionStorage,"scout:versionMismatch"),!e.startupData)throw new Error("Missing startupData");if(this.persistent=e.startupData.persistent,this.clientSessionId=e.startupData.clientSessionId,this._storeClientSessionIdInStorage(this.clientSessionId),this.uiSessionId=e.startupData.uiSessionId,s()(window).on("beforeunload."+this.uiSessionId,this._onWindowBeforeUnload.bind(this)).on("unload."+this.uiSessionId,this._onWindowUnload.bind(this)),e.startupData.reloadPage)O.reloadPage();else{e.startupData.inspector&&(this.inspector=!0),this.requestTimeoutPoll=1e3*(e.startupData.pollingInterval+15),this.modelAdapterRegistry[this.uiSessionId]=this,e.adapterData&&this._copyAdapterData(e.adapterData),this.locale=new fo(e.startupData.locale),this.textMap=th.get(this.locale.languageTag),this.textMap.addAll(e.startupData.textMap);var t=this._getAdapterData(e.startupData.clientSession);this.desktop=this.getOrCreateWidget(t.desktop,this.rootAdapter.widget);var n=function(){if(this._renderDesktop(),e.events){this.processingEvents=!0;try{this._processEvents(e.events)}finally{this.processingEvents=!1}}this.layoutValidator.validate(),this.focusManager.validateFocus(),this._resumeBackgroundJobPolling(),this.ready=!0,s.a.log.isInfoEnabled()&&s.a.log.info("Session initialized. Detected "+Mt.get()),s.a.log.isDebugEnabled()&&(s.a.log.isDebugEnabled()&&s.a.log.debug("size of _adapterDataCache after session has been initialized: "+oi.countOwnProperties(this._adapterDataCache)),s.a.log.isDebugEnabled()&&s.a.log.debug("size of modelAdapterRegistry after session has been initialized: "+oi.countOwnProperties(this.modelAdapterRegistry)))}.bind(this);this.render(n)}}}},{key:"_storeClientSessionIdInStorage",value:function(e){Gi.removeItem(sessionStorage,"scout:clientSessionId"),Gi.removeItem(localStorage,"scout:clientSessionId");var t=sessionStorage;this.persistent&&(t=localStorage),Gi.setItem(t,"scout:clientSessionId",e)}},{key:"_getClientSessionIdFromStorage",value:function(){var e=Gi.getItem(sessionStorage,"scout:clientSessionId");return e||(e=Gi.getItem(localStorage,"scout:clientSessionId")),e}},{key:"render",value:function(e){nn.loadingComplete?e():nn.preloader().then(e)}},{key:"_sendUnloadRequest",value:function(){var e=this._newRequest({unload:!0,showBusyIndicator:!1});this._sendRequest(e)}},{key:"_sendNow",value:function(){if(0!==this.asyncEvents.length){var e=[];this.asyncEvents.some((function(t,n){return!!(t.newRequest&&e.length>0)||(e.push(t),!1)}));var t=this._newRequest({events:e});t.showBusyIndicator=t.events.some((function(e){return O.nvl(e.showBusyIndicator,!0)})),this.responseQueue.prepareRequest(t),this._sendRequest(t),this.asyncEvents=this.asyncEvents.slice(e.length)}}},{key:"_coalesceEvents",value:function(e,t){if(!t.coalesce)return e;var n=s.a.negate(t.coalesce).bind(t);return e.filter(n)}},{key:"_sendRequest",value:function(e){if(e)if(!this.offline||e.unload)if(e.unload&&navigator.sendBeacon)navigator.sendBeacon(this.unloadUrl+"/"+this.uiSessionId,"");else{var t=this.defaultAjaxOptions(e),n=O.nvl(e.showBusyIndicator,!0);e.unload&&(t.async=!1),this._performUserAjaxRequest(t,n,e)}else this._handleSendWhenOffline(e)}},{key:"_handleSendWhenOffline",value:function(e){e.events&&(this._queuedRequest?this._queuedRequest.events?(e.events.forEach(function(e){this._queuedRequest.events=this._coalesceEvents(this._queuedRequest.events,e)}.bind(this)),this._queuedRequest.events=this._queuedRequest.events.concat(e.events)):this._queuedRequest.events=e.events:this._queuedRequest=e,this.layoutValidator.validate())}},{key:"defaultAjaxOptions",value:function(e){e=e||this._newRequest();var t={type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",cache:!1,url:this._decorateUrl(this.remoteUrl,e),data:this._requestToJson(e),timeout:0};return e.cancel&&(t.timeout=this.requestTimeoutCancel),e.ping&&(t.timeout=this.requestTimeoutPing),e.pollForBackgroundJobs&&(t.timeout=this.requestTimeoutPoll),t}},{key:"_decorateUrl",value:function(e,t){var n=null;return t.unload?n="unload":t.pollForBackgroundJobs?n="poll":t.ping?n="ping":t.cancel?n="cancel":t.log?n="log":t.syncResponseQueue&&(n="sync"),n&&(e=new Li(e).addParameter(n).toString()),e}},{key:"_getRequestName",value:function(e,t){if(e){if(e.unload)return"unload";if(e.pollForBackgroundJobs)return"pollForBackgroundJobs";if(e.ping)return"ping";if(e.cancel)return"cancel";if(e.log)return"log";if(e.syncResponseQueue)return"syncResponseQueue"}return t}},{key:"_requestToJson",value:function(e){return JSON.stringify(e,(function(t,n){return this===e&&"showBusyIndicator"===t||this instanceof lo&&O.isOneOf(t,"showBusyIndicator","coalesce","newRequest")?void 0:n}))}},{key:"_callAjax",value:function(e){var t=O.create("AjaxCall",s.a.extend({retryIntervals:[100,500,500,500]},e,this.ajaxCallOptions),{ensureUniqueId:!1});return this.registerAjaxCall(t),t.call().always(this.unregisterAjaxCall.bind(this,t))}},{key:"_performUserAjaxRequest",value:function(e,t,n){t&&this.setBusy(!0),this.setRequestPending(!0);var i=null,r=!1;this._callAjax({ajaxOptions:e,request:n,name:this._getRequestName(n,"user request")}).done(function(e){try{t&&!this.areBusyIndicatedEventsQueued()&&this.setBusy(!1),r=this.responseQueue.process(e)}catch(e){i=i||e}}.bind(this)).fail(function(e){try{t&&this.setBusy(!1),this._processErrorResponse(e.jqXHR,e.textStatus,e.errorThrown,n)}catch(e){i=i||e}}.bind(this)).always(function(e,t,n){if(this.setRequestPending(!1),r){if(this._resumeBackgroundJobPolling(),this._fireRequestFinished(e),this._retryRequest){var o=this._retryRequest;this._retryRequest=null,this.responseQueue.prepareRequest(o),this._sendRequest(o)}else if(this._queuedRequest){var s=this._queuedRequest;this._queuedRequest=null,this.responseQueue.prepareRequest(s),this._sendRequest(s)}this._sendTimeoutId||this._sendNow()}if(this.layoutValidator.validate(),i)throw i}.bind(this))}},{key:"registerAjaxCall",value:function(e){this.ajaxCalls.push(e)}},{key:"unregisterAjaxCall",value:function(e){et.remove(this.ajaxCalls,e)}},{key:"interruptAllAjaxCalls",value:function(){this.ajaxCalls.slice().forEach((function(e){e.pendingCall&&e.pendingCall.abort()}))}},{key:"abortAllAjaxCalls",value:function(){this.ajaxCalls.slice().forEach((function(e){e.abort()}))}},{key:"_resumeBackgroundJobPolling",value:function(){this.backgroundJobPollingSupport.enabled&&this.backgroundJobPollingSupport.status!==Zr.RUNNING&&(s.a.log.isInfoEnabled()&&s.a.log.info("Resume background jobs polling request, status was="+this.backgroundJobPollingSupport.status),this._pollForBackgroundJobs())}},{key:"_pollForBackgroundJobs",value:function(){this.backgroundJobPollingSupport.setRunning();var e=this._newRequest({pollForBackgroundJobs:!0});this.responseQueue.prepareRequest(e);var t=this.defaultAjaxOptions(e);this._callAjax({ajaxOptions:t,request:e,name:this._getRequestName(e,"request")}).done(function(e){if(e.error)s.a.log.warn("Polling request failed. Interrupt polling until the next user-initiated request succeeds"),this.backgroundJobPollingSupport.setFailed(),this.areRequestsPending()?this.responseQueue.add(e):this.responseQueue.process(e);else if(e.sessionTerminated)s.a.log.info("Session terminated, stopped polling for background jobs"),this.backgroundJobPollingSupport.setStopped(),!this.loggedOut&&e.redirectUrl&&this.logout(e.redirectUrl);else try{this.areRequestsPending()?this.responseQueue.add(e):(this.responseQueue.process(e),this.layoutValidator.validate()),setTimeout(this._pollForBackgroundJobs.bind(this))}catch(e){throw this.backgroundJobPollingSupport.setFailed(),e}}.bind(this)).fail(function(t){this.backgroundJobPollingSupport.setFailed(),this._processErrorResponse(t.jqXHR,t.textStatus,t.errorThrown,e)}.bind(this))}},{key:"processJsonResponseInternal",value:function(e){var t=!1;return e.error?this._processErrorJsonResponse(e.error):(this._processSuccessResponse(e),t=!0),t}},{key:"_processSuccessResponse",value:function(e){if(e.adapterData&&this._copyAdapterData(e.adapterData),e.events){this.processingEvents=!0;try{this._processEvents(e.events)}finally{this.processingEvents=!1}}if(s.a.log.isDebugEnabled()){var t=oi.countOwnProperties(this._adapterDataCache);s.a.log.trace("size of _adapterDataCache after response has been processed: "+t),t=oi.countOwnProperties(this.modelAdapterRegistry),s.a.log.trace("size of modelAdapterRegistry after response has been processed: "+t)}}},{key:"_copyAdapterData",value:function(e){var t,n=0;for(t in e)this._adapterDataCache[t]=e[t],n++;n>0&&s.a.log.isTraceEnabled()&&s.a.log.trace("Stored "+n+" properties in adapterDataCache")}},{key:"_processErrorResponse",value:function(e,t,n,i){if(s.a.log.error("errorResponse: status="+e.status+", textStatus="+t+", errorThrown="+n),or.isOfflineError(e,t,n,i)){if(this.ready)return this.goOffline(),void(!i||i.pollForBackgroundJobs||this._retryRequest||(this._retryRequest=i));n=n||this.optText("ui.ConnectionInterrupted","Connection interrupted")}var r={header:this.optText("ui.NetworkError","Network error"),body:En.join(" ",e.status||"",n),yesButtonText:this.optText("ui.Reload","Reload"),yesButtonAction:function(){O.reloadPage()},noButtonText:this.ready?this.optText("ui.Ignore","Ignore"):null};this.showFatalMessage(r,e.status+".net")}},{key:"_processErrorJsonResponse",value:function(t){if(t.code===e.JsonResponseError.VERSION_MISMATCH){if(!Gi.getItem(sessionStorage,"scout:versionMismatch"))return Gi.setItem(sessionStorage,"scout:versionMismatch","yes"),void O.reloadPage();Gi.removeItem(sessionStorage,"scout:versionMismatch")}var n={header:this.optText("ui.ServerError","Server error")+" ("+this.optText("ui.ErrorCodeX","Code "+t.code,t.code)+")",body:t.message,yesButtonText:this.optText("ui.Reload","Reload"),yesButtonAction:function(){O.reloadPage()}};t.code===e.JsonResponseError.STARTUP_FAILED?(n.header=t.message,n.body=null,n.yesButtonText="Retry"):t.code===e.JsonResponseError.SESSION_TIMEOUT?(n.header=this.optText("ui.SessionTimeout",n.header),n.body=this.optText("ui.SessionExpiredMsg",n.body)):t.code===e.JsonResponseError.UI_PROCESSING?(n.header=this.optText("ui.UnexpectedProblem",n.header),n.body=En.join("\n\n",this.optText("ui.InternalProcessingErrorMsg",n.body," ("+this.optText("ui.ErrorCodeX","Code 20","20")+")"),this.optText("ui.UiInconsistentMsg","")),n.noButtonText=this.optText("ui.Ignore","Ignore")):t.code===e.JsonResponseError.UNSAFE_UPLOAD&&(n.header=this.optText("ui.UnsafeUpload",n.header),n.body=this.optText("ui.UnsafeUploadMsg",n.body),n.yesButtonText=this.optText("ui.Ok","Ok"),n.yesButtonAction=function(){}),this.showFatalMessage(n,t.code)}},{key:"_fireRequestFinished",value:function(e){if(this._deferred){if(e.events)for(var t=0;t<e.events.length;t++)this._deferredEventTypes.push(e.events[t].type);0===this.requestsPendingCounter&&(this._deferred.resolve(this._deferredEventTypes),this._deferred=null,this._deferredEventTypes=null)}}},{key:"showFatalMessage",value:function(e,t){if(t){if(this._fatalMessagesOnScreen[t])return;this._fatalMessagesOnScreen[t]=!0}this._setApplicationLoading(!1),e=e||{};var n={session:this,parent:this.desktop||new Ee,iconId:e.iconId,severity:O.nvl(e.severity,pi.Severity.ERROR),header:e.header,body:e.body,hiddenText:e.hiddenText,yesButtonText:e.yesButtonText,noButtonText:e.noButtonText,cancelButtonText:e.cancelButtonText},i=O.create("MessageBox",n),r=e.entryPoint||this.$entryPoint;i.on("action",function(n){delete this._fatalMessagesOnScreen[t],i.destroy();var r=n.option;"yes"===r&&e.yesButtonAction?e.yesButtonAction.apply(this):"no"===r&&e.noButtonAction?e.noButtonAction.apply(this):"cancel"===r&&e.cancelButtonAction&&e.cancelButtonAction.apply(this)}.bind(this)),i.render(r)}},{key:"uploadFiles",value:function(t,n,i,r,o){var a=new FormData,u=0;if(i&&s.a.each(i,(function(e,t){a.append(e,t)})),s.a.each(n,(function(t,n){if(!o||0===o.length||O.isOneOf(n.type,o)){u+=n.size;var i=O.nvl(n.scoutName,n.name,e.EMPTY_UPLOAD_FILENAME);a.append("files",n,i)}})),r=O.nvl(r,LS.DEFAULT_MAXIMUM_UPLOAD_SIZE),u>r){var l={header:this.text("ui.FileSizeLimitTitle"),body:this.text("ui.FileSizeLimit",r/1024/1024),yesButtonText:this.optText("Ok","Ok")};return this.showFatalMessage(l),!1}var c={type:"POST",url:"upload/"+this.uiSessionId+"/"+t.id,cache:!1,processData:!1,contentType:!1,data:a};a.polyfill&&a.applyToAjaxOptions(c),this.responseQueue.prepareHttpRequest(c);var f=!this.areRequestsPending();return this._performUserAjaxRequest(c,f),!0}},{key:"goOffline",value:function(){this.offline||(this.offline=!0,this.abortAllAjaxCalls(),setTimeout(function(){this.unloading||this.unloaded||(this.rootAdapter.goOffline(),this.reconnector.start())}.bind(this),100))}},{key:"goOnline",value:function(){this.offline=!1,this.rootAdapter.goOnline();var e=this._newRequest({syncResponseQueue:!0});this.responseQueue.prepareRequest(e),this._sendRequest(e)}},{key:"onReconnecting",value:function(){this.desktop&&this.desktop.onReconnecting()}},{key:"onReconnectingSucceeded",value:function(){this.desktop&&this.desktop.onReconnectingSucceeded(),this.goOnline()}},{key:"onReconnectingFailed",value:function(){this.desktop&&this.desktop.onReconnectingFailed()}},{key:"listen",value:function(){return this._deferred||(this._deferred=s.a.Deferred(),this._deferredEventTypes=[]),this._deferred}},{key:"onRequestsDone",value:function(e){var t=Array.prototype.slice.call(arguments).slice();function n(){e.apply(this,t)}t.shift(),this.areRequestsPending()||this.areEventsQueued()?this.listen().done(n):e.apply(this,t)}},{key:"onEventsProcessed",value:function(e){var t=Array.prototype.slice.call(arguments).slice();function n(){e.apply(this,t)}t.shift(),this.processingEvents?this.one("eventsProcessed",n):n()}},{key:"areEventsQueued",value:function(){return this.asyncEvents.length>0}},{key:"areBusyIndicatedEventsQueued",value:function(){return this.asyncEvents.some((function(e){return O.nvl(e.showBusyIndicator,!0)}))}},{key:"areResponsesQueued",value:function(){return this.responseQueue.size()>0}},{key:"areRequestsPending",value:function(){return this.requestsPendingCounter>0}},{key:"setRequestPending",value:function(e){e?this.requestsPendingCounter++:this.requestsPendingCounter--,this.inspector&&this.$entryPoint.toggleAttr("data-request-pending",e,"true")}},{key:"setBusy",value:function(e){e?(this._busy||this._renderBusy(),this._busy=!0):(this._busy&&this._removeBusy(),this._busy=!1)}},{key:"_renderBusy",value:function(){null!==this._busyIndicatorTimeoutId&&void 0!==this._busyIndicatorTimeoutId||(this._busyIndicatorTimeoutId=setTimeout(function(){this._busyIndicator||this.desktop&&this.desktop.rendered&&(this._busyIndicator=O.create("BusyIndicator",{parent:this.desktop}),this._busyIndicator.on("cancel",this._onCancelProcessing.bind(this)),this._busyIndicator.render(this.$entryPoint))}.bind(this),500))}},{key:"_removeBusy",value:function(){clearTimeout(this._busyIndicatorTimeoutId),this._busyIndicatorTimeoutId=null,this._busyIndicator&&(this._busyIndicator.destroy(),this._busyIndicator=null)}},{key:"_onCancelProcessing",value:function(e){var t=this._busyIndicator;t&&(t.off("cancel"),setTimeout((function(){t.cancelled()}),100),this._sendCancelRequest())}},{key:"_sendCancelRequest",value:function(){var e=this._newRequest({cancel:!0,showBusyIndicator:!1});this._sendRequest(e)}},{key:"sendLogRequest",value:function(e){var t=this._newRequest({log:!0,message:e});this.currentEvent&&(t.event={target:this.currentEvent.target,type:this.currentEvent.type}),s.a.ajax(this.defaultAjaxOptions(t))}},{key:"_newRequest",value:function(e){var t=s.a.extend({uiSessionId:this.uiSessionId},e);return t.log||t.syncResponseQueue||(t["#"]=this.requestSequenceNo++),t}},{key:"_setApplicationLoading",value:function(e){e?this._applicationLoadingTimeoutId=setTimeout(function(){this.desktop&&this.desktop.rendered||this._renderApplicationLoading()}.bind(this),200):(clearTimeout(this._applicationLoadingTimeoutId),this._applicationLoadingTimeoutId=null,this._removeApplicationLoading())}},{key:"_renderApplicationLoading",value:function(){var e=s()("body").appendDiv("application-loading-root").addClass("application-loading-root").fadeIn();e.appendDiv("application-loading01").hide().fadeIn(),e.appendDiv("application-loading02").hide().fadeIn()}},{key:"_removeApplicationLoading",value:function(){var e=s()("body").children(".application-loading-root");e.addClass("application-loading-root-fadeout"),Mt.get().supportsCssAnimation()?e.oneAnimationEnd((function(){e.remove()})):e.remove()}},{key:"_processEvents",value:function(e){for(var t=0;t<e.length;){var n=e[t];this.currentEvent=n;var i=this.getModelAdapter(n.target);i?(e.splice(t,1),t=0,s.a.log.isDebugEnabled()&&s.a.log.debug("Processing event '"+n.type+"' for adapter with ID "+n.target),i.onModelEvent(n),i.resetEventFilters()):(s.a.log.isDebugEnabled()&&s.a.log.debug("Postponing '"+n.type+"' for adapter with ID "+n.target),t++)}if(this.currentEvent=null,e.length)throw new Error("Could not resolve event targets: ["+e.map((function(e){var t="target: "+e.target+", type: "+e.type;return e.properties&&(t+=", properties: "+Object.keys(e.properties)),'"'+t+'"'}),this).join(", ")+"]");this.trigger("eventsProcessed")}},{key:"start",value:function(){return s.a.log.isInfoEnabled()&&s.a.log.info("Session starting..."),this._setApplicationLoading(!0),this._sendStartupRequest()}},{key:"onModelEvent",value:function(e){"localeChanged"===e.type?this._onLocaleChanged(e):"logout"===e.type?this._onLogout(e):"disposeAdapter"===e.type?this._onDisposeAdapter(e):"reloadPage"===e.type?this._onReloadPage(e):s.a.log.warn('Model action "'+e.type+'" is not supported by UI session')}},{key:"resetEventFilters",value:function(){}},{key:"_onLocaleChanged",value:function(e){var t=new fo(e.locale),n=new Wf(e.textMap);this.switchLocale(t,n)}},{key:"switchLocale",value:function(e,t){O.assertParameter("locale",e,fo),this.locale=e,this.textMap=th.get(e.languageTag),t&&oi.copyOwnProperties(t,this.textMap),this.trigger("localeSwitch",{locale:this.locale})}},{key:"_renderDesktop",value:function(){this.desktop.render(this.$entryPoint),this.desktop.invalidateLayoutTree(!1),this._setApplicationLoading(!1)}},{key:"_onLogout",value:function(e){this.logout(e.redirectUrl)}},{key:"logout",value:function(e){if(this.loggedOut=!0,this.forceNewClientSession)this.desktop.$container.window(!0).close();else{var t=new Li;t.removeParameter("dl"),t.removeParameter("i"),Gi.setItem(sessionStorage,"scout:loginUrl",t.toString()),setTimeout((function(){O.reloadPage({redirectUrl:e})}))}}},{key:"_onDisposeAdapter",value:function(e){var t=this.getModelAdapter(e.adapter);t&&t.destroy()}},{key:"_onReloadPage",value:function(e){O.reloadPage({clearBody:!1})}},{key:"_onWindowBeforeUnload",value:function(){s.a.log.isInfoEnabled()&&s.a.log.info("Session before unloading..."),this.unloading=!0,setTimeout(function(){this.unloading=!1}.bind(this),200)}},{key:"_onWindowUnload",value:function(){s.a.log.isInfoEnabled()&&s.a.log.info("Session unloading..."),this.unloaded=!0,this.desktop&&this.desktop.formController&&this.desktop.formController.closePopupWindows(),this.loggedOut||this._sendUnloadRequest(),this.loggedOut&&this.persistent&&Gi.removeItem(localStorage,"scout:clientSessionId")}},{key:"_getAdapterData",value:function(e){var t=this._adapterDataCache[e];return!this.adapterExportEnabled&&delete this._adapterDataCache[e],t}},{key:"getAdapterData",value:function(e){return this._adapterDataCache[e]}},{key:"text",value:function(e){var t;return(t=this.textMap).get.apply(t,arguments)}},{key:"optText",value:function(e,t){var n;return(n=this.textMap).optGet.apply(n,arguments)}},{key:"textExists",value:function(e){return this.textMap.exists(e)}},{key:"_createEventSupport",value:function(){return new Yt}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}},{key:"when",value:function(e){return this.events.when(e)}}])&&mo(t.prototype,n),i&&mo(t,i),e}();_o(wo,"JsonResponseError",{STARTUP_FAILED:5,SESSION_TIMEOUT:10,UI_PROCESSING:20,UNSAFE_UPLOAD:30,VERSION_MISMATCH:40}),_o(wo,"EMPTY_UPLOAD_FILENAME","*empty*");var ko=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t=t||{}).deviceType)throw new Error("deviceType needs to be defined");this.deviceType=t.deviceType,this.touch=O.nvl(t.touch,!1),this.standalone=O.nvl(t.standalone,!1)};function So(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Oo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filters=[]}var t,n,i;return t=e,(n=[{key:"addFilter",value:function(e){this.filters.push(e)}},{key:"addFilterForEventType",value:function(e){this.filters.push((function(t){return t.type===e}))}},{key:"filter",value:function(e){return this.filters.some((function(t){return t(e)}))}},{key:"reset",value:function(){this.filters=[]}}])&&So(t.prototype,n),i&&So(t,i),e}();function To(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Co=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof e?(this.width=t.width,this.height=t.height):(this.width=t||0,this.height=n||0)}var t,n,i;return t=e,(n=[{key:"toString",value:function(){return"Dimension[width="+this.width+" height="+this.height+"]"}},{key:"equals",value:function(e){return!!e&&this.width===e.width&&this.height===e.height}},{key:"clone",value:function(){return new e(this.width,this.height)}},{key:"subtract",value:function(t){return new e(this.width-t.horizontal(),this.height-t.vertical())}},{key:"add",value:function(t){return new e(this.width+t.horizontal(),this.height+t.vertical())}},{key:"floor",value:function(){return new e(Math.floor(this.width),Math.floor(this.height))}},{key:"ceil",value:function(){return new e(Math.ceil(this.width),Math.ceil(this.height))}}])&&To(t.prototype,n),i&&To(t,i),e}();function Po(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ro=function(){function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof e?(this.top=t.top,this.right=t.right,this.bottom=t.bottom,this.left=t.left):(this.top=t||0,this.right=n||0,this.bottom=i||0,this.left=r||0)}var t,n,i;return t=e,(n=[{key:"toString",value:function(){return"Insets[top="+this.top+" right="+this.right+" bottom="+this.bottom+" left="+this.left+"]"}},{key:"equals",value:function(e){return this.top===e.top&&this.right===e.right&&this.bottom===e.bottom&&this.left===e.left}},{key:"clone",value:function(){return new e(this.top,this.right,this.bottom,this.left)}},{key:"horizontal",value:function(){return this.right+this.left}},{key:"vertical",value:function(){return this.top+this.bottom}},{key:"floor",value:function(){return new e(Math.floor(this.top),Math.floor(this.right),Math.floor(this.bottom),Math.floor(this.left))}},{key:"ceil",value:function(){return new e(Math.ceil(this.top),Math.ceil(this.right),Math.ceil(this.bottom),Math.ceil(this.left))}}])&&Po(t.prototype,n),i&&Po(t,i),e}();function xo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Eo=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof e?(this.x=t.x,this.y=t.y):(this.x=t||0,this.y=n||0)}var t,n,i;return t=e,(n=[{key:"toString",value:function(){return"Point[x="+this.x+" y="+this.y+"]"}},{key:"equals",value:function(e){return!!e&&this.x===e.x&&this.y===e.y}},{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"subtract",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"floor",value:function(){return new e(Math.floor(this.x),Math.floor(this.y))}},{key:"ceil",value:function(){return new e(Math.ceil(this.x),Math.ceil(this.y))}}])&&xo(t.prototype,n),i&&xo(t,i),e}();function Do(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Fo=function(){function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof e?(this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height):(this.x=t||0,this.y=n||0,this.width=i||0,this.height=r||0)}var t,n,i;return t=e,(n=[{key:"toString",value:function(){return"Rectangle[x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"}},{key:"equals",value:function(e){return!!e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}},{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height)}},{key:"center",value:function(){return new Eo(this.x+this.width/2,this.y+this.height/2)}},{key:"right",value:function(){return this.x+this.width}},{key:"bottom",value:function(){return this.y+this.height}},{key:"contains",value:function(e,t){return t>=this.y&&t<this.y+this.height&&e>=this.x&&e<this.x+this.width}},{key:"intersects",value:function(e){return!!e&&e.width>0&&e.height>0&&this.width>0&&this.height>0&&e.x<this.right()&&e.right()>this.x&&e.y<this.bottom()&&e.bottom()>this.y}},{key:"subtract",value:function(t){return new e(this.x+t.left,this.y+t.top,this.width-t.horizontal(),this.height-t.vertical())}},{key:"subtractFromDimension",value:function(e){return new scout.Rectangle(this.x,this.y,this.width-e.horizontal(),this.height-e.vertical())}},{key:"translate",value:function(t,n){return new e(this.x+t,this.y+n,this.width,this.height)}},{key:"point",value:function(){return new Eo(this.x,this.y)}},{key:"dimension",value:function(){return new Co(this.width,this.height)}},{key:"union",value:function(t){var n=this.width,i=this.height;if(n<0||i<0)return new e(t.x,t.y,t.width,t.height);var r=t.width,o=t.height;if(r<0||o<0)return new e(this.x,this.y,this.width,this.height);var s=this.x,a=this.y;n+=s,i+=a;var u=t.x,l=t.y;return s>u&&(s=u),a>l&&(a=l),n<(r+=u)&&(n=r),i<(o+=l)&&(i=o),i-=a,(n-=s)>Number.MAX_VALUE&&(n=Number.MAX_VALUE),i>Number.MAX_VALUE&&(i=Number.MAX_VALUE),new e(s,a,n,i)}},{key:"floor",value:function(){return new e(Math.floor(this.x),Math.floor(this.y),Math.floor(this.width),Math.floor(this.height))}},{key:"ceil",value:function(){return new e(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.width),Math.ceil(this.height))}}])&&Do(t.prototype,n),i&&Do(t,i),e}();function Ao(e,t){if(!e[0]||e.isDisplayNone())return new Co(0,0);t="boolean"==typeof t?{includeMargin:t}:t||{};var n={includeMargin:!1,useCssSize:!1,widthHint:void 0,heightHint:void 0,restoreScrollPositions:!0};if((t=s.a.extend({},n,t)).animateClasses&&t.animateClasses.length>0)return jo(e,t);var i=e.attr("style"),r=e.scrollLeft(),o=e.scrollTop();t.restoreScrollPositions&&wf.storeScrollPositions(e);var a={width:t.useCssSize?"":O.nvl(t.widthHint,"auto"),height:t.useCssSize?"":O.nvl(t.heightHint,"auto")};Mt.get().isInternetExplorer()&&"flex"===e.css("display")&&(a.position="fixed"),e.css(a);var u=e[0].getBoundingClientRect(),l=new Co(u.width,u.height);return t.includeMargin&&(l.width+=e.cssMarginX(),l.height+=e.cssMarginY()),e.attrOrRemove("style",i),e.scrollLeft(r),e.scrollTop(o),t.restoreScrollPositions&&wf.restoreScrollPositions(e),$o(l,t)}function $o(e,t){return O.nvl(t.exact,!1)||(e.width=Math.ceil(e.width),e.height=Math.ceil(e.height)),e}function jo(e,t){var n=et.ensure(t.animateClasses);if(n=n.filter((function(t){return e.hasClass(t)})),(t=s.a.extend({},t)).animateClasses=null,0===n.length)return Ao(e,t);n=et.format(n," ");var i=e.clone().removeClass(n).appendTo(e.parent()),r=Ao(i,t);return i.remove(),r}function Mo(e,t){if(!e[0]||e.isDisplayNone())return new Co(0,0);t="boolean"==typeof t?{includeMargin:t}:t||{};var n=e[0].getBoundingClientRect(),i=new Co(n.width,n.height);return O.nvl(t.includeMargin,!1)&&(i.width+=e.cssMarginX(),i.height+=e.cssMarginY()),O.nvl(t.exact,!1)||(i.width=Math.ceil(i.width),i.height=Math.ceil(i.height)),i}function Io(e,t){t="boolean"==typeof t?{includeMargin:t}:t||{};var n,i=["top","right","bottom","left"],r=[0,0,0,0],o=O.nvl(t.includeMargin,!1),s=O.nvl(t.includePadding,!0),a=O.nvl(t.includeBorder,!0);for(n=0;n<i.length;n++)o&&(r[n]+=e.cssPxValue("margin-"+i[n])),s&&(r[n]+=e.cssPxValue("padding-"+i[n])),a&&(r[n]+=e.cssPxValue("border-"+i[n]+"-width"));return new Ro(r[0],r[1],r[2],r[3])}function Lo(e,t,n){var i=Mo(e,n);return new Fo(t.left,t.top,i.width,i.height)}var Bo,No={borders:function(e){return Io(e,{includeMargin:!1,includePadding:!1,includeBorder:!0})},bounds:function(e,t){return Lo(e,e.position(),t)},cssBounds:function(e){return new Fo(e.cssLeft(),e.cssTop(),e.cssWidth(),e.cssHeight())},cssMaxSize:function(e){return new Co(e.cssMaxWidth(),e.cssMaxHeight())},cssMinSize:function(e){return new Co(e.cssMinWidth(),e.cssMinHeight())},cssSize:function(e){return new Co(e.cssWidth(),e.cssHeight())},debugOutput:function(e){if(!e)return"$comp is undefined";if(0===(e=s.a.ensure(e)).length)return"$comp doesn\t match any elements";var t="";if(e.attr("id")&&(t+="id="+e.attr("id")),e.attr("class")&&(t+=" class="+e.attr("class")),e.attr("data-modelclass")&&(t+=" data-modelclass="+e.attr("data-modelclass")),0===t.length){var n=O.nvl(e.html(),"");n.length>30&&(n=n.substring(0,30)+"..."),t=n}return e.isAttached()||(t+=" attached=false"),"Element["+t.trim()+"]"},exactPrefSize:$o,insets:Io,location:function(e){return new Eo(e.cssLeft(),e.cssTop())},margins:function(e){return Io(e,{includeMargin:!0,includePadding:!1,includeBorder:!1})},offset:function(e){var t=e.offset();return new Eo(t.left,t.top)},offsetBounds:function(e,t){return Lo(e,e.offset(),t)},paddings:function(e){return Io(e,{includeMargin:!1,includePadding:!0,includeBorder:!1})},position:function(e){var t=e.position();return new Eo(t.left,t.top)},prefSize:Ao,prefSizeWithoutAnimation:jo,setBounds:function(e,t,n,i,r){var o=t instanceof Fo?t:new Fo(t,n,i,r);e.cssLeft(o.x).cssTop(o.y).cssWidth(o.width).cssHeight(o.height)},setLocation:function(e,t,n){var i=t instanceof Eo?t:new Eo(t,n);e.cssLeft(i.x).cssTop(i.y)},setMargins:function(e,t){e.css({marginLeft:t.left,marginRight:t.right,marginTop:t.top,marginBottom:t.bottom})},setSize:function(e,t,n){var i=t instanceof Co?t:new Co(t,n);e.cssWidth(i.width).cssHeight(i.height)},size:Mo};function Ho(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Vo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formRowHeight=30,this.formRowGap=10,this.formColumnWidth=420,this.formColumnGap=32,this.smallColumnGap=4,this.fieldLabelWidth=140,this.fieldMandatoryIndicatorWidth=8,this.fieldStatusWidth=20,this.events=new Yt}var t,n,i;return t=e,i=[{key:"get",value:function(){return Bo}}],(n=[{key:"init",value:function(e){this.formRowHeight=$i.getSize("html-env-logical-grid-row","height","height",this.formRowHeight,e),this.formRowGap=$i.getSize("html-env-logical-grid-row","margin-bottom","marginBottom",this.formRowGap,e),this.formColumnWidth=$i.getSize("html-env-logical-grid-column","width","width",this.formColumnWidth,e),this.formColumnGap=$i.getSize("html-env-logical-grid-column","margin-right","marginRight",this.formColumnGap,e),this.smallColumnGap=$i.getSize("html-env-logical-grid-column","margin-left","marginLeft",this.smallColumnGap,e),this.fieldLabelWidth=$i.getSize("html-env-field-label","width","width",this.fieldLabelWidth,e),this.fieldMandatoryIndicatorWidth=$i.getSize("html-env-field-mandatory-indicator","width","width",this.fieldMandatoryIndicatorWidth,e),this.fieldStatusWidth=$i.getSize("html-env-field-status","width","width",this.fieldStatusWidth,e);var t={source:this};this.events.trigger("propertyChange",t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){return this.events.off(e,t)}}])&&Ho(t.prototype,n),i&&Ho(t,i),e}();function Wo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}x.addListener("prepare",(function(){Bo||(Bo=O.create("HtmlEnvironment")).init()}));var zo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.animateClasses=[]}var t,n,i;return t=e,(n=[{key:"invalidate",value:function(){}},{key:"layout",value:function(e){}},{key:"_revertSizeHintsAdjustments",value:function(e,t){var n=Uo.get(e);t.widthHint&&(t.widthHint+=n.insets().horizontal()),t.heightHint&&(t.heightHint+=n.insets().vertical())}},{key:"preferredLayoutSize",value:function(e,t){return t=s.a.extend({},t),this.animateClasses.length>0&&(t.animateClasses=this.animateClasses),this._revertSizeHintsAdjustments(e,t),No.prefSize(e,t)}}])&&Wo(t.prototype,n),i&&Wo(t,i),e}();function Go(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Uo=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!n)throw new Error("session must be defined for "+this.debug());this.$comp=t,this.layout=new ya,this.layoutData=null,this.valid=!1,this.validateRoot=!1,this.layouted=!1,this.layouting=!1,this.suppressInvalidate=!1,this.pixelBasedSizing=!0,this.sizeCached=null,this.prefSizeCached={},this.session=n,this.scrollable=!1}var t,n,i;return t=e,i=[{key:"install",value:function(t,n){if(!t)throw new Error('Missing argument "$comp"');if(!n)throw new Error('Missing argument "session"');var i=new e(t,n);return t.data("htmlComponent",i),i}},{key:"get",value:function(e){var t=this.optGet(e);if(!t){var n="";throw e&&(n="\nClass: "+e.attr("class"),n+="\nId: "+e.attr("id"),n+="\nAttached: "+e.isAttached()),new Error('data "htmlComponent" is undefined.'+n)}return t}},{key:"optGet",value:function(e){return e&&e.data("htmlComponent")}}],(n=[{key:"getParent",value:function(){var t=this.$comp.parent();return 0===t.length?null:e.optGet(t)}},{key:"isDescendantOf",value:function(t){for(var n=this.$comp.parent();n.length>0;){if(e.optGet(n)===t)return!0;n=n.parent()}return!1}},{key:"availableSize",value:function(e){e=e||{};var t=this.size({exact:e.exact});if(this.scrollable){var n=this.prefSize({widthHint:t.width,removeMarginFromHints:!1});n.height>t.height&&(t.height=n.height)}return t}},{key:"invalidateLayout",value:function(e){this.valid=!1,this.prefSizeCached={},this.layout&&this.layout.invalidate(e)}},{key:"validateLayout",value:function(){if(!this.layout)throw new Error("Called layout() but component has no layout");if(!this.valid){if(!this._checkValidationPossible())return!1;this.layouting=!0,this.layout.layout(this.$comp),this.layouting=!1,this.layouted=!0,this.sizeCached=this.size({exact:!0}),this.valid=!0}return!0}},{key:"_checkValidationPossible",value:function(){if(!this.isAttachedAndVisible())return!1;if(this.$comp.hasAnimationClass())return this._validateLayoutAfterAnimation(this.$comp),!1;var e=this.getParent();if(!e||!e.layouting){var t=!0,n=null;if(this.$comp.parents().each((function(){var e=s()(this);return e.isVisible()?!e.hasAnimationClass()||(n=e,!1):(t=!1,!1)})),!t)return!1;if(n)return this._validateLayoutAfterAnimation(n),!1}return!0}},{key:"_validateLayoutAfterAnimation",value:function(e){e.oneAnimationEnd(this.validateLayout.bind(this))}},{key:"revalidateLayout",value:function(){this.invalidateLayout(),this.validateLayout()}},{key:"invalidateLayoutTree",value:function(e){this.suppressInvalidate||(O.nvl(e,!0)?this.session.layoutValidator.invalidateTree(this):(this.invalidateLayout(),this.session.layoutValidator.invalidate(this)))}},{key:"validateLayoutTree",value:function(){this.session.layoutValidator.validate()}},{key:"revalidateLayoutTree",value:function(e){this.suppressInvalidate||(this.invalidateLayoutTree(e),this.validateLayoutTree())}},{key:"isValidateRoot",value:function(){return!!this.validateRoot||!(!this.layoutData||!this.layoutData.isValidateRoot)&&this.layoutData.isValidateRoot()}},{key:"setLayout",value:function(e){this.layout=e,e.cssClass&&this.$comp.addClass(e.cssClass)}},{key:"prefSize",value:function(e){if(!this.isVisible())return new Co(0,0);e="boolean"==typeof e?{includeMargin:e}:s.a.extend({},e);var t=O.nvl(e.includeMargin,!1);if(e.includeMargin=null,!this.layout)throw new Error("Called prefSize() but component has no layout");var n=this.computePrefSizeKey(e),i=this.prefSizeCached[n];if(!s.a.isEmptyObject(i))return s.a.log.isTraceEnabled()&&s.a.log.trace("(HtmlComponent#prefSize) "+this.debug()+" widthHint="+e.widthHint+" heightHint="+e.heightHint+" prefSizeCached="+i),t&&(i=i.add(this.margins())),i.clone();var r=No.cssMinSize(this.$comp),o=No.cssMaxSize(this.$comp);(e.widthHint||e.heightHint)&&this._adjustSizeHintsForPrefSize(e,r,o);var a=this.layout.preferredLayoutSize(this.$comp,e);return this._adjustPrefSizeWithMinMaxSize(a,r,o),this.prefSizeCached[n]=a,s.a.log.isTraceEnabled()&&s.a.log.trace("(HtmlComponent#prefSize) "+this.debug()+" widthHint="+e.widthHint+" heightHint="+e.heightHint+" prefSize="+a),t&&(a=a.add(this.margins())),a.clone()}},{key:"computePrefSizeKey",value:function(e){return"wHint"+O.nvl(e.widthHint,"-1")+"hHint"+O.nvl(e.heightHint,"-1")+"wOnly"+O.nvl(e.widthOnly,"-1")}},{key:"_adjustSizeHintsForPrefSize",value:function(e,t,n){var i=O.nvl(e.removeMarginFromHints,!0),r=O.nvl(e.removeInsetsFromHints,!0);if(e.removeMarginFromHints=null,e.removeInsetsFromHints=null,e.widthHint||e.heightHint){var o=i?this.margins():new Ro,s=r?this.insets():new Ro;e.widthHint&&(e.widthHint-=o.horizontal(),e.widthHint=Math.max(e.widthHint,t.width),e.widthHint=Math.min(e.widthHint,n.width),e.widthHint-=s.horizontal()),e.heightHint&&(e.heightHint-=o.vertical(),e.heightHint=Math.max(e.heightHint,t.height),e.heightHint=Math.min(e.heightHint,n.height),e.heightHint-=s.vertical())}}},{key:"_adjustPrefSizeWithMinMaxSize",value:function(e,t,n){t=t||No.cssMinSize(this.$comp),n=n||No.cssMaxSize(this.$comp),e.height=Math.max(e.height,t.height),e.height=Math.min(e.height,n.height),e.width=Math.max(e.width,t.width),e.width=Math.min(e.width,n.width)}},{key:"insets",value:function(e){return No.insets(this.$comp,e)}},{key:"margins",value:function(){return No.margins(this.$comp)}},{key:"borders",value:function(){return No.borders(this.$comp)}},{key:"size",value:function(e){return No.size(this.$comp,e)}},{key:"setSize",value:function(e){if(this.isAttachedAndVisible()){var t=this.sizeCached;e.equals(t)||this.invalidateLayout(),this.pixelBasedSizing&&No.setSize(this.$comp,e),this.validateLayout()}}},{key:"bounds",value:function(e){return No.bounds(this.$comp,e)}},{key:"position",value:function(){return No.position(this.$comp)}},{key:"offsetBounds",value:function(e){return No.offsetBounds(this.$comp,e)}},{key:"offset",value:function(){return No.offset(this.$comp)}},{key:"setLocation",value:function(e){No.setLocation(this.$comp,e)}},{key:"location",value:function(){return No.location(this.$comp)}},{key:"setBounds",value:function(e){if(this.isAttachedAndVisible()){var t=this.sizeCached;e.dimension().equals(t)||this.invalidateLayout(),this.pixelBasedSizing&&No.setBounds(this.$comp,e),this.validateLayout()}}},{key:"pack",value:function(){var e=this.prefSize();this.setSize(e)}},{key:"isAttached",value:function(){return this.$comp.isAttached()&&this.$comp.window(!0)}},{key:"isVisible",value:function(){return this.$comp.isVisible()}},{key:"isAttachedAndVisible",value:function(){return this.isAttached()&&this.isVisible()}},{key:"debug",value:function(){return No.debugOutput(this.$comp)}}])&&Go(t.prototype,n),i&&Go(t,i),e}(),Ko={MIN:0,PREF:1,MAX:2,EPS:1e-6};function qo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Yo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._invalidComponents=[],this._validateTimeoutId=null,this._postValidateFunctions=[]}var t,n,i;return t=e,(n=[{key:"invalidateTree",value:function(e){for(var t,n=e,i=e;n;){if((e=n).invalidateLayout(i),e.isValidateRoot()){t=e;break}n=e.getParent()}n||(t=e),this.invalidate(t)}},{key:"invalidate",value:function(e){var t=0;this._invalidComponents.indexOf(e)>=0||(this._invalidComponents.forEach((function(n,i){n.isDescendantOf(e)||t++}),this),et.insert(this._invalidComponents,e,t)),this._scheduleValidation()}},{key:"_scheduleValidation",value:function(){null===this._validateTimeoutId&&(this._validateTimeoutId=setTimeout(function(){this.validate()}.bind(this)))}},{key:"validate",value:function(){clearTimeout(this._validateTimeoutId),this._validateTimeoutId=null,this._invalidComponents.slice().forEach((function(e){e.validateLayout()&&et.remove(this._invalidComponents,e)}),this),this._postValidateFunctions.slice().forEach((function(e){e(),et.remove(this._postValidateFunctions,e)}),this)}},{key:"cleanupInvalidComponents",value:function(e){this._invalidComponents.slice().forEach((function(t){t.$comp.closest(e).length>0&&et.remove(this._invalidComponents,t)}),this)}},{key:"schedulePostValidateFunction",value:function(e){e&&this._postValidateFunctions.push(e)}}])&&qo(t.prototype,n),i&&qo(t,i),e}();function Xo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Jo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.dirty=!0,this.gridConfig=t.gridConfig||null,this._setGridConfig(this.gridConfig)}var t,n,i;return t=e,(n=[{key:"setDirty",value:function(e){this.dirty=e}},{key:"setGridConfig",value:function(e){this._setGridConfig(e)}},{key:"_setGridConfig",value:function(e){!e||e instanceof Qo||(e=O.create("LogicalGridConfig",e)),this.gridConfig=e}},{key:"validate",value:function(e){this.dirty&&(this._validate(e),this.setDirty(!1))}}])&&Xo(t.prototype,n),i&&Xo(t,i),e}();function Zo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Qo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.widget=null}var t,n,i;return t=e,(n=[{key:"setWidget",value:function(e){this.widget=e}},{key:"getGridColumnCount",value:function(){return this.widget.gridColumnCount}},{key:"getGridWidgets",value:function(){return this.widget.widgets}}])&&Zo(t.prototype,n),i&&Zo(t,i),e}();function es(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ts=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gridx=0,this.gridy=0,this.gridw=1,this.gridh=1,this.weightx=0,this.weighty=0,this.useUiWidth=!1,this.useUiHeight=!1,this.widthHint=0,this.heightHint=0,this.horizontalAlignment=-1,this.verticalAlignment=-1,this.fillHorizontal=!0,this.fillVertical=!0,t instanceof e?oi.copyProperties(t,this):t instanceof de&&(this.widget=t)}var t,n,i;return t=e,(n=[{key:"validate",value:function(){if(this.widget){var e=this.widget.gridData;this.gridx=e.x,this.gridy=e.y,this.gridw=e.w,this.gridh=e.h,this.weightx=e.weightX,this.weighty=e.weightY,this.weightx<0&&(this.weightx=Math.max(1,this.gridw)),this.weighty<0&&(this.weighty=this._inheritWeightY()),this.useUiWidth=e.useUiWidth,this.useUiHeight=e.useUiHeight,this.horizontalAlignment=e.horizontalAlignment,this.verticalAlignment=e.verticalAlignment,this.fillHorizontal=e.fillHorizontal,this.fillVertical=e.fillVertical,this.widthHint=e.widthInPixel,this.heightHint=e.heightInPixel,this.widget.labelVisible&&this.widget.$label&&this.widget.labelPosition===GH.LabelPosition.TOP?this.logicalRowHeightAddition=No.prefSize(this.widget.$label,!0).height:this.logicalRowHeightAddition=0}}},{key:"_inheritWeightY",value:function(){var e=this._inheritWeightYRec(this.widget);if(null===e){var t=this.widget.gridData;e=t.weightY>=0?t.weightY:t.h>=2?t.h:0}return e}},{key:"_inheritWeightYRec",value:function(e){var t=!1,n=0;if(e.validateLogicalGrid(),e instanceof EV){var i,r,o,s=e.getFields();for(i=0;i<s.length;i++)if((o=s[i]).isVisible()){var a=o.gridData;a.weightY<0?null!==(r=this._inheritWeightYRec(o))&&(t=!0,n+=r):(t=!0,n+=a.weightY)}}else n=e.gridData.h>=2?e.gridData.h:0,t=!0;return t?n:null}},{key:"isValidateRoot",value:function(){return!this.useUiHeight&&!this.useUiWidth&&this.fillVertical&&this.fillHorizontal}}])&&es(t.prototype,n),i&&es(t,i),e}();function ns(e){return(ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function is(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rs(e,t){return(rs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function os(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=us(e);if(t){var r=us(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ss(this,n)}}function ss(e,t){return!t||"object"!==ns(t)&&"function"!=typeof t?as(e):t}function as(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function us(e){return(us=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ls=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rs(e,t)}(o,e);var t,n,i,r=os(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).cssClass="logical-grid-layout",n.validityBasedOnContainerSize=new Co,n.valid=!1,n.widget=e,n.info=null,n._initDefaults(),n.layoutConfig=fs.ensure(t||{}),n.layoutConfig.applyToLayout(as(n)),n.htmlPropertyChangeHandler=n._onHtmlEnvironmenPropertyChange.bind(as(n)),Vo.get().on("propertyChange",n.htmlPropertyChangeHandler),n.widget.one("remove",function(){Vo.get().off("propertyChange",this.htmlPropertyChangeHandler)}.bind(as(n))),n}return t=o,(n=[{key:"_initDefaults",value:function(){var e=Vo.get();this.hgap=e.formColumnGap,this.vgap=e.formRowGap,this.columnWidth=e.formColumnWidth,this.rowHeight=e.formRowHeight,this.minWidth=0}},{key:"_onHtmlEnvironmenPropertyChange",value:function(){this._initDefaults(),this.layoutConfig.applyToLayout(this),this.widget.invalidateLayoutTree(),this.widget.invalidateLogicalGrid()}},{key:"validateLayout",value:function(e,t){var n=[],i=[];function r(e){this._validateGridData(e)&&(n.push(e.$comp),i.push(e.layoutData))}this.widget.logicalGrid?(this.widget.validateLogicalGrid(),this.widget.logicalGrid.gridConfig.getGridWidgets().forEach((function(e){e.rendered&&(e.htmlComp?r.call(this,e.htmlComp):s.a.log.isWarnEnabled()&&s.a.log.warn("(LogicalGridLayout#validateLayout) no htmlComp found, widget cannot be layouted. Widget: "+e))}),this)):e.children().each(function(e,t){var n=s()(t),i=Uo.optGet(n);i&&r.call(this,i)}.bind(this)),this.info=new ds({$components:n,cons:i,hgap:this.hgap,vgap:this.vgap,rowHeight:this.rowHeight,columnWidth:this.columnWidth,widthHint:t.widthHint,heightHint:t.heightHint,widthOnly:t.widthOnly}),s.a.log.isTraceEnabled()&&s.a.log.trace("(LogicalGridLayout#validateLayout) $container="+Uo.get(e).debug())}},{key:"_validateGridData",value:function(e){var t=e.$comp,n=t.data("widget");if(n?n.isVisible():t.isVisible())return e.layoutData.validate(),!0}},{key:"layout",value:function(e){this._layout(e)}},{key:"_layout",value:function(e){var t=Uo.get(e),n=t.availableSize(),i=t.insets();this.validateLayout(e,{widthHint:n.width-i.horizontal(),heightHint:n.height-i.vertical()}),this.minWidth>0&&n.width<this.minWidth&&(n.width=this.minWidth),s.a.log.isTraceEnabled()&&s.a.log.trace("(LogicalGridLayout#layout) container "+t.debug()+" size="+n+" insets="+i);var r,o,a,u,l,c,f,h,d,p,y=this._layoutCellBounds(n,i);for(c=0;c<this.info.$components.length;c++)l=this.info.$components[c],f=Uo.get(l),r=y[(h=this.info.gridDatas[c]).gridy][h.gridx],o=y[h.gridy+h.gridh-1][h.gridx+h.gridw-1],a=r.union(o),p=f.margins(),a.width-=p.horizontal(),a.height-=p.vertical(),h.fillHorizontal&&h.fillVertical||(u=this.info.compSize[c],!h.fillHorizontal&&u.width<a.width&&(d=a.width-u.width,a.width=u.width,0===h.horizontalAlignment?a.x+=Math.ceil(d/2):h.horizontalAlignment>0&&(a.x+=d)),!h.fillVertical&&u.height<a.height&&(d=a.height-u.height,0===h.heightHint?a.height=u.height:a.height=h.heightHint,0===h.verticalAlignment?a.y+=Math.ceil(d/2):h.verticalAlignment>0&&(a.y+=d))),s.a.log.isTraceEnabled()&&s.a.log.trace("(LogicalGridLayout#layout) comp="+f.debug()+" bounds="+a),f.setBounds(a)}},{key:"_layoutCellBounds",value:function(e,t){return this.info.layoutCellBounds(e,t)}},{key:"preferredLayoutSize",value:function(e,t){this.validateLayout(e,t);var n,i,r,o=Ko.PREF,s=new Co,a=0;for(n=0;n<this.info.cols;n++)i=this.info.width[n][o],a>0&&(s.width+=this.hgap),s.width+=i,a++;for(a=0,n=0;n<this.info.rows;n++)r=this.info.height[n][o],a>0&&(s.height+=this.vgap),s.height+=r,a++;var u=Uo.get(e).insets();return s.width+=u.horizontal(),s.height+=u.vertical(),s}}])&&is(t.prototype,n),i&&is(t,i),o}(zo);function cs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._extend(t)}var t,n,i;return t=e,i=[{key:"ensure",value:function(t){return t?t instanceof e?t:new e(t):t}}],(n=[{key:"_extend",value:function(e){(e=e||{}).hgap>-1&&(this.hgap=e.hgap),e.vgap>-1&&(this.vgap=e.vgap),e.columnWidth>-1&&(this.columnWidth=e.columnWidth),e.rowHeight>-1&&(this.rowHeight=e.rowHeight),e.minWidth>-1&&(this.minWidth=e.minWidth)}},{key:"clone",value:function(){return new e(this)}},{key:"applyToLayout",value:function(e){e.layoutConfig=this,null!==this.hgap&&void 0!==this.hgap&&(e.hgap=this.hgap),null!==this.vgap&&void 0!==this.vgap&&(e.vgap=this.vgap),null!==this.columnWidth&&void 0!==this.columnWidth&&(e.columnWidth=this.columnWidth),null!==this.rowHeight&&void 0!==this.rowHeight&&(e.rowHeight=this.rowHeight),null!==this.minWidth&&void 0!==this.minWidth&&(e.minWidth=this.minWidth)}}])&&cs(t.prototype,n),i&&cs(t,i),e}();function hs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ds=function(){function e(t){var n,i,r,o;for(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gridDatas=[],this.$components=null,this.cols=0,this.compSize=[],this.rows=0,this.width=[],this.widthHints=[],this.height=[],this.weightX=[],this.weightY=[],this.hgap=0,this.vgap=0,this.rowHeight=0,this.columnWidth=0,this.cellBounds=[],this.widthHint=null,this.widthOnly=!1,s.a.extend(this,t),n=0;n<this.cons.length;n++)this.gridDatas[n]=new ts(this.cons[n]);if(0!==this.$components.length){var a=new Mi,u=new Mi;for(n=0;n<this.gridDatas.length;n++){for((i=this.gridDatas[n]).gridx<0&&(i.gridx=0),i.gridy<0&&(i.gridy=0),i.gridw<1&&(i.gridw=1),i.gridh<1&&(i.gridh=1),r=i.gridx;r<i.gridx+i.gridw;r++)a.add(r);for(o=i.gridy;o<i.gridy+i.gridh;o++)u.add(o)}for(r=a.last();r>=0;r--)if(!a.contains(r))for(n=0;n<this.gridDatas.length;n++)(i=this.gridDatas[n]).gridx>r&&i.gridx--;for(o=u.last();o>=0;o--)if(!u.contains(o))for(n=0;n<this.gridDatas.length;n++)(i=this.gridDatas[n]).gridy>o&&i.gridy--;this.cols=a.size(),this.rows=u.size(),s.a.log.isTraceEnabled()&&s.a.log.trace("(LogicalGridLayoutInfo#CTOR) $components.length="+this.$components.length+" usedCols="+this.cols+" usedRows="+this.rows),this._initializeInfo()}}var t,n,i;return t=e,(n=[{key:"_initializeInfo",value:function(){for(var e=this.$components.length,t=[],n=0;n<e;n++){var i=this.$components[n],r=this.gridDatas[n];r.gridx<0&&(r.gridx=0),r.gridy<0&&(r.gridy=0),r.gridw<1&&(r.gridw=1),r.gridh<1&&(r.gridh=1),r.gridx>=this.cols&&(r.gridx=this.cols-1),r.gridy>=this.rows&&(r.gridy=this.rows-1),r.gridx+r.gridw-1>=this.cols&&(r.gridw=this.cols-r.gridx),r.gridy+r.gridh>=this.rows&&(r.gridh=this.rows-r.gridy);var o=new Co(0,0);r.widthHint>0?o.width=r.widthHint:!r.useUiWidth&&r.fillHorizontal||(o=this.uiSizeInPixel(i,r)),r.heightHint>0?o.height=r.heightHint:!r.useUiHeight&&r.fillVertical||t.push({cons:r,$comp:i,index:n}),this.compSize[n]=o}if(this._initializeColumns(),this.widthOnly)this.height=et.init(this.rows,[0,0,0]);else{if(this.widthHint&&t.length>0){var s=Math.max(0,(this.cols-1)*this.hgap);this.widthHints=this.layoutSizes(this.widthHint-s,this.width,this.weightX)}t.forEach((function(e){var t=e.$comp,n=e.cons,i=this.widthHintForGridData(n);n.fillHorizontal||(i=Math.min(i,this.compSize[e.index].width)),this.compSize[e.index]=this.uiSizeInPixel(t,n,{widthHint:i})}),this),this._initializeRows()}}},{key:"_initializeColumns",value:function(){var e,t,n,i,r,o=this.compSize,s=o.length,a=et.init(this.cols,0),u=et.init(this.cols,!1);for(e=0;e<s;e++)if(1===(r=this.gridDatas[e]).gridw)for(i=r.widthHint>0?r.widthHint:r.useUiWidth?o[e].width:this.logicalWidthInPixel(r),i=Math.floor(i),t=r.gridx;t<r.gridx+r.gridw&&t<this.cols;t++)a[t]=Math.max(a[t],i),0===r.weightx&&(u[t]=!0);for(e=0;e<s;e++)if((r=this.gridDatas[e]).gridw>1){var l,c=r.gridw,f=0;for(t=r.gridx;t<r.gridx+r.gridw&&t<this.cols;t++)u[t]||(f+=a[t]);if((l=r.widthHint>0?r.widthHint-f-(c-1)*this.hgap:r.useUiWidth?o[e].width-f-(c-1)*this.hgap:this.logicalWidthInPixel(r)-f-(c-1)*this.hgap)>0){var h=Math.floor((l+f)/c),d=(l+f)%c,p=-1;for(t=r.gridx;t<r.gridx+r.gridw&&t<this.cols;t++)p=t,u[t]||(a[t]=Math.max(h,a[t])),0===r.weightx&&(u[t]=!0);p>-1&&(a[p]+=d)}}var y=Ko;for(e=0;e<this.cols;e++)this.width[e]=[],u[e]?(this.width[e][y.MIN]=a[e],this.width[e][y.PREF]=a[e],this.width[e][y.MAX]=a[e]):(this.width[e][y.MIN]=0,this.width[e][y.PREF]=a[e],this.width[e][y.MAX]=10240);for(e=0;e<this.cols;e++)if(u[e])this.weightX[e]=0;else{var v=0,b=0;for(n=0;n<s;n++)(r=this.gridDatas[n]).weightx>0&&r.gridx<=e&&e<=r.gridx+r.gridw-1&&(v+=r.weightx/r.gridw,b++);this.weightX[e]=b>0?v/b:0}var g=0;for(e=0;e<this.cols;e++)g+=this.weightX[e];if(g>=1e-6){var m=1/g;for(e=0;e<this.cols;e++)this.weightX[e]=this.weightX[e]*m}}},{key:"_initializeRows",value:function(){var e,t,n,i,r,o=this.compSize,s=o.length,a=et.init(this.rows,0),u=et.init(this.rows,!1);for(e=0;e<s;e++)if(1===(r=this.gridDatas[e]).gridh)for(i=r.heightHint>0?r.heightHint:r.useUiHeight?o[e].height:this.logicalHeightInPixel(r),i=Math.floor(i),t=r.gridy;t<r.gridy+r.gridh&&t<this.rows;t++)a[t]=Math.max(a[t],i),0===r.weighty&&(u[t]=!0);for(e=0;e<s;e++)if((r=this.gridDatas[e]).gridh>1){var l,c=r.gridh,f=0;for(t=r.gridy;t<r.gridy+r.gridh&&t<this.rows;t++)u[t]||(f+=a[t]);if((l=r.heightHint>0?r.heightHint-f-(c-1)*this.vgap:r.useUiHeight?o[e].height-f-(c-1)*this.vgap:this.logicalHeightInPixel(r)-f-(c-1)*this.vgap)>0){var h=Math.floor((l+f)/c),d=(l+f)%c,p=-1;for(t=r.gridy;t<r.gridy+r.gridh&&t<this.rows;t++)p=t,u[t]||(a[t]=Math.max(h,a[t])),0===r.weighty&&(u[t]=!0);p>-1&&(a[p]+=d)}}var y=Ko;for(e=0;e<this.rows;e++)this.height[e]=[],u[e]?(this.height[e][y.MIN]=a[e],this.height[e][y.PREF]=a[e],this.height[e][y.MAX]=a[e]):(this.height[e][y.MIN]=0,this.height[e][y.PREF]=a[e],this.height[e][y.MAX]=10240);for(e=0;e<this.rows;e++)if(u[e])this.weightY[e]=0;else{var v=0,b=0;for(n=0;n<s;n++)(r=this.gridDatas[n]).weighty>0&&r.gridy<=e&&e<=r.gridy+r.gridh-1&&(v+=r.weighty/r.gridh,b++);this.weightY[e]=b>0?v/b:0}var g=0;for(e=0;e<this.rows;e++)g+=this.weightY[e];if(g>=1e-6){var m=1/g;for(e=0;e<this.rows;e++)this.weightY[e]=this.weightY[e]*m}}},{key:"layoutCellBounds",value:function(e,t){var n=this.layoutSizes(e.width-t.horizontal()-Math.max(0,(this.cols-1)*this.hgap),this.width,this.weightX),i=this.layoutSizes(e.height-t.vertical()-Math.max(0,(this.rows-1)*this.vgap),this.height,this.weightY);this.cellBounds=et.init(this.rows,null);var r,o,s,a=t.top;for(r=0;r<this.rows;r++){for(o=t.left,this.cellBounds[r]=et.init(this.cols,null),s=0;s<this.cols;s++)this.cellBounds[r][s]=new Fo(o,a,n[s],i[r]),o+=n[s],o+=this.hgap;a+=i[r],a+=this.vgap}return this.cellBounds}},{key:"layoutSizes",value:function(e,t,n){var i,r=et.init(t.length,0);if(e<=0){for(i=0;i<t.length;i++)r[i]=t[i][Ko.MIN];return r}var o=0,s=et.init(n.length,0),a=0;for(i=0;i<t.length;i++)r[i]=t[i][Ko.PREF],o+=r[i],s[i]=n[i],s[i]<Ko.EPS&&(t[i][Ko.MAX]>t[i][Ko.MIN]?s[i]=1:s[i]=0),a+=s[i];if(a>0)for(i=0;i<s.length;i++)s[i]=s[i]/a;var u=e-o;if(Math.abs(u)>0){var l,c=et.init(s.length,0);if(u>0)for(l=!0;u>0&&l;)for(l=!1,i=0;i<r.length&&u>0;i++)s[i]>0&&r[i]<t[i][Ko.MAX]&&(l=!0,c[i]+=s[i],c[i]>0&&(c[i]-=1,r[i]+=1,u-=1));else for(l=!0;u<0&&l;)for(l=!1,i=0;i<r.length&&u<0;i++)s[i]>0&&r[i]>t[i][Ko.MIN]&&(l=!0,c[i]+=s[i],c[i]>0&&(c[i]-=1,r[i]-=1,u+=1))}return r}},{key:"logicalWidthInPixel",value:function(e){var t=e.gridw;return this.columnWidth*t+this.hgap*Math.max(0,t-1)}},{key:"logicalHeightInPixel",value:function(e){var t=e.gridh,n=e.logicalRowHeightAddition||0;return this.rowHeight*t+this.vgap*Math.max(0,t-1)+n}},{key:"uiSizeInPixel",value:function(e,t,n){var i=Uo.get(e);return i.prefSize(n).add(i.margins())}},{key:"widthHintForGridData",value:function(e){if(0===this.widthHints.length)return null;for(var t=(e.gridw-1)*this.hgap,n=e.gridx;n<e.gridx+e.gridw;n++)t+=this.widthHints[n];return t}}])&&hs(t.prototype,n),i&&hs(t,i),e}();function ps(e){return(ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ys(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vs(e,t){return(vs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ms(e);if(t){var r=ms(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gs(this,n)}}function gs(e,t){return!t||"object"!==ps(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ms(e){return(ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vs(e,t)}(o,e);var t,n,i,r=bs(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).gridRows=0,t.gridColumns=0,t}return t=o,i=[{key:"getGridDataFromHints",value:function(e,t){var n=kV.createFromHints(e,t);return n.w=Math.min(t,n.w),n}}],(n=[{key:"_validate",value:function(e){this.gridRows=0,this.gridConfig.setWidget(e),this.gridColumns=this.gridConfig.getGridColumnCount();var t=0,n=0,i=[];this.gridConfig.getGridWidgets().forEach((function(e){if(e.isVisible()){i.push(e);var r=e.gridDataHints;r&&r.x>=0&&r.y>=0?t++:n++}else{var o=kV.createFromHints(e,1);e.gridData=o}})),t>0&&0===n?this.layoutAllStatic(i):this.layoutAllDynamic(i)}},{key:"layoutAllStatic",value:function(e){var t=[];e.forEach((function(e){t.push(kV.createFromHints(e,1))}));var n=t.reduce((function(e,t){var n=t.x+t.w;return n>e?n:e}),1),i=t.reduce((function(e,t){var n=t.y+t.h;return n>e?n:e}),0);e.forEach((function(e){e.gridData=kV.createFromHints(e,n)})),this.gridRows=i,this.gridColumns=n}},{key:"layoutAllDynamic",value:function(e){}},{key:"getGridColumnCount",value:function(){return this.gridColumns}},{key:"getGridRowCount",value:function(){return this.gridRows}}])&&ys(t.prototype,n),i&&ys(t,i),o}(Jo);function ws(e){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ks(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ss(e,t){return(Ss=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Os(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Cs(e);if(t){var r=Cs(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ts(this,n)}}function Ts(e,t){return!t||"object"!==ws(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cs(e){return(Cs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ps=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ss(e,t)}(o,e);var t,n,i,r=Os(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"layoutAllDynamic",value:function(e){var t=new qs(this.getGridColumnCount());t.computeGridData(e),this.gridRows=t.getRowCount()}}])&&ks(t.prototype,n),i&&ks(t,i),o}(_s);function Rs(e){return(Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Es(e,t){return(Es=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ds(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=As(e);if(t){var r=As(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Fs(this,n)}}function Fs(e,t){return!t||"object"!==Rs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function As(e){return(As=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Es(e,t)}(o,e);var t,n,i,r=Ds(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"layoutAllDynamic",value:function(e){var t=0;e.forEach(function(e){var n=_s.getGridDataFromHints(e,this.getGridColumnCount());t+=n.w*n.h}.bind(this));for(var n=Math.floor((t+this.getGridColumnCount()-1)/this.getGridColumnCount()),i=new ta(this.getGridColumnCount(),n);!i.computeGridData(e);)i.resetAll(this.getGridColumnCount(),++n);e.forEach((function(e){e.gridData=i.getGridData(e)})),this.gridRows=i.getRowCount()}}])&&xs(t.prototype,n),i&&xs(t,i),o}(_s);function js(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ms=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._cursor=t,this._assignedCells=[]}var t,n,i;return t=e,(n=[{key:"getColumnCount",value:function(){return this._cursor.columnCount}},{key:"getRowCount",value:function(){return this._cursor.rowCount}},{key:"_setAssignedCell",value:function(e,t){this._assignedCells[e.x]||(this._assignedCells[e.x]=[]),this._assignedCells[e.x][e.y]=t}},{key:"_getAssignedCell",value:function(e){return this._assignedCells[e.x]?this._assignedCells[e.x][e.y]:null}},{key:"_nextFree",value:function(e,t){if(!this._cursor.increment())return!1;var n=this._cursor.currentIndex();return!!this._isAllCellFree(n.x,n.y,e,t)||(this._getAssignedCell(n)||this._setAssignedCell(n,new Ls),this._nextFree(e,t))}},{key:"_isAllCellFree",value:function(e,t,n,i){return!(e+n>this._cursor.startX+this._cursor.columnCount||t+i>this._cursor.startY+this._cursor.rowCount)&&this._assignedCells.slice(e,e+n).every((function(e){return(e||[]).slice(t,t+i).every((function(e){return!e}))}))}},{key:"toString",value:function(){for(var e="----Group Box Grid Matrix [orientation="+this._cursor.orientation+", columnCount="+this.getColumnCount()+", rowCount="+this.getRowCount()+"]--------------\n",t=new Hs(0,0,this.getColumnCount(),this.getRowCount(),this._cursor.orientation);t.increment();){var n=this._getAssignedCell(t.currentIndex());e+="cell["+t.currentIndex().x+", "+t.currentIndex().y+"] ",n?n.widget?e+=n.widget+(n.widget?", ["+n.widget.label+"]":""):e+="Placeholder":e+="NULL",e+="\n"}return e}}])&&js(t.prototype,n),i&&js(t,i),e}();function Is(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ls=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.widget=t,this.data=n}var t,n,i;return t=e,(n=[{key:"isEmpty",value:function(){return!this.widget}}])&&Is(t.prototype,n),i&&Is(t,i),e}();function Bs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ns(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Hs=function(){function e(t,n,i,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.startX=t,this.startY=n,this.columnCount=i,this.rowCount=r,this.orientation=o,this.reset()}var t,n,i;return t=e,(n=[{key:"reset",value:function(){this._currentIndex={x:-1,y:-1}}},{key:"currentIndex",value:function(){return{x:this._currentIndex.x,y:this._currentIndex.y}}},{key:"increment",value:function(){return this._currentIndex.x<0||this._currentIndex.y<0?(this._currentIndex.x=this.startX,this._currentIndex.y=this.startY):this.orientation===e.HORIZONTAL?(this._currentIndex.x++,this._currentIndex.x>=this.startX+this.columnCount&&(this._currentIndex.x=this.startX,this._currentIndex.y++)):(this._currentIndex.y++,this._currentIndex.y>=this.startY+this.rowCount&&(this._currentIndex.y=this.startY,this._currentIndex.x++)),!(this._currentIndex.x>=this.startX+this.columnCount||this._currentIndex.y>=this.startY+this.rowCount)}},{key:"decrement",value:function(){return!(this._currentIndex.x<0||this._currentIndex.y<0||(this._currentIndex.x>=this.startX+this.columnCount||this._currentIndex.y>=this.startY+this.rowCount?(this._currentIndex.x=this.startX+this.columnCount-1,this._currentIndex.y=this.startY+this.rowCount-1):this.orientation===e.HORIZONTAL?(this._currentIndex.x--,this._currentIndex.x<this.startX&&(this._currentIndex.x=this.startX+this.columnCount-1,this._currentIndex.y--)):(this._currentIndex.y--,this._currentIndex.y<this.startY&&(this._currentIndex.y=this.startY+this.rowCount-1,this._currentIndex.x--)),this._currentIndex.x<this.startX||this._currentIndex.y<this.startY))}},{key:"toString",value:function(){var e=[];return e.push("MatrixCursor ["),e.push("orientation="+this.orientation),e.push(", startX="+this.startX),e.push(", startY="+this.startY),e.push(", columnCount="+this.columnCount),e.push(", currentIndex="+this._currentIndex.x+", "+this._currentIndex.y),e.push("]"),e.join("")}}])&&Bs(t.prototype,n),i&&Bs(t,i),e}();function Vs(e){return(Vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ws(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zs(e,t){return(zs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ks(e);if(t){var r=Ks(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Us(this,n)}}function Us(e,t){return!t||"object"!==Vs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ks(e){return(Ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Ns(Hs,"HORIZONTAL",0),Ns(Hs,"VERTICAL",1);var qs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zs(e,t)}(o,e);var t,n,i,r=Gs(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,new Hs(0,0,e,Number.MAX_SAFE_INTEGER,Hs.HORIZONTAL))).rowCount=0,t}return t=o,(n=[{key:"computeGridData",value:function(e){return e.forEach(function(e){var t=kV.createFromHints(e,this.getColumnCount()),n=new kV(t);n.w=Math.min(t.w,this.getColumnCount()),this._add(e,t,n),e.gridData=n}.bind(this)),this._cursor.rowCount=this.rowCount,!0}},{key:"_add",value:function(e,t,n){this._nextFree(n.w,n.h);var i=this._cursor.currentIndex();if(n.w<=this.getColumnCount()-i.x){n.x=i.x,n.y=i.y;for(var r=i.x;r<i.x+n.w;r++)for(var o=i.y;o<i.y+n.h;o++)this._setAssignedCell({x:r,y:o},new Ls(e,n));this.rowCount=i.y+n.h}else this._setAssignedCell(this._cursor.currentIndex(),new Ls),this._add(e,t,n)}}])&&Ws(t.prototype,n),i&&Ws(t,i),o}(Ms);function Ys(e){return(Ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Js(e,t){return(Js=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ea(e);if(t){var r=ea(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Qs(this,n)}}function Qs(e,t){return!t||"object"!==Ys(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ea(e){return(ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ta=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Js(e,t)}(o,e);var t,n,i,r=Zs(o);function o(e,t,n,i){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(s=r.call(this,new Hs(n||0,i||0,e,t,Hs.VERTICAL)))._widgets=[],s._widgetGridDatas=[],s}return t=o,(n=[{key:"resetAll",value:function(e,t){this._widgetGridDatas=[],this._assignedCells=[],this._widgetIndexes=[],this._cursor=new Hs(this._cursor.startX,this._cursor.startY,e,t,Hs.VERTICAL)}},{key:"computeGridData",value:function(e){return this._widgets=e,e.every(function(e,t){return this._widgetGridDatas[t]=_s.getGridDataFromHints(e,this._cursor.columnCount),this._add(e,this._widgetGridDatas[t])}.bind(this))}},{key:"getGridData",value:function(e){return this._widgetGridDatas[this._widgets.indexOf(e)]}},{key:"_addAssignedCells",value:function(e){e.forEach(function(e,t){e&&e.forEach(function(e,n){e&&this._setAssignedCell({x:t,y:n},e)}.bind(this))}.bind(this))}},{key:"_getAssignedCells",value:function(){return this._assignedCells}},{key:"_add",value:function(e,t){var n=this._cursor.currentIndex();if(t.w>1){for(var i=n.x,r=n.y;i+t.w>this._cursor.startX+this._cursor.columnCount;)i--,r=this._cursor.rowCount-1;this._reorganizeGridAbove(i,r,t.w)}if(!this._nextFree(t.w,t.h))return!1;n=this._cursor.currentIndex(),t.x=n.x,t.y=n.y;for(var o=n.x;o<n.x+t.w;o++)for(var s=n.y;s<n.y+t.h;s++)this._setAssignedCell({x:o,y:s},new Ls(e,t));return!0}},{key:"_reorganizeGridAbove",value:function(e,t,n){for(var i,r=[],s=[],a=function(e,t,n){s[e]||(s[e]=[]),s[e][t]=n},u={x:e,y:0,w:n,h:t+1},l=t,c=0,f=!0,h=t;h>=0&&f;h--)for(var d=e;d<e+n&&f;d++){var p={x:d,y:h},y=this._getAssignedCell(p);if(y&&!y.isEmpty()){var v=y.data;this._horizontalMatchesOrOverlaps(u,v)?f=!1:this._horizontalOverlapsOnSide(u,v)?(a(p.x,p.y,y),c++,l=Math.min(p.y,l)):(this._setAssignedCell(p,null),i=y.widget,-1===r.indexOf(i)&&r.push(i),c++,l=Math.min(p.y,l))}}if(0!==r.length){r.sort(function(e,t){return this._widgets.indexOf(e)<this._widgets.indexOf(t)?-1:1}.bind(this)),u.y=l;var b=new o(u.w,Math.floor((c+u.w-1)/u.w),u.x,u.y);for(b._addAssignedCells(s);!b.computeGridData(r);)b.resetAll(b.getColumnCount(),b.getRowCount()+1);this._cursor.reset(),this._addAssignedCells(b._getAssignedCells()),b._widgetGridDatas.forEach(function(e,t){this._widgetGridDatas[this._widgets.indexOf(b._widgets[t])]=e}.bind(this))}}},{key:"_horizontalMatchesOrOverlaps",value:function(e,t){return e.x>=t.x&&e.x+e.w<=t.x+t.w}},{key:"_horizontalOverlapsOnSide",value:function(e,t){return e.x>t.x||e.x+e.w<t.x+t.w}}])&&Xs(t.prototype,n),i&&Xs(t,i),o}(Ms);function na(e){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ia(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ra(e,t){return(ra=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=aa(e);if(t){var r=aa(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sa(this,n)}}function sa(e,t){return!t||"object"!==na(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aa(e){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ua=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ra(e,t)}(o,e);var t,n,i,r=oa(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),e=e||{},(t=r.call(this)).stretch=O.nvl(e.stretch,!0),t.useCssWidth=O.nvl(e.useCssWidth,!1),t}return t=o,(n=[{key:"layout",value:function(e){var t=Uo.get(e),n=t.availableSize().subtract(t.insets());e.children().each(function(e,t){var i=s()(t),r=Uo.optGet(i);if(r&&i.isVisible()){var o=r.prefSize({useCssSize:!0});this.stretch&&(o.height=n.height-r.margins().vertical()),r.layoutData&&r.layoutData.widthHint&&(o.width=r.layoutData.widthHint),this.useCssWidth?(r.$comp.cssHeight(o.height),r.revalidateLayout()):r.setSize(o)}}.bind(this))}},{key:"preferredLayoutSize",value:function(e,t){var n=new Co,i=Uo.get(e),r={useCssSize:!0};return e.children().each((function(e,t){var i=s()(t),o=Uo.optGet(i);if(o&&i.isVisible()){var a=o.prefSize(r);o.layoutData&&o.layoutData.widthHint&&(a.width=o.layoutData.widthHint),a=a.add(o.margins()),n.width=n.width+a.width,n.height=Math.max(n.height,a.height)}})),n=n.add(i.insets())}}])&&ia(t.prototype,n),i&&ia(t,i),o}(zo);function la(e){return(la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ca(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fa(e,t){return(fa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ha(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pa(e);if(t){var r=pa(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return da(this,n)}}function da(e,t){return!t||"object"!==la(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pa(e){return(pa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ya=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fa(e,t)}(o,e);var t,n,i,r=ha(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"layout",value:function(e){e.children().each((function(){var e=Uo.optGet(s()(this));e&&e.revalidateLayout()}))}}])&&ca(t.prototype,n),i&&ca(t,i),o}(zo);function va(e){return(va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ba(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ga(e,t){return(ga=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ma(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=wa(e);if(t){var r=wa(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _a(this,n)}}function _a(e,t){return!t||"object"!==va(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wa(e){return(wa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ka=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ga(e,t)}(o,e);var t,n,i,r=ma(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),e=e||{},(t=r.call(this)).pixelBasedSizing=O.nvl(e.pixelBasedSizing,!0),t.stretch=O.nvl(e.stretch,!0),t}return t=o,(n=[{key:"layout",value:function(e){var t=Uo.get(e),n=t.availableSize().subtract(t.insets());e.children().each(function(e,t){var i=s()(t),r=Uo.optGet(i);if(r&&i.isVisible())if(this.pixelBasedSizing){var o=r.prefSize({widthHint:n.width});this.stretch&&(o.width=n.width-r.margins().horizontal()),r.setSize(o)}else r.validateLayout()}.bind(this))}},{key:"preferredLayoutSize",value:function(e,t){var n=new Co,i=Uo.get(e),r=0;return e.children().each((function(e,i){var o=s()(i),a=Uo.optGet(o);if(a&&o.isVisible()){var u=a.prefSize(t).add(a.margins());r=Math.max(u.width,r),n.height+=u.height,n.width=r}})),n=n.add(i.insets())}}])&&ba(t.prototype,n),i&&ba(t,i),o}(zo);function Sa(e){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ta(e,t){return(Ta=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ca(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ra(e);if(t){var r=Ra(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Pa(this,n)}}function Pa(e,t){return!t||"object"!==Sa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ra(e){return(Ra=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ta(e,t)}(o,e);var t,n,i,r=Ca(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this))._htmlChild=e,t=t||{},n.exact=scout.nvl(t.exact,!1),n}return t=o,(n=[{key:"layout",value:function(e){var t=Uo.get(e),n=t.availableSize({exact:this.exact}).subtract(t.insets()),i=this._htmlChild;i||(i=this._getHtmlSingleChild(e)),i&&i.setSize(n)}},{key:"preferredLayoutSize",value:function(e,t){var n=this._htmlChild;return n||(n=this._getHtmlSingleChild(e)),n?n.prefSize(t).add(No.insets(e)):new Co(1,1)}},{key:"_getHtmlSingleChild",value:function(e){var t=null;return e.children().each((function(e,n){var i=Uo.optGet(s()(n));if(i)return t=i,!1})),t}}])&&Oa(t.prototype,n),i&&Oa(t,i),o}(zo);function Ea(e){return(Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Da(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fa(e,t){return(Fa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Aa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ja(e);if(t){var r=ja(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $a(this,n)}}function $a(e,t){return!t||"object"!==Ea(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ja(e){return(ja=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ma=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fa(e,t)}(o,e);var t,n,i,r=Aa(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).childrenLayoutDatas=[],n.cacheKey=null,n.setCacheKey(t),e===o.Direction.ROW?(n.preferredLayoutSize=n.preferredLayoutSizeRow,n._getDimensionValue=n._getWidth,n._layoutFromLayoutData=n._layoutFromLayoutDataRow):(n.preferredLayoutSize=n.preferredLayoutSizeColumn,n._getDimensionValue=n._getHeight,n._layoutFromLayoutData=n._layoutFromLayoutDataColumn),n}return t=o,(n=[{key:"setCacheKey",value:function(e){this.cacheKey=e,this.cacheKey&&this.cacheKey.length>0&&this.cacheKey.unshift("scout.flexboxLayout")}},{key:"_readCache",value:function(e){if(this.cacheKey&&0!==this.cacheKey.length&&!(e<2)){var t,n=this.cacheKey.slice(),i=Gi.getItem(localStorage,n[0]),r=1;for(n.push(""+e),i&&(t=JSON.parse(i));t&&r<n.length;)t=t[n[r]],r++;return t}}},{key:"_writeCache",value:function(e,t){if(this.cacheKey&&0!==this.cacheKey.length&&!(e<2)){var n,i,r=this.cacheKey.slice(),o=Gi.getItem(localStorage,r[0]),s=1;for(r.push(""+e),i=n=o?JSON.parse(o):{};s<r.length-1;)i[r[s]]||(i[r[s]]={}),i=i[r[s]],s++;i[r[s]]=t,Gi.setItem(localStorage,r[0],JSON.stringify(n))}}},{key:"_computeCacheKey",value:function(e){if(this.cacheKey&&!(e<2))return this.cacheKey+"-"+e}},{key:"layout",value:function(e){var t,n=this._getChildren(e),i=Uo.get(e),r=i.availableSize({exact:!0});r=r.subtract(i.insets()),(t=n.filter((function(e){return e.layoutData.diff}))[0])?this._layoutDelta(n,t,r):this._layoutComponents(n,r)}},{key:"_getChildren",value:function(e){var t=[];return e.children().each((function(){var e=Uo.optGet(s()(this));e&&t.push(e)})),t=t.sort((function(e,t){return(e.layoutData.order||0)-(t.layoutData.order||0)}))}},{key:"reset",value:function(){this.childrenLayoutDatas.forEach((function(e){e.sizePx=0,e.initialPx=0,e.diff=null})),this.childrenLayoutDatas=[]}},{key:"_layoutDelta",value:function(e,t,n){this.ensureInitialValues(e,n);var i,r,o=t.layoutData.diff,s=e.slice(0,e.indexOf(t)).reverse(),a=e.slice(e.indexOf(t)+1);function u(e,t,n){return e.reduce((function(e,t){return 0!==e&&(e=t.layoutData.acceptDelta(e,n)),e}),t)}i=u(s,o,!1),r=-u(a,-o,!1),0!=(o=Math.sign(o)*Math.min(Math.abs(o-i),Math.abs(o-r)))&&(u(s,o,!0),u(a,-o,!0)),this._layoutFromLayoutDataWithCache(e,n)}},{key:"_layoutComponents",value:function(e,t){var n=this.ensureInitialValues(e,t);n<0?this._adjust(e,n,(function(e){return e.shrink})):n>0&&this._adjust(e,n,(function(e){return e.grow})),this._layoutFromLayoutDataWithCache(e,t)}},{key:"_adjust",value:function(e,t,n){var i,r,o=e.map((function(e){return e.layoutData})).filter((function(e){return 0===e.acceptDelta(Math.sign(t))}));o.length<1||(i=o.reduce((function(e,t){return e+n(t)}),0),r=t/i,t=o.reduce((function(e,t){return t.acceptDelta(r*n(t),!0)}),t),Math.abs(t)>.2&&this._adjust(e,t,n))}},{key:"_getPreferredSize",value:function(e){return e.prefSize({useCssSize:!0}).add(e.margins())}},{key:"ensureInitialValues",value:function(e,t){var n=this._getDimensionValue(t),i=0,r=0,o=e.map((function(e){return e.layoutData})),s=this._readCache(e.length)||[];e.forEach(function(e,t){var n=e.layoutData;n.sizePx?i+=n.sizePx:n.initial<0?(n.initialPx=this._getDimensionValue(this._getPreferredSize(e)),i+=n.initialPx):n.relative?r+=n.initial:(n.initialPx=n.initial,i+=n.initialPx)}.bind(this));var a=(n-i)/r;return o.filter((function(e){return e.relative&&e.initial>-1&&!e.sizePx})).reduce((function(e,t){return t.initialPx=Math.max(30,a*t.initial),e-t.initialPx}),n-i),o.reduce(function(e,t,i){return t.sizePx||(s[i]?t.sizePx=t.validate(Math.round(n*s[i])):t.sizePx=t.initialPx),this.childrenLayoutDatas.push(t),e-t.sizePx}.bind(this),n)}},{key:"_layoutFromLayoutDataWithCache",value:function(e,t){this._cacheSizes(e,t),this._layoutFromLayoutData(e,t)}},{key:"_cacheSizes",value:function(e,t){var n,i=this._getDimensionValue(t);n=e.map((function(e){return e.layoutData.sizePx/i})),this._writeCache(e.length,n)}},{key:"preferredLayoutSizeColumn",value:function(e,t){return this._getChildren(e).reduce(function(e,t){var n=this._getPreferredSize(t);return e.width=Math.max(n.width,e.width),e.height+=n.height,e}.bind(this),new Co(0,0))}},{key:"preferredLayoutSizeRow",value:function(e,t){return this._getChildren(e).reduce(function(e,t){var n=this._getPreferredSize(t);return e.height=Math.max(n.height,e.height),e.width+=n.width,e}.bind(this),new Co(0,0))}},{key:"_getWidth",value:function(e){return e.width}},{key:"_getHeight",value:function(e){return e.height}},{key:"_layoutFromLayoutDataRow",value:function(e,t){e.reduce((function(e,n){var i=n.margins(),r=n.insets(),o=n.layoutData.sizePx,s=new Fo(e-r.left-i.left,0,o+r.left+r.right,t.height);return n.setBounds(s),e+o}),0)}},{key:"_layoutFromLayoutDataColumn",value:function(e,t){e.reduce((function(e,n){var i=n.margins(),r=n.insets(),o=n.layoutData.sizePx,s=new Fo(0,e-r.top-i.top,t.width,o+r.top+r.bottom);return n.setBounds(s),e+o}),0)}}])&&Da(t.prototype,n),i&&Da(t,i),o}(zo);function Ia(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Ma,"Direction",{COLUMN:0,ROW:1});var La=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._prepare(),this.relative=!0,this.grow=1,this.shrink=1,this.initial=1,this.order=0,s.a.extend(this,t),this.sizePx,this.initialPx,this.delta}var t,n,i;return t=e,i=[{key:"fixed",value:function(t){var n=new e;return n.relative=!1,n.initial=t||-1,n.grow=0,n.shrink=0,n}}],(n=[{key:"_prepare",value:function(){}},{key:"withOrder",value:function(e){return this.order=e,this}},{key:"acceptDelta",value:function(e,t){return e>0?this._grow(e,t):this._shrink(e,t)}},{key:"validate",value:function(e){return 0===this.grow&&(e=Math.min(this.initialPx,e)),0===this.shrink&&(e=Math.max(this.initialPx,e)),e}},{key:"_grow",value:function(e,t){var n,i=0;return this.grow>0?i=e:this.initialPx>this.sizePx&&(i=this.initialPx-this.sizePx),n=Math.min(e,i),t&&(this.sizePx=this.sizePx+n),e-n}},{key:"_shrink",value:function(e,t){var n,i=0;return this.shrink>0?i=20-this.sizePx:this.initialPx<this.sizePx&&(i=this.initialPx-this.sizePx),n=Math.max(e,i),t&&(this.sizePx=this.sizePx+n),e-n}}])&&Ia(t.prototype,n),i&&Ia(t,i),e}();function Ba(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Na=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tabBox=null,this._viewAddHandler=this._onViewAdd.bind(this),this._viewRemoveHandler=this._onViewRemove.bind(this),this._viewActivateHandler=this._onViewActivate.bind(this),this._viewDeactivateHandler=this._onViewDeactivate.bind(this),this.tabArea=null,this._viewTabSelectHandler=this._onViewTabSelect.bind(this)}var t,n,i;return t=e,i=[{key:"hasViewTab",value:function(e){return oi.someProperties(e,["title","subTitle","iconId"])}}],(n=[{key:"init",value:function(e){s.a.extend(this,e)}},{key:"install",value:function(e,t){this.uninstall(),this.tabBox=O.assertParameter("tabBox",e),this.tabArea=O.assertParameter("tabArea",t||this.tabBox.tabArea),this._installListeners()}},{key:"uninstall",value:function(){this._uninstallListeners()}},{key:"_installListeners",value:function(){this.tabBox.on("viewAdd",this._viewAddHandler),this.tabBox.on("viewRemove",this._viewRemoveHandler),this.tabBox.on("viewActivate",this._viewActivateHandler),this.tabBox.on("viewDeactivate",this._viewDeactivateHandler),this.tabArea.on("tabSelect",this._viewTabSelectHandler)}},{key:"_uninstallListeners",value:function(){this.tabBox&&(this.tabBox.off("viewAdd",this._viewAddHandler),this.tabBox.off("viewRemove",this._viewRemoveHandler),this.tabBox.off("viewActivate",this._viewActivateHandler),this.tabBox.off("viewDeactivate",this._viewDeactivateHandler)),this.tabArea&&this.tabArea.off("tabSelect",this._viewTabSelectHandler)}},{key:"_onViewAdd",value:function(t){var n,i,r=t.view,o=t.siblingView;e.hasViewTab(r)&&((n=this._getTab(r))||(i=this._getTab(o),n=this._createTab(r),this.tabArea.addTab(n,i)))}},{key:"_onViewRemove",value:function(e){var t=e.view;if(t){var n=this._getTab(t);n&&this.tabArea.destroyTab(n)}}},{key:"_onViewActivate",value:function(e){var t=this._getTab(e.view);this.tabArea.selectTab(t)}},{key:"_onViewDeactivate",value:function(e){var t=this._getTab(e.view);this.tabArea.deselectTab(t)}},{key:"_onViewTabSelect",value:function(e){if(e.viewTab){var t=e.viewTab.view;this.tabBox.activateView(t)}}},{key:"_createTab",value:function(e){return O.create("SimpleTab",{parent:this.tabArea,view:e})}},{key:"_getTab",value:function(e){if(e){var t=null;return this.tabArea.getTabs().some((function(n){return n.view===e&&(t=n,!0)})),t}}},{key:"getTabs",value:function(){return this.tabArea.getTabs()}}])&&Ba(t.prototype,n),i&&Ba(t,i),e}();function Ha(e){return(Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Va(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wa(e,t,n){return(Wa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ka(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function za(e,t){return(za=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ga(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ka(e);if(t){var r=Ka(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ua(this,n)}}function Ua(e,t){return!t||"object"!==Ha(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ka(e){return(Ka=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&za(e,t)}(o,e);var t,n,i,r=Ga(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["tabArea"]),e.tabArea=null,e.viewStack=[],e.currentView=null,e.controller=null,e._removeViewInProgress=0,e}return t=o,(n=[{key:"_init",value:function(e){Wa(Ka(o.prototype),"_init",this).call(this,e),this.cssClass=e.cssClass,this.tabArea||(this.tabArea=O.create("SimpleTabArea",{parent:this})),this.controller||(this.controller=O.create("SimpleTabBoxController")),this.controller.install(this,this.tabArea),this._viewDestroyedHandler=this._onViewDestroyed.bind(this)}},{key:"_keyStrokeBindTarget",value:function(){return this.$container}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("simple-tab-box"),this.cssClass&&this.$container.addClass(this.cssClass),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new tu(this)),this.htmlComp.layoutData=this.layoutData,this.$viewContent=this.$container.appendDiv("tab-content"),this.viewContent=Uo.install(this.$viewContent,this.session),this.viewContent.setLayout(new uu(this))}},{key:"_renderProperties",value:function(){Wa(Ka(o.prototype),"_renderProperties",this).call(this),this._renderTabArea(),this._renderView(this.currentView)}},{key:"_renderTabArea",value:function(){this.tabArea.render(),this.$tabArea=this.tabArea.$container,this.tabArea.attached&&this.$tabArea.insertBefore(this.$viewContent)}},{key:"_renderView",value:function(e){e&&(e.rendered||(e.render(this.$viewContent),e.$container.addClass("view"),e.validateRoot=!0))}},{key:"postRender",value:function(){this.viewStack.length>0&&!this.currentView&&this.activateView(this.viewStack[this.viewStack.length-1])}},{key:"activateView",value:function(e){e!==this.currentView&&(this.currentView&&(this.currentView.detach(),this.trigger("viewDeactivate",{view:this.currentView}),this.currentView=null),this.rendered&&this._renderView(e),e.attached||e.attach(),this.currentView=e,this.trigger("viewActivate",{view:e}),this.revalidateLayout())}},{key:"setLayoutData",value:function(e){Wa(Ka(o.prototype),"setLayoutData",this).call(this,e),this.layoutData=e}},{key:"getLayoutData",value:function(){return this.layoutData}},{key:"revalidateLayout",value:function(){this.rendered&&(this.viewContent.invalidateLayoutTree(),this.viewContent.validateLayoutTree())}},{key:"addView",value:function(e,t){var n=O.nvl(t,!0),i=this._addToViewStack(e,n);e.setTrackFocus(!0),e.setParent(this),this.trigger("viewAdd",{view:e,siblingView:i}),n&&this.activateView(e)}},{key:"_addToViewStack",value:function(e,t){var n,i=this.viewStack.indexOf(e);if(i>-1)return this.viewStack[i-1];if(!Na.hasViewTab(e))return this.viewStack.unshift(e),this._addDestroyListener(e),n;if(!this.currentView||!t)return n=this.viewStack[this.viewStack.length-1],this.viewStack.push(e),this._addDestroyListener(e),n;var r=this.viewStack.indexOf(this.currentView);return n=this.viewStack[r],this.viewStack.splice(r+1,0,e),n}},{key:"_addDestroyListener",value:function(e){e.one("destroy",this._viewDestroyedHandler)}},{key:"_removeDestroyListener",value:function(e){e.off("destroy",this._viewDestroyedHandler)}},{key:"_onViewDestroyed",value:function(e){var t=e.source;et.remove(this.viewStack,t),this.currentView===t&&(this.rendered&&t.remove(),this.currentView=null)}},{key:"removeView",value:function(e,t){if(e){e.setTrackFocus(!1),t=O.nvl(t,!0);var n,i=this.viewStack.indexOf(e);this.currentView===e&&(this.currentView=null),i>-1&&(t&&(i-1>=0?n=this.viewStack[i-1]:i+1<this.viewStack.length&&(n=this.viewStack[i+1])),this.viewStack.splice(i,1),e.rendered&&(this._removeViewInProgress++,e.remove(),this._removeViewInProgress--),this.trigger("viewRemove",{view:e}),0===this._removeViewInProgress&&(n&&this.activateView(n),this.rendered&&(this.viewContent.invalidateLayoutTree(),this.viewContent.validateLayoutTree())))}}},{key:"getController",value:function(){return this.controller}},{key:"viewCount",value:function(){return this.viewStack.length}},{key:"hasViews",value:function(){return this.viewStack.length>0}},{key:"hasView",value:function(e){return this.viewStack.filter((function(t){return t===e})).length>0}},{key:"getViews",value:function(e){return this.viewStack.filter((function(t){return!e||e===t.displayViewId}))}}])&&Va(t.prototype,n),i&&Va(t,i),o}(de);function Ya(e){return(Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ja(e,t){return(Ja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Za(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=eu(e);if(t){var r=eu(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Qa(this,n)}}function Qa(e,t){return!t||"object"!==Ya(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eu(e){return(eu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ja(e,t)}(o,e);var t,n,i,r=Za(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tabBox=e,t}return t=o,(n=[{key:"layout",value:function(e){var t,n,i,r=Uo.get(e),o=Uo.get(this.tabBox.$viewContent);t=r.availableSize({exact:!0}).subtract(r.insets()),i=this._layoutTabArea(t),(n=t.subtract(o.margins())).height-=i.height,o.setSize(n)}},{key:"_layoutTabArea",value:function(e){if(!this.tabBox.rendered)return new Co(0,0);var t=Uo.get(this.tabBox.$tabArea),n=t.prefSize(),i=t.margins(),r=new Co(e.width,n.height+i.top+i.bottom);return t.setSize(r),r}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n=Uo.get(e),i=Uo.get(this.tabBox.$viewContent),r=Uo.get(this.tabBox.$tabArea),o=new Co,s=new Co;return t.heightHint=null,r.isVisible()&&(o=r.prefSize().add(r.margins())),s=i.prefSize(t).add(n.insets()).add(i.margins()),new Co(Math.max(o.width,s.width),s.height+o.height)}}])&&Xa(t.prototype,n),i&&Xa(t,i),o}(zo);function nu(e){return(nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ru(e,t){return(ru=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ou(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=au(e);if(t){var r=au(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return su(this,n)}}function su(e,t){return!t||"object"!==nu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function au(e){return(au=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ru(e,t)}(o,e);var t,n,i,r=ou(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tabBox=e,t}return t=o,(n=[{key:"layout",value:function(e){var t=this.tabBox.currentView;if(t&&t.rendered&&t.htmlComp){var n=Uo.get(e),i=n.availableSize({exact:!0}).subtract(n.insets()).subtract(t.htmlComp.margins());t.htmlComp.setSize(i)}}},{key:"preferredLayoutSize",value:function(e){var t=this.tabBox.currentView;if(!t||!t.rendered||!t.htmlComp)return new Co;var n=Uo.get(e);return t.htmlComp.prefSize().add(n.insets()).add(t.htmlComp.margins())}}])&&iu(t.prototype,n),i&&iu(t,i),o}(zo);var lu={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,ESCAPE:27,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,PRINT_SCREEN:44,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,WIN_LEFT:91,WIN_RIGHT:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL_POINT:110,DIVIDE:111,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,DASH:189,COMMA:188,POINT:190,FORWARD_SLASH:191,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222,ANGULAR_BRACKET:226,codesToKeys:{8:"Backspace",9:"Tab",13:"Enter",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSE",20:"Caps lock",27:"Esc",33:"Page up",34:"Page down",35:"End",36:"Home",37:"Left",38:"UP",39:"Right",40:"Down",32:"Space",44:"Print screen",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"WIN_LEFT",92:"WIN_RIGHT",93:"SELECT",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",96:"NUMPAD_0",97:"NUMPAD_1",98:"NUMPAD_2",99:"NUMPAD_3",100:"NUMPAD_4",101:"NUMPAD_5",102:"NUMPAD_6",103:"NUMPAD_7",104:"NUMPAD_8",105:"NUMPAD_9",106:"MULTIPLY",107:"+",109:"SUBTRACT",110:"DECIMAL_POINT",111:"/",144:"Num lock",145:"Scroll lock",186:"ü",189:"-",188:",",190:".",191:"§",219:"'",220:"ä",221:"^",222:"ö",226:"<"},browserMap:function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},Mt.Browser.FIREFOX,{226:60}),browserMapReverse:{},forBrowser:function(e){return lu.mapKey(lu.browserMap,e)},fromBrowser:function(e){return lu.mapKey(lu.browserMapReverse,e)},mapKey:function(e,t){var n=e[Mt.get().browser];return n&&n.hasOwnProperty(t)?n[t]:t}};for(var cu in lu.browserMap){var fu={},hu=lu.browserMap[cu];for(var du in hu){fu[hu[du]]=parseInt(du,10)}lu.browserMapReverse[cu]=fu}var pu=lu;function yu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var vu=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyStroke=t,this.which=n,this.ctrl=t.ctrl,this.alt=t.alt,this.shift=t.shift,this.keyStrokeMode=t.keyStrokeMode}var t,n,i;return t=e,(n=[{key:"render",value:function(e,t){return this.$drawingArea=this.keyStroke.renderKeyBox(e,t),!!this.$drawingArea}},{key:"remove",value:function(){this.keyStroke.removeKeyBox(this.$drawingArea),this.$drawingArea=null}},{key:"toKeyStrokeString",value:function(){var e="";this.ctrl&&(e+="Ctrl-"),this.alt&&(e+="Alt-"),this.shift&&(e+="Shift-");var t=pu.codesToKeys[this.which];return void 0===t&&(t=this.which),e+=t}}])&&yu(t.prototype,n),i&&yu(t,i),e}();function bu(e,t,n){if(!((n&e)>0))return(t&e)>0}var gu={ALT:16,ALT_UNDEFINED:32,CTRL:1,CTRL_UNDEFINED:2,NONE:0,SHIFT:4,SHIFT_UNDEFINED:8,isAlt:function(e){return bu(e,16,32)},isCtrl:function(e){return bu(e,1,2)},isShift:function(e){return bu(e,4,8)},toModifierBitMask:function(e){var t=0;return t|=e.ctrlKey?1:0,t|=e.altKey?16:0,t|=e.shiftKey?4:0}};function mu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _u=function(){function e(t,n,i,r,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.which=t,this.ctrlKey=n,this.metaKey=!1,this.altKey=i,this.shiftKey=r,this.target=s,this.type=o,this._propagationStopped=!1,this._immediatePropagationStopped=!1,this._defaultPrevented=!1}var t,n,i;return t=e,(n=[{key:"stopPropagation",value:function(){this._propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this._immediatePropagationStopped=!0}},{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"isPropagationStopped",value:function(){return this._propagationStopped}},{key:"isImmediatePropagationStopped",value:function(){return this._immediatePropagationStopped}},{key:"isDefaultPrevented",value:function(){return this._defaultPrevented}},{key:"isAnyPropagationStopped",value:function(){return this._propagationStopped||this._immediatePropagationStopped}}])&&mu(t.prototype,n),i&&mu(t,i),e}();function wu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ku=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=null,this.helpKeyStroke=$u.parseKeyStroke("F1"),this.swallowF1=!0,this._helpRendered=!1,this._renderedKeys=[],this.events=this._createEventSupport(),this.filters=[]}var t,n,i;return t=e,(n=[{key:"init",value:function(e){this.session=e.session,this.installTopLevelKeyStrokeHandlers(this.session.$entryPoint)}},{key:"installTopLevelKeyStrokeHandlers",value:function(e){var t=e.window(!0),n=function(e){return e.which!==pu.F1},i=function(e){return e.which!==pu.BACKSPACE};this.swallowF1&&e.keydown(n).keyup(n),e.keydown(i).keyup(i),"onhelp"in t&&(t.onhelp=Bi.returnFalse)}},{key:"installKeyStrokeContext",value:function(e){if(e&&!e._handler){if(!e.$getBindTarget())throw new Error("missing bind-target for KeyStrokeContext: "+e);e._handler=this._onKeyEvent.bind(this,e),e._handler.$target=e.$getBindTarget(),e._handler.$target.on("keydown",e._handler),e._handler.$target.on("keyup",e._handler)}}},{key:"uninstallKeyStrokeContext",value:function(e){e&&e._handler&&(e._handler.$target.off("keydown",e._handler),e._handler.$target.off("keyup",e._handler),e._handler.$target=null,e._handler=null)}},{key:"_renderKeys",value:function(e,t){var n=t.originalEvent.keyStrokeContexts||[],i=[];e.keyStrokes.filter((function(e){var t=e.renderingHints.render;return"function"==typeof t?t.call(e):t})).forEach((function(r){r.enabledByFilter=this._filter(r);var o=(r.field?r.field.$container:null)||e.$getScopeTarget();r.keys().forEach((function(s){var a=new _u(s.which,s.ctrl,s.alt,s.shift,s.keyStrokeMode,t.target);i.indexOf(s.toKeyStrokeString())<0&&e.accept(a)&&r.accept(a)&&!this._isPreventedByDescendantContext(s,t.target,n)&&(s.render(o,a)&&this._renderedKeys.push(s),a.isImmediatePropagationStopped()&&i.push(s.toKeyStrokeString()))}),this)}),this),n.push(e),t.originalEvent.keyStrokeContexts=n}},{key:"_isPreventedByDescendantContext",value:function(e,t,n){var i=new _u(e.which,e.ctrl,e.alt,e.shift,e.keyStrokeMode,t);return n.some((function(e){return e.accept(i),!!i.isAnyPropagationStopped()||e.keyStrokes.some((function(e){return e.accept(i),i.isAnyPropagationStopped()}),this)}),this)}},{key:"_handleKeyStrokeEvent",value:function(e,t){e.accept(t)&&(e.keyStrokes.length<1||(t.which>=96&&t.which<=105&&(t.which=t.which-48),e.keyStrokes.slice().some((function(n){return!!n.accept(t)&&(this.invokeAcceptInputOnActiveValueField(n,e)&&GV.invokeValueFieldAcceptInput(t.target),!this._filter(n)||(this.trigger("keyStroke",{keyStroke:n,keyStrokeContext:e}),n.invokeHandle(t),t.isImmediatePropagationStopped()))}),this)))}},{key:"_filter",value:function(e){for(var t=0;t<this.filters.length;t++)if(!this.filters[t].filter(e))return!1;return!0}},{key:"invokeAcceptInputOnActiveValueField",value:function(e,t){return!e.preventInvokeAcceptInputOnActiveValueField&&(e.invokeAcceptInputOnActiveValueField||t.invokeAcceptInputOnActiveValueField)}},{key:"_isHelpKeyStroke",value:function(e){return $u.acceptEvent(this.helpKeyStroke,e)}},{key:"_installHelpDisposeListener",value:function(e){var t,n=s()(e.currentTarget),i=n.window(),r=n.entryPoint();return t=function(){r.off("keyup",t),i.off("blur",t),this._helpRendered=!1,this._renderedKeys.forEach((function(e){e.remove()})),this._renderedKeys=[]}.bind(this),r.on("keyup",t),i.on("blur",t),!1}},{key:"_onKeyEvent",value:function(e,t){if(this.session.focusManager.isElementCovertByGlassPane(e.$getScopeTarget())){var n=s.a.grep(e.keyStrokes,(function(e){return e.keyStrokeFirePolicy===Eh.KeyStrokeFirePolicy.ALWAYS}));if(0===n.length)return;(e=e.clone()).keyStrokes=n}this._isHelpKeyStroke(t)?!t.originalEvent.renderingHelp&&this._helpRendered||(t.originalEvent.renderingHelp=!0,this._helpRendered=!0,this._installHelpDisposeListener(t),this._renderKeys(e,t)):this._handleKeyStrokeEvent(e,t)}},{key:"addFilter",value:function(e){et.pushSet(this.filters,e)}},{key:"removeFilter",value:function(e){et.remove(this.filters,e)}},{key:"_createEventSupport",value:function(){return new Yt}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}}])&&wu(t.prototype,n),i&&wu(t,i),e}();function Su(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ou=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$bindTarget=null,this.$scopeTarget=null,this.keyStrokes=[],this.stopPropagationInterceptors=[],this._stopPropagationKeys={},this.invokeAcceptInputOnActiveValueField=!1,t=t||{},s.a.extend(this,t)}var t,n,i;return t=e,(n=[{key:"registerStopPropagationKeys",value:function(e,t){this._stopPropagationKeys[e]=this._stopPropagationKeys[e]||[],et.pushAll(this._stopPropagationKeys[e],t)}},{key:"registerStopPropagationInterceptor",value:function(e){this.stopPropagationInterceptors.push(e)}},{key:"accept",value:function(e){return!!this._accept(e)&&(this._applyPropagationFlags(e),!0)}},{key:"_applyPropagationFlags",value:function(e){var t=gu.toModifierBitMask(e),n=this._stopPropagationKeys[t];n&&O.isOneOf(e.which,n)&&e.stopPropagation(),this.stopPropagationInterceptors.forEach((function(t){t(e)}),this)}},{key:"_accept",value:function(e){return!0}},{key:"registerKeyStroke",value:function(e){this.registerKeyStrokes(e)}},{key:"registerKeyStrokes",value:function(e){et.ensure(e).map(this._resolveKeyStroke,this).filter((function(e){return-1===this.keyStrokes.indexOf(e)}),this).forEach((function(e){this.keyStrokes.push(e),e.field&&!e.destroyListener&&(e.destroyListener=function(t){this.unregisterKeyStroke(e),e.destroyListener=null}.bind(this),e.field.one("destroy",e.destroyListener))}),this)}},{key:"unregisterKeyStroke",value:function(e){this.unregisterKeyStrokes(e)}},{key:"unregisterKeyStrokes",value:function(e){et.ensure(e).map(this._resolveKeyStroke,this).forEach((function(e){et.remove(this.keyStrokes,e)&&e.field&&e.destroyListener&&(e.field.off("destroy",e.destroyListener),e.destroyListener=null)}),this)}},{key:"_resolveKeyStroke",value:function(e){if(e instanceof $u)return e;if(e instanceof Eh)return e.actionKeyStroke;throw new Error("unsupported keystroke: "+e)}},{key:"$getBindTarget",value:function(){return"function"==typeof this.$bindTarget?this.$bindTarget():this.$bindTarget}},{key:"$getScopeTarget",value:function(){return"function"==typeof this.$scopeTarget?this.$scopeTarget():this.$scopeTarget}},{key:"clone",value:function(){return new e(oi.copyOwnProperties(this,{}))}}])&&Su(t.prototype,n),i&&Su(t,i),e}();function Tu(e){return(Tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pu(e,t,n){return(Pu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Du(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ru(e,t){return(Ru=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Du(e);if(t){var r=Du(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Eu(this,n)}}function Eu(e,t){return!t||"object"!==Tu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Du(e){return(Du=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ru(e,t)}(o,e);var t,n,i,r=xu(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).invokeAcceptInputOnActiveValueField=!0,e.registerStopPropagationKeys(gu.CTRL,[pu.A,pu.C,pu.Y,pu.V,pu.Z,pu.RIGHT,pu.BACKSPACE,pu.LEFT,pu.HOME,pu.END,pu.NUMPAD_4,pu.NUMPAD_6]),e.registerStopPropagationKeys(gu.CTRL|gu.SHIFT,[pu.RIGHT,pu.BACKSPACE,pu.LEFT,pu.HOME,pu.END,pu.NUMPAD_4,pu.NUMPAD_6]),e.registerStopPropagationKeys(gu.SHIFT,[pu.RIGHT,pu.BACKSPACE,pu.LEFT,pu.HOME,pu.END,pu.NUMPAD_4,pu.NUMPAD_6]),e.registerStopPropagationKeys(gu.NONE,[pu.SEMICOLON,pu.DASH,pu.COMMA,pu.POINT,pu.FORWARD_SLASH,pu.OPEN_BRACKET,pu.BACK_SLASH,pu.CLOSE_BRACKET,pu.SINGLE_QUOTE,pu.MULTIPLY,pu.ADD,pu.SUBTRACT,pu.DECIMAL_POINT,pu.DIVIDE,pu.NUMPAD_0,pu.NUMPAD_1,pu.NUMPAD_2,pu.NUMPAD_3,pu.NUMPAD_4,pu.NUMPAD_5,pu.NUMPAD_6,pu.NUMPAD_7,pu.NUMPAD_8,pu.NUMPAD_9,pu.MULTIPLY,pu.END,pu.HOME,pu.RIGHT,pu.BACKSPACE,pu.LEFT,pu.DELETE,pu.SPACE]),e}return t=o,(n=[{key:"_applyPropagationFlags",value:function(e){Pu(Du(o.prototype),"_applyPropagationFlags",this).call(this,e),e.isPropagationStopped()||(s()(e.target).is("input:text")||s()(e.target).is("input:file")||s()(e.target).is("textarea"))&&(this._isLetterKeyStroke(e)||this._isNumberKeyStroke(e))&&e.stopPropagation()}},{key:"_isNumberKeyStroke",value:function(e){return!e.ctrlKey&&e.which>=pu[0]&&e.which<=pu[9]}},{key:"_isLetterKeyStroke",value:function(e){return!e.ctrlKey&&e.which>=pu.A&&e.which<=pu.Z}}])&&Cu(t.prototype,n),i&&Cu(t,i),o}(Ou);function Au(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=null,this.which=[],this.ctrl=!1,this.alt=!1,this.shift=!1,this.preventDefault=!0,this.stopPropagation=!1,this.stopImmediatePropagation=!1,this.keyStrokeMode=e.Mode.DOWN,this.repeatable=!1,this._handleExecuted=!1,this.keyStrokeFirePolicy=Eh.KeyStrokeFirePolicy.ACCESSIBLE_ONLY,this.enabledByFilter=!0,this.renderingHints={render:function(){return!this.field||void 0===this.field.rendered||this.field.rendered}.bind(this),gap:4,offset:4,hAlign:Ni.LEFT,text:null,$drawingArea:function(e,t){return e}},this.invokeAcceptInputOnActiveValueField=!1,this.preventInvokeAcceptInputOnActiveValueField=!1}var t,n,i;return t=e,i=[{key:"parseKeyStroke",value:function(e){if(!e)return null;var t={alt:!1,ctrl:!1,shift:!1,which:[]};return e.split("-").forEach((function(e){if("alternate"===e||"alt"===e)t.alt=!0;else if("control"===e||"ctrl"===e)t.ctrl=!0;else if("shift"===e)t.shift=!0;else{var n=pu[e.toUpperCase()];t.which=n&&[n]}})),t}},{key:"acceptEvent",value:function(t,n){return!!t&&e._acceptModifier(t.ctrl,n.ctrlKey||n.metaKey)&&e._acceptModifier(t.alt,n.altKey)&&e._acceptModifier(t.shift,n.shiftKey)&&O.isOneOf(n.which,t.which)}},{key:"_acceptModifier",value:function(e,t){return void 0===e||e===t}}],(n=[{key:"parseAndSetKeyStroke",value:function(t){this.alt=!1,this.ctrl=!1,this.shift=!1,this.which=[],t&&s.a.extend(this,e.parseKeyStroke(t))}},{key:"accept",value:function(e){return!!this._isEnabled()&&!!this._accept(e)&&(this._applyPropagationFlags(e),e.type===this.keyStrokeMode)}},{key:"handle",value:function(e){throw new Error("keystroke event not handled: "+e)}},{key:"invokeHandle",value:function(t){if(this.repeatable)this.handle(t);else if(!this._handleExecuted&&(this.handle(t),t.type===e.Mode.DOWN)){this._handleExecuted=!0;var n=s()(t.target).window(),i=this,r={handleEvent:function(e){i._handleExecuted=!1,n[0].removeEventListener("keyup",this,!0)}};n[0].addEventListener("keyup",r,!0)}}},{key:"_isEnabled",value:function(){if(this.field){if(void 0!==this.field.visible&&!this.field.visible)return!1;if(void 0!==this.field.enabled&&!this.field.enabled)return!1}return!0}},{key:"_accept",value:function(t){return e.acceptEvent(this,t)}},{key:"_applyPropagationFlags",value:function(e){this.stopPropagation&&e.stopPropagation(),this.stopImmediatePropagation&&e.stopImmediatePropagation(),this.preventDefault&&e.preventDefault()}},{key:"keys",value:function(){return this.which.map((function(e){return new vu(this,e)}),this)}},{key:"renderKeyBox",value:function(e,t){if(!(e=this.renderingHints.$drawingArea(e,t))||!e.length)return null;var n=this._renderKeyBox(e,t.which);return this._postRenderKeyBox(e,n),e}},{key:"_renderKeyBox",value:function(e,t){var n=s()(".key-box",e),i=this.renderingHints.text||pu.codesToKeys[pu.fromBrowser(t)],r=this.renderingHints.hAlign===Ni.RIGHT?"right":"left",o=this.renderingHints.offset;if((n=n.filter((function(){return"right"===r?s()(this).hasClass("right"):!s()(this).hasClass("right")}))).length>0){var a=n.first();o=this.renderingHints.hAlign===Ni.RIGHT?e.outerWidth()-a.position().left+this.renderingHints.gap:a.position().left+this.renderingHints.gap+a.outerWidth()}this.shift&&(i="Shift "+i),this.alt&&(i="Alt "+i),this.ctrl&&(i="Ctrl "+i);var u=e.css("position");if("absolute"===u||"relative"===u||"static"===u&&n.length>0)return c.call(this,o);var l=e.position();if(l)return c.call(this,l.left+o);function c(t){return e.prependDiv("key-box",i).css(r,t+"px").toggleClass("disabled",!this.enabledByFilter).addClass(r)}s.a.log.warn("(keys#drawSingleKeyBoxItem) pos is undefined. $parent="+e)}},{key:"_postRenderKeyBox",value:function(e){}},{key:"removeKeyBox",value:function(e){e&&(s()(".key-box",e).remove(),s()(".key-box-additional",e).remove())}}])&&Au(t.prototype,n),i&&Au(t,i),e}();function ju(e){return(ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Iu(e,t){return(Iu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Nu(e);if(t){var r=Nu(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Bu(this,n)}}function Bu(e,t){return!t||"object"!==ju(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nu(e){return(Nu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}($u,"Mode",{UP:"keyup",DOWN:"keydown"});var Hu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iu(e,t)}(o,e);var t,n,i,r=Lu(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).ranges=[],e}return t=o,(n=[{key:"registerRange",value:function(e,t){this.ranges.push({from:e,to:t})}},{key:"_accept",value:function(e){return(e.ctrlKey||e.metaKey)===this.ctrl&&e.altKey===this.alt&&e.shiftKey===this.shift&&this.ranges.some((function(t){return e.which>=this._getRangeFrom(t)&&e.which<=this._getRangeTo(t)}),this)}},{key:"keys",value:function(){var e=[];return this.ranges.forEach((function(t){for(var n=this._getRangeFrom(t),i=this._getRangeTo(t),r=n;r<=i;r++)e.push(new vu(this,r))}),this),e}},{key:"_getRangeFrom",value:function(e){return"function"==typeof e.from?e.from():e.from}},{key:"_getRangeTo",value:function(e){return"function"==typeof e.to?e.to():e.to}}])&&Mu(t.prototype,n),i&&Mu(t,i),o}($u);function Vu(e){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zu(e,t){return(zu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=qu(e);if(t){var r=qu(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Uu(this,n)}}function Uu(e,t){return!t||"object"!==Vu(t)&&"function"!=typeof t?Ku(e):t}function Ku(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qu(e){return(qu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zu(e,t)}(o,e);var t,n,i,r=Gu(o);function o(e,t,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this))._contextFunction=t,i._bindObject=n||Ku(i),i.field=e,i.renderingHints.render=!1,i.which=[pu.SELECT],i.ctrl=!1,i.shift=!1,i.stopPropagation=!0,i}return t=o,(n=[{key:"handle",value:function(e){this._contextFunction.call(this._bindObject,e)}}])&&Wu(t.prototype,n),i&&Wu(t,i),o}($u);function Xu(e){return(Xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ju(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zu(e,t,n){return(Zu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nl(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Qu(e,t){return(Qu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function el(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=nl(e);if(t){var r=nl(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return tl(this,n)}}function tl(e,t){return!t||"object"!==Xu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nl(e){return(nl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var il=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qu(e,t)}(o,e);var t,n,i,r=el(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).field=e,n.which=t,n.stopPropagation=!0,n.renderingHints.render=!0,n.renderingHints.$drawingArea=function(e,t){return t._$activeElement},n}return t=o,(n=[{key:"_accept",value:function(e){return!!Zu(nl(o.prototype),"_accept",this).call(this,e)&&(e._$activeElement=this.field.$container.activeElement(),!0)}},{key:"handle",value:function(e){e._$activeElement.trigger({type:"click",which:1})}}])&&Ju(t.prototype,n),i&&Ju(t,i),o}($u);function rl(e){return(rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ol(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sl(e,t){return(sl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function al(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ll(e);if(t){var r=ll(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ul(this,n)}}function ul(e,t){return!t||"object"!==rl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ll(e){return(ll=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sl(e,t)}(o,e);var t,n,i,r=al(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).session=e,n.field=t,n.which=[pu.LEFT,pu.RIGHT],n.renderingHints.render=!1,n.stopPropagation=!0,n.keyStrokeMode=$u.Mode.DOWN,n}return t=o,(n=[{key:"handle",value:function(e){var t=this.field.$container.activeElement(!0),n=this.field.$container.find(":focusable");switch(e.which){case pu.RIGHT:t===n.last()[0]?this.session.focusManager.requestFocus(n.first()):this.session.focusManager.requestFocus(n[n.index(t)+1]);break;case pu.LEFT:t===n.first()[0]?this.session.focusManager.requestFocus(n.last()):this.session.focusManager.requestFocus(n[n.index(t)-1])}}}])&&ol(t.prototype,n),i&&ol(t,i),o}($u);function fl(e){return(fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dl(e,t){return(dl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=vl(e);if(t){var r=vl(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return yl(this,n)}}function yl(e,t){return!t||"object"!==fl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vl(e){return(vl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dl(e,t)}(o,e);var t,n,i,r=pl(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).field=e,n.which=[pu.ESC],n.renderingHints.render=!0,n.stopPropagation=!0,n.renderingHints={render:!!t,$drawingArea:t},n}return t=o,(n=[{key:"handle",value:function(e){this.field.close()}}])&&hl(t.prototype,n),i&&hl(t,i),o}($u);function gl(e){return(gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ml(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _l(e,t){return(_l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Sl(e);if(t){var r=Sl(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return kl(this,n)}}function kl(e,t){return!t||"object"!==gl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sl(e){return(Sl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ol=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_l(e,t)}(o,e);var t,n,i,r=wl(o);function o(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e,t)}return t=o,(n=[{key:"handle",value:function(e){this.field.abort()}}])&&ml(t.prototype,n),i&&ml(t,i),o}(bl);function Tl(e){return(Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pl(e,t){return(Pl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Dl(e);if(t){var r=Dl(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xl(this,n)}}function xl(e,t){return!t||"object"!==Tl(t)&&"function"!=typeof t?El(e):t}function El(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dl(e){return(Dl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pl(e,t)}(o,e);var t,n,i,r=Rl(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).field=t,n.parseAndSetKeyStroke(e),n.renderingHints.offset=16,n.renderingHints.hAlign=Ni.RIGHT,n.renderingHints.$drawingArea=function(e,t){return this.field.$tabContainer}.bind(El(n)),n}return t=o,(n=[{key:"handle",value:function(e){this.field.parent.setSelectedTab(this.field)}}])&&Cl(t.prototype,n),i&&Cl(t,i),o}($u);function Al(e){return(Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jl(e,t,n){return(jl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Nl(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ml(e,t){return(Ml=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Il(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Nl(e);if(t){var r=Nl(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ll(this,n)}}function Ll(e,t){return!t||"object"!==Al(t)&&"function"!=typeof t?Bl(e):t}function Bl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nl(e){return(Nl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ml(e,t)}(o,e);var t,n,i,r=Il(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).comparator=null,e.collapseStyle=null,e.exclusiveExpand=!0,e.groups=[],e.scrollable=!0,e.$container=null,e.htmlComp=null,e._addWidgetProperties(["groups"]),e._groupPropertyChangeHandler=e._onGroupPropertyChange.bind(Bl(e)),e}return t=o,(n=[{key:"_init",value:function(e){jl(Nl(o.prototype),"_init",this).call(this,e),this._initGroups(this.groups),this._setExclusiveExpand(this.exclusiveExpand)}},{key:"_createLoadingSupport",value:function(){return new te({widget:this})}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("accordion"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}},{key:"_createLayout",value:function(){return new ka}},{key:"_renderProperties",value:function(){jl(Nl(o.prototype),"_renderProperties",this).call(this),this._renderScrollable(),this._renderGroups()}},{key:"insertGroup",value:function(e){this.insertGroups([e])}},{key:"insertGroups",value:function(e){e=et.ensure(e),this.setGroups(this.groups.concat(e))}},{key:"deleteGroup",value:function(e){this.deleteGroups([e])}},{key:"deleteGroups",value:function(e){e=et.ensure(e);var t=this.groups.slice();et.removeAll(t,e),this.setGroups(t)}},{key:"deleteAllGroups",value:function(){this.setGroups([])}},{key:"_initGroups",value:function(e){this.groups.forEach((function(e){this._initGroup(e)}),this)}},{key:"setGroups",value:function(e){if(e=et.ensure(e),!oi.equals(this.groups,e)){e=this._createChildren(e);var t=et.diff(this.groups,e),n=et.diff(e,this.groups);this._deleteGroups(t),this._insertGroups(n),this._sort(e),this._updateGroupOrder(e),this._setProperty("groups",e),n.length>0&&this._updateExclusiveExpand(),this.rendered&&(this._updateFirstLastMarker(),this.invalidateLayoutTree())}}},{key:"_insertGroups",value:function(e){e.forEach((function(e){this._insertGroup(e)}),this)}},{key:"_insertGroup",value:function(e){this._initGroup(e),this.rendered&&this._renderGroup(e)}},{key:"_initGroup",value:function(e){e.setParent(this),e.on("propertyChange",this._groupPropertyChangeHandler),null!==this.collapseStyle&&e.setCollapseStyle(this.collapseStyle),this.setProperty("collapseStyle",e.collapseStyle)}},{key:"_renderGroup",value:function(e){e.render()}},{key:"_deleteGroups",value:function(e){e.forEach((function(e){this._deleteGroup(e)}),this)}},{key:"_deleteGroup",value:function(e){e.off("propertyChange",this._groupPropertyChangeHandler),e.owner===this?e.destroy():this.rendered&&e.remove()}},{key:"_renderGroups",value:function(){this.groups.forEach((function(e){this._renderGroup(e)}),this),this._updateFirstLastMarker(),this.invalidateLayoutTree()}},{key:"setComparator",value:function(e){this.comparator!==e&&(this.comparator=e)}},{key:"sort",value:function(){var e=this.groups.slice();this._sort(e),this._updateGroupOrder(e),this._setProperty("groups",e)}},{key:"_sort",value:function(e){null!==this.comparator&&e.sort(this.comparator)}},{key:"_updateGroupOrder",value:function(e){if(this.rendered){var t=!1;e.forEach((function(e,n){(this.groups[n]!==e||t)&&(t=!0,e.$container.appendTo(this.$container))}),this)}}},{key:"_updateFirstLastMarker",value:function(){ye.updateFirstLastMarker(this.groups)}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this.scrollable?this._installScrollbars({axis:"y"}):this._uninstallScrollbars(),this.$container.toggleClass("scrollable",this.scrollable),this.invalidateLayoutTree()}},{key:"getFocusableElement",value:function(){var e=ye.findFirstFocusableWidget(this.groups,this);return e?e.getFocusableElement():null}},{key:"setExclusiveExpand",value:function(e){this.setProperty("exclusiveExpand",e)}},{key:"_setExclusiveExpand",value:function(e){this._setProperty("exclusiveExpand",e),this._updateExclusiveExpand()}},{key:"_updateExclusiveExpand",value:function(){if(this.exclusiveExpand){var e=et.find(this.groups,(function(e){return e.visible&&!e.collapsed}));this._collapseOthers(e)}}},{key:"setCollapseStyle",value:function(e){this.groups.forEach((function(t){t.setCollapseStyle(e)})),this.setProperty("collapseStyle",e)}},{key:"_collapseOthers",value:function(e){e&&e.collapsible&&this.groups.forEach((function(t){t!==e&&t.collapsible&&t.setCollapsed(!0)}))}},{key:"_onGroupPropertyChange",value:function(e){"collapsed"===e.propertyName?this._onGroupCollapsedChange(e):"visible"===e.propertyName&&this._updateFirstLastMarker()}},{key:"_onGroupCollapsedChange",value:function(e){!e.newValue&&this.exclusiveExpand&&this._collapseOthers(e.source)}}])&&$l(t.prototype,n),i&&$l(t,i),o}(de);function Vl(e){return(Vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wl(e,t){return(Wl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ul(e);if(t){var r=Ul(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gl(this,n)}}function Gl(e,t){return!t||"object"!==Vl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ul(e){return(Ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wl(e,t)}(n,e);var t=zl(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(fe);function ql(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Yl=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new Error("Missing $parent");t.addClass("box-buttons"),this._$parent=t,this._onClickHandler=n,this._$buttons=[]}var t,n,i;return t=e,(n=[{key:"addButton",value:function(e){e=e||{};var t=this._$parent.appendDiv().text(e.text).addClass("box-button").unfocusable().setEnabled(O.nvl(e.enabled,!0));if(e.needsClick&&t.addClass("needsclick"),Mt.get().supportsOnlyTouch()||t.attr("tabindex",e.tabIndex||"0"),e.onClick){var n=e.onClick;t.on("click",(function(e){s.a.suppressEventIfDisabled(e)||n(e)}))}else this._onClickHandler&&t.on("click",this._onClick.bind(this));return t.data("buttonOption",e.option),this._$buttons.push(t),t}},{key:"_onClick",value:function(e){var t=s()(e.target);s.a.suppressEventIfDisabled(e,t)||this._onClickHandler(e,t.data("buttonOption"))}},{key:"updateButtonWidths",value:function(e){var t=[];this._$buttons.forEach((function(e){e.isVisible()&&t.push(e)}));var n=t.length>0;this._$parent.toggleClass("empty",!n),e=e||this._$parent.width();var i=Math.floor(e/t.length);t.forEach((function(n,r){r===t.length-1?i=e:e-=i,n.outerWidth(i)}))}},{key:"buttonCount",value:function(){return this._$buttons.length}}])&&ql(t.prototype,n),i&&ql(t,i),e}();function Xl(e){return(Xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zl(e,t,n){return(Zl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nc(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ql(e,t){return(Ql=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ec(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=nc(e);if(t){var r=nc(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return tc(this,n)}}function tc(e,t){return!t||"object"!==Xl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nc(e){return(nc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ic=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ql(e,t)}(o,e);var t,n,i,r=ec(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["widgets"]),e.statusEnabled=!0,e.statusItemHtml="&bull;",e.currentItem=0,e.moveThreshold=.25,e.widgets=[],e.$carouselFilmstrip,e.$carouselItems=[],e.$carouselStatus,e.$carouselStatusItems=[],e.positionX=0,e}return t=o,(n=[{key:"_init",value:function(e){Zl(nc(o.prototype),"_init",this).call(this,e),this._setGridData(this.gridData),this.widgets=et.ensure(this.widgets)}},{key:"_setGridData",value:function(e){this._setProperty("gridData",new kV(e))}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("carousel"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new cc(this)),this.$carouselFilmstrip=this.$container.appendDiv("carousel-filmstrip"),this._registerCarouselFilmstripEventListeners(),this.htmlCompFilmstrip=Uo.install(this.$carouselFilmstrip,this.session)}},{key:"_remove",value:function(){this._removeStatus(),Zl(nc(o.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){Zl(nc(o.prototype),"_renderProperties",this).call(this),this._renderWidgets(),this._renderCurrentItem(),this._renderStatusEnabled()}},{key:"setStatusEnabled",value:function(e){this.setProperty("statusEnabled",e)}},{key:"_renderStatusEnabled",value:function(){this.statusEnabled?(this._renderStatus(),this._renderStatusItems(),this._renderCurrentStatusItem()):this._removeStatus(),this.invalidateLayoutTree()}},{key:"_renderStatus",value:function(){this.$carouselStatus||(this.$carouselStatus=this.$container.appendDiv("carousel-status"),this.htmlCompStatus=Uo.install(this.$carouselStatus,this.session))}},{key:"_removeStatus",value:function(){this.$carouselStatus&&(this.$carouselStatus.remove(),this.$carouselStatus=null)}},{key:"_renderStatusItems",value:function(){this.$carouselStatus&&(this.$carouselStatusItems=[],this.$carouselStatus.empty(),this.$carouselItems.forEach(function(){var e=this.$carouselStatus.appendDiv("status-item");e.html(this.statusItemHtml),this.$carouselStatusItems.push(e)}.bind(this)))}},{key:"_renderCurrentStatusItem",value:function(){this.$carouselStatus&&this.$carouselStatusItems.forEach(function(e,t){e.toggleClass("current-item",t===this.currentItem)}.bind(this))}},{key:"recalcTransformation",value:function(){this.positionX=this.currentItem*this.$container.width()*-1,this.$carouselFilmstrip.css({transform:"translateX("+this.positionX+"px)"})}},{key:"setCurrentItem",value:function(e){this.setProperty("currentItem",e)}},{key:"_renderCurrentItem",value:function(){this._renderItemsInternal(void 0,!1),this._renderCurrentStatusItem(),this.invalidateLayoutTree()}},{key:"_renderItemsInternal",value:function(e,t){e=e||this.currentItem,t||this.widgets.forEach((function(t,n){t.rendered&&(n<e-1||n>e+1)&&t.remove()}),this);for(var n=Math.max(e-1,0);n<Math.min(e+2,this.widgets.length);n++){var i=this.widgets[n];i.rendered||(i.render(this.$carouselItems[n]),i.htmlComp.revalidateLayout())}}},{key:"setWidgets",value:function(e){this.setProperty("widgets",e)}},{key:"_renderWidgets",value:function(){this.$carouselFilmstrip.empty(),this.$carouselItems=this.widgets.map((function(e){var t=this.$carouselFilmstrip.appendDiv("carousel-item");return Uo.install(t,this.session).setLayout(new xa),e.cssClassAsArray().forEach((function(e){t.addClass(e+"-carousel-item")})),t}),this),this._renderStatusItems(),this.setCurrentItem(0)}},{key:"_registerCarouselFilmstripEventListeners",value:function(){var e=this.$carouselFilmstrip.window();this.$carouselFilmstrip.on("mousedown touchstart",function(t){var n=Ft.pageX(t),i=this.positionX,r=this.$container.width()-this.$carouselFilmstrip.width(),o=this.$container.width();e.on("mousemove.carouselDrag touchmove.carouselDrag",function(e){var t=Ft.pageX(e),s=i+(t-n);if(s!==this.positionX&&s<=0&&s>=r){this.$carouselFilmstrip.css({transform:"translateX("+s+"px)"}),this.positionX=s;var a=s/o*-1;this._renderItemsInternal(s<i?Math.floor(a):Math.ceil(a),!0)}}.bind(this)),e.on("mouseup.carouselDrag touchend.carouselDrag touchcancel.carouselDrag",function(t){e.off(".carouselDrag");var n=this.positionX%o,r=this.currentItem;this.positionX<i&&n/o<0-this.moveThreshold?r=Math.ceil(this.positionX/o*-1):this.positionX>i&&n/o>=this.moveThreshold-1&&(r=Math.floor(this.positionX/o*-1)),this.setCurrentItem(r),0!==n&&(this.positionX=r*o*-1,this.recalcTransformation())}.bind(this))}.bind(this))}}])&&Jl(t.prototype,n),i&&Jl(t,i),o}(de);function rc(e){return(rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sc(e,t){return(sc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ac(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=lc(e);if(t){var r=lc(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return uc(this,n)}}function uc(e,t){return!t||"object"!==rc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lc(e){return(lc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sc(e,t)}(o,e);var t,n,i,r=ac(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).carousel=e,t}return t=o,(n=[{key:"layout",value:function(e){this.carousel.recalcTransformation();var t=this.carousel.htmlComp.availableSize().subtract(this.carousel.htmlComp.insets()).subtract(this.carousel.htmlCompFilmstrip.margins()),n=this.carousel.htmlComp.availableSize().subtract(this.carousel.htmlComp.insets()).subtract(this.carousel.htmlCompFilmstrip.margins());if(this.carousel.statusEnabled&&this.carousel.htmlCompStatus){var i=this.carousel.htmlCompStatus.size().add(this.carousel.htmlCompStatus.margins());t.height-=i.height,n.height-=i.height}var r=this.carousel.$carouselItems;t.width=r.length*t.width,this.carousel.htmlCompFilmstrip.setSize(t),r.forEach((function(e){Uo.get(e).setSize(n)}))}},{key:"preferredLayoutSize",value:function(e){var t=this.carousel.currentItem,n=new Co(1,1);return t<this.carousel.$carouselItems.length&&t>=0&&(n=Uo.get(this.carousel.$carouselItems[t]).prefSize()),n.height+=this.carousel.htmlCompStatus.size().height,n}}])&&oc(t.prototype,n),i&&oc(t,i),o}(zo);function fc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var hc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cssClass=null,this.editable=null,this.errorStatus=null,this.horizontalAlignment=null,this.htmlEnabled=null,this.iconId=null,this.mandatory=null,this._cachedEncodedText=null,this.text=null,this.value=null,this.tooltipText=null}var t,n,i;return t=e,(n=[{key:"init",value:function(e){this._init(e)}},{key:"_init",value:function(e){s.a.extend(this,e)}},{key:"update",value:function(e){this.setText(e.text),s.a.extend(this,e)}},{key:"setEditable",value:function(e){this.editable=e}},{key:"setMandatory",value:function(e){this.mandatory=e}},{key:"setHorizontalAlignment",value:function(e){this.horizontalAlignment=e}},{key:"setValue",value:function(e){this.value=e}},{key:"setErrorStatus",value:function(e){this.errorStatus=e}},{key:"setText",value:function(e){var t=this.text;this.text=e,t!==this.text&&(this._cachedEncodedText=null)}},{key:"encodedText",value:function(){return this._cachedEncodedText||(this._cachedEncodedText=En.encode(this.text)),this._cachedEncodedText}},{key:"setCssClass",value:function(e){this.cssClass=e}}])&&fc(t.prototype,n),i&&fc(t,i),e}();function dc(e){return(dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yc(e,t,n){return(yc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mc(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function vc(e,t){return(vc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mc(e);if(t){var r=mc(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gc(this,n)}}function gc(e,t){return!t||"object"!==dc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mc(e){return(mc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vc(e,t)}(o,e);var t,n,i,r=bc(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).leftVisible=!0,e.rightVisible=!0,e.horizontalAlignment=o.HorizontalAlignment.LEFT,e}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("collapse-handle"),this.$container.on("mousedown",this._onMouseDown.bind(this)),this.$left=this.$container.appendDiv("collapse-handle-body left"),this.$right=this.$container.appendDiv("collapse-handle-body right")}},{key:"_renderProperties",value:function(){yc(mc(o.prototype),"_renderProperties",this).call(this),this._renderLeftVisible(),this._renderRightVisible(),this._renderHorizontalAlignment()}},{key:"setHorizontalAlignment",value:function(e){this.setProperty("horizontalAlignment",e)}},{key:"_renderHorizontalAlignment",value:function(){this.$container.removeClass("left-aligned right-aligned"),this.horizontalAlignment===o.HorizontalAlignment.LEFT?this.$container.addClass("left-aligned"):this.horizontalAlignment===o.HorizontalAlignment.RIGHT&&this.$container.addClass("right-aligned")}},{key:"setLeftVisible",value:function(e){this.setProperty("leftVisible",e)}},{key:"_renderLeftVisible",value:function(){this.$left.setVisible(this.leftVisible),this._updateVisibilityClasses()}},{key:"setRightVisible",value:function(e){this.setProperty("rightVisible",e)}},{key:"_renderRightVisible",value:function(){this.$right.setVisible(this.rightVisible),this._updateVisibilityClasses()}},{key:"_updateVisibilityClasses",value:function(){var e=this.leftVisible&&this.rightVisible;this.$container.toggleClass("both-visible",e),this.$left.toggleClass("both-visible",e),this.$right.toggleClass("both-visible",e),this.$container.toggleClass("one-visible",(this.leftVisible||this.rightVisible)&&!e)}},{key:"_onLeftMouseDown",value:function(e){this.trigger("action",{left:!0})}},{key:"_onRightMouseDown",value:function(e){this.trigger("action",{right:!0})}},{key:"_onMouseDown",value:function(e){var t=e.target;this.$left.isOrHas(t)?this.trigger("action",{left:!0}):this.$right.isOrHas(t)?this.trigger("action",{right:!0}):this.$container.hasClass("one-visible")&&this.trigger("action",{left:this.leftVisible,right:this.rightVisible})}}])&&pc(t.prototype,n),i&&pc(t,i),o}(de);function wc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(_c,"HorizontalAlignment",{LEFT:"left",RIGHT:"right"});var kc=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n={active:!Mt.get().supportsOnlyTouch(),restrictedFocusGain:!Mt.get().supportsOnlyTouch()};if(s.a.extend(this,n,t),!this.session)throw new Error("Session expected");this._focusContexts=[],this._glassPaneTargets=[],this._glassPaneDisplayParents=[],this._glassPaneRenderers=[];var i=this.session.$entryPoint,r=i.data("partid")||"0";i.attr("tabindex",r),this.restrictedFocusGain&&this.installTopLevelMouseHandlers(i),this.installFocusContext(i,Pc.AUTO)}var t,n,i;return t=e,(n=[{key:"installTopLevelMouseHandlers",value:function(e){e.on("mousedown",function(e){return this._acceptFocusChangeOnMouseDown(s()(e.target))?this._handleIEEvent(e):e.preventDefault(),!0}.bind(this))}},{key:"_handleIEEvent",value:function(e){if(Mt.get().isInternetExplorer()){var t,n=s()(e.target);if(n.is(".table-cell")||n.closest(".table-cell").length>0)return this.requestFocus(n.closest(".table")),void e.preventDefault();if(n.is(".tree-node")||n.closest(".tree-node").length>0)return this.requestFocus(n.closest(".tree")),void e.preventDefault();var i=n.css("user-select"),r="div:not(.desktop),[tabindex]:not([tabindex=-1]),radio,a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe";0!==n.not(r).length&&0===n.closest('[contenteditable="true"]').length&&i&&"none"===i&&((t=n.closest(r))&&this.requestFocus(t.get(0)),e.preventDefault())}}},{key:"activate",value:function(e){this.active!==e&&(this.active=e,s.a.log.isDebugEnabled()&&s.a.log.isDebugEnabled()&&s.a.log.debug("Focus manager active: "+this.active),this.active&&this.validateFocus())}},{key:"installFocusContext",value:function(e,t){var n=this.evaluateFocusRule(e,t),i=new Oc(e,this);return Pc.PREPARE!==t&&i.ready(),this._pushIfAbsendElseMoveTop(i),n&&i.validateAndSetFocus(n),i}},{key:"evaluateFocusRule",value:function(e,t){return!t||O.isOneOf(t,Pc.AUTO,Pc.PREPARE)?this.findFirstFocusableElement(e):t===Pc.NONE?null:t}},{key:"uninstallFocusContext",value:function(e){var t=this.getFocusContext(e);if(t){var n=Bi.outsideFilter(t.$container);et.remove(this._focusContexts,t),t.dispose();var i=this._findActiveContext();i&&i.validateAndSetFocus(i.lastValidFocusedElement,n)}}},{key:"isFocusContextInstalled",value:function(e){return!!this.getFocusContext(e)}},{key:"activateFocusContext",value:function(e){var t=e;e instanceof Oc||(t=this.getFocusContext(e)),t&&!this.isElementCovertByGlassPane(t.$container)&&(this._pushIfAbsendElseMoveTop(t),this.validateFocus())}},{key:"isElementCovertByGlassPane",value:function(e,t){var n=this._glassPaneTargets;return t&&(n=this._glassPaneTargets.filter(t)),!!n.length&&(this._glassPaneDisplayParents.indexOf(O.widget(e))>=0||n.some((function(t){return 0!==s()(e).closest(t).length})))}},{key:"registerGlassPaneTarget",value:function(e){this._glassPaneTargets.push(e),this.validateFocus()}},{key:"registerGlassPaneDisplayParent",value:function(e){this._glassPaneDisplayParents.push(e)}},{key:"registerGlassPaneRenderer",value:function(e){this._glassPaneRenderers.push(e)}},{key:"unregisterGlassPaneTarget",value:function(e){et.$remove(this._glassPaneTargets,e),this.validateFocus()}},{key:"unregisterGlassPaneDisplayParent",value:function(e){et.remove(this._glassPaneDisplayParents,e)}},{key:"unregisterGlassPaneRenderer",value:function(e){et.remove(this._glassPaneRenderers,e)}},{key:"rerenderGlassPanes",value:function(){this._glassPaneRenderers.slice().forEach((function(e){e.removeGlassPanes(),e.renderGlassPanes()}))}},{key:"validateFocus",value:function(e){var t=this._findActiveContext();t&&t.validateFocus(e)}},{key:"requestFocusIfReady",value:function(e,t){return this.requestFocus(e,t,!0)}},{key:"requestFocus",value:function(e,t,n){if(!(e=e instanceof s.a?e[0]:e))return!1;var i=this._findFocusContextFor(e);if(i){if(n&&!i.prepared)return!1;i.validateAndSetFocus(e,t)}return Cc.isActiveElement(e)}},{key:"findFirstFocusableElement",value:function(e,t){var n,i,r,o,a,u,l,c,f,h=e.entryPoint(),d=e.find(":focusable").addBack(":focusable").not(h).filter(t||Bi.returnTrue);for(o=0;o<d.length;o++)if(a=d[o],u=s()(a),!this.isElementCovertByGlassPane(a)&&!(u.is(".prevent-initial-focus")||u.closest(".prevent-initial-focus").length>0))if(n||u.hasClass("button")||u.hasClass("menu-item")||(n=a),!i&&u.is(".default-menu")&&(i=a),l=u.parents(".menubar"),c=u.parents(".tab-box-header"),f=u.parents(".box-buttons"),(l.length>0||c.length>0||f.length>0)&&!r&&(u.hasClass("button")||u.hasClass("menu-item")))r=a;else if(!l.length&&!c.length&&!f.length&&"function"==typeof a.focus)return a;if(i)return i;if(r){if(r!==n&&n){var p=s()(r).parents(".tab-box-header"),y=s()(n);if(s()(n).parents(".tab-box-header").length>0&&p.length>0&&y.is(".tab-item"))return n}return r}return n}},{key:"_findActiveContext",value:function(){return et.last(this._focusContexts)}},{key:"getFocusContext",value:function(e){return et.find(this._focusContexts,(function(t){return t.$container===e}))}},{key:"_findFocusContextFor",value:function(e){e=s.a.ensure(e);var t=null,n=Number.MAX_VALUE;return this._focusContexts.forEach((function(i){i.$container.isOrHas(e)&&e.parentsUntil(i.$container).length<n&&(t=i)})),t}},{key:"_acceptFocusChangeOnMouseDown",value:function(e){return!(e.hasClass("glasspane")||this.isElementCovertByGlassPane(e)||!Cc.isFocusableByMouse(e)||!e.is(":focusable")&&!Cc.isSelectableText(e)&&!Cc.containsParentFocusableByMouse(e,e.entryPoint()))}},{key:"_pushIfAbsendElseMoveTop",value:function(e){et.remove(this._focusContexts,e),this._focusContexts.push(e)}}])&&wc(t.prototype,n),i&&wc(t,i),e}();function Sc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Oc=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$container=t,this.focusManager=n,this.lastValidFocusedElement=null,this.focusedElement=null,this.prepared=!1,this._keyDownListener=this._onKeyDown.bind(this),this._focusInListener=this._onFocusIn.bind(this),this._focusOutListener=this._onFocusOut.bind(this),this._unfocusableListener=this._onUnfocusable.bind(this),this._removeListener=this._onRemove.bind(this)}var t,n,i;return t=e,(n=[{key:"ready",value:function(){this.prepared||(this.$container.on("keydown",this._keyDownListener).on("focusin",this._focusInListener).on("focusout",this._focusOutListener).on("hide disable",this._unfocusableListener),this.prepared=!0,this.lastValidFocusedElement&&this.restoreFocus())}},{key:"dispose",value:function(){this.prepared&&(this.$container.off("keydown",this._keyDownListener).off("focusin",this._focusInListener).off("focusout",this._focusOutListener).off("hide disable",this._unfocusableListener),s()(this.focusedElement).off("remove",this._removeListener))}},{key:"_onKeyDown",value:function(e){if(e.which===pu.TAB){var t,n=this.$container.activeElement(!0),i=this.$container.find(":tabbable:visible"),r=i.first()[0],o=i.last()[0],a=i.index(n);if(e.shiftKey?!o||n!==r&&n!==this.$container[0]?a>0&&(t=i.get(a-1)):(s.a.suppressEvent(e),this.validateAndSetFocus(o),t=o):!r||n!==o&&n!==this.$container[0]?a<i.length-1&&(t=i.get(a+1)):(s.a.suppressEvent(e),this.validateAndSetFocus(r),t=r),!t)return;var u=s()(t),l=No.offsetBounds(u),c=u.scrollParent();wf.isLocationInView(new Eo(l.x,l.y),c)||wf.scrollTo(c,u)}}},{key:"_onFocusIn",value:function(e){s()(e.target).on("remove",this._removeListener),this.focusedElement=e.target,e.target!==this.$container.entryPoint(!0)&&(this.focusManager._pushIfAbsendElseMoveTop(this),this.validateAndSetFocus(e.target),e.stopPropagation())}},{key:"_onFocusOut",value:function(e){s()(e.target).off("remove",this._removeListener),this.focusedElement=null,e.stopPropagation()}},{key:"_onRemove",value:function(e){this.validateAndSetFocus(null,Bi.notSameFilter(e.target)),e.stopPropagation()}},{key:"_onUnfocusable",value:function(e){s()(e.target).isOrHas(this.lastValidFocusedElement)&&(this.validateAndSetFocus(null,Bi.notSameFilter(e.target)),e.stopPropagation())}},{key:"validateAndSetFocus",value:function(e,t){e&&!s.a.contains(this.$container[0],e)&&(e=null);var n=null;n=!e||t&&!t.call(e)?this.focusManager.findFirstFocusableElement(this.$container,t):e,this.lastValidFocusedElement=n,this._focus(n)}},{key:"validateFocus",value:function(e){this.validateAndSetFocus(this.lastValidFocusedElement,e)}},{key:"restoreFocus",value:function(){this.lastValidFocusedElement&&this._focus(this.lastValidFocusedElement)}},{key:"_focus",value:function(e){if(this.focusManager.active&&this.prepared){if(this.focusManager.isElementCovertByGlassPane(e)){var t=this.$container.activeElement(!0);if(e&&(!t||!this.focusManager.isElementCovertByGlassPane(t)))return!1;e=null}(e=e||this.$container.entryPoint(!0)).focus||(e=this.$container.entryPoint(!0)),Cc.isActiveElement(e)||(e.focus(),s.a.log.isDebugEnabled()&&s.a.log.debug("Focus set to "+No.debugOutput(e)))}}}])&&Sc(t.prototype,n),i&&Sc(t,i),e}();function Tc(e){var t=s()(e);return!t.hasClass("unfocusable")&&!t.closest(".unfocusable").length}var Cc={containsParentFocusableByMouse:function(e,t){return s()(e).parents(":focusable").not(t).filter((function(){return Tc(this)})).length>0},isActiveElement:function(e){return!!e&&(e instanceof s.a?(t=e.activeElement(!0),e=e[0]):t=(e instanceof Document?e:e.ownerDocument).activeElement,t===e);var t},isFocusableByMouse:Tc,isSelectableText:function(e){for(var t=s()(e),n=t;"auto"===n.css("user-select");)if((n=n.parent()).is("body"))return!1;return"none"!==n.css("user-select")&&(!!t.is("input[disabled][type=text], textarea[disabled]")||t.text().trim().length>0)}},Pc={AUTO:"auto",NONE:"none",PREPARE:"prepare"};function Rc(e){return(Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ec(e,t,n){return(Ec="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$c(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Dc(e,t){return(Dc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$c(e);if(t){var r=$c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ac(this,n)}}function Ac(e,t){return!t||"object"!==Rc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $c(e){return($c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dc(e,t)}(o,e);var t,n,i,r=Fc(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("glasspane").on("mousedown",this._onMouseDown.bind(this)),Mt.get().supportsOnlyTouch()&&this.$container.addClass("needsclick"),this.$parent.addClass("glasspane-parent");var e=this.$parent.css("position");O.isOneOf(e,"relative","absolute")||this.$parent.css("position","relative"),this.session.focusManager.registerGlassPaneTarget(this.$parent)}},{key:"_remove",value:function(){this.$parent.removeClass("glasspane-parent"),this.session.focusManager.unregisterGlassPaneTarget(this.$parent),Ec($c(o.prototype),"_remove",this).call(this)}},{key:"_onMouseDown",value:function(e){s.a.suppressEvent(e)}}])&&xc(t.prototype,n),i&&xc(t,i),o}(de);function Mc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ic=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$glassPaneTargets,this.glassPaneRenderer}var t,n,i;return t=e,i=[{key:"createFor",value:function(t,n){if(t.rendered)throw new Error("Don't call this function if widget is already rendered.");var i=new e,r=function(e){var t=n();i.ready(t)};return t.one("render",r),t.one("destroy",(function(){t.off("render",r)})),[i]}}],(n=[{key:"ready",value:function(e){this.$glassPaneTargets=e,this.renderWhenReady()}},{key:"rendererReady",value:function(e){this.glassPaneRenderer=e,this.renderWhenReady()}},{key:"removeGlassPaneRenderer",value:function(e){this.glassPaneRenderer===e&&(this.glassPaneRenderer=null)}},{key:"renderWhenReady",value:function(){this.glassPaneRenderer&&this.$glassPaneTargets&&this.$glassPaneTargets.length>0&&this.$glassPaneTargets.forEach(function(e){this.glassPaneRenderer.renderGlassPane(e)}.bind(this))}}])&&Mc(t.prototype,n),i&&Mc(t,i),e}();function Lc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Bc=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._widget=t,this.session=t.session,this._enabled=O.nvl(n,!0),this._$glassPanes=[],this._deferredGlassPanes=[],this._resolvedDisplayParent=null,this._registeredDisplayParent=null,this._displayParentRenderHandler=this._onDisplayParentRender.bind(this),this._glassPaneRemoveHandler=this._onGlassPaneRemove.bind(this),this._glassPaneRendererRegistered=!1}var t,n,i;return t=e,(n=[{key:"renderGlassPanes",value:function(){this.findGlassPaneTargets().forEach((function(e){e instanceof Ic?(e.rendererReady(this),this._deferredGlassPanes.push(e)):this.renderGlassPane(e)}),this),this._glassPaneRendererRegistered||(this.session.focusManager.registerGlassPaneRenderer(this),this._glassPaneRendererRegistered=!0)}},{key:"renderGlassPane",value:function(e){if(!(e=s.a.ensure(e),this._widget.$container&&this._widget.$container[0]===e[0]||this._$glassPanes.some((function(t){return t.parent()[0]===e[0]})))){var t=e.appendDiv("glasspane").on("mousedown",this._onMouseDown.bind(this));this._adjustGlassPaneSize(t,e),Mt.get().supportsOnlyTouch()&&t.addClass("needsclick"),t.window(!0).popupWindow&&t.addClass("dark"),this._$glassPanes.push(t),this.session.focusManager.registerGlassPaneTarget(e),t.one("remove",this._glassPaneRemoveHandler),this._registerDisplayParent()}}},{key:"_adjustGlassPaneSize",value:function(e,t){var n=-t.cssBorderTopWidth(),i=-t.cssBorderBottomWidth(),r=-t.cssBorderLeftWidth(),o=-t.cssBorderRightWidth();t.children().each((function(e,t){var a=s()(t);n=Math.min(n,(a.cssTop()||0)+(a.cssMarginTop()||0)),i=Math.min(i,(a.cssBottom()||0)+(a.cssMarginBottom()||0)),r=Math.min(r,(a.cssLeft()||0)+(a.cssMarginLeft()||0)),o=Math.min(o,(a.cssRight()||0)+(a.cssMarginRight()||0))})),e.cssTop(n).cssBottom(i).cssLeft(r).cssRight(o)}},{key:"removeGlassPanes",value:function(){this._$glassPanes.slice().forEach((function(e){this._removeGlassPane(e)}),this),this._deferredGlassPanes.forEach((function(e){e.removeGlassPaneRenderer(this)}),this),this._deferredGlassPanes=[],this._unregisterDisplayParent(),this.session.focusManager.unregisterGlassPaneRenderer(this),this._glassPaneRendererRegistered=!1}},{key:"_removeGlassPane",value:function(e){var t=e.parent();e.off("remove",this._glassPaneRemoveHandler),e.remove(),et.$remove(this._$glassPanes,e),t.removeClass("no-hover"),this.session.focusManager.unregisterGlassPaneTarget(t)}},{key:"eachGlassPane",value:function(e){this._$glassPanes.forEach((function(t){e(t)}))}},{key:"findGlassPaneTargets",value:function(){if(!this._enabled)return[];var e=this._resolveDisplayParent();return e&&e.glassPaneTargets?e.glassPaneTargets(this._widget):[]}},{key:"_resolveDisplayParent",value:function(){return this._resolvedDisplayParent||(this._resolvedDisplayParent=this._widget.displayParent||this.session.desktop),this._resolvedDisplayParent}},{key:"_registerDisplayParent",value:function(){this._resolvedDisplayParent||this._resolveDisplayParent(),this._resolvedDisplayParent&&(this._registeredDisplayParent||(this.session.focusManager.registerGlassPaneDisplayParent(this._resolvedDisplayParent),this._registeredDisplayParent=this._resolvedDisplayParent,this._registeredDisplayParent.on("render",this._displayParentRenderHandler)))}},{key:"_unregisterDisplayParent",value:function(){this._registeredDisplayParent&&(this.session.focusManager.unregisterGlassPaneDisplayParent(this._registeredDisplayParent),this._registeredDisplayParent.off("render",this._displayParentRenderHandler),this._registeredDisplayParent=null)}},{key:"_onMouseDown",value:function(e){var t=null,n=this._resolveDisplayParent();if(n._onGlassPaneMouseDown&&n._onGlassPaneMouseDown(this._widget,s()(e.target)),this._widget instanceof ZO&&this._widget.isView()){var i=this.session.desktop.bench.getViewTab(this._widget);i&&((t=i.$container).isVisible()||(t=t.siblings(".overflow-tab-item")))}else this._widget.$container&&(t=this._widget.$container);if(t){var r=this._widget.$container.children(".glasspane");r.length?r.trigger("mousedown"):t.addClassForAnimation("animate-modality-highlight",{classesToRemove:"animate-modality-highlight animate-open"})}s.a.suppressEvent(e)}},{key:"_onDisplayParentRender",value:function(e){this.renderGlassPanes()}},{key:"_onGlassPaneRemove",value:function(e){var t=s()(e.target);this._removeGlassPane(t)}}])&&Lc(t.prototype,n),i&&Lc(t,i),e}();function Nc(e){return(Nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Vc(e,t,n){return(Vc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kc(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Wc(e,t){return(Wc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Kc(e);if(t){var r=Kc(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gc(this,n)}}function Gc(e,t){return!t||"object"!==Nc(t)&&"function"!=typeof t?Uc(e):t}function Uc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kc(e){return(Kc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wc(e,t)}(o,e);var t,n,i,r=zc(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).location=null,e.sandboxEnabled=!0,e.sandboxPermissions=null,e.scrollBarEnabled=!0,e.trackLocation=!1,e.wrapIframe=Mt.get().isIosPlatform(),e.$iframe=null,e._loadHandler=e._onLoad.bind(Uc(e)),e}return t=o,(n=[{key:"_render",value:function(){var e="iframe "+Mt.get().cssClassForIphone();this.wrapIframe?(this.$container=this.$parent.appendDiv("iframe-wrapper"),this.$iframe=this.$container.appendElement("<iframe>",e)):(this.$iframe=this.$parent.appendElement("<iframe>",e),this.$container=this.$iframe),this.htmlComp=Uo.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){Vc(Kc(o.prototype),"_renderProperties",this).call(this),this._renderScrollBarEnabled(),this._renderSandboxEnabled(),this._renderLocation(),this._renderTrackLocation()}},{key:"setLocation",value:function(e){this.setProperty("location",e)}},{key:"_renderLocation",value:function(){var e=this.location||"about:blank";this.$iframe.attr("src",e)}},{key:"setTrackLocation",value:function(e){this.setProperty("trackLocation",e)}},{key:"_renderTrackLocation",value:function(e){this.trackLocation?this.$iframe.on("load",this._loadHandler):this.$iframe.off("load",this._loadHandler)}},{key:"_onLoad",value:function(e){if(this.rendered&&this.trackLocation){var t=this.$iframe[0].contentDocument;if(!t)return;var n=t.location.href;"about:blank"===n&&(n=null),this._setProperty("location",n)}}},{key:"setScrollBarEnabled",value:function(e){this.setProperty("scrollBarEnabled",e)}},{key:"_renderScrollBarEnabled",value:function(){this.$container.toggleClass("no-scrolling",!this.scrollBarEnabled),this.$iframe.attr("scrolling",this.scrollBarEnabled?"yes":"no"),this.rendered&&this._renderLocation()}},{key:"setSandboxEnabled",value:function(e){this.setProperty("sandboxEnabled",e)}},{key:"_renderSandboxEnabled",value:function(){this.sandboxEnabled?this._renderSandboxPermissions():(this.$iframe.removeAttr("sandbox"),this.$iframe.removeAttr("security")),this.rendered&&this._renderLocation()}},{key:"setSandboxPermissions",value:function(e){this.setProperty("sandboxPermissions",e)}},{key:"_renderSandboxPermissions",value:function(){this.sandboxEnabled&&(this.$iframe.attr("sandbox",O.nvl(this.sandboxPermissions,"")),this.rendered&&this._renderLocation())}}])&&Hc(t.prototype,n),i&&Hc(t,i),o}(de);function Yc(e){return(Yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jc(e,t,n){return(Jc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nf(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Zc(e,t){return(Zc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=nf(e);if(t){var r=nf(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ef(this,n)}}function ef(e,t){return!t||"object"!==Yc(t)&&"function"!=typeof t?tf(e):t}function tf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nf(e){return(nf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zc(e,t)}(o,e);var t,n,i,r=Qc(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).$container=null,e.$thumb=null,e.$thumbHandle=null,e.axis="y",e.borderless=!1,e.mouseWheelNeedsShift=!1,e._scrollSize=null,e._offsetSize=null,e._dim="Height",e._dir="top",e._dirReverse="bottom",e._scrollDir="scrollTop",e._thumbClipping=new Ro(0,0,0,0),e._onScrollHandler=e._onScroll.bind(tf(e)),e._onScrollWheelHandler=e._onScrollWheel.bind(tf(e)),e._onScrollbarMouseDownHandler=e._onScrollbarMouseDown.bind(tf(e)),e._onTouchStartHandler=e._onTouchStart.bind(tf(e)),e._onThumbMouseDownHandler=e._onThumbMouseDown.bind(tf(e)),e._onDocumentMousemoveHandler=e._onDocumentMousemove.bind(tf(e)),e._onDocumentMouseUpHandler=e._onDocumentMouseUp.bind(tf(e)),e._onAncestorScrollOrResizeHandler=e.update.bind(tf(e)),e._fixScrollbarHandler=e._fixScrollbar.bind(tf(e)),e._unfixScrollbarHandler=e._unfixScrollbar.bind(tf(e)),e}return t=o,(n=[{key:"_render",value:function(){this._ensureParentPosition(),this.$container=this.$parent.appendDiv("scrollbar").addClass(this.axis+"-axis"),this._$thumb=this.$container.appendDiv("scrollbar-thumb").addClass(this.axis+"-axis"),this._$thumbHandle=this._$thumb.appendDiv("scrollbar-thumb-handle").addClass(this.axis+"-axis"),this.borderless&&this.$container.addClass("borderless"),this._dim="x"===this.axis?"Width":"Height",this._dir="x"===this.axis?"left":"top",this._dirReverse="x"===this.axis?"right":"bottom",this._scrollDir="x"===this.axis?"scrollLeft":"scrollTop";var e=this.$parent.data("scrollbars");if(!e)throw new Error('Data "scrollbars" missing in '+No.debugOutput(this.$parent)+"\nAncestors: "+this.ancestorsToString(1));this.$parent.on("DOMMouseScroll mousewheel",this._onScrollWheelHandler).on("scroll",this._onScrollHandler).onPassive("touchstart",this._onTouchStartHandler),e.forEach(function(e){e.on("scrollStart",this._fixScrollbarHandler),e.on("scrollEnd",this._unfixScrollbarHandler)}.bind(this)),this.$container.on("mousedown",this._onScrollbarMouseDownHandler),this._$thumb.on("mousedown",this._onThumbMouseDownHandler),this._$ancestors=this.$container.parents("div").on("scroll resize",this._onAncestorScrollOrResizeHandler)}},{key:"_remove",value:function(){var e=this.$parent.data("scrollbars");this.$parent.off("DOMMouseScroll mousewheel",this._onScrollWheelHandler).off("scroll",this._onScrollHandler).offPassive("touchstart",this._onTouchStartHandler),e.forEach(function(e){e.off("scrollStart",this._fixScrollbarHandler),e.off("scrollEnd",this._unfixScrollbarHandler)}.bind(this)),this.$container.off("mousedown",this._onScrollbarMouseDownHandler),this._$thumb.off("mousedown","",this._onThumbMouseDownHandler),this._$ancestors.off("scroll resize",this._onAncestorScrollOrResizeHandler),this._$ancestors=null,Jc(nf(o.prototype),"_remove",this).call(this)}},{key:"_renderOnAttach",value:function(){Jc(nf(o.prototype),"_renderOnAttach",this).call(this),this._ensureParentPosition()}},{key:"_ensureParentPosition",value:function(){if(this.$parent&&this.$parent.isAttached()){var e=this.$parent.css("position");O.isOneOf(e,"relative","absolute")||this.$parent.css("position","relative")}}},{key:"scroll",value:function(e){var t=Math.max(0,this.$parent[this._scrollDir]());this._scrollToAbsolutePoint(t+e)}},{key:"_scrollToAbsolutePoint",value:function(e){var t=Math.min(this._scrollSize-this._offsetSize+1,Math.max(0,Math.round(e)));this.$parent[this._scrollDir](t)}},{key:"update",value:function(){if(this.rendered){var e=this.$container["cssMargin"+this.axis.toUpperCase()](),t=this.$parent[this._scrollDir](),n=this.$parent.scrollLeft(),i=this.$parent.scrollTop();this.reset(),this._offsetSize=this.$parent[0]["offset"+this._dim],this._scrollSize=this.$parent[0]["scroll"+this._dim];var r=Math.max(this._offsetSize*this._offsetSize/this._scrollSize-e,25),o=this._offsetSize-r-e;this._$thumb.css(this._dim.toLowerCase(),r);var s=t/(this._scrollSize-this._offsetSize)*o;this._$thumb.css(this._dir,s),this._offsetSize+1>=this._scrollSize?this.$container.css("display","none"):(this.$container.css("display",""),this._isContainerTooSmallForThumb()?this._$thumb.addClass("container-too-small-for-thumb"):this._$thumb.removeClass("container-too-small-for-thumb")),this._clipWhenOverlappingAncestor(),this.$container.cssRight(-1*n),this.$container.cssBottom(-1*i)}}},{key:"_resetClipping",value:function(){"y"===this.axis?this._$thumb.css("width","").css("left",""):this._$thumb.css("height","").css("top",""),this._$thumb.removeClass("clipped-left clipped-right clipped-top clipped-bottom"),this._thumbClipping=new Ro(0,0,0,0)}},{key:"_clipWhenOverlappingAncestor",value:function(){if(this._resetClipping(),"fixed"===this.$container.css("position")){var e=No.offsetBounds(this._$thumb),t=e.width,n=e.height,i=e.x+e.width,r=e.y+e.height,o=0,a=0,u=i,l=r;this.$container.parents("div").each((function(){var e=s()(this),t=No.offsetBounds(e);if("visible"!==e.css("overflow-x")){t.x>o&&(o=t.x);var n=t.x+t.width;n<u&&(u=n)}if("visible"!==e.css("overflow-y")){t.y>a&&(a=t.y);var i=t.y+t.height;i<l&&(l=i)}}));var c=0,f=0,h=0,d=0;o>e.x&&(t-=c=o-e.x,this._$thumb.css("width",t).css("left",No.bounds(this._$thumb).x+c).addClass("clipped-left")),a>e.y&&(n-=h=a-e.y,this._$thumb.css("height",n).css("top",No.bounds(this._$thumb).y+h).addClass("clipped-top")),i>u&&(f=i-u,this._$thumb.css("width",t-f).addClass("clipped-right")),r>l&&(d=r-l,this._$thumb.css("height",n-d).addClass("clipped-bottom")),this._thumbClipping=new Ro(h,f,d,c)}}},{key:"reset",value:function(){this._$thumb.css(this._dim.toLowerCase(),0),this.$container.cssRight(0),this.$container.cssBottom(0)}},{key:"_onScroll",value:function(e){this.update()}},{key:"_onTouchStart",value:function(e){Ft.onScrollStartEndDuringTouch(this.$parent,function(){this.rendered&&this.$container.css("opacity",0)}.bind(this),function(){this.rendered&&this.$container.css("opacity","")}.bind(this))}},{key:"_onScrollWheel",value:function(e){if(!this.$container.isVisible())return!0;if(e.ctrlKey)return!0;if(this.mouseWheelNeedsShift!==e.shiftKey)return!0;var t=(e=e.originalEvent||this.$container.window(!0).event.originalEvent).wheelDelta?-e.wheelDelta/2:20*e.detail;return this.notifyBeforeScroll(),this.scroll(t),this.notifyAfterScroll(),!1}},{key:"_onScrollbarMouseDown",value:function(e){this.notifyBeforeScroll();var t,n=this.$container[this._dim.toLowerCase()](),i=this.$container.offset()[this._dir],r=("x"===this.axis?e.pageX:e.pageY)-i;if(this._isContainerTooSmallForThumb())t=Math.min(1,Math.max(0,r/n)),this._scrollToAbsolutePoint(t*this._scrollSize-Math.round(this._offsetSize/2));else{var o=this._$thumb["outer"+this._dim](!0),s=Math.round(o/2),a=1/(n-Math.round(o/2)-s)*(r-s);t=Math.min(1,Math.max(0,a)),this._scrollToAbsolutePoint(t*(this._scrollSize-this._offsetSize))}this.notifyAfterScroll()}},{key:"_onThumbMouseDown",value:function(e){if(this._isContainerTooSmallForThumb())return!0;this.notifyBeforeScroll();var t=("x"===this.axis?this._thumbClipping.horizontal():this._thumbClipping.vertical())+this._$thumb["outer"+this._dim](!0),n="x"===this.axis?this._thumbClipping.left:this._thumbClipping.top,i=this._$thumb.offset()[this._dir]+Math.floor(t/2)-n,r=Math.round(("x"===this.axis?e.pageX:e.pageY)-i);return this._$thumb.addClass("scrollbar-thumb-move"),this._$thumb.document().on("mousemove",{thumbCenterOffset:r},this._onDocumentMousemoveHandler).one("mouseup",this._onDocumentMouseUpHandler),!1}},{key:"_onDocumentMousemove",value:function(e){if(this.rendered){var t=e.data.thumbCenterOffset,n=("x"===this.axis?this._thumbClipping.horizontal():this._thumbClipping.vertical())+this._$thumb["outer"+this._dim](!0),i=this.$container[this._dim.toLowerCase()]()-n,r=this.$container.offset()[this._dir]+n/2,o=Math.min(i,Math.max(0,("x"===this.axis?e.pageX:e.pageY)-r-t)),s=Math.min(1,Math.max(0,o/i))*(this._scrollSize-this._offsetSize);this._scrollToAbsolutePoint(s)}}},{key:"_onDocumentMouseUp",value:function(e){return s()(e.currentTarget).off("mousemove",this._onDocumentMousemoveHandler),this.rendered&&this._$thumb.removeClass("scrollbar-thumb-move"),this.notifyAfterScroll(),!1}},{key:"notifyBeforeScroll",value:function(){this.trigger("scrollStart")}},{key:"notifyAfterScroll",value:function(){this.trigger("scrollEnd")}},{key:"_fixScrollbar",value:function(){wf.fix(this.$container),this.update()}},{key:"_unfixScrollbar",value:function(){wf.unfix(this.$container,null,!0),this.update()}},{key:"_isContainerTooSmallForThumb",value:function(){return this._$thumb["outer"+this._dim](!0)>=this.$container[this._dim.toLowerCase()]()}}])&&Xc(t.prototype,n),i&&Xc(t,i),o}(de),of={};function sf(e){if(e)return of[e]||[];var t=[];return oi.values(of).forEach((function(e){et.pushAll(t,e)})),t}function af(e,t){if(of[e]){if(of[e].indexOf(t)>-1)return;of[e].push(t)}else of[e]=[t];s.a.log.isTraceEnabled()&&s.a.log.trace("Scrollable added: "+t.attr("class")+". New length: "+of[e].length)}function uf(e,t){var n=0;if(!of[e])throw new Error("scrollable could not be removed. Potential memory leak. "+t.attr("class"));if(n=of[e].length,et.$remove(of[e],t),s.a.log.isTraceEnabled()&&s.a.log.trace("Scrollable removed: "+t.attr("class")+". New length: "+of[e].length),n===of[e].length)throw new Error("scrollable could not be removed. Potential memory leak. "+t.attr("class"))}function lf(e,t){Mt.get().isIos()?setTimeout(cf.bind(this,e,t)):cf(e,t)}function cf(e,t){s.a.log.isTraceEnabled()&&s.a.log.trace("use native scrollbars for container "+No.debugOutput(e)),"x"===t.axis?e.css("overflow-x","auto").css("overflow-y","hidden"):"y"===t.axis?e.css("overflow-x","hidden").css("overflow-y","auto"):e.css("overflow","auto"),e.css("-webkit-overflow-scrolling","touch")}function ff(e,t){s.a.log.isTraceEnabled()&&s.a.log.trace("installing JS-scrollbars for container "+No.debugOutput(e));var n,i=et.ensure(e.data("scrollbars"));if(i.forEach((function(e){e.destroy()})),i=[],"both"===t.axis){var r=s.a.extend({},t);r.axis="y",n=O.create("Scrollbar",s.a.extend({},r)),i.push(n),r.axis="x",r.mouseWheelNeedsShift=!0,n=O.create("Scrollbar",s.a.extend({},r)),i.push(n)}else n=O.create("Scrollbar",s.a.extend({},t)),i.push(n);e.data("scrollbars",i),i.forEach((function(t){t.render(e),t.update()}))}function hf(e,t){if(e&&e.data("scrollable")){var n=e.data("scrollbars");n?t?df(n):e.data("scrollbarUpdatePending")||(setTimeout((function(){df(n),e.removeData("scrollbarUpdatePending")}),0),e.data("scrollbarUpdatePending",!0)):Mt.get().isIos()&&function(e){if(e.data("scrollbarUpdatePending"))return;setTimeout((function(){var t;t=No.size(e).subtract(No.insets(e,{includePadding:!1,includeBorder:!0})),e[0].scrollHeight===t.height&&e[0].scrollWidth===t.width?e.css("-webkit-overflow-scrolling",""):e.css("-webkit-overflow-scrolling","touch"),e.removeData("scrollbarUpdatePending")})),e.data("scrollbarUpdatePending",!0)}(e)}}function df(e){e.forEach((function(e){e.rendered&&e.reset()})),e.forEach((function(e){e.rendered&&e.update()}))}function pf(e){return s.a.extend({},{animate:!1,stop:!0},e)}function yf(e,t,n){n=pf(n);var i=mf(e,"y");if(i&&i.notifyBeforeScroll(),!n.animate)return n.stop&&e.stop("scroll"),e.scrollTop(t),void(i&&i.notifyAfterScroll());bf(e,t,n),e.promise("scroll").always((function(){i&&i.notifyAfterScroll()}))}function vf(e,t,n){n=pf(n);var i=mf(e,"x");if(i&&i.notifyBeforeScroll(),!n.animate)return n.stop&&e.stop("scroll"),e.scrollLeft(t),void(i&&i.notifyAfterScroll());gf(e,t,n),e.promise("scroll").always((function(){i&&i.notifyAfterScroll()}))}function bf(e,t,n){n.stop&&e.stop("scroll"),e.animate({scrollTop:t},{queue:"scroll"}).dequeue("scroll")}function gf(e,t,n){n.stop&&e.stop("scroll"),e.animate({scrollLeft:t},{queue:"scroll"}).dequeue("scroll")}function mf(e,t){var n=e.data("scrollbars")||[];return et.find(n,(function(e){return e.axis===t}))}function _f(e){e.css({position:"absolute",left:"",top:"",width:"",height:""})}var wf={animateScrollLeft:gf,animateScrollTop:bf,ensureExpansionVisible:function(e){var t=e.isExpanded(e.element),n=e.getChildren(e.element),i=e.$element.position().top,r=e.element.height,o=e.$scrollable.scrollTop();if(t){if(t&&n.length>0){var s=e.$scrollable.height(),a=i+(function e(t,n,i,r){var o=0;return t.forEach((function(t){t.height?o+=t.height:o+=r,i(t)&&n(t).length>0&&(o+=e(n(t),n,i,r))})),o}(n,e.getChildren,e.isExpanded,e.defaultChildHeight)+1.5*r),u=o+Math.min(a-s,i-r);u>o&&yf(e.$scrollable,u,{animate:!0,stop:!1})}}else if(i<r){var l=Math.max(o-(r-i),0);yf(e.$scrollable,l,{animate:!0})}if(n.length>0){var c=Math.max(e.element.level-3,0)*e.nodePaddingLevel;vf(e.$scrollable,c,{animate:!0,stop:!1})}},fix:function(e){if(e.isVisible()&&"fixed"!==e.css("position")){var t=e[0].getBoundingClientRect();e.css("position","fixed").cssLeft(t.left-e.cssMarginLeft()).cssTop(t.top-e.cssMarginTop()).cssWidth(t.width).cssHeight(t.height)}},getScrollables:sf,install:function(e,t){(t=pf(t)).axis=t.axis||"both";var n=O.nvl(t.nativeScrollbars,Mt.get().hasPrettyScrollbars()),i=O.nvl(t.hybridScrollbars,Mt.get().canHideScrollbars()&&!(Mt.get().isInternetExplorer()&&!Mt.get().supportsTouch()));n?lf(e,t):i?(e.addClass("hybrid-scrollable"),lf(e,t),ff(e,t)):(e.css("overflow","hidden"),ff(e,t));var r=Uo.optGet(e);return r&&(r.scrollable=!0),e.data("scrollable",!0),af(t.session||t.parent.session,e),e},isHybridScrolling:function(e){return e.hasClass("hybrid-scrollable")},isJsScrolling:function(e){return!!e.data("scrollbars")},isLocationInView:function(e,t){return!t||0===t.length||No.offsetBounds(t).contains(e.x,e.y)},isNativeScrolling:function(e){return O.isOneOf("auto",e.css("overflow"),e.css("overflow-x"),e.css("overflow-y"))},offScroll:function(e){var t=e.$scrollParents;if(!t)throw new Error("$scrollParents are not defined");for(var n=0;n<t.length;n++){t[n].off("scroll",e)}},onScroll:function(e,t){t.$scrollParents=[],e.scrollParents().each((function(){var e=s()(this);e.on("scroll",t),t.$scrollParents.push(e)}))},opacity:function(e,t){if(e&&e.data("scrollable")){var n=e.data("scrollbars");n&&n.forEach((function(e){e.rendered&&e.$container.css("opacity",t)}))}},pushScrollable:af,removeScrollable:uf,reset:function(e){var t=e.data("scrollbars");t&&t.forEach((function(e){e.reset()}))},restoreScrollPositions:function(e,t){var n,i,r=sf(t);r&&r.forEach((function(t){e.isOrHas(t[0])&&((n=t.data("scrollTop"))&&(t.scrollTop(n),t.removeData("scrollTop")),(i=t.data("scrollLeft"))&&(t.scrollLeft(i),t.removeData("scrollLeft")),hf(t),s.a.log.isTraceEnabled()&&s.a.log.trace("Restored scroll position for "+t.attr("class")+". Top: "+n+". Left: "+i))}))},scrollHorizontalTo:function(e,t,n){var i,r=e.width(),o=No.bounds(t,!0),s=o.x,a=o.width;s<0?vf(e,e.scrollLeft()+s,n):s+a>r&&(i=Math.ceil(e.scrollLeft()+s+a-r),vf(e,i,n))},scrollLeft:vf,scrollTo:function(e,t,n){var i,r=e.height(),o=No.offsetBounds(t),s=No.offsetBounds(e),a=o.y-s.y-4,u=0,l=o.height+8,c=a+l,f=(n="string"==typeof n?{align:n}:pf(n)).align;"center"===(f=f?f.toLowerCase():a<0?"top":c>r?"bottom":void 0)?i=e.scrollTop()+a-Math.max(0,(r-l)/2):"top"===f?i=e.scrollTop()+a:"bottom"===f&&(u=a-((i=Math.ceil(e.scrollTop()+c-r))-e.scrollTop()))<0&&(i+=u),i&&yf(e,i,n)},scrollToBottom:function(e){yf(e,e[0].scrollHeight-e[0].offsetHeight)},scrollTop:yf,scrollbar:mf,setVisible:function(e,t){if(e&&e.data("scrollable")){var n=e.data("scrollbars");n&&n.forEach((function(e){e.rendered&&e.$container.setVisible(t)}))}},storeScrollPositions:function(e,t){var n,i,r=sf(t);r&&r.forEach((function(t){e.isOrHas(t[0])&&(n=t.scrollTop(),t.data("scrollTop",n),i=t.scrollLeft(),t.data("scrollLeft",t.scrollLeft()),s.a.log.isTraceEnabled()&&s.a.log.trace("Stored scroll position for "+t.attr("class")+". Top: "+n+". Left: "+i))}))},unfix:function(e,t,n){if(clearTimeout(t),!n)return setTimeout((function(){_f(e)}),50);_f(e)},uninstall:function(e,t){if(e.data("scrollable")){var n=e.data("scrollbars");n&&n.forEach((function(e){e.destroy()})),uf(t,e),e.removeData("scrollable"),e.css("overflow",""),e.removeClass("hybrid-scrollable"),e.removeData("scrollbars");var i=Uo.optGet(e);i&&(i.scrollable=!1)}},update:hf};function kf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Sf=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled=!0,this.minRowHeight=0,this.scrollHandler=null,this.viewRangeSize=new fi,this.widget=null,this.$scrollable=null,s.a.extend(this,t)}var t,n,i;return t=e,(n=[{key:"setEnabled",value:function(e){this.enabled=e}},{key:"set$Scrollable",value:function(e){this.$scrollable!==e&&(this.$scrollable=e)}},{key:"setMinRowHeight",value:function(e){if(this.minRowHeight!==e){if(!Gn.isNumber(e))throw new Error("minRowHeight is not a number: "+e);this.minRowHeight=e,this.widget.rendered&&this.setViewRangeSize(this.calculateViewRangeSize())}}},{key:"setViewRangeSize",value:function(e,t){this.viewRangeSize!==e&&(this.viewRangeSize=e,this.widget.rendered&&O.nvl(t,!0)&&this._renderViewPort())}},{key:"calculateViewRangeSize",value:function(){if(!this.enabled||0===this.$scrollable.length)return this.rowCount();if(0===this.minRowHeight)throw new Error("Cannot calculate view range with rowHeight = 0");return 2*Math.ceil(this.$scrollable.height()/this.minRowHeight)}},{key:"calculateCurrentViewRange",value:function(){if(!this.enabled)return this.maxViewRange();if(0===this.viewRangeSize)return new fi(0,0);var e;if(0===this.$scrollable.length)return this.maxViewRange();var t=this.$scrollable[0].scrollTop,n=this.$scrollable[0].scrollHeight-this.$scrollable[0].clientHeight,i=this.widget.$container[0].getBoundingClientRect(),r=this.$scrollable[0].getBoundingClientRect();return i.height>0&&(i.bottom<r.top||i.top>r.bottom)?new fi(0,0):(e=0===n?0:this._rowIndexAtScrollTop(t),this.calculateViewRangeForRowIndex(e))}},{key:"maxViewRange",value:function(){return new fi(0,this.rowCount())}},{key:"calculateViewRangeForRowIndex",value:function(e){if(!this.enabled)return this.maxViewRange();var t=new fi,n=Math.floor(this.viewRangeSize/4);return t.from=Math.max(e-n,0),t.to=Math.min(t.from+this.viewRangeSize,this.rowCount()),this.viewRangeSize-t.size()>0&&(t.from=Math.max(t.to-this.viewRangeSize,0)),t}},{key:"_rowIndexAtScrollTop",value:function(e){var t=0,n=this.rowCount(),i=n-1;this.widget.$container[0]!==this.$scrollable[0]&&(t=e+(this.widget.$container.offset().top-this.$scrollable.offset().top));for(var r=0;r<n;r++)if(e<(t+=this.rowHeight(r))){i=r;break}return i}},{key:"rowHeight",value:function(e){throw new Error("Function has to be provided by widget")}},{key:"rowCount",value:function(){throw new Error("Function has to be provided by widget")}},{key:"_renderViewPort",value:function(){var e=this.calculateCurrentViewRange();this._renderViewRange(e)}},{key:"_renderViewRangeForRowIndex",value:function(e){var t=this.calculateViewRangeForRowIndex(e);this._renderViewRange(t)}},{key:"_renderViewRange",value:function(e){throw new Error("Function has to be provided by widget")}}])&&kf(t.prototype,n),i&&kf(t,i),e}();function Of(e){return(Of="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cf(e,t,n){return(Cf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Df(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Pf(e,t){return(Pf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Df(e);if(t){var r=Df(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xf(this,n)}}function xf(e,t){return!t||"object"!==Of(t)&&"function"!=typeof t?Ef(e):t}function Ef(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Df(e){return(Df=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ff=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pf(e,t)}(o,e);var t,n,i,r=Rf(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).splitHorizontal=!0,e.$anchor=null,e.$root=null,e.position=null,e.orientation="top",e._cursorOffset=0,e._mouseDownHandler=e._onMouseDown.bind(Ef(e)),e}return t=o,(n=[{key:"_init",value:function(e){Cf(Df(o.prototype),"_init",this).call(this,e),this.setPosition(this.position)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("splitter").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.htmlComp=Uo.install(this.$container,this.session),this._$window=this.$parent.window(),this._$body=this.$parent.body()}},{key:"_renderProperties",value:function(){Cf(Df(o.prototype),"_renderProperties",this).call(this),this._renderPosition()}},{key:"_renderEnabled",value:function(){Cf(Df(o.prototype),"_renderEnabled",this).call(this),this.enabledComputed?this.$container.on("mousedown",this._mouseDownHandler):this.$container.off("mousedown",this._mouseDownHandler)}},{key:"setLayoutData",value:function(e){Cf(Df(o.prototype),"setLayoutData",this).call(this,e),this.layoutData=e}},{key:"getLayoutData",value:function(){return this.layoutData}},{key:"setPosition",value:function(e){if(s.a.isNumeric(e)||(e=this._derivePositionFromAnchor()),e!==this.position)return this._setPosition(e),e}},{key:"_derivePositionFromAnchor",value:function(){if(!this.$anchor)return null;var e=No.offsetBounds(this.$anchor,{exact:!0});return this.splitHorizontal?e.x+e.width:e.y+e.height}},{key:"_setPosition",value:function(e){if(s.a.isNumeric(e)&&e!==this.position){this.position=e;var t={position:e};this.trigger("positionChange",t),this.rendered&&this._renderPosition()}}},{key:"_renderPosition",value:function(){if(null!==this.position){var e=No.size(this.$container,!0);if(this.splitHorizontal){var t=this.position-e.width/2;"right"===this.orientation?this.$container.cssRight(t):this.$container.cssLeft(t)}else{var n=this.position-e.height/2;"bottom"===this.orientation?this.$container.cssBottom(n):this.$container.cssTop(n)}}}},{key:"_onMouseDown",value:function(e){var t=No.margins(this.$container),n=No.offsetBounds(this.$container);n.x-=t.left,n.y-=t.top,n.width+=t.horizontal(),n.height+=t.vertical();var i=n.center();this._$window.on("mousemove.splitter",this._onMouseMove.bind(this)).one("mouseup",this._onMouseUp.bind(this)),this._$body.addClass(this.splitHorizontal?"col-resize":"row-resize"),s()("iframe").addClass("dragging-in-progress"),this._cursorOffset={left:i.x-e.pageX,top:i.y-e.pageY},this.trigger("moveStart",{position:this._getSplitterPosition(e)}),e.preventDefault()}},{key:"_getSplitterPosition",value:function(e){var t=No.offsetBounds(this.$root);if(this.splitHorizontal){var n=e.pageX+this._cursorOffset.left-t.x;return"right"===this.orientation?t.width-n:n}var i=e.pageY+this._cursorOffset.top-t.y;return"bottom"===this.orientation?t.height-i:i}},{key:"_onMouseMove",value:function(e){var t={position:this._getSplitterPosition(e),defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0},setPosition:function(e){this.position=e}};this.trigger("move",t),t.defaultPrevented||this._setPosition(t.position)}},{key:"_onMouseUp",value:function(e){this._$window.off("mousemove.splitter"),this._$body.removeClass(this.splitHorizontal?"col-resize":"row-resize"),s()("iframe").removeClass("dragging-in-progress"),this.trigger("moveEnd",{position:this.position})}}])&&Tf(t.prototype,n),i&&Tf(t,i),o}(de),Af={YEAR:"year",MONTH:"month",WEEK_IN_YEAR:"week_in_year",DAY_IN_MONTH:"day_in_month",WEEKDAY:"weekday",HOUR_24:"hour_24",HOUR_12:"hour_12",AM_PM:"am_pm",MINUTE:"minute",SECOND:"second",MILLISECOND:"millisecond",TIMEZONE:"timezone"};function $f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jf=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.type=t.type,this.terms=t.terms,this.dateFormat=t.dateFormat,this.formatFunction=t.formatFunction&&t.formatFunction.bind(this),this.parseRegExp=t.parseRegExp,this.applyMatchFunction=t.applyMatchFunction&&t.applyMatchFunction.bind(this),this.parseFunction=t.parseFunction&&t.parseFunction.bind(this)}var t,n,i;return t=e,(n=[{key:"createFormatFunction",value:function(e){return function(t){if(this.formatFunction){var n=this.formatFunction(t,e);void 0!==n&&(t.formattedString+=n)}}.bind(this)}},{key:"createParseFunction",value:function(e){return function(t){var n,i,r,o=!1;return this.parseRegExp&&(n=this.parseRegExp.exec(t.inputString))&&(this.applyMatchFunction&&this.applyMatchFunction(t,n[1],e),r=n[1],t.inputString=n[2],o=!0),!o&&this.parseFunction&&null!==(r=this.parseFunction(t,e))&&(o=!0),o&&(i=this.terms[0],this.terms.length>1&&this.terms.some((function(e){return e.length===r.length&&(i=e,!0)})),t.parsedPattern+=i),o}.bind(this)}},{key:"accept",value:function(e){if(e)for(var t=0;t<this.terms.length;t++)if(e===this.terms[t])return this.terms[t];return null}}])&&$f(t.prototype,n),i&&$f(t,i),e}();function Mf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var If=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=i||{},this.locale=t,O.assertParameter("locale",this.locale),this.pattern=n||t.dateFormatPatternDefault,O.assertParameter("pattern",this.pattern),this.symbols=t.dateFormatSymbols,this.symbols.firstDayOfWeek=1,this.symbols.weekdaysOrdered=wt.orderWeekdays(this.symbols.weekdays,this.symbols.firstDayOfWeek),this.symbols.weekdaysShortOrdered=wt.orderWeekdays(this.symbols.weekdaysShort,this.symbols.firstDayOfWeek),this.symbols.monthsToNumber,this.symbols.monthsShortToNumber,this.lenient=O.nvl(i.lenient,!0),this._terms=[],this._formatFunctions=[],this._parseFunctions=[],this._analyzeFunctions=[],this._patternDefinitions=[new jf({type:Af.YEAR,terms:["yyyy"],dateFormat:this,formatFunction:function(e,t){return En.padZeroLeft(e.inputDate.getFullYear(),4).slice(-4)},parseRegExp:/^(\d{4})(.*)$/,applyMatchFunction:function(e,t,n){e.matchInfo.year=t,e.dateInfo.year=Number(t)}}),new jf({type:Af.YEAR,terms:["yyy","yy","y"],dateFormat:this,formatFunction:function(e,t){var n=String(e.inputDate.getFullYear()),i=e.exactLength?t.length:2;return 1===i?n.slice(-i):En.padZeroLeft(n,i).slice(-i)},parseRegExp:/^(\d{1,3})(.*)$/,applyMatchFunction:function(e,t,n){if(3===t.length)return e.dateInfo.year=Number(t),void(e.matchInfo.year=t);var i=(e.startDate||new Date).getFullYear(),r=Number(En.padZeroLeft(i,4).substr(0,2)+En.padZeroLeft(t,2)),o=r-i;o<=-50?r+=100:o>50&&(r-=100),e.dateInfo.year=r,e.matchInfo.year=t}}),new jf({type:Af.MONTH,terms:["MMMM"],dateFormat:this,formatFunction:function(e,t){return this.dateFormat.symbols.months[e.inputDate.getMonth()]},parseFunction:function(e,t){var n,i,r;for(n=0;n<this.dateFormat.symbols.months.length;n++)if((i=this.dateFormat.symbols.months[n])&&(r=new RegExp("^("+En.quote(i)+")(.*)$","i").exec(e.inputString)))return e.dateInfo.month=n,e.matchInfo.month=r[1],e.inputString=r[2],r[1];if(e.analyze)for(n=0;n<this.dateFormat.symbols.months.length;n++)if(i=this.dateFormat.symbols.months[n],r=new RegExp("^("+En.quote(e.inputString)+")(.*)$","i").exec(i))return e.dateInfo.month=n,e.matchInfo.month=i,e.inputString="",r[1];return null}}),new jf({type:Af.MONTH,terms:["MMM"],dateFormat:this,formatFunction:function(e,t){return this.dateFormat.symbols.monthsShort[e.inputDate.getMonth()]},parseFunction:function(e,t){var n,i,r;for(n=0;n<this.dateFormat.symbols.monthsShort.length;n++)if((i=this.dateFormat.symbols.monthsShort[n])&&(r=new RegExp("^("+En.quote(i)+")(.*)$","i").exec(e.inputString)))return e.dateInfo.month=n,e.matchInfo.month=r[1],e.inputString=r[2],r[1];if(e.analyze)for(n=0;n<this.dateFormat.symbols.monthsShort.length;n++)if(i=this.dateFormat.symbols.monthsShort[n],r=new RegExp("^("+En.quote(e.inputString)+")(.*)$","i").exec(i))return e.dateInfo.month=n,e.matchInfo.month=i,e.inputString="",r[1];return null}}),new jf({type:Af.MONTH,terms:["MM"],dateFormat:this,formatFunction:function(e,t){return En.padZeroLeft(e.inputDate.getMonth()+1,2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){var i=Number(t);e.dateInfo.month=i-1,e.matchInfo.month=t},parseFunction:function(e,t){if(e.analyze&&"0"===e.inputString){var n=this.dateFormat._dateInfoToDate(e.dateInfo);if(!n)return null;var i=n.getMonth();return i>=9&&(i=0,void 0===e.dateInfo.year?e.dateInfo.year=Number(n.getFullYear())+1:e.dateInfo.year=e.dateInfo.year+1),e.dateInfo.month=i,e.matchInfo.month=En.padZeroLeft(String(i+1),2),e.inputString="","0"}return null}}),new jf({type:Af.MONTH,terms:["M"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getMonth()+1)},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){var i=Number(t);e.dateInfo.month=i-1,e.matchInfo.month=t}}),new jf({type:Af.WEEK_IN_YEAR,terms:["ww"],dateFormat:this,formatFunction:function(e,t){return En.padZeroLeft(wt.weekInYear(e.inputDate),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.matchInfo.week=t,e.hints.weekInYear=Number(t)}}),new jf({type:Af.WEEK_IN_YEAR,terms:["w"],dateFormat:this,formatFunction:function(e,t){return String(wt.weekInYear(e.inputDate))},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.matchInfo.week=t,e.hints.weekInYear=Number(t)}}),new jf({type:Af.DAY_IN_MONTH,terms:["dd"],dateFormat:this,formatFunction:function(e,t){return En.padZeroLeft(e.inputDate.getDate(),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.day=Number(t),e.matchInfo.day=t},parseFunction:function(e,t){return e.analyze&&"0"===e.inputString?(e.dateInfo.day=1,e.matchInfo.day="01",e.inputString="","0"):null}}),new jf({type:Af.DAY_IN_MONTH,terms:["d"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getDate())},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.day=Number(t),e.matchInfo.day=t}}),new jf({type:Af.WEEKDAY,terms:["EEEE"],dateFormat:this,formatFunction:function(e,t){return this.dateFormat.symbols.weekdays[e.inputDate.getDay()]},parseFunction:function(e,t){var n,i,r;for(n=0;n<this.dateFormat.symbols.weekdays.length;n++)if((i=this.dateFormat.symbols.weekdays[n])&&(r=new RegExp("^("+En.quote(i)+")(.*)$","i").exec(e.inputString)))return e.matchInfo.weekday=r[1],e.hints.weekday=n,e.inputString=r[2],r[1];if(e.analyze)for(n=0;n<this.dateFormat.symbols.weekdays.length;n++)if(i=this.dateFormat.symbols.weekdays[n],r=new RegExp("^("+En.quote(e.inputString)+")(.*)$","i").exec(i))return e.matchInfo.weekday=i,e.hints.weekday=n,e.inputString="",r[1];return null}}),new jf({type:Af.WEEKDAY,terms:["EEE","EE","E"],dateFormat:this,formatFunction:function(e,t){return this.dateFormat.symbols.weekdaysShort[e.inputDate.getDay()]},parseFunction:function(e,t){var n,i,r;for(n=0;n<this.dateFormat.symbols.weekdaysShort.length;n++)if((i=this.dateFormat.symbols.weekdaysShort[n])&&(r=new RegExp("^("+En.quote(i)+")(.*)$","i").exec(e.inputString)))return e.matchInfo.weekday=r[1],e.hints.weekday=n,e.inputString=r[2],r[1];if(e.analyze)for(n=0;n<this.dateFormat.symbols.weekdaysShort.length;n++)if(i=this.dateFormat.symbols.weekdaysShort[n],r=new RegExp("^("+En.quote(e.inputString)+")(.*)$","i").exec(i))return e.matchInfo.weekday=i,e.hints.weekday=n,e.inputString="",r[1];return null}}),new jf({type:Af.HOUR_24,terms:["HH"],dateFormat:this,formatFunction:function(e,t){return En.padZeroLeft(e.inputDate.getHours(),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.hours=Number(t),e.matchInfo.hours=t}}),new jf({type:Af.HOUR_24,terms:["H"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getHours())},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.hours=Number(t),e.matchInfo.hours=t}}),new jf({type:Af.HOUR_12,terms:["hh"],dateFormat:this,formatFunction:function(e,t){return e.inputDate.getHours()%12==0?"12":En.padZeroLeft(e.inputDate.getHours()%12,2)},parseRegExp:/^(10|11|12|0[1-9])(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.hours=Number(t)+(e.hints.pm?12:0),e.matchInfo.hours=t},parseFunction:function(e,t){return e.analyze&&"0"===e.inputString?(e.dateInfo.hours=1,e.matchInfo.hours="01",e.inputString="",e.inputString):null}}),new jf({type:Af.HOUR_12,terms:["h"],dateFormat:this,formatFunction:function(e,t){return e.inputDate.getHours()%12==0?"12":String(e.inputDate.getHours()%12)},parseRegExp:/^(10|11|12|0?[1-9])(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.hours=Number(t)+(e.hints.pm?12:0),e.matchInfo.hours=t}}),new jf({type:Af.AM_PM,terms:["a"],dateFormat:this,formatFunction:function(e,t){return e.inputDate.getHours()<12?this.dateFormat.symbols.am:this.dateFormat.symbols.pm},parseFunction:function(e,t){var n=new RegExp("^("+En.quote(this.dateFormat.symbols.am)+")(.*)$","i"),i=n.exec(e.inputString);if(e.matchInfo.ampm=null,i)return e.matchInfo.ampm=i[1],e.inputString=i[2],e.hints.am=!0,e.dateInfo.hours=e.dateInfo.hours%12,i[1];if(i=(n=new RegExp("^("+En.quote(this.dateFormat.symbols.pm)+")(.*)$","i")).exec(e.inputString))return e.matchInfo.ampm=i[1],e.inputString=i[2],e.hints.pm=!0,e.dateInfo.hours=e.dateInfo.hours%12+12,i[1];if(e.analyze){if(i=(n=new RegExp("^("+En.quote(e.inputString)+")(.*)$","i")).exec(this.dateFormat.symbols.am))return e.matchInfo.ampm=this.dateFormat.symbols.am,e.inputString="",e.hints.am=!0,e.dateInfo.hours=e.dateInfo.hours%12,i[1];if(i=n.exec(this.dateFormat.symbols.pm))return e.matchInfo.ampm=this.dateFormat.symbols.pm,e.inputString="",e.hints.pm=!0,e.dateInfo.hours=e.dateInfo.hours%12+12,i[1]}return null}}),new jf({type:Af.MINUTE,terms:["mm"],dateFormat:this,formatFunction:function(e,t){return En.padZeroLeft(e.inputDate.getMinutes(),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.minutes=Number(t),e.matchInfo.minutes=t},parseFunction:function(e,t){if(e.analyze&&O.isOneOf(e.inputString,"0","1","2","3","4","5")){var n=e.inputString+"0";return e.dateInfo.minutes=Number(n),e.matchInfo.minutes=n,e.inputString="",e.inputString}return null}}),new jf({type:Af.MINUTE,terms:["m"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getMinutes())},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.minutes=Number(t),e.matchInfo.minutes=t}}),new jf({type:Af.SECOND,terms:["ss"],dateFormat:this,formatFunction:function(e,t){return En.padZeroLeft(e.inputDate.getSeconds(),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.seconds=Number(t),e.matchInfo.seconds=t}}),new jf({type:Af.SECOND,terms:["s"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getSeconds())},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.seconds=Number(t),e.matchInfo.seconds=t}}),new jf({type:Af.MILLISECOND,terms:["SSS"],dateFormat:this,formatFunction:function(e,t){return En.padZeroLeft(e.inputDate.getMilliseconds(),3)},parseRegExp:/^(\d{3})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.milliseconds=Number(t),e.matchInfo.milliseconds=t}}),new jf({type:Af.MILLISECOND,terms:["S"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getMilliseconds())},parseRegExp:/^(\d{1,3})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.milliseconds=Number(t),e.matchInfo.milliseconds=t}}),new jf({type:Af.TIMEZONE,terms:["Z"],dateFormat:this,formatFunction:function(e,t){var n=Math.abs(e.inputDate.getTimezoneOffset());return(n!==e.inputDate.getTimezoneOffset()?"-":"+")+En.padZeroLeft(Math.floor(n/60),2)+En.padZeroLeft(n%60,2)},parseRegExp:/^([+|-]\d{4})(.*)$/,applyMatchFunction:function(e,t,n){var i=60*Number(t.substr(1,2))+Number(t.substr(3,2));"-"===t.charAt(0)&&(i*=-1),e.dateInfo.timezone=i,e.matchInfo.timezone=t}})],this._patternLibrary={};for(var r=0;r<this._patternDefinitions.length;r++){var o=this._patternDefinitions[r],s=o.type;s&&(this._patternLibrary[s]||(this._patternLibrary[s]=[]),this._patternLibrary[s].push(o))}this._compile()}var t,n,i;return t=e,i=[{key:"ensure",value:function(t,n){return n?n instanceof e?n:new e(t,n):n}}],(n=[{key:"_compile",value:function(){var e,t,n,i,r,o,s,a,u;for(r=/(.)\1*/g;o=r.exec(this.pattern);){for(s=o[0],this._terms.push(s),a=!1,e=0;e<this._patternDefinitions.length;e++){var l=(i=this._patternDefinitions[e]).accept(s);if(l){if(this._formatFunctions.push(i.createFormatFunction(l)),this._parseFunctions.push(i.createParseFunction(l)),u=[i.createParseFunction(l)],this.lenient)for(n=this._patternLibrary[i.type],t=0;t<n.length;t++)n[t]!==i&&u.push(n[t].createParseFunction(l));this._analyzeFunctions.push(u),a=!0;break}}if(!a){this._formatFunctions.push(this._createConstantStringFormatFunction(s));var c=this._createConstantStringParseFunction(s);this._parseFunctions.push(c),this._analyzeFunctions.push([c])}}}},{key:"_createConstantStringFormatFunction",value:function(e){return function(t){t.formattedString+=e}}},{key:"_createConstantStringParseFunction",value:function(e){return function(t){return En.startsWith(t.inputString,e)?(t.inputString=t.inputString.substr(e.length),t.parsedPattern+=e,!0):t.analyze}}},{key:"format",value:function(e,t){if(!e)return"";var n=this._createFormatContext(e);n.exactLength=O.nvl(t,!1);for(var i=0;i<this._formatFunctions.length;i++)(0,this._formatFunctions[i])(n);return n.formattedString}},{key:"analyze",value:function(e,t){var n=this._createAnalyzeInfo(e);if(!e)return n;var i=this._createParseContext(e);i.analyze=!0,i.startDate=t;for(var r="",o=0;o<this._terms.length;o++)if(i.inputString.length>0){for(var s=this._analyzeFunctions[o],a=!1,u=0;u<s.length;u++)if((0,s[u])(i)){a=!0;break}if(!a)return n.error=!0,n;r=i.parsedPattern}else i.parsedPattern+=this._terms[o];if(i.inputString.length>0)return n.error=!0,n;t=this._prepareStartDate(t);var l=i.hints.weekday,c=i.dateInfo.day;void 0!==l&&(t=void 0!==c&&c<=31?wt.shiftToNextDayAndDate(t,l,c):wt.shiftToNextDayOfType(t,l));var f=this._dateInfoToDate(i.dateInfo,t,i.hints);return n.dateInfo=i.dateInfo,n.matchInfo=i.matchInfo,n.hints=i.hints,n.parsedPattern=i.parsedPattern,n.matchedPattern=r,n.predictedDate=f,n.error=!f,n}},{key:"parse",value:function(e,t){if(!e)return null;var n=this._createParseContext(e);n.startDate=t;for(var i=0;i<this._parseFunctions.length;i++){if(!(0,this._parseFunctions[i])(n))return null;if(0===n.inputString.length)break}if(n.inputString.length>0)return null;var r=this._dateInfoToDate(n.dateInfo,t);return r?void 0!==n.hints.weekday&&r.getDay()!==n.hints.weekday?null:r:null}},{key:"_dateInfoToDate",value:function(e,t,n){if(!e)return null;t=this._prepareStartDate(t);var i=new Date(1970,0,1),r=O.nvl(e.day,t.getDate()),o=O.nvl(e.month,t.getMonth()),s=O.nvl(e.year,t.getFullYear());if(e.day&&!e.month&&(31===e.day?O.isOneOf(o,[0,2,4,6,7,9,11])||(o+=1):e.day>=29&&1===o&&(e.day>29||!wt.isLeapYear(s))&&(o+=1)),!e.day&&e.month){var a=wt.shift(new Date(s,e.month+1,1),0,0,-1);r=Math.min(a.getDate(),t.getDate())}return i.setFullYear(s,o,r),i.setHours(O.nvl(e.hours,t.getHours()),O.nvl(e.minutes,t.getMinutes()),O.nvl(e.seconds,t.getSeconds()),O.nvl(e.milliseconds,t.getMilliseconds())),u(i.getFullYear(),e.year)&&u(i.getMonth(),e.month)&&u(i.getDate(),e.day)&&u(i.getHours(),e.hours)&&u(i.getMinutes(),e.minutes)&&u(i.getSeconds(),e.seconds)&&u(i.getMilliseconds(),e.milliseconds)&&u(i.getDay(),oi.optProperty(n,"weekday"))?(Gn.isNumber(e.timezone)&&i.setMinutes(i.getMinutes()-i.getTimezoneOffset()+e.timezone),i):null;function u(e,t){return oi.isNullOrUndefined(t)||t===e}}},{key:"_prepareStartDate",value:function(e){return e?new Date(e.getTime()):wt.trunc(new Date)}},{key:"_createFormatContext",value:function(e){return{inputDate:e,formattedString:"",exactLength:!1}}},{key:"_createParseContext",value:function(e){return{inputString:e,dateInfo:{},matchInfo:{},hints:{},parsedPattern:"",analyze:!1,startDate:null}}},{key:"_createAnalyzeInfo",value:function(e){return{inputString:e,dateInfo:{},matchInfo:{},hints:{},parsedPattern:"",matchedPattern:"",predictedDate:null,error:!1}}}])&&Mf(t.prototype,n),i&&Mf(t,i),e}();function Lf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Bf=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.positivePrefix="",this.positiveSuffix="",this.negativePrefix=t.decimalFormatSymbols.minusSign,this.negativeSuffix="",this.groupingChar=t.decimalFormatSymbols.groupingSeparator,this.lenientGroupingChars="'´`’·    ",this.groupLength=0,this.decimalSeparatorChar=t.decimalFormatSymbols.decimalSeparator,this.zeroBefore=1,this.zeroAfter=0,this.allAfter=0,"string"==typeof n&&(this.pattern=n),n=n||{},this.pattern=this.pattern||n.pattern||t.decimalFormatPatternDefault,this.multiplier=n.multiplier||1,this.roundingMode=n.roundingMode||Un.HALF_UP;var i=e.PATTERN_SYMBOLS,r=this.pattern.split(i.patternSeparator),o=l(r[0]);if(this.positivePrefix=o.prefix,this.positiveSuffix=o.suffix,r.length>1){var s=l(r[1]);this.negativePrefix=s.prefix,this.negativeSuffix=s.suffix,this.pattern=r[0]}else-1!==this.positivePrefix.indexOf(i.minusSign)||-1!==this.positiveSuffix.indexOf(i.minusSign)?(this.negativePrefix=this.positivePrefix.replace(i.minusSign,t.decimalFormatSymbols.minusSign),this.negativeSuffix=this.positiveSuffix.replace(i.minusSign,t.decimalFormatSymbols.minusSign),this.positivePrefix=this.positivePrefix.replace(i.minusSign,""),this.positiveSuffix=this.positiveSuffix.replace(i.minusSign,"")):(this.negativePrefix=this.positivePrefix+this.negativePrefix,this.negativeSuffix=this.negativeSuffix+this.positiveSuffix);var a=this.pattern.indexOf(i.decimalSeparator);-1===a&&(a=this.pattern.length);var u=this.pattern.lastIndexOf(i.groupingSeparator,a);function l(e){var t={prefix:"",suffix:""},n=i.digit+i.zeroDigit+i.decimalSeparator+i.groupingSeparator,r=new RegExp("^(.*?)["+n+"].*$"),o=r.exec(e);return null!==o&&(t.prefix=o[1].replace(new RegExp("'([^']+)'","g"),"$1")),null!==(o=(r=new RegExp("^.*["+n+"](.*?)$")).exec(e))&&(t.suffix=o[1].replace(new RegExp("'([^']+)'","g"),"$1")),t}u>0&&(this.groupLength=a-u-1),this.pattern=this.pattern.replace(new RegExp("["+i.groupingSeparator+"]","g"),""),r=this.pattern.split(i.decimalSeparator),this.zeroBefore=En.count(r[0],i.zeroDigit),r.length>1&&(this.zeroAfter=En.count(r[1],i.zeroDigit),this.allAfter=this.zeroAfter+En.count(r[1],i.digit))}var t,n,i;return t=e,i=[{key:"ensure",value:function(t,n){return n?n instanceof e?n:new e(t,n):n}}],(n=[{key:"parse",value:function(e,t){if(En.empty(e))return null;var n=this.normalize(e),i=(t=t||Number)(n);if(isNaN(i))throw new Error(e+" is not a number (NaN)");return 1!==this.multiplier&&(i/=this.multiplier),i}},{key:"format",value:function(e,t){if(t=O.nvl(t,!0),null==e)return null;var n=this.positivePrefix,i=this.positiveSuffix;t&&1!==this.multiplier&&(e*=this.multiplier),e=this.round(e);var r="";if(this.allAfter){for(var o=(r=e.toFixed(this.allAfter).split(".")[1]).length-1;o>this.zeroAfter-1&&"0"===r[o];o--)r=r.slice(0,-1);r&&(r=this.decimalSeparatorChar+r)}e<0&&(n=this.negativePrefix,i=this.negativeSuffix,e=-e);var s=Math.floor(e);if(s=0===s?"":String(s),s=En.padZeroLeft(s,this.zeroBefore),this.groupLength)for(var a=s.length-this.groupLength;a>0;a-=this.groupLength)s=s.substr(0,a)+this.groupingChar+s.substr(a);return n+s+r+i}},{key:"round",value:function(e,t){return t=O.nvl(t,!0),null==e?null:(t&&1!==this.multiplier&&(e*=this.multiplier),e=Gn.round(e,this.roundingMode,this.allAfter),t&&1!==this.multiplier&&(e/=this.multiplier),e)}},{key:"normalize",value:function(e){return e?e.replace(new RegExp("["+this.groupingChar+this.lenientGroupingChars+"]","g"),"").replace(new RegExp("["+this.decimalSeparatorChar+"]","g"),".").replace(/\s/g,""):e}}])&&Lf(t.prototype,n),i&&Lf(t,i),e}();function Nf(e){return function(e){if(Array.isArray(e))return Hf(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Hf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hf(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Vf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Bf,"PATTERN_SYMBOLS",{digit:"#",zeroDigit:"0",decimalSeparator:".",groupingSeparator:",",minusSign:"-",patternSeparator:";"});var Wf=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=t||{}}var t,n,i;return t=e,(n=[{key:"get",value:function(e){var t;if(!this._exists(e))return this.parent?(t=this.parent).get.apply(t,arguments):"[undefined text: "+e+"]";var n=arguments.length,i=this.map[e];if(1===n)return i;for(var r=1;r<n;r++)i=i.replace(new RegExp("\\{"+(r-1)+"\\}","g"),arguments[r]);return i}},{key:"optGet",value:function(e,t){var n;if(!this._exists(e))return this.parent?(n=this.parent).optGet.apply(n,arguments):t;if(arguments.length>2){var i=Array.prototype.slice.call(arguments).slice(2);return i.unshift(e),this.get.apply(this,Nf(i))}return this.get(e)}},{key:"exists",value:function(e){return!!this._exists(e)||!!this.parent&&this.parent.exists(e)}},{key:"_exists",value:function(e){return this.map.hasOwnProperty(e)}},{key:"add",value:function(e,t){this.map[e]=t}},{key:"addAll",value:function(t){t&&(t instanceof e&&(t=t.map),oi.copyOwnProperties(t,this.map))}},{key:"setParent",value:function(e){this.parent=e}},{key:"remove",value:function(e){delete this.map[e]}}])&&Vf(t.prototype,n),i&&Vf(t,i),e}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Wf,"TEXT_KEY_REGEX",/\${textKey:([a-zA-Z0-9.]*)}/);var zf=/\${textKey:([^}]*)}/,Gf={};function Uf(e,t){if(t&&t.error)throw{error:t.error,url:e};Kf(t)}function Kf(e){Object.keys(e).forEach((function(t){Xf(t).addAll(e[t])}),this)}function qf(e){var t;Yf(e).forEach((function(e){var n=Jf(e);n||Zf(e,n=new Wf),t&&t.setParent(n),t=n}),this)}function Yf(e){var t=[],n=e.lastIndexOf("-");for(t.push(e);n>=0;)e=e.substring(0,n),t.push(e),n=e.lastIndexOf("-");return"default"!==e&&t.push("default"),t}function Xf(e){var t=Jf(e);if(t)return t;if(qf(e),!(t=Jf(e)))throw new Error("Texts missing for the language tag "+e);return t}function Jf(e){return Gf[e]}function Zf(e,t){Gf[e]=t}function Qf(e){var t=zf.exec(e);return t&&2===t.length?t[1]:e}function eh(e,t){var n=Qf(e);return n!==e?Xf(t).get(n):e}var th={TEXT_KEY_REGEX:zf,bootstrap:function(e){return(e?s.a.ajaxJson(e):s.a.resolvedPromise({})).then(Uf.bind(this,e))},buildKey:function(e){return"${textKey:"+e+"}"},createOrderedLanguageTags:Yf,get:Xf,init:Kf,link:qf,put:Zf,readFromDOM:function(){var e={};return s()("scout-text").each((function(){var t=s()(this).data("key"),n=s()(this).data("value");e[t]=n})),e},resolveKey:Qf,resolveText:eh,resolveTextProperty:function(e,t,n){t=t||"text",n=e.session||n;var i=e[t],r=eh(i,n.locale.languageTag);r!==i&&(e[t]=r)},textsByLocale:Gf};function nh(e){return(nh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ih(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rh(e,t,n){return(rh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uh(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function oh(e,t){return(oh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=uh(e);if(t){var r=uh(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ah(this,n)}}function ah(e,t){return!t||"object"!==nh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uh(e){return(uh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oh(e,t)}(o,e);var t,n,i,r=sh(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).text=null,e.arrowPosition=25,e.arrowPositionUnit="%",e.windowPaddingX=10,e.windowPaddingY=5,e.origin=null,e.originRelativeToParent=!1,e.$anchor=null,e.autoRemove=!0,e.tooltipPosition="top",e.scrollType="position",e.htmlEnabled=!1,e.$content=null,e.menus=[],e._addWidgetProperties(["menus"]),e._openLater=!1,e}return t=o,i=[{key:"computeHypotenuse",value:function(e){return Math.sqrt(Math.pow(e,2)+Math.pow(e,2))}}],(n=[{key:"render",value:function(e){var t=e||this.entryPoint();if(!t||!t.length||!t.isAttached())return this._openLater=!0,void(this.$parent=t);rh(uh(o.prototype),"render",this).call(this,t)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tooltip").data("tooltip",this),this.cssClass&&this.$container.addClass(this.cssClass),this.$arrow=this.$container.appendDiv("tooltip-arrow"),this.$content=this.$container.appendDiv("tooltip-content"),this._renderText(),this._renderSeverity(),this._renderMenus(),this.autoRemove&&(this._mouseDownHandler=this._onDocumentMouseDown.bind(this),this.$container.document(!0).addEventListener("mousedown",this._mouseDownHandler,!0),this._keydownHandler=this._onDocumentKeyDown.bind(this),this.$container.document().on("keydown",this._keydownHandler)),this.$anchor&&this.scrollType&&(this._anchorScrollHandler=this._onAnchorScroll.bind(this),wf.onScroll(this.$anchor,this._anchorScrollHandler)),this.dialog=null;for(var e=this.parent;e;){if(e instanceof ZO&&e.isDialog()){this.dialog=e;break}e=e.parent}this.dialog&&(this._moveHandler=this.position.bind(this),this.dialog.on("move",this._moveHandler))}},{key:"_postRender",value:function(){rh(uh(o.prototype),"_postRender",this).call(this),this.position()}},{key:"_remove",value:function(){this._mouseDownHandler&&(this.$container.document(!0).removeEventListener("mousedown",this._mouseDownHandler,!0),this._mouseDownHandler=null),this._keydownHandler&&(this.$container.document().off("keydown",this._keydownHandler),this._keydownHandler=null),this._anchorScrollHandler&&(wf.offScroll(this._anchorScrollHandler),this._anchorScrollHandler=null),this._moveHandler&&(this.dialog&&this.dialog.off("move",this._moveHandler),this._moveHandler=null),this.dialog=null,this.$menus=null,rh(uh(o.prototype),"_remove",this).call(this)}},{key:"_onAttach",value:function(){rh(uh(o.prototype),"_onAttach",this).call(this),this._openLater&&!this.rendered&&(this._openLater=!1,this.render())}},{key:"_renderOnDetach",value:function(){this._openLater=!0,this.remove(),rh(uh(o.prototype),"_onDetach",this).call(this)}},{key:"_isRemovalPrevented",value:function(){return!1}},{key:"setText",value:function(e){this.setProperty("text",e)}},{key:"setSeverity",value:function(e){this.setProperty("severity",e)}},{key:"_renderText",value:function(){var e=this.text||"";this.htmlEnabled?this.$content.html(e):this.$content.html(En.nl2br(e)),this.$content.setVisible(!!e),this.$container.toggleClass("no-text",!e),this.rendering||this.position()}},{key:"_renderSeverity",value:function(){this.$container.removeClass(pi.SEVERITY_CSS_CLASSES),this.$container.addClass(pi.cssClassForSeverity(this.severity))}},{key:"setMenus",value:function(e){e=et.ensure(e),this.setProperty("menus",e)}},{key:"_renderMenus",value:function(){var e=0,t=this.menus;t.length>0&&!this.$menus?this.$menus=this.$container.appendDiv("tooltip-menus"):0===t.length&&this.$menus&&(this.$menus.remove(),this.$menus=null),t.forEach((function(t){var n=0;t.render(this.$menus),t.iconId&&(n=t.get$Icon().outerWidth(!0),e=Math.max(n,e))}),this),e>0&&t.forEach((function(t){t.iconId?t.$text.cssPaddingLeft(e-t.get$Icon().outerWidth(!0)):t.$text.cssPaddingLeft(e)}),this),this.rendering||this.position()}},{key:"position",value:function(){var e,t,n,i,r,s,a,u,l,c,f,h,d;if(s=this.origin?(u=this.origin).x:(u=No.offsetBounds(this.$anchor)).x+u.width/2,a=u.y,this.$anchor&&(d=wf.isLocationInView(u,this.$anchor.scrollParent()),this.$container.setVisible(d)),!this.originRelativeToParent){var p=this.$parent.offset();s-=p.left,a-=p.top}f=this.$arrow.outerWidth(),n=o.computeHypotenuse(f)/2,c=this.$container.outerHeight(),l=this.$container.outerWidth(),h=this.arrowPosition,"%"===this.arrowPositionUnit&&(h=l*this.arrowPosition/100),e=a-c-n,i=(t=s-h)+l+this.windowPaddingX-this.$parent.width(),r=e-this.windowPaddingY,i>0&&(h=s-(t-=i)),this.$arrow.removeClass("arrow-top arrow-bottom"),"bottom"===this.tooltipPosition||r<0?(this.$arrow.addClass("arrow-top"),e=a+u.height+n):this.$arrow.addClass("arrow-bottom"),h=Math.min(h,this.$container.outerWidth()-n),h=Math.max(h,n),this.$arrow.cssLeft(h),this.$container.cssLeft(t).cssTop(e),this.menus.forEach((function(e){e.popup&&e.popup.position()}),this)}},{key:"_onAnchorScroll",value:function(e){this.rendered&&("position"===this.scrollType?this.position():"remove"===this.scrollType&&this.destroy())}},{key:"_onDocumentMouseDown",value:function(e){if(!this.rendered)return!1;this._isMouseDownOutside(e)&&this._onMouseDownOutside(e)}},{key:"_isMouseDownOutside",value:function(e){var t=s()(e.target),n=O.widget(t);return!this.isOrHas(n)&&this.$anchor&&!this.$anchor.isOrHas(t[0])&&!this.session.focusManager.isElementCovertByGlassPane(this.$container[0])}},{key:"_onMouseDownOutside",value:function(){this.destroy()}},{key:"_onDocumentKeyDown",value:function(e){O.isOneOf(e.which,pu.CTRL,pu.SHIFT,pu.ALT,pu.NUM_LOCK,pu.CAPS_LOCK,pu.SCROLL_LOCK,pu.WIN_LEFT,pu.WIN_RIGHT,pu.SELECT,pu.PAUSE,pu.PRINT_SCREEN)||this.destroy()}}])&&ih(t.prototype,n),i&&ih(t,i),o}(de);function ch(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fh=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n={selector:null,delay:dh.DEFAULT_TOOLTIP_DELAY,text:void 0,nativeTooltip:!1};t=s.a.extend({},n,t),this._options=t,this._mouseEnterHandler=this._onMouseEnter.bind(this),this._mouseLeaveHandler=this._onMouseLeave.bind(this),this._tooltip=null,this._tooltipTimeoutId=null}var t,n,i;return t=e,(n=[{key:"install",value:function(e){e.data("tooltipSupport")||e.on("mouseenter",this._options.selector,this._mouseEnterHandler).on("mouseleave",this._options.selector,this._mouseLeaveHandler).data("tooltipSupport",this)}},{key:"uninstall",value:function(e){e.removeData("tooltipSupport").off("mouseleave",this._options.selector,this._mouseLeaveHandler).off("mouseenter",this._options.selector,this._mouseEnterHandler),this._destroyTooltip()}},{key:"update",value:function(e,t){s.a.extend(this._options,t),this._tooltip&&this._showTooltip(e)}},{key:"cancel",value:function(e){clearTimeout(this._tooltipTimeoutId)}},{key:"close",value:function(){this._destroyTooltip()}},{key:"_onMouseEnter",value:function(e){var t=s()(e.currentTarget);if(this._options.nativeTooltip){var n=this._text(t);t.attr("title",n)}else clearTimeout(this._tooltipTimeoutId),this._tooltipTimeoutId=setTimeout(this._showTooltip.bind(this,t),this._options.delay)}},{key:"_onMouseLeave",value:function(e){this._destroyTooltip()}},{key:"_destroyTooltip",value:function(){clearTimeout(this._tooltipTimeoutId),this._tooltip&&(this._tooltip.destroy(),this._tooltip=null)}},{key:"_text",value:function(e){var t=this._options.text||e.data("tooltipText");return s.a.isFunction(t)&&(t=t(e)),t}},{key:"_htmlEnabled",value:function(e){var t=this._options.htmlEnabled||e.data("htmlEnabled");return s.a.isFunction(t)&&(t=t(e)),O.nvl(t,!1)}},{key:"_showTooltip",value:function(e){if(e&&e.isAttached()){var t=this._text(e);if(t){var n=this._htmlEnabled(e);if(this._tooltip&&this._tooltip.rendered)this._tooltip.setText(t),this._tooltip.setSeverity(this._options.severity),this._tooltip.setMenus(this._options.menus);else{var i=s.a.extend({},this._options,{$anchor:this._options.$anchor||e,text:t,htmlEnabled:n});this._tooltip=O.create("Tooltip",i),this._tooltip.render(i.$parent)}}}}}])&&ch(t.prototype,n),i&&ch(t,i),e}();function hh(e,t){var n=e.data("tooltipSupport");n?n.update(e,t):(n=new fh(t)).install(e)}var dh={DEFAULT_TOOLTIP_DELAY:600,LONG_TOOLTIP_DELAY:2e3,cancel:function(e){var t=e.data("tooltipSupport");t&&t.cancel(e)},close:function(e){var t=e.data("tooltipSupport");t&&t.close()},find:function(e){var t,n,i,r=[];for(t=s()(".tooltip",e.document(!0)),n=0;n<t.length;n++)i=t.eq(n).data("tooltip"),e.has(i.$anchor).length>0&&r.push(i);return r},install:hh,installForEllipsis:function(e,t){var n={text:function(e){if(e.isContentTruncated())return e.text()},nativeTooltip:!Mt.get().isCustomEllipsisTooltipPossible()};hh(e,t=s.a.extend({},n,t))},uninstall:function(e){var t=e.data("tooltipSupport");t&&t.uninstall(e)},update:function(e,t){var n=e.data("tooltipSupport");n&&n.update(e,t)}};function ph(e){return(ph="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vh(e,t,n){return(vh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_h(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function bh(e,t){return(bh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_h(e);if(t){var r=_h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return mh(this,n)}}function mh(e,t){return!t||"object"!==ph(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _h(e){return(_h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bh(e,t)}(o,e);var t,n,i,r=gh(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).$widgetContainer=null,e.widget=null,e._addWidgetProperties(["widget"]),e.keyStrokeStopPropagationInterceptor=function(e){O.isOneOf(e.which,pu.ESC,pu.ENTER)||e.stopPropagation()},e.withFocusContext=!0,e.initialFocus=function(){return Pc.AUTO},e.focusableContainer=!1,e}return t=o,(n=[{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){vh(_h(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeStopPropagationInterceptor&&this.keyStrokeContext.registerStopPropagationInterceptor(this.keyStrokeStopPropagationInterceptor)}},{key:"_render",value:function(){vh(_h(o.prototype),"_render",this).call(this),this.$container.addClass("widget-tooltip"),this.$widgetContainer=this.$container.appendDiv("tooltip-widget-container")}},{key:"_renderProperties",value:function(){vh(_h(o.prototype),"_renderProperties",this).call(this),this._renderWidget()}},{key:"_remove",value:function(){this._removeWidget(),vh(_h(o.prototype),"_remove",this).call(this)}},{key:"setWidget",value:function(e){this.setProperty("widget",e)}},{key:"_renderWidget",value:function(){this.widget&&(this.widget.render(this.$widgetContainer),this.widget.$container.addClass("widget"),this.widget.pack()),this.$widgetContainer.setVisible(!!this.widget),this.rendering||this.position(),this.withFocusContext&&this.widget&&this.session.focusManager.installFocusContext(this.$widgetContainer,this.initialFocus())}},{key:"_removeWidget",value:function(){this.widget&&(this.session.focusManager.uninstallFocusContext(this.$widgetContainer),this.widget.remove())}}])&&yh(t.prototype,n),i&&yh(t,i),o}(lh);function kh(e){return(kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oh(e,t,n){return(Oh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rh(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Th(e,t){return(Th=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ch(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Rh(e);if(t){var r=Rh(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ph(this,n)}}function Ph(e,t){return!t||"object"!==kh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rh(e){return(Rh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Eh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Th(e,t)}(o,e);var t,n,i,r=Ch(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).actionStyle=o.ActionStyle.DEFAULT,e.compact=!1,e.iconId=null,e.horizontalAlignment=-1,e.keyStroke=null,e.keyStrokeFirePolicy=o.KeyStrokeFirePolicy.ACCESSIBLE_ONLY,e.selected=!1,e.preventDoubleClick=!1,e.tabbable=!1,e.text=null,e.textVisible=!0,e.toggleAction=!1,e.tooltipText=null,e.showTooltipWhenSelected=!0,e._doubleClickSupport=new Lt,e._addCloneProperties(["actionStyle","horizontalAlignment","iconId","selected","preventDoubleClick","tabbable","text","tooltipText","toggleAction"]),e}return t=o,(n=[{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_init",value:function(e){Oh(Rh(o.prototype),"_init",this).call(this,e),this.actionKeyStroke=this._createActionKeyStroke(),this.resolveConsts([{property:"actionStyle",constType:o.ActionStyle},{property:"keyStrokeFirePolicy",constType:o.KeyStrokeFirePolicy}]),this.resolveTextKeys(["text","tooltipText"]),this.resolveIconIds(["iconId"]),this._setKeyStroke(this.keyStroke)}},{key:"_render",value:function(){var e=this;this.$container=this.$parent.appendDiv("action").on("mousedown",(function(t){return e._doubleClickSupport.mousedown(t)})).on("click",this._onClick.bind(this)),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}},{key:"_createLayout",value:function(){return new ya}},{key:"_renderProperties",value:function(){Oh(Rh(o.prototype),"_renderProperties",this).call(this),this._renderText(),this._renderIconId(),this._renderTooltipText(),this._renderKeyStroke(),this._renderSelected(),this._renderTabbable(),this._renderCompact()}},{key:"_remove",value:function(){this._removeText(),this._removeIconId(),Oh(Rh(o.prototype),"_remove",this).call(this)}},{key:"setText",value:function(e){this.setProperty("text",e)}},{key:"_renderText",value:function(){var e=this.text||"";e&&this.textVisible?(this.$text||(this.$text=this.$container.appendSpan("content text"),Uo.install(this.$text,this.session)),this.$text.text(e)):this._removeText()}},{key:"_removeText",value:function(){this.$text&&(this.$text.remove(),this.$text=null)}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(){var e=this.iconId||"";e?this.icon?this.icon.setIconDesc(e):(this.icon=O.create("Icon",{parent:this,iconDesc:e,prepend:!0}),this.icon.one("destroy",function(){this.icon=null}.bind(this)),this.icon.render()):this._removeIconId()}},{key:"get$Icon",value:function(){return this.icon?this.icon.$container:s()()}},{key:"_removeIconId",value:function(){this.icon&&this.icon.destroy()}},{key:"_renderEnabled",value:function(){Oh(Rh(o.prototype),"_renderEnabled",this).call(this),this.rendered&&(this._updateTooltip(),this._renderTabbable())}},{key:"setTooltipText",value:function(e){this.setProperty("tooltipText",e)}},{key:"_renderTooltipText",value:function(){this._updateTooltip()}},{key:"_updateTooltip",value:function(){this._shouldInstallTooltip()?dh.install(this.$container,this._configureTooltip()):dh.uninstall(this.$container)}},{key:"_shouldInstallTooltip",value:function(){var e=this.tooltipText&&this.enabledComputed;return!this.showTooltipWhenSelected&&this.selected&&(e=!1),e}},{key:"_renderTabbable",value:function(){this.$container.setTabbable(this.tabbable&&this.enabledComputed&&!Mt.get().supportsOnlyTouch())}},{key:"_renderCompact",value:function(){this.$container.toggleClass("compact",this.compact),this.invalidateLayoutTree()}},{key:"setTooltipPosition",value:function(e){this.setProperty("tooltipPosition",e)}},{key:"_configureTooltip",value:function(){return{parent:this,text:this.tooltipText,$anchor:this.$container,arrowPosition:50,arrowPositionUnit:"%",tooltipPosition:this.tooltipPosition}}},{key:"doAction",value:function(){return!!this.prepareDoAction()&&(this.isToggleAction()&&this.setSelected(!this.selected),this._doAction(),!0)}},{key:"toggle",value:function(){this.isToggleAction()&&this.setSelected(!this.selected)}},{key:"setToggleAction",value:function(e){this.setProperty("toggleAction",e)}},{key:"isToggleAction",value:function(){return this.toggleAction}},{key:"prepareDoAction",value:function(){return!(!this.enabledComputed||!this.visible)}},{key:"_doAction",value:function(){this.trigger("action")}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.toggleClass("selected",this.selected),this.rendered&&this._updateTooltip()}},{key:"setKeyStroke",value:function(e){this.setProperty("keyStroke",e)}},{key:"_setKeyStroke",value:function(e){this.actionKeyStroke.parseAndSetKeyStroke(e),this._setProperty("keyStroke",e)}},{key:"_renderKeyStroke",value:function(){var e=this.keyStroke;void 0===e?this.$container.removeAttr("data-shortcut"):this.$container.attr("data-shortcut",e)}},{key:"setTabbable",value:function(e){this.setProperty("tabbable",e)}},{key:"setTextVisible",value:function(e){this.textVisible!==e&&(this._setProperty("textVisible",e),this.rendered&&this._renderText())}},{key:"setActionStyle",value:function(e){this.setProperty("actionStyle",e)}},{key:"setCompact",value:function(e){this.compact!==e&&(this.compact=e,this.rendered&&this._renderCompact())}},{key:"setHorizontalAlignment",value:function(e){this.setProperty("horizontalAlignment",e)}},{key:"_createActionKeyStroke",value:function(){return new Uh(this)}},{key:"setPreventDoubleClick",value:function(e){this.setProperty("preventDoubleClick",e)}},{key:"_allowMouseEvent",value:function(e){return!(1!==e.which||"click"===e.type&&this.preventDoubleClick&&this._doubleClickSupport.doubleClicked())}},{key:"_onClick",value:function(e){this._allowMouseEvent(e)&&(dh.cancel(this.$container),this.doAction())}}])&&Sh(t.prototype,n),i&&Sh(t,i),o}(de);function Dh(e){return(Dh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ah(e,t,n){return(Ah="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ih(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function $h(e,t){return($h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ih(e);if(t){var r=Ih(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Mh(this,n)}}function Mh(e,t){return!t||"object"!==Dh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ih(e){return(Ih=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}xh(Eh,"ActionStyle",{DEFAULT:0,BUTTON:1}),xh(Eh,"KeyStrokeFirePolicy",{ACCESSIBLE_ONLY:0,ALWAYS:1});var Lh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$h(e,t)}(o,e);var t,n,i,r=jh(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["selected"]),e}return t=o,(n=[{key:"_goOffline",value:function(){this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1)}},{key:"_goOnline",value:function(){this.widget.setEnabled(this._enabledBeforeOffline)}},{key:"_onWidgetAction",value:function(e){this.widget.isToggleAction()||this._send("action")}},{key:"_onWidgetEvent",value:function(e){"action"===e.type?this._onWidgetAction(e):Ah(Ih(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&Fh(t.prototype,n),i&&Fh(t,i),o}(fe);function Bh(e){return(Bh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hh(e,t,n){return(Hh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gh(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Vh(e,t){return(Vh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Gh(e);if(t){var r=Gh(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return zh(this,n)}}function zh(e,t){return!t||"object"!==Bh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gh(e){return(Gh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Uh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vh(e,t)}(o,e);var t,n,i,r=Wh(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.parseAndSetKeyStroke(e.keyStroke),t.keyStrokeFirePolicy=e.keyStrokeFirePolicy,t.stopPropagation=!0,t.stopImmediatePropagation=!0,t}return t=o,(n=[{key:"_isEnabled",value:function(){return!!this.which.length&&Hh(Gh(o.prototype),"_isEnabled",this).call(this)}},{key:"handle",value:function(e){this.field.doAction()}}])&&Nh(t.prototype,n),i&&Nh(t,i),o}($u);function Kh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var qh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$parent=null}var t,n,i;return t=e,(n=[{key:"render",value:function(e){this.$parent=e,this._render(),this.rendered=!0}},{key:"remove",value:function(){this.$container.remove(),this.$container=null,this.rendered=!1}},{key:"_render",value:function(){this.$container=s()("<div>").addClass("box").appendTo(this.$parent),this.$wrapper=s()("<div>").addClass("wrapper").appendTo(this.$container),this.$content=s()("<div>").addClass("box-content").appendTo(this.$wrapper),this.logoUrl&&(this.$header=this.$content.appendDiv("header"),this.$logo=s()("<img>").addClass("logo").attr("src",this.logoUrl).appendTo(this.$header))}}])&&Kh(t.prototype,n),i&&Kh(t,i),e}();function Yh(e){return(Yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jh(e,t,n){return(Jh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=td(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Zh(e,t){return(Zh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=td(e);if(t){var r=td(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ed(this,n)}}function ed(e,t){return!t||"object"!==Yh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function td(e){return(td=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zh(e,t)}(o,e);var t,n,i,r=Qh(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).value=null,e.htmlEnabled=!1,e.scrollable=!1,e}return t=o,(n=[{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){Jh(td(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new CH(this,this._onAppLinkAction))}},{key:"_init",value:function(e){Jh(td(o.prototype),"_init",this).call(this,e),this.resolveTextKeys(["value"])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv(),this.htmlComp=Uo.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){Jh(td(o.prototype),"_renderProperties",this).call(this),this._renderValue(),this._renderScrollable()}},{key:"setValue",value:function(e){this.setProperty("value",e)}},{key:"_renderValue",value:function(){var e=this.value||"";this.htmlEnabled?(this.$container.html(e),this.$container.find(".app-link").on("click",this._onAppLinkAction.bind(this)),this.$container.find("img").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this))):this.$container.html(En.nl2br(e)),this.rendered&&(this._uninstallScrollbars(),this._renderScrollable()),this.invalidateLayoutTree()}},{key:"setHtmlEnabled",value:function(e){this.setProperty("htmlEnabled",e)}},{key:"_renderHtmlEnabled",value:function(){this._renderValue()}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this.scrollable?this._installScrollbars():this._uninstallScrollbars()}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}},{key:"_onImageLoad",value:function(e){this.invalidateLayoutTree()}},{key:"_onImageError",value:function(e){this.invalidateLayoutTree()}}])&&Xh(t.prototype,n),i&&Xh(t,i),o}(de);function id(e){return(id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function od(e,t,n){return(od="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ld(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function sd(e,t){return(sd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ad(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ld(e);if(t){var r=ld(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ud(this,n)}}function ud(e,t){return!t||"object"!==id(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ld(e){return(ld=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sd(e,t)}(o,e);var t,n,i,r=ad(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):od(ld(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&rd(t.prototype,n),i&&rd(t,i),o}(fe);function fd(e){return(fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dd(e,t,n){return(dd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gd(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function pd(e,t){return(pd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=gd(e);if(t){var r=gd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return vd(this,n)}}function vd(e,t){return!t||"object"!==fd(t)&&"function"!=typeof t?bd(e):t}function bd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gd(e){return(gd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function md(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _d,wd,kd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pd(e,t)}(o,e);var t,n,i,r=yd(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._documentMouseDownHandler=null,e._anchorScrollHandler=null,e._anchorLocationChangeHandler=null,e._popupOpenHandler=null,e._glassPaneRenderer=null,e.anchorBounds=null,e.animateOpening=!1,e.animateResize=!1,e.anchor=null,e.$anchor=null,e.windowPaddingX=10,e.windowPaddingY=5,e.withGlassPane=!1,e.withFocusContext=!0,e.initialFocus=function(){return Pc.AUTO},e.focusableContainer=!1,e.horizontalAlignment=o.Alignment.LEFTEDGE,e.verticalAlignment=o.Alignment.BOTTOM,e.calculatedHorizontalAlignment=e.horizontalAlignment,e.calculatedVerticalAlignment=e.verticalAlignment,e.horizontalSwitch=!1,e.verticalSwitch=!0,e.trimWidth=!1,e.trimHeight=!0,e.scrollType="remove",e.windowResizeType=null,e.boundToAnchor=!0,e.withArrow=!1,e.closeOnAnchorMouseDown=!0,e.closeOnMouseDownOutside=!0,e.closeOnOtherPopupOpen=!0,e._openLater=!1,e.$arrow=null,e.$arrowOverlay=null,e._windowResizeHandler=e._onWindowResize.bind(bd(e)),e._anchorRenderHandler=e._onAnchorRender.bind(bd(e)),e._addWidgetProperties(["anchor"]),e._addPreserveOnPropertyChangeProperties(["anchor"]),e}return t=o,(n=[{key:"_init",value:function(e){dd(gd(o.prototype),"_init",this).call(this,e),e.location&&(this.anchorBounds=new Fo(e.location.x,e.location.y,0,0)),this.withGlassPane&&(this._glassPaneRenderer=new Bc(this)),this._setAnchor(this.anchor)}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){dd(gd(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(this._createCloseKeyStroke())}},{key:"_createCloseKeyStroke",value:function(){return new bl(this)}},{key:"_createLayout",value:function(){return new Id(this)}},{key:"_openWithoutParent",value:function(){var e=this.parent;e.destroyed||(e.rendered||e.rendering?this.open(e.entryPoint()):e.one("render",function(){this.session.layoutValidator.schedulePostValidateFunction(function(){this.destroyed||this.rendered||this.open()}.bind(this))}.bind(this)))}},{key:"open",value:function(e){e?(this._triggerPopupOpenEvent(),this._open(e),this._openLater||(this.validateFocus(),this.animateOpening&&this.$container.addClassForAnimation("animate-open"))):this._openWithoutParent()}},{key:"validateFocus",value:function(){if(this.withFocusContext){var e=this.session.focusManager.getFocusContext(this.$container);e.ready(),e.lastValidFocusedElement||this._requestInitialFocus()}}},{key:"_requestInitialFocus",value:function(){var e=this.session.focusManager.evaluateFocusRule(this.$container,this.initialFocus());e&&this.session.focusManager.requestFocus(e)}},{key:"_open",value:function(e){this.render(e),this._openLater||(this.revalidateLayout(),this.position())}},{key:"render",value:function(e){var t=e||this.entryPoint();t&&t.length&&t.isAttached()?dd(gd(o.prototype),"render",this).call(this,t):this._openLater=!0}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("popup"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.validateRoot=!0,this.htmlComp.setLayout(this._createLayout()),this.$container.window().on("resize",this._windowResizeHandler)}},{key:"_renderProperties",value:function(){dd(gd(o.prototype),"_renderProperties",this).call(this),this._renderAnchor(),this._renderWithArrow(),this._renderWithFocusContext(),this._renderWithGlassPane()}},{key:"_postRender",value:function(){dd(gd(o.prototype),"_postRender",this).call(this),this.size(),this._attachCloseHandlers(),this._attachAnchorHandlers(),this._handleGlassPanes()}},{key:"_onAttach",value:function(){dd(gd(o.prototype),"_onAttach",this).call(this),this._openLater&&!this.rendered&&(this._openLater=!1,this.open())}},{key:"_renderOnDetach",value:function(){this._openLater=!0,this.remove(),dd(gd(o.prototype),"_renderOnDetach",this).call(this)}},{key:"remove",value:function(){var e=this.animateRemoval;this.boundToAnchor&&this.$anchor&&!this._isInView()&&(this.animateRemoval=!1),dd(gd(o.prototype),"remove",this).call(this),this.animateRemoval=e}},{key:"_remove",value:function(){this.$container.window().off("resize",this._windowResizeHandler),this._glassPaneRenderer&&this._glassPaneRenderer.removeGlassPanes(),this.withFocusContext&&this.session.focusManager.uninstallFocusContext(this.$container),this.$arrow&&(this.$arrow.remove(),this.$arrow=null),this.anchor&&this.anchor.one("render",this._anchorRenderHandler),this._detachAnchorHandlers(),this._detachCloseHandlers(),dd(gd(o.prototype),"_remove",this).call(this)}},{key:"_destroy",value:function(){this.anchor&&this.anchor.off("render",this._anchorRenderHandler),dd(gd(o.prototype),"_destroy",this).call(this)}},{key:"_renderWithFocusContext",value:function(){this.withFocusContext&&this.session.focusManager.installFocusContext(this.$container,Pc.PREPARE),this.withFocusContext&&this.focusableContainer&&this.$container.attr("tabindex",-1)}},{key:"_renderWithGlassPane",value:function(){this._glassPaneRenderer&&this._glassPaneRenderer.renderGlassPanes()}},{key:"setWithArrow",value:function(e){this.setProperty("withArrow",e)}},{key:"_renderWithArrow",value:function(){this.$arrow&&(this.$arrow.remove(),this.$arrow=null),this.$arrowOverlay&&(this.$arrowOverlay.remove(),this.$arrowOverlay=null),this.withArrow&&(this.$arrowOverlay=this.$container.prependDiv("popup-arrow-overlay"),this.$arrow=this.$container.prependDiv("popup-arrow"),this._updateArrowClass()),this.$container.toggleClass("with-arrow",this.withArrow),this.invalidateLayoutTree()}},{key:"_updateArrowClass",value:function(e,t){this.$arrow&&(this.$arrow.removeClass(this._alignClasses()),this.$arrow.addClass(this._computeArrowPositionClass(e,t)))}},{key:"_computeArrowPositionClass",value:function(e,t){var n=o.Alignment,i="";switch(t=t||this.horizontalAlignment,e=e||this.verticalAlignment,t){case n.LEFT:i=n.RIGHT;break;case n.RIGHT:i=n.LEFT;break;default:i=t}switch(e){case n.BOTTOM:i+=" "+n.TOP;break;case n.TOP:i+=" "+n.BOTTOM;break;default:i+=" "+e}return i}},{key:"_isRemovalPrevented",value:function(){return!1}},{key:"close",value:function(){var e=new Kt;this.trigger("close",e),e.defaultPrevented||this.destroy()}},{key:"_attachCloseHandlers",value:function(){this.closeOnMouseDownOutside&&(this._documentMouseDownHandler=this._onDocumentMouseDown.bind(this),this.$container.document(!0).addEventListener("mousedown",this._documentMouseDownHandler,!0)),this.closeOnOtherPopupOpen&&(this._popupOpenHandler=this._onPopupOpen.bind(this),this.session.desktop.on("popupOpen",this._popupOpenHandler))}},{key:"_attachAnchorHandlers",value:function(){if(this.$anchor&&this.boundToAnchor&&this.scrollType){this._anchorScrollHandler=this._onAnchorScroll.bind(this),wf.onScroll(this.$anchor,this._anchorScrollHandler);var e=O.widget(this.$anchor);e&&(this._anchorLocationChangeHandler=this._onAnchorLocationChange.bind(this),e.on("locationChange",this._anchorLocationChangeHandler))}}},{key:"_detachAnchorHandlers",value:function(){if(this._anchorScrollHandler&&(wf.offScroll(this._anchorScrollHandler),this._anchorScrollHandler=null),this._anchorLocationChangeHandler){var e=O.widget(this.$anchor);e&&(e.off("locationChange",this._anchorLocationChangeHandler),this._anchorLocationChangeHandler=null)}}},{key:"_detachCloseHandlers",value:function(){this._popupOpenHandler&&(this.session.desktop.off("popupOpen",this._popupOpenHandler),this._popupOpenHandler=null),this._documentMouseDownHandler&&(this.$container.document(!0).removeEventListener("mousedown",this._documentMouseDownHandler,!0),this._documentMouseDownHandler=null)}},{key:"_onDocumentMouseDown",value:function(e){this.rendered&&this._isMouseDownOutside(e)&&this._onMouseDownOutside(e)}},{key:"_isMouseDownOutside",value:function(e){var t,n=s()(e.target);return!(!this.closeOnAnchorMouseDown&&this._isMouseDownOnAnchor(e)||(t=O.widget(n),this.isOrHas(t)||this.session.focusManager.isElementCovertByGlassPane(this.$container[0])))}},{key:"_isMouseDownOnAnchor",value:function(e){return!!this.$anchor&&this.$anchor.isOrHas(e.target)}},{key:"_onMouseDownOutside",value:function(e){this.close()}},{key:"_onAnchorScroll",value:function(e){this.rendered&&this._handleAnchorPositionChange()}},{key:"_handleAnchorPositionChange",value:function(e){O.isOneOf(this.scrollType,"position","layoutAndPosition")&&this.isOpeningAnimationRunning()||("position"===this.scrollType?this.position():"layoutAndPosition"===this.scrollType?(this.revalidateLayout(),this.position()):"remove"===this.scrollType&&this.close())}},{key:"isOpeningAnimationRunning",value:function(){return this.rendered&&this.animateOpening&&this.$container.hasClass("animate-open")}},{key:"_onAnchorLocationChange",value:function(e){this._handleAnchorPositionChange()}},{key:"_onPopupOpen",value:function(e){var t=!this.isOrHas(e.popup)&&!e.popup.isOrHas(this);this.rendered&&(t=t&&!this.session.focusManager.isElementCovertByGlassPane(this.$container[0])),t&&this.close()}},{key:"setHorizontalAlignment",value:function(e){this.setProperty("horizontalAlignment",e)}},{key:"_renderHorizontalAlignment",value:function(){this._updateArrowClass(),this.invalidateLayoutTree()}},{key:"setVerticalAlignment",value:function(e){this.setProperty("verticalAlignment",e)}},{key:"_renderVerticalAlignment",value:function(){this._updateArrowClass(),this.invalidateLayoutTree()}},{key:"setHorizontalSwitch",value:function(e){this.setProperty("horizontalSwitch",e)}},{key:"_renderHorizontalSwitch",value:function(){this.invalidateLayoutTree()}},{key:"setVerticalSwitch",value:function(e){this.setProperty("verticalSwitch",e)}},{key:"_renderVerticalSwitch",value:function(){this.invalidateLayoutTree()}},{key:"setTrimWidth",value:function(e){this.setProperty("trimWidth",e)}},{key:"_renderTrimWidth",value:function(){this.invalidateLayoutTree()}},{key:"setTrimHeight",value:function(e){this.setProperty("trimHeight",e)}},{key:"_renderTrimHeight",value:function(){this.invalidateLayoutTree()}},{key:"prefLocation",value:function(e,t){return this.boundToAnchor&&(this.anchorBounds||this.$anchor)?this._prefLocationWithAnchor(e,t):this._prefLocationWithoutAnchor()}},{key:"_prefLocationWithoutAnchor",value:function(){return aP.positionContainerInWindow(this.$container)}},{key:"_prefLocationWithAnchor",value:function(e,t){var n=this.$container;t=t||this.horizontalAlignment,e=e||this.verticalAlignment;var i=this.getAnchorBounds(),r=No.size(n),s=No.margins(n),a=o.Alignment,u=null;this.$arrow&&(this._updateArrowClass(e,t),No.setMargins(this.$arrow,new Ro),u=No.bounds(this.$arrow)),n.removeClass(this._alignClasses()),n.addClass(e+" "+t);var l=r.width+s.horizontal(),c=r.width,f=i.x;t===a.LEFT?f-=l:t===a.LEFTEDGE?this.withArrow?f+=i.width/2-u.center().x-s.left:f=i.x-s.left:t===a.CENTER?f+=i.width/2-c/2-s.left:t===a.RIGHT?f+=i.width:t===a.RIGHTEDGE&&(this.withArrow?f+=i.width/2-u.center().x-s.right:f=i.x+i.width-c-s.right);var h=r.height+s.vertical(),d=r.height,p=i.y;e===a.TOP?p-=h:e===a.TOPEDGE?this.withArrow?p+=i.height/2-u.center().y-s.top:p=i.y-s.top:e===a.CENTER?p+=i.height/2-d/2-s.top:e===a.BOTTOM?p+=i.height:e===a.BOTTOMEDGE&&(this.withArrow?p+=i.height/2-u.center().y-s.bottom:p=i.y+i.height-d-s.bottom);var y=this.$parent.offset();return f-=y.left,p-=y.top,new Eo(f,p)}},{key:"_alignClasses",value:function(){var e=o.Alignment;return En.join(" ",e.LEFT,e.LEFTEDGE,e.CENTER,e.RIGHT,e.RIGHTEDGE,e.TOP,e.TOPEDGE,e.CENTER,e.BOTTOM,e.BOTTOMEDGE)}},{key:"getAnchorBounds",value:function(){var e=this.anchorBounds;if(!this.$anchor)return e;var t=No.offsetBounds(this.$anchor,{exact:!0});return e?(e.x||(e.x=t.x,e.width=t.width),e.y||(e.y=t.y,e.height=t.height)):e=t,e}},{key:"getWindowSize",value:function(){var e=this.$parent.window();return new Co(e.width(),e.height())}},{key:"overlap",value:function(e,t){var n=this.$container;if(!n||!e)return null;t=O.nvl(t,!0);var i=n.outerHeight(t),r=n.outerWidth(t),o=new Fo(e.x,e.y,r,i),s=No.offsetBounds(n.entryPoint(),!0),a=o.right()+this.windowPaddingX-s.width;a<0&&(a=Math.min(o.x-this.windowPaddingX-s.x,0));var u=o.bottom()+this.windowPaddingY-s.height;return u<0&&(u=Math.min(o.y-this.windowPaddingY-s.y,0)),new Eo(a,u)}},{key:"adjustLocation",value:function(e,t){this.calculatedVerticalAlignment=this.verticalAlignment,this.calculatedHorizontalAlignment=this.horizontalAlignment;var n=this.overlap(e);return this.$arrow&&(this._updateArrowClass(this.calculatedVerticalAlignment,this.calculatedHorizontalAlignment),No.setMargins(this.$arrow,new Ro)),e=e.clone(),0!==n.y&&(O.nvl(t,this.verticalSwitch)?(this.calculatedVerticalAlignment=o.SwitchRule[this.calculatedVerticalAlignment],e.y=this.prefLocation(this.calculatedVerticalAlignment).y):e.y-=n.y),0!==n.x&&(O.nvl(t,this.horizontalSwitch)?(this.calculatedHorizontalAlignment=o.SwitchRule[this.calculatedHorizontalAlignment],e.x=this.prefLocation(this.calculatedVerticalAlignment,this.calculatedHorizontalAlignment).x):e.x-=n.x),this.$arrow&&(0!==n.y&&(this.$arrow.hasClass(o.Alignment.LEFT)||this.$arrow.hasClass(o.Alignment.RIGHT))&&(n.y>0?this.$arrow.cssMarginTop(n.y):this.$arrow.cssMarginBottom(-n.y)),0!==n.x&&(this.$arrow.hasClass(o.Alignment.TOP)||this.$arrow.hasClass(o.Alignment.BOTTOM))&&(n.x>0?this.$arrow.cssMarginLeft(n.x):this.$arrow.cssMarginRight(-n.x))),e}},{key:"size",value:function(){var e=this.prefSize(this.$container);e&&No.setSize(this.$container,e)}},{key:"prefSize",value:function(e){return null}},{key:"position",value:function(e){this._validateVisibility(),this._position(e)}},{key:"_position",value:function(e){var t=this.prefLocation();t&&(t=this.adjustLocation(t,e),this.setLocation(t))}},{key:"setLocation",value:function(e){this.$container.css("left",e.x).css("top",e.y),this._triggerLocationChange()}},{key:"_validateVisibility",value:function(){if(this.boundToAnchor&&this.$anchor){var e=this._isInView(),t=this.$container.hasClass("invisible")===e&&e;if(this.$container.toggleClass("invisible",!e),t){var n=this.animateResize;this.animateResize=!1,this.revalidateLayout(),this.animateResize=n,this.withFocusContext&&this.session.focusManager.validateFocus()}}}},{key:"_isInView",value:function(){if(this.boundToAnchor&&this.$anchor){var e=this.getAnchorBounds();return wf.isLocationInView(e.center(),this.$anchor.scrollParent())}}},{key:"_triggerLocationChange",value:function(){this.trigger("locationChange")}},{key:"_triggerPopupOpenEvent",value:function(){this.session.desktop.trigger("popupOpen",{popup:this})}},{key:"belongsTo",value:function(e){return this.$anchor[0]===e[0]}},{key:"set$Anchor",value:function(e){this.$anchor&&this._detachAnchorHandlers(),this.setProperty("$anchor",e),this.rendered&&(this._attachAnchorHandlers(),this.revalidateLayout(),this.animateResize||this.position())}},{key:"isOpen",value:function(){return this.rendered}},{key:"ensureOpen",value:function(){this.isOpen()||this.open()}},{key:"setAnchor",value:function(e){this.setProperty("anchor",e)}},{key:"_setAnchor",value:function(e){e&&this.setParent(e),this._setProperty("anchor",e)}},{key:"_onAnchorRender",value:function(){this.session.layoutValidator.schedulePostValidateFunction(function(){if(!this.rendered&&!this.destroyed)if(!this.anchor||this.anchor.rendered){var e=this.animateOpening;this.animateOpening=!1,this.open(),this.animateOpening=e}else this.anchor.one("render",this._anchorRenderHandler)}.bind(this))}},{key:"_renderAnchor",value:function(){this.anchor&&this.set$Anchor(this.anchor.$container)}},{key:"_onWindowResize",value:function(){this.rendered&&("position"===this.windowResizeType?this.position():"layoutAndPosition"===this.windowResizeType?(this.revalidateLayoutTree(!1),this.position()):"remove"===this.windowResizeType&&this.close())}},{key:"_handleGlassPanes",value:function(){this.session.focusManager.isElementCovertByGlassPane(this.parent.$container)&&this.session.focusManager.rerenderGlassPanes()}}])&&hd(t.prototype,n),i&&hd(t,i),o}(de);function Sd(e){return(Sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Od(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Td(e,t,n){return(Td="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xd(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Cd(e,t){return(Cd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=xd(e);if(t){var r=xd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Rd(this,n)}}function Rd(e,t){return!t||"object"!==Sd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xd(e){return(xd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}md(kd,"Alignment",{LEFT:"left",LEFTEDGE:"leftedge",TOP:"top",TOPEDGE:"topedge",CENTER:"center",RIGHT:"right",RIGHTEDGE:"rightedge",BOTTOM:"bottom",BOTTOMEDGE:"bottomedge"}),md(kd,"SwitchRule",{}),_d=kd.SwitchRule,wd=kd.Alignment,_d[wd.LEFT]=wd.RIGHT,_d[wd.LEFTEDGE]=wd.RIGHTEDGE,_d[wd.TOP]=wd.BOTTOM,_d[wd.TOPEDGE]=wd.BOTTOMEDGE,_d[wd.CENTER]=wd.CENTER,_d[wd.RIGHT]=wd.LEFT,_d[wd.RIGHTEDGE]=wd.LEFTEDGE,_d[wd.BOTTOM]=wd.TOP,_d[wd.BOTTOMEDGE]=wd.TOPEDGE;var Ed=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cd(e,t)}(o,e);var t,n,i,r=Pd(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetClose",value:function(e){e.preventDefault(),this._send("close")}},{key:"_onWidgetEvent",value:function(e){"close"===e.type?this._onWidgetClose(e):Td(xd(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&Od(t.prototype,n),i&&Od(t,i),o}(fe);function Dd(e){return(Dd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ad(e,t){return(Ad=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Md(e);if(t){var r=Md(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jd(this,n)}}function jd(e,t){return!t||"object"!==Dd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Md(e){return(Md=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Id=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ad(e,t)}(o,e);var t,n,i,r=$d(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).popup=e,t.doubleCalcPrefSize=!0,t.autoPosition=!0,t.autoSize=!0,t}return t=o,(n=[{key:"layout",value:function(e){if(this.popup.isOpeningAnimationRunning())this.popup.$container.oneAnimationEnd(this.layout.bind(this,e));else if(!this.popup.removalPending&&!this.popup.removing&&this.popup.rendered)if(this.autoSize){var t=this.popup.htmlComp,n=No.bounds(t.$comp),i=this.preferredLayoutSize(e,{exact:!0,onlyWidth:this.doubleCalcPrefSize});i=this.adjustSize(i),this.doubleCalcPrefSize&&(i=this.preferredLayoutSize(e,{exact:!0,widthHint:i.width-t.insets().horizontal()}),i=this.adjustSize(i)),this._setSize(i),t.layouted&&this.popup.animateResize&&this._resizeAnimated(n,i)}else this._setSize(this.popup.htmlComp.size({exact:!0}))}},{key:"_resizeAnimated",value:function(e,t){this._position();var n=this.popup.htmlComp,i=n.$comp.position(),r=new Fo(i.left,i.top,Math.ceil(t.width),Math.ceil(t.height));e.equals(r)||n.$comp.stop(!0).cssHeight(e.height).cssWidth(e.width).cssLeft(e.x).cssTop(e.y).animate({height:t.height,width:t.width,left:i.left,top:i.top},{complete:function(){this.popup.rendered&&this._position()}.bind(this)})}},{key:"_position",value:function(e){this.autoPosition&&this.popup.position(e)}},{key:"_setSize",value:function(e){No.setSize(this.popup.htmlComp.$comp,e)}},{key:"adjustSize",value:function(e){return this.popup.htmlComp._adjustPrefSizeWithMinMaxSize(e),this.popup.boundToAnchor&&(this.popup.anchorBounds||this.popup.$anchor)?this._adjustSizeWithAnchor(e):this._adjustSize(e)}},{key:"_adjustSize",value:function(e){var t=new Co,n=this._calcMaxSize();return t.width=Math.min(n.width,e.width),t.height=Math.min(n.height,e.height),t}},{key:"_calcMaxSize",value:function(){this.popup.repositionEnabled&&this._position(!1);var e,t,n=this.popup.htmlComp,i=this.popup.windowPaddingX,r=this.popup.windowPaddingY,o=n.margins(),s=this.popup.getWindowSize();return e=s.width-o.horizontal()-i,t=s.height-o.vertical()-r,new Co(e,t)}},{key:"_adjustSizeWithAnchor",value:function(e){var t=new Co,n=this._calcMaxSizeAroundAnchor(),i=this._calcMaxSize(),r=kd.Alignment,o=this.popup.horizontalAlignment,s=this.popup.verticalAlignment;return n=n.floor(),t.width=e.width,this.popup.trimWidth&&(this.popup.horizontalSwitch?e.width>n.right&&e.width>n.left&&(t.width=Math.max(n.right,n.left)):o===r.RIGHT?t.width=Math.min(t.width,n.right):o===r.LEFT?t.width=Math.min(t.width,n.left):t.width=Math.min(t.width,i.width)),t.height=e.height,this.popup.trimHeight&&(this.popup.verticalSwitch?e.height>n.bottom&&e.height>n.top&&(t.height=Math.max(n.bottom,n.top)):s===r.BOTTOM?t.height=Math.min(t.height,n.bottom):s===r.TOP?t.height=Math.min(t.height,n.top):t.height=Math.min(t.height,i.height)),s!==r.CENTER&&o!==r.CENTER||(o===r.CENTER&&(t.width=Math.min(i.width,e.width)),s===r.CENTER&&(t.height=Math.min(i.height,e.height))),t}},{key:"_calcMaxSizeAroundAnchor",value:function(){this.popup.repositionEnabled&&this._position(!1);var e,t,n,i,r=this.popup.htmlComp,o=this.popup.windowPaddingX,s=this.popup.windowPaddingY,a=r.margins(),u=this.popup.getAnchorBounds(),l=this.popup.getWindowSize(),c=this.popup.horizontalAlignment,f=this.popup.verticalAlignment,h=kd.Alignment;return O.isOneOf(c,h.LEFTEDGE,h.RIGHTEDGE)?(t=l.width-u.x-a.horizontal()-o,e=u.right()-a.horizontal()-o):(t=l.width-u.right()-a.horizontal()-o,e=u.x-a.horizontal()-o),O.isOneOf(f,h.BOTTOMEDGE,h.TOPEDGE)?(n=l.height-u.y-a.vertical()-s,i=u.bottom()-a.vertical()-s):(n=l.height-u.bottom()-a.vertical()-s,i=u.y-a.vertical()-s),new Ro(i,t,n,e)}}])&&Fd(t.prototype,n),i&&Fd(t,i),o}(zo);function Ld(e){return(Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nd(e,t,n){return(Nd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zd(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Hd(e,t){return(Hd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zd(e);if(t){var r=zd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Wd(this,n)}}function Wd(e,t){return!t||"object"!==Ld(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zd(e){return(zd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hd(e,t)}(o,e);var t,n,i,r=Vd(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).popups=[],e._addWidgetProperties(["popups"]),e._addPreserveOnPropertyChangeProperties(["popups"]),e}return t=o,(n=[{key:"_init",value:function(e){Nd(zd(o.prototype),"_init",this).call(this,e),this.session.layoutValidator.schedulePostValidateFunction(function(){this._openPopups(this.popups)}.bind(this))}},{key:"setPopups",value:function(e){this.setProperty("popups",e)}},{key:"_setPopups",value:function(e){this._openPopups(et.diff(e,this.popups)),this._destroyPopups(et.diff(this.popups,e)),this._setProperty("popups",e),this.popups.forEach(function(e){e.parent instanceof scout.PopupManager&&e.setParent(this.session.desktop)}.bind(this))}},{key:"_openPopups",value:function(e){e.forEach((function(e){e.open()}))}},{key:"_destroyPopups",value:function(e){e.forEach((function(e){e.destroy()}))}}])&&Bd(t.prototype,n),i&&Bd(t,i),o}(de);function Ud(e){return(Ud="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kd(e,t){return(Kd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Xd(e);if(t){var r=Xd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Yd(this,n)}}function Yd(e,t){return!t||"object"!==Ud(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xd(e){return(Xd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kd(e,t)}(n,e);var t=qd(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(fe);function Zd(e){return(Zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ep(e,t,n){return(ep="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rp(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function tp(e,t){return(tp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function np(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=rp(e);if(t){var r=rp(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ip(this,n)}}function ip(e,t){return!t||"object"!==Zd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rp(e){return(rp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var op=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tp(e,t)}(o,e);var t,n,i,r=np(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).$head,e.$body,e.$deco,e.$parent,e.horizontalSwitch=!0,e.verticalSwitch=!0,e._headVisible=!0,e.windowResizeType="remove",e}return t=o,(n=[{key:"_createLayout",value:function(){return new dp(this)}},{key:"_init",value:function(e){ep(rp(o.prototype),"_init",this).call(this,e),this.trimWidth=O.nvl(e.trimWidth,this._headVisible)}},{key:"_render",value:function(){ep(rp(o.prototype),"_render",this).call(this),this._$createBody(),this._headVisible&&this._renderHead()}},{key:"_postRender",value:function(){ep(rp(o.prototype),"_postRender",this).call(this),wf.update(this.$body)}},{key:"_$createBody",value:function(){this.$body=this.$container.appendDiv("popup-body"),Uo.install(this.$body,this.session).setLayout(this._createBodyLayout()),this._modifyBody()}},{key:"_createBodyLayout",value:function(){return new ya}},{key:"rerenderHead",value:function(){this._removeHead(),this._renderHead()}},{key:"_renderHead",value:function(){this.$deco=this.$container.makeDiv("popup-deco"),this.$head=this.$container.makeDiv("popup-head menu-item").on("mousedown","",this._onHeadMouseDown.bind(this)),this.$container.prepend(this.$head).append(this.$deco),this.$headBlueprint&&(this.$head.html(this.$headBlueprint.html()),this._copyStyleToHeadChildren())}},{key:"_modifyBody",value:function(){}},{key:"_removeHead",value:function(){this.$head&&this.$head.remove(),this.$deco&&this.$deco.remove()}},{key:"_copyCssClassToHead",value:function(e){this.$headBlueprint&&this.$headBlueprint.hasClass(e)&&this.$head.addClass(e)}},{key:"_copyStyleToHeadChildren",value:function(){var e=this.$headBlueprint.children();this.$head.children().each((function(t){var n=s()(this),i=e.eq(t);n.copyCss(i,"margin padding line-height border vertical-align font-size display width height")}))}},{key:"_onHeadMouseDown",value:function(e){this.$head&&this.$head.isOrHas(e.target)&&this.close()}},{key:"_isMouseDownOutside",value:function(e){return(!this.$headBlueprint||!this.$headBlueprint.isOrHas(e.target))&&ep(rp(o.prototype),"_isMouseDownOutside",this).call(this,e)}},{key:"appendToBody",value:function(e){this.$body.append(e)}},{key:"addClassToBody",value:function(e){this.$body.addClass(e)}},{key:"_position",value:function(e){var t=this.$container;if(t){var n,i,r,s;if(!this._headVisible)return ep(rp(o.prototype),"_position",this).call(this,e),this.$body.removeClass(this._alignClasses()),i=kd.Alignment.TOP,t.hasClass(kd.Alignment.BOTTOM)&&(i=kd.Alignment.BOTTOM),n=kd.Alignment.LEFTEDGE,t.hasClass(kd.Alignment.RIGHTEDGE)&&(n=kd.Alignment.RIGHTEDGE),void this.$body.addClass(i+" "+n);this._positionImpl();var a=O.nvl(e,this.horizontalSwitch),u=O.nvl(e,this.verticalSwitch);if(a||u){s=t.offset(),r=this.overlap({x:s.left,y:s.top},!1);var l=this.$parent.offset();r.x-=l.left,r.y-=l.top,r.y>0&&u&&(i=kd.Alignment.TOP),r.x>0&&a&&(n=kd.Alignment.RIGHTEDGE),(n||i)&&this._positionImpl(n,i)}}}},{key:"_positionImpl",value:function(e,t){var n,i,r,o,a,u,l,c,f,h=0,d=0;e=e||this.horizontalAlignment,t=t||this.verticalAlignment,this.$container.removeClass(this._alignClasses()),this.$body.removeClass(this._alignClasses()),this.$container.addClass(t+" "+e),this.$body.addClass(t+" "+e),this.$head.copyCssIfGreater(this.$headBlueprint,"padding"),this.$head.copyCss(this.$headBlueprint,"line-height"),this.$head.height(this.$headBlueprint.height()),this.$head.width(this.$headBlueprint.width()),this._copyStyleToHeadChildren(),i=No.size(this.$head,!0),(r=No.size(this.$body,!0)).width=Math.max(r.width,i.width),o=r.width,n=this.$headBlueprint.offset();var p=this.$parent.offset();n.left-=p.left,n.top-=p.top,u=n.left,c=No.insets(this.$head),f=No.insets(this.$headBlueprint),l=n.top-c.top+f.top,t===kd.Alignment.TOP?(l-=r.height,d=(h=0+r.height)-1,this.$container.cssMarginBottom(i.height),this.$container.css("margin-top","")):t===kd.Alignment.BOTTOM&&(h-=i.height,this.$container.cssMarginTop(i.height),this.$container.css("margin-bottom","")),s.a.log.isTraceEnabled()&&s.a.log.trace("bodyWidth="+o+" pos=[left="+n.left+" top="+n.top+"] headSize="+i+" headInsets="+c+" left="+u+" top="+l),this.$head.cssTop(h),this.$body.cssTop(0),this.$deco.cssTop(d),e===kd.Alignment.RIGHTEDGE?(u-=(a=o-i.width)+c.left-f.left,this.$head.cssLeft(a),this.$body.cssLeft(0),this.$deco.cssLeft(a+this.$head.cssBorderLeftWidth()).width(i.width-this.$head.cssBorderWidthX())):(u=u-c.left+f.left,this.$head.cssLeft(0),this.$deco.cssLeft(1).width(i.width-2)),this.horizontalAlignment=e,this.verticalAlignment=t,this.setLocation(new Eo(u,l)),No.setSize(this.$head,i),No.setSize(this.$body,r)}},{key:"_glassPaneTargets",value:function(){return[this.$container,this.$head]}}])&&Qd(t.prototype,n),i&&Qd(t,i),o}(kd);function sp(e){return(sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ap(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function up(e,t,n){return(up="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hp(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function lp(e,t){return(lp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=hp(e);if(t){var r=hp(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fp(this,n)}}function fp(e,t){return!t||"object"!==sp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hp(e){return(hp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lp(e,t)}(o,e);var t,n,i,r=cp(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"_setSize",value:function(e){up(hp(o.prototype),"_setSize",this).call(this,e);var t=this.popup.htmlComp,n=e,i=Uo.optGet(this.popup.$body);if(!this.popup.bodyAnimating){if(n=n.subtract(t.insets()),this._headVisible){var r=No.size(this.popup.$head,!0);n.width<r.width&&(n.width=r.width)}i.setSize(n)}}},{key:"_adjustSize",value:function(e){return this._adjustSizeWithAnchor(e)}},{key:"_calcMaxSizeAroundAnchor",value:function(){if(!this.popup._headVisible)return up(hp(o.prototype),"_calcMaxSizeAroundAnchor",this).call(this);this._position(!1);var e,t,n,i,r=this.popup.htmlComp,s=this.popup.windowPaddingX,a=this.popup.windowPaddingX,u=this.popup.windowPaddingY,l=No.offsetBounds(r.$comp),c=No.offsetBounds(this.popup.$head),f=r.margins(),h=this.popup.getWindowSize();return t=h.width-c.x-a,e=c.x+c.width-s,n=h.height-l.y-u,i=l.y-f.vertical()-u,new Ro(i,t,n,e)}},{key:"preferredLayoutSize",value:function(e,t){var n,i,r=this.popup.htmlComp;if(this.popup.bodyAnimating)i=No.size(this.popup.$body,t).add(No.margins(this.popup.$body));else{var o=this.popup.$container.attr("style"),s=this.popup.$body.siblings(".popup-body");s.addClass("hidden"),this.popup.$container.css({width:"auto",height:"auto"}),i=(n=Uo.optGet(this.popup.$body))?n.prefSize(t).add(n.margins()):No.prefSize(this.popup.$body,t).add(No.margins(this.popup.$body)),s.removeClass("hidden"),this.popup.$container.attr("style",o)}if(this.popup._headVisible){var a=No.size(this.popup.$head,t).add(No.margins(this.popup.$head));i.width=i.width<a.width?a.width:i.width}return i=i.add(r.insets())}}])&&ap(t.prototype,n),i&&ap(t,i),o}(Id);function pp(e){return(pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vp(e,t,n){return(vp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_p(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function bp(e,t){return(bp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_p(e);if(t){var r=_p(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return mp(this,n)}}function mp(e,t){return!t||"object"!==pp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _p(e){return(_p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bp(e,t)}(o,e);var t,n,i,r=gp(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).animateOpening=!0,e.boundToAnchor=!1,e.windowPaddingX=0,e.windowPaddingY=0,e.closable=!0,e.animateRemoval=!0,e.widget=null,e.title=null,e.withGlassPane=!0,e._addWidgetProperties("widget"),e}return t=o,(n=[{key:"_createLayout",value:function(){return new xp(this)}},{key:"prefLocation",value:function(e,t){var n=this.htmlComp.prefSize(),i=this.$container.window().height(),r=Math.max(i-n.height,0);return new Eo(0,r)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("popup mobile-popup"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.validateRoot=!0,this.htmlComp.setLayout(this._createLayout()),this.$header=this.$container.appendDiv("mobile-popup-header"),this.$title=this.$header.appendDiv("title")}},{key:"_renderProperties",value:function(){vp(_p(o.prototype),"_renderProperties",this).call(this),this._renderWidget(),this._renderTitle(),this._renderClosable()}},{key:"setWidget",value:function(e){this.setProperty("widget",e)}},{key:"_renderWidget",value:function(){this.widget&&(this.widget.render(),this.widget.$container.addClass("mobile-popup-widget"),this.invalidateLayoutTree())}},{key:"_renderClosable",value:function(){if(this.$container.toggleClass("closable"),this.closable){if(this.$close)return;this.$close=this.$title.afterDiv("closer").on("click",this.close.bind(this))}else{if(!this.$close)return;this.$close.remove(),this.$close=null}}},{key:"_renderTitle",value:function(){this.$title.textOrNbsp(this.title)}}])&&yp(t.prototype,n),i&&yp(t,i),o}(kd);function kp(e){return(kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Op(e,t,n){return(Op="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rp(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Tp(e,t){return(Tp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Rp(e);if(t){var r=Rp(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Pp(this,n)}}function Pp(e,t){return!t||"object"!==kp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rp(e){return(Rp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tp(e,t)}(o,e);var t,n,i,r=Cp(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).doubleCalcPrefSize=!1,t}return t=o,(n=[{key:"layout",value:function(e){Op(Rp(o.prototype),"layout",this).call(this,e);var t,n=this.popup.htmlComp,i=n.size(),r=this.popup.widget.htmlComp,s=0,a=this.popup.$header;i=i.subtract(n.insets()),t=No.prefSize(a,!0),No.setLocation(a,new Eo(0,0)),(s=i.clone()).height-=t.height,r.setLocation(new Eo(0,t.height)),r.setSize(s.subtract(r.margins()))}},{key:"preferredLayoutSize",value:function(e){var t=this.popup.$container.window();return new Co(t.width(),t.height())}}])&&Sp(t.prototype,n),i&&Sp(t,i),o}(Id);function Ep(e){return(Ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fp(e,t,n){return(Fp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ip(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ap(e,t){return(Ap=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ip(e);if(t){var r=Ip(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jp(this,n)}}function jp(e,t){return!t||"object"!==Ep(t)&&"function"!=typeof t?Mp(e):t}function Mp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ip(e){return(Ip=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ap(e,t)}(o,e);var t,n,i,r=$p(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._touchField=null,e._touchFieldTooltip=null,e._field=null,e._widget=null,e._$widgetContainer=null,e._widgetContainerHtmlComp=null,e.windowPaddingX=0,e.windowPaddingY=0,e.withGlassPane=!0,e._touchFieldPropertyChangeListener=e._onTouchFieldPropertyChange.bind(Mp(e)),e}return t=o,(n=[{key:"_init",value:function(e){Fp(Ip(o.prototype),"_init",this).call(this,e),this._touchField=e.field,this._touchField._tooltip()&&this._touchField._tooltip().rendered&&(this._touchFieldTooltip=this._touchField._tooltip(),this._touchFieldTooltip.remove()),this._field=this._touchField.clone(this._fieldOverrides()),this._touchField.on("propertyChange",this._touchFieldPropertyChangeListener),this._initWidget(e)}},{key:"_destroy",value:function(){this._touchField.off("propertyChange",this._touchFieldPropertyChangeListener),this._touchFieldTooltip&&!this._touchFieldTooltip.destroyed&&this._touchFieldTooltip.render(this._touchField._$tooltipParent()),Fp(Ip(o.prototype),"_destroy",this).call(this)}},{key:"_fieldOverrides",value:function(){return{parent:this,labelPosition:GH.LabelPosition.ON_FIELD,fieldStyle:GH.FieldStyle.CLASSIC,popup:this,statusVisible:!1,menusVisible:!1,embedded:!0,touchMode:!1,clearable:GV.Clearable.ALWAYS}}},{key:"_initWidget",value:function(e){}},{key:"_createLayout",value:function(){return new Up(this)}},{key:"prefLocation",value:function(e,t){var n=this.htmlComp.prefSize(),i=this.$container.window().width(),r=Math.max(this.windowPaddingX,(i-n.width)/2);return new Eo(r,0)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("touch-popup"),this._$header=this.$container.appendDiv("touch-popup-header"),this._$header.appendDiv("status closer touch-popup-close-icon").on("click",this._onCloseIconClick.bind(this)),this._$header.appendDiv("touch-popup-title").textOrNbsp(this._touchField.label,"empty"),this._$widgetContainer=this.$container.appendDiv("touch-popup-widget-container"),this._widgetContainerHtmlComp=Uo.install(this._$widgetContainer,this.session),this._widgetContainerHtmlComp.setLayout(new xa),this._field.render(),this._field.$container.insertBefore(this._$widgetContainer),this._field.$container.addClass("touch-popup-field"),this._widget&&this._widget.render(this._$widgetContainer),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.validateRoot=!0,this.htmlComp.setLayout(this._createLayout())}},{key:"_onTouchFieldPropertyChange",value:function(e){"errorStatus"===e.propertyName?this._field.setErrorStatus(e.newValue):"lookupRow"===e.propertyName&&this._field.setLookupRow(e.newValue)}},{key:"_acceptInput",value:function(){var e=this._field.acceptInput();e?e.always(this.close.bind(this)):this.close()}},{key:"_onCloseIconClick",value:function(e){this._acceptInput()}}])&&Dp(t.prototype,n),i&&Dp(t,i),o}(kd);function Bp(e){return(Bp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Np(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hp(e,t,n){return(Hp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gp(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Vp(e,t){return(Vp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Gp(e);if(t){var r=Gp(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return zp(this,n)}}function zp(e,t){return!t||"object"!==Bp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gp(e){return(Gp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Up=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vp(e,t)}(o,e);var t,n,i,r=Wp(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).doubleCalcPrefSize=!1,t}return t=o,(n=[{key:"layout",value:function(e){Hp(Gp(o.prototype),"layout",this).call(this,e);var t=this.popup.htmlComp.size().subtract(this.popup.htmlComp.insets()),n=No.size(this.popup._$header,!0).height,i=this.popup._field,r=i.htmlComp.prefSize().height,s=i.htmlComp.margins(),a=t.width-s.horizontal(),u=n+r+s.vertical();i.htmlComp.setBounds(new Fo(0,n,a,r)),this.popup._widgetContainerHtmlComp.setBounds(new Fo(0,u,t.width,t.height-u))}},{key:"preferredLayoutSize",value:function(e){var t=Vo.get().formColumnWidth,n=15*Vo.get().formRowHeight;return new Co(t,n)}}])&&Np(t.prototype,n),i&&Np(t,i),o}(Id);function Kp(e){return(Kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yp(e,t,n){return(Yp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ey(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Xp(e,t){return(Xp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ey(e);if(t){var r=ey(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Zp(this,n)}}function Zp(e,t){return!t||"object"!==Kp(t)&&"function"!=typeof t?Qp(e):t}function Qp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ey(e){return(ey=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ty=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xp(e,t)}(o,e);var t,n,i,r=Jp(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).animateOpening=!0,e.animateResize=!0,e.animateRemoval=!0,e.closable=!1,e.closeAction=null,e.movable=!1,e.resizable=!1,e.resizeModes=null,e.minSize=null,e.widget=null,e.windowPaddingX=0,e.windowPaddingY=0,e.windowResizeType="layoutAndPosition",e.$dragHandle=null,e._moveHandler=e._onMove.bind(Qp(e)),e._resizeHandler=e._onResize.bind(Qp(e)),e._autoPositionOrig=null,e._addWidgetProperties(["widget"]),e}return t=o,(n=[{key:"_createLayout",value:function(){return new yy(this)}},{key:"_init",value:function(e){Yp(ey(o.prototype),"_init",this).call(this,e),this._setClosable(this.closable)}},{key:"_render",value:function(){Yp(ey(o.prototype),"_render",this).call(this),this.$container.addClass("widget-popup")}},{key:"_renderProperties",value:function(){Yp(ey(o.prototype),"_renderProperties",this).call(this),this._renderWidget(),this._renderClosable(),this._renderMovable(),this._renderResizable()}},{key:"_remove",value:function(){this.$dragHandle=null,Yp(ey(o.prototype),"_remove",this).call(this)}},{key:"setWidget",value:function(e){this.setProperty("widget",e)}},{key:"_renderWidget",value:function(){this.widget&&(this.widget.render(),this.widget.$container.addClass("popup-widget"),this.invalidateLayoutTree())}},{key:"setClosable",value:function(e){this.setProperty("closable",e)}},{key:"_setClosable",value:function(e){if(this._setProperty("closable",e),this.closable){if(this.closeAction)return;this.closeAction=this._createCloseAction(),this.closeAction.on("action",this._onCloseAction.bind(this))}else{if(!this.closeAction)return;this.closeAction.destroy(),this.closeAction=null}}},{key:"_createCloseAction",value:function(){return O.create("Action",{parent:this,cssClass:"close-action",iconId:sn.REMOVE})}},{key:"_renderClosable",value:function(){this.closeAction&&this.closeAction.render()}},{key:"_onCloseAction",value:function(){this.close()}},{key:"setResizable",value:function(e){this.setProperty("resizable",e)}},{key:"_renderResizable",value:function(){this.resizable?this.$container.resizable({modes:this._determineResizeModes(),$parent:this.$container,boundaries:this._calculateResizeBoundaries()}).on("resize",this._resizeHandler):(this.$container.unresizable().off("resize",this._resizeHandler),this.invalidateLayoutTree())}},{key:"_calculateResizeBoundaries",value:function(){var e=new Ro;if(!this.$arrow)return e;var t=this._getAnchorMiddlePoint();if(!t)return e;var n=No.size(this.$arrow);return this._isVerticallyAligned()?(e.top=t.y-n.height,e.bottom=t.y+n.height):(e.left=t.x-n.width,e.right=t.x+n.width),e}},{key:"_determineResizeModes",value:function(){return!this.$arrow||this.resizeModes?this.resizeModes:this.calculatedVerticalAlignment===kd.Alignment.TOP?[eye.MODES.WEST,eye.MODES.EAST,eye.MODES.NORTH]:this.calculatedVerticalAlignment===kd.Alignment.BOTTOM?[eye.MODES.WEST,eye.MODES.EAST,eye.MODES.SOUTH]:this.calculatedHorizontalAlignment===kd.Alignment.LEFT?[eye.MODES.NORTH,eye.MODES.SOUTH,eye.MODES.WEST]:this.calculatedHorizontalAlignment===kd.Alignment.RIGHT?[eye.MODES.NORTH,eye.MODES.SOUTH,eye.MODES.EAST]:this.resizeModes}},{key:"_onResize",value:function(e){var t=this.htmlComp.layout.autoSize;return this.htmlComp.layout.autoSize=!1,this.htmlComp.revalidateLayout(),this.htmlComp.layout.autoSize=t,this._updateArrowPosition(),!1}},{key:"position",value:function(e){if(Yp(ey(o.prototype),"position",this).call(this,e),this.resizable){var t=this.$container.data("resizable");t.setBoundaries(this._calculateResizeBoundaries()),t.setModes(this._determineResizeModes()),this._updateArrowPosition()}}},{key:"_updateArrowClass",value:function(e,t){Yp(ey(o.prototype),"_updateArrowClass",this).call(this,e,t),this.$arrow&&(this.$arrow.cssLeft(null),this.$arrow.cssTop(null))}},{key:"_updateArrowPosition",value:function(){if(this.$arrow){var e=this._getAnchorMiddlePoint();if(e){this.$arrow.removeClass("leftedge rightedge topedge bottomedge");var t=No.size(this.$arrow),n=No.margins(this.$arrow);if(this._isVerticallyAligned()){var i=n.top+n.bottom;this.$arrow.cssTop(e.y-(i+this.$container.position().top+t.height/2))}else{var r=n.left+n.right;this.$arrow.cssLeft(e.x-(r+this.$container.position().left+t.width/2))}}}}},{key:"_getAnchorMiddlePoint",value:function(){var e=this.getAnchorBounds();return e?e.center():null}},{key:"_isVerticallyAligned",value:function(){return O.isOneOf(this.calculatedHorizontalAlignment,kd.Alignment.LEFT,kd.Alignment.RIGHT)}},{key:"setMovable",value:function(e){this.setProperty("movable",e)}},{key:"_renderMovable",value:function(){if(this.movable){if(this.$dragHandle)return;this.$dragHandle=this.$container.prependDiv("drag-handle"),this.$container.draggable(this.$dragHandle,s.a.throttle(this._moveHandler,1e3/60))}else{if(!this.$dragHandle)return;this.$container.undraggable(this.$dragHandle),this.$dragHandle.remove(),this.$dragHandle=null,this.htmlComp.layout.autoPosition=this._autoPositionOrig,this._autoPositionOrig=null,this.invalidateLayoutTree()}}},{key:"_onMove",value:function(e){null===this._autoPositionOrig&&(this._autoPositionOrig=this.htmlComp.layout.autoPosition,this.htmlComp.layout.autoPosition=!1),this.trigger("move",e)}},{key:"set$Anchor",value:function(e){this._autoPositionOrig&&e&&this.$anchor!==e&&(this.htmlComp.layout.autoPosition=this._autoPositionOrig,this._autoPositionOrig=null),Yp(ey(o.prototype),"set$Anchor",this).call(this,e)}}])&&qp(t.prototype,n),i&&qp(t,i),o}(kd);function ny(e){return(ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iy(e,t){return(iy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ry(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=sy(e);if(t){var r=sy(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return oy(this,n)}}function oy(e,t){return!t||"object"!==ny(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sy(e){return(sy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ay=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iy(e,t)}(n,e);var t=ry(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Ed);function uy(e){return(uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ly(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cy(e,t,n){return(cy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=py(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function fy(e,t){return(fy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=py(e);if(t){var r=py(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dy(this,n)}}function dy(e,t){return!t||"object"!==uy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function py(e){return(py=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fy(e,t)}(o,e);var t,n,i,r=hy(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"_setSize",value:function(e){cy(py(o.prototype),"_setSize",this).call(this,e);var t=this.popup.htmlComp,n=this.popup.widget.htmlComp,i=e.subtract(t.insets());n.setSize(i.subtract(n.margins()))}},{key:"preferredLayoutSize",value:function(e,t){var n=this.popup.htmlComp,i=this.popup.widget.htmlComp;return i.prefSize(t).add(n.insets()).add(i.margins())}}])&&ly(t.prototype,n),i&&ly(t,i),o}(Id);function vy(e){return(vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function by(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gy(e,t,n){return(gy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ky(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function my(e,t){return(my=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ky(e);if(t){var r=ky(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wy(this,n)}}function wy(e,t){return!t||"object"!==vy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ky(e){return(ky=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&my(e,t)}(o,e);var t,n,i,r=_y(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).preselectedDate=null,e.selectedDate=null,e.dateFormat=null,e.viewDate=null,e.allowedDates=null,e.currentMonth=null,e.$scrollable=null,e.months=[],e.touch=Mt.get().supportsOnlyTouch(),e}return t=o,(n=[{key:"_init",value:function(e){gy(ky(o.prototype),"_init",this).call(this,e),this._setDateFormat(this.dateFormat)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("date-picker").toggleClass("touch",this.touch),this.htmlComp=Uo.install(this.$container,this.session),this._$header=this._append$Header(),this._$header.find(".date-picker-left-y, .date-picker-left-m, .date-picker-right-m, .date-picker-right-y").mousedown(this._onNavigationMouseDown.bind(this)),this.$container.appendDiv("date-picker-separator"),this.$scrollable=this.$container.appendDiv("date-picker-scrollable"),this._registerSwipeHandlers()}},{key:"_setDateFormat",value:function(e){e||(e=this.session.locale.dateFormatPatternDefault),e=If.ensure(this.session.locale,e),this._setProperty("dateFormat",e)}},{key:"prependMonth",value:function(e){var t=this.months.slice();et.insert(t,e,0),this.setMonths(t)}},{key:"appendMonth",value:function(e){var t=this.months.slice();t.push(e),this.setMonths(t)}},{key:"resetMonths",value:function(e){e=e||this.viewDate;var t=wt.shift(e,0,-1,0),n=wt.shift(e,0,1,0);this.setMonths([t,e,n])}},{key:"setMonths",value:function(e){e=(e=et.ensure(e)).map((function(e){var t=e;e instanceof Date||(t=e.viewDate);var n=this._findMonthByViewDate(t);return n||{rendered:!1,viewDate:t,$container:void 0}}),this),this.rendered&&this.months.forEach((function(t){e.indexOf(t)<0&&t.rendered&&t.$container.remove()}),this),this.setProperty("months",e)}},{key:"_renderMonths",value:function(){this.months.forEach((function(e){e.rendered||(this._renderMonth(e),this.currentMonth&&wt.compare(e.viewDate,this.currentMonth.viewDate)<0&&e.$container.insertBefore(this.currentMonth.$container))}),this);var e=this.months.length*this._boxWidth;this.$scrollable.width(e),this.currentMonth&&this.$scrollable.cssLeft(this._scrollableLeftForMonth(this.currentMonth))}},{key:"_findMonthByViewDate",value:function(e){return et.find(this.months,(function(t){return 0===wt.compareMonths(t.viewDate,e)}))}},{key:"_scrollableLeftForMonth",value:function(e){var t=No.insets(this.$scrollable),n=No.margins(e.$container);return-1*(e.$container.position().left-n.left-t.left)}},{key:"_renderMonth",value:function(e){if(!e.rendered){var t=this.$parent.makeDiv("date-picker-month-box");this._build$DateBox(e.viewDate).appendTo(t),t.on("DOMMouseScroll mousewheel",this._onMouseWheel.bind(this)).appendTo(this.$scrollable),this._boxWidth||(this._boxWidth=t.width()),t.width(this._boxWidth),e.$container=t,e.rendered=!0}}},{key:"setViewDate",value:function(e,t){oi.equals(this.viewDate,e)||(this._setProperty("viewDate",e),this.rendered&&this._renderViewDate(t))}},{key:"_renderViewDate",value:function(e){var t=this._findMonthByViewDate(this.viewDate),n=this._scrollableLeftForMonth(t);this.currentMonth||this.revalidateLayoutTree(),this.currentMonth=t,this._updateHeader(this.viewDate),(e=O.nvl(e,!0))?this.$scrollable.stop(!0).animate({left:n},300,function(){this.resetMonths()}.bind(this)):(this.$scrollable.cssLeft(n),this.resetMonths())}},{key:"preselectDate",value:function(e,t){this.showDate(e,t),e&&this.setSelectedDate(null),this.setPreselectedDate(e)}},{key:"setPreselectedDate",value:function(e){this.setProperty("preselectedDate",e)}},{key:"_renderPreselectedDate",value:function(){this.currentMonth&&this.currentMonth.$container.find(".date-picker-day").each(function(e,t){var n=s()(t);n.removeClass("preselected"),wt.isSameDay(this.preselectedDate,n.data("date"))&&n.addClass("preselected")}.bind(this))}},{key:"selectDate",value:function(e,t){this.showDate(e,t),e&&this.setPreselectedDate(null),this.setSelectedDate(e)}},{key:"setSelectedDate",value:function(e){this.setProperty("selectedDate",e)}},{key:"_renderSelectedDate",value:function(){this.currentMonth&&this.currentMonth.$container.find(".date-picker-day").each(function(e,t){var n=s()(t);n.removeClass("selected"),wt.isSameDay(this.selectedDate,n.data("date"))&&n.addClass("selected")}.bind(this))}},{key:"showDate",value:function(e,t){var n=0;this.viewDate&&(n=wt.compareMonths(e,this.viewDate)),this.currentMonth&&n?n<0?this.prependMonth(e):this.appendMonth(e):this.currentMonth?this.resetMonths(e):this.setMonths([e]),this.setViewDate(e,t)}},{key:"shiftViewDate",value:function(e,t,n){var i=this.viewDate;i=wt.shift(i,e,t,n),this.showDate(i)}},{key:"shiftSelectedDate",value:function(e,t,n){var i=this.preselectedDate;this.selectedDate&&(i=this.allowedDates?this._findNextAllowedDate(e,t,n):wt.shift(this.selectedDate,e,t,n)),i&&this.selectDate(i,!0)}},{key:"_findNextAllowedDate",value:function(e,t,n){var i,r,o=e+t+n>0?1:-1,s=this.selectedDate||wt.trunc(new Date);if(0!==e?s=wt.shift(s,e,0,0):0!==t&&(s=wt.shift(s,0,t,0)),1===o){for(i=0;i<this.allowedDates.length;i++)if(r=this.allowedDates[i],wt.compare(s,r)<0)return r}else if(-1===o)for(i=this.allowedDates.length-1;i>=0;i--)if(r=this.allowedDates[i],wt.compare(s,r)>0)return r;return null}},{key:"_isDateAllowed",value:function(e){if(!this.allowedDates||0===this.allowedDates.length)return!0;var t=e.getTime();return this.allowedDates.some((function(e){return e.getTime()===t}))}},{key:"_build$DateBox",value:function(e){var t,n,i,r,o,s,a,u=new Date,l=new Date(e),c=this.dateFormat.symbols.weekdaysShortOrdered,f=this.$container.makeDiv("date-picker-month").data("viewDate",e),h=f.appendDiv("date-picker-weekdays");c.forEach((function(e){h.appendDiv("date-picker-weekday",e)}));for(var d=0;d<42;d++){l.setDate(l.getDate()-1);var p=new Date(l.getYear(),e.getMonth(),0).getDate()-l.getDate();if(0===l.getDay()&&l.getMonth()!==e.getMonth()&&p>1)break}for(n=0;n<42;n++)n%7==0&&(a=f.appendDiv("date-picker-week")),l.setDate(l.getDate()+1),o=l.getDate(),t=6===l.getDay()||0===l.getDay()?l.getMonth()!==e.getMonth()?" date-picker-out-weekend":" date-picker-weekend":l.getMonth()!==e.getMonth()?" date-picker-out":"",wt.isSameDay(l,u)&&(t+=" date-picker-now"),wt.isSameDay(this.selectedDate,l)&&(t+=" selected"),wt.isSameDay(this.preselectedDate,l)&&(t+=" preselected"),o>9&&o<20&&(t+=" ten"),(r=this._isDateAllowed(l))||(t+=" disabled"),i=o<=9?"0"+o:o,(s=a.appendDiv("date-picker-day"+t).data("dayInMonth",o).data("date",new Date(l))).appendSpan("text",i),r&&s.on("click",this._onDayClick.bind(this));return f}},{key:"_append$Header",value:function(){return this.$container.appendElement('<div class="date-picker-header">  <div class="date-picker-left-y" data-shift="-12"></div>  <div class="date-picker-left-m" data-shift="-1"></div>  <div class="date-picker-right-y" data-shift="12"></div>  <div class="date-picker-right-m" data-shift="1"></div>  <div class="date-picker-header-month"></div></div>').toggleClass("touch",this.touch)}},{key:"_updateHeader",value:function(e){this._$header.find(".date-picker-header-month").text(this._createHeaderText(e))}},{key:"_createHeaderText",value:function(e){return this.dateFormat.symbols.months[e.getMonth()]+" "+e.getFullYear()}},{key:"_registerSwipeHandlers",value:function(){var e=this.$scrollable.window();this.$scrollable.on("touchmove",(function(e){e.preventDefault()})),this.$scrollable.on("remove",(function(t){e.off(".datepickerDrag")})),this.$scrollable.on(Ft.touchdown(this.touch),function(t){var n=Ft.pageX(t),i=0;this.$scrollable.stop(!0);var r=wt.shift(this.viewDate,0,-1,0),o=wt.shift(this.viewDate,0,1,0);this.setMonths([r,this.viewDate,o]);var s=this.$scrollable.position().left;this.swiped=!1;var a=!0;e.on(Ft.touchmove(this.touch,"datepickerDrag"),function(e){var t=Ft.pageX(e),r=s+(i=t-n),o=this.$container.width()-this.$scrollable.outerWidth();(r=Math.max(Math.min(r,0),o))!==s&&this.$scrollable.cssLeft(r)}.bind(this)),e.on(Ft.touchendcancel(this.touch,"datepickerDrag"),function(t){if(e.off(".datepickerDrag"),a){a=!1;var n=this.viewDate;i<-5?n=o:i>5&&(n=r),this.viewDate!==n&&(this.swiped=!0,this.setViewDate(n))}}.bind(this))}.bind(this))}},{key:"_onNavigationMouseDown",value:function(e){var t=s()(e.currentTarget).data("shift");this.shiftViewDate(0,t,0)}},{key:"_onDayClick",value:function(e){if(!this.swiped){var t=s()(e.currentTarget).data("date");this.selectDate(t),this.trigger("dateSelect",{date:t})}}},{key:"_onMouseWheel",value:function(e){var t=((e=e.originalEvent||this.$container.window(!0).event.originalEvent).wheelDelta?e.wheelDelta/10:3*-e.detail)>=0?-1:1;this.shiftViewDate(0,t,0),e.preventDefault()}}])&&by(t.prototype,n),i&&by(t,i),o}(de);function Oy(e){return(Oy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ty(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cy(e,t,n){return(Cy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ey(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Py(e,t){return(Py=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ry(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ey(e);if(t){var r=Ey(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xy(this,n)}}function xy(e,t){return!t||"object"!==Oy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ey(e){return(Ey=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Py(e,t)}(o,e);var t,n,i,r=Ry(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){e.scrollType=e.scrollType||"layoutAndPosition",e.withFocusContext=!1,Cy(Ey(o.prototype),"_init",this).call(this,e),this.picker=O.create("DatePicker",{parent:this,dateFormat:e.dateFormat,allowedDates:e.allowedDates})}},{key:"_createLayout",value:function(){return new By(this)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("date-picker-popup"),this.$container.toggleClass("alternative",this.field.fieldStyle===GH.FieldStyle.ALTERNATIVE),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.validateRoot=!0,this.picker.render()}},{key:"getDatePicker",value:function(){return this.picker}},{key:"_isMouseDownOnAnchor",value:function(e){return this.field.$dateField.isOrHas(e.target)||this.field.$dateFieldIcon.isOrHas(e.target)||this.field.$dateClearIcon&&this.field.$dateClearIcon.isOrHas(e.target)}}])&&Ty(t.prototype,n),i&&Ty(t,i),o}(kd);function Fy(e){return(Fy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ay(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $y(e,t,n){return($y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ly(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function jy(e,t){return(jy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function My(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ly(e);if(t){var r=Ly(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Iy(this,n)}}function Iy(e,t){return!t||"object"!==Fy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ly(e){return(Ly=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var By=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jy(e,t)}(o,e);var t,n,i,r=My(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).popup=e,t.doubleCalcPrefSize=!1,t}return t=o,(n=[{key:"layout",value:function(e){var t,n=this.popup.htmlComp,i=this.popup.picker.htmlComp;$y(Ly(o.prototype),"layout",this).call(this,e),t=n.size().subtract(n.insets()).subtract(i.margins()),i.setSize(t),this.popup.htmlComp.layouted&&this.popup.position()}},{key:"preferredLayoutSize",value:function(e){var t=this.popup.htmlComp,n=this.popup.picker.htmlComp;return n.prefSize().add(t.insets()).add(n.margins())}}])&&Ay(t.prototype,n),i&&Ay(t,i),o}(Id);function Ny(e){return(Ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Vy(e,t,n){return(Vy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Uy(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Wy(e,t){return(Wy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Uy(e);if(t){var r=Uy(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gy(this,n)}}function Gy(e,t){return!t||"object"!==Ny(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uy(e){return(Uy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ky=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wy(e,t)}(o,e);var t,n,i,r=zy(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){Vy(Uy(o.prototype),"_init",this).call(this,e),this._field.on("acceptInput",this._onFieldAcceptInput.bind(this))}},{key:"_initWidget",value:function(e){this._widget=O.create("DatePicker",{parent:this,dateFormat:e.dateFormat,allowedDates:e.allowedDates})}},{key:"_render",value:function(){Vy(Uy(o.prototype),"_render",this).call(this),this._field.$container.addClass("date")}},{key:"_onMouseDownOutside",value:function(){this._acceptInput()}},{key:"getDatePicker",value:function(){return this._widget}},{key:"_createLayout",value:function(){return new ev(this)}},{key:"_onFieldAcceptInput",value:function(e){this._touchField.setDisplayText(e.displayText),this._touchField.setErrorStatus(e.errorStatus),e.errorStatus||this._touchField.setValue(e.value),this._touchField._triggerAcceptInput()}}])&&Hy(t.prototype,n),i&&Hy(t,i),o}(Lp);function qy(e){return(qy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xy(e,t){return(Xy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Qy(e);if(t){var r=Qy(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Zy(this,n)}}function Zy(e,t){return!t||"object"!==qy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qy(e){return(Qy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ev=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xy(e,t)}(o,e);var t,n,i,r=Jy(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"preferredLayoutSize",value:function(e,t){var n=Vo.get().formColumnWidth,i=this.popup.htmlComp.insets(),r=this.popup._field.htmlComp,o=this.popup._widgetContainerHtmlComp,s=r.prefSize(t).add(r.margins()),a=o.prefSize(t).add(o.margins()),u=No.size(this.popup._$header,!0).height+s.height+a.height+i.vertical();return new Co(n,u)}}])&&Yy(t.prototype,n),i&&Yy(t,i),o}(Up);function tv(e){return(tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iv(e,t,n){return(iv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=av(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function rv(e,t){return(rv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ov(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=av(e);if(t){var r=av(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sv(this,n)}}function sv(e,t){return!t||"object"!==tv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function av(e){return(av=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rv(e,t)}(o,e);var t,n,i,r=ov(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).bodyAnimating=!1,e.collapsed=!1,e.collapsible=!0,e.title=null,e.titleHtmlEnabled=!1,e.titleSuffix=null,e.header=null,e.headerFocusable=!1,e.headerVisible=!0,e.body=null,e.$container=null,e.$header=null,e.$footer=null,e.$collapseIcon=null,e.$collapseBorderLeft=null,e.$collapseBorderRight=null,e.collapseStyle=o.CollapseStyle.LEFT,e.htmlComp=null,e.htmlHeader=null,e.htmlFooter=null,e.iconId=null,e.icon=null,e._addWidgetProperties(["header"]),e._addWidgetProperties(["body"]),e}return t=o,(n=[{key:"_init",value:function(e){iv(av(o.prototype),"_init",this).call(this,e),this.resolveTextKeys(["title","titleSuffix"]),this.resolveIconIds(["iconId"]),this._setBody(this.body),this._setHeader(this.header)}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){iv(av(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.$bindTarget=function(){return this.$header}.bind(this),this.keyStrokeContext.registerKeyStroke([new Rv(this)])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("group"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new wv(this)),this._renderHeader(),this.$collapseIcon=this.$header.appendDiv("group-collapse-icon"),this.$footer=this.$container.appendDiv("group-footer"),this.$collapseBorderLeft=this.$footer.appendDiv("group-collapse-border"),this.$collapseBorderRight=this.$footer.appendDiv("group-collapse-border"),this.htmlFooter=Uo.install(this.$footer,this.session),this.$footer.on("mousedown",this._onFooterMouseDown.bind(this))}},{key:"_renderProperties",value:function(){iv(av(o.prototype),"_renderProperties",this).call(this),this._renderIconId(),this._renderTitle(),this._renderTitleSuffix(),this._renderHeaderVisible(),this._renderHeaderFocusable(),this._renderCollapsed(),this._renderCollapseStyle(),this._renderCollapsible()}},{key:"_remove",value:function(){this.$header=null,this.$title=null,this.$titleSuffix=null,this.$footer=null,this.$collapseIcon=null,this.$collapseBorderLeft=null,this.$collapseBorderRight=null,this._removeIconId(),iv(av(o.prototype),"_remove",this).call(this)}},{key:"_renderEnabled",value:function(){iv(av(o.prototype),"_renderEnabled",this).call(this),this.$header.setTabbable(this.enabledComputed)}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(){var e=this.iconId||"";return e?this.icon?(this.icon.setIconDesc(e),void this._updateIconStyle()):(this.icon=O.create("Icon",{parent:this,iconDesc:e,prepend:!0}),this.icon.one("destroy",function(){this.icon=null}.bind(this)),this.icon.render(this.$header),void this._updateIconStyle()):(this._removeIconId(),void this._updateIconStyle())}},{key:"_updateIconStyle",value:function(){var e=!!this.title;this.get$Icon().toggleClass("with-title",e),this.get$Icon().addClass("group-icon"),this._renderCollapseStyle()}},{key:"get$Icon",value:function(){return this.icon?this.icon.$container:s()()}},{key:"_removeIconId",value:function(){this.icon&&this.icon.destroy()}},{key:"setHeader",value:function(e){this.setProperty("header",e)}},{key:"_setHeader",value:function(e){this._setProperty("header",e)}},{key:"setHeaderFocusable",value:function(e){this.setProperty("headerFocusable",e)}},{key:"_renderHeaderFocusable",value:function(){this.$header.toggleClass("unfocusable",!this.headerFocusable)}},{key:"setTitle",value:function(e){this.setProperty("title",e)}},{key:"_renderTitle",value:function(){this.$title&&(this.titleHtmlEnabled?this.$title.htmlOrNbsp(this.title):this.$title.textOrNbsp(this.title),this._updateIconStyle())}},{key:"setTitleSuffix",value:function(e){this.setProperty("titleSuffix",e)}},{key:"_renderTitleSuffix",value:function(){this.$titleSuffix&&this.$titleSuffix.text(this.titleSuffix||"")}},{key:"setHeaderVisible",value:function(e){this.setProperty("headerVisible",e)}},{key:"_renderHeaderVisible",value:function(){this.$header.setVisible(this.headerVisible),this._renderCollapsible(),this.invalidateLayoutTree()}},{key:"setBody",value:function(e){this.setProperty("body",e)}},{key:"_setBody",value:function(e){e||(e=O.create("Widget",{parent:this,_render:function(){this.$container=this.$parent.appendDiv("group"),this.htmlComp=Uo.install(this.$container,this.session)}})),this._setProperty("body",e)}},{key:"_createLoadingSupport",value:function(){return new te({widget:this,$container:function(){return this.$header}.bind(this)})}},{key:"_renderHeader",value:function(){this.$header&&(this.$header.remove(),this._removeIconId()),this.header?(this.header.render(),this.$header=this.header.$container.addClass("group-header").addClass("custom-header-widget").prependTo(this.$container),this.htmlHeader=this.header.htmlComp):(this.$header=this.$container.prependDiv("group-header").unfocusable().addClass("prevent-initial-focus"),this.$title=this.$header.appendDiv("group-title"),this.$titleSuffix=this.$header.appendDiv("group-title-suffix"),dh.installForEllipsis(this.$title,{parent:this}),this.htmlHeader=Uo.install(this.$header,this.session),this.rendering||(this._renderIconId(),this._renderTitle(),this._renderTitleSuffix())),this.$header.on("mousedown",this._onHeaderMouseDown.bind(this)),this.invalidateLayoutTree()}},{key:"_renderBody",value:function(){this.body.render(),this.body.$container.insertAfter(this.$header),this.body.$container.addClass("group-body"),this.body.invalidateLayoutTree()}},{key:"getFocusableElement",value:function(){return!!this.rendered&&this.$header}},{key:"toggleCollapse",value:function(){this.setCollapsed(!this.collapsed&&this.collapsible)}},{key:"setCollapsed",value:function(e){this.setProperty("collapsed",e)}},{key:"_renderCollapsed",value:function(){this.$container.toggleClass("collapsed",this.collapsed),this.$collapseIcon.toggleClass("collapsed",this.collapsed),this.collapsed||this.bodyAnimating||this._renderBody(),this.rendered?this.resizeBody():this.collapsed&&this.body.remove(),this.invalidateLayoutTree()}},{key:"setCollapsible",value:function(e){this.setProperty("collapsible",e)}},{key:"_renderCollapsible",value:function(){this.$container.toggleClass("collapsible",this.collapsible),this.$header.toggleClass("disabled",!this.collapsible),this.$footer.setVisible(this.collapseStyle===o.CollapseStyle.BOTTOM&&(this.headerVisible||this.collapsible)),this.$collapseIcon.setVisible(this.collapsible),this.invalidateLayoutTree()}},{key:"setCollapseStyle",value:function(e){this.setProperty("collapseStyle",e)}},{key:"_renderCollapseStyle",value:function(){if(this.$header.toggleClass("collapse-right",this.collapseStyle===o.CollapseStyle.RIGHT),this.$container.toggleClass("collapse-bottom",this.collapseStyle===o.CollapseStyle.BOTTOM),this.collapseStyle!==o.CollapseStyle.RIGHT||this.header)if(this.collapseStyle!==o.CollapseStyle.LEFT||this.header){if(this.collapseStyle===o.CollapseStyle.BOTTOM){var e=this.body.$container?this.body.$container:this.$header;this.$footer.insertAfter(e),this.$collapseIcon.insertAfter(this.$collapseBorderLeft)}}else this.$collapseIcon.prependTo(this.$header);else this.$collapseIcon.appendTo(this.$header);this._renderCollapsible(),this.invalidateLayoutTree()}},{key:"_onHeaderMouseDown",value:function(e){!this.collapsible||this.header&&this.collapseStyle===o.CollapseStyle.BOTTOM||this.setCollapsed(!this.collapsed&&this.collapsible)}},{key:"_onFooterMouseDown",value:function(e){this.collapsible&&this.setCollapsed(!this.collapsed&&this.collapsible)}},{key:"resizeBody",value:function(){this.animateToggleCollapse().done(function(){this.bodyAnimating||(this.collapsed&&this.body.remove(),this.invalidateLayoutTree())}.bind(this))}},{key:"animateToggleCollapse",value:function(e){var t,n,i,r=No.cssSize(this.body.$container),o=No.margins(this.body.$container),s=No.paddings(this.body.$container);return this.collapsed?(t=0,n=new Ro,i=new Ro):(t=this.body.htmlComp.prefSize({widthHint:r.width}).height,this.body.htmlComp.setSize(new Co(this.body.$container.outerWidth(),t)),this.bodyAnimating?(this.body.$container.cssMarginY("").cssPaddingY(""),n=No.margins(this.body.$container),i=No.paddings(this.body.$container)):(r.height=0,o=new Ro,s=new Ro,n=No.margins(this.body.$container),i=No.paddings(this.body.$container))),this.bodyAnimating=!0,this.collapsed&&this.$container.addClass("collapsing"),this.body.$container.stop(!0).cssHeight(r.height).cssMarginTop(o.top).cssMarginBottom(o.bottom).cssPaddingTop(s.top).cssPaddingBottom(s.bottom).animate({height:t,marginTop:n.top,marginBottom:n.bottom,paddingTop:i.top,paddingBottom:i.bottom},{duration:350,progress:function(){this.trigger("bodyHeightChange"),this.revalidateLayoutTree()}.bind(this),complete:function(){this.bodyAnimating=!1,this.body.rendered&&(this.body.$container.cssMarginY(""),this.body.$container.cssPaddingY("")),this.rendered&&this.$container.removeClass("collapsing"),this.trigger("bodyHeightChangeDone")}.bind(this)}).promise()}}])&&nv(t.prototype,n),i&&nv(t,i),o}(de);function lv(e){return(lv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cv(e,t){return(cv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=dv(e);if(t){var r=dv(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return hv(this,n)}}function hv(e,t){return!t||"object"!==lv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dv(e){return(dv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(uv,"CollapseStyle",{LEFT:"left",RIGHT:"right",BOTTOM:"bottom"});var pv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cv(e,t)}(n,e);var t=fv(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["collapsed"]),e}return n}(fe);function yv(e){return(yv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bv(e,t){return(bv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_v(e);if(t){var r=_v(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return mv(this,n)}}function mv(e,t){return!t||"object"!==yv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _v(e){return(_v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bv(e,t)}(o,e);var t,n,i,r=gv(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).group=e,t}return t=o,(n=[{key:"layout",value:function(e){var t=this.group.htmlComp,n=t.availableSize().subtract(t.insets()),i=this.group.htmlHeader,r=i.prefSize({widthHint:n.width});r.width=n.width,r=r.subtract(i.margins()),i.setSize(r);var o=this.group.htmlFooter;if(o.isVisible()){var s=o.prefSize({includeMargin:!1,useCssSize:!0});s.width=n.width,o.setSize(s.subtract(o.margins()))}if(!this.group.collapsed&&!this.group.bodyAnimating&&this.group.body.rendered&&this.group.body.isVisible()){var a=this.group.body.htmlComp,u=n.subtract(a.margins());u.height-=r.height,o.isVisible()&&(u.height-=o.prefSize(!0).height),a.setSize(u)}}},{key:"invalidate",value:function(e){this.group.body.htmlComp&&this.group.bodyAnimating&&e&&e.isDescendantOf(this.group.htmlComp)&&(this.group.body.$container.stop(),this.group.resizeBody())}},{key:"preferredLayoutSize",value:function(e,t){var n;t=t||{};var i=this.group.htmlComp,r=this.group.htmlHeader,o=this.group.body.htmlComp,s=this.group.htmlFooter;return t.heightHint=null,(n=(n=this.group.bodyAnimating?o.size(!0):!this.group.collapsed&&this.group.body.rendered&&this.group.body.isVisible()?o.prefSize(t).add(o.margins()):new Co(0,0)).add(i.insets({includeMargin:!0}))).height+=r.prefSize(t).add(r.margins()).height,s.isVisible()&&(n.height+=s.prefSize({includeMargin:!0,useCssSize:!0}).height),n}}])&&vv(t.prototype,n),i&&vv(t,i),o}(zo);function kv(e){return(kv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ov(e,t){return(Ov=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Pv(e);if(t){var r=Pv(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Cv(this,n)}}function Cv(e,t){return!t||"object"!==kv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pv(e){return(Pv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ov(e,t)}(o,e);var t,n,i,r=Tv(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).field=e,t.which=[pu.SPACE],t}return t=o,(n=[{key:"handle",value:function(e){this.field.toggleCollapse()}}])&&Sv(t.prototype,n),i&&Sv(t,i),o}($u);function xv(e){return(xv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ev(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Dv(e,t,n){return(Dv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jv(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Fv(e,t){return(Fv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Av(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=jv(e);if(t){var r=jv(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $v(this,n)}}function $v(e,t){return!t||"object"!==xv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jv(e){return(jv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fv(e,t)}(o,e);var t,n,i,r=Av(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).iconDesc=null,e.image=null,e.prepend=!1,e}return t=o,(n=[{key:"_init",value:function(e){Dv(jv(o.prototype),"_init",this).call(this,e),this._setIconDesc(this.iconDesc)}},{key:"_renderProperties",value:function(){Dv(jv(o.prototype),"_renderProperties",this).call(this),this._renderIconDesc()}},{key:"setIconDesc",value:function(e){this.setProperty("iconDesc",e)}},{key:"_setIconDesc",value:function(e){e=Bv.ensure(e),this._setProperty("iconDesc",e)}},{key:"_renderIconDesc",value:function(){this._removeFontIcon(),this._removeImageIcon(),!this.iconDesc||this.iconDesc.isFontIcon()?this._renderFontIcon():this._renderImageIcon(),this.invalidateLayoutTree()}},{key:"_renderFontIcon",value:function(){this.$container=this.$parent.appendIcon(this.iconDesc),this.prepend&&this.$container.prependTo(this.$parent),this.htmlComp=Uo.install(this.$container,this.session)}},{key:"_removeFontIcon",value:function(){this.$container&&(this.$container.remove(),this.$container=null)}},{key:"_renderImageIcon",value:function(){this.image||(this.image=O.create("Image",{parent:this,imageUrl:this.iconDesc.iconUrl,cssClass:"icon image-icon",autoFit:this.autoFit,prepend:this.prepend}),this.image.render(this.$parent),this.image.one("destroy",function(){this.image=null}.bind(this)),this.image.on("load error",function(e){this.trigger(e.type,e)}.bind(this)),this.$container=this.image.$container,this.htmlComp=this.image.htmlComp)}},{key:"_removeImageIcon",value:function(){this.image&&(this.image.destroy(),this.image=null)}},{key:"setAutoFit",value:function(e){this.image&&this.image.setAutoFit(e)}}])&&Ev(t.prototype,n),i&&Ev(t,i),o}(de);function Iv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Lv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bv=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.iconType,this.font,this.iconCharacter,this.iconUrl}var t,n,i;return t=e,i=[{key:"ensure",value:function(t){return t?t instanceof e?t:sn.parseIconId(t):t}}],(n=[{key:"cssClass",value:function(){return this.isFontIcon()&&this.font!==e.DEFAULT_FONT?"font-"+this.font:""}},{key:"appendCssClass",value:function(e){var t=this.cssClass();return t.length>0?e+" "+t:e}},{key:"isFontIcon",value:function(){return this.iconType===e.IconType.FONT_ICON}},{key:"isBitmap",value:function(){return this.iconType===e.IconType.BITMAP}}])&&Iv(t.prototype,n),i&&Iv(t,i),e}();function Nv(e){return(Nv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Vv(e,t,n){return(Vv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Uv(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Wv(e,t){return(Wv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Uv(e);if(t){var r=Uv(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gv(this,n)}}function Gv(e,t){return!t||"object"!==Nv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uv(e){return(Uv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Lv(Bv,"IconType",{FONT_ICON:0,BITMAP:1}),Lv(Bv,"DEFAULT_FONT","scoutIcons");var Kv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wv(e,t)}(o,e);var t,n,i,r=zv(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).autoFit=!1,e.imageUrl=null,e.prepend=!1,e}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.makeElement("<img>","image").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this)),this.prepend?this.$container.prependTo(this.$parent):this.$container.appendTo(this.$parent),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new tb(this)),this.htmlComp.pixelBasedSizing=!1}},{key:"_renderProperties",value:function(){Vv(Uv(o.prototype),"_renderProperties",this).call(this),this._renderImageUrl(),this._renderAutoFit()}},{key:"_remove",value:function(){Vv(Uv(o.prototype),"_remove",this).call(this),this.htmlComp=null}},{key:"setImageUrl",value:function(e){this.setProperty("imageUrl",e)}},{key:"_renderImageUrl",value:function(){this.$container.attr("src",this.imageUrl),this.imageUrl||this.$container.addClass("empty").removeClass("broken")}},{key:"setAutoFit",value:function(e){this.setProperty("autoFit",e)}},{key:"_renderAutoFit",value:function(){this.$container.toggleClass("autofit",this.autoFit)}},{key:"_onImageLoad",value:function(e){this.rendered&&(this._ensureImageLayout(),this.$container.removeClass("empty broken"),this.invalidateLayoutTree(),this.trigger("load"))}},{key:"_ensureImageLayout",value:function(){Mt.get().isChrome()&&(this.$container.addClass("chrome-fix"),setTimeout(function(){this.rendered&&this.$container.removeClass("chrome-fix")}.bind(this)))}},{key:"_onImageError",value:function(e){this.rendered&&(this.$container.addClass("empty broken"),this.invalidateLayoutTree(),this.trigger("error"))}}])&&Hv(t.prototype,n),i&&Hv(t,i),o}(de);function qv(e){return(qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xv(e,t,n){return(Xv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eb(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Jv(e,t){return(Jv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=eb(e);if(t){var r=eb(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Qv(this,n)}}function Qv(e,t){return!t||"object"!==qv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eb(e){return(eb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jv(e,t)}(o,e);var t,n,i,r=Zv(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).image=e,t}return t=o,(n=[{key:"preferredLayoutSize",value:function(e,t){var n=e[0];if(n&&n.complete&&n.naturalWidth>0&&n.naturalHeight>0){var i=n.naturalHeight,r=n.naturalWidth;return t.widthHint>0&&t.widthHint<n.naturalWidth?(i=t.widthHint/n.naturalWidth*n.naturalHeight,r=t.widthHint):t.heightHint>0&&t.heightHint<n.naturalHeight&&(i=t.heightHint,r=t.heightHint/n.naturalHeight*n.naturalWidth),new Co(r,i)}return Xv(eb(o.prototype),"preferredLayoutSize",this).call(this,e,t)}}])&&Yv(t.prototype,n),i&&Yv(t,i),o}(zo);function nb(e){return(nb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ib(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rb(e,t,n){return(rb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ub(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function ob(e,t){return(ob=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ub(e);if(t){var r=ub(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ab(this,n)}}function ab(e,t){return!t||"object"!==nb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ub(e){return(ub=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ob(e,t)}(o,e);var t,n,i,r=sb(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).status=pi.info(),e}return t=o,(n=[{key:"_init",value:function(e){rb(ub(o.prototype),"_init",this).call(this,e),(e.severity||e.message)&&(this.status=new pi({severity:O.nvl(e.severity,this.status.severity),message:O.nvl(e.message,this.status.message)})),th.resolveTextProperty(this.status,"message",this.session),this._setStatus(this.status)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("notification"),this.htmlComp=Uo.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){rb(ub(o.prototype),"_renderProperties",this).call(this),this._renderStatus()}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"_setStatus",value:function(e){this.rendered&&this._removeStatus(),e=pi.ensure(e),this._setProperty("status",e)}},{key:"_removeStatus",value:function(){this.status&&this.$container.removeClass(this.status.cssClass())}},{key:"_renderStatus",value:function(){this.status&&this.$container.addClass(this.status.cssClass()),this._renderMessage()}},{key:"_renderMessage",value:function(){var e=O.nvl(En.nl2br(this.status.message),"");this.$container.html(e),this.invalidateLayoutTree()}}])&&ib(t.prototype,n),i&&ib(t,i),o}(de);function cb(e){return(cb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fb(e,t){return(fb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pb(e);if(t){var r=pb(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return db(this,n)}}function db(e,t){return!t||"object"!==cb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pb(e){return(pb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fb(e,t)}(n,e);var t=hb(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(fe);function vb(e,t,n,i,r){if(e){t=et.ensure(t),r=et.ensure(r);var o=[],s=0;return e.forEach((function(e){var a=e.childActions;if(a.length>0){if(0===(a=vb(a,t,n,i,r)).length)return void bb(e,i,!0)}else if(!gb(e,t)||0!==r.length&&gb(e,r))return void bb(e,i,!0);!n||e.visible?(e.separator&&s++,bb(e,i,!1),o.push(e)):bb(e,i,!0)})),s===o.length?[]:o}}function bb(e,t,n){t&&(e.excludedByFilter=n)}function gb(e,t){if(!t||0===t.length)return!1;if(!e.menuTypes)return!1;for(var n=0;n<t.length;n++)if(e.menuTypes.indexOf(t[n])>-1)return!0}var mb={checkType:function(e,t){return t=et.ensure(t),e.childActions.length>0?vb(e.childActions,t).length>0:gb(e,t)},createEllipsisMenu:function(e){var t={iconId:sn.ELLIPSIS_V,tabbable:!1};return e=s.a.extend({},t,e),O.create("Menu",e)},filter:vb,filterAccordingToSelection:function(e,t,n,i,r,o,s){var a=[];i===_b.MENU_BAR?a=[e+".EmptySpace",e+".SingleSelection",e+".MultiSelection"]:i===_b.CONTEXT_MENU?a=[e+".SingleSelection",e+".MultiSelection"]:i===_b.HEADER&&(a=[e+".Header"]),a.indexOf(e+".SingleSelection")>-1&&1!==t&&et.remove(a,e+".SingleSelection"),a.indexOf(e+".MultiSelection")>-1&&t<=1&&et.remove(a,e+".MultiSelection"),s=et.ensure(s);var u=[];return e+=".",s.forEach((function(t){t.slice(0,e.length)!==e&&(t=e+t),u.push(t)}),this),vb(n,a,r,o,u)},moveMenuIntoEllipsis:function(e,t){e.remove(),e.overflow=!0,e.overflowMenu=t;var n=t.childActions.slice();n.unshift(e),t.setChildActions(n)},removeMenuFromEllipsis:function(e,t){e.overflow=!1,e.overflowMenu=null,e.rendered||e.render(t)},updateSeparatorVisibility:function(e){if(0!==(e=(e=et.ensure(e)).filter((function(e){return e.visible||e.separator}))).length){var t=!1,n=!1;e.forEach((function(i,r){i.ellipsis||(i.separator?(n=e[r+1]&&!e[r+1].separator&&!e[r+1].ellipsis,t&&n?void 0!==i.visibleOrig&&(i.setVisible(i.visibleOrig),i.visibleOrig=void 0):void 0===i.visibleOrig&&(i.visibleOrig=i.visible,i.setVisible(!1))):t=!0)}))}}},_b={MENU_BAR:1,CONTEXT_MENU:2,HEADER:3};function wb(e){return(wb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Sb(e,t,n){return(Sb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pb(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ob(e,t){return(Ob=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Pb(e);if(t){var r=Pb(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Cb(this,n)}}function Cb(e,t){return!t||"object"!==wb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pb(e){return(Pb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ob(e,t)}(o,e);var t,n,i,r=Tb(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).childActions=[],e.defaultMenu=null,e.excludedByFilter=!1,e.menuTypes=[],e.menuStyle=o.MenuStyle.NONE,e.overflown=!1,e.parentMenu=null,e.popup=null,e.popupHorizontalAlignment=void 0,e.popupVerticalAlignment=void 0,e.stackable=!0,e.separator=!1,e.shrinkable=!1,e.subMenuVisibility=o.SubMenuVisibility.DEFAULT,e.menuFilter=null,e._addCloneProperties(["defaultMenu","menuTypes","overflow","stackable","separator","shrinkable","parentMenu","menuFilter"]),e._addWidgetProperties("childActions"),e}return t=o,(n=[{key:"_init",value:function(e){Sb(Pb(o.prototype),"_init",this).call(this,e),this._setChildActions(this.childActions)}},{key:"_initKeyStrokeContext",value:function(){Sb(Pb(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new og(this))}},{key:"_render",value:function(){this.separator?this._renderSeparator():this._renderItem(),this.$container.unfocusable(),this.htmlComp=Uo.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){Sb(Pb(o.prototype),"_renderProperties",this).call(this),this._renderOverflown(),this._renderMenuStyle(),this._renderActionStyle()}},{key:"_remove",value:function(){Sb(Pb(o.prototype),"_remove",this).call(this),this.$submenuIcon=null,this.$subMenuBody=null}},{key:"_renderSeparator",value:function(){this.$container=this.$parent.appendDiv("menu-separator")}},{key:"_renderItem",value:function(){this.$container=this.$parent.appendDiv("menu-item"),this.uiCssClass&&this.$container.addClass(this.uiCssClass);var e=this._onMouseEvent.bind(this);this.$container.on("mousedown",e).on("contextmenu",e).on("click",e),this._renderSubMenuIcon()}},{key:"_renderActionStyle",value:function(){this.$container.toggleClass("menu-button",this.isButton()&&!this.overflown)}},{key:"_renderSelected",value:function(){this._doActionTogglesSubMenu()||(Sb(Pb(o.prototype),"_renderSelected",this).call(this),this.parent instanceof Rg&&this.parent.updateNextToSelected()),this.selected?this._doActionTogglesSubMenu()?this._renderSubMenuItems(this,this.childActions):this._doActionTogglesPopup()&&this._openPopup():this._doActionTogglesSubMenu()&&this.rendered?this._removeSubMenuItems(this):(this._closePopup(),this._closeSubMenues())}},{key:"_closeSubMenues",value:function(){this.childActions.forEach((function(e){e._doActionTogglesPopup()&&(e._closeSubMenues(),e.setSelected(!1))}))}},{key:"_removeSubMenuItems",value:function(e){this.parent instanceof Rg?this.parent.removeSubMenuItems(e,!0):this.parent instanceof o&&this.parent._removeSubMenuItems(e)}},{key:"_renderSubMenuItems",value:function(e,t){if(this.parent instanceof Rg){this.parent.renderSubMenuItems(e,t,!0);var n=function(t){e.setSelected(!1)},i=function(t){"selected"===t.propertyName&&!1===t.newValue&&(this.parent.off("close",n),e.off("propertyChange",i))}.bind(this);this.parent.on("close",n),e.on("propertyChange",i)}else this.parent instanceof o&&this.parent._renderSubMenuItems(e,t)}},{key:"_togglesSubMenu",value:function(){return!0}},{key:"_doActionTogglesSubMenu",value:function(){return!!this.childActions.length&&(this.parent instanceof Rg||this.parent instanceof o&&this.parent._togglesSubMenu())}},{key:"_getSubMenuLevel",value:function(){return this.parent instanceof Rg?0:Sb(Pb(o.prototype),"_getSubMenuLevel",this).call(this)+1}},{key:"_onMouseEvent",value:function(e){"mousedown"===e.type&&this._doubleClickSupport.mousedown(e),this._allowMouseEvent(e)&&(dh.cancel(this.$container),"mousedown"===e.type&&this._doActionTogglesPopup()?this.doAction():"click"!==e.type&&"contextmenu"!==e.type||this._doActionTogglesPopup()||this.doAction())}},{key:"_doActionTogglesPopup",value:function(){return this.childActions.length>0}},{key:"_renderChildActions",value:function(){if(oi.optProperty(this.popup,"rendered")){var e=this.popup.$container;this.childActions.forEach((function(t){t.render(e)}))}this._renderSubMenuIcon()}},{key:"_renderSubMenuIcon",value:function(){var e=!1;if(this.childActions.length>0)switch(this.subMenuVisibility){case o.SubMenuVisibility.DEFAULT:e=this._hasText();break;case o.SubMenuVisibility.TEXT_OR_ICON:e=this._hasText()||this.iconId;break;case o.SubMenuVisibility.ALWAYS:e=!0}if(e){if(!this.$submenuIcon){var t=sn.parseIconId(o.SUBMENU_ICON);this.$submenuIcon=this.$container.appendSpan("submenu-icon").text(t.iconCharacter),this.invalidateLayoutTree()}}else this.$submenuIcon&&(this.$submenuIcon.remove(),this.$submenuIcon=null,this.invalidateLayoutTree())}},{key:"_renderText",value:function(e){Sb(Pb(o.prototype),"_renderText",this).call(this,e),this.$submenuIcon&&this.$submenuIcon.appendTo(this.$container),this.$container.toggleClass("has-text",En.hasText(this.text)&&this.textVisible),this._updateIconAndTextStyle(),this.invalidateLayoutTree()}},{key:"_renderIconId",value:function(){Sb(Pb(o.prototype),"_renderIconId",this).call(this),this.$container.toggleClass("has-icon",!!this.iconId),this._updateIconAndTextStyle(),this.invalidateLayoutTree()}},{key:"isTabTarget",value:function(){return this.enabledComputed&&this.visible&&!this.overflown&&(this.isButton()||!this.separator)}},{key:"recomputeEnabled",value:function(e){var t,n;void 0===e&&(e=this._getInheritedAccessibility()),n=this.enabled&&this.inheritAccessibility&&!e&&this.childActions.length>0?!!(t=this._hasAccessibleChildMenu())&&e:t=this._computeEnabled(this.inheritAccessibility,e),this._updateEnabledComputed(t,n)}},{key:"_getInheritedAccessibility",value:function(){for(var e=this,t=e;e;){if(!e.inheritAccessibility)return e.enabled;t=e,e=e.parentMenu}var n=t.parent;return!n||!n.initialized||void 0===n.enabledComputed||n.enabledComputed}},{key:"_findRootMenu",value:function(){for(var e,t=this;t;)e=t,t=t.parentMenu;return e}},{key:"_hasAccessibleChildMenu",value:function(){var e=!1;return this.visitChildMenus((function(t){return!t.inheritAccessibility&&t.enabled&&t.visible?(e=!0,JW.TERMINATE):JW.CONTINUE})),e}},{key:"visitChildMenus",value:function(e){for(var t=0;t<this.childActions.length;t++){var n=this.childActions[t];if(n instanceof o){var i=e(n);if(!0===i||i===JW.TERMINATE)return JW.TERMINATE;if(i!==JW.SKIP_SUBTREE&&(!0===(i=n.visitChildMenus(e))||i===JW.TERMINATE))return JW.TERMINATE}}}},{key:"_hasText",value:function(){return En.hasText(this.text)&&this.textVisible}},{key:"_updateIconAndTextStyle",value:function(){var e=this._hasText(),t=!(!e||!this.iconId);this.$container.toggleClass("menu-textandicon",t),this.$container.toggleClass("menu-icononly",!e)}},{key:"_closePopup",value:function(){this.popup&&this.popup.close()}},{key:"_openPopup",value:function(){this.popup||(this.popup=this._createPopup(),this.popup.open(),this.popup.on("remove",function(e){this.popup=null}.bind(this)),this.popup.on("close",function(e){this.setSelected(!1)}.bind(this)),this.uiCssClass&&this.popup.$container.addClass(this.uiCssClass))}},{key:"_createPopup",value:function(e){var t={parent:this,menu:this,menuFilter:this.menuFilter,ignoreEvent:e,horizontalAlignment:this.popupHorizontalAlignment,verticalAlignment:this.popupVerticalAlignment};return O.create("MenuBarPopup",t)}},{key:"_createActionKeyStroke",value:function(){return new Jb(this)}},{key:"isToggleAction",value:function(){return this.childActions.length>0||this.toggleAction}},{key:"isButton",value:function(){return Eh.ActionStyle.BUTTON===this.actionStyle}},{key:"addChildActions",value:function(e){var t=this.childActions.slice();et.pushAll(t,et.ensure(e)),this.setChildActions(t)}},{key:"setChildActions",value:function(e){this.setProperty("childActions",e)}},{key:"_setChildActions",value:function(e){this.childActions.forEach((function(e){e.parentMenu=null})),this._setProperty("childActions",e),this.childActions.forEach(function(e){e.parentMenu=this}.bind(this)),this.initialized&&this.recomputeEnabled()}},{key:"_setInheritAccessibility",value:function(e){this._setProperty("inheritAccessibility",e),this.initialized&&this._findRootMenu().recomputeEnabled()}},{key:"_setEnabled",value:function(e){this._setProperty("enabled",e),this.initialized&&this._findRootMenu().recomputeEnabled()}},{key:"_setVisible",value:function(e){this._setProperty("visible",e),this.initialized&&this._findRootMenu().recomputeEnabled()}},{key:"setSelected",value:function(e){e!==this.selected&&(Sb(Pb(o.prototype),"setSelected",this).call(this,e),(this._doActionTogglesSubMenu()||this._doActionTogglesPopup())&&this.overflowMenu&&!this.overflowMenu.selected&&this._handleSelectedInEllipsis())}},{key:"_handleSelectedInEllipsis",value:function(){this.selected&&this.overflowMenu.setSelected(!0)}},{key:"setStackable",value:function(e){this.setProperty("stackable",e)}},{key:"setShrinkable",value:function(e){this.setProperty("shrinkable",e)}},{key:"_setOverflown",value:function(e){this.overflown!==e&&(this._setProperty("overflown",e),this.rendered&&this._renderOverflown())}},{key:"_renderOverflown",value:function(){this.$container.toggleClass("overflown",this.overflown),this._renderActionStyle()}},{key:"setMenuStyle",value:function(e){this.setProperty("menuStyle",e)}},{key:"_renderMenuStyle",value:function(){this.$container.toggleClass("default-menu",this.menuStyle===o.MenuStyle.DEFAULT)}},{key:"setDefaultMenu",value:function(e){this.setProperty("defaultMenu",e)}},{key:"setMenuFilter",value:function(e){this.setProperty("menuFilter",e),this.childActions.forEach((function(t){t.setMenuFilter(e)}))}},{key:"clone",value:function(e,t){var n=Sb(Pb(o.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,"childActions",t),n._setChildActions(n.childActions),n}},{key:"focus",value:function(){var e=new Kt({source:this});return this.trigger("focus",e),!e.defaultPrevented&&Sb(Pb(o.prototype),"focus",this).call(this)}}])&&kb(t.prototype,n),i&&kb(t,i),o}(Eh);function Eb(e){return(Eb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Db(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fb(e,t,n){return(Fb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mb(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ab(e,t){return(Ab=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Mb(e);if(t){var r=Mb(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jb(this,n)}}function jb(e,t){return!t||"object"!==Eb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mb(e){return(Mb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Rb(xb,"SUBMENU_ICON",sn.ANGLE_DOWN_BOLD),Rb(xb,"MenuStyle",{NONE:0,DEFAULT:1}),Rb(xb,"SubMenuVisibility",{DEFAULT:"default",TEXT_OR_ICON:"textOrIcon",ALWAYS:"always"});var Ib=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ab(e,t)}(o,e);var t,n,i,r=$b(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).hidden=!0,e.ellipsis=!0,e.stackable=!1,e.horizontalAlignment=1,e.iconId=sn.ELLIPSIS_V,e.tabbable=!1,e.rightAligned=!1,e._addPreserveOnPropertyChangeProperties(["childActions"]),e}return t=o,(n=[{key:"_render",value:function(){Fb(Mb(o.prototype),"_render",this).call(this),this.$container.addClass("ellipsis")}},{key:"setChildActions",value:function(e){Fb(Mb(o.prototype),"setChildActions",this).call(this,e),e&&e.forEach((function(e){e.setSelected(!1)}))}},{key:"_renderProperties",value:function(){Fb(Mb(o.prototype),"_renderProperties",this).call(this),this._renderHidden()}},{key:"setHidden",value:function(e){this.setProperty("hidden",e)}},{key:"_renderHidden",value:function(){this.$container.setVisible(!this.hidden)}},{key:"isTabTarget",value:function(){return Fb(Mb(o.prototype),"isTabTarget",this).call(this)&&!this.hidden}}])&&Db(t.prototype,n),i&&Db(t,i),o}(xb);function Lb(e){return(Lb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bb(e,t){return(Bb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Vb(e);if(t){var r=Vb(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Hb(this,n)}}function Hb(e,t){return!t||"object"!==Lb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vb(e){return(Vb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bb(e,t)}(n,e);var t=Nb(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Lh);function zb(e){return(zb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ub(e,t,n){return(Ub="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xb(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Kb(e,t){return(Kb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Xb(e);if(t){var r=Xb(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Yb(this,n)}}function Yb(e,t){return!t||"object"!==zb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xb(e){return(Xb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kb(e,t)}(o,e);var t,n,i,r=qb(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"_isEnabled",value:function(){return!this.field.excludedByFilter&&Ub(Xb(o.prototype),"_isEnabled",this).call(this)}}])&&Gb(t.prototype,n),i&&Gb(t,i),o}(Uh);function Zb(e){return(Zb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eg(e,t){return(eg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=rg(e);if(t){var r=rg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ng(this,n)}}function ng(e,t){return!t||"object"!==Zb(t)&&"function"!=typeof t?ig(e):t}function ig(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rg(e){return(rg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var og=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eg(e,t)}(o,e);var t,n,i,r=tg(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.SPACE,pu.ENTER],t.stopPropagation=!0,t.renderingHints.offset=16,t.renderingHints.$drawingArea=function(e,t){return this.field.$container}.bind(ig(t)),t}return t=o,(n=[{key:"handle",value:function(e){this.field.doAction()}}])&&Qb(t.prototype,n),i&&Qb(t,i),o}($u);function sg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ag=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=t,this.objectType=n,this.emptySpaceTypes=["EmptySpace"],this.selectionTypes=["SingleSelection","MultiSelection"]}var t,n,i;return t=e,(n=[{key:"order",value:function(e){var t=[],n=[],i=[],r=[],o=!1,s=!1;return e.forEach((function(e){e.createdBy!==this&&(e.isButton()?t.push(e):1===e.horizontalAlignment?r.push(e):mb.checkType(e,this._menuTypes(this.emptySpaceTypes))?(e.visible&&(o=!0),n.push(e)):mb.checkType(e,this._menuTypes(this.selectionTypes))&&(e.visible&&(s=!0),i.push(e)))}),this),o&&s&&n.push(this._createSeparator()),{left:t.concat(n,i),right:r,all:t.concat(n,i).concat(r)}}},{key:"_menuTypes",value:function(e){var t,n=[];for(e=e||[],t=0;t<e.length;t++)n.push(this.objectType+"."+e[t]);return n}},{key:"_createSeparator",value:function(){return O.create("Menu",{parent:this.menuBar,createdBy:this,separator:!0})}}])&&sg(t.prototype,n),i&&sg(t,i),e}();function ug(e){return(ug="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cg(e,t){return(cg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=dg(e);if(t){var r=dg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return hg(this,n)}}function hg(e,t){return!t||"object"!==ug(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dg(e){return(dg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cg(e,t)}(o,e);var t,n,i,r=fg(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menu-item combo-menu"),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.$container.unfocusable(),this.htmlComp=Uo.install(this.$container,this.session),this.childActions.forEach((function(e){e.addCssClass("combo-menu-child"),e.render()}))}},{key:"_togglesSubMenu",value:function(){return!1}}])&&lg(t.prototype,n),i&&lg(t,i),o}(xb);function yg(e){return(yg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vg(e,t){return(vg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mg(e);if(t){var r=mg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gg(this,n)}}function gg(e,t){return!t||"object"!==yg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mg(e){return(mg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vg(e,t)}(n,e);var t=bg(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Wb);function wg(e){return(wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Sg(e,t,n){return(Sg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pg(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Og(e,t){return(Og=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Pg(e);if(t){var r=Pg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Cg(this,n)}}function Cg(e,t){return!t||"object"!==wg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pg(e){return(Pg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Og(e,t)}(o,e);var t,n,i,r=Tg(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._headVisible=!1,e.menuItems=[],e.cloneMenuItems=!0,e._toggleSubMenuQueue=[],e.repositionEnabled=!0,e}return t=o,(n=[{key:"_init",value:function(e){e.focusableContainer=!0,!1===e.cloneMenuItems&&this._addWidgetProperties("menuItems"),Sg(Pg(o.prototype),"_init",this).call(this,e)}},{key:"_initKeyStrokeContext",value:function(){Sg(Pg(o.prototype),"_initKeyStrokeContext",this).call(this),Rm.registerKeyStrokes(this.keyStrokeContext,this,"menu-item")}},{key:"_createLayout",value:function(){return new Mg(this)}},{key:"_createBodyLayout",value:function(){return new ka({pixelBasedSizing:!1})}},{key:"_render",value:function(){Sg(Pg(o.prototype),"_render",this).call(this),this._installScrollbars(),this._renderMenuItems()}},{key:"_installScrollbars",value:function(e){Sg(Pg(o.prototype),"_installScrollbars",this).call(this,{axis:"y"})}},{key:"get$Scrollable",value:function(){return this.$body}},{key:"removeSubMenuItems",value:function(e,t){if(this.rendered||this.rendering)if(this.bodyAnimating)this._toggleSubMenuQueue.push(this.removeSubMenuItems.bind(this,e,t));else{this.$body=e.__originalParent.$subMenuBody,this.$body.insertBefore(e.$subMenuBody),e.__originalParent._doActionTogglesSubMenu&&e.__originalParent._doActionTogglesSubMenu();var n=this.htmlComp.offsetBounds().subtractFromDimension(this.htmlComp.insets());if(this.revalidateLayout(),this.position(),t){this.bodyAnimating=!0;var i=e.$placeHolder.position();e.$subMenuBody.css({width:"auto",height:"auto"});var r=this.htmlComp.offsetBounds().subtractFromDimension(this.htmlComp.insets());e.$subMenuBody.css("box-shadow","none"),this.htmlComp.setBounds(n),this.verticalAlignment!==kd.Alignment.TOP&&e.$subMenuBody.cssTop(),this._animateTopAndLeft(this.htmlComp.$comp,n,r,300),e.$subMenuBody.cssHeightAnimated(n.height,e.$container.cssHeight(),{duration:300,queue:!1});var o=i.top-this.$body.cssHeight(),s=0-n.height;e.$subMenuBody.cssTopAnimated(s,o,{duration:300,queue:!1,complete:function(){if(e.$container){wf.uninstall(e.$subMenuBody,this.session),e.$placeHolder.replaceWith(e.$container),e.$container.toggleClass("expanded",!1),this._updateFirstLastClass(),this.updateNextToSelected("menu-item",e.$container),e.$subMenuBody.detach(),this._installScrollbars(),this.$body.css("box-shadow",""),this.bodyAnimating=!1,this._invalidateLayoutTreeAndRepositionPopup();var t=this._toggleSubMenuQueue.shift();t&&t()}}.bind(this)}),this.$body.cssWidthAnimated(n.width,r.width,{duration:300,start:this.revalidateLayout.bind(this,!0),progress:this.revalidateLayout.bind(this,!1),queue:!1}),r.height!==n.height&&this.$body.cssHeightAnimated(n.height,r.height,{duration:300,queue:!1})}}}},{key:"renderSubMenuItems",value:function(e,t,n,i){if(this.session.desktop.rendered||i){if(this.rendered||this.rendering)if(this.bodyAnimating)this._toggleSubMenuQueue.push(this.renderSubMenuItems.bind(this,e,t,n,i));else{var r=this.htmlComp.offsetBounds().subtractFromDimension(this.htmlComp.insets());e.__originalParent.$subMenuBody=this.$body,this.$body.find(".menu-item").removeClass("next-to-selected"),e.$subMenuBody?this.$body=e.$subMenuBody:(this._$createBody(),e.$subMenuBody=this.$body,this._renderMenuItems(t,i));var o=e.$container.prev(),s=e.$container.position();if(e.$placeHolder=e.$container.clone(),Uo.install(e.$placeHolder,this.session),o.length?e.$placeHolder.insertAfter(o):e.__originalParent.$subMenuBody.prepend(e.$placeHolder),this.$body.insertAfter(e.__originalParent.$subMenuBody),this.$body.prepend(e.$container),e.$container.toggleClass("expanded"),this.revalidateLayout(),this.position(),this.updateNextToSelected(),n){this.bodyAnimating=!0,e.__originalParent.$subMenuBody.css({width:"auto",height:"auto"});var a=this.htmlComp.offsetBounds().subtractFromDimension(this.htmlComp.insets());this._animateTopAndLeft(this.htmlComp.$comp,r,a,300),this.$body.css("box-shadow","none"),this.$body.cssWidthAnimated(r.width,a.width,{duration:300,start:this.revalidateLayout.bind(this,!0),progress:this.revalidateLayout.bind(this,!1),queue:!1}),this.$body.cssHeightAnimated(e.$container.cssHeight(),a.height,{duration:300,queue:!1});var u=0-a.height,l=s.top-e.__originalParent.$subMenuBody.cssHeight();this.$body.cssTopAnimated(l,u,{duration:300,queue:!1,complete:function(){this.bodyAnimating=!1,e.__originalParent.$subMenuBody&&(wf.uninstall(e.__originalParent.$subMenuBody,this.session),e.__originalParent.$subMenuBody.detach(),this.$body.cssTop(0),this._installScrollbars(),this._updateFirstLastClass(),this.$body.css("box-shadow","")),this._invalidateLayoutTreeAndRepositionPopup();var t=this._toggleSubMenuQueue.shift();t&&t()}.bind(this)}),r.height!==a.height&&(e.__originalParent.$subMenuBody.cssHeightAnimated(r.height,a.height,{duration:300,queue:!1}),this.$container.cssHeight(r.height,a.height,{duration:300,queue:!1})),this.verticalAlignment===kd.Alignment.TOP&&(this.$container.cssTopAnimated(r.y,a.y,{duration:300,queue:!1}).css("overflow","visible"),this.$head.cssTopAnimated(r.height,a.height,{duration:300,queue:!1}),this.$deco.cssTopAnimated(r.height-1,a.height-1,{duration:300,queue:!1}))}else i||wf.uninstall(e.__originalParent.$subMenuBody,this.session),e.__originalParent.$subMenuBody.detach(),this._installScrollbars(),this._updateFirstLastClass()}}else this.initialSubMenusToRender={parentMenu:e,menus:t}}},{key:"_animateTopAndLeft",value:function(e,t,n,i){var r={duration:i,queue:!1};e.cssTopAnimated(t.y,n.y,r).cssLeftAnimated(t.x,n.x,r)}},{key:"revalidateLayout",value:function(e){this.repositionEnabled=scout.nvl(e,!0),Sg(Pg(o.prototype),"revalidateLayout",this).call(this),this.repositionEnabled=!0}},{key:"_renderMenuItems",value:function(e,t){e=e||this._getMenuItems(),this.menuFilter&&(e=this.menuFilter(e,_b.CONTEXT_MENU)),e&&0!==e.length&&(e.forEach((function(e){if(!e.separator){var t=e.parent;this.cloneMenuItems&&!e.cloneOf&&((e=e.clone({parent:this},{delegateEventsToOriginal:["acceptInput","action","click"],delegateAllPropertiesToClone:!0,delegateAllPropertiesToOriginal:!0,excludePropertiesToOriginal:["selected","logicalGrid","tabbable"]})).setTabbable(!1),this._attachCloneMenuListeners(e)),e.__originalParent||(e.__originalParent=t),e.render(this.$body),this._attachMenuListeners(e),e.icon&&e.icon.on("load error",this._invalidateLayoutTreeAndRepositionPopup.bind(this))}}),this),this._handleInitialSubMenus(t),this._updateFirstLastClass())}},{key:"_attachCloneMenuListeners",value:function(e){e.on("propertyChange",this._onCloneMenuPropertyChange.bind(this)),e.childActions.forEach(this._attachCloneMenuListeners.bind(this))}},{key:"_onCloneMenuPropertyChange",value:function(e){"selected"===e.propertyName&&e.source.cloneOf.triggerPropertyChange("selected",e.oldValue,e.newValue)}},{key:"_handleInitialSubMenus",value:function(e){if(!e)for(var t;this.initialSubMenusToRender;)t=this.initialSubMenusToRender,this.initialSubMenusToRender=void 0,this.renderSubMenuItems(t.parentMenu,t.menus,!1,!0)}},{key:"_attachMenuListeners",value:function(e){var t=this._onMenuItemAction.bind(this),n=this._onMenuItemPropertyChange.bind(this);e.on("action",t),e.on("propertyChange",n),this.one("remove",(function(){e.off("action",t),e.off("propertyChange",n)}))}},{key:"_modifyBody",value:function(){this.$body.addClass("context-menu")}},{key:"updateMenuItems",value:function(e){e=et.ensure(e),et.equals(this.menuItems,e)||this.close()}},{key:"_getMenuItems",value:function(){return this.menuItems}},{key:"$menuItems",value:function(){return this.$body.children(".menu-item")}},{key:"$visibleMenuItems",value:function(){return this.$body.children(".menu-item:visible")}},{key:"_updateFirstLastClass",value:function(e){var t,n;this.$body.children(".menu-item").each((function(){var e=s()(this);e.removeClass("context-menu-item-first context-menu-item-last"),e.isVisible()&&(t||(t=e),n=e)})),t&&t.addClass("context-menu-item-first"),n&&n.addClass("context-menu-item-last")}},{key:"updateNextToSelected",value:function(e,t){e=e||"menu-item";var n=this.$body.find("."+e);t=t||this.$body.find("."+e+".selected"),n.removeClass("next-to-selected"),t.hasClass("selected")&&t.nextAll(":visible").first().addClass("next-to-selected")}},{key:"_onMenuItemAction",value:function(e){e.source.isToggleAction()||this.close()}},{key:"_onMenuItemPropertyChange",value:function(e){this.rendered&&("visible"===e.propertyName?this._updateFirstLastClass():"selected"===e.propertyName&&this._deselectSiblings(e.source),this.position())}},{key:"_deselectSiblings",value:function(e){e.$container.siblings(".menu-item").each((function(e,t){s()(t).select(!1)}),this)}},{key:"_invalidateLayoutTreeAndRepositionPopup",value:function(){this.invalidateLayoutTree(),this.session.layoutValidator.schedulePostValidateFunction(function(){this.rendered&&this.position()}.bind(this))}}])&&kg(t.prototype,n),i&&kg(t,i),o}(op);function xg(e){return(xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Eg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Dg(e,t,n){return(Dg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jg(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Fg(e,t){return(Fg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ag(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=jg(e);if(t){var r=jg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $g(this,n)}}function $g(e,t){return!t||"object"!==xg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jg(e){return(jg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fg(e,t)}(o,e);var t,n,i,r=Ag(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"layout",value:function(e){var t=this.popup.$visibleMenuItems();this._adjustTextAlignment(t),this._resetMaxWidthFor(t),Dg(jg(o.prototype),"layout",this).call(this,e),this._setMaxWidthFor(t)}},{key:"_adjustTextAlignment",value:function(e){var t=0;e.each((function(e,n){var i=s()(n).children(".icon"),r=0;i.length>0&&(r=i.outerWidth(!0)),t=Math.max(t,r)})),e.each((function(e,n){var i=s()(n),r=i.children(".icon"),o=i.children(".text"),a=0;r.length>0&&(a=r.outerWidth(!0)),o.css("padding-left",t-a);var u=Uo.optGet(i);u&&u.invalidateLayout()}))}},{key:"_resetMaxWidthFor",value:function(e){e.each((function(e,t){var n=s()(t).data("widget");n&&n.$text&&n.$text.css("max-width","")}))}},{key:"_setMaxWidthFor",value:function(e){e.each(function(e,t){var n=s()(t).data("widget");if(n&&n.$text){var i=this._calcTextMaxWidth(n);n.$text.cssPxValue("max-width",i)}}.bind(this))}},{key:"_calcTextMaxWidth",value:function(e){var t=e.$container.width(),n=e.get$Icon(),i=e.$text,r=e.$submenuIcon,o=t+1;return i&&i.isVisible()&&(o-=i.cssMarginX()),n&&n.isVisible()&&(o-=n.outerWidth(!0)),r&&r.isVisible()&&(o-=r.outerWidth(!0)),o}}])&&Eg(t.prototype,n),i&&Eg(t,i),o}(dp);function Ig(e){return(Ig="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bg(e,t,n){return(Bg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Wg(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ng(e,t){return(Ng=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Wg(e);if(t){var r=Wg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Vg(this,n)}}function Vg(e,t){return!t||"object"!==Ig(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wg(e){return(Wg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ng(e,t)}(o,e);var t,n,i,r=Hg(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t}return t=o,(n=[{key:"_accept",value:function(e){var t=Bg(Wg(o.prototype),"_accept",this).call(this,e);return!(!t||this.field.bodyAnimating)&&t}},{key:"_changeSelection",value:function(e,t){0!==t.length&&(t.select(!0).focus(),this.field.updateNextToSelected&&this.field.updateNextToSelected(this._menuItemClass,t),e.length>0&&e.select(!1))}}])&&Lg(t.prototype,n),i&&Lg(t,i),o}($u);function Gg(e){return(Gg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ug(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Kg(e,t){return(Kg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Xg(e);if(t){var r=Xg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Yg(this,n)}}function Yg(e,t){return!t||"object"!==Gg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xg(e){return(Xg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kg(e,t)}(o,e);var t,n,i,r=qg(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e))._menuItemClass=t,n.stopImmediatePropagation=!0,n.which=[pu.ENTER,pu.SPACE],n.renderingHints.render=!1,n}return t=o,(n=[{key:"handle",value:function(e){var t=Rm._findMenuItems(this.field,this._menuItemClass).$selected;t.length>0&&t.data("widget").doAction()}}])&&Ug(t.prototype,n),i&&Ug(t,i),o}(zg);function Zg(e){return(Zg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function em(e,t,n){return(em="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rm(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function tm(e,t){return(tm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=rm(e);if(t){var r=rm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return im(this,n)}}function im(e,t){return!t||"object"!==Zg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rm(e){return(rm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var om=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tm(e,t)}(o,e);var t,n,i,r=nm(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t))._menuItemClass=t,n.which=[pu[1],pu[2],pu[3],pu[4],pu[5],pu[6],pu[7],pu[8],pu[9]],n.renderingHints.render=!0,n.renderingHints.hAlign=Ni.RIGHT,n.renderingHints.$drawingArea=function(e,t){return t.$menuItem},n}return t=o,(n=[{key:"_accept",value:function(e){if(!em(rm(o.prototype),"_accept",this).call(this,e))return!1;var t=Rm._findMenuItems(this.field,this._menuItemClass),n=pu.codesToKeys[e.which];return e.$menuItem=t.$allVisible.eq(n-1),e.$menuItem.length>0}},{key:"handle",value:function(e){e.$menuItem.data("widget").doAction()}}])&&Qg(t.prototype,n),i&&Qg(t,i),o}(Jg);function sm(e){return(sm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function am(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function um(e,t){return(um=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=fm(e);if(t){var r=fm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cm(this,n)}}function cm(e,t){return!t||"object"!==sm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fm(e){return(fm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&um(e,t)}(o,e);var t,n,i,r=lm(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e))._menuItemClass=t,n.which=[pu.DOWN],n.renderingHints.render=!1,n}return t=o,(n=[{key:"handle",value:function(e){var t=Rm._findMenuItems(this.field,this._menuItemClass);t.$selected.length>0?this._changeSelection(t.$selected,t.$selected.nextAll(":visible").first()):this._changeSelection(t.$selected,t.$allVisible.first())}}])&&am(t.prototype,n),i&&am(t,i),o}(zg);function dm(e){return(dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ym(e,t){return(ym=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=gm(e);if(t){var r=gm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bm(this,n)}}function bm(e,t){return!t||"object"!==dm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gm(e){return(gm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ym(e,t)}(o,e);var t,n,i,r=vm(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e))._menuItemClass=t,n.which=[pu.UP],n.renderingHints.render=!1,n}return t=o,(n=[{key:"handle",value:function(e){var t=Rm._findMenuItems(this.field,this._menuItemClass);t.$selected.length>0?this._changeSelection(t.$selected,t.$selected.prevAll(":visible").first()):this._changeSelection(t.$selected,t.$allVisible.last())}}])&&pm(t.prototype,n),i&&pm(t,i),o}(zg);function _m(e){return(_m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function km(e,t,n){return(km="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Cm(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Sm(e,t){return(Sm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Om(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Cm(e);if(t){var r=Cm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Tm(this,n)}}function Tm(e,t){return!t||"object"!==_m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cm(e){return(Cm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sm(e,t)}(o,e);var t,n,i,r=Om(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t))._menuItemClass=t,n.which=[pu.BACKSPACE],n.renderingHints.render=!0,n.renderingHints.$drawingArea=function(e,t){return t.$menuItem},n}return t=o,(n=[{key:"_accept",value:function(e){if(!km(Cm(o.prototype),"_accept",this).call(this,e))return!1;var t=Rm._findMenuItems(this.field,this._menuItemClass+".expanded");return t.$all.length>0&&(e.$menuItem=t.$all,!0)}},{key:"handle",value:function(e){e.$menuItem.data("widget").doAction()}}])&&wm(t.prototype,n),i&&wm(t,i),o}(Jg);var Rm={registerKeyStrokes:function(e,t,n){e.registerKeyStroke([new mm(t,n),new hm(t,n),new Jg(t,n),new om(t,n),new Pm(t,n)])},_findMenuItems:function(e,t){return{$all:e.$body.find("."+t),$allVisible:e.$body.find("."+t+":visible"),$selected:e.$body.find("."+t+".selected")}}};function xm(e){return(xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Em(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Dm(e,t,n){return(Dm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mm(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Fm(e,t){return(Fm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Am(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Mm(e);if(t){var r=Mm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $m(this,n)}}function $m(e,t){return!t||"object"!==xm(t)&&"function"!=typeof t?jm(e):t}function jm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mm(e){return(Mm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Im=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fm(e,t)}(o,e);var t,n,i,r=Am(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._removeWidgetProperties("childActions"),e._buttonPropertyChangeHandler=e._onButtonPropertyChange.bind(jm(e)),e._buttonDestroyHandler=e._onButtonDestroy.bind(jm(e)),e._addCloneProperties(["button"]),e.button=null,e.menubar=null,e}return t=o,i=[{key:"adaptButtonProperties",value:function(e,t){for(var n in t=t||{},["visible","selected","tooltipText","keyStroke","keyStrokes","cssClass","modelClass","classId","iconId","preventDoubleClick","enabled","inheritAccessibility","stackable","shrinkable"].forEach((function(n){t[n]=e[n]})),t.text=e.label,t.horizontalAlignment=e.gridData?e.gridData.horizontalAlignment:void 0,t.actionStyle=function(e){if(void 0!==e)return e===WG.DisplayStyle.LINK?Eh.ActionStyle.DEFAULT:Eh.ActionStyle.BUTTON}(e.displayStyle),t.toggleAction=e.displayStyle===WG.DisplayStyle.TOGGLE,t.childActions=e.menus,void 0===t.defaultMenu&&(t.defaultMenu=e.defaultButton),t)void 0===t[n]&&delete t[n];return t}}],(n=[{key:"_init",value:function(e){if(Dm(Mm(o.prototype),"_init",this).call(this,e),!this.button)throw new Error("Cannot adapt to undefined button");this.button.adaptedBy=this,this._installListeners()}},{key:"_destroy",value:function(){Dm(Mm(o.prototype),"_destroy",this).call(this),delete this.button.adaptedBy}},{key:"_installListeners",value:function(){this.button.on("propertyChange",this._buttonPropertyChangeHandler),this.button.on("destroy",this._buttonDestroyHandler)}},{key:"_uninstallListeners",value:function(){this.button.off("propertyChange",this._buttonPropertyChangeHandler),this.button.off("destroy",this._buttonDestroyHandler)}},{key:"_render",value:function(){Dm(Mm(o.prototype),"_render",this).call(this),this.$container.attr("data-buttonadapter",this.button.id)}},{key:"_onButtonPropertyChange",value:function(e){var t={};for(var n in t[e.propertyName]=e.newValue,t=o.adaptButtonProperties(t))this.setProperty(n,t[n])}},{key:"_onButtonDestroy",value:function(e){this.destroy(),this._uninstallListeners()}},{key:"doAction",value:function(){if(this.childActions.length>0)return Dm(Mm(o.prototype),"doAction",this).call(this);var e=this.button.doAction();return e&&(this.isToggleAction()&&this.setSelected(!this.selected),this._doAction()),e}},{key:"focus",value:function(){return this.rendered?(this.menubar.setTabbableMenu(this),this.session.focusManager.requestFocus(this.getFocusableElement())):(this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1)}}])&&Em(t.prototype,n),i&&Em(t,i),o}(xb);function Lm(e){return(Lm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nm(e,t,n){return(Nm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zm(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Hm(e,t){return(Hm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zm(e);if(t){var r=zm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Wm(this,n)}}function Wm(e,t){return!t||"object"!==Lm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zm(e){return(zm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hm(e,t)}(o,e);var t,n,i,r=Vm(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties("field"),e}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menu-item"),this.$container.addClass("form-field-menu"),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new ua({stretch:!1}))}},{key:"_renderProperties",value:function(){Nm(zm(o.prototype),"_renderProperties",this).call(this),this._renderField()}},{key:"_renderText",value:function(e){Nm(zm(o.prototype),"_renderText",this).call(this,e),this.field&&this.field.rendered&&this.$text&&this.field.$container.insertAfter(this.$text)}},{key:"setField",value:function(e){this.setProperty("field",e)}},{key:"_renderField",value:function(){if(this.field){this.field.gridData=kV.createFromHints(this.field,1),this.field.render(this.$container);var e=new ts(this.field);e.validate(),this.field.setLayoutData(e),this.field.$container.addClass("content")}}},{key:"_removeField",value:function(){this.field&&this.field.remove()}},{key:"clone",value:function(e,t){var n=Nm(zm(o.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,["field"],t),n}},{key:"isTabTarget",value:function(){return!1}},{key:"_renderOverflown",value:function(){Nm(zm(o.prototype),"_renderOverflown",this).call(this),this.field._hideStatusMessage()}}])&&Bm(t.prototype,n),i&&Bm(t,i),o}(xb);function Um(e){return(Um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Km(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qm(e,t,n){return(qm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zm(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ym(e,t){return(Ym=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Zm(e);if(t){var r=Zm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Jm(this,n)}}function Jm(e,t){return!t||"object"!==Um(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zm(e){return(Zm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ym(e,t)}(o,e);var t,n,i,r=Xm(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_postCreateWidget",value:function(){qm(Zm(o.prototype),"_postCreateWidget",this).call(this),this.widget.field&&(this.widget.field.gridDataHints=new kV(this.widget.field.gridData))}}])&&Km(t.prototype,n),i&&Km(t,i),o}(Wb);function e_(e){return(e_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n_(e,t,n){return(n_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s_(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function i_(e,t){return(i_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=s_(e);if(t){var r=s_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return o_(this,n)}}function o_(e,t){return!t||"object"!==e_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s_(e){return(s_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var a_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i_(e,t)}(o,e);var t,n,i,r=r_(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).compact=!1,t.menus=[],t._addWidgetProperties("menus"),t}return t=o,(n=[{key:"_init",value:function(e){n_(s_(o.prototype),"_init",this).call(this,e),this.menus=e.menus||[],this.uiMenuCssClass=e.uiMenuCssClass||"",this.uiMenuCssClass+=" menu-box-item",this._initMenus(this.menus)}},{key:"_initMenus",value:function(e){e.forEach(this._initMenu.bind(this))}},{key:"_initMenu",value:function(e){e.uiCssClass=this.uiMenuCssClass}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menu-box"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new p_(this))}},{key:"_renderProperties",value:function(){n_(s_(o.prototype),"_renderProperties",this).call(this),this._renderMenus(),this._renderCompact()}},{key:"setMenus",value:function(e){this.setProperty("menus",e)}},{key:"_renderMenus",value:function(){this.menus.forEach((function(e){e.render()}),this),this.invalidateLayoutTree()}},{key:"_removeMenus",value:function(){this.menus.forEach((function(e){e.remove()})),this.invalidateLayoutTree()}},{key:"setCompact",value:function(e){this.setProperty("compact",e)}},{key:"_renderCompact",value:function(){this.$container.toggleClass("compact",this.compact),this.invalidateLayoutTree()}}])&&t_(t.prototype,n),i&&t_(t,i),o}(de);function u_(e){return(u_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c_(e,t){return(c_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d_(e);if(t){var r=d_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h_(this,n)}}function h_(e,t){return!t||"object"!==u_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d_(e){return(d_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c_(e,t)}(o,e);var t,n,i,r=f_(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).menuBox=e,t.firstMenu=null,t.lastMenu=null,t}return t=o,(n=[{key:"layout",value:function(e){var t=this.menuBox.htmlComp.size(),n=this.visibleMenus(),i=0;this.menuBox.session.layoutValidator.schedulePostValidateFunction((function(){n.forEach((function(e){e.popup&&e.popup.position()}))})),this.updateFirstAndLastMenuMarker(n),this.undoCollapse(n),this.undoCompact(n),this.undoShrink(n),(i=this.actualPrefSize(n).width)<=t.width||(this.compact(n),(i=this.actualPrefSize(n).width)<=t.width||(this.shrink(n),(i=this.actualPrefSize(n).width)<=t.width||this.collapse(n,t,i)))}},{key:"preferredLayoutSize",value:function(e){var t=this.visibleMenus();return this.updateFirstAndLastMenuMarker(t),this.undoCollapse(t),this.undoCompact(t),this.undoShrink(t),this.actualPrefSize()}},{key:"compact",value:function(e){void 0===this.menuBox.compactOrig&&(this.menuBox.compactOrig=this.menuBox.compact,this.menuBox.htmlComp.suppressInvalidate=!0,this.menuBox.setCompact(!0),this.menuBox.htmlComp.suppressInvalidate=!1),this.compactMenus(e)}},{key:"undoCompact",value:function(e){void 0!==this.menuBox.compactOrig&&(this.menuBox.htmlComp.suppressInvalidate=!0,this.menuBox.setCompact(this.menuBox.compactOrig),this.menuBox.htmlComp.suppressInvalidate=!1,this.menuBox.compactOrig=void 0),this.undoCompactMenus(e)}},{key:"compactMenus",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){void 0===e.compactOrig&&(e.compactOrig=e.compact,e.htmlComp.suppressInvalidate=!0,e.setCompact(!0),e.htmlComp.suppressInvalidate=!1)}),this),this._ellipsis&&this._ellipsis.setCompact(!0)}},{key:"undoCompactMenus",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){void 0!==e.compactOrig&&(e.htmlComp.suppressInvalidate=!0,e.setCompact(e.compactOrig),e.htmlComp.suppressInvalidate=!1,e.compactOrig=void 0)}),this),this._ellipsis&&this._ellipsis.setCompact(!1)}},{key:"shrink",value:function(e){this.shrinkMenus(e)}},{key:"shrinkMenus",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){void 0===e.textVisibleOrig&&e.iconId&&(e.textVisibleOrig=e.textVisible,e.htmlComp.suppressInvalidate=!0,e.setTextVisible(!1),e.htmlComp.suppressInvalidate=!1)}),this)}},{key:"undoShrink",value:function(e){this.undoShrinkMenus(e)}},{key:"undoShrinkMenus",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){void 0!==e.textVisibleOrig&&(e.htmlComp.suppressInvalidate=!0,e.setTextVisible(e.textVisibleOrig),e.htmlComp.suppressInvalidate=!1,e.textVisibleOrig=void 0)}),this)}},{key:"collapse",value:function(e,t,n){this._createAndRenderEllipsis(this.menuBox.$container);var i=this._moveOverflowMenusIntoEllipsis(t,n);this.updateFirstAndLastMenuMarker(i)}},{key:"undoCollapse",value:function(e){e=e||this.visibleMenus(),this._destroyEllipsis(),this._removeMenusFromEllipsis(e)}},{key:"_createAndRenderEllipsis",value:function(e){var t=mb.createEllipsisMenu({parent:this.menuBox,horizontalAlignment:1,compact:this.menuBox.compact});t.uiCssClass=this.menuBox.uiMenuCssClass,t.render(e),this._ellipsis=t}},{key:"_destroyEllipsis",value:function(){this._ellipsis&&(this._ellipsis.destroy(),this._ellipsis=null)}},{key:"_moveOverflowMenusIntoEllipsis",value:function(e,t){var n=[this._ellipsis],i=No.size(this._ellipsis.$container,!0);return t+=i.width,this.visibleMenus().slice().reverse().forEach((function(i){var r;t>e.width?(r=No.size(i.$container,!0),t-=r.width,mb.moveMenuIntoEllipsis(i,this._ellipsis)):n.unshift(i)}),this),n}},{key:"_removeMenusFromEllipsis",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){mb.removeMenuFromEllipsis(e,this.menuBox.$container)}),this)}},{key:"actualPrefSize",value:function(e){var t,n;return e=e||this.visibleMenus(),t=this._menusWidth(e),(n=No.prefSize(this.menuBox.$container,{includeMargin:!0,useCssSize:!0})).width=t+this.menuBox.htmlComp.insets().horizontal(),n}},{key:"_menusWidth",value:function(e){var t=0;return(e=e||this.visibleMenus()).forEach((function(e){e.rendered&&(t+=e.$container.outerWidth(!0))}),this),this._ellipsis&&(t+=this._ellipsis.$container.outerWidth(!0)),t}},{key:"compactPrefSize",value:function(e){return e=e||this.visibleMenus(),this.updateFirstAndLastMenuMarker(e),this.undoCollapse(e),this.undoShrink(e),this.compact(e),this.actualPrefSize()}},{key:"shrinkPrefSize",value:function(e){return e=e||this.visibleMenus(),this.updateFirstAndLastMenuMarker(e),this.undoCollapse(e),this.compact(e),this.shrink(e),this.actualPrefSize()}},{key:"visibleMenus",value:function(){return this.menuBox.menus.filter((function(e){return e.visible}),this)}},{key:"updateFirstAndLastMenuMarker",value:function(e){var t=null,n=null;(e||[]).forEach((function(e){e.rendered&&(t||(t=e),n=e)})),t===this.firstMenu&&n===this.lastMenu||(this.firstMenu&&this.firstMenu.rendered&&this.firstMenu.$container.removeClass("first"),this.lastMenu&&this.lastMenu.rendered&&this.lastMenu.$container.removeClass("last"),this.firstMenu=t,this.lastMenu=n,this.firstMenu&&this.firstMenu.$container.addClass("first"),this.lastMenu&&this.lastMenu.$container.addClass("last"))}}])&&l_(t.prototype,n),i&&l_(t,i),o}(zo);function y_(e){return(y_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function b_(e,t,n){return(b_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k_(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function g_(e,t){return(g_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=k_(e);if(t){var r=k_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return __(this,n)}}function __(e,t){return!t||"object"!==y_(t)&&"function"!=typeof t?w_(e):t}function w_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k_(e){return(k_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g_(e,t)}(o,e);var t,n,i,r=m_(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).menuSorter=null,e.menuFilter=null,e.position=o.Position.TOP,e.tabbable=!0,e.menuboxLeft=null,e.menuboxRight=null,e.menuItems=[],e.orderedMenuItems={left:[],right:[],all:[]},e.defaultMenu=null,e.visible=!1,e.ellipsisPosition=o.EllipsisPosition.RIGHT,e._menuItemPropertyChangeHandler=e._onMenuItemPropertyChange.bind(w_(e)),e._focusHandler=e._onMenuItemFocus.bind(w_(e)),e.hiddenByUi=!1,e._addWidgetProperties("menuItems"),e}return t=o,(n=[{key:"_init",value:function(e){b_(k_(o.prototype),"_init",this).call(this,e),this.menuSorter=e.menuOrder||new xY,this.menuSorter.menuBar=this,e.menuFilter&&(this.menuFilter=function(t,n,i,r){return e.menuFilter(t,_b.MENU_BAR,i,r)}),this.menuboxLeft=O.create("MenubarBox",{parent:this,cssClass:"left",tooltipPosition:this._oppositePosition()}),this.menuboxRight=O.create("MenubarBox",{parent:this,cssClass:"right",tooltipPosition:this._oppositePosition()}),this._setMenuItems(et.ensure(this.menuItems)),this.updateVisibility()}},{key:"_destroy",value:function(){b_(k_(o.prototype),"_destroy",this).call(this),this._detachMenuHandlers()}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){b_(k_(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new L_(this),new G_(this)])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menubar"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new D_(this)),this.menuboxRight.render(this.$container),this.menuboxLeft.render(this.$container)}},{key:"_renderProperties",value:function(){b_(k_(o.prototype),"_renderProperties",this).call(this),this._renderMenuItems(),this._renderPosition()}},{key:"setPosition",value:function(e){this.setProperty("position",e)}},{key:"_setPosition",value:function(e){this._setProperty("position",e),this.menuboxLeft.setTooltipPosition(this._oppositePosition()),this.menuboxRight.setTooltipPosition(this._oppositePosition())}},{key:"_renderPosition",value:function(){this.$container.toggleClass("bottom",this.position===o.Position.BOTTOM)}},{key:"_oppositePosition",value:function(){return this.position===o.Position.TOP?o.Position.BOTTOM:o.Position.TOP}},{key:"setEllipsisPosition",value:function(e){this.setProperty("ellipsisPosition",e)}},{key:"_setChildMenuFilters",value:function(){this.orderedMenuItems.all.forEach((function(e){e.setMenuFilter(this.menuFilter)}),this)}},{key:"_attachMenuHandlers",value:function(){this.orderedMenuItems.all.forEach((function(e){0===e.events.count("propertyChange",this._menuItemPropertyChangeHandler)&&e.on("propertyChange",this._menuItemPropertyChangeHandler),0===e.events.count("focus",this._focusHandler)&&e.on("focus",this._focusHandler)}),this)}},{key:"_detachMenuHandlers",value:function(){this.orderedMenuItems.all.forEach(function(e){e.off("propertyChange",this._menuItemPropertyChangeHandler),e.off("focus",this._focusHandler)}.bind(this))}},{key:"setMenuItems",value:function(e){if(e=et.ensure(e),et.equals(this.menuItems,e))return this.menuboxRight.link(this.menuboxRight.menuItems),void this.menuboxLeft.link(this.menuboxLeft.menuItems);this.setProperty("menuItems",e)}},{key:"_setMenuItems",value:function(e,t){this._detachMenuHandlers(),this.orderedMenuItems=this._createOrderedMenus(e),t?(this.menuboxRight.setMenuItems(this.orderedMenuItems.right),this.menuboxLeft.setMenuItems(this.orderedMenuItems.left)):(this.menuboxLeft.setMenuItems(this.orderedMenuItems.left),this.menuboxRight.setMenuItems(this.orderedMenuItems.right)),this._setChildMenuFilters(),this._attachMenuHandlers(),this.updateVisibility(),this.updateDefaultMenu(),this._updateTabbableMenu(),this._setProperty("menuItems",e)}},{key:"_renderMenuItems",value:function(){this.updateLeftOfButtonMarker(),this.invalidateLayoutTree()}},{key:"_removeMenuItems",value:function(){}},{key:"_createOrderedMenus",value:function(e){var t,n=this.menuSorter.order(e,this),i=-1;if(n.right.forEach((function(e){e.rightAligned=!0})),n.all.length>0){if(this._ellipsis&&(this._ellipsis.setChildActions([]),this._ellipsis.destroy()),t=O.create("EllipsisMenu",{parent:this,cssClass:"overflow-menu-item"}),this._ellipsis=t,this.ellipsisPosition===o.EllipsisPosition.RIGHT){var r=this._getFirstStackableIndexPosition(n.right.slice().reverse());r>-1?(i=n.right.length-r,t.rightAligned=!0,n.right.splice(i,0,t)):(r=this._getFirstStackableIndexPosition(n.left.slice().reverse()))>-1&&(i=n.left.length-r,n.left.splice(i,0,t))}else(i=this._getFirstStackableIndexPosition(n.left))>-1?n.left.splice(i,0,t):(i=this._getFirstStackableIndexPosition(n.right))>-1&&(t.rightAligned=!0,n.right.splice(i,0,t));n.all=n.left.concat(n.right)}return n}},{key:"_getFirstStackableIndexPosition",value:function(e){var t=-1;return e.some((function(e,n){return!(!e.stackable||!e.visible||(t=n,0))}),this),t}},{key:"_updateTabbableMenu",value:function(){this.tabbable&&(this.defaultMenu&&this.defaultMenu.enabledComputed?this.setTabbableMenu(this.defaultMenu):this.setTabbableMenu(et.find(this.orderedMenuItems.all,(function(e){return e.isTabTarget()}))))}},{key:"setTabbableMenu",value:function(e){this.tabbable&&e!==this.tabbableMenu&&(this.tabbableMenu&&this.tabbableMenu.setTabbable(!1),this.tabbableMenu=e,e&&e.setTabbable(!0))}},{key:"setHiddenByUi",value:function(e){this.setProperty("hiddenByUi",e)}},{key:"updateVisibility",value:function(){mb.updateSeparatorVisibility(this.orderedMenuItems.left),mb.updateSeparatorVisibility(this.orderedMenuItems.right),this.setVisible(!this.hiddenByUi&&this.orderedMenuItems.all.some((function(e){return e.visible&&!e.ellipsis})))}},{key:"updateDefaultMenu",value:function(){var e,t,n=null;for(e=0;e<this.orderedMenuItems.all.length;e++)if((t=this.orderedMenuItems.all[e]).visible&&t.enabled&&!1!==t.defaultMenu){if(t.defaultMenu){n=t;break}!n&&this._isDefaultKeyStroke(t.actionKeyStroke)&&(n=t)}this.setDefaultMenu(n),n&&n.isTabTarget()&&this.setTabbableMenu(n)}},{key:"_isDefaultKeyStroke",value:function(e){return O.isOneOf(pu.ENTER,e.which)&&!e.ctrl&&!e.alt&&!e.shift}},{key:"setDefaultMenu",value:function(e){this.setProperty("defaultMenu",e)}},{key:"_setDefaultMenu",value:function(e){this.defaultMenu&&this.defaultMenu.setMenuStyle(xb.MenuStyle.NONE),e&&e.setMenuStyle(xb.MenuStyle.DEFAULT),this._setProperty("defaultMenu",e)}},{key:"updateLeftOfButtonMarker",value:function(){this._updateLeftOfButtonMarker(this.orderedMenuItems.left),this._updateLeftOfButtonMarker(this.orderedMenuItems.right)}},{key:"_updateLeftOfButtonMarker",value:function(e){var t;e=e.filter((function(e){return e.visible&&e.rendered}));for(var n=0;n<e.length;n++)(t=e[n]).$container.removeClass("left-of-button"),n>0&&t.isButton()&&e[n-1].$container.addClass("left-of-button")}},{key:"_onMenuItemPropertyChange",value:function(e){if("overflown"!==e.propertyName&&"enabled"!==e.propertyName&&"visible"!==e.propertyName&&"hidden"!==e.propertyName||this.tabbableMenu&&e.source!==this.tabbableMenu||this._updateTabbableMenu(),"overflown"!==e.propertyName&&"hidden"!==e.propertyName||this.defaultMenu&&e.source!==this.defaultMenu||this.updateDefaultMenu(),"horizontalAlignment"===e.propertyName&&this.reorderMenus(e.newValue<=0),"visible"===e.propertyName){var t=this.visible;this.updateVisibility(),!t&&this.visible&&this.revalidateLayout(),e.source.separator||this.reorderMenus()}"keyStroke"!==e.propertyName&&"enabled"!==e.propertyName&&"defaultMenu"!==e.propertyName&&"visible"!==e.propertyName||this.updateDefaultMenu()}},{key:"_onMenuItemFocus",value:function(e){this.setTabbableMenu(e.source)}},{key:"reorderMenus",value:function(e){var t=this.menuItems;this._setMenuItems(t,e),this.rendered&&this.updateLeftOfButtonMarker()}},{key:"_allMenusAsFlatList",value:function(){return et.flatMap(this.orderedMenuItems.all,(function(e){return e instanceof pg?e.childActions:[e]}))}}])&&v_(t.prototype,n),i&&v_(t,i),o}(de);function T_(e){return(T_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P_(e,t){return(P_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=E_(e);if(t){var r=E_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x_(this,n)}}function x_(e,t){return!t||"object"!==T_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E_(e){return(E_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}S_(O_,"EllipsisPosition",{LEFT:"left",RIGHT:"right"}),S_(O_,"Position",{TOP:"top",BOTTOM:"bottom"});var D_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P_(e,t)}(o,e);var t,n,i,r=R_(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this))._menuBar=e,t._overflowMenuItems=[],t._visibleMenuItems=[],t._ellipsis=null,t.collapsed=!1,t}return t=o,i=[{key:"size",value:function(e,t){var n=e.prefSize();return n.width=t.width,n=n.subtract(e.margins())}}],(n=[{key:"layout",value:function(e){var t,n=this._menuBar.orderedMenuItems.left.concat(this._menuBar.orderedMenuItems.right),i=Uo.get(e);this.undoShrink(n),t=et.find(n,(function(e){return e.ellipsis})),this.preferredLayoutSize(e,{widthHint:i.availableSize().width}),t&&this._overflowMenuItems.length>0&&t.setHidden(!1),this._visibleMenuItems.forEach((function(e){e._setOverflown(!1)}),this),this._overflowMenuItems.forEach((function(e){e._setOverflown(!0)})),t&&0===this._overflowMenuItems.length&&t.setHidden(!0),this._overflowMenuItems=this._overflowMenuItems.filter((function(e){return!e.separator})),t&&(t._closePopup(),t.setChildActions(this._overflowMenuItems)),this._visibleMenuItems.forEach((function(e){e.validateLayout()})),this._visibleMenuItems.forEach((function(e){e.popup&&e.popup.position()}))}},{key:"preferredLayoutSize",value:function(e,t){if(this._overflowMenuItems=[],!this._menuBar.isVisible())return new Co(0,0);var n=this._menuBar.orderedMenuItems.all.filter((function(e){return e.visible}),this),i=n.filter((function(e){var t=e.overflown;return e._setOverflown(!1),t})),r=[],o=Uo.get(e),s=new Co(0,0),a=Number.MAX_VALUE;if((0===t.widthHint||t.widthHint)&&(a=t.widthHint-o.insets().horizontal()),a<=0)return i.forEach((function(e){e._setOverflown(!0)})),this._minSize(n);(s=this._prefSize(n)).width>a&&this.shrink(n),n.forEach((function(e,t){e.stackable&&r.push(t)}));var u=-1;for(this._setFirstLastMenuMarker(n),s=this._prefSize(n);s.width>a&&r.length>0;)u=this._menuBar.ellipsisPosition===O_.EllipsisPosition.RIGHT?r.splice(-1)[0]:r.splice(0,1)[0]-this._overflowMenuItems.length,this._overflowMenuItems.splice(0,0,n[u]),n.splice(u,1),this._setFirstLastMenuMarker(n),s=this._prefSize(n);return i.forEach((function(e){e._setOverflown(!0)})),this._visibleMenuItems=n,s.add(o.insets())}},{key:"_minSize",value:function(e){var t=e.filter((function(e){return e.ellisis||!e.stackable}),this);return this._setFirstLastMenuMarker(t,!0),this._prefSize(t,!0)}},{key:"_prefSize",value:function(e,t){var n=new Co(0,0),i=new Co(0,0);return t=O.nvl(t,this._overflowMenuItems.length>0),e.forEach((function(e){i=new Co(0,0),e.ellipsis?t&&(i=this._menuItemSize(e)):i=this._menuItemSize(e),n.height=Math.max(n.height,i.height),n.width+=i.width}),this),n}},{key:"_menuItemSize",value:function(e){var t,n=e.$container.attr("class");return e.$container.removeClass("overflown"),e.$container.removeClass("hidden"),e.htmlComp.invalidateLayout(),t=e.htmlComp.prefSize({useCssSize:!0,exact:!0}).add(No.margins(e.$container)),e.$container.attrOrRemove("class",n),t}},{key:"_setFirstLastMenuMarker",value:function(e,t){var n=e;t=O.nvl(t,this._overflowMenuItems.length>0),this._menuBar.orderedMenuItems.all.forEach((function(e){e.$container.removeClass("first last")})),t||(n=n.filter((function(e){return!e.ellipsis}))),n.length>0&&(n[0].$container.addClass("first"),n[n.length-1].$container.addClass("last"))}},{key:"shrink",value:function(e){e.forEach((function(e){void 0===e.textVisibleOrig&&e.shrinkable&&e.icon&&(e.textVisibleOrig=e.textVisible,e.htmlComp.suppressInvalidate=!0,e.setTextVisible(!1),e.htmlComp.suppressInvalidate=!1)}),this)}},{key:"undoShrink",value:function(e){e.forEach((function(e){void 0!==e.textVisibleOrig&&(e.htmlComp.suppressInvalidate=!0,e.setTextVisible(e.textVisibleOrig),e.htmlComp.suppressInvalidate=!1,e.textVisibleOrig=void 0)}),this)}}])&&C_(t.prototype,n),i&&C_(t,i),o}(zo);function F_(e){return(F_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $_(e,t){return($_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=I_(e);if(t){var r=I_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return M_(this,n)}}function M_(e,t){return!t||"object"!==F_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I_(e){return(I_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$_(e,t)}(o,e);var t,n,i,r=j_(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.LEFT],t.renderingHints.render=!1,t.stopPropagation=!0,t.keyStrokeMode=$u.Mode.DOWN,t}return t=o,(n=[{key:"handle",value:function(e){var t,n,i,r=this.field._allMenusAsFlatList(),o=this.field.$container.find(":focus");for(t=0;t<r.length;t++){if(n=r[t],o[0]===n.$container[0]){i&&(this.field.setTabbableMenu(i),i.focus());break}n.isTabTarget()&&(i=n)}}}])&&A_(t.prototype,n),i&&A_(t,i),o}($u);function B_(e){return(B_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function H_(e,t){return(H_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=z_(e);if(t){var r=z_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return W_(this,n)}}function W_(e,t){return!t||"object"!==B_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z_(e){return(z_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H_(e,t)}(o,e);var t,n,i,r=V_(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.RIGHT],t.renderingHints.render=!1,t.stopPropagation=!0,t.keyStrokeMode=$u.Mode.DOWN,t}return t=o,(n=[{key:"handle",value:function(e){var t,n,i=this.field._allMenusAsFlatList(),r=this.field.$container.find(":focus"),o=!1;for(t=0;t<i.length;t++){if(n=i[t],o&&n.isTabTarget()){this.field.setTabbableMenu(n),n.focus();break}r[0]===n.$container[0]&&(o=!0)}}}])&&N_(t.prototype,n),i&&N_(t,i),o}($u);function U_(e){return(U_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function q_(e,t,n){return(q_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Q_(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Y_(e,t){return(Y_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Q_(e);if(t){var r=Q_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return J_(this,n)}}function J_(e,t){return!t||"object"!==U_(t)&&"function"!=typeof t?Z_(e):t}function Z_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q_(e){return(Q_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ew=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y_(e,t)}(o,e);var t,n,i,r=X_(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).menu=null,e.$headBlueprint=null,e.ignoreEvent=null,e._headVisible=!0,e.parentMenuPropertyChangeHandler=e._onParentMenuPropertyChange.bind(Z_(e)),e}return t=o,(n=[{key:"_init",value:function(e){e.$anchor=e.menu.$container,q_(Q_(o.prototype),"_init",this).call(this,e),this.$headBlueprint=this.menu.$container}},{key:"_getMenuItems",value:function(){return this.menu.childActions||this.menu.menus}},{key:"close",value:function(e){e&&this.ignoreEvent&&e.originalEvent===this.ignoreEvent.originalEvent||q_(Q_(o.prototype),"close",this).call(this,e)}},{key:"_render",value:function(){q_(Q_(o.prototype),"_render",this).call(this),this.menu.on("propertyChange",this.parentMenuPropertyChangeHandler)}},{key:"_remove",value:function(){this.menu.off("propertyChange",this.parentMenuPropertyChangeHandler),q_(Q_(o.prototype),"_remove",this).call(this)}},{key:"_renderHead",value:function(){q_(Q_(o.prototype),"_renderHead",this).call(this),this.menu.$container.parent().hasClass("main-menubar")&&this.$head.addClass("in-main-menubar"),this.menu.uiCssClass&&this._copyCssClassToHead(this.menu.uiCssClass),this._copyCssClassToHead("unfocusable"),this._copyCssClassToHead("button")}},{key:"_onParentMenuPropertyChange",value:function(e){this.session.layoutValidator.schedulePostValidateFunction(function(){this.rendered&&(this.rerenderHead(),this.position())}.bind(this))}}])&&K_(t.prototype,n),i&&K_(t,i),o}(Rg);function tw(e){return(tw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iw(e,t,n){return(iw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uw(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function rw(e,t){return(rw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ow(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=uw(e);if(t){var r=uw(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sw(this,n)}}function sw(e,t){return!t||"object"!==tw(t)&&"function"!=typeof t?aw(e):t}function aw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uw(e){return(uw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rw(e,t)}(o,e);var t,n,i,r=ow(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).menuItems=[],e.tooltipPosition=O_.Position.TOP,e._addWidgetProperties("menuItems"),e._menuItemPropertyChangeHandler=e._onMenuItemPropertyChange.bind(aw(e)),e}return t=o,(n=[{key:"_destroy",value:function(){iw(uw(o.prototype),"_destroy",this).call(this),this._removeMenuHandlers()}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menubox"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new vw(this))}},{key:"_renderProperties",value:function(){iw(uw(o.prototype),"_renderProperties",this).call(this),this._renderMenuItems()}},{key:"_remove",value:function(){this._removeMenuItems(),iw(uw(o.prototype),"_remove",this).call(this)}},{key:"setMenuItems",value:function(e){e=et.ensure(e),et.equals(this.menuItems,e)||this.setProperty("menuItems",e)}},{key:"_setMenuItems",value:function(e){this._removeMenuHandlers(),this._setProperty("menuItems",e),this._addMenuHandlers(),this._updateTooltipPosition()}},{key:"_removeMenuItems",value:function(){this._removeMenuHandlers(),this.menuItems.forEach((function(e){e.overflow=!1,e.remove()}))}},{key:"_renderMenuItems",value:function(){this.menuItems.forEach(function(e){e.render(this.$container),e.$container.addClass("menubar-item")}.bind(this)),this.rendering||this.invalidateLayoutTree()}},{key:"_addMenuHandlers",value:function(){this.menuItems.forEach((function(e){e.off("propertyChange",this._menuItemPropertyChangeHandler)}),this)}},{key:"_removeMenuHandlers",value:function(){this.menuItems.forEach((function(e){e.off("propertyChange",this._menuItemPropertyChangeHandler)}),this)}},{key:"_renderVisible",value:function(){iw(uw(o.prototype),"_renderVisible",this).call(this),this.revalidateLayout()}},{key:"_onMenuItemPropertyChange",value:function(e){"visible"===e.propertyName&&this.setVisible(this.menuItems.some((function(e){return e.visible&&!e.ellipsis})))}},{key:"setTooltipPosition",value:function(e){this.setProperty("tooltipPosition",e)}},{key:"_setTooltipPosition",value:function(e){this._setProperty("tooltipPosition",e),this._updateTooltipPosition()}},{key:"_updateTooltipPosition",value:function(){this.menuItems.forEach((function(e){e.setTooltipPosition(this.tooltipPosition)}),this)}}])&&nw(t.prototype,n),i&&nw(t,i),o}(de);function cw(e){return(cw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hw(e,t){return(hw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=yw(e);if(t){var r=yw(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pw(this,n)}}function pw(e,t){return!t||"object"!==cw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yw(e){return(yw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hw(e,t)}(o,e);var t,n,i,r=dw(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).menubox=e,t}return t=o,(n=[{key:"layout",value:function(e){}},{key:"preferredLayoutSize",value:function(e,t){var n=null;return this.menubox.menuItems.filter((function(e){return!e.overflown&&e.isVisible()})).reduce((function(e,t){return n=t.htmlComp.prefSize({useCssSize:!0,includeMargin:!0}),e.height=Math.max(e.height,n.height),e.width=Math.max(e.width,n.width),e}),new Co)}}])&&fw(t.prototype,n),i&&fw(t,i),o}(zo);function bw(e){return(bw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mw(e,t,n){return(mw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sw(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _w(e,t){return(_w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ww(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Sw(e);if(t){var r=Sw(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return kw(this,n)}}function kw(e,t){return!t||"object"!==bw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sw(e){return(Sw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ow(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_w(e,t)}(o,e);var t,n,i,r=ww(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).monthViewNumberOfWeeks=6,e.numberOfHourDivisions=e.getConfiguredNumberOfHourDivisions(),e.heightPerDivision=e.getConfiguredHeightPerDivision(),e.startHour=e.getConfiguredStartHour(),e.heightPerHour=e.numberOfHourDivisions*e.heightPerDivision,e.heightPerDay=24*e.heightPerHour,e.spaceBeforeScrollTop=15,e.workDayIndices=[1,2,3,4,5],e.components=[],e.displayMode,e.displayCondensed=!1,e.loadInProgress=!1,e.selectedDate=null,e.showDisplayModeSelection=!0,e.title=null,e.useOverflowCells=!0,e.viewRange=null,e.calendarToggleListWidth=270,e.calendarToggleYearWidth=215,e.$container=null,e.$header=null,e.$range=null,e.$commands=null,e.$grids=null,e.$grid=null,e.$topGrid=null,e.$list=null,e.$progress=null,e._showYearPanel=!1,e._showListPanel=!1,e._exactRange=null,e._listComponents=[],e.menuInjectionTarget=null,e._menuInjectionTargetMenusChangedHandler=null,e._addWidgetProperties(["components","menus","selectedComponent"]),e}return t=o,(n=[{key:"init",value:function(e,t,n){mw(Sw(o.prototype),"init",this).call(this,e,t,n)}},{key:"getConfiguredNumberOfHourDivisions",value:function(){return 2}},{key:"getConfiguredHeightPerDivision",value:function(){return 30}},{key:"getConfiguredStartHour",value:function(){return 6}},{key:"_isDay",value:function(){return this.displayMode===o.DisplayMode.DAY}},{key:"_isWeek",value:function(){return this.displayMode===o.DisplayMode.WEEK}},{key:"_isMonth",value:function(){return this.displayMode===o.DisplayMode.MONTH}},{key:"_isWorkWeek",value:function(){return this.displayMode===o.DisplayMode.WORK_WEEK}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_init",value:function(e){mw(Sw(o.prototype),"_init",this).call(this,e),this._yearPanel=O.create("YearPanel",{parent:this}),this._yearPanel.on("dateSelect",this._onYearPanelDateSelect.bind(this)),this.modesMenu=O.create("CalendarModesMenu",{parent:this,visible:!1,displayMode:this.displayMode}),this._setSelectedDate(e.selectedDate),this._setDisplayMode(e.displayMode),this._setMenuInjectionTarget(e.menuInjectionTarget),this._exactRange=this._calcExactRange(),this._yearPanel.setViewRange(this._exactRange),this.viewRange=this._calcViewRange()}},{key:"setSelectedDate",value:function(e){this.setProperty("selectedDate",e)}},{key:"_setSelectedDate",value:function(e){e=wt.ensure(e),this._setProperty("selectedDate",e),this._yearPanel.selectDate(this.selectedDate)}},{key:"setDisplayMode",value:function(e){if(!oi.equals(this.displayMode,e)){var t=this.displayMode;this._setDisplayMode(e),this.rendered&&this._renderDisplayMode(t)}}},{key:"_setDisplayMode",value:function(e){if(this._setProperty("displayMode",e),this._yearPanel.setDisplayMode(this.displayMode),this.modesMenu.setDisplayMode(e),this._isWorkWeek()){var t=this._dateParts(this.selectedDate,!0);t.day>4&&this.setSelectedDate(new Date(t.year,t.month,t.date-t.day+4))}}},{key:"_renderDisplayMode",value:function(e){this.rendering||(this._updateModel(!1,!0),e!==o.DisplayMode.MONTH&&this.displayMode!==o.DisplayMode.MONTH||(this._renderComponents(),this.needsScrollToStartHour=!0))}},{key:"_setViewRange",value:function(e){e=mk.ensure(e),this._setProperty("viewRange",e)}},{key:"_setMenus",value:function(e){if(this._checkMenuInjectionTarget(this.menuInjectionTarget)){var t=this._removeInjectedMenus(this.menuInjectionTarget,this.menus);this.menuInjectionTarget.setMenus(e.concat(t))}this._setProperty("menus",e)}},{key:"_setMenuInjectionTarget",value:function(e){if(oi.isString(e)&&(e=O.widget(e)),this._checkMenuInjectionTarget(this.menuInjectionTarget)){e.off("propertyChange:menus",this._menuInjectionTargetMenusChangedHandler);var t=this._removeInjectedMenus(this.menuInjectionTarget,this.menus);this.menuInjectionTarget.setMenus(t)}this._checkMenuInjectionTarget(e)&&(e.setMenus(this.menus.concat(e.menus)),this._menuInjectionTargetMenusChangedHandler=e.on("propertyChange:menus",function(e){this.menuInjectionTarget.menus.some(function(e){return this.menus.includes(e)}.bind(this))||this.menuInjectionTarget.setMenus(this.menus.concat(this.menuInjectionTarget.menus))}.bind(this))),this._setProperty("menuInjectionTarget",e)}},{key:"_checkMenuInjectionTarget",value:function(e){return e instanceof rY}},{key:"_removeInjectedMenus",value:function(e,t){return e.menus.filter((function(e){return!t.includes(e)}))}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("calendar");var e=new nk(this);this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(e),this.$header=this.$container.appendDiv("calendar-header"),this.$headerRow1=this.$header.appendDiv("calendar-header-row first"),this.$headerRow2=this.$header.appendDiv("calendar-header-row last"),this._yearPanel.render(),this.$grids=this.$container.appendDiv("calendar-grids"),this.$topGrid=this.$grids.appendDiv("calendar-top-grid"),this.$grid=this.$grids.appendDiv("calendar-grid"),this.$list=this.$container.appendDiv("calendar-list-container").appendDiv("calendar-list"),this.$listTitle=this.$list.appendDiv("calendar-list-title"),this.$range=this.$headerRow1.appendDiv("calendar-range"),this.$range.appendDiv("calendar-previous").click(this._onPreviousClick.bind(this)),this.$range.appendDiv("calendar-today",this.session.text("ui.CalendarToday")).click(this._onTodayClick.bind(this)),this.$range.appendDiv("calendar-next").click(this._onNextClick.bind(this)),this.$title=this.$headerRow1.appendDiv("calendar-title"),this.$select=this.$title.appendDiv("calendar-select"),this.$progress=this.$title.appendDiv("busyindicator-label"),this.$commands=this.$headerRow1.appendDiv("calendar-commands"),this.$commands.appendDiv("calendar-mode first",this.session.text("ui.CalendarDay")).attr("data-mode",o.DisplayMode.DAY).click(this._onDisplayModeClick.bind(this)),this.$commands.appendDiv("calendar-mode",this.session.text("ui.CalendarWorkWeek")).attr("data-mode",o.DisplayMode.WORK_WEEK).click(this._onDisplayModeClick.bind(this)),this.$commands.appendDiv("calendar-mode",this.session.text("ui.CalendarWeek")).attr("data-mode",o.DisplayMode.WEEK).click(this._onDisplayModeClick.bind(this)),this.$commands.appendDiv("calendar-mode last",this.session.text("ui.CalendarMonth")).attr("data-mode",o.DisplayMode.MONTH).click(this._onDisplayModeClick.bind(this)),this.modesMenu.render(this.$commands),this.$commands.appendDiv("calendar-toggle-year").click(this._onYearClick.bind(this)),this.$commands.appendDiv("calendar-toggle-list").click(this._onListClick.bind(this));var t=this.$topGrid.appendDiv("calendar-week-header");t.appendDiv("calendar-week-name");for(var n=0;n<7;n++)t.appendDiv("calendar-day-name").data("day",n);this.$topGrid.appendDiv("calendar-week-task").attr("data-axis-name",this.session.text("ui.CalendarDay"));var i=this.$topGrid.appendDiv("calendar-week-allday-container");i.appendDiv("calendar-week-name");for(var r=this._onDayContextMenu.bind(this),s=0;s<7;s++)i.appendDiv("calendar-day").addClass("calendar-scrollable-components").data("day",s).on("contextmenu",r);for(var a=1;a<7;a++)for(var u=this.$grid.appendDiv("calendar-week"),l=0;l<8;l++){var c=u.appendDiv();a>0&&0===l?c.addClass("calendar-week-name"):a>0&&l>0&&c.addClass("calendar-day").data("day",l).data("week",a).on("contextmenu",r)}var f=this._onDayMouseDown.bind(this,!0);this.$grid.find(".calendar-day").on("mousedown",f);var h=this._onDayMouseDown.bind(this,!1);this.$topGrid.find(".calendar-day").on("mousedown",h),this._updateScreen(!1,!1)}},{key:"_renderProperties",value:function(){mw(Sw(o.prototype),"_renderProperties",this).call(this),this._renderComponents(),this._renderSelectedComponent(),this._renderLoadInProgress(),this._renderDisplayMode()}},{key:"_renderComponents",value:function(){this.components.sort(this._sortFromTo),this.components.forEach((function(e){return e.remove()})),this.components.forEach((function(e){return e.render()})),this._arrangeComponents(),this._updateListPanel()}},{key:"_renderSelectedComponent",value:function(){this.selectedComponent&&this.selectedComponent.setSelected(!0)}},{key:"_renderLoadInProgress",value:function(){this.$progress.setVisible(this.loadInProgress)}},{key:"updateScrollPosition",value:function(e){this.rendered?this._updateScrollPosition(!0,e):this.session.layoutValidator.schedulePostValidateFunction(this._updateScrollPosition.bind(this,!0,e))}},{key:"_updateScrollPosition",value:function(e,t){if(this._isMonth())this._scrollToSelectedComponent(t);else if(this.selectedComponent)if(this.selectedComponent.fullDay)this._scrollToSelectedComponent(t),e&&this._scrollToInitialTime(t);else{var n=wt.parseJsonDate(this.selectedComponent.fromDate,this.selectedComponent),i=this._dayPosition(n.getHours(),n.getMinutes())/100,r=this.heightPerDay*i;wf.scrollTop(this.$grid,r-this.spaceBeforeScrollTop,{animate:t})}else e&&this._scrollToInitialTime(t)}},{key:"_scrollToSelectedComponent",value:function(e){this.selectedComponent&&this.selectedComponent._$parts[0]&&this.selectedComponent._$parts[0].parent()&&this.selectedComponent._$parts[0].isVisible()&&wf.scrollTo(this.selectedComponent._$parts[0].parent(),this.selectedComponent._$parts[0],{animate:e})}},{key:"_scrollToInitialTime",value:function(e){if(this.needsScrollToStartHour=!1,!this._isMonth())if(this.selectedComponent&&!this.selectedComponent.fullDay){var t=wt.parseJsonDate(this.selectedComponent.fromDate),n=this._dayPosition(t.getHours(),t.getMinutes())/100,i=this.heightPerDay*n;wf.scrollTop(this.$grid,i-this.spaceBeforeScrollTop,{animate:e})}else{var r=this.heightPerHour*this.startHour;wf.scrollTop(this.$grid,r-this.spaceBeforeScrollTop,{animate:e})}}},{key:"_onPreviousClick",value:function(e){this._navigateDate(o.Direction.BACKWARD)}},{key:"_onNextClick",value:function(e){this._navigateDate(o.Direction.FORWARD)}},{key:"_dateParts",value:function(e,t){var n={year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay()};return t&&(n.day=(e.getDay()+6)%7),n}},{key:"_navigateDate",value:function(e){this.selectedDate=this._calcSelectedDate(e),this._updateModel(!0,!1)}},{key:"_calcSelectedDate",value:function(e){var t=this._dateParts(this.selectedDate),n=e,i=7*e,r=e;return this._isDay()?new Date(t.year,t.month,t.date+n):this._isWeek()||this._isWorkWeek()?new Date(t.year,t.month,t.date+i):this._isMonth()?wt.shift(this.selectedDate,0,r,0):void 0}},{key:"_updateModel",value:function(e,t){this._exactRange=this._calcExactRange(),this._yearPanel.setViewRange(this._exactRange),this.viewRange=this._calcViewRange(),this.trigger("modelChange"),this._updateScreen(e,t)}},{key:"_calcExactRange",value:function(){var e,t,n=this._dateParts(this.selectedDate,!0);if(this._isDay())e=new Date(n.year,n.month,n.date),t=new Date(n.year,n.month,n.date+1);else if(this._isWeek())e=new Date(n.year,n.month,n.date-n.day),t=new Date(n.year,n.month,n.date-n.day+6);else if(this._isMonth())e=new Date(n.year,n.month,1),t=new Date(n.year,n.month+1,0);else{if(!this._isWorkWeek())throw new Error("invalid value for displayMode");e=new Date(n.year,n.month,n.date-n.day),t=new Date(n.year,n.month,n.date-n.day+4)}return new mk(e,t)}},{key:"_calcViewRange",value:function(){var e=function(e){var t,n=new Date(e.valueOf());for(t=0;t<42;t++)if(n.setDate(n.getDate()-1),1===n.getDay()&&n.getMonth()!==e.getMonth())return n;throw new Error("failed to calc viewFrom date")}(this._exactRange.from),t=function(e){var t,n=new Date(e.valueOf());for(t=0;t<42;t++)n.setDate(n.getDate()+1);return n}(e);return new mk(e,t)}},{key:"_onTodayClick",value:function(e){this.selectedDate=new Date,this._updateModel(!0,!1)}},{key:"_onDisplayModeClick",value:function(e){var t=s()(e.target).data("mode");this.setDisplayMode(t)}},{key:"_onYearClick",value:function(e){this._showYearPanel=!this._showYearPanel,this._updateScreen(!0,!0)}},{key:"_onListClick",value:function(e){this._showListPanel=!this._showListPanel,this._updateScreen(!1,!0)}},{key:"_onDayMouseDown",value:function(e,t){var n=new Date(s()(t.delegateTarget).data("date"));if(e&&(this._isDay()||this._isWeek()||this._isWorkWeek())){var i=Math.floor(t.originalEvent.layerY/this.heightPerDivision)/this.numberOfHourDivisions*60*60;i<86400&&n.setSeconds(i)}this._setSelection(n,null,!1)}},{key:"_setSelection",value:function(e,t,n){var i=!1;0!==wt.compareDays(this.selectedDate,e)&&(i=!0,s()(".calendar-day",this.$container).each(function(t,n){var i=s()(n),r=i.data("date");r&&0!==wt.compareDays(r,this.selectedDate)?0===wt.compareDays(r,e)&&i.select(!0):i.select(!1)}.bind(this)),this.selectedDate=e),this.selectedComponent!==t&&(i=!0,this.selectedComponent&&this.selectedComponent.setSelected(!1),t&&t.setSelected(!0),this.selectedComponent=t),i&&(this.trigger("selectionChange"),this._updateListPanel(),n&&this._updateScrollPosition(!1,!0)),this._showYearPanel&&this._yearPanel.selectDate(this.selectedDate)}},{key:"_updateScreen",value:function(e,t){s.a.log.isInfoEnabled()&&s.a.log.info("(Calendar#_updateScreen)"),s()(".calendar-mode",this.$commands).select(!1),s()('[data-mode="'+this.displayMode+'"]',this.$commands).select(!0),s()(".selected",this.$grid).select(!1),this.layoutLabel(),this.layoutSize(t),this.layoutAxis(),this._showYearPanel&&this._yearPanel.selectDate(this.selectedDate),this._updateListPanel(),this._updateScrollbars(this.$grid,t),e&&!this._isMonth()&&this._updateTopGrid()}},{key:"layoutSize",value:function(e){s()("div",this.$container).removeData(["new-width","new-height"]),this._isMonth()?(this.$topGrid.addClass("calendar-top-grid-short"),this.$grid.removeClass("calendar-grid-short")):(this.$topGrid.removeClass("calendar-top-grid-short"),this.$grid.addClass("calendar-grid-short"));var t=s()(".selected",this.$grid),n=s()(".selected",this.$topGrid),i=this.$container.width(),r=this.$grid.height(),o=i-20;s()(".calendar-toggle-year",this.$commands).select(this._showYearPanel),this._showYearPanel?(this._yearPanel.$container.data("new-width",this.calendarToggleYearWidth),o-=this.calendarToggleYearWidth,i-=this.calendarToggleYearWidth):this._yearPanel.$container.data("new-width",0),s()(".calendar-toggle-list",this.$commands).select(this._showListPanel),this._showListPanel?(this.$list.parent().data("new-width",this.calendarToggleListWidth),o-=this.calendarToggleListWidth,i-=this.calendarToggleListWidth):this.$list.parent().data("new-width",0),this.$grids.data("new-width",i);var a=s()(),u=s()(".calendar-week",this.$grid);if(this._isDay()||this._isWeek()||this._isWorkWeek()){u.removeClass("calendar-week-noborder");var l=t.parent();(a=u.not(l)).data("new-height",0),a.removeClass("invisible"),l.data("new-height",this.heightPerDay),l.addClass("calendar-week-noborder"),l.removeClass("hidden invisible"),s()(".calendar-day",l).data("new-height",this.heightPerDay),s()(".calendar-week-name",this.$grid).addClass("invisible"),s()(".calendar-week-allday-container",this.$topGrid).removeClass("hidden"),s()(".calendar-week-task",this.$topGrid).removeClass("hidden")}else{var c=r/this.monthViewNumberOfWeeks;u.removeClass("calendar-week-noborder invisible hidden"),u.eq(0).addClass("calendar-week-noborder"),u.data("new-height",c),s()(".calendar-day",this.$grid).data("new-height",c);var f=s()(".calendar-week-name",this.$grid);f.removeClass("hidden invisible"),f.data("new-height",c),s()(".calendar-week-allday-container",this.$topGrid).addClass("hidden"),s()(".calendar-week-task",this.$topGrid).addClass("hidden")}var h=o-45;if(this._isDay())s()(".calendar-day-name, .calendar-day",this.$topGrid).data("new-width",0),s()(".calendar-day",this.$grid).data("new-width",0),s()(".calendar-day-name:nth-child("+(n.index()+1)+")",this.$topGrid).data("new-width",h),s()(".calendar-day:nth-child("+(n.index()+1)+")",this.$topGrid).data("new-width",h),s()(".calendar-day:nth-child("+(t.index()+1)+")",this.$grid).data("new-width",h);else if(this._isWorkWeek()){this.$topGrid.find(".calendar-day-name").data("new-width",0),this.$grids.find(".calendar-day").data("new-width",0);var d=Math.round(h/this.workDayIndices.length);s()(".calendar-day-name:nth-child(-n+6), .calendar-day:nth-child(-n+6)",this.$topGrid).data("new-width",d),s()(".calendar-day:nth-child(-n+6)",this.$grid).data("new-width",d)}else if(this._isMonth()||this._isWeek()){var p=Math.round(h/7);this.$grids.find(".calendar-day").data("new-width",p),this.$topGrid.find(".calendar-day-name").data("new-width",p)}this._isMonth()&&s()(".component-month",this.$grid).each((function(){var e=s()(this),t=e.closest(".calendar-day");e.toggleClass("compact",t.data("new-width")<Hw.MONTH_COMPACT_THRESHOLD)}));var y=this._afterLayout.bind(this);s()("div",this.$container).each((function(){var t=s()(this),n=t.data("new-width"),i=t.data("new-height");t.stop(!1,!0),void 0!==n&&n!==t.outerWidth()&&(e?t.animateAVCSD("width",n,y.bind(this,t,e)):(t.css("width",n),y(t,e))),void 0!==i&&i!==t.outerHeight()&&(i>0&&t.removeClass("hidden"),e?t.animateAVCSD("height",i,(function(){0===i&&t.addClass("hidden"),y(t,e)})):(t.css("height",i),0===i&&t.addClass("hidden"),y(t,e)))}))}},{key:"_afterLayout",value:function(e,t){this._updateScrollbars(e,t),this._updateWeekdayNames()}},{key:"_updateWeekdayNames",value:function(){var e,t=this.$topGrid.width();this._isDay()?t/=1:this._isWorkWeek()?t/=this.workDayIndices.length:(this._isWeek()||this._isMonth())&&(t/=7),e=t>90?this.session.locale.dateFormat.symbols.weekdaysOrdered:this.session.locale.dateFormat.symbols.weekdaysShortOrdered,s()(".calendar-day-name",this.$topGrid).each((function(t){s()(this).attr("data-day-name",e[t])}))}},{key:"_updateScrollbars",value:function(e,t){s()(".calendar-scrollable-components",e).each((function(){var e=s()(this);wf.update(e,!0)})),this.updateScrollPosition(t)}},{key:"_updateTopGrid",value:function(){s()(".calendar-component",this.$topGrid).each((function(e,t){var n=s()(t).data("component");n&&n.remove()}));var e=this.components.filter((function(e){return e.fullDay}));e.forEach((function(e){return e.remove()})),e.forEach((function(e){return e.render()})),this._updateScrollbars(this.$topGrid,!1)}},{key:"layoutYearPanel",value:function(){this._showYearPanel&&(wf.update(this._yearPanel.$yearList),this._yearPanel._scrollYear())}},{key:"layoutLabel",value:function(){var e,t,n,i=this._exactRange.from,r=this._exactRange.to;if(this._isDay())e=this._format(i,"d. MMMM yyyy");else if(this._isWorkWeek()||this._isWeek()){var o=this.session.text("ui.to");e=i.getMonth()===r.getMonth()?En.join(" ",this._format(i,"d."),o,this._format(r,"d. MMMM yyyy")):i.getFullYear()===r.getFullYear()?En.join(" ",this._format(i,"d. MMMM"),o,this._format(r,"d. MMMM yyyy")):En.join(" ",this._format(i,"d. MMMM yyyy"),o,this._format(r,"d. MMMM yyyy"))}else this._isMonth()&&(e=this._format(i,"MMMM yyyy"));this.$select.text(e),t=s()(".calendar-day",this.$grid);var a,u,l,c=this._exactRange.from.getMonth(),f=new Date(this.viewRange.from.valueOf());for(a=0;a<this.monthViewNumberOfWeeks;a++)for(u=0;u<7;u++)l="",l=-1===this.workDayIndices.indexOf(f.getDay())?f.getMonth()!==c?" weekend-out":" weekend":f.getMonth()!==c?" out":"",wt.isSameDay(f,new Date)&&(l+=" now"),wt.isSameDay(f,this.selectedDate)&&(l+=" selected"),this._isMonth()||(l+=" calendar-no-label"),f.getDate()>9&&f.getDate()<20&&(l+=" center-nice"),e=this._format(f,"dd"),t.eq(7*a+u).removeClass("weekend-out weekend out selected now calendar-no-label").addClass(l).attr("data-day-name",e).data("date",new Date(f.valueOf())),f.setDate(f.getDate()+1);if(!this._isMonth()){n=s()(".calendar-day",this.$topGrid);var h=new Date(this._exactRange.from.valueOf());for(f=wt.firstDayOfWeek(h,1),u=0;u<7;u++)l="",l=-1===this.workDayIndices.indexOf(f.getDay())?f.getMonth()!==c?" weekend-out":" weekend":f.getMonth()!==c?" out":"",wt.isSameDay(f,new Date)&&(l+=" now"),wt.isSameDay(f,this.selectedDate)&&(l+=" selected"),e=this._format(f,"dd"),n.eq(u).removeClass("weekend-out weekend out selected now").addClass(l).attr("data-day-name",e).data("date",new Date(f.valueOf())),f.setDate(f.getDate()+1)}}},{key:"layoutAxis",value:function(){var e;s()(".calendar-week-axis, .calendar-week-task",this.$grid).remove();var t=this.session;if(s()(".calendar-week-name",this.$container).each((function(n){n>0&&(e=s()(this)).text(t.text("ui.CW",wt.weekInYear(e.next().data("date"))))})),!this._isMonth())for(var n=s()(".calendar-week",this.$grid),i=0;i<24;i++){var r=("00"+i).slice(-2),o=i*this.heightPerHour;n.appendDiv("calendar-week-axis hour"+(0===i?" first":"")).attr("data-axis-name",r+":00").css("top",o+"px");for(var a=1;a<this.numberOfHourDivisions;a++)o+=this.heightPerDivision,n.appendDiv("calendar-week-axis").attr("data-axis-name","").css("top",o+"px")}}},{key:"_onYearPanelDateSelect",value:function(e){this.selectedDate=e.date,this._updateModel(!0,!1)}},{key:"_updateListPanel",value:function(){this._showListPanel&&(this._listComponents.forEach((function(e){e.remove()})),this._listComponents=[],this._renderListPanel())}},{key:"_remove",value:function(){for(var e=s()(".calendar-day",this.$grid),t=0;t<e.length;t++){var n=e.eq(t).children(".calendar-scrollable-components");n.length>0&&(wf.uninstall(n,this.session),n.remove())}mw(Sw(o.prototype),"_remove",this).call(this)}},{key:"_renderListPanel",value:function(){var e,t=[];function n(e){var t=wt.trunc(this.selectedDate);return wt.compare(t,e.coveredDaysRange.from)>=0&&wt.compare(t,e.coveredDaysRange.to)<=0}this.$listTitle.text(this._format(this.selectedDate,"d. MMMM yyyy")),this.components.forEach(function(e){n.call(this,e)&&t.push(e)}.bind(this)),t.forEach(function(t){(e=new Yw(this.selectedDate,t)).render(this.$list),this._listComponents.push(e)}.bind(this))}},{key:"_selectedComponentChanged",value:function(e,t,n){this._setSelection(t,e,n)}},{key:"_onDayContextMenu",value:function(e){this._showContextMenu(e,"Calendar.EmptySpace")}},{key:"_showContextMenu",value:function(e,t){e.preventDefault(),e.stopPropagation();var n=function(e,t){if(this.rendered&&this.attached){var n=mb.filter(this.menus,[t],!0),i=s()(e.currentTarget);0!==n.length&&O.create("ContextMenuPopup",{parent:this,menuItems:n,location:{x:e.pageX,y:e.pageY},$anchor:i}).open()}}.bind(this);this.session.onRequestsDone(n,e,t)}},{key:"_arrangeComponents",value:function(){var e,t,n,i,r,o,a,u,l=s()(".calendar-day",this.$grid);for(e=0;e<l.length;e++){if(r=(n=l.eq(e)).children(".calendar-component:not(.component-task)"),i=n.children(".calendar-component"),u=n.data("date"),(o=n.children(".calendar-scrollable-components")).length>0&&(wf.uninstall(o,this.session),o.remove()),this._isMonth()&&i.length>0){for(o=n.appendDiv("calendar-scrollable-components"),t=0;t<i.length;t++){var c=i.eq(t);(this._isMonth()||c.hasClass("component-task"))&&o.append(c)}wf.install(o,{parent:this,session:this.session,axis:"y"})}this._isMonth()&&r.length>2?n.addClass("many-items"):!this._isMonth()&&r.length>1&&(a=this._getComponents(r),this._arrange(a,u),this._arrangeComponentSetPlacement(r,u))}if(this._isMonth())this._uninstallScrollbars(),this.$grid.removeClass("calendar-scrollable-components");else{this.$grid.addClass("calendar-scrollable-components"),this._installScrollbars({parent:this,session:this.session,axis:"y"});var f=s()(".calendar-scrollable-components",this.$topGrid);for(e=0;e<f.length;e++){var h=f.eq(e);wf.install(h,{parent:this,session:this.session,axis:"y"})}}}},{key:"_getComponents",value:function(e){var t,n,i=[];for(t=0;t<e.length;t++)n=e.eq(t),i.push(n.data("component"));return i}},{key:"_sort",value:function(e){e.sort(this._sortFromTo)}},{key:"_arrange",value:function(e,t){var n,i,r,o,s,a=[];for(this._sort(e),n=0;n<e.length;n++)(r=e[n]).stack||(r.stack={}),r.stack[t]={};for(n=0;n<e.length;n++)for(o=(r=e[n]).getPartDayPosition(t),a.length>0&&this._allEndBefore(a,o.from,t)&&(a=[]),(s=this._findReplacableColumn(a,o.from,t))>=0?(a[s]=r,r.stack[t].x=s):(a.push(r),r.stack[t].x=a.length-1),i=0;i<a.length;i++)a[i].stack[t].w=a.length}},{key:"_allEndBefore",value:function(e,t,n){var i;for(i=0;i<e.length;i++)if(!this._endsBefore(e[i],t,n))return!1;return!0}},{key:"_findReplacableColumn",value:function(e,t,n){var i;for(i=0;i<e.length;i++)if(this._endsBefore(e[i],t,n))return i;return-1}},{key:"_endsBefore",value:function(e,t,n){return e.getPartDayPosition(n).to<=t}},{key:"_arrangeComponentSetPlacement",value:function(e,t){var n,i,r;for(n=0;n<e.length;n++)r=(i=e.eq(n)).data("component").stack[t],i.css("width",100/r.w+"%").css("left",100*r.x/r.w+"%")}},{key:"get$Scrollable",value:function(){return this.$grid}},{key:"_dayPosition",value:function(e,t){var n;return n=e<0?0:100/1440*(60*e+t),Math.round(100*n)/100}},{key:"_hourToNumber",value:function(e){var t=e.split(":");return parseFloat(t[0])+parseFloat(t[1])/60}},{key:"_format",value:function(e,t){return wt.format(e,this.session.locale,t)}},{key:"_sortFromTo",value:function(e,t){var n=wt.parseJsonDate(e.fromDate),i=wt.parseJsonDate(t.fromDate),r=wt.compare(n,i);if(0!==r)return r;var o=wt.parseJsonDate(e.toDate),s=wt.parseJsonDate(t.toDate),a=wt.compare(o,s);if(0!==a)return a;var u=e.item&&e.item.subject?e.item.subject:"",l=t.item&&t.item.subject?t.item.subject:"";return u.localeCompare(l)}}])&&gw(t.prototype,n),i&&gw(t,i),o}(de);function Cw(e){return(Cw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Rw(e,t,n){return(Rw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fw(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function xw(e,t){return(xw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ew(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Fw(e);if(t){var r=Fw(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Dw(this,n)}}function Dw(e,t){return!t||"object"!==Cw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fw(e){return(Fw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Ow(Tw,"DisplayMode",{DAY:1,WEEK:2,MONTH:3,WORK_WEEK:4}),Ow(Tw,"Direction",{BACKWARD:-1,FORWARD:1});var Aw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xw(e,t)}(o,e);var t,n,i,r=Ew(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_postCreateWidget",value:function(){this._sendViewRangeChange()}},{key:"_onWidgetEvent",value:function(e){"viewRangeChange"===e.type?this._sendViewRangeChange():"modelChange"===e.type?this._sendModelChange():"selectionChange"===e.type?this._sendSelectionChange():Rw(Fw(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_jsonViewRange",value:function(){return wt.toJsonDateRange(this.widget.viewRange)}},{key:"_jsonSelectedDate",value:function(){return wt.toJsonDate(this.widget.selectedDate)}},{key:"_sendViewRangeChange",value:function(){this._send("viewRangeChange",{viewRange:this._jsonViewRange()})}},{key:"_sendModelChange",value:function(){var e={viewRange:this._jsonViewRange(),selectedDate:this._jsonSelectedDate(),displayMode:this.widget.displayMode};this._send("modelChange",e)}},{key:"_sendSelectionChange",value:function(){var e=this.widget.selectedComponent?this.widget.selectedComponent.id:null;this._send("selectionChange",{date:this._jsonSelectedDate(),componentId:e})}}])&&Pw(t.prototype,n),i&&Pw(t,i),o}(fe);function $w(e){return($w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Mw(e,t,n){return(Mw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Nw(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Iw(e,t){return(Iw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Nw(e);if(t){var r=Nw(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Bw(this,n)}}function Bw(e,t){return!t||"object"!==$w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nw(e){return(Nw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iw(e,t)}(o,e);var t,n,i,r=Lw(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).selected=!1,e.fullDay=!1,e.item=null,e._$parts=[],e}return t=o,(n=[{key:"_init",value:function(e){Mw(Nw(o.prototype),"_init",this).call(this,e),this._syncCoveredDaysRange(this.coveredDaysRange)}},{key:"_syncCoveredDaysRange",value:function(e){e&&(this.coveredDaysRange=new fi(wt.parseJsonDate(e.from),wt.parseJsonDate(e.to)))}},{key:"_remove",value:function(){this._$parts.forEach((function(e){e.remove()})),this._$parts=[],Mw(Nw(o.prototype),"_remove",this).call(this)}},{key:"_startLoopDay",value:function(){return wt.compare(this.coveredDaysRange.from,this.parent.viewRange.from)>0?this.coveredDaysRange.from:this.parent.viewRange.from}},{key:"_render",value:function(){var e,t,n;if(this.coveredDaysRange){var i=this._startLoopDay(),r=wt.parseJsonDate(this.toDate),a=wt.parseJsonDate(this.fromDate),u=this.coveredDaysRange.to;if(!this.fullDay){var l=wt.trunc(r);wt.isSameDay(a,r)||0!==wt.compare(r,l)||(r=wt.shiftTime(r,0,0,0,-1),u=wt.shift(u,0,0,-1))}r=wt.toJsonDate(r);var c=wt.shift(u,0,0,1);if(!(wt.compare(i,c)>0))for(;!(wt.isSameDay(i,c)||(e=i,i=wt.shift(i,0,0,1),wt.compare(e,this.parent.viewRange.to)>0));)if(t=this.fullDay&&!this.parent._isMonth()?this._findDayInGrid(e,this.parent.$topGrid):this._findDayInGrid(e,this.parent.$grid))if((n=t.appendDiv("calendar-component")).addClass(this.item.cssClass).data("component",this).data("partDay",e).mousedown(this._onMouseDown.bind(this)).on("contextmenu",this._onContextMenu.bind(this)),n.appendDiv("calendar-component-leftcolorborder"),n.appendDiv("content",this.item.subject),this._$parts.push(n),this.parent._isMonth()){var f=t.data("new-width")||t.width();n.addClass("component-month").toggleClass("compact",f<o.MONTH_COMPACT_THRESHOLD)}else if(this.fullDay){var h=s()(".component-task",t).length;this._arrangeTask(30+26*h),n.addClass("component-task")}else{var d=wt.parseJsonDate(this.fromDate),p=wt.parseJsonDate(r),y=this._getHours(this.fromDate),v=this._getHours(r);n.addClass("component-day"),wt.isSameDay(wt.trunc(this.coveredDaysRange.from),wt.trunc(u))?this._partPosition(n,y,v):wt.isSameDay(e,d)?this._partPosition(n,y,25).addClass("component-open-bottom"):wt.isSameDay(e,p)?this._partPosition(n,0,v).addClass("component-open-top"):this._partPosition(n,0,25).addClass("component-open-top").addClass("component-open-bottom")}}}},{key:"_getHours",value:function(e){var t=wt.parseJsonDate(e);return t.getHours()+t.getMinutes()/60}},{key:"_findDayInGrid",value:function(e,t){return t.find(".calendar-day").filter((function(t,n){return wt.isSameDay(s()(this).data("date"),e)})).eq(0)}},{key:"_isTask",value:function(){return!this.parent._isMonth()&&this.fullDay}},{key:"_arrangeTask",value:function(e){this._$parts.forEach((function(t){t.css("top",e+"px")}))}},{key:"_isDayPart",value:function(){return!this.parent._isMonth()&&!this.fullDay}},{key:"_getHourRange",value:function(e){var t=new fi(this._getHours(this.fromDate),this._getHours(this.toDate)),n=new fi(wt.parseJsonDate(this.fromDate),wt.parseJsonDate(this.toDate));return wt.isSameDay(e,n.from)&&wt.isSameDay(e,n.to)?new fi(t.from,t.to):wt.isSameDay(e,n.from)?new fi(t.from,24):wt.isSameDay(e,n.to)?new fi(0,t.to):new fi(0,24)}},{key:"getPartDayPosition",value:function(e){return this._getDisplayDayPosition(this._getHourRange(e))}},{key:"_getDisplayDayPosition",value:function(e){var t=new fi(this.parent._dayPosition(e.from,0),this.parent._dayPosition(e.to,0)),n=Math.round(1e4/24/this.parent.numberOfHourDivisions)/100;return t.size()<n?new fi(t.from,t.from+n):t}},{key:"_partPosition",value:function(e,t,n){var i=25===n?23:0;n=Math.min(24,n);var r=new fi(t,n),o=this._getDisplayDayPosition(r);return i=Math.round(100/1920*i*100)/100,e.css("top",o.from+"%").css("height",o.to-o.from-i+"%")}},{key:"_renderProperties",value:function(){Mw(Nw(o.prototype),"_renderProperties",this).call(this),this._renderSelected()}},{key:"_renderSelected",value:function(){this._$parts.forEach((function(e){e.toggleClass("comp-selected",this.selected)}),this)}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"updateSelectedComponent",value:function(e,t){this.parent._selectedComponentChanged(this,e.data("partDay"),t)}},{key:"_onMouseDown",value:function(e){var t=s()(e.delegateTarget);this.updateSelectedComponent(t,!1),0===e.button&&O.create("WidgetPopup",{parent:this.parent,$anchor:t,closeOnAnchorMouseDown:!0,closeOnMouseDownOutside:!0,closeOnOtherPopupOpen:!0,horizontalAlignment:kd.Alignment.LEFT,verticalAlignment:kd.Alignment.CENTER,trimWidth:!1,trimHeight:!1,horizontalSwitch:!0,verticalSwitch:!0,withArrow:!0,cssClass:"tooltip",scrollType:"remove",location:{y:e.originalEvent.clientY},widget:{objectType:"Label",htmlEnabled:!0,cssClass:"tooltip-content",value:this._description()}}).open(),e.stopPropagation()}},{key:"_onContextMenu",value:function(e){this.parent._showContextMenu(e,"Calendar.CalendarComponent")}},{key:"_format",value:function(e,t){return wt.format(e,this.session.locale,t)}},{key:"_description",value:function(){var e=[],t=null,n="",i=wt.parseJsonDate(this.fromDate),r=wt.parseJsonDate(this.toDate);return En.hasText(this.item.subject)&&e.push({text:En.encode(this.item.subject),cssClass:"calendar-component-title"}),this.fullDay||(t=wt.isSameDay(i,r)?this.session.text("ui.FromXToY",this._format(i,"HH:mm"),this._format(r,"HH:mm")):this.session.text("ui.FromXToY",this._format(i,"EEEE HH:mm "),this._format(r,"EEEE HH:mm"))),En.hasText(t)&&e.push({text:t,cssClass:"calendar-component-intro"}),En.hasText(this.item.description)&&e.push({text:En.nl2br(this.item.description)}),e.forEach((function(e){n+=(e.cssClass?'<span class="'+e.cssClass+'">'+e.text+"</span>":e.text)+"<br/>"})),n}}])&&jw(t.prototype,n),i&&jw(t,i),o}(de);function Vw(e){return(Vw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ww(e,t){return(Ww=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Uw(e);if(t){var r=Uw(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gw(this,n)}}function Gw(e,t){return!t||"object"!==Vw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uw(e){return(Uw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Hw,"MONTH_COMPACT_THRESHOLD",100);var Kw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ww(e,t)}(n,e);var t=zw(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(fe);function qw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Yw=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.partDay=t,this.source=n,this.$container=null,this._selectedListener=n.on("selected",function(e){this.$container.toggleClass("comp-selected",e.selected)}.bind(this)),this._removeListener=n.on("remove",this.remove.bind(this))}var t,n,i;return t=e,(n=[{key:"render",value:function(e){var t=this.source;this.$container=e.appendDiv("calendar-component").data("partDay",this.partDay).addClass(t.item.cssClass).toggleClass("comp-selected",t._selected).mousedown(this._onMouseDown.bind(this,t)).on("contextmenu",t._onContextMenu.bind(t)),this.$container.appendDiv("calendar-component-leftcolorborder"),this.$container.appendDiv("content").html(t._description())}},{key:"_onMouseDown",value:function(e,t){t.preventDefault();var n=$(t.delegateTarget);e.updateSelectedComponent(n,!0)}},{key:"remove",value:function(){this.source.removeListener(this._selectedListener),this.source.removeListener(this._removeListener),this.$container.remove()}}])&&qw(t.prototype,n),i&&qw(t,i),e}();function Xw(e){return(Xw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zw(e,t){return(Zw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=tk(e);if(t){var r=tk(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ek(this,n)}}function ek(e,t){return!t||"object"!==Xw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tk(e){return(tk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zw(e,t)}(o,e);var t,n,i,r=Qw(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).calendar=e,t.stacked=!1,t.compacted=!1,t}return t=o,(n=[{key:"layout",value:function(e){var t,n=0,i=this.calendar._yearPanel.$container,r=this.calendar.$grids,o=this.calendar.$header;n+=e.cssMarginTop()+e.cssMarginBottom(),e.css("height","calc(100% - "+n+"px)"),this.undoCompact(),this.undoStack(),o[0].scrollWidth>e.width()&&this.stack(),o[0].scrollWidth>e.width()&&this.compact(),t=o.outerHeight(!0),i.css("height","calc(100% - "+(t+i.cssMarginY())+"px)"),r.css("height","calc(100% - "+(t+r.cssMarginY())+"px)"),this.calendar.layoutSize(),this.calendar.layoutYearPanel()}},{key:"compact",value:function(){if(!this.compacted){var e=this.calendar.$headerRow2;this.calendar.$title.appendTo(this.calendar.$headerRow2),e.show(),this.compacted=!0}}},{key:"undoCompact",value:function(){if(this.compacted){var e=this.calendar.$headerRow2;this.calendar.$title.insertBefore(this.calendar.$commands),e.hide(),this.compacted=!1}}},{key:"stack",value:function(){this.stacked||(this.calendar.$commands.children(".calendar-mode").hide(),this.calendar.modesMenu.setVisible(!0),this.stacked=!0)}},{key:"undoStack",value:function(){this.stacked&&(this.calendar.$commands.children(".calendar-mode").show(),this.calendar.modesMenu.setVisible(!1),this.stacked=!1)}}])&&Jw(t.prototype,n),i&&Jw(t,i),o}(zo);function ik(e){return(ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ok(e,t){return(ok=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=uk(e);if(t){var r=uk(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ak(this,n)}}function ak(e,t){return!t||"object"!==ik(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uk(e){return(uk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ok(e,t)}(o,e);var t,n,i,r=sk(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"doAction",value:function(){return!!this.prepareDoAction()&&(this.setSelected(!0),this.parentMenu.setSelected(!1),!0)}}])&&rk(t.prototype,n),i&&rk(t,i),o}(xb);function ck(e){return(ck="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hk(e,t,n){return(hk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vk(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function dk(e,t){return(dk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=vk(e);if(t){var r=vk(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return yk(this,n)}}function yk(e,t){return!t||"object"!==ck(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vk(e){return(vk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dk(e,t)}(o,e);var t,n,i,r=pk(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).cssClass="calendar-mode-menu",e.displayMode,e}return t=o,(n=[{key:"_init",value:function(e){hk(vk(o.prototype),"_init",this).call(this,e),this.calendar=this.parent;var t=[];t.push(O.create("CalendarModeMenu",{parent:this,displayMode:Tw.DisplayMode.DAY,text:this.session.text("ui.CalendarDay")})),t.push(O.create("CalendarModeMenu",{parent:this,displayMode:Tw.DisplayMode.WORK_WEEK,text:this.session.text("ui.CalendarWorkWeek")})),t.push(O.create("CalendarModeMenu",{parent:this,displayMode:Tw.DisplayMode.WEEK,text:this.session.text("ui.CalendarWeek")})),t.push(O.create("CalendarModeMenu",{parent:this,displayMode:Tw.DisplayMode.MONTH,text:this.session.text("ui.CalendarMonth")})),this.addChildActions(t),this.childActions.forEach((function(e){e.on("propertyChange",this._onMenuPropertyChange.bind(this))}),this),this._setDisplayMode(this.displayMode)}},{key:"setDisplayMode",value:function(e){this.setProperty("displayMode",e)}},{key:"_setDisplayMode",value:function(e){this._setProperty("displayMode",e);var t=this.getMenuForMode(this.displayMode);t.setSelected(!0),this.setText(t.text)}},{key:"getMenuForMode",value:function(e){return et.find(this.childActions,(function(t){return t.displayMode===e}))}},{key:"_onMenuPropertyChange",value:function(e){if("selected"===e.propertyName&&e.newValue){var t=e.source.displayMode;this.setDisplayMode(t),this.calendar.setDisplayMode(t),this.childActions.forEach((function(t){t!==e.source&&t.setSelected(!1)}),this)}}}])&&fk(t.prototype,n),i&&fk(t,i),o}(xb);function gk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var mk=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.from=t,this.to=n}var t,n,i;return t=e,i=[{key:"ensure",value:function(t){return t?t instanceof e?t:new e(wt.ensure(t.from),wt.ensure(t.to)):t}}],(n=[{key:"equals",value:function(e){return!!e&&wt.equals(this.from,e.from)&&wt.equals(this.to,e.to)}},{key:"toString",value:function(){return"scout.DateRange[from="+(null===this.from?"null":this.from.toUTCString())+" to="+(null===this.to?"null":this.to.toUTCString())+"]"}}])&&gk(t.prototype,n),i&&gk(t,i),e}();function _k(e){return(_k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kk(e,t,n){return(kk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ck(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Sk(e,t){return(Sk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ok(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ck(e);if(t){var r=Ck(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Tk(this,n)}}function Tk(e,t){return!t||"object"!==_k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ck(e){return(Ck=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sk(e,t)}(o,e);var t,n,i,r=Ok(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).$yearTitle,e.$yearList,e.selectedDate,e.displayMode,e.alwaysSelectFirstDay,e}return t=o,(n=[{key:"_init",value:function(e){kk(Ck(o.prototype),"_init",this).call(this,e),this.alwaysSelectFirstDay=e.alwaysSelectFirstDay}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("year-panel-container"),this.$yearTitle=this.$container.appendDiv("year-panel-title"),this.$yearList=this.$container.appendDiv("year-panel-list")}},{key:"renderContent",value:function(){this.removeContent(),this._drawYear(),this._installScrollbars({axis:"y"}),this.yearRendered=!0,this._colorYear()}},{key:"get$Scrollable",value:function(){return this.$yearList}},{key:"removeContent",value:function(){this._uninstallScrollbars(),this.$yearList.empty(),this.yearRendered=!1}},{key:"_remove",value:function(){this.removeContent(),kk(Ck(o.prototype),"_remove",this).call(this)}},{key:"_drawYear",value:function(){var e,t,n,i,r,o,a=this.selectedDate.getFullYear();for(this.$yearTitle.data("year",a).empty(),this.$yearTitle.appendDiv("year-title-item",a-1).data("year-diff",-1).click(this._onYearClick.bind(this)),this.$yearTitle.appendDiv("year-title-item selected",a),this.$yearTitle.appendDiv("year-title-item",a+1).data("year-diff",1).click(this._onYearClick.bind(this)),t=0;t<12;t++)for(e=new Date(a,t,1),n=this.$yearList.appendDiv("year-month").attr("data-title",this._format(e,"MMMM")),i=1;i<=31&&(r=new Date(a,t,i)).getMonth()===t;i++)o=n.appendDiv("year-day",i).data("date",r),0!==r.getDay()&&6!==r.getDay()||o.addClass("weekend"),1===i&&o.css("margin-left",(r.getDay()+6)%7*o.outerWidth());s()(".year-day",this.$yearList).click(this._onYearDayClick.bind(this)).hover(this._onYearHoverIn.bind(this),this._onYearHoverOut.bind(this)),wf.update(this.$yearList)}},{key:"_colorYear",value:function(){if(this.yearRendered){s()(".year-day.year-range, .year-day.year-range-day",this.$yearList).removeClass("year-range year-range-day");var e,t,n=this;s()(".year-day",this.$yearList).each((function(){e=s()(this),t=e.data("date"),n.displayMode!==Tw.DisplayMode.DAY&&t>=n.viewRange.from&&t<n.viewRange.to&&e.addClass("year-range"),wt.isSameDay(t,n.selectedDate)&&e.addClass("year-range-day")})),this._scrollYear()}}},{key:"_scrollYear",value:function(){var e,t,n,i=s()(".year-range-day",this.$yearList),r=i.parent(),o=i.parent().parent();r[0]&&(e=r[0].offsetTop,t=r.outerHeight()/2,n=o.outerHeight()/2,this.$yearList.animateAVCSD("scrollTop",e+t-n))}},{key:"_format",value:function(e,t){return wt.format(e,this.session.locale,t)}},{key:"selectDate",value:function(e){this.selectedDate=e,this.rendered&&(e&&e.getFullYear()===this.$yearTitle.data("year")||this.renderContent(),this._colorYear())}},{key:"setDisplayMode",value:function(e){e!==this.displayMode&&(this._setProperty("displayMode",e),this.rendered&&this._colorYear())}},{key:"setViewRange",value:function(e){e!==this.viewRange&&(this._setProperty("viewRange",e),this.rendered&&this._colorYear())}},{key:"_onYearClick",value:function(e){var t,n=Lk.DisplayMode,i=s()(e.target).data("year-diff"),r=this.selectedDate.getFullYear(),o=this.selectedDate.getMonth(),a=this.selectedDate.getDate(),u=new Date(r+i,o,a);this.alwaysSelectFirstDay&&(O.isOneOf(this.displayMode,n.WEEK,n.WORK_WEEK,n.CALENDAR_WEEK)?(t=wt.weekInYear(this.selectedDate)-wt.weekInYear(u),u=wt.shift(u,0,0,7*t),u=wt.shiftToNextOrPrevMonday(u,0)):O.isOneOf(this.displayMode,n.MONTH,n.YEAR)&&(u=new Date(r+i,o,1))),this.selectedDate=u,this.trigger("dateSelect",{date:this.selectedDate})}},{key:"_onYearDayClick",value:function(e){this.selectedDate=s()(".year-hover-day",this.$yearList).data("date"),this.selectedDate&&this.trigger("dateSelect",{date:this.selectedDate})}},{key:"_onYearHoverIn",value:function(e){var t,n,i,r,o=s()(e.target).data("date"),a=o.getFullYear(),u=o.getMonth(),l=o.getDate(),c=(o.getDay()+6)%7;this.displayMode===Tw.DisplayMode.DAY?(t=new Date(a,u,l),n=new Date(a,u,l)):this.displayMode===Tw.DisplayMode.WEEK?(t=new Date(a,u,l-c),n=new Date(a,u,l-c+6)):this.displayMode===Tw.DisplayMode.WORK_WEEK?(t=new Date(a,u,l-c),n=new Date(a,u,l-c+4),o>n&&(o=n)):this.displayMode===Tw.DisplayMode.MONTH?(t=new Date(a,u,1),n=new Date(a,u+1,0)):this.displayMode===Lk.DisplayMode.YEAR?(t=new Date(a,u,1),n=t):(t=new Date(a,u,l-c),n=t),this.alwaysSelectFirstDay&&(o=t),s()(".year-day",this.$yearList).each((function(){i=s()(this),(r=i.data("date"))>=t&&r<=n?i.addClass("year-hover"):i.removeClass("year-hover"),wt.isSameDay(o,r)&&i.addClass("year-hover-day")}))}},{key:"_onYearHoverOut",value:function(e){s()(".year-day.year-hover, .year-day.year-hover-day",this.$yearList).removeClass("year-hover year-hover-day")}}])&&wk(t.prototype,n),i&&wk(t,i),o}(de);function Rk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var xk=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.widget=null,this.emptyMandatoryElementsTextKey=null,this.emptyMandatoryElementsText=null,this.invalidElementsTextKey=null,this.invalidElementsText=null,this.saveChangesQuestionTextKey=null,this.askIfNeedSave=!0,this.askIfNeedSaveText=null,this.events=new Yt,this.handlers={load:this._defaultLoad.bind(this),save:this._defaultSave.bind(this)}}var t,n,i;return t=e,(n=[{key:"init",value:function(e){O.assertParameter("widget",e.widget),s.a.extend(this,e),oi.isNullOrUndefined(this.emptyMandatoryElementsText)&&(this.emptyMandatoryElementsText=this.session().text(this.emptyMandatoryElementsTextKey)),oi.isNullOrUndefined(this.invalidElementsText)&&(this.invalidElementsText=this.session().text(this.invalidElementsTextKey)),oi.isNullOrUndefined(this.askIfNeedSaveText)&&(this.askIfNeedSaveText=this.session().text(this.saveChangesQuestionTextKey))}},{key:"load",value:function(){return this._load().then(function(){this.markAsSaved(),this.events.trigger("postLoad")}.bind(this))}},{key:"_load",value:function(){return this.handlers.load().then(function(e){this.events.trigger("load")}.bind(this))}},{key:"_defaultLoad",value:function(){return s.a.resolvedPromise()}},{key:"ok",value:function(){return this._whenInvalid(this._validate).then(function(e){if(!e)return this.requiresSave()?this._whenInvalid(this._save).then(function(e){if(!e)return this.markAsSaved(),this.close()}.bind(this)):this.close()}.bind(this))}},{key:"cancel",value:function(){return this.requiresSave()&&this.askIfNeedSave?this._showYesNoCancelMessageBox(this.askIfNeedSaveText,this.ok.bind(this),this.close.bind(this)):this.close()}},{key:"reset",value:function(){return this._reset(),this.load().then(function(){this.events.trigger("reset")}.bind(this))}},{key:"close",value:function(){return this._close()}},{key:"_close",value:function(){return this.events.trigger("close"),s.a.resolvedPromise()}},{key:"save",value:function(){return this._whenInvalid(this._validate).then(function(e){if(!e&&this.requiresSave())return this._whenInvalid(this._save).then(function(e){e||this.markAsSaved()}.bind(this))}.bind(this))}},{key:"_save",value:function(){return this.handlers.save().then(function(e){return this.events.trigger("save"),e}.bind(this))}},{key:"_defaultSave",value:function(){return s.a.resolvedPromise()}},{key:"markAsSaved",value:function(){}},{key:"requiresSave",value:function(){return!1}},{key:"setAskIfNeedSave",value:function(e){this.askIfNeedSave=e}},{key:"_whenInvalid",value:function(e){return e.call(this).then(function(e){return e&&e.severity!==pi.Severity.OK?this._showStatusMessageBox(e):s.a.resolvedPromise(!1)}.bind(this)).catch(function(e){return this._showStatusMessageBox(function(e){return e instanceof pi?e:"string"==typeof e?pi.error({message:e}):pi.error({message:e.message})}(e))}.bind(this))}},{key:"_showYesNoCancelMessageBox",value:function(e,t,n){return mz.create(this.widget).withSeverity(pi.Severity.WARNING).withHeader(e).withYes().withNo().withCancel().buildAndOpen().then((function(e){return e===az.Buttons.YES?t():e===az.Buttons.NO?n():s.a.resolvedPromise()}))}},{key:"_showStatusMessageBox",value:function(e){return mz.createOk(this.widget).withSeverity(e.severity).withBody(e.message,!0).buildAndOpen().then((function(){var t=e.severity===pi.Severity.ERROR;return s.a.resolvedPromise(t)}))}},{key:"_validate",value:function(){var e=this._validateElements();return e.isValid()&&(e=this._validateWidget()),s.a.resolvedPromise(e)}},{key:"_validateElements",value:function(){var e=this._invalidElements(),t=new pi;return 0===e.missingElements.length&&0===e.invalidElements.length?t.severity=pi.Severity.OK:(t.severity=pi.Severity.ERROR,t.message=this._createInvalidElementsMessageHtml(e.missingElements,e.invalidElements)),t}},{key:"_validateWidget",value:function(){return pi.ok()}},{key:"_invalidElements",value:function(){return{missingElements:[],invalidElements:[]}}},{key:"_createInvalidElementsMessageHtml",value:function(e,t){var n=s()("<div>"),i=e.length>0,r=t.length>0;return i&&o.call(this,n,this.emptyMandatoryElementsText,e,this._missingElementText),i&&r&&n.appendElement("<br>"),r&&o.call(this,n,this.invalidElementsText,t,this._invalidElementText),n.html();function o(e,t,n,i){e.appendElement("<strong>").text(t);var r=e.appendElement("<ul>");n.forEach((function(e){r.appendElement("<li>").text(i.call(this,e))}),this)}}},{key:"_invalidElementText",value:function(e){return""}},{key:"_missingElementText",value:function(e){return""}},{key:"session",value:function(){return this.widget.session}},{key:"handle",value:function(e,t){if(-1===["load","save"].indexOf(e))throw new Error("Cannot register handler for unsupported type '"+e+"'");this.handlers[e]=t}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){return this.events.off(e,t)}}])&&Rk(t.prototype,n),i&&Rk(t,i),e}();function Ek(e){return(Ek="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fk(e,t,n){return(Fk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mk(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ak(e,t){return(Ak=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Mk(e);if(t){var r=Mk(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jk(this,n)}}function jk(e,t){return!t||"object"!==Ek(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mk(e){return(Mk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ik(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ak(e,t)}(o,e);var t,n,i,r=$k(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).activityMap=[],e.activitySelectable=!1,e.availableDisplayModes=[],e.displayMode=null,e.displayModeOptions={},e.headerVisible=!0,e.label=null,e.resources=[],e.resourceMap=[],e.selectionMode=o.SelectionMode.MULTI_RANGE,e.selectionRange=new mk,e.selectedResources=[],e.viewRange={},e.selectedActivity=null,e._resourceTitleWidth=20,e._rangeSelectionStarted=!1,e.startRow=null,e.lastRow=null,e.$container=null,e.$range=null,e.$modes=null,e.$grid=null,e.transformLeft=function(e){return e},e.transformWidth=function(e,t){return t-e},e.yearPanelVisible=!1,e._addWidgetProperties(["menus"]),e}return t=o,(n=[{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_init",value:function(e){Fk(Mk(o.prototype),"_init",this).call(this,e),this._yearPanel=O.create("YearPanel",{parent:this,alwaysSelectFirstDay:!0}),this._yearPanel.on("dateSelect",this._onYearPanelDateSelect.bind(this)),this._header=O.create("PlannerHeader",{parent:this}),this._header.on("todayClick",this._onTodayClick.bind(this)),this._header.on("yearClick",this._onYearClick.bind(this)),this._header.on("previousClick",this._onPreviousClick.bind(this)),this._header.on("nextClick",this._onNextClick.bind(this)),this._header.on("displayModeClick",this._onDisplayModeClick.bind(this)),this.menuBar=O.create("MenuBar",{parent:this,position:O_.Position.BOTTOM,menuOrder:new hS(this.session,"Planner")});for(var t=0;t<this.resources.length;t++)this._initResource(this.resources[t]);this._setDisplayMode(this.displayMode),this._setAvailableDisplayModes(this.availableDisplayModes),this._setViewRange(this.viewRange),this._setSelectedResources(this.selectedResources),this._setSelectedActivity(this.selectedActivity),this._setSelectionRange(this.selectionRange),this._setMenus(this.menus),this._setDisplayModeOptions(this.displayModeOptions),this._tooltipSupport=new fh({parent:this,arrowPosition:50})}},{key:"_initResource",value:function(e){Pt.applyTo(e,"Resource"),e.activities.forEach((function(e){this._initActivity(e)}),this),this.resourceMap[e.id]=e}},{key:"_initActivity",value:function(e){e.beginTime=wt.parseJsonDate(e.beginTime),e.endTime=wt.parseJsonDate(e.endTime),Pt.applyTo(e,"Activity"),this.activityMap[e.id]=e}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("planner");var e=new sS(this);this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(e),this._header.render(),this._yearPanel.render(),this.$grid=this.$container.appendDiv("planner-grid").on("mousedown",".resource-cells",this._onCellMouseDown.bind(this)).on("mousedown",".resource-title",this._onResourceTitleMouseDown.bind(this)).on("contextmenu",".resource-title",this._onResourceTitleContextMenu.bind(this)).on("contextmenu",".planner-activity",this._onActivityContextMenu.bind(this)),this.$scale=this.$container.appendDiv("planner-scale"),this.menuBar.render(),dh.install(this.$grid,{parent:this,selector:".planner-activity",text:function(e){if(this._activityById(e.attr("data-id")))return this._activityById(e.attr("data-id")).tooltipText}.bind(this)}),this._installScrollbars(),this._gridScrollHandler=this._onGridScroll.bind(this),this.$grid.on("scroll",this._gridScrollHandler)}},{key:"_renderProperties",value:function(){Fk(Mk(o.prototype),"_renderProperties",this).call(this),this._renderViewRange(),this._renderHeaderVisible(),this._renderYearPanelVisible(!1),this._renderResources(),this._renderSelectedActivity(),this._renderSelectedResources(),setTimeout(this._renderSelectionRange.bind(this))}},{key:"get$Scrollable",value:function(){return this.$grid}},{key:"_onPreviousClick",value:function(e){this._navigateDate(o.Direction.BACKWARD)}},{key:"_onNextClick",value:function(e){this._navigateDate(o.Direction.FORWARD)}},{key:"_navigateDate",value:function(e){var t=new mk(this.viewRange.from,this.viewRange.to),n=o.DisplayMode;this.displayMode===n.DAY?(t.from=wt.shift(this.viewRange.from,0,0,e),t.to=wt.shift(this.viewRange.to,0,0,e)):O.isOneOf(this.displayMode,n.WEEK,n.WORK_WEEK)?(t.from=wt.shift(this.viewRange.from,0,0,7*e),t.from=wt.ensureMonday(t.from,-1*e),t.to=wt.shift(this.viewRange.to,0,0,7*e)):this.displayMode===n.MONTH||this.displayMode===n.CALENDAR_WEEK?(t.from=wt.shift(this.viewRange.from,0,e,0),t.from=wt.ensureMonday(t.from,-1*e),t.to=wt.shift(this.viewRange.to,0,e,0)):this.displayMode===n.YEAR&&(t.from=wt.shift(this.viewRange.from,0,3*e,0),t.to=wt.shift(this.viewRange.to,0,3*e,0)),this.setViewRange(t)}},{key:"_onTodayClick",value:function(e){var t=new Date,n=t.getFullYear(),i=t.getMonth(),r=t.getDate(),s=(t.getDay()+6)%7,a=o.DisplayMode;t=this.displayMode===a.DAY?new Date(n,i,r):this.displayMode===a.YEAR?new Date(n,i,1):new Date(n,i,r-s),this.setViewRangeFrom(t)}},{key:"_onDisplayModeClick",value:function(e){var t=e.displayMode;this.setDisplayMode(t)}},{key:"_onYearClick",value:function(e){this.setYearPanelVisible(!this.yearPanelVisible)}},{key:"_onYearPanelDateSelect",value:function(e){this.setViewRangeFrom(e.date)}},{key:"_onResourceTitleMouseDown",value:function(e){var t=s()(e.target).parent();t.isSelected()&&(3===e.which||1===e.which&&e.ctrlKey)||(this.startRow=t.data("resource"),this.lastRow=this.startRow,this._select())}},{key:"_onResourceTitleContextMenu",value:function(e){this._showContextMenu(e,"Planner.Resource")}},{key:"_onRangeSelectorContextMenu",value:function(e){this._showContextMenu(e,"Planner.Range")}},{key:"_onActivityContextMenu",value:function(e){this._showContextMenu(e,"Planner.Activity")}},{key:"_showContextMenu",value:function(e,t){e.preventDefault(),e.stopPropagation();var n=function(e,t){if(this.rendered&&this.attached){var n=this._filterMenus([t],!0),i=s()(e.currentTarget);0!==n.length&&O.create("ContextMenuPopup",{parent:this,menuItems:n,location:{x:e.pageX,y:e.pageY},$anchor:i}).open()}}.bind(this);this.session.onRequestsDone(n,e,t)}},{key:"_onGridScroll",value:function(){this._reconcileScrollPos()}},{key:"_reconcileScrollPos",value:function(){var e=this.$grid.scrollLeft();this.$scale.scrollLeft(e)}},{key:"_renderRange",value:function(){if(this.viewRange.from&&this.viewRange.to){var e,t=new Date(this.viewRange.to.valueOf()-1),n=this.session.text("ui.to"),i=o.DisplayMode;e=wt.isSameDay(this.viewRange.from,t)?this._dateFormat(this.viewRange.from,"d. MMMM yyyy"):this.viewRange.from.getMonth()===t.getMonth()&&this.viewRange.from.getFullYear()===t.getFullYear()?En.join(" ",this._dateFormat(this.viewRange.from,"d."),n,this._dateFormat(t,"d. MMMM yyyy")):this.viewRange.from.getFullYear()===t.getFullYear()?this.displayMode===i.YEAR?En.join(" ",this._dateFormat(this.viewRange.from,"MMMM"),n,this._dateFormat(t,"MMMM yyyy")):En.join(" ",this._dateFormat(this.viewRange.from,"d.  MMMM"),n,this._dateFormat(t,"d. MMMM yyyy")):this.displayMode===i.YEAR?En.join(" ",this._dateFormat(this.viewRange.from,"MMMM yyyy"),n,this._dateFormat(t,"MMMM yyyy")):En.join(" ",this._dateFormat(this.viewRange.from,"d.  MMMM yyyy"),n,this._dateFormat(t,"d. MMMM yyyy")),s()(".planner-select",this._header.$range).text(e)}}},{key:"_renderScale",value:function(){if(this.viewRange.from&&this.viewRange.to){var e,t=this,n=o.DisplayMode;this.$scale.empty(),this.$grid.children(".planner-small-scale-item-line").remove(),this.$grid.children(".planner-large-scale-item-line").remove(),this.$scaleTitle=this.$scale.appendDiv("planner-scale-title"),this._renderLabel(),this.$timeline=this.$scale.appendDiv("timeline"),this.$timelineLarge=this.$timeline.appendDiv("timeline-large"),this.$timelineSmall=this.$timeline.appendDiv("timeline-small"),this.displayMode===n.DAY?this._renderDayScale():O.isOneOf(this.displayMode,n.WORK_WEEK,n.WEEK)?this._renderWeekScale():this.displayMode===n.MONTH?this._renderMonthScale():this.displayMode===n.CALENDAR_WEEK?this._renderCalendarWeekScale():this.displayMode===n.YEAR&&this._renderYearScale();var i,r,a,u,l=this.$timelineSmall.children(".scale-item"),c=this.$timelineLarge.children(".scale-item");if(e=100/l.length,c.each((function(){var n=s()(this),i=t.$grid.prependDiv("planner-large-scale-item-line");n.css("width",n.data("count")*e+"%").data("scale-item-line",i),n.prependDiv("planner-large-scale-item-line").css("left",0)})),l.each((function(n){var i=s()(this);if(i.css("width",e+"%"),!i.data("first")){var r=t.$grid.prependDiv("planner-small-scale-item-line");i.data("scale-item-line",r),i.prependDiv("planner-small-scale-item-line").css("left",0)}})),this.beginScale=this.$timelineSmall.children().first().data("date-from").valueOf(),this.endScale=this.$timelineSmall.children().last().data("date-to").valueOf(),O.isOneOf(this.displayMode,n.WORK_WEEK,n.WEEK)){var f=this.displayModeOptions[this.displayMode],h=(f.interval,f.firstHourOfDay),d=f.lastHourOfDay;this.transformLeft=(i=this.viewRange.from,r=this.viewRange.to,a=h,u=d,function(e){e=new Date(e),i=new Date(i);var t=(r=new Date(r))-i,n=wt.compareDays(e,i),o=wt.compareDays(r,i),s=36e5*n*24,l=24/(u-a+1),c=n/o;return e.getHours()<a?100*(l/t+c):e.getHours()>u?100*(l/t+(c=(n+1)/o)):100*((e.valueOf()-(i.valueOf()+36e5*a)-s)*l/t+c)}),this.transformWidth=function(e,t,n,i,r){return function(r,o){var s=t-e,a=new fi(new Date(r),new Date(o)),u=this._findHiddenRangesInWeekMode();return a.subtractAll(u).reduce((function(e,t){return e+t.size()}),0)*(24/(i-n+1))/s*100}}(this.viewRange.from,this.viewRange.to,h,d)}else this.transformLeft=function(e,t){return function(n){return(n-e)/(t-e)*100}}(this.beginScale,this.endScale),this.transformWidth=function(e,t){return function(n,i){return(i-n)/(t-e)*100}}(this.beginScale,this.endScale)}}},{key:"_findHiddenRangesInWeekMode",value:function(){if(!O.isOneOf(this.displayMode,o.DisplayMode.WORK_WEEK,o.DisplayMode.WEEK))return[];for(var e,t=[],n=this.displayModeOptions[this.displayMode],i=n.firstHourOfDay,r=n.lastHourOfDay,s=new Date(this.viewRange.from.valueOf());s<this.viewRange.to;)(e=new fi(new Date(s.valueOf()),wt.shiftTime(s,i))).size()>0&&t.push(e),(e=new fi(wt.shiftTime(s,r+1),wt.shiftTime(s,24))).size()>0&&t.push(e),s.setHours(0),s.setMinutes(0),s.setDate(s.getDate()+1);return t}},{key:"_renderDayScale",value:function(){var e,t,n,i=!0,r=new Date(this.viewRange.from.valueOf()),o=this.displayModeOptions[this.displayMode],s=o.interval,a=o.labelPeriod,u=o.firstHourOfDay,l=o.lastHourOfDay;for(s=Math.min(s,60*(l-u+1));r<this.viewRange.to;)r.getHours()>=u&&r.getHours()<=l?(e=!1,(0===r.getMinutes()||i)&&(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"HH")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(r,":mm")).data("date-from",new Date(r.valueOf())),r.getMinutes()%(s*a)!=0&&n.addClass("label-invisible"),r=wt.shiftTime(r,0,s,0),this._incrementTimelineScaleItems(t,n,r,e),i=!1):r=wt.shiftTime(r,0,s,0)}},{key:"_renderWeekScale",value:function(){var e,t,n,i=!0,r=new Date(this.viewRange.from.valueOf()),o=this.displayModeOptions[this.displayMode],s=o.interval,a=o.labelPeriod,u=o.firstHourOfDay,l=o.lastHourOfDay;for(s=Math.min(s,60*(l-u+1));r<this.viewRange.to;)e=!1,r.getHours()<u&&r.setHours(u),(r.getHours()===u&&0===r.getMinutes()||i)&&(t=0===r.getMonth()||i?this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"d. MMMM yyyy")).data("count",0):1===r.getDate()?this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"d. MMMM")).data("count",0):this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"d.")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(r,"HH:mm")).data("date-from",new Date(r.valueOf())),(60*(r.getHours()-u)+r.getMinutes())%(s*a)!=0&&n.addClass("label-invisible"),r=wt.shiftTime(r,0,s,0,0),this._incrementTimelineScaleItems(t,n,r,e),i=!1,r.getHours()>l&&(r.setHours(0),r.setMinutes(0),r.setDate(r.getDate()+1))}},{key:"_renderMonthScale",value:function(){for(var e,t,n,i=!0,r=new Date(this.viewRange.from.valueOf()),o=this.displayModeOptions[this.displayMode].labelPeriod;r<this.viewRange.to;)e=!1,(1===r.getDate()||i)&&(t=0===r.getMonth()||i?this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"MMMM yyyy")).data("count",0):this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"MMMM")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(r,"dd")).data("date-from",new Date(r.valueOf())),r.getDate()%o!=0&&n.addClass("label-invisible"),r=wt.shift(r,0,0,1),this._incrementTimelineScaleItems(t,n,r,e),i=!1}},{key:"_renderCalendarWeekScale",value:function(){for(var e,t,n,i=!0,r=new Date(this.viewRange.from.valueOf()),o=this.displayModeOptions[this.displayMode].labelPeriod;r<this.viewRange.to;)e=!1,(r.getDate()<8||!0===i)&&(0===r.getMonth()||!0===i?r.getDate()>11?(t=this.$timelineLarge.appendDiv("scale-item").html("&nbsp;").data("count",0),i=2):(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"MMMM yyyy")).data("count",0),i=!1):2===i?(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"MMMM yyyy")).data("count",0),i=!1):t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"MMMM")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",wt.weekInYear(r)).data("date-from",new Date(r.valueOf())).data("tooltipText",this._scaleTooltipText.bind(this)),this._tooltipSupport.install(n),wt.weekInYear(r)%o!=0&&n.addClass("label-invisible"),r.setDate(r.getDate()+7),this._incrementTimelineScaleItems(t,n,r,e)}},{key:"_renderYearScale",value:function(){for(var e,t,n,i=!0,r=new Date(this.viewRange.from.valueOf()),o=this.displayModeOptions[this.displayMode].labelPeriod;r<this.viewRange.to;)e=!1,(0===r.getMonth()||i)&&(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(r,"yyyy")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(r,"MMMM")).data("date-from",new Date(r.valueOf())),r.getMonth()%o!=0&&n.addClass("label-invisible"),r=wt.shift(r,0,1,0),this._incrementTimelineScaleItems(t,n,r,e),i=!1}},{key:"_incrementTimelineScaleItems",value:function(e,t,n,i){e.data("count",e.data("count")+1),t.data("date-to",new Date(n.valueOf())).data("first",i)}},{key:"_scaleTooltipText",value:function(e){var t=" "+this.session.text("ui.to")+" ",n=new Date(e.data("date-from").valueOf()),i=new Date(e.data("date-to").valueOf()-1);return n.getMonth()===i.getMonth()?this._dateFormat(n,"d.")+t+this._dateFormat(i,"d. MMMM yyyy"):n.getFullYear()===i.getFullYear()?this._dateFormat(n,"d. MMMM")+t+this._dateFormat(i,"d. MMMM yyyy"):this._dateFormat(n,"d. MMMM yyyy")+t+this._dateFormat(i,"d. MMMM yyyy")}},{key:"_removeAllResources",value:function(){this.resources.forEach((function(e){e.$resource.remove()}))}},{key:"_renderResources",value:function(e){var t,n,i="";for(e=e||this.resources,t=0;t<e.length;t++)n=e[t],i+=this._buildResourceHtml(n,this.$grid);s()(i).appendTo(this.$grid),this.$grid.children(".planner-resource").each(function(e,t){var i=s()(t);n=this._resourceById(i.attr("data-id")),this._linkResource(i,n),this._linkActivitiesForResource(n)}.bind(this))}},{key:"_linkResource",value:function(e,t){e.data("resource",t),t.$resource=e,t.$cells=e.children(".resource-cells")}},{key:"_linkActivity",value:function(e,t){e.data("activity",t),t.$activity=e}},{key:"_rerenderActivities",value:function(e){(e=e||this.resources).forEach((function(e){this._removeActivitiesForResource(e),this._renderActivititesForResource(e)}),this)}},{key:"_buildResourceHtml",value:function(e){var t='<div class="planner-resource" data-id="'+e.id+'">';return t+='<div class="resource-title">'+En.encode(e.resourceCell.text||"")+"</div>",t+='<div class="resource-cells">'+this._buildActivitiesHtml(e)+"</div>",t+="</div>"}},{key:"_renderActivititesForResource",value:function(e){e.$cells.html(this._buildActivitiesHtml(e)),this._linkActivitiesForResource(e)}},{key:"_linkActivitiesForResource",value:function(e){e.$cells.children(".planner-activity").each(function(e,t){var n=s()(t),i=this._activityById(n.attr("data-id"));this._linkActivity(n,i)}.bind(this))}},{key:"_buildActivitiesHtml",value:function(e){var t="";return e.activities.forEach((function(e){e.beginTime.valueOf()>=this.endScale||e.endTime.valueOf()<=this.beginScale||(t+=this._buildActivityHtml(e))}),this),t}},{key:"_removeActivitiesForResource",value:function(e){e.activities.forEach((function(e){e.$activity&&(e.$activity.remove(),e.$activity=null)}),this)}},{key:"_buildActivityHtml",value:function(e){var t=100-Math.min(100*e.level,100),n=$i.modelToCssColor(e.backgroundColor),i=$i.modelToCssColor(e.foregroundColor),r=$i.modelToCssColor(e.levelColor),o=e.beginTime.valueOf(),s=e.endTime.valueOf();o=Math.max(o,this.beginScale),s=Math.min(s,this.endScale);var a="planner-activity"+(e.cssClass?" "+e.cssClass:""),u="left: calc("+this.transformLeft(o)+"% + 2px);";u+=" width: calc("+this.transformWidth(o,s)+"% - 4px);",r&&(u+=" background-color: "+r+";",u+=" border-color: "+r+";"),!r&&n&&(u+=" background-color: "+n+";",u+=" border-color: "+n+";"),i&&(u+=" color: "+i+";");var l="planner-activity-level"+(e.cssClass?" "+e.cssClass:""),c=$i.get(l,"background-color").backgroundColor,f="<div";return f+=' class="'+a+'"',f+=' style="'+(u+=" background-image: linear-gradient(to bottom, "+c+" 0%, "+c+" "+t+"%, transparent "+t+"%, transparent 100% );")+'"',f+=' data-id="'+e.id+'"',f+=">"+En.encode(e.text||"")+"</div>"}},{key:"_onCellMouseDown",value:function(e){var t,n,i=s()(e.target),r=o.SelectionMode,a=3===e.which||1===e.which&&e.ctrlKey;this.activitySelectable?(!a&&this.$selector&&this.$selector.hide(),t=this.$grid.elementFromPoint(e.pageX,e.pageY),!a&&this.$selector&&this.$selector.show(),t.hasClass("planner-activity")?(n=t.parent().parent(),this.selectResources([n.data("resource")]),this.selectActivity(t.data("activity")),this.selectRange(new mk)):this.selectActivity(null)):this.selectActivity(null),this.selectionMode!==r.NONE&&(i.hasClass("selector")&&a||(this.selectedActivity||this._startRangeSelection(e.pageX,e.pageY),this._cellMousemoveHandler=this._onCellMousemove.bind(this,e),i.document().on("mousemove",this._cellMousemoveHandler).one("mouseup",this._onDocumentMouseUp.bind(this))))}},{key:"_startRangeSelection",value:function(e,t){this.startRow=this._findRow(t),this.lastRow=this.startRow,this.startRange=this._findScale(e),this.lastRange=this.startRange,this._select(!0),this._rangeSelectionStarted=!0}},{key:"_prepareRangeSelectionByMousemove",value:function(e,t){var n=e.pageX-t.pageX,i=e.pageY-t.pageY,r=o.RANGE_SELECTION_MOVE_THRESHOLD;if(Math.abs(n)>=r)return!0;var s=this._findRow(e.pageY),a=this._findRow(t.pageY);return Math.abs(i)>=r&&this.selectionMode===o.SelectionMode.MULTI_RANGE&&s!==a}},{key:"_onCellMousemove",value:function(e,t){if(this.selectedActivity&&!this._rangeSelectionStarted){if(!this._prepareRangeSelectionByMousemove(e,t))return;this._startRangeSelection(e.pageX,e.pageY)}var n=this._findRow(t.pageY);n&&(this.lastRow=n);var i=this._findScale(t.pageX);i&&(this.lastRange=i),this._select(!0)}},{key:"_onResizeMouseDown",value:function(e){var t,n=s()(e.target);return this.startRow=this.selectedResources[0],this.lastRow=this.selectedResources[this.selectedResources.length-1],this.startRange=O.nvl(this._findScaleByFromDate(this.selectionRange.from),new fi(this.selectionRange.from.getTime(),this.selectionRange.from.getTime())),this.lastRange=O.nvl(this._findScaleByToDate(this.selectionRange.to),new fi(this.selectionRange.to.getTime(),this.selectionRange.to.getTime())),n.hasClass("selector-resize-left")&&(t=this.startRange,this.startRange=this.lastRange,this.lastRange=t),n.body().addClass("col-resize"),this._resizeMousemoveHandler=this._onResizeMousemove.bind(this),n.document().on("mousemove",this._resizeMousemoveHandler).one("mouseup",this._onDocumentMouseUp.bind(this)),!1}},{key:"_onResizeMousemove",value:function(e){if(this.rendered){var t=this._findScale(e.pageX);t&&(this.lastRange=t),this._select(!0)}}},{key:"_onDocumentMouseUp",value:function(e){var t=s()(e.target);t.body().removeClass("col-resize"),this._cellMousemoveHandler&&(t.document().off("mousemove",this._documentMousemoveHandler),this._cellMousemoveHandler=null),this._resizeMousemoveHandler&&(t.document().off("mousemove",this._resizeMousemoveHandler),this._resizeMousemoveHandler=null),this._rangeSelectionStarted&&(this._rangeSelectionStarted=!1,this.rendered&&this._select())}},{key:"_select",value:function(e){if(this.startRow&&this.lastRow){var t=!(!this.startRange||!this.lastRange),n=this.startRow.$resource,i=this.lastRow.$resource;this.selectionMode===o.SelectionMode.SINGLE_RANGE&&(this.lastRow=this.startRow,i=this.startRow.$resource);for(var r=n[0].offsetTop<=i[0].offsetTop?n:i,a=n[0].offsetTop>i[0].offsetTop?n:i,u=s()(".planner-resource",this.$grid).toArray(),l=r[0].offsetTop,c=a[0].offsetTop,f=u.length-1;f>=0;f--){var h=u[f];(h.offsetTop<l&&h.offsetTop<c||h.offsetTop>l&&h.offsetTop>c)&&u.splice(f,1)}if(this.selectResources(u.map((function(e){return s()(e).data("resource")})),!e),this.selectActivity(null),t){var d=Math.min(this.lastRange.from,this.startRange.from),p=Math.max(this.lastRange.to,this.startRange.to),y=new mk(new Date(d),new Date(p));y=this._adjustSelectionRange(y),this.selectRange(y,!e)}}}},{key:"_adjustSelectionRange",value:function(e){var t=e.from.getTime(),n=e.to.getTime(),i=0,r=this.displayModeOptions[this.displayMode];r.interval>0&&r.minSelectionIntervalCount>0&&(i=r.minSelectionIntervalCount*r.interval*6e4);var o=r.lastHourOfDay,s=wt.shiftTime(wt.trunc(e.from),o+1),a=this._visibleViewRange();return this.lastRange.from<this.startRange.from?n-i>=a.from.getTime()?t=Math.min(t,n-i):(t=a.from.getTime(),n=Math.max(n,Math.min(t+i,a.to.getTime()))):t+i<=a.to.getTime()?(n=Math.max(n,Math.max(t+i,a.from.getTime())))>=s.getTime()&&new fi(t,n).size()===i&&(n=s.getTime(),t=Math.min(t,n-i)):(n=a.to.getTime(),t=Math.min(t,n-i)),new mk(new Date(t),new Date(n))}},{key:"_findRow",value:function(e){var t,n=No.offsetBounds(this.$grid),i=n.x+10;return e=Math.min(Math.max(e,0),n.y+n.height-1),(t=this.$container.elementFromPoint(i,e,".planner-resource")).length>0?t.data("resource"):null}},{key:"_findScale",value:function(e){var t,n=No.offsetBounds(this.$grid),i=this.$scale.offset().top+.75*this.$scale.height();return e=Math.min(Math.max(e,0),n.x+n.width-1),(t=this.$container.elementFromPoint(e,i,".scale-item")).length>0?new mk(t.data("date-from").valueOf(),t.data("date-to").valueOf()):null}},{key:"_findScaleByFromDate",value:function(e){return this._findScaleByFunction((function(t,n){if(s()(n).data("date-from").getTime()===e.getTime())return!0}))}},{key:"_findScaleByToDate",value:function(e){return this._findScaleByFunction((function(t,n){if(s()(n).data("date-to").getTime()===e.getTime())return!0}))}},{key:"_findScaleByFunction",value:function(e){var t=this.$timelineSmall.children(".scale-item").filter(e);return t.length?new mk(t.data("date-from").valueOf(),t.data("date-to").valueOf()):null}},{key:"_visibleViewRange",value:function(){var e=this.$timelineSmall.children(".scale-item");return new fi(e.first().data("date-from"),e.last().data("date-to"))}},{key:"_dateFormat",value:function(e,t){var n=new Date(e.valueOf());return new If(this.session.locale,t).format(n)}},{key:"_renderViewRange",value:function(){this._renderRange(),this._renderScale(),this.invalidateLayoutTree()}},{key:"_renderHeaderVisible",value:function(){this._header.setVisible(this.headerVisible),this.invalidateLayoutTree()}},{key:"_renderYearPanelVisible",value:function(e){var t;this.yearPanelVisible&&this._yearPanel.renderContent(),s()(".calendar-toggle-year",this.$modes).select(this.yearPanelVisible),t=this.yearPanelVisible?210:0,this._yearPanel.$container.animate({width:t},{duration:e?500:0,progress:this._onYearPanelWidthChange.bind(this),complete:this._afterYearPanelWidthChange.bind(this)})}},{key:"_onYearPanelWidthChange",value:function(){if(this._yearPanel.$container){var e=this._yearPanel.$container.outerWidth();this.$grid.css("width","calc(100% - "+e+"px)"),this.$scale.css("width","calc(100% - "+e+"px)"),this.revalidateLayout()}}},{key:"_afterYearPanelWidthChange",value:function(){this.yearPanelVisible||this._yearPanel.removeContent()}},{key:"_setMenus",value:function(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this._updateMenuBar()}},{key:"_updateMenuBar",value:function(){var e=this._filterMenus(["Planner.EmptySpace","Planner.Resource","Planner.Activity","Planner.Range"],!1,!0);this.menuBar.setMenuItems(e)}},{key:"_removeMenus",value:function(){}},{key:"_filterMenus",value:function(e,t,n){return(e=e||[]).indexOf("Planner.Resource")>-1&&0===this.selectedResources.length&&et.remove(e,"Planner.Resource"),e.indexOf("Planner.Activity")>-1&&!this.selectedActivity&&et.remove(e,"Planner.Activity"),e.indexOf("Planner.Range")>-1&&!this.selectionRange.from&&!this.selectionRange.to&&et.remove(e,"Planner.Range"),mb.filter(this.menus,e,t,n)}},{key:"setDisplayModeOptions",value:function(e){this.setProperty("displayModeOptions",e)}},{key:"_setDisplayModeOptions",value:function(e){e&&this._adjustHours(e),this.displayModeOptions=e}},{key:"_adjustHours",value:function(e){function t(e){return e<0?0:e>23?23:e}oi.values(e).forEach((function(e){e.firstHourOfDay&&(e.firstHourOfDay=t(e.firstHourOfDay)),e.lastHourOfDay&&(e.lastHourOfDay=t(e.lastHourOfDay))}))}},{key:"_renderDisplayModeOptions",value:function(){this._renderRange(),this._renderScale(),this._rerenderActivities(),this._select(),this.invalidateLayoutTree()}},{key:"_renderAvailableDisplayModes",value:function(){}},{key:"_renderDisplayMode",value:function(){}},{key:"_setViewRange",value:function(e){e=mk.ensure(e),this._setProperty("viewRange",e),this._yearPanel.setViewRange(this.viewRange),this._yearPanel.selectDate(this.viewRange.from)}},{key:"_setDisplayMode",value:function(e){this._setProperty("displayMode",e),this._yearPanel.setDisplayMode(this.displayMode),this._header.setDisplayMode(this.displayMode)}},{key:"_setAvailableDisplayModes",value:function(e){this._setProperty("availableDisplayModes",e),this._header.setAvailableDisplayModes(this.availableDisplayModes)}},{key:"_setSelectionRange",value:function(e){e=mk.ensure(e),this._setProperty("selectionRange",e),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_setSelectedResources",value:function(e){"string"==typeof e[0]&&(e=this._resourcesByIds(e)),this.rendered&&this._removeSelectedResources(),this._setProperty("selectedResources",e),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_removeSelectedResources",value:function(){this.selectedResources.forEach((function(e){e.$resource.select(!1)}))}},{key:"_renderSelectedResources",value:function(){this.selectedResources.forEach((function(e){e.$resource.select(!0)}))}},{key:"_renderActivitySelectable",value:function(){this.selectedActivity&&this.selectedActivity.$activity&&this.selectedActivity.$activity.toggleClass("selected",this.activitySelectable)}},{key:"_renderSelectionMode",value:function(){this.selectionMode===o.SelectionMode.NONE?this.$selector&&(this.$selector.remove(),this.$highlight.remove()):this._renderSelectionRange()}},{key:"_renderSelectionRange",value:function(){var e,t,n=this.selectionRange.from,i=this.selectionRange.to,r=this.selectedResources[0],o=this.selectedResources[this.selectedResources.length-1];if(this.$selector&&(this.$selector.remove(),this.$highlight.remove()),r&&o&&this.selectionRange.from&&this.selectionRange.to){e=r.$resource,t=o.$resource,n=Math.max(n,this.beginScale),i=Math.min(i,this.endScale);var s=e[0].offsetTop<=t[0].offsetTop?e:t;this.$selector=s.children(".resource-cells").appendDiv("selector"),this.$selector.cssHeight(e.outerHeight()+Math.abs(t[0].offsetTop-e[0].offsetTop));var a=this.$selector.appendDiv("selector-resize-left").mousedown(this._onResizeMouseDown.bind(this)),u=this.$selector.appendDiv("selector-resize-right").mousedown(this._onResizeMouseDown.bind(this));this.$selector.css("left","calc("+this.transformLeft(n)+"% - "+a.cssWidth()+"px)").css("width","calc("+this.transformWidth(n,i)+"% + "+(a.cssWidth()+u.cssWidth())+"px)").on("contextmenu",this._onRangeSelectorContextMenu.bind(this)),this.$highlight=this.$timelineSmall.prependDiv("highlight");var l=this.$selector.cssLeft()+a.cssWidth()+this.$scaleTitle.cssWidth(),c=this.$selector.cssWidth()-(a.cssWidth()+u.cssWidth());this.$highlight.cssLeft(l).cssWidth(c)}}},{key:"_setSelectedActivity",value:function(e){"string"==typeof e&&(e=this._activityById(e)),this.rendered&&this._removeSelectedActivity(),this._setProperty("selectedActivity",e),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_removeSelectedActivity",value:function(){this.selectedActivity&&this.selectedActivity.$activity&&this.selectedActivity.$activity.removeClass("selected")}},{key:"_renderSelectedActivity",value:function(){this.selectedActivity&&this.selectedActivity.$activity&&this.selectedActivity.$activity.addClass("selected")}},{key:"_renderLabel",value:function(){var e=this.label||"";this.$scaleTitle&&this.$scaleTitle.text(e)}},{key:"_resourcesByIds",value:function(e){return e.map(this._resourceById.bind(this))}},{key:"_activityById",value:function(e){return this.activityMap[e]}},{key:"_resourceById",value:function(e){return this.resourceMap[e]}},{key:"setDisplayMode",value:function(e){this.setProperty("displayMode",e),this.startRange=null,this.lastRange=null}},{key:"layoutYearPanel",value:function(){this.yearPanelVisible&&(wf.update(this._yearPanel.$yearList),this._yearPanel._scrollYear())}},{key:"setYearPanelVisible",value:function(e){this.yearPanelVisible!==e&&(this._setProperty("yearPanelVisible",e),this.rendered&&this._renderYearPanelVisible(!0))}},{key:"setViewRangeFrom",value:function(e){var t=this.viewRange.to.getTime()-this.viewRange.from.getTime(),n=new mk(this.viewRange.from,this.viewRange.to);n.from=e,n.to=new Date(e.getTime()+t),this.setViewRange(n)}},{key:"setViewRange",value:function(e){this.viewRange!==e&&(this._setViewRange(e),this.rendered&&(this._renderViewRange(),this._rerenderActivities(),this._renderSelectedActivity(),this.validateLayoutTree()))}},{key:"selectRange",value:function(e){e&&e.equals(this.selectionRange)||this.setProperty("selectionRange",e)}},{key:"selectActivity",value:function(e){this.setProperty("selectedActivity",e)}},{key:"selectResources",value:function(e){et.equals(e,this.selectedResources)||(e=(e=et.ensure(e)).slice(),this.setProperty("selectedResources",e),this.trigger("resourcesSelected",{resources:e}),this.rendered&&this._renderSelectionRange())}},{key:"deselectResources",value:function(e){var t=!1;e=et.ensure(e);var n=this.selectedResources.slice();return et.removeAll(n,e)&&(this.selectResources(n),t=!0),t}},{key:"insertResources",value:function(e){e.forEach(function(e){this._initResource(e),this.resources.push(e)}.bind(this)),this.rendered&&(this._renderResources(e),this.invalidateLayoutTree())}},{key:"deleteResources",value:function(e){this.deselectResources(e)&&this.selectRange(new mk),e.forEach(function(e){et.remove(this.resources,e),delete this.resourceMap[e.id],e.activities.forEach(function(e){delete this.activityMap[e.id]}.bind(this)),this.rendered&&(e.$resource.remove(),delete e.$resource)}.bind(this)),this.invalidateLayoutTree()}},{key:"deleteAllResources",value:function(){this.rendered&&(this._removeAllResources(),this.invalidateLayoutTree()),this.resources=[],this.resourceMap={},this.activityMap={},this.selectResources([]),this.selectRange(new mk)}},{key:"updateResources",value:function(e){e.forEach(function(e){var t=this.resourceMap[e.id];if(!t)throw new Error("Update event received for non existing resource. ResourceId: "+e.id);if(this._initResource(e),et.replace(this.resources,t,e),et.replace(this.selectedResources,t,e),this.rendered&&t.$resource){var n=s()(this._buildResourceHtml(e));t.$resource.replaceWith(n),n.css("min-width",t.$resource.css("min-width")),this._linkResource(n,e),this._linkActivitiesForResource(e)}}.bind(this))}}])&&Dk(t.prototype,n),i&&Dk(t,i),o}(de);function Bk(e){return(Bk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hk(e,t,n){return(Hk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gk(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Vk(e,t){return(Vk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Gk(e);if(t){var r=Gk(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return zk(this,n)}}function zk(e,t){return!t||"object"!==Bk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gk(e){return(Gk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Ik(Lk,"Direction",{BACKWARD:-1,FORWARD:1}),Ik(Lk,"DisplayMode",{DAY:1,WEEK:2,MONTH:3,WORK_WEEK:4,CALENDAR_WEEK:5,YEAR:6}),Ik(Lk,"SelectionMode",{NONE:0,SINGLE_RANGE:1,MULTI_RANGE:2}),Ik(Lk,"RANGE_SELECTION_MOVE_THRESHOLD",10);var Uk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vk(e,t)}(o,e);var t,n,i,r=Wk(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["displayMode","viewRange","selectionRange","selectedActivity"]),e}return t=o,(n=[{key:"_sendViewRange",value:function(e){this._send("property",{viewRange:wt.toJsonDateRange(e)})}},{key:"_sendSelectedActivity",value:function(){var e=null;this.widget.selectedActivity&&(e=this.widget.selectedActivity.id),this._send("property",{selectedActivity:e})}},{key:"_sendSelectionRange",value:function(){var e=wt.toJsonDateRange(this.widget.selectionRange);this._send("property",{selectionRange:e})}},{key:"_onWidgetResourcesSelected",value:function(e){this._sendResourcesSelected()}},{key:"_sendResourcesSelected",value:function(){var e=this.widget.selectedResources.map((function(e){return e.id}));this._send("resourcesSelected",{resourceIds:e})}},{key:"_onWidgetEvent",value:function(e){"resourcesSelected"===e.type?this._onWidgetResourcesSelected(e):Hk(Gk(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onResourcesInserted",value:function(e){this.widget.insertResources(e)}},{key:"_onResourcesDeleted",value:function(e){var t=this.widget._resourcesByIds(e);this.addFilterForWidgetEventType("resourcesSelected"),this.addFilterForProperties({selectionRange:new mk}),this.widget.deleteResources(t)}},{key:"_onAllResourcesDeleted",value:function(){this.addFilterForWidgetEventType("resourcesSelected"),this.addFilterForProperties({selectionRange:new mk}),this.widget.deleteAllResources()}},{key:"_onResourcesSelected",value:function(e){var t=this.widget._resourcesByIds(e);this.addFilterForWidgetEventType("resourcesSelected"),this.widget.selectResources(t,!1)}},{key:"_onResourcesUpdated",value:function(e){this.widget.updateResources(e)}},{key:"onModelAction",value:function(e){"resourcesInserted"===e.type?this._onResourcesInserted(e.resources):"resourcesDeleted"===e.type?this._onResourcesDeleted(e.resourceIds):"allResourcesDeleted"===e.type?this._onAllResourcesDeleted():"resourcesSelected"===e.type?this._onResourcesSelected(e.resourceIds):"resourcesUpdated"===e.type?this._onResourcesUpdated(e.resources):Hk(Gk(o.prototype),"onModelAction",this).call(this,e)}}])&&Nk(t.prototype,n),i&&Nk(t,i),o}(fe);function Kk(e){return(Kk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yk(e,t){return(Yk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Zk(e);if(t){var r=Zk(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Jk(this,n)}}function Jk(e,t){return!t||"object"!==Kk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zk(e){return(Zk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yk(e,t)}(o,e);var t,n,i,r=Xk(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).availableDisplayModes=[],e}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("planner-header"),this.$range=this.$container.appendDiv("planner-range"),this.$range.appendDiv("planner-previous").on("click",this._onPreviousClick.bind(this)),this.$range.appendDiv("planner-today",this.session.text("ui.CalendarToday")).on("click",this._onTodayClick.bind(this)),this.$range.appendDiv("planner-next").on("click",this._onNextClick.bind(this)),this.$range.appendDiv("planner-select"),this.$commands=this.$container.appendDiv("planner-commands"),this._renderAvailableDisplayModes(),this._renderDisplayMode()}},{key:"setAvailableDisplayModes",value:function(e){this.setProperty("availableDisplayModes",e)}},{key:"_renderAvailableDisplayModes",value:function(){var e=Lk.DisplayMode;this.$commands.empty(),this.availableDisplayModes.length>1&&(this.availableDisplayModes.indexOf(e.DAY)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarDay")).attr("data-mode",e.DAY).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.WORK_WEEK)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarWorkWeek")).attr("data-mode",e.WORK_WEEK).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.WEEK)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarWeek")).attr("data-mode",e.WEEK).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.MONTH)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarMonth")).attr("data-mode",e.MONTH).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.CALENDAR_WEEK)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarCalendarWeek")).attr("data-mode",e.CALENDAR_WEEK).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.YEAR)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarYear")).attr("data-mode",e.YEAR).on("click",this._onDisplayModeClick.bind(this)));var t=this.$commands.children(".planner-mode");t.first().addClass("first"),t.last().addClass("last"),1===t.length&&(t.first().addClass("disabled"),t.off("click")),this.$commands.appendDiv("planner-toggle-year").on("click",this._onYearClick.bind(this))}},{key:"setDisplayMode",value:function(e){this.setProperty("displayMode",e)}},{key:"_renderDisplayMode",value:function(){s()(".planner-mode",this.$commands).select(!1),s()('[data-mode="'+this.displayMode+'"]',this.$commands).select(!0)}},{key:"_onTodayClick",value:function(e){this.trigger("todayClick")}},{key:"_onNextClick",value:function(e){this.trigger("nextClick")}},{key:"_onPreviousClick",value:function(e){this.trigger("previousClick")}},{key:"_onYearClick",value:function(e){this.trigger("yearClick")}},{key:"_onDisplayModeClick",value:function(e){var t=s()(e.target).data("mode");this.setDisplayMode(t),this.trigger("displayModeClick",{displayMode:this.displayMode})}}])&&qk(t.prototype,n),i&&qk(t,i),o}(de);function eS(e){return(eS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nS(e,t){return(nS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oS(e);if(t){var r=oS(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rS(this,n)}}function rS(e,t){return!t||"object"!==eS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oS(e){return(oS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nS(e,t)}(o,e);var t,n,i,r=iS(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).planner=e,t}return t=o,(n=[{key:"layout",value:function(e){var t,n=this.planner._header.$container,i=this.planner.$scale,r=this.planner.$grid,o=this.planner.menuBar,s=this.planner._yearPanel.$container,a=0,u=0,l=0,c=0,f=0,h=Uo.get(o.$container),d=this.planner.htmlComp,p=d.availableSize().subtract(d.insets());o.$container.isVisible()&&(t=D_.size(h,p),h.setSize(t),a=t.height,"top"===o.position&&(f+=a)),n.isVisible()&&(f+=No.size(n).height),i.css("top",f),c+=f+No.size(i).height,r.css("top",c),l=f+s.cssMarginY(),u=c+r.cssMarginY(),o.$container.isVisible()&&"bottom"===o.position&&(l+=a,u+=a),s.css("height","calc(100% - "+l+"px)"),r.css("height","calc(100% - "+u+"px)"),this._updateMinWidth(),this._layoutScaleLines(),wf.update(this.planner.$grid,!0),this.planner.layoutYearPanel()}},{key:"_updateMinWidth",value:function(){var e=this._minWidth(),t=this.planner.$scaleTitle,n=this.planner.$timeline;n&&(n.css("min-width",e),e+=t.outerWidth(!0),this.planner.resources.forEach((function(t){t.$resource.css("min-width",e)})))}},{key:"_layoutScaleLines",value:function(){var e,t,n,i,r=this.planner.$timelineSmall,o=this.planner.$timelineLarge;r&&(t=r.children(".scale-item"),(n=o.children(".scale-item")).each((function(){s()(this).data("scale-item-line").cssHeight(0)})),t.each((function(){var e=s()(this).data("scale-item-line");e&&e.cssHeight(0)})),wf.reset(this.planner.$grid),e=this.planner.$grid[0].scrollHeight,i=this.planner.$scale[0].scrollLeft,n.each((function(){var t=s()(this);t.data("scale-item-line").cssLeft(i+t.position().left).cssHeight(e)})),t.each((function(){var t=s()(this),n=t.data("scale-item-line");n&&n.cssLeft(i+t.position().left).cssHeight(e)})))}},{key:"_minWidth",value:function(){var e=this.planner.$timelineLarge.children(".scale-item"),t=this.planner.$timelineSmall.children(".scale-item"),n=e.length,i=t.length,r=Lk.DisplayMode,o=i*No.insets(t,{includeBorder:!1}).horizontal();return this.planner.displayMode===r.DAY?Math.max(o,52*n):O.isOneOf(this.planner.displayMode,r.WORK_WEEK,r.WEEK)?Math.max(o,160*n):this.planner.displayMode===r.MONTH||this.planner.displayMode===r.CALENDAR_WEEK?Math.max(o,23*i):this.planner.displayMode===r.YEAR?Math.max(o,90*i):void 0}}])&&tS(t.prototype,n),i&&tS(t,i),o}(zo);function aS(e){return(aS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uS(e,t){return(uS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=fS(e);if(t){var r=fS(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cS(this,n)}}function cS(e,t){return!t||"object"!==aS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fS(e){return(fS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uS(e,t)}(n,e);var t=lS(n);function n(e,i){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=t.call(this,e,i)).selectionTypes=["Resource","Activity","Range"],r}return n}(ag);function dS(e){return(dS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yS(e,t,n){return(yS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mS(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function vS(e,t){return(vS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mS(e);if(t){var r=mS(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gS(this,n)}}function gS(e,t){return!t||"object"!==dS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mS(e){return(mS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vS(e,t)}(o,e);var t,n,i,r=bS(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).displayParent=null,e.files=[],e._glassPaneRenderer=null,e.maximumUploadSize=LS.DEFAULT_MAXIMUM_UPLOAD_SIZE,e}return t=o,(n=[{key:"_init",value:function(e){yS(mS(o.prototype),"_init",this).call(this,e),this._setDisplayParent(this.displayParent),this._glassPaneRenderer=new Bc(this),this.fileInput=O.create("FileInput",{parent:this,acceptTypes:this.acceptTypes,maximumUploadSize:this.maximumUploadSize,multiSelect:this.multiSelect,visible:!Mt.get().supportsFile()}),this.fileInput.on("change",this._onFileChange.bind(this))}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){yS(mS(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new cl(this.session,this),new il(this,[pu.SPACE,pu.ENTER]),new bl(this,function(){return this.$cancelButton}.bind(this))])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("file-chooser").on("mousedown",this._onMouseDown.bind(this));var e=this.$container.appendDiv("drag-handle");this.$container.draggable(e),this.$container.appendDiv("closable").on("click",function(){this.cancel()}.bind(this)),this.$content=this.$container.appendDiv("file-chooser-content"),this.$title=this.$content.appendDiv("file-chooser-title").text(this.session.text(this.multiSelect?"ui.ChooseFiles":"ui.ChooseFile")),this.fileInput.render(this.$content),this.fileInput.legacy||(this.$container.on("dragenter",this._onDragEnterOrOver.bind(this)).on("dragover",this._onDragEnterOrOver.bind(this)).on("drop",this._onDrop.bind(this)),this.$content.appendDiv("file-chooser-label").text(this.session.text("ui.FileChooserHint")),this.$files=this.$content.appendElement("<ul>","file-chooser-files"),this._installScrollbars()),this.$buttons=this.$container.appendDiv("file-chooser-buttons");var t=new Yl(this.$buttons);this.fileInput.legacy||(this.$addFileButton=t.addButton({text:this.session.text("ui.Browse"),onClick:this._onAddFileButtonClicked.bind(this),needsClick:!0})),this.$uploadButton=t.addButton({text:this.session.text("ui.Upload"),onClick:this._onUploadButtonClicked.bind(this),enabled:!1}),this.$cancelButton=t.addButton({text:this.session.text("Cancel"),onClick:this._onCancelButtonClicked.bind(this)}),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new _T(this)),this.$container.addClassForAnimation("animate-open"),this.$container.addClass("calc-helper");var n=this.$container.windowSize(),i=Math.min(this.$container.width(),n.width-20);this.$container.css("min-width",i),this.$container.css("max-width",i),this.$container.removeClass("calc-helper"),t.updateButtonWidths(this.$container.width()),this._glassPaneRenderer.renderGlassPanes(),this._position()}},{key:"_renderProperties",value:function(){yS(mS(o.prototype),"_renderProperties",this).call(this),this.fileInput.legacy&&this.setFiles([]),this._renderFiles()}},{key:"_postRender",value:function(){yS(mS(o.prototype),"_postRender",this).call(this),this._installFocusContext()}},{key:"_remove",value:function(){this._glassPaneRenderer.removeGlassPanes(),this._uninstallFocusContext(),yS(mS(o.prototype),"_remove",this).call(this)}},{key:"_installFocusContext",value:function(){this.session.focusManager.installFocusContext(this.$container,Pc.AUTO)}},{key:"_uninstallFocusContext",value:function(){this.session.focusManager.uninstallFocusContext(this.$container)}},{key:"get$Scrollable",value:function(){return this.$files}},{key:"_position",value:function(){this.$container.cssMarginLeft(-this.$container.outerWidth()/2)}},{key:"setDisplayParent",value:function(e){this.setProperty("displayParent",e)}},{key:"_setDisplayParent",value:function(e){this._setProperty("displayParent",e),e&&this.setParent(this.findDesktop().computeParentForDisplayParent(e))}},{key:"setMaximumUploadSize",value:function(e){this.setProperty("maximumUploadSize",e),this.fileInput.setMaximumUploadSize(e)}},{key:"open",value:function(){this.setDisplayParent(this.displayParent||this.session.desktop),this.displayParent.fileChooserController.registerAndRender(this)}},{key:"close",value:function(){this.rendered?this.$cancelButton&&this.session.focusManager.requestFocus(this.$cancelButton)&&this.$cancelButton.click():this.cancel()}},{key:"cancel",value:function(){var e=new Kt;this.trigger("cancel",e),e.defaultPrevented||this._close()}},{key:"_close",value:function(){this.displayParent&&this.displayParent.fileChooserController.unregisterAndRemove(this),this.destroy()}},{key:"browse",value:function(){this.fileInput.browse()}},{key:"setAcceptTypes",value:function(e){this.setProperty("acceptTypes",e),this.fileInput.setAcceptTypes(e)}},{key:"setMultiSelect",value:function(e){this.setProperty("multiSelect",e),this.fileInput.setMultiSelect(e)}},{key:"addFiles",value:function(e){e instanceof FileList&&(e=LS.fileListToArray(e)),0!==(e=et.ensure(e)).length&&(!this.multiSelect||this.fileInput.legacy?(e=[e[0]],this.setFiles([e[0]])):(e=e.slice(),et.insertAll(e,this.files,0),this.setFiles(e)))}},{key:"removeFile",value:function(e){var t=this.files.slice();et.remove(t,e),this.setFiles(t),this.fileInput.clear()}},{key:"setFiles",value:function(e){e instanceof FileList&&(e=LS.fileListToArray(e)),e=et.ensure(e);try{this.fileInput.validateMaximumUploadSize(e)}catch(e){return void mz.createOk(this).withHeader(this.session.text("ui.FileSizeLimitTitle")).withBody(e).withSeverity(pi.Severity.ERROR).buildAndOpen()}this.setProperty("files",e)}},{key:"_renderFiles",value:function(){var e=this.files;this.fileInput.legacy||(this.$files.empty(),e.forEach((function(e){var t=this.$files.appendElement("<li>","file",e.name);t.append(" ");var n=t.appendSpan("remove menu-item").on("click",this.removeFile.bind(this,e)),i=t.makeElement("<a>","remove-link",this.session.text("Remove"));n.appendTextNode("("),n.append(i),n.appendTextNode(")")}),this),wf.update(this.$files)),this.$uploadButton.setEnabled(e.length>0)}},{key:"_onDragEnterOrOver",value:function(e){Gt.verifyDataTransferTypesScoutTypes(e,Gt.SCOUT_TYPES.FILE_TRANSFER)}},{key:"_onDrop",value:function(e){Gt.dataTransferTypesContainsScoutTypes(e.originalEvent.dataTransfer,Gt.SCOUT_TYPES.FILE_TRANSFER)&&(s.a.suppressEvent(e),this.addFiles(e.originalEvent.dataTransfer.files))}},{key:"_onUploadButtonClicked",value:function(e){this.trigger("upload")}},{key:"_onCancelButtonClicked",value:function(e){this.cancel()}},{key:"_onAddFileButtonClicked",value:function(e){this.browse()}},{key:"_onFileChange",value:function(e){this.addFiles(e.files)}},{key:"_onMouseDown",value:function(e,t){var n=this.findParent((function(e){return e instanceof ZO&&e.isDialog()}));n&&n.activate()}},{key:"_attach",value:function(){this.$parent.append(this.$container),yS(mS(o.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.$container.detach(),yS(mS(o.prototype),"_detach",this).call(this)}}])&&pS(t.prototype,n),i&&pS(t,i),o}(de);function wS(e){return(wS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SS(e,t,n){return(SS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PS(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function OS(e,t){return(OS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function TS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=PS(e);if(t){var r=PS(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return CS(this,n)}}function CS(e,t){return!t||"object"!==wS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function PS(e){return(PS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var RS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OS(e,t)}(o,e);var t,n,i,r=TS(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetCancel",value:function(e){e.preventDefault(),this._send("cancel")}},{key:"_onWidgetEvent",value:function(e){"cancel"===e.type?this._onWidgetCancel(e):"upload"===e.type?this._onUpload(e):SS(PS(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onUpload",value:function(e){this.widget.rendered&&this.widget.$uploadButton.setEnabled(!1),0!==this.widget.files.length&&(this.widget.fileInput.legacy?this.widget.fileInput.upload():this.session.uploadFiles(this,this.widget.files,void 0,this.widget.maximumUploadSize),this.session.listen().done(function(){this.widget&&this.widget.rendered&&this.widget.$uploadButton.setEnabled(!0)}.bind(this)))}}])&&kS(t.prototype,n),i&&kS(t,i),o}(fe);function xS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ES=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.displayParent=t,this.session=n}var t,n,i;return t=e,(n=[{key:"registerAndRender",value:function(e){O.assertProperty(e,"displayParent"),this.displayParent.fileChoosers.push(e),this._render(e)}},{key:"unregisterAndRemove",value:function(e){e&&(et.remove(this.displayParent.fileChoosers,e),this._remove(e))}},{key:"remove",value:function(){this.displayParent.fileChoosers.forEach(this._remove.bind(this))}},{key:"render",value:function(){this.displayParent.fileChoosers.forEach(function(e){e.setDisplayParent(this.displayParent),this._render(e)}.bind(this))}},{key:"_render",value:function(e){if(e.displayParent||e._setProperty("displayParent",this.displayParent),this.displayParent.acceptView){if(!this.displayParent.acceptView(e))return}else if(!this.acceptView(e))return;var t;e.rendered||(t=this.displayParent instanceof ZO&&this.displayParent.isPopupWindow()?this.displayParent.popupWindow.$container:this.session.desktop.$container,e.setTrackFocus(!0),e.render(t),this.displayParent.inFront()||e.detach())}},{key:"_remove",value:function(e){e.remove()}},{key:"attach",value:function(){this.displayParent.fileChoosers.forEach((function(e){e.attach()}),this)}},{key:"detach",value:function(){this.displayParent.fileChoosers.forEach((function(e){e.detach()}),this)}},{key:"acceptView",value:function(e){return this.displayParent.rendered}}])&&xS(t.prototype,n),i&&xS(t,i),e}();function DS(e){return(DS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AS(e,t,n){return(AS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=IS(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function $S(e,t){return($S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=IS(e);if(t){var r=IS(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return MS(this,n)}}function MS(e,t){return!t||"object"!==DS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function IS(e){return(IS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var LS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$S(e,t)}(o,e);var t,n,i,r=jS(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).acceptTypes=null,e.maximumUploadSize=o.DEFAULT_MAXIMUM_UPLOAD_SIZE,e.multiSelect=!1,e.files=[],e.legacyFileUploadUrl=null,e.text=null,e}return t=o,i=[{key:"fileListToArray",value:function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e[t]);return n}}],(n=[{key:"_init",value:function(e){AS(IS(o.prototype),"_init",this).call(this,e),this.uploadController=e.uploadController||e.parent;var t=new Li(e.legacyFileUploadUrl||"upload/"+this.session.uiSessionId+"/"+this.uploadController.id);t.setParameter("legacy",!0),this.legacyFileUploadUrl=t.toString(),this.legacy=!Mt.get().supportsFile()}},{key:"_initKeyStrokeContext",value:function(){this.keyStrokeContext=this._createKeyStrokeContext(),AS(IS(o.prototype),"_initKeyStrokeContext",this).call(this)}},{key:"_createKeyStrokeContext",value:function(){if(this.legacy)return new Fu}},{key:"_render",value:function(){this.$fileInput=this.$parent.makeElement("<input>").attr("type","file").on("change",this._onFileChange.bind(this)),this.legacy?this._renderLegacyMode():(this.$container=this.$parent.appendDiv("file-input input-field").on("dragenter",this._onDragEnterOrOver.bind(this)).on("dragover",this._onDragEnterOrOver.bind(this)).on("drop",this._onDrop.bind(this)),this.$fileInput.appendTo(this.$container),this.$container.on("mousedown",this._onMouseDown.bind(this)),this.$text=this.$container.appendDiv("file-input-text")),this.legacy&&this.clear()}},{key:"_renderLegacyMode",value:function(){this.$legacyFormTarget=this.$fileInput.appendElement("<iframe>").attr("name","legacyFileUpload"+this.uploadController.id).on("load",function(){try{var e=this.$legacyFormTarget.contents().text();if(En.hasText(e)){var t=s.a.parseJSON(e);this.session.responseQueue.process(t)}}finally{this.session.setBusy(!1)}}.bind(this)),this.$fileInput.attr("name","file").addClass("legacy-upload-file-input"),this.$legacyForm=this.$parent.appendElement("<form>","legacy-upload-form").attr("action",this.legacyFileUploadUrl).attr("enctype","multipart/form-data").attr("method","post").attr("target","legacyFileUpload"+this.uploadController.id).append(this.$fileInput),this.$container=this.$legacyForm}},{key:"_renderProperties",value:function(){AS(IS(o.prototype),"_renderProperties",this).call(this),this._renderText(),this._renderAcceptTypes(),this._renderMultiSelect()}},{key:"_renderEnabled",value:function(){AS(IS(o.prototype),"_renderEnabled",this).call(this),this.legacy?this.$fileInput.setEnabled(this.enabledComputed):this.$container.setTabbable(this.enabledComputed)}},{key:"setText",value:function(e){this.setProperty("text",e)}},{key:"_renderText",value:function(){if(!this.legacy){var e=this.text||"";this.$text.text(e)}}},{key:"setAcceptTypes",value:function(e){this.setProperty("acceptTypes",e)}},{key:"_renderAcceptTypes",value:function(){var e=this.acceptTypes||"";this.$fileInput.attr("accept",e)}},{key:"setMultiSelect",value:function(e){this.setProperty("multiSelect",e)}},{key:"_renderMultiSelect",value:function(){this.$fileInput.prop("multiple",this.multiSelect)}},{key:"setMaximumUploadSize",value:function(e){this.setProperty("maximumUploadSize",e)}},{key:"clear",value:function(){this._setFiles([]),this.setText(null),this.rendered&&this.$fileInput.val(null)}},{key:"_setFiles",value:function(e){if(e instanceof FileList&&(e=o.fileListToArray(e)),e=et.ensure(e),!et.equals(this.files,e)){var t="";e.length>0&&(t=this.legacy?e[0]:e[0].name),this.files=e,this.setText(t),this.trigger("change",{files:e})}}},{key:"upload",value:function(){return 0===this.files.length||(this.legacy?(this.session.setBusy(!0),this.$legacyForm[0].submit(),!0):this.session.uploadFiles(this.uploadController,this.files,void 0,this.maximumUploadSize))}},{key:"browse",value:function(){this.$fileInput.click()}},{key:"_onFileChange",value:function(e){var t=[];this.legacy?this.$fileInput[0].value&&t.push(this.$fileInput[0].value):t=this.$fileInput[0].files,t.length&&this._setFiles(t)}},{key:"_onMouseDown",value:function(){this.enabled&&this.browse()}},{key:"_onDragEnterOrOver",value:function(e){Gt.verifyDataTransferTypesScoutTypes(e,Gt.SCOUT_TYPES.FILE_TRANSFER)}},{key:"_onDrop",value:function(e){if(Gt.dataTransferTypesContainsScoutTypes(e.originalEvent.dataTransfer,Gt.SCOUT_TYPES.FILE_TRANSFER)){e.stopPropagation(),e.preventDefault();var t=e.originalEvent.dataTransfer.files;t.length>=1&&this._setFiles(t)}}},{key:"validateMaximumUploadSize",value:function(e){if(0!==(e=et.ensure(e)).length){var t=e.reduce((function(e,t){return e+t.size}),0);if(null!==this.maximumUploadSize&&t>this.maximumUploadSize)throw this.session.text("ui.FileSizeLimit",this.maximumUploadSize/1024/1024)}}}])&&FS(t.prototype,n),i&&FS(t,i),o}(de);function BS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(LS,"DEFAULT_MAXIMUM_UPLOAD_SIZE",52428800);var NS=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.location=null}var t,n,i;return t=e,(n=[{key:"matches",value:function(e){return!1}},{key:"activate",value:function(e){this.location=e}},{key:"deactivate",value:function(){}}])&&BS(t.prototype,n),i&&BS(t,i),e}(),HS=[],VS=new Yt,WS=null,zS=null;function GS(e){e||(e=new RegExp("[^/]*$").exec(document.location.href)[0]);(En.empty(e)||"/"===e)&&(e=zS);var t,n=null;for(t=0;t<HS.length;t++)if((n=HS[t]).matches(e))return n===WS&&n.location===e?void(s.a.log.isDebugEnabled()&&s.a.log.debug("Route has not changed - do not activate route")):(WS&&WS.deactivate(),(WS=n).activate(e),window.location.replace(e),s.a.log.isInfoEnabled()&&s.a.log.info("router: activated route for location=",e),void VS.trigger("routeChange",{route:n}));s.a.log.warn("router: no route registered for location=",e)}var US={activate:GS,currentRoute:WS,defaultLocation:zS,events:VS,on:function(e,t){VS.on(e,t)},prepare:function(e,t){En.startsWith(t,"#")||(t="#"+t),e.attr("href",t).on("mousedown",(function(e){return GS(t),!1}))},register:function(e){HS.push(e)},routes:HS,setDefaultLocation:function(e){zS="#"+e},updateLocation:function(e){var t="#"+e;window.location.replace(t)}};function KS(e){return(KS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function YS(e,t,n){return(YS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=QS(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function XS(e,t){return(XS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function JS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=QS(e);if(t){var r=QS(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ZS(this,n)}}function ZS(e,t){return!t||"object"!==KS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function QS(e){return(QS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}window.addEventListener("popstate",(function(e){return US.activate(null),!1}));var eO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XS(e,t)}(o,e);var t,n,i,r=JS(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).value=null,e.minValue=null,e.maxValue=null,e.step=null,e.$sliderInput=null,e.$sliderValue=null,e}return t=o,(n=[{key:"_init",value:function(e){YS(QS(o.prototype),"_init",this).call(this,e),this.value=e.value,this.minValue=e.minValue,this.maxValue=e.maxValue,this.step=e.step}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("slider"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new dO(this)),this.$sliderInput=this.$container.appendElement("<input>","slider-input").attr("type","range").on("change",this._onValueChange.bind(this)).addClass(Mt.get().cssClassForEdge()),this.$sliderValue=this.$container.appendSpan("slider-value",this.value)}},{key:"_renderProperties",value:function(){YS(QS(o.prototype),"_renderProperties",this).call(this),this._renderValue(),this._renderMinValue(),this._renderMaxValue(),this._renderStep()}},{key:"_remove",value:function(){YS(QS(o.prototype),"_remove",this).call(this),this.$sliderInput=null,this.$sliderValue=null}},{key:"_renderValue",value:function(){var e=O.nvl(this.value,0);this.$sliderInput.val(e),this.$sliderValue.text(e)}},{key:"_renderMinValue",value:function(){this.minValue?this.$sliderInput.attr("min",this.minValue):this.$sliderInput.removeAttr("min")}},{key:"_renderMaxValue",value:function(){this.maxValue?this.$sliderInput.attr("max",this.maxValue):this.$sliderInput.removeAttr("max")}},{key:"_renderStep",value:function(){this.step?this.$sliderInput.attr("step",this.step):this.$sliderInput.removeAttr("step")}},{key:"_onValueChange",value:function(e){var t=Number(this.$sliderInput.val());oi.isNumber(t)||(t=O.nvl(this.maxValue,this.minValue,0)),this.setValue(t)}},{key:"setValue",value:function(e){this.setProperty("value",e)}}])&&qS(t.prototype,n),i&&qS(t,i),o}(de);function tO(e){return(tO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nO(e,t){return(nO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oO(e);if(t){var r=oO(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rO(this,n)}}function rO(e,t){return!t||"object"!==tO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oO(e){return(oO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nO(e,t)}(n,e);var t=iO(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["value"]),e}return n}(fe);function aO(e){return(aO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lO(e,t){return(lO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=hO(e);if(t){var r=hO(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fO(this,n)}}function fO(e,t){return!t||"object"!==aO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hO(e){return(hO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lO(e,t)}(o,e);var t,n,i,r=cO(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).slider=e,t}return t=o,(n=[{key:"layout",value:function(e){var t=No.size(e);this.slider.$sliderInput.css("height",t.height),this.slider.$sliderValue.css("height",t.height)}}])&&uO(t.prototype,n),i&&uO(t,i),o}(zo);function pO(e){return(pO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vO(e,t,n){return(vO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_O(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function bO(e,t){return(bO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_O(e);if(t){var r=_O(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return mO(this,n)}}function mO(e,t){return!t||"object"!==pO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _O(e){return(_O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bO(e,t)}(o,e);var t,n,i,r=gO(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).selected=!1,e.ref=null,e}return t=o,(n=[{key:"_init",value:function(e){e.owner=e.parent,vO(_O(o.prototype),"_init",this).call(this,e)}},{key:"_render",value:function(){vO(_O(o.prototype),"_render",this).call(this),this.$container.addClass("mode")}},{key:"_renderProperties",value:function(){vO(_O(o.prototype),"_renderProperties",this).call(this),this._renderSelected()}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.select(this.selected)}},{key:"doAction",value:function(){return!!this.prepareDoAction()&&(this.selected||this.setSelected(!0),!0)}},{key:"toggle",value:function(){this.selected||this.setSelected(!0)}},{key:"_renderIconId",value:function(){vO(_O(o.prototype),"_renderIconId",this).call(this),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}},{key:"_renderText",value:function(){vO(_O(o.prototype),"_renderText",this).call(this),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}},{key:"_updateLabelAndIconStyle",value:function(){var e=!!this.text;this.get$Icon().toggleClass("with-label",e)}}])&&yO(t.prototype,n),i&&yO(t,i),o}(Eh);function kO(e){return(kO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SO(e,t){return(SO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=CO(e);if(t){var r=CO(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return TO(this,n)}}function TO(e,t){return!t||"object"!==kO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CO(e){return(CO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SO(e,t)}(n,e);var t=OO(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Lh);function RO(e){return(RO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function EO(e,t,n){return(EO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jO(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function DO(e,t){return(DO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function FO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=jO(e);if(t){var r=jO(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return AO(this,n)}}function AO(e,t){return!t||"object"!==RO(t)&&"function"!=typeof t?$O(e):t}function $O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jO(e){return(jO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DO(e,t)}(o,e);var t,n,i,r=FO(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["modes","selectedMode"]),e._addPreserveOnPropertyChangeProperties(["selectedMode"]),e.modes=[],e.selectedMode=null,e._modePropertyChangeHandler=e._onModePropertyChange.bind($O(e)),e}return t=o,(n=[{key:"_init",value:function(e){EO(jO(o.prototype),"_init",this).call(this,e),this._setModes(this.modes),this._setSelectedMode(this.selectedMode)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("mode-selector"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new zO(this))}},{key:"_renderProperties",value:function(){EO(jO(o.prototype),"_renderProperties",this).call(this),this._renderModes()}},{key:"setModes",value:function(e){this.setProperty("modes",e)}},{key:"_setModes",value:function(e){this.modes.forEach((function(e){e.off("propertyChange",this._modePropertyChangeHandler)}),this),this._setProperty("modes",et.ensure(e)),this.modes.forEach((function(e){e.on("propertyChange",this._modePropertyChangeHandler),e.selected&&this.setSelectedMode(e)}),this)}},{key:"_renderModes",value:function(){this.modes.forEach((function(e){e.render()})),this._updateMarkers()}},{key:"setSelectedMode",value:function(e){this.setProperty("selectedMode",e)}},{key:"_setSelectedMode",value:function(e){this.selectedMode&&this.selectedMode!==e&&this.selectedMode.setSelected(!1),e&&!e.selected&&e.setSelected(!0),this._updateMarkers(),this._setProperty("selectedMode",e)}},{key:"_onModePropertyChange",value:function(e){"selected"===e.propertyName&&e.newValue?this.setSelectedMode(e.source):"visible"===e.propertyName&&this._updateMarkers()}},{key:"_updateMarkers",value:function(){var e=[],t=-1;this.modes.forEach((function(n){n.rendered&&(n.$container.removeClass("first last after-selected"),n.isVisible()&&(e.push(n),n.selected&&(t=e.length-1)))})),e.length&&(e[0].$container.addClass("first"),e[e.length-1].$container.addClass("last"),t>=0&&t<e.length-1&&e[t+1].$container.addClass("after-selected"))}},{key:"findModeById",value:function(e){return et.find(this.modes,(function(t){return t.id===e}))}},{key:"findModeByRef",value:function(e){return et.find(this.modes,(function(t){return t.ref===e}))}},{key:"selectModeById",value:function(e){this.setSelectedMode(this.findModeById(e))}},{key:"selectModeByRef",value:function(e){this.setSelectedMode(this.findModeByRef(e))}}])&&xO(t.prototype,n),i&&xO(t,i),o}(de);function IO(e){return(IO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BO(e,t,n){return(BO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WO(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function NO(e,t){return(NO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function HO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=WO(e);if(t){var r=WO(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return VO(this,n)}}function VO(e,t){return!t||"object"!==IO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function WO(e){return(WO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NO(e,t)}(o,e);var t,n,i,r=HO(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).modeSelector=e,t}return t=o,(n=[{key:"preferredLayoutSize",value:function(e,t){var n=BO(WO(o.prototype),"preferredLayoutSize",this).call(this,e,t),i=this.modeSelector.$container.attr("style");this.modeSelector.$container.css({width:"auto",height:"auto"});var r=0;return this.modeSelector.modes.forEach((function(e){var t=e.htmlComp.prefSize().width;t>r&&(r=t)})),this.modeSelector.$container.attrOrRemove("style",i),n.width=r*this.modeSelector.modes.length+this.modeSelector.htmlComp.insets().horizontal(),n}}])&&LO(t.prototype,n),i&&LO(t,i),o}(zo);function GO(e){return(GO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function KO(e,t,n){return(KO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=JO(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function qO(e,t){return(qO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=JO(e);if(t){var r=JO(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return XO(this,n)}}function XO(e,t){return!t||"object"!==GO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function JO(e){return(JO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ZO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qO(e,t)}(o,e);var t,n,i,r=YO(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["rootGroupBox","views","dialogs","initialFocus","messageBoxes","fileChoosers"]),e._addPreserveOnPropertyChangeProperties(["initialFocus"]),e.askIfNeedSave=!0,e.askIfNeedSaveText=null,e.data={},e.displayHint=o.DisplayHint.DIALOG,e.displayParent=null,e.maximizeEnabled=!0,e.maximized=!1,e.minimizeEnabled=!0,e.minimized=!1,e.modal=!0,e.logicalGrid=O.create("FormGrid"),e.dialogs=[],e.views=[],e.messageBoxes=[],e.fileChoosers=[],e.focusedElement=null,e.closable=!0,e.cacheBounds=!1,e.cacheBoundsKey=null,e.resizable=!0,e.rootGroupBox=null,e.saveNeeded=!1,e.saveNeededVisible=!1,e.formController=null,e.messageBoxController=null,e.fileChooserController=null,e._glassPaneRenderer=null,e.renderInitialFocusEnabled=!0,e.$statusIcons=[],e.$header=null,e.$statusContainer=null,e.$close=null,e.$saveNeeded=null,e.$icon=null,e.$title=null,e.$subTitle=null,e}return t=o,i=[{key:"findForm",value:function(e){for(var t=e.parent;t&&!(t instanceof o);)t=t.parent;return t}},{key:"findNonWrappedForm",value:function(e){if(!e)return null;var t=null;return e.findParent((function(e){if(e instanceof o)return!((t=e).parent instanceof J8)})),t}}],(n=[{key:"_init",value:function(e){KO(JO(o.prototype),"_init",this).call(this,e),this.resolveTextKeys(["title","askIfNeedSaveText"]),this.resolveIconIds(["iconId"]),this._setDisplayParent(this.displayParent),this._setViews(this.views),this.formController=O.create("FormController",{displayParent:this,session:this.session}),this.messageBoxController=new bz(this,this.session),this.fileChooserController=new ES(this,this.session),this._setRootGroupBox(this.rootGroupBox),this._setStatus(this.status),this.cacheBoundsKey=O.nvl(e.cacheBoundsKey,this.objectType),this._installLifecycle()}},{key:"_render",value:function(){this._renderForm()}},{key:"_renderProperties",value:function(){KO(JO(o.prototype),"_renderProperties",this).call(this),this._renderTitle(),this._renderSubTitle(),this._renderIconId(),this._renderClosable(),this._renderSaveNeeded(),this._renderCssClass(),this._renderStatus(),this._renderModal(),this._installFocusContext(),this.renderInitialFocusEnabled&&this.renderInitialFocus()}},{key:"_postRender",value:function(){KO(JO(o.prototype),"_postRender",this).call(this),this.formController.render(),this.messageBoxController.render(),this.fileChooserController.render(),this._glassPaneRenderer&&this._glassPaneRenderer.renderGlassPanes()}},{key:"_destroy",value:function(){KO(JO(o.prototype),"_destroy",this).call(this),this._glassPaneRenderer&&(this._glassPaneRenderer=null)}},{key:"_remove",value:function(){this.formController.remove(),this.messageBoxController.remove(),this.fileChooserController.remove(),this._glassPaneRenderer&&(this._glassPaneRenderer.removeGlassPanes(),this._glassPaneRenderer=null),this._uninstallFocusContext(),this.$statusIcons=[],this.$header=null,this.$statusContainer=null,this.$close=null,this.$saveNeeded=null,this.$icon=null,this.$title=null,this.$subTitle=null,KO(JO(o.prototype),"_remove",this).call(this)}},{key:"_renderForm",value:function(){var e,t;this.$container=this.$parent.appendDiv().addClass(this.isDialog()?"dialog":"form").data("model",this),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.htmlComp=Uo.install(this.$container,this.session),this.isDialog()?(e=new aP(this),this.htmlComp.validateRoot=!0,t=this.$container.appendDiv("drag-handle"),this.$container.draggable(t,s.a.throttle(this._onMove.bind(this),1e3/60)),this.resizable&&this._initResizable(),this._renderHeader(),this.$container[0].addEventListener("mousedown",this._onDialogMouseDown.bind(this),!0)):e=new _T(this),this.htmlComp.setLayout(e),this.rootGroupBox.render()}},{key:"_renderFocusedElement",value:function(){this.focusedElement&&(this.focusedElement.focus(),this.focusedElement=null)}},{key:"setModal",value:function(e){this.setProperty("modal",e)}},{key:"_renderModal",value:function(){this.parent instanceof J8||(this.modal&&!this._glassPaneRenderer?(this._glassPaneRenderer=new Bc(this),this._glassPaneRenderer.renderGlassPanes()):!this.modal&&this._glassPaneRenderer&&(this._glassPaneRenderer.removeGlassPanes(),this._glassPaneRenderer=null))}},{key:"_installLifecycle",value:function(){this.lifecycle=this._createLifecycle(),this.lifecycle.handle("load",this._onLifecycleLoad.bind(this)),this.lifecycle.handle("save",this._onLifecycleSave.bind(this)),this.lifecycle.on("postLoad",this._onLifecyclePostLoad.bind(this)),this.lifecycle.on("reset",this._onLifecycleReset.bind(this)),this.lifecycle.on("close",this._onLifecycleClose.bind(this))}},{key:"_createLifecycle",value:function(){return O.create("FormLifecycle",{widget:this,askIfNeedSave:this.askIfNeedSave,askIfNeedSaveText:this.askIfNeedSaveText})}},{key:"open",value:function(){return this.load().then(function(){this.destroyed||this.show()}.bind(this))}},{key:"load",value:function(){return this.lifecycle.load()}},{key:"whenLoad",value:function(){return this.when("load")}},{key:"_onLifecycleLoad",value:function(){var e=this;try{return this._load().then((function(t){e.destroyed||(e.setData(t),e.importData(),e.trigger("load"))})).catch((function(t){return e._handleLoadError(t)}))}catch(e){return this._handleLoadError(e)}}},{key:"_handleLoadError",value:function(e){throw this.destroy(),e}},{key:"_load",value:function(){return s.a.resolvedPromise().then(function(){return this.data}.bind(this))}},{key:"whenPostLoad",value:function(){return this.when("postLoad")}},{key:"_onLifecyclePostLoad",value:function(){return this._postLoad().then(function(){this.trigger("postLoad")}.bind(this))}},{key:"_postLoad",value:function(){return s.a.resolvedPromise()}},{key:"setData",value:function(e){this.setProperty("data",e)}},{key:"importData",value:function(){}},{key:"exportData",value:function(){}},{key:"ok",value:function(){return this.lifecycle.ok()}},{key:"save",value:function(){return this.lifecycle.save()}},{key:"whenSave",value:function(){return this.when("save")}},{key:"_onLifecycleSave",value:function(){var e=this.exportData();return this._save(e).then(function(t){return this.setData(e),this.trigger("save"),t}.bind(this))}},{key:"_validate",value:function(){return pi.ok()}},{key:"_save",value:function(e){return s.a.resolvedPromise()}},{key:"reset",value:function(){this.lifecycle.reset()}},{key:"whenReset",value:function(){return this.when("reset")}},{key:"_onLifecycleReset",value:function(){this.trigger("reset")}},{key:"cancel",value:function(){return this.lifecycle.cancel()}},{key:"whenCancel",value:function(){return this.when("cancel")}},{key:"close",value:function(){return this.lifecycle.close()}},{key:"whenClose",value:function(){return this.when("close")}},{key:"_onLifecycleClose",value:function(){var e=new Kt;this.trigger("close",e),e.defaultPrevented||this._close()}},{key:"_close",value:function(){this.hide(),this.destroy()}},{key:"abort",value:function(){var e=new Kt;this.trigger("abort",e),e.defaultPrevented||this._abort()}},{key:"whenAbort",value:function(){return this.when("abort")}},{key:"_abort",value:function(){this.rootGroupBox.controls.concat(this.rootGroupBox.menus).filter((function(e){var t=e.enabled;return void 0!==e.enabledComputed&&(t=e.enabledComputed),e.visible&&t&&e.systemType&&e.systemType!==WG.SystemType.NONE})).some((function(e){return e.systemType===WG.SystemType.CLOSE}))?this.close():this.cancel()}},{key:"setClosable",value:function(e){this.setProperty("closable",e)}},{key:"_renderClosable",value:function(){if(this.isDialog())if(this.$container.toggleClass("closable"),this.closable){if(this.$close)return;this.$close=this.$statusContainer.appendDiv("status closer").on("click",this._onCloseIconClick.bind(this))}else{if(!this.$close)return;this.$close.remove(),this.$close=null}}},{key:"_onCloseIconClick",value:function(){this.abort()}},{key:"_initResizable",value:function(){this.$container.resizable().on("resize",this._onResize.bind(this))}},{key:"_onResize",value:function(e){var t=this.htmlComp.layout.autoSize;return this.htmlComp.layout.autoSize=!1,this.htmlComp.revalidateLayout(),this.htmlComp.layout.autoSize=t,this.updateCacheBounds(),!1}},{key:"_onDialogMouseDown",value:function(){this.activate()}},{key:"activate",value:function(){this.session.desktop.activateForm(this)}},{key:"show",value:function(){this.session.desktop.showForm(this)}},{key:"hide",value:function(){this.session.desktop.hideForm(this)}},{key:"_renderHeader",value:function(){this.isDialog()&&(this.$header=this.$container.appendDiv("header"),this.$statusContainer=this.$header.appendDiv("status-container"),this.$icon=this.$header.appendDiv("icon-container"),this.$title=this.$header.appendDiv("title"),dh.installForEllipsis(this.$title,{parent:this}),this.$subTitle=this.$header.appendDiv("sub-title"),dh.installForEllipsis(this.$subTitle,{parent:this}))}},{key:"_setRootGroupBox",value:function(e){this._setProperty("rootGroupBox",e),this.rootGroupBox&&(this.rootGroupBox.setMainBox(!0),(this.isDialog()||this.searchForm||this.parent instanceof J8)&&this.rootGroupBox.setMenuBarPosition(rY.MenuBarPosition.BOTTOM))}},{key:"_renderSaveNeeded",value:function(){if(this.isDialog()){if(this.saveNeeded&&this.saveNeededVisible){if(this.$container.addClass("save-needed"),this.$saveNeeded)return;this.$close?this.$saveNeeded=this.$close.beforeDiv("status save-needer"):this.$saveNeeded=this.$statusContainer.appendDiv("status save-needer")}else{if(this.$container.removeClass("save-needed"),!this.$saveNeeded)return;this.$saveNeeded.remove(),this.$saveNeeded=null}this.invalidateLayoutTree()}}},{key:"setAskIfNeedSave",value:function(e){this.setProperty("askIfNeedSave",e),this.lifecycle&&this.lifecycle.setAskIfNeedSave(e)}},{key:"setDisplayHint",value:function(e){this.setProperty("displayHint",e)}},{key:"setSaveNeededVisible",value:function(e){this.setProperty("saveNeededVisible",e)}},{key:"_renderSaveNeededVisible",value:function(){this._renderSaveNeeded()}},{key:"_renderCssClass",value:function(e,t){e=e||this.cssClass,this.$container.removeClass(t),this.$container.addClass(e),this.invalidateLayoutTree()}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"_setStatus",value:function(e){e=pi.ensure(e),this._setProperty("status",e)}},{key:"_renderStatus",value:function(){var e;this.isDialog()&&(this.$statusIcons.forEach((function(e){e.remove()})),this.$statusIcons=[],this.status&&this.status.asFlatList().forEach(function(t){(e=this._renderSingleStatus(t,e))&&this.$statusIcons.push(e)}.bind(this)),this.invalidateLayoutTree())}},{key:"_renderSingleStatus",value:function(e,t){if(e&&e.iconId){var n=this.$statusContainer.appendIcon(e.iconId,"status");return e.cssClass()&&n.addClass(e.cssClass()),n.prependTo(this.$statusContainer),n}return t}},{key:"_updateTitleForWindow",value:function(){var e=En.join(" - ",this.title,this.subTitle),t=this.session.desktop.title;this.popupWindow.title(e||t)}},{key:"_updateTitleForDom",value:function(){var e=this.title;if(!e&&this.closable&&(e=En.plainText("&nbsp;")),e||this.subTitle){var t=n(this.$container,"title-box");e?n(t,"title").text(e).icon(this.iconId):i(t,"title"),En.hasText(e)?n(t,"sub-title").text(this.subTitle):i(t,"sub-title")}else i(this.$container,"title-box");function n(e,t){var n=e.children("."+t);return 0===n.length&&(n=this.$parent.appendDiv(t)),n}function i(e,t){e.children("."+t).remove()}}},{key:"isDialog",value:function(){return this.displayHint===o.DisplayHint.DIALOG}},{key:"isPopupWindow",value:function(){return this.displayHint===o.DisplayHint.POPUP_WINDOW}},{key:"isView",value:function(){return this.displayHint===o.DisplayHint.VIEW}},{key:"_onMove",value:function(e){this.trigger("move",e),this.updateCacheBounds()}},{key:"updateCacheBounds",value:function(){this.cacheBounds&&this.storeCacheBounds(this.htmlComp.bounds())}},{key:"appendTo",value:function(e){this.$container.appendTo(e)}},{key:"setTitle",value:function(e){this.setProperty("title",e)}},{key:"_renderTitle",value:function(){this.isDialog()?(this.$title.text(this.title),this.$header.toggleClass("no-title",!this.title&&!this.subTitle)):this.isPopupWindow()&&this._updateTitleForWindow(),this.invalidateLayoutTree()}},{key:"setSubTitle",value:function(e){this.setProperty("subTitle",e)}},{key:"_renderSubTitle",value:function(){this.isDialog()?(this.$subTitle.text(this.subTitle),this.$header.toggleClass("no-title",!this.title&&!this.subTitle)):this.isPopupWindow()&&this._updateTitleForWindow(),this.invalidateLayoutTree()}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(){this.isDialog()&&(this.$icon.icon(this.iconId),this.invalidateLayoutTree())}},{key:"_setViews",value:function(e){e&&e.forEach(function(e){e.setDisplayParent(this)}.bind(this)),this._setProperty("views",e)}},{key:"setDisabledStyle",value:function(e){this.rootGroupBox.setDisabledStyle(e)}},{key:"setDisplayParent",value:function(e){this.setProperty("displayParent",e)}},{key:"_setDisplayParent",value:function(e){e instanceof o&&e.parent instanceof J8&&e.isView()&&(e=o.findNonWrappedForm(e)),this._setProperty("displayParent",e),e&&this.setParent(this.findDesktop().computeParentForDisplayParent(e))}},{key:"_attach",value:function(){this.$parent.append(this.$container),this.isView()&&this.invalidateLayoutTree(!1),!this.isView()&&!this.isDialog()||this.detailForm||this.session.desktop._setFormActivated(this),KO(JO(o.prototype),"_attach",this).call(this)}},{key:"_postAttach",value:function(){this.formController.attachDialogs(),this.messageBoxController.attach(),this.fileChooserController.attach(),KO(JO(o.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.formController.detachDialogs(),this.messageBoxController.detach(),this.fileChooserController.detach(),this.$container.detach(),KO(JO(o.prototype),"_detach",this).call(this)}},{key:"renderInitialFocus",value:function(){var e=!1;if(this.initialFocus)e=this.initialFocus.focus();else if(!this.$container.isOrHas(this.$container.activeElement())){var t=this.session.focusManager;e=t.requestFocusIfReady(t.findFirstFocusableElement(this.$container))}if(e){var n=this.$container.activeElement().scrollParent();n.scrollTop(0),n.scrollLeft(0)}}},{key:"_initialFocusElement",value:function(){var e;return this.initialFocus&&(e=this.initialFocus.getFocusableElement()),e||(e=this.session.focusManager.findFirstFocusableElement(this.$container)),e}},{key:"_installFocusContext",value:function(){(this.isDialog()||this.isPopupWindow())&&this.session.focusManager.installFocusContext(this.$container,Pc.NONE)}},{key:"_uninstallFocusContext",value:function(){(this.isDialog()||this.isPopupWindow())&&this.session.focusManager.uninstallFocusContext(this.$container)}},{key:"touch",value:function(){this.rootGroupBox.touch()}},{key:"inFront",value:function(){return this.rendered&&this.attached}},{key:"visitFields",value:function(e){this.rootGroupBox.visitFields(e)}},{key:"visitDisplayChildren",value:function(e,t){t||(t=function(e){return!0});var n=function(n){e(n),n instanceof o&&n.visitDisplayChildren(e,t)};this.dialogs.filter(t).forEach(n,this),this.messageBoxes.filter(t).forEach(n,this),this.fileChoosers.filter(t).forEach(n,this)}},{key:"storeCacheBounds",value:function(e){if(this.cacheBounds){var t="scout:formBounds:"+this.cacheBoundsKey;Gi.setItem(localStorage,t,JSON.stringify(e))}}},{key:"readCacheBounds",value:function(){if(!this.cacheBounds)return null;var e="scout:formBounds:"+this.cacheBoundsKey,t=Gi.getItem(localStorage,e);return t?(t=JSON.parse(t),new Fo(t.x,t.y,t.width,t.height)):null}}])&&UO(t.prototype,n),i&&UO(t,i),o}(de);function QO(e){return(QO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tT(e,t,n){return(tT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oT(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function nT(e,t){return(nT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oT(e);if(t){var r=oT(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rT(this,n)}}function rT(e,t){return!t||"object"!==QO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oT(e){return(oT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(ZO,"DisplayHint",{DIALOG:"dialog",POPUP_WINDOW:"popupWindow",VIEW:"view"});var sT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nT(e,t)}(o,e);var t,n,i,r=iT(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_initModel",value:function(e,t){return(e=tT(oT(o.prototype),"_initModel",this).call(this,e,t)).logicalGrid=null,e}},{key:"_onWidgetEvent",value:function(e){"abort"===e.type?this._onWidgetAbort(e):"close"===e.type?this._onWidgetClose(e):tT(oT(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onWidgetAbort",value:function(e){e.preventDefault(),this._send("formClosing")}},{key:"_onWidgetClose",value:function(e){this._send("close")}},{key:"onModelAction",value:function(e){"requestFocus"===e.type?this._onRequestFocus(e):"requestInput"===e.type?this._onRequestInput(e):tT(oT(o.prototype),"onModelAction",this).call(this,e)}},{key:"_onRequestFocus",value:function(e){this.session.getOrCreateWidget(e.formField,this.widget).focus()}},{key:"_onRequestInput",value:function(e){this.session.getOrCreateWidget(e.formField,this.widget).requestInput()}}])&&eT(t.prototype,n),i&&eT(t,i),o}(fe);function aT(e){return(aT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lT(e,t){return(lT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=hT(e);if(t){var r=hT(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fT(this,n)}}function fT(e,t){return!t||"object"!==aT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hT(e){return(hT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lT(e,t)}(o,e);var t,n,i,r=cT(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_validate",value:function(e){e.rootGroupBox.gridData=kV.createFromHints(e.rootGroupBox)}}])&&uT(t.prototype,n),i&&uT(t,i),o}(Jo);function pT(e){return(pT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vT(e,t){return(vT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mT(e);if(t){var r=mT(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gT(this,n)}}function gT(e,t){return!t||"object"!==pT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mT(e){return(mT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vT(e,t)}(o,e);var t,n,i,r=bT(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).form=e,t}return t=o,(n=[{key:"layout",value:function(e){var t,n=Uo.get(e),i=this._htmlRootGroupBox();this.form.validateLogicalGrid(),t=n.availableSize().subtract(n.insets()).subtract(i.margins()),this.form.isDialog()&&(t.height-=this._titleHeight()),s.a.log.isTraceEnabled()&&s.a.log.trace("(FormLayout#layout) rootGbSize="+t),i.setSize(t)}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n,i=Uo.get(e),r=this._htmlRootGroupBox();this.form.validateLogicalGrid();var o=this._titleHeight();return t.heightHint&&(t.heightHint-=o),(n=r.prefSize(t).add(i.insets()).add(r.margins())).height+=o,n}},{key:"_htmlRootGroupBox",value:function(){var e=this.form.$container.children(".root-group-box");return Uo.get(e)}},{key:"_titleHeight",value:function(){return this.form.$header&&"absolute"!==this.form.$header.css("position")?No.prefSize(this.form.$header,!0).height:0}}])&&yT(t.prototype,n),i&&yT(t,i),o}(zo);function wT(e){return(wT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ST(e,t){return(ST=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=CT(e);if(t){var r=CT(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return TT(this,n)}}function TT(e,t){return!t||"object"!==wT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CT(e){return(CT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ST(e,t)}(o,e);var t,n,i,r=OT(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"handle",value:function(e){this.field.toggle()}},{key:"_postRenderKeyBox",value:function(e){if(this.field.iconId){var t=e.find(".icon").width()/2-e.find(".key-box").outerWidth()/2+e.cssPaddingLeft();e.find(".key-box").cssLeft(t)}}}])&&kT(t.prototype,n),i&&kT(t,i),o}(Uh);function RT(e){return(RT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ET(e,t,n){return(ET="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$T(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function DT(e,t){return(DT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function FT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$T(e);if(t){var r=$T(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return AT(this,n)}}function AT(e,t){return!t||"object"!==RT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $T(e){return($T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DT(e,t)}(o,e);var t,n,i,r=FT(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).form,e.toggleAction=!0,e._addWidgetProperties("form"),e}return t=o,(n=[{key:"_init",value:function(e){ET($T(o.prototype),"_init",this).call(this,e),this.popupStyle||(this.session.userAgent.deviceType===Mt.Type.MOBILE?this.popupStyle=o.PopupStyle.MOBILE:this.popupStyle=o.PopupStyle.DEFAULT)}},{key:"_renderForm",value:function(){this.rendered&&this._renderSelected()}},{key:"clone",value:function(e,t){return(e=e||{}).form=this.form,ET($T(o.prototype),"clone",this).call(this,e,t)}},{key:"_addFormRemoveHandler",value:function(){this.form&&this.form.one("remove",function(e){this._onFormRemove(e)}.bind(this))}},{key:"_onFormRemove",value:function(e){if(this.selected){this.destroying||this.removing||this.setSelected(!1);var t=this.findParent((function(e){return e instanceof Rg}));!t||t.destroying||t.removing||t.close()}}},{key:"_openPopup",value:function(){ET($T(o.prototype),"_openPopup",this).call(this),this._addFormRemoveHandler()}},{key:"_createPopup",value:function(){return this.form.rootGroupBox.setMenuBarPosition(rY.MenuBarPosition.BOTTOM),this.popupStyle===o.PopupStyle.MOBILE?O.create("MobilePopup",{parent:this.session.desktop,widget:this.form,title:this.form.title}):O.create("FormMenuPopup",{parent:this,formMenu:this,horizontalAlignment:this.popupHorizontalAlignment,verticalAlignment:this.popupVerticalAlignment})}},{key:"_doActionTogglesPopup",value:function(){return!!this.form}},{key:"_handleSelectedInEllipsis",value:function(){this.popupStyle===o.PopupStyle.MOBILE?this._doActionTogglesPopup()&&(this.selected?this._openPopup():this._closePopup()):ET($T(o.prototype),"_handleSelectedInEllipsis",this).call(this)}},{key:"_createActionKeyStroke",value:function(){return new PT(this)}}])&&xT(t.prototype,n),i&&xT(t,i),o}(xb);function MT(e){return(MT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IT(e,t){return(IT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=NT(e);if(t){var r=NT(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return BT(this,n)}}function BT(e,t){return!t||"object"!==MT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NT(e){return(NT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(jT,"PopupStyle",{DEFAULT:"default",MOBILE:"mobile"});var HT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IT(e,t)}(n,e);var t=LT(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Wb);function VT(e){return(VT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zT(e,t,n){return(zT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=YT(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function GT(e,t){return(GT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=YT(e);if(t){var r=YT(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return KT(this,n)}}function KT(e,t){return!t||"object"!==VT(t)&&"function"!=typeof t?qT(e):t}function qT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YT(e){return(YT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var XT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GT(e,t)}(o,e);var t,n,i,r=UT(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).formMenu=null,e.formMenuPropertyChangeHandler=e._onFormMenuPropertyChange.bind(qT(e)),e._addWidgetProperties("form"),e}return t=o,(n=[{key:"_init",value:function(e){e.form=e.formMenu.form,e.initialFocus=e.formMenu.form._initialFocusElement.bind(e.formMenu.form),zT(YT(o.prototype),"_init",this).call(this,e),this.$formMenu=this.formMenu.$container,this.$headBlueprint=this.$formMenu}},{key:"_createLayout",value:function(){return new rC(this)}},{key:"_render",value:function(){zT(YT(o.prototype),"_render",this).call(this),this.$container.addClass("form-menu-popup"),this.form.renderInitialFocusEnabled=!1,this.form.render(this.$body),this._headVisible&&this.formMenu.on("propertyChange",this.formMenuPropertyChangeHandler)}},{key:"_remove",value:function(){zT(YT(o.prototype),"_remove",this).call(this),this._headVisible&&this.formMenu.off("propertyChange",this.formMenuPropertyChangeHandler)}},{key:"_renderHead",value:function(){zT(YT(o.prototype),"_renderHead",this).call(this),this.formMenu.uiCssClass&&this._copyCssClassToHead(this.formMenu.uiCssClass),this.formMenu.cssClass&&this._copyCssClassToHead(this.formMenu.cssClass),this._copyCssClassToHead("unfocusable")}},{key:"_onFormMenuPropertyChange",value:function(e){this.session.layoutValidator.schedulePostValidateFunction(function(){this.rendered&&(this.rerenderHead(),this.position())}.bind(this))}},{key:"_onWindowResize",value:function(){this.rendered&&(this.revalidateLayout(),this.position(!1))}}])&&WT(t.prototype,n),i&&WT(t,i),o}(op);function JT(e){return(JT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QT(e,t,n){return(QT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iC(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function eC(e,t){return(eC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=iC(e);if(t){var r=iC(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return nC(this,n)}}function nC(e,t){return!t||"object"!==JT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iC(e){return(iC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eC(e,t)}(o,e);var t,n,i,r=tC(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).popup=e,t}return t=o,(n=[{key:"_setSize",value:function(e){var t,n=this.popup.form.htmlComp;QT(iC(o.prototype),"_setSize",this).call(this,e),t=(t=No.size(this.popup.$body)).subtract(No.insets(this.popup.$body)),n.setSize(t)}},{key:"preferredLayoutSize",value:function(e){var t=this.popup.htmlComp,n=this.popup.form.htmlComp;return n.prefSize().add(t.insets()).add(No.insets(this.popup.$body,!0)).add(n.margins())}}])&&ZT(t.prototype,n),i&&ZT(t,i),o}(dp);function oC(e){return(oC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aC(e,t,n){return(aC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fC(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function uC(e,t){return(uC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=fC(e);if(t){var r=fC(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cC(this,n)}}function cC(e,t){return!t||"object"!==oC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fC(e){return(fC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uC(e,t)}(o,e);var t,n,i,r=lC(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).emptyMandatoryElementsTextKey="FormEmptyMandatoryFieldsMessage",e.invalidElementsTextKey="FormInvalidFieldsMessage",e.saveChangesQuestionTextKey="FormSaveChangesQuestion",e}return t=o,(n=[{key:"init",value:function(e){O.assertParameter("widget",e.widget,ZO),aC(fC(o.prototype),"init",this).call(this,e)}},{key:"_reset",value:function(){this.widget.visitFields((function(e){e instanceof GV&&e.resetValue()}))}},{key:"_invalidElements",value:function(){var e=[],t=[];return this.widget.visitFields((function(n){var i=n.getValidationResult();i.valid||(i.validByErrorStatus?i.validByMandatory||e.push(n):t.push(n))})),{missingElements:e,invalidElements:t}}},{key:"_invalidElementText",value:function(e){return e.label}},{key:"_missingElementText",value:function(e){return e.label}},{key:"_validateWidget",value:function(){return this.widget._validate()}},{key:"markAsSaved",value:function(){this.widget.visitFields((function(e){e.markAsSaved()}))}},{key:"requiresSave",value:function(){var e=!1;return this.widget.visitFields((function(t){t.updateRequiresSave(),t.requiresSave&&(e=!0)})),e}}])&&sC(t.prototype,n),i&&sC(t,i),o}(xk);function dC(e){return(dC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yC(e,t,n){return(yC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mC(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function vC(e,t){return(vC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mC(e);if(t){var r=mC(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gC(this,n)}}function gC(e,t){return!t||"object"!==dC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mC(e){return(mC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vC(e,t)}(o,e);var t,n,i,r=bC(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).actionStyle=Eh.ActionStyle.BUTTON,e.keyStroke="esc",e.systemType=WG.SystemType.CANCEL,e.inheritAccessibility=!1,e.preventDoubleClick=!0,e}return t=o,(n=[{key:"_init",value:function(e){yC(mC(o.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("CancelButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new Kt;this.trigger("action",t),t.defaultPrevented||e.cancel()}}])&&pC(t.prototype,n),i&&pC(t,i),o}(xb);function wC(e){return(wC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SC(e,t,n){return(SC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PC(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function OC(e,t){return(OC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function TC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=PC(e);if(t){var r=PC(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return CC(this,n)}}function CC(e,t){return!t||"object"!==wC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function PC(e){return(PC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var RC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OC(e,t)}(o,e);var t,n,i,r=TC(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).actionStyle=Eh.ActionStyle.BUTTON,e.keyStroke="esc",e.systemType=WG.SystemType.CLOSE,e.inheritAccessibility=!1,e.preventDoubleClick=!0,e}return t=o,(n=[{key:"_init",value:function(e){SC(PC(o.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("CloseButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new Kt;this.trigger("action",t),t.defaultPrevented||e.close()}}])&&kC(t.prototype,n),i&&kC(t,i),o}(xb);function xC(e){return(xC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function DC(e,t,n){return(DC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jC(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function FC(e,t){return(FC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=jC(e);if(t){var r=jC(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $C(this,n)}}function $C(e,t){return!t||"object"!==xC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jC(e){return(jC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FC(e,t)}(o,e);var t,n,i,r=AC(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).actionStyle=Eh.ActionStyle.BUTTON,e.keyStroke="enter",e.systemType=WG.SystemType.OK,e.preventDoubleClick=!0,e}return t=o,(n=[{key:"_init",value:function(e){DC(jC(o.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("OkButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new Kt;this.trigger("action",t),t.defaultPrevented||e.ok()}}])&&EC(t.prototype,n),i&&EC(t,i),o}(xb);function IC(e){return(IC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BC(e,t,n){return(BC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WC(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function NC(e,t){return(NC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function HC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=WC(e);if(t){var r=WC(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return VC(this,n)}}function VC(e,t){return!t||"object"!==IC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function WC(e){return(WC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NC(e,t)}(o,e);var t,n,i,r=HC(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).actionStyle=Eh.ActionStyle.BUTTON,e.systemType=WG.SystemType.RESET,e.preventDoubleClick=!0,e}return t=o,(n=[{key:"_init",value:function(e){BC(WC(o.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("ResetButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new Kt;this.trigger("action",t),t.defaultPrevented||e.reset()}}])&&LC(t.prototype,n),i&&LC(t,i),o}(xb);function GC(e){return(GC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function KC(e,t,n){return(KC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=JC(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function qC(e,t){return(qC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=JC(e);if(t){var r=JC(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return XC(this,n)}}function XC(e,t){return!t||"object"!==GC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function JC(e){return(JC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ZC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qC(e,t)}(o,e);var t,n,i,r=YC(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).actionStyle=Eh.ActionStyle.BUTTON,e.keyStroke="enter",e.systemType=WG.SystemType.SAVE,e.preventDoubleClick=!0,e}return t=o,(n=[{key:"_init",value:function(e){KC(JC(o.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("SaveButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new Kt;this.trigger("action",t),t.defaultPrevented||e.save()}}])&&UC(t.prototype,n),i&&UC(t,i),o}(xb);function QC(e){return(QC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tP(e,t,n){return(tP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oP(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function nP(e,t){return(nP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oP(e);if(t){var r=oP(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rP(this,n)}}function rP(e,t){return!t||"object"!==QC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oP(e){return(oP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sP,aP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nP(e,t)}(o,e);var t,n,i,r=iP(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).autoSize=!0,t}return t=o,i=[{key:"fitContainerInWindow",value:function(e,t,n,i){var r=e.width-i.horizontal()-t.x,o=e.height-i.vertical()-t.y,s=new Co;return s.width=Math.min(r,n.width),s.height=Math.min(o,n.height),s}},{key:"positionContainerInWindow",value:function(e){var t=e.windowSize(),n=Uo.get(e).size(!0),i=(t.width-n.width)/2,r=(t.height-n.height)/2;return r-=r/5,i=Math.floor(i),r=Math.floor(r),new Eo(i,r)}}],(n=[{key:"layout",value:function(e){if(this.autoSize){var t,n=this.form.htmlComp,i=this.form.readCacheBounds(),r=n.margins(),s=e.windowSize();t=i||n.bounds();var a=this._calcSize(e,t,i);e.toggleClass("full-width",0===t.x&&0===r.horizontal()&&s.width===a.width).toggleClass("full-height",0===t.y&&0===r.vertical()&&s.height===a.height),n.layouted&&(a.width=Math.max(a.width,t.width),a.height=Math.max(a.height,t.height)),No.setSize(e,a),tP(oP(o.prototype),"layout",this).call(this,e)}else tP(oP(o.prototype),"layout",this).call(this,e)}},{key:"_calcSize",value:function(e,t,n){var i,r=this.form.htmlComp.margins(),s=e.windowSize();return n&&(i=n.dimension(),t=n,i=o.fitContainerInWindow(s,t.point(),i,r),n.dimension().width===i.width)?i:(i=this.preferredLayoutSize(e,{widthOnly:!0}),i=o.fitContainerInWindow(s,t.point(),i,r),i=this.preferredLayoutSize(e,{widthHint:i.width}).ceil(),i=o.fitContainerInWindow(s,t.point(),i,r))}}])&&eP(t.prototype,n),i&&eP(t,i),o}(_T);function uP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var lP=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active=!0,this.globalState=null,this._responsiveHandlers=[]}var t,n,i;return t=e,i=[{key:"get",value:function(){return sP}}],(n=[{key:"init",value:function(){}},{key:"destroy",value:function(){this._responsiveHandlers.forEach((function(e){e.destroy()}))}},{key:"setActive",value:function(e){this.active=e}},{key:"setGlobalState",value:function(e){this.globalState=e}},{key:"handleResponsive",value:function(t,n){if(!this.active)return!1;if(!t.responsiveHandler||!t.responsiveHandler.active())return!1;var i,r=t.responsiveHandler.state;return this.globalState?i=this.globalState:n<t.responsiveHandler.getCompactThreshold()&&t.responsiveHandler.acceptState(e.ResponsiveState.COMPACT)?i=e.ResponsiveState.COMPACT:(r===e.ResponsiveState.COMPACT&&t.responsiveHandler.transform(e.ResponsiveState.CONDENSED),i=n<t.responsiveHandler.getCondensedThreshold()&&t.responsiveHandler.acceptState(e.ResponsiveState.CONDENSED)?e.ResponsiveState.CONDENSED:e.ResponsiveState.NORMAL),t.responsiveHandler.transform(i)}},{key:"reset",value:function(t,n){if(this.active)return!!(t.responsiveHandler&&t.responsiveHandler.active()||n)&&void t.responsiveHandler.transform(e.ResponsiveState.NORMAL,n)}},{key:"registerHandler",value:function(e,t){e.responsiveHandler&&e.responsiveHandler.destroy(),e.responsiveHandler=t}},{key:"unregisterHandler",value:function(e){e.responsiveHandler&&(e.responsiveHandler.destroy(),e.responsiveHandler=null)}}])&&uP(t.prototype,n),i&&uP(t,i),e}();function cP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(lP,"ResponsiveState",{NORMAL:"normal",CONDENSED:"condensed",COMPACT:"compact"}),x.addListener("prepare",(function(){sP||(sP=O.create("ResponsiveManager")).init()}));var fP=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.widget=null,this.compactThreshold=-1,this.condensedThreshold=-1,this.oldState=lP.ResponsiveState.NORMAL,this.state=lP.ResponsiveState.NORMAL,this.allowedStates=[lP.ResponsiveState.NORMAL,lP.ResponsiveState.COMPACT],this.transformations=oi.createMap(),this.enabledTransformations=oi.createMap(),this._destroyHandler=this._onDestroy.bind(this)}var t,n,i;return t=e,(n=[{key:"init",value:function(e){s.a.extend(this,e),this.widget.one("destroy",this._destroyHandler)}},{key:"destroy",value:function(){this.widget.off("destroy",this._destroyHandler)}},{key:"getCompactThreshold",value:function(){return this.compactThreshold}},{key:"getCondensedThreshold",value:function(){return this.condensedThreshold}},{key:"active",value:function(){return!0}},{key:"setAllowedStates",value:function(e){this.allowedStates=e}},{key:"acceptState",value:function(e){return et.containsAny(this.allowedStates,e)}},{key:"_registerTransformation",value:function(e,t){this.transformations[e]=t.bind(this)}},{key:"_enableTransformation",value:function(e,t){var n=this.enabledTransformations[e];n||(n=[],this.enabledTransformations[e]=n),n.push(t)}},{key:"_disableTransformation",value:function(e,t){et.remove(this.enabledTransformations[e],t)}},{key:"_storeFieldProperty",value:function(e,t,n){e._setProperty("responsive-"+t,n)}},{key:"_hasFieldProperty",value:function(e,t){return e.hasOwnProperty("responsive-"+t)}},{key:"_getFieldProperty",value:function(e,t){return e["responsive-"+t]}},{key:"transform",value:function(e,t){return!(this.state===e&&!t||(this.oldState=this.state,this.state=e,this.oldState!==this.state?(n=this.enabledTransformations[this.oldState]||[],i=this.enabledTransformations[this.state]||[]):(n=[],this.state!==lP.ResponsiveState.NORMAL&&et.pushAll(n,this.enabledTransformations[lP.ResponsiveState.NORMAL]),this.state!==lP.ResponsiveState.CONDENSED&&et.pushAll(n,this.enabledTransformations[lP.ResponsiveState.CONDENSED]),this.state!==lP.ResponsiveState.COMPACT&&et.pushAll(n,this.enabledTransformations[lP.ResponsiveState.COMPACT]),i=this.enabledTransformations[this.state]||[]),this._transformationsToApply=et.diff(i,n),this._transformationsToReset=et.diff(n,i),this._transform(),0));var n,i}},{key:"_transform",value:function(){this._transformWidget(this.widget)}},{key:"_transformWidget",value:function(e){this._transformationsToApply.forEach(function(t){this.transformations[t](e,!0)}.bind(this)),this._transformationsToReset.forEach(function(t){this.transformations[t](e,!1)}.bind(this))}},{key:"_onDestroy",value:function(e){this.destroy()}}])&&cP(t.prototype,n),i&&cP(t,i),e}();function hP(e){return(hP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pP(e,t,n){return(pP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mP(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function yP(e,t){return(yP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mP(e);if(t){var r=mP(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bP(this,n)}}function bP(e,t){return!t||"object"!==hP(t)&&"function"!=typeof t?gP(e):t}function gP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mP(e){return(mP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yP(e,t)}(o,e);var t,n,i,r=vP(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._initDefaults(),e.allowedStates=[lP.ResponsiveState.NORMAL,lP.ResponsiveState.CONDENSED,lP.ResponsiveState.COMPACT],e._formFieldAddedHandler=e._onFormFieldAdded.bind(gP(e)),e._compositeFields=[],e._htmlPropertyChangeHandler=e._onHtmlEnvironmenPropertyChange.bind(gP(e)),e}return t=o,(n=[{key:"_initDefaults",value:function(){this.compactThreshold=Vo.get().formColumnWidth}},{key:"_onHtmlEnvironmenPropertyChange",value:function(){this._initDefaults()}},{key:"init",value:function(e){pP(mP(o.prototype),"init",this).call(this,e);var t=o.TransformationType,n=lP.ResponsiveState;this._registerTransformation(t.LABEL_POSITION_ON_FIELD,this._transformLabelPositionOnField),this._registerTransformation(t.LABEL_POSITION_ON_TOP,this._transformLabelPositionOnTop),this._registerTransformation(t.LABEL_VISIBILITY,this._transformLabelVisibility),this._registerTransformation(t.STATUS_POSITION_ON_TOP,this._transformStatusPosition),this._registerTransformation(t.STATUS_VISIBILITY,this._transformStatusVisibility),this._registerTransformation(t.VERTICAL_ALIGNMENT,this._transformVerticalAlignment),this._registerTransformation(t.GRID_COLUMN_COUNT,this._transformGridColumnCount),this._registerTransformation(t.HIDE_PLACE_HOLDER_FIELD,this._transformHidePlaceHolderField),this._registerTransformation(t.FIELD_SCALABLE,this._transformFieldScalable),this._enableTransformation(n.CONDENSED,t.LABEL_POSITION_ON_TOP),this._enableTransformation(n.CONDENSED,t.LABEL_VISIBILITY),this._enableTransformation(n.CONDENSED,t.VERTICAL_ALIGNMENT),this._enableTransformation(n.COMPACT,t.LABEL_POSITION_ON_TOP),this._enableTransformation(n.COMPACT,t.LABEL_VISIBILITY),this._enableTransformation(n.COMPACT,t.STATUS_POSITION_ON_TOP),this._enableTransformation(n.COMPACT,t.STATUS_VISIBILITY),this._enableTransformation(n.COMPACT,t.VERTICAL_ALIGNMENT),this._enableTransformation(n.COMPACT,t.GRID_COLUMN_COUNT),this._enableTransformation(n.COMPACT,t.HIDE_PLACE_HOLDER_FIELD),this._enableTransformation(n.COMPACT,t.FIELD_SCALABLE),Vo.get().on("propertyChange",this._htmlPropertyChangeHandler),this.widget.visitFields(function(e){e instanceof EV&&(e.on("propertyChange",this._formFieldAddedHandler),this._compositeFields.push(e))}.bind(this))}},{key:"destroy",value:function(){pP(mP(o.prototype),"destroy",this).call(this),this._compositeFields.forEach(function(e){e.off("propertyChange",this._formFieldAddedHandler)}.bind(this)),Vo.get().off("propertyChange",this._htmlPropertyChangeHandler)}},{key:"active",value:function(){return this.widget.responsive}},{key:"getCondensedThreshold",value:function(){return this.condensedThreshold>0?this.condensedThreshold:this.widget.htmlComp.prefSize({widthOnly:!0}).width}},{key:"_transform",value:function(){this.widget.visitFields(this._transformWidget.bind(this))}},{key:"_transformWidget",value:function(e){if(e!==this.widget&&e instanceof rY&&null!==e.responsive)return JW.SKIP_SUBTREE;var t;e instanceof GH&&(e.htmlComp&&(e.htmlComp.suppressInvalidate=!0,(t=e.htmlComp.getParent())&&(t.suppressInvalidate=!0)),pP(mP(o.prototype),"_transformWidget",this).call(this,e),e.htmlComp&&(e.htmlComp.suppressInvalidate=!1),t&&(t.suppressInvalidate=!1))}},{key:"_transformLabelPositionOnField",value:function(e,t){e.parent instanceof QQ||e instanceof WU||e instanceof SX||(t?(this._storeFieldProperty(e,"labelPosition",e.labelPosition),e.setLabelPosition(GH.LabelPosition.ON_FIELD)):this._hasFieldProperty(e,"labelPosition")&&e.setLabelPosition(this._getFieldProperty(e,"labelPosition")))}},{key:"_transformLabelPositionOnTop",value:function(e,t){e.parent instanceof QQ||e instanceof WU||e instanceof SX||e.labelPosition===GH.LabelPosition.ON_FIELD||(t?(this._storeFieldProperty(e,"labelPosition",e.labelPosition),e.setLabelPosition(GH.LabelPosition.TOP)):this._hasFieldProperty(e,"labelPosition")&&e.setLabelPosition(this._getFieldProperty(e,"labelPosition")))}},{key:"_transformLabelVisibility",value:function(e,t){e instanceof WU&&(t?(this._storeFieldProperty(e,"labelVisible",e.labelVisible),e.setLabelVisible(!1)):this._hasFieldProperty(e,"labelVisible")&&e.setLabelVisible(this._getFieldProperty(e,"labelVisible")))}},{key:"getGridData",value:function(e){return new kV(e.gridDataHints)}},{key:"setGridData",value:function(e,t){e.setGridDataHints(t)}},{key:"_transformStatusPosition",value:function(e,t){t?(this._storeFieldProperty(e,"statusPosition",e.statusPosition),e.setStatusPosition(GH.StatusPosition.TOP)):this._hasFieldProperty(e,"statusPosition")&&e.setStatusPosition(this._getFieldProperty(e,"statusPosition"))}},{key:"_transformStatusVisibility",value:function(e,t){t?(this._storeFieldProperty(e,"statusVisible",e.statusVisible),e.setStatusVisible(!1)):this._hasFieldProperty(e,"statusVisible")&&e.setStatusVisible(this._getFieldProperty(e,"statusVisible"))}},{key:"_transformVerticalAlignment",value:function(e,t){var n=e instanceof WG&&e.displayStyle===WG.DisplayStyle.DEFAULT,i=e instanceof WU,r=e.labelPosition===GH.LabelPosition.ON_FIELD&&e.gridData&&1===e.gridData.h;if((n||i||r)&&e.gridData){var o=this.getGridData(e);t?(this._storeFieldProperty(e,"fillVertical",o.fillVertical),this._storeFieldProperty(e,"verticalAlignment",o.verticalAlignment),o.fillVertical=!1,o.verticalAlignment=1):(this._hasFieldProperty(e,"fillVertical")&&(o.fillVertical=this._getFieldProperty(e,"fillVertical")),this._hasFieldProperty(e,"verticalAlignment")&&(o.verticalAlignment=this._getFieldProperty(e,"verticalAlignment"))),this.setGridData(e,o)}}},{key:"_transformGridColumnCount",value:function(e,t){e instanceof rY&&(t?(this._storeFieldProperty(e,"gridColumnCount",e.gridColumnCount),e.setGridColumnCount(1)):this._hasFieldProperty(e,"gridColumnCount")&&e.setGridColumnCount(this._getFieldProperty(e,"gridColumnCount")))}},{key:"_transformHidePlaceHolderField",value:function(e,t){e instanceof nZ&&(t?(this._storeFieldProperty(e,"visible",e.visible),e.setVisible(!1)):this._hasFieldProperty(e,"visible")&&e.setVisible(this._getFieldProperty(e,"visible")))}},{key:"_transformFieldScalable",value:function(e,t){if(!(e.parent instanceof QQ)){var n=this.getGridData(e);t&&0===n.weightX?(this._storeFieldProperty(e,"weightX",n.weightX),n.weightX=1):t||this._hasFieldProperty(e,"weightX")&&(n.weightX=this._getFieldProperty(e,"weightX")),this.setGridData(e,n)}}},{key:"_onFormFieldAdded",value:function(e){this.state===lP.ResponsiveState.NORMAL||"fields"!==e.propertyName&&"tabItems"!==e.propertyName||et.diff(e.newValue,e.oldValue).forEach(function(e){e.visitFields(this._transformWidget.bind(this))}.bind(this))}}])&&dP(t.prototype,n),i&&dP(t,i),o}(fP);function wP(e){return(wP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SP(e,t,n){return(SP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PP(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function OP(e,t){return(OP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function TP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=PP(e);if(t){var r=PP(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return CP(this,n)}}function CP(e,t){return!t||"object"!==wP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function PP(e){return(PP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(_P,"TransformationType",{LABEL_POSITION_ON_FIELD:"labelPositionOnField",LABEL_POSITION_ON_TOP:"labelPositionOnTop",LABEL_VISIBILITY:"labelVisibility",STATUS_POSITION_ON_TOP:"statusPositionOnTop",STATUS_VISIBILITY:"statusVisibility",VERTICAL_ALIGNMENT:"verticalAlignment",GRID_COLUMN_COUNT:"gridColumnCount",HIDE_PLACE_HOLDER_FIELD:"hidePlaceHolderField",FIELD_SCALABLE:"fieldScalable"});var RP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OP(e,t)}(o,e);var t,n,i,r=TP(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).compactThreshold=500,e.allowedStates=[lP.ResponsiveState.NORMAL,lP.ResponsiveState.COMPACT],e}return t=o,(n=[{key:"init",value:function(e){SP(PP(o.prototype),"init",this).call(this,e),this._registerTransformation("navigationVisible",this._transformNavigationVisible),this._enableTransformation(lP.ResponsiveState.COMPACT,"navigationVisible")}},{key:"_transformNavigationVisible",value:function(e,t){t?(this._storeFieldProperty(e,"navigationVisible",e.navigationVisible),e.setNavigationVisible(!1)):this._hasFieldProperty(e,"navigationVisible")&&e.setNavigationVisible(this._getFieldProperty(e,"navigationVisible"))}}])&&kP(t.prototype,n),i&&kP(t,i),o}(fP);function xP(e){return(xP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function DP(e,t,n){return(DP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jP(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function FP(e,t){return(FP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=jP(e);if(t){var r=jP(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $P(this,n)}}function $P(e,t){return!t||"object"!==xP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jP(e){return(jP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FP(e,t)}(o,e);var t,n,i,r=AP(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).outline=null,e.nodes=null,e.tileOverviewTitle=null,e.scrollable=!0,e._addWidgetProperties(["pageTileGrid"]),e.$content=null,e.$title=null,e}return t=o,(n=[{key:"_init",value:function(e){DP(jP(o.prototype),"_init",this).call(this,e),this.pageTileGrid||(this.pageTileGrid=this._createPageTileGrid())}},{key:"_renderForm",value:function(){DP(jP(o.prototype),"_renderForm",this).call(this),this.htmlComp.setLayout(new zte(this)),this.$content=this.$container.appendDiv("tile-overview-content"),this.contentHtmlComp=Uo.install(this.$content,this.session),this.$title=this.$content.appendDiv("tile-overview-title").text(this.tileOverviewTitle)}},{key:"_renderProperties",value:function(){DP(jP(o.prototype),"_renderProperties",this).call(this),this.pageTileGrid.rendered&&(this.pageTileGrid=this._createPageTileGrid()),this._renderPageTileGrid(),this._renderScrollable()}},{key:"_renderPageTileGrid",value:function(){this.pageTileGrid.render(this.$content)}},{key:"_createPageTileGrid",value:function(){return scout.create("PageTileGrid",{parent:this,outline:this.outline,nodes:this.nodes})}},{key:"_renderScrollable",value:function(){this.scrollable?this._installScrollbars({axis:"y"}):this._uninstallScrollbars()}},{key:"setPage",value:function(e){this.outline=e.getOutline(),this.nodes=e.childNodes,this.tileOverviewTitle=e.text,this.pageTileGrid.setOutline(this.outline),this.pageTileGrid.setPage(e),this.pageTileGrid.setNodes(this.nodes)}},{key:"_remove",value:function(){this.$content=null,this.$title=null,DP(jP(o.prototype),"_remove",this).call(this)}}])&&EP(t.prototype,n),i&&EP(t,i),o}(ZO);function IP(e){return(IP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LP(e,t){return(LP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=HP(e);if(t){var r=HP(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return NP(this,n)}}function NP(e,t){return!t||"object"!==IP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HP(e){return(HP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var VP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LP(e,t)}(n,e);var t=BP(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sT);function WP(e){return(WP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GP(e,t,n){return(GP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=XP(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function UP(e,t){return(UP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=XP(e);if(t){var r=XP(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return qP(this,n)}}function qP(e,t){return!t||"object"!==WP(t)&&"function"!=typeof t?YP(e):t}function YP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XP(e){return(XP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function JP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ZP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UP(e,t)}(o,e);var t,n,i,r=KP(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).autoResizeColumns=!1,e.columnAddable=!1,e.columnLayoutDirty=!1,e.columns=[],e.contextColumn=null,e.checkable=!1,e.checkableStyle=o.CheckableStyle.CHECKBOX,e.dropType=0,e.dropMaximumSize=Gt.DEFAULT_DROP_MAXIMUM_SIZE,e.groupingStyle=o.GroupingStyle.BOTTOM,e.header=null,e.headerEnabled=!0,e.headerVisible=!0,e.headerMenusEnabled=!0,e.hasReloadHandler=!1,e.hierarchical=!1,e.hierarchicalStyle=o.HierarchicalStyle.DEFAULT,e.keyStrokes=[],e.keyboardNavigation=!0,e.menus=[],e.menuBar=null,e.menuBarVisible=!0,e.contextMenu=null,e.multiCheck=!0,e.multiSelect=!0,e.multilineText=!1,e.scrollToSelection=!1,e.scrollTop=0,e.selectedRows=[],e.sortEnabled=!0,e.tableControls=[],e.tableStatusVisible=!1,e.tableTileGridMediator=null,e.tileMode=!1,e.tileTableHeader=null,e.footer=null,e.footerVisible=!1,e.filters=[],e.rows=[],e.rootRows=[],e.visibleRows=[],e.estimatedRowCount=0,e.maxRowCount=0,e.truncatedCellTooltipEnabled=null,e.visibleRowsMap={},e.rowLevelPadding=0,e.rowsMap={},e.rowHeight=0,e.rowWidth=0,e.rowBorderWidth=0,e.rowBorderLeftWidth=0,e.rowBorderRightWidth=0,e.rowIconVisible=!1,e.rowIconColumnWidth=gD.NARROW_MIN_WIDTH,e.staticMenus=[],e.selectionHandler=new iE(YP(e)),e.tooltips=[],e._filterMap={},e._filteredRows=[],e.tableNodeColumn=null,e._maxLevel=0,e._aggregateRows=[],e._animationRowLimit=25,e._blockLoadThreshold=25,e.updateBuffer=new XE(YP(e)),e.viewRangeSize=10,e.viewRangeDirty=!1,e.viewRangeRendered=new fi(0,0),e.virtual=!0,e._doubleClickSupport=new Lt,e._permanentHeadSortColumns=[],e._permanentTailSortColumns=[],e._filterMenusHandler=e._filterMenus.bind(YP(e)),e._popupOpenHandler=e._onDesktopPopupOpen.bind(YP(e)),e._rerenderViewPortAfterAttach=!1,e._renderViewPortAfterAttach=!1,e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(YP(e)),e._addWidgetProperties(["tableControls","menus","keyStrokes","staticMenus","tileTableHeader","tableTileGridMediator"]),e.$data=null,e.$emptyData=null,e.$fillBefore=null,e.$fillAfter=null,e}return t=o,i=[{key:"parseHorizontalAlignment",value:function(e){return e>0?"right":0===e?"center":"left"}},{key:"linkRowToDiv",value:function(e,t){e&&(e.$row=t),t&&t.data("row",e)}}],(n=[{key:"_init",value:function(e){GP(XP(o.prototype),"_init",this).call(this,e),this.resolveConsts([{property:"hierarchicalStyle",constType:o.HierarchicalStyle},{property:"checkableStyle",constType:o.CheckableStyle},{property:"groupingStyle",constType:o.GroupingStyle}]),this._initColumns(),this.rows.forEach((function(e,t){this.rows[t]=this._initRow(e)}),this),this.setFilters(this.filters),this._updateRowStructure({updateTree:!0}),this.menuBar=this._createMenuBar(),this._setSelectedRows(this.selectedRows),this._setKeyStrokes(this.keyStrokes),this._setMenus(this.menus),this._setTableControls(this.tableControls),this._setTableStatus(this.tableStatus),this._calculateValuesForBackgroundEffect(),this._group(),this._setTileMode(this.tileMode),this._setTileTableHeader(this.tileTableHeader)}},{key:"_initRow",value:function(e){return e instanceof uR||(e.parent=this,e=O.create("TableRow",e)),this.rowsMap[e.id]=e,this.trigger("rowInit",{row:e}),e}},{key:"_initColumns",value:function(){this.columns=this.columns.map((function(e,t){var n=e;return n.session=this.session,n instanceof gD?n._setTable(this):(n.table=this,n=O.create(n)),n.index<0&&(n.index=t),n.checkable&&(this.checkableColumn=n),n}),this),this._setCheckable(this.checkable),this.rowIconVisible&&this._insertRowIconColumn(),this._calculateTableNodeColumn(),this._setHeadAndTailSortColumns(),this.columnLayoutDirty=!0}},{key:"_destroy",value:function(){this._destroyColumns(),GP(XP(o.prototype),"_destroy",this).call(this)}},{key:"_destroyColumns",value:function(){this.columns.forEach((function(e){e.destroy()})),this.checkableColumn=null,this.columns=[]}},{key:"_calculateTableNodeColumn",value:function(){var e=this.visibleColumns().filter((function(e){return e.nodeColumnCandidate})),t=et.first(e);this.tableNodeColumn&&this.tableNodeColumn!==t&&(this.tableNodeColumn.minWidth=this.tableNodeColumn._initialMinWidth),this.tableNodeColumn=t,this.tableNodeColumn&&(this.tableNodeColumn._initialMinWidth=this.tableNodeColumn.minWidth,this.tableNodeColumn.minWidth=this.rowLevelPadding*this._maxLevel+this.tableNodeColumn.tableNodeLevel0CellPadding+8,this.tableNodeColumn.minWidth>this.tableNodeColumn.width&&(this._isDataRendered()?this.resizeColumn(this.tableNodeColumn,this.tableNodeColumn.minWidth):this.tableNodeColumn.width=this.tableNodeColumn.minWidth))}},{key:"_createLoadingSupport",value:function(){return new te({widget:this,$container:function(){return this.$data}.bind(this)})}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){GP(XP(o.prototype),"_initKeyStrokeContext",this).call(this),this._initTableKeyStrokeContext()}},{key:"_initTableKeyStrokeContext",value:function(){this.keyStrokeContext.registerKeyStroke([new qj(this),new nM(this),new CM(this),new $M(this),new cM(this),new gM(this),new J$(this),new sj(this),new HM(this),new Sj(this),new pj(this),new Fj(this),new Nj(this),new V$(this),new Yu(this,this.showContextMenu,this),new CH(this,this.handleAppLinkAction)]),this.keyStrokeContext.registerStopPropagationInterceptor((function(e){e.ctrlKey||e.altKey||!O.isOneOf(e.which,pu.UP,pu.DOWN)||(e.stopPropagation(),e.preventDefault())}))}},{key:"_insertBooleanColumn",value:function(){if(this.checkableStyle!==o.CheckableStyle.TABLE_ROW){var e=O.create("BooleanColumn",{session:this.session,fixedWidth:!0,fixedPosition:!0,guiOnly:!0,nodeColumnCandidate:!1,headerMenuEnabled:!1,showSeparator:!1,width:gD.NARROW_MIN_WIDTH,table:this});et.insert(this.columns,e,0),this.checkableColumn=e}}},{key:"_insertRowIconColumn",value:function(){var e=0,t=O.create("IconColumn",{session:this.session,fixedWidth:!0,fixedPosition:!0,guiOnly:!0,nodeColumnCandidate:!1,headerMenuEnabled:!1,showSeparator:!1,width:this.rowIconColumnWidth,table:this});this.columns[0]===this.checkableColumn&&(e=1),et.insert(this.columns,t,e),this.rowIconColumn=t}},{key:"handleAppLinkAction",value:function(e){var t=s()(e.target),n=this._columnAtX(t.offset().left);this._triggerAppLinkAction(n,t.data("ref"))}},{key:"_isDataRendered",value:function(){return this.rendered&&null!==this.$data}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("table").addDeviceClass(),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new tE(this)),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.tileMode?this._renderTileMode():this._renderData(),this.session.desktop.on("popupOpen",this._popupOpenHandler),this.session.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}},{key:"_renderData",value:function(){this.$data=this.$container.appendDiv("table-data"),this.$data.on("mousedown",".table-row",this._onRowMouseDown.bind(this)).on("mouseup",".table-row",this._onRowMouseUp.bind(this)).on("dblclick",".table-row",this._onRowDoubleClick.bind(this)).on("contextmenu",(function(e){e.preventDefault()})),this._installScrollbars({axis:"both"}),this._installImageListeners(),this._installCellTooltipSupport(),this._calculateRowBorderWidth(),this._updateRowWidth(),this._updateRowHeight(),this._renderViewport(),this.scrollToSelection&&this.revealSelection()}},{key:"_renderProperties",value:function(){GP(XP(o.prototype),"_renderProperties",this).call(this),this._renderTableHeader(),this._renderMenuBarVisible(),this._renderFooterVisible(),this._renderDropType(),this._renderCheckableStyle(),this._renderHierarchicalStyle()}},{key:"_setCssClass",value:function(e){GP(XP(o.prototype),"_setCssClass",this).call(this,e);var t=["table-row-level-padding"];this.cssClass&&t.push(this.cssClass),this.setRowLevelPadding($i.getSize(t.reduce((function(e,t){return e+" "+t}),""),"width","width",15))}},{key:"_removeData",value:function(){this._destroyCellEditorPopup(),this._removeAggregateRows(),this._uninstallImageListeners(),this._uninstallCellTooltipSupport(),this._uninstallScrollbars(),this._removeRows(),this.$fillBefore=null,this.$fillAfter=null,this.$data.remove(),this.$data=null,this.$emptyData=null}},{key:"_remove",value:function(){this.session.desktop.off("propertyChange",this._desktopPropertyChangeHandler),this.session.desktop.off("popupOpen",this._popupOpenHandler),this._uninstallDragAndDropHandler(),this.header=null,this.$data&&this._removeData(),GP(XP(o.prototype),"_remove",this).call(this)}},{key:"setRowLevelPadding",value:function(e){this.setProperty("rowLevelPadding",e)}},{key:"_renderRowLevelPadding",value:function(){this._rerenderViewport()}},{key:"setTableControls",value:function(e){this.setProperty("tableControls",e)}},{key:"_renderTableControls",value:function(){this.footer&&this.footer._renderControls()}},{key:"_setTableControls",value:function(e){var t;for(t=0;t<this.tableControls.length;t++)this.keyStrokeContext.unregisterKeyStroke(this.tableControls[t]);for(this._setProperty("tableControls",e),t=0;t<this.tableControls.length;t++)this.keyStrokeContext.registerKeyStroke(this.tableControls[t]);this._updateFooterVisibility(),this.tableControls.forEach((function(e){e.tableFooter=this.footer}),this)}},{key:"_onImageLoadOrError",value:function(e){var t=s()(e.target);if("in-progress"!==t.data("measure")){var n=t.closest(".table-row"),i=n.data("row");if(i){var r=i.height;i.height=n.outerHeight(!0),r!==i.height&&this.invalidateLayoutTree()}}}},{key:"_onRowMouseDown",value:function(e){this._doubleClickSupport.mousedown(e),this._$mouseDownRow=s()(e.currentTarget),this._mouseDownRowId=this._$mouseDownRow.data("row").id,this._mouseDownColumn=this._columnAtX(e.pageX),this._$mouseDownRow.window().one("mouseup",function(){this._$mouseDownRow=null,this._mouseDownRowId=null,this._mouseDownColumn=null}.bind(this)),this.setContextColumn(this._columnAtX(e.pageX)),this.selectionHandler.onMouseDown(e);var t=3===e.which,n=this._$mouseDownRow.data("row"),i=s()(e.target);if(this._isRowControl(i)&&(n.expanded?this.collapseRow(n):this.expandRow(n)),!O.isOneOf(this.checkableStyle,o.CheckableStyle.TABLE_ROW,o.CheckableStyle.CHECKBOX_TABLE_ROW)||t&&n.checked||s()(e.target).is(".table-row-control")||i.hasClass("checkable")||i.parent().hasClass("checkable")||this.checkRow(n,!n.checked),t)return this.showContextMenu({pageX:e.pageX,pageY:e.pageY}),!1}},{key:"_isRowControl",value:function(e){return e.hasClass("table-row-control")||e.parent().hasClass("table-row-control")}},{key:"_onRowMouseUp",value:function(e){var t,n,i,r,o=e.which;if(!this._doubleClickSupport.doubleClicked()&&(n=s()(e.currentTarget),this.selectionHandler.onMouseUp(e,n),this._$mouseDownRow&&this._mouseDownRowId===n.data("row").id&&(t=n,(i=this._columnAtX(e.pageX))===this._mouseDownColumn))){var a=s()(e.target);if(!this._isRowControl(a))if(1===o&&(i.onMouseUp(e,t),r=this._find$AppLink(e)),r)this._triggerAppLinkAction(i,r.data("ref"));else{var u=t.data("row");this._triggerRowClick(u,o)}}}},{key:"_onRowDoubleClick",value:function(e){var t=s()(e.currentTarget),n=this._columnAtX(e.pageX);this.doRowAction(t.data("row"),n)}},{key:"showContextMenu",value:function(e){this.session.onRequestsDone(this._showContextMenu.bind(this,e))}},{key:"_showContextMenu",value:function(e){if(e=e||{},this._isDataRendered()&&this.attached&&0!==this.selectedRows.length){var t=this._filterMenusForContextMenu();if(0!==t.length){var n=O.nvl(e.pageX,null),i=O.nvl(e.pageY,null);if(null===n||null===i){var r=this.isRowSelectedAndVisible(this.selectionHandler.lastActionRow)?this.selectionHandler.lastActionRow:this.getLastSelectedAndVisibleRow();if(null!==r){var o=r.$row,s=o.offset(),a=No.offsetBounds(this.$data);s.left+=this.$data.scrollLeft(),n=s.left+10,i=s.top+o.outerHeight()/2,i=Math.min(Math.max(i,a.y+1),a.bottom()-1)}else n=this.$data.offset().left+10,i=this.$data.offset().top+10}this.contextMenu&&this.contextMenu.close(),this.contextMenu=O.create("ContextMenuPopup",{parent:this,menuItems:t,location:{x:n,y:i},$anchor:this.$data,menuFilter:this._filterMenusHandler}),this.contextMenu.open()}}}},{key:"isRowSelectedAndVisible",value:function(e){return!(!this.isRowSelected(e)||!e.$row)&&No.offsetBounds(e.$row).intersects(No.offsetBounds(this.$data))}},{key:"getLastSelectedAndVisibleRow",value:function(){for(var e=this.viewRangeRendered.to;e>=this.viewRangeRendered.from;e--)if(this.isRowSelectedAndVisible(this.rows[e]))return this.rows[e];return null}},{key:"onColumnVisibilityChanged",value:function(e){this.columnLayoutDirty=!0,this._isDataRendered()&&(this._updateRowWidth(),this._redraw(),this.invalidateLayoutTree()),this.trigger("columnStructureChanged")}},{key:"_onScroll",value:function(){var e=this.$data[0].scrollTop,t=this.$data[0].scrollLeft;this.scrollTop!==e&&this._renderViewport(),this.scrollTop=e,this.scrollLeft=t}},{key:"_renderTableStatus",value:function(){this.trigger("statusChanged")}},{key:"setContextColumn",value:function(e){this.setProperty("contextColumn",e)}},{key:"_hasVisibleTableControls",value:function(){return this.tableControls.some((function(e){return e.visible}))}},{key:"hasAggregateTableControl",value:function(){return this.tableControls.some((function(e){return e instanceof aA}))}},{key:"_createHeader",value:function(){return O.create("TableHeader",{parent:this,table:this,enabled:this.headerEnabled,headerMenusEnabled:this.headerMenusEnabled})}},{key:"_createFooter",value:function(){return O.create("TableFooter",{parent:this,table:this})}},{key:"_installCellTooltipSupport",value:function(){dh.install(this.$data,{parent:this,selector:".table-cell",text:this._cellTooltipText.bind(this),htmlEnabled:this._isAggregatedTooltip.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Mt.get().isCustomEllipsisTooltipPossible()})}},{key:"_uninstallCellTooltipSupport",value:function(){dh.uninstall(this.$data)}},{key:"_cellTooltipText",value:function(e){var t,n=e.parent(),i=this.columnFor$Cell(e,n),r=n.data("row");return r&&(t=this.cell(i,r).tooltipText),t||(n.data("aggregateRow")&&e.text().trim()&&(e.isContentTruncated()||e.children(".table-cell-icon").length&&!e.children(".table-cell-icon").isVisible())?((e=e.clone()).children(".table-cell-icon").setVisible(!0),e.html()):this._isTruncatedCellTooltipEnabled(i)&&e.isContentTruncated()?En.plainText(e.html(),{trim:!0}):void 0)}},{key:"setTruncatedCellTooltipEnabled",value:function(e){this.setProperty("truncatedCellTooltipEnabled",e)}},{key:"_isTruncatedCellTooltipEnabled",value:function(e){return null===this.truncatedCellTooltipEnabled?!this.headerVisible||!this.headerEnabled||e.fixedWidth:this.truncatedCellTooltipEnabled}},{key:"_isAggregatedTooltip",value:function(e){if(e.parent().data("aggregateRow"))return!0}},{key:"reload",value:function(e){this.hasReloadHandler&&(this._removeRows(),this._isDataRendered()&&(this._removeAggregateRows(),this._renderFiller()),this._triggerReload(e))}},{key:"setLoading",value:function(e){!e&&this.updateBuffer.isBuffering()||GP(XP(o.prototype),"setLoading",this).call(this,e)}},{key:"exportToClipboard",value:function(){this._triggerClipboardExport()}},{key:"_exportToClipboard",value:function(){ot.copyText({parent:this,text:this._selectedRowsToText()})}},{key:"_selectedRowsToText",value:function(){var e=this,t=this.visibleColumns();return this.selectedRows.map((function(n){return t.map((function(t){var i,r=t.cell(n);return i=t instanceof VD?r.value?"X":"":r.htmlEnabled?En.plainText(r.text):r.text,e._unwrapText(i)})).join("\t")})).join("\n")}},{key:"_unwrapText",value:function(e){return En.nvl(e).split(/[\n\r]/).map((function(e){return e.replace(/\t/g," ")})).map((function(e){return e.trim()})).filter((function(e){return!!e.length})).join(" ")}},{key:"setMultiSelect",value:function(e){this.setProperty("multiSelect",e)}},{key:"toggleSelection",value:function(){this.selectedRows.length===this.visibleRows.length?this.deselectAll():this.selectAll()}},{key:"selectAll",value:function(){this.selectRows(this.visibleRows)}},{key:"deselectAll",value:function(){this.selectRows([])}},{key:"checkAll",value:function(e,t){var n=s.a.extend(t,{checked:e});this.checkRows(this.visibleRows,n)}},{key:"uncheckAll",value:function(e){this.checkAll(!1,e)}},{key:"updateScrollbars",value:function(){wf.update(this.$data)}},{key:"_sort",value:function(e){var t=this._sortColumns();return!!this._isSortingPossible(t)&&(this.clearAggregateRows(e),!t.length||(t=et.union(t,this.columns),this._sortImpl(t),this._triggerRowOrderChanged(),this._isDataRendered()&&this._renderRowOrderChanges(),this._group(e),!0))}},{key:"_isSortingPossible",value:function(e){return e.every((function(e){return e.isSortingPossible()}))}},{key:"_sortColumns",value:function(){for(var e=[],t=0;t<this.columns.length;t++){var n=this.columns[t],i=n.sortIndex;i>=0&&(e[i]=n)}return e}},{key:"_sortImpl",value:function(e){var t=function(t,n){for(var i=0;i<e.length;i++){var r=e[i],o=r.compare(t,n);if(r.sortActive&&!r.sortAscending&&(o=-o),0!==o)return o}return 0};if(this.hierarchical){this._sortHierarchical(t);var n=[];this.visitRows((function(e){n.push(e)})),this.rows=n}else this.rows.sort(t),this.rootRows=this.rows;this._updateRowStructure({filteredRows:!0,applyFilters:!1,visibleRows:!0})}},{key:"visitRows",value:function(e,t,n){n=O.nvl(n,0),(t=t||this.rootRows).forEach((function(t){e(t,n),this.visitRows(e,t.childRows,n+1)}),this)}},{key:"_sortHierarchical",value:function(e,t){(t=t||this.rootRows).sort(e),t.forEach((function(t){this._sortHierarchical(e,t.childRows)}),this)}},{key:"_renderRowOrderChanges",value:function(){var e,t=this.$rows(),n={};t.length===this.visibleRows.length&&t.each(function(t,i){var r=!1,o=s()(i),a=o.data("row");if(this._insertedRows)for(var u=0;u<this._insertedRows.length;u++)if(this._insertedRows[u].id===a.id){r=!0;break}r||(e=!0,n[a.id]=o.offset().top)}.bind(this)),this._rerenderViewport(),this._order$AggregateRows(),this.scrollToSelection&&this.revealSelection(),e&&(t=this.$rows()).each(function(e,t){var i=s()(t),r=i.data("row"),o=n[r.id];void 0!==o&&i.css("top",o-i.offset().top).animate({top:0},{progress:function(){this._triggerRowOrderChanged(r,!0),this.updateScrollbars()}.bind(this)})}.bind(this))}},{key:"setSortEnabled",value:function(e){this.setProperty("sortEnabled",e)}},{key:"sort",value:function(e,t,n,i){var r,o,s;s=!(n=O.nvl(n,!1)),(i=O.nvl(i,!1))?this._removeSortColumn(e):this._addSortColumn(e,t,n),this.header&&this.header.onSortingChanged(),o=this._sort(s),r={column:e,sortAscending:e.sortAscending},i&&(r.sortingRemoved=!0),n&&(r.multiSort=!0),o||(r.sortingRequested=!0,this._animateAggregateRows=s),this.trigger("sort",r)}},{key:"_addSortColumn",value:function(e,t,n){var i;t=O.nvl(t,e.sortAscending?"asc":"desc"),n=O.nvl(n,!0),this._updateSortIndexForColumn(e,n),n||(i=this._groupedColumns().length,1===this._sortColumns().length&&1===i||(e.grouped=!1)),e.sortAscending="asc"===t,e.sortActive=!0}},{key:"_updateSortIndexForColumn",value:function(e,t){var n,i=-1;t?e.sortActive&&-1!==e.sortIndex||(i=Math.max(-1,et.max(this.columns.map((function(e){return void 0===e.sortIndex||e.initialAlwaysIncludeSortAtEnd?-1:e.sortIndex})))),e.sortIndex=i+1,this._permanentTailSortColumns.forEach((function(e){e.sortIndex++}))):(e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd||(e.sortIndex=this._permanentHeadSortColumns.length),et.eachSibling(this.columns,e,function(e){e.sortActive&&this._removeSortColumnInternal(e)}.bind(this)),n=e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd?0:1,this._permanentTailSortColumns.forEach((function(e,t){e.sortIndex=this._permanentHeadSortColumns.length+n+t}),this))}},{key:"_removeSortColumn",value:function(e){e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd||(et.eachSibling(this.columns,e,(function(t){t.sortIndex>e.sortIndex&&(t.sortIndex=t.sortIndex-1)})),this._removeSortColumnInternal(e))}},{key:"_removeSortColumnInternal",value:function(e){e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd||(e.sortActive=!1,e.grouped=!1,e.sortIndex=-1)}},{key:"isGroupingPossible",value:function(e){var t=!0;return!this.hierarchical&&!!this.sortEnabled&&(!(!this._permanentHeadSortColumns||0!==this._permanentHeadSortColumns.length)||(e.initialAlwaysIncludeSortAtBegin?(t=!0,et.eachSibling(this._permanentHeadSortColumns,e,(function(n){n.sortIndex<e.sortIndex&&(t=t&&n.grouped)})),t):!e.initialAlwaysIncludeSortAtEnd&&(this._permanentHeadSortColumns.forEach((function(e){t=t&&e.grouped})),t)))}},{key:"isAggregationPossible",value:function(e){return e instanceof hF&&!e.grouped&&!(!e.allowedAggregationFunctions||e.allowedAggregationFunctions.length<=1)&&(this.isGrouped()||this.hasAggregateTableControl())}},{key:"changeAggregation",value:function(e,t){this.changeAggregations([e],[t])}},{key:"changeAggregations",value:function(e,t){e.forEach((function(e,n){var i=t[n];e.aggregationFunction!==i&&(e.setAggregationFunction(i),this._triggerAggregationFunctionChanged(e))}),this),this._group()}},{key:"_addGroupColumn",value:function(e,t,n){var i=-1;this.isGroupingPossible(e)&&(t=O.nvl(t,e.sortAscending?"asc":"desc"),n=O.nvl(n,!0),e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd?e.initialAlwaysIncludeSortAtBegin&&(e.grouped=!0):(n?(i=Math.max(-1,et.max(this.columns.map((function(e){return void 0===e.sortIndex||e.initialAlwaysIncludeSortAtEnd||!e.grouped?-1:e.sortIndex})))),e.sortActive?(et.eachSibling(this.columns,e,(function(t){t.sortActive&&!t.initialAlwaysIncludeSortAtBegin&&!t.initialAlwaysIncludeSortAtEnd&&t.sortIndex>i&&t.sortIndex<e.sortIndex&&t.sortIndex++})),e.sortIndex=i+1):(e.sortIndex=i+1,et.eachSibling(this.columns,e,(function(e){e.sortActive&&!e.initialAlwaysIncludeSortAtBegin&&!e.initialAlwaysIncludeSortAtEnd&&e.sortIndex>i&&e.sortIndex++})),this._permanentTailSortColumns.forEach((function(e){e.sortIndex++})))):(i=this._permanentHeadSortColumns.length,e.sortActive?(et.eachSibling(this.columns,e,(function(t){t.sortActive&&!t.initialAlwaysIncludeSortAtBegin&&!t.initialAlwaysIncludeSortAtEnd&&t.sortIndex>=i&&t.sortIndex<e.sortIndex&&t.sortIndex++})),e.sortIndex=i):(et.eachSibling(this.columns,e,(function(e){e.sortActive&&!e.initialAlwaysIncludeSortAtBegin&&!e.initialAlwaysIncludeSortAtEnd&&e.sortIndex>=i&&e.sortIndex++})),e.sortIndex=i,this._permanentTailSortColumns.forEach((function(e){e.sortIndex++}))),et.eachSibling(this.columns,e,(function(e){e.sortActive&&!e.initialAlwaysIncludeSortAtBegin&&!e.initialAlwaysIncludeSortAtEnd&&e.sortIndex>=i&&(e.grouped=!1)}))),e.sortAscending="asc"===t,e.sortActive=!0),e.grouped=!0)}},{key:"_removeGroupColumn",value:function(e){e.grouped=!1,e.initialAlwaysIncludeSortAtBegin&&this.columns.forEach((function(t){t.sortIndex>=e.sortIndex&&(t.grouped=!1)})),this._removeSortColumn(e)}},{key:"_buildRowDiv",value:function(e){var t=this.rowWidth,n="table-row";e.cssClass&&(n+=" "+e.cssClass),e.enabled||(n+=" disabled"),e.checked&&this.checkableStyle===o.CheckableStyle.TABLE_ROW&&(n+=" checked"),e.filterAccepted||(n+=" filter-not-accepted"),et.empty(e.childRows)&&(n+=" leaf");var i,r,s='<div class="'+n+'" style="width: '+t+'px">';for(i=0;i<this.columns.length;i++)(r=this.columns[i]).isVisible()&&(s+=r.buildCellForRow(e));return s+="</div>"}},{key:"_calculateRowBorderWidth",value:function(){var e=this.$data.appendDiv("table-row");this.rowBorderLeftWidth=e.cssBorderLeftWidth(),this.rowBorderRightWidth=e.cssBorderRightWidth(),this.rowBorderWidth=this.rowBorderLeftWidth+this.rowBorderRightWidth,e.remove()}},{key:"_updateRowWidth",value:function(){this.rowWidth=this.visibleColumns().reduce(function(e,t){return this.autoResizeColumns?e+t.width:e+t._realWidthIfAvailable()}.bind(this),this.rowBorderWidth)}},{key:"_updateRealColumnWidths",value:function(e){if(!Mt.get().hasTableCellZoomBug())return!1;var t=!1;return e=e||this.$rows().eq(0),this.visibleColumns().forEach((function(n,i){this._updateRealColumnWidth(n,i,e)&&(t=!0)}),this),t}},{key:"_updateRealColumnWidth",value:function(e,t,n){if(!Mt.get().hasTableCellZoomBug())return!1;n=n||this.$rows().eq(0);var i=this.$cell(O.nvl(t,e),n);if(0===i.length&&null!==e._realWidth)return e._realWidth=null,!0;var r=No.size(i,{exact:!0}).width;return r!==e._realWidth&&(e._realWidth=r,!0)}},{key:"_updateRowHeight",value:function(){var e=this.$data.appendDiv("table-row"),t=this.$data.appendDiv("table-aggregate-row");e.appendDiv("table-cell").html("&nbsp;"),t.appendDiv("table-cell").html("&nbsp;"),this.rowHeight=e.outerHeight(!0),this.aggregateRowHeight=t.outerHeight(!0),e.remove(),t.remove()}},{key:"_updateRowHeights",value:function(){this.rows.forEach((function(e){e.$row?e.height=e.$row.outerHeight(!0):e.height=null})),this._aggregateRows.forEach((function(e){e.$row?e.height=e.$row.outerHeight(!0):e.height=null}))}},{key:"_renderRowsInRange",value:function(e){var t,n="",i=0,r=!1,a=this.visibleRows;if(0!==a.length){var u=new fi(0,this.rows.length);if(e=u.intersect(e),this.viewRangeRendered.size()>0&&!e.intersect(this.viewRangeRendered).equals(new fi(0,0)))throw new Error("New range must not intersect with existing.");e.to<=this.viewRangeRendered.from&&(r=!0);var l=this.viewRangeRendered.union(e);if(2===l.length)throw new Error("Can only prepend or append rows to the existing range. Existing: "+this.viewRangeRendered+". New: "+l);this.viewRangeRendered=l[0],this._removeEmptyData();for(var c=e.from;c<e.to;c++){var f=a[c];n+=this._buildRowDiv(f),i++}t=this.$data.makeElement(n),(t=r?this.$fillBefore?t.insertAfter(this.$fillBefore):t.prependTo(this.$data):this.$fillAfter?t.insertBefore(this.$fillAfter):t.appendTo(this.$data)).each(function(t,n){var r=s()(n);this.viewRangeRendered.size()===i&&this._updateRealColumnWidths(r)&&(this._updateRowWidth(),this.header&&this.header.rendered&&this.header.resizeHeaderItems()),r.cssWidth(this.rowWidth);var u=a[e.from+t];o.linkRowToDiv(u,r),this._installRow(u)}.bind(this)),s.a.log.isTraceEnabled()&&(s.a.log.trace(i+" new rows rendered from "+e),s.a.log.trace(this._rowsRenderedInfo()))}}},{key:"_rowsRenderedInfo",value:function(){return this.$rows().length+" rows rendered ("+this.viewRangeRendered+")"}},{key:"moveRowToTop",value:function(e){var t=this.rows.indexOf(e);this.moveRow(t,0)}},{key:"moveRowToBottom",value:function(e){var t=this.rows.indexOf(e);this.moveRow(t,this.rows.length-1)}},{key:"moveRowUp",value:function(e){var t=this.rows.indexOf(e),n=t-1;if(this.hierarchical){var i=this.rows.filter((function(t){return e.parentRow===t.parentRow}),this),r=i.indexOf(e),o=i[r-1];n=o?this.rows.indexOf(o):0}this.moveRow(t,n)}},{key:"moveRowDown",value:function(e){var t=this.rows.indexOf(e),n=t+1;if(this.hierarchical){var i=this.rows.filter((function(t){return e.parentRow===t.parentRow}),this),r=i.indexOf(e),o=i[r+1];n=o?this.rows.indexOf(o):this.rows.length}this.moveRow(t,n)}},{key:"moveFilteredRowUp",value:function(e){this.moveVisibleRowUp(e)}},{key:"moveVisibleRowUp",value:function(e){var t,n,i=this.rows.indexOf(e),r=this.visibleRows.indexOf(e);if(this.hierarchical){var o=this.visibleRows.filter((function(t){return e.parentRow===t.parentRow}),this);if(!(t=o[o.indexOf(e)-1]))return;n=this.rows.indexOf(t)}else{if(!(t=this.visibleRows[r-1]))return;n=this.rows.indexOf(t)}this.moveRow(i,n)}},{key:"moveFilteredRowDown",value:function(e){this.moveVisibleRowDown(e)}},{key:"moveVisibleRowDown",value:function(e){var t,n,i=this.rows.indexOf(e),r=this.visibleRows.indexOf(e);if(this.hierarchical){var o=this.visibleRows.filter((function(t){return e.parentRow===t.parentRow}),this);if(!(t=o[o.indexOf(e)+1]))return;n=this.rows.indexOf(t)}else{if(!(t=this.visibleRows[r+1]))return;n=this.rows.indexOf(t)}this.moveRow(i,n)}},{key:"moveRow",value:function(e,t){var n=this.rows.length;e=Math.max(e,0),e=Math.min(e,n-1),t=Math.max(t,0),e!==(t=Math.min(t,n-1))&&(et.move(this.rows,e,t),this.updateRowOrder(this.rows))}},{key:"_removeRowsInRange",value:function(e){var t,n,i=0,r=this.visibleRows;e=new fi(0,r.length).intersect(e);var o=this.viewRangeRendered.subtract(e);if(2===o.length)throw new Error("Can only remove rows at the beginning or end of the existing range. "+this.viewRangeRendered+". New: "+o);for(this.viewRangeRendered=o[0],n=e.from;n<e.to;n++)t=r[n],this._removeRow(t),i++;s.a.log.isTraceEnabled()&&(s.a.log.trace(i+" rows removed from "+e+"."),s.a.log.trace(this._rowsRenderedInfo()))}},{key:"removeAllRows",value:function(){this._isDataRendered()&&this.$rows().each(function(e,t){var n=s()(t),i=n.data("row");n.hasClass("hiding")||this._removeRow(i)}.bind(this)),this.viewRangeRendered=new fi(0,0)}},{key:"_removeRows",value:function(e){if(e){var t=this.isAttachedAndRendered();(e=et.ensure(e)).forEach(function(e){var n=this.visibleRows.indexOf(e);if(-1!==n){var i=Boolean(e.$row),r=this.viewRangeRendered.contains(n);if(t){if(!i&&r)throw new Error("Inconsistency found while removing row. Row is undefined but inside rendered view range. RowIndex: "+n);if(i&&!r)throw new Error("Inconsistency found while removing row. Row is rendered but not inside rendered view range. RowIndex: "+n)}this._removeRow(e),(r||n<this.viewRangeRendered.from)&&(n<this.viewRangeRendered.from?(this.viewRangeRendered.from--,this.viewRangeRendered.to--):n<=this.viewRangeRendered.to&&this.viewRangeRendered.to--)}}.bind(this))}else this.removeAllRows()}},{key:"_removeRow",value:function(e){var t=e.$row;t&&(this._destroyTooltipsForRow(e),this._removeCellEditorForRow(e),t.hasClass("hiding")||(t.remove(),e.$row=null))}},{key:"_showRow",value:function(e){var t=e.$row;t&&(t.is(".showing")||(t.hide(),t.addClass("showing"),t.removeClass("hiding"),t.stop().slideDown({duration:250,complete:function(){t.removeClass("showing"),this.updateScrollbars()}.bind(this)})))}},{key:"_hideRow",value:function(e){var t=e.$row;t&&(t.is(".hiding")||(t.addClass("hiding"),t.removeClass("showing"),t.stop().slideUp({duration:250,complete:function(){e.$row&&(t.remove(),t[0]===e.$row[0]&&(e.$row=null),this.updateScrollbars())}.bind(this)})))}},{key:"_installRow",value:function(e){if(e.height=e.$row.outerHeight(!0),e.hasError&&this._showCellErrorForRow(e),this.cellEditorPopup&&!this.cellEditorPopup.rendered&&this.cellEditorPopup.row.id===e.id){var t=this.cellEditorPopup.cell.field;this.startCellEdit(this.cellEditorPopup.column,e,t)}}},{key:"_calcRowLevelPadding",value:function(e){return e?this._calcRowLevelPadding(e.parentRow)+this.rowLevelPadding:-this.rowLevelPadding}},{key:"_showCellErrorForRow",value:function(e){var t=this.$cellsForRow(e.$row),n=this;t.each((function(t){var i=s()(this),r=n.cellByCellIndex(t,e);r.errorStatus&&n._showCellError(e,i,r.errorStatus)}))}},{key:"_showCellError",value:function(e,t,n){var i,r;r={parent:this,text:n.message,autoRemove:!1,$anchor:t,table:this},(i=O.create("TableTooltip",r)).render(),i.row=e,this.tooltips.push(i)}},{key:"_columnAtX",value:function(e){var t=0,n=this.$data.offset().left+this.rowBorderLeftWidth,i=this.$data.scrollLeft();if(e<n)return this.columns[0];n-=i;var r=this.visibleColumns(),o=et.find(r,(function(i){if(t=n+i.width,e>=n&&e<t)return!0;n=t}));return o||(o=r[r.length-1]),o}},{key:"_find$AppLink",value:function(e){for(var t=s()(e.target),n=s()(e.delegateTarget);t.length>0;){if(t.hasClass("app-link"))return t;if(t[0]===n[0])return null;t=t.parent()}return null}},{key:"_filterMenus",value:function(e,t,n,i,r){return mb.filterAccordingToSelection("Table",this.selectedRows.length,e,t,n,i,r)}},{key:"_filterMenusForContextMenu",value:function(){return this._filterMenus(this.menus,_b.CONTEXT_MENU,!0,!1,["Header"])}},{key:"setStaticMenus",value:function(e){this.setProperty("staticMenus",e),this._updateMenuBar()}},{key:"_removeMenus",value:function(){}},{key:"notifyRowSelectionFinished",value:function(){this._triggerRowsSelectedPending&&(this._triggerRowsSelected(),this._triggerRowsSelectedPending=!1),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_triggerRowClick",value:function(e,t,n){var i={row:e,mouseButton:t};this.trigger("rowClick",i)}},{key:"_triggerRowAction",value:function(e,t){this.trigger("rowAction",{row:e,column:t})}},{key:"prepareCellEdit",value:function(e,t,n){var i=s.a.resolvedPromise();this.cellEditorPopup&&(i=this.cellEditorPopup.waitForCompleteCellEdit()),i.then(this.prepareCellEditInternal.bind(this,e,t,n))}},{key:"prepareCellEditInternal",value:function(e,t,n){var i=new Kt({column:e,row:t});if(this.openFieldPopupOnCellEdit=O.nvl(n,!1),this.trigger("prepareCellEdit",i),!i.defaultPrevented){var r=e.createEditor(t);this.startCellEdit(e,t,r)}}},{key:"cell",value:function(e,t){return e===this.rowIconColumn?O.create("Cell",{iconId:t.iconId,cssClass:En.join(" ","row-icon-cell",t.cssClass)}):e===this.checkableColumn?O.create("Cell",{value:t.checked,editable:!0,cssClass:t.cssClass}):t.cells[e.index]}},{key:"cellByCellIndex",value:function(e,t){return this.cell(this.columns[e],t)}},{key:"cellValue",value:function(e,t){var n=this.cell(e,t);return n?void 0!==n.value?n.value:"":n}},{key:"cellText",value:function(e,t){var n=this.cell(e,t);return n&&n.text||""}},{key:"nextEditableCellPos",value:function(e,t,n){var i,r,o,s,a,u=this.columns.indexOf(e);return r=u+1,n&&(r=u-1),(i=this.nextEditableCellPosForRow(r,t,n))||(a=function(e){return!!e.$row&&(r=0,n&&(r=this.columns.length-1),!!(i=this.nextEditableCellPosForRow(r,e,n))||void 0)}.bind(this),s=(o=this.rows.indexOf(t))+1,n&&(s=o-1),et.findFrom(this.rows,s,a,n)),i}},{key:"nextEditableCellPosForRow",value:function(e,t,n){var i,r,o;if(o=function(e){return!e.guiOnly&&(i=this.cell(e,t),this.enabledComputed&&t.enabled&&i.editable)}.bind(this),r=et.findFrom(this.columns,e,o,n))return{column:r,row:t}}},{key:"clearAggregateRows",value:function(e){this._aggregateRows.forEach((function(e){e.prevRow&&(e.prevRow.aggregateRowAfter=null),e.nextRow&&(e.nextRow.aggregateRowBefore=null)}),this),this._isDataRendered()&&(this._removeAggregateRows(e),this._renderSelection()),this._aggregateRows=[]}},{key:"_forEachVisibleColumn",value:function(e,t,n){var i;this.visibleColumns().forEach((function(r,o){r[e]?(n&&(i=r.cellValueOrTextForCalculation(n)),t[o]=r[e](t[o],i)):t[o]=void 0}))}},{key:"_group",value:function(e){var t,n,i,r,s=this._groupedColumns(),a=this.groupingStyle===o.GroupingStyle.TOP,u=[];this.clearAggregateRows(),s.length&&(t=this.visibleRows,this._forEachVisibleColumn("aggrStart",u),t.forEach(function(e,o){i||(i=e),this._forEachVisibleColumn("aggrStep",u,e),n=t[o+1],(o===t.length-1||this._isNewGroup(s,e,n))&&(this._forEachVisibleColumn("aggrFinish",u),this._addAggregateRow(u,a?r:e,a?i:n),this._forEachVisibleColumn("aggrStart",u),i=null,r=e)}.bind(this)),this._isDataRendered()&&(this._renderAggregateRows(e),this._renderSelection()))}},{key:"_isNewGroup",value:function(e,t,n){var i,r,o,s=!1;if(!n)return!0;for(i=0;i<e.length;i++)if(o=(r=e[i])&&r.cellTextForGrouping&&"function"==typeof r.cellTextForGrouping,s=(s=s||o&&r.cellTextForGrouping(t)!==r.cellTextForGrouping(n))||!o&&this.cellText(r,t)!==this.cellText(r,n))return!0;return!1}},{key:"_groupedColumns",value:function(){return this.columns.filter((function(e){return e.grouped}))}},{key:"_addAggregateRow",value:function(e,t,n){var i={contents:e.slice(),prevRow:t,nextRow:n};this._aggregateRows.push(i),t&&(t.aggregateRowAfter=i),n&&(n.aggregateRowBefore=i)}},{key:"_removeAggregateRows",value:function(e){0!==this._aggregateRows.length&&((e=O.nvl(e,!1))?this._aggregateRows.forEach((function(e,t){this._hideRow(e)}),this):(this._aggregateRows.forEach((function(e){this._removeRow(e)}),this),this.updateScrollbars()))}},{key:"_renderAggregateRows",value:function(e){var t=this.groupingStyle===o.GroupingStyle.TOP,n=t?"insertBefore":"insertAfter";e=O.nvl(e,!1),this._aggregateRows.forEach((function(i,r){var o,a,u;i.$row||(o=t?i.nextRow:i.prevRow)&&o.$row&&((u=this.$container.makeDiv("table-aggregate-row").data("aggregateRow",i))[n](o.$row).width(this.rowWidth),this.visibleColumns().forEach((function(e){(a=s()(e.buildCellForAggregateRow(i))).appendTo(u),this._resizeCell(a)}),this),i.height=u.outerHeight(!0),i.$row=u,e&&this._showRow(i))}),this)}},{key:"groupColumn",value:function(e,t,n,i){var r,o;t=O.nvl(t,!1),(i=O.nvl(i,!1))&&this._removeGroupColumn(e),this.isGroupingPossible(e)&&(i||this._addGroupColumn(e,n,t),this.header&&this.header.onSortingChanged(),o=this._sort(!0),r={column:e,groupAscending:e.sortAscending},i&&(r.groupingRemoved=!0),t&&(r.multiGroup=!0),o||(r.groupingRequested=!0,this._animateAggregateRows=!0),this.trigger("group",r))}},{key:"removeColumnGrouping",value:function(e){e&&this.groupColumn(e,!1,"asc",!0)}},{key:"removeAllColumnGroupings",value:function(){this.columns.filter((function(e){return e.grouped})).forEach(this.removeColumnGrouping.bind(this))}},{key:"isGrouped",value:function(){return this.columns.some((function(e){return e.grouped}))}},{key:"setColumnBackgroundEffect",value:function(e,t){e.setBackgroundEffect(t)}},{key:"_updateBackgroundEffect",value:function(){this.columns.forEach((function(e){e.backgroundEffect&&e.updateBackgroundEffect()}),this)}},{key:"_calculateValuesForBackgroundEffect",value:function(){this.columns.forEach((function(e){e.backgroundEffect&&e.calculateMinMaxValues()}),this)}},{key:"_markAutoOptimizeWidthColumnsAsDirty",value:function(){this.columns.forEach((function(e){e.autoOptimizeWidthRequired=!0}))}},{key:"_markAutoOptimizeWidthColumnsAsDirtyIfNeeded",value:function(e,t,n){var i,r=!1;for(i=e.length-1;i>=0;i--){var o=e[i];this.cellValue(o,t)!==this.cellValue(o,n)&&(o.autoOptimizeWidthRequired=!0,e.splice(i,1),r=!0)}return r}},{key:"setMultiCheck",value:function(e){this.setProperty("multiCheck",e)}},{key:"checkedRows",value:function(){return this.rows.filter((function(e){return e.checked}))}},{key:"checkRow",value:function(e,t,n){var i=s.a.extend(n,{checked:t});this.checkRows([e],i)}},{key:"checkRows",value:function(e,t){var n=s.a.extend({checked:!0,checkOnlyEnabled:!0},t),i=[];!this.checkable||!this.enabledComputed&&n.checkOnlyEnabled||((e=et.ensure(e)).forEach((function(e){if((e.enabled||!n.checkOnlyEnabled)&&e.checked!==n.checked){if(!this.multiCheck&&n.checked)for(var t=0;t<this.rows.length;t++)this.rows[t].checked&&(this.rows[t].checked=!1,i.push(this.rows[t]));e.checked=n.checked,i.push(e)}}),this),this._isDataRendered()&&i.forEach((function(e){this._renderRowChecked(e)}),this),this._triggerRowsChecked(i))}},{key:"uncheckRow",value:function(e,t){this.uncheckRows([e],t)}},{key:"uncheckRows",value:function(e,t){var n=s.a.extend({checked:!1},t);this.checkRows(e,n)}},{key:"isTableNodeColumn",value:function(e){return this.hierarchical&&this.tableNodeColumn===e}},{key:"collapseRow",value:function(e){this.collapseRows(et.ensure(e))}},{key:"collapseAll",value:function(){this.expandRowsInternal(this.rootRows,!1,!0)}},{key:"expandAll",value:function(){this.expandRowsInternal(this.rootRows,!0,!0)}},{key:"collapseRows",value:function(e,t){this.expandRowsInternal(e,!1,t)}},{key:"expandRow",value:function(e,t){this.expandRows(et.ensure(e))}},{key:"expandRows",value:function(e,t){this.expandRowsInternal(e,!0,t)}},{key:"expandRowsInternal",value:function(e,t,n){var i=[],r=[];e=e||this.rootRows,t=O.nvl(t,!0),(n=O.nvl(n,!1))?this.visitRows((function(e){e.expanded!==t&&(e.expanded=t,i.push(e),e.$row&&r.push(e))}),e):i=e.filter((function(e){var n=e.expanded!==t;return n&&e.$row&&r.push(e),e.expanded=t,n})),0!==i.length&&(this._updateRowStructure({visibleRows:!0}),this._triggerRowsExpanded(i),this._isDataRendered()&&(this._renderRowDelta(),r.forEach((function(e){e.animateExpansion()})),e[0].$row&&wf.ensureExpansionVisible({element:e[0],$element:e[0].$row,$scrollable:this.get$Scrollable(),isExpanded:function(e){return e.expanded},getChildren:function(e){return e.childRows},defaultChildHeight:this.rowHeight})))}},{key:"doRowAction",value:function(e,t){1===this.selectedRows.length&&this.selectedRows[0]===e&&((t=t||this.columns[0])&&t.guiOnly&&(t=et.find(this.columns,(function(e){return!e.guiOnly}))),e&&t&&this._triggerRowAction(e,t))}},{key:"insertRow",value:function(e){this.insertRows([e])}},{key:"insertRows",value:function(e){var t=0===this.rows.length;e.forEach((function(t,n){(t=this._initRow(t)).status=uR.Status.INSERTED,e[n]=t,this.rows.push(t)}),this);var n=e.filter((function(e){return this._applyFiltersForRow(e),e.filterAccepted}),this);this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),this._filterCount()>0&&n.length>0&&this._triggerFilter(),this._calculateValuesForBackgroundEffect(),this._markAutoOptimizeWidthColumnsAsDirty(),this._triggerRowsInserted(e),this._sortAfterInsert(t),this._isDataRendered()&&(this.hierarchical&&this._renderRowOrderChanges(),this._insertedRows?et.pushAll(this._insertedRows,e):(this._insertedRows=e,setTimeout(function(){this._insertedRows=null}.bind(this),0)),this.viewRangeDirty=!0,this._renderViewport(),this.invalidateLayoutTree())}},{key:"_sortAfterInsert",value:function(e){this._sort()}},{key:"deleteRow",value:function(e){this.deleteRows([e])}},{key:"deleteRows",value:function(e){var t,n,i=[];this.visitRows(function(e){this.rowsMap[e.id]&&(i.push(e),this._isDataRendered()&&(this.cellEditorPopup&&this.cellEditorPopup.row.id===e.id&&this.cellEditorPopup.cancelEdit(),this._removeRows(e),t=!0),et.remove(this.rows,e),et.remove(this.visibleRows,e),this._filterCount()>0&&et.remove(this._filteredRows,e)&&(n=!0),delete this.rowsMap[e.id],this.selectionHandler.lastActionRow===e&&this.selectionHandler.clearLastSelectedRowMarker())}.bind(this),e),this.deselectRows(i),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),n&&this._triggerFilter(),this._group(),this._updateBackgroundEffect(),this._markAutoOptimizeWidthColumnsAsDirty(),this._triggerRowsDeleted(e),t&&(this._renderViewport(),this._renderRangeMarkers(),this._renderFiller(),this._renderEmptyData(),this.invalidateLayoutTree())}},{key:"deleteAllRows",value:function(){var e=this._filterCount()>0&&this._filteredRows.length>0,t=this.rows;this._isDataRendered()&&(this.cellEditorPopup&&this.cellEditorPopup.cancelEdit(),this.selectionHandler.clearLastSelectedRowMarker(),this._removeRows()),this.rows=[],this.rowsMap={},this._filteredRows=[],this.deselectAll(),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),e&&this._triggerFilter(),this._markAutoOptimizeWidthColumnsAsDirty(),this._group(),this._updateBackgroundEffect(),this._triggerAllRowsDeleted(t),this._isDataRendered()&&(this._renderFiller(),this._renderViewport(),this._renderEmptyData(),this.invalidateLayoutTree())}},{key:"updateRow",value:function(e){this.updateRows([e])}},{key:"updateRows",value:function(e){if(this.updateBuffer.isBuffering())this.updateBuffer.buffer(e);else{var t,n,i=this.columns.filter((function(e){return e.autoOptimizeWidth&&!e.autoOptimizeWidthRequired})),r={};this.rows.forEach((function(e,t){r[e.id]=t}),this);var o={},s=!1;e=e.map((function(e){var a=e.parentRow,u=this.rowsMap[e.id];if(o[e.id]=u,!u)throw new Error("Update event received for non existing row. RowId: "+e.id);return e.parentRow&&!oi.isNullOrUndefined(e.parentRow.id)&&(a=e.parentRow.id),s=s||O.nvl(u._parentRowId,null)!==O.nvl(a,null),n=n||u.expanded!==O.nvl(e.expanded,!1),(e=this._initRow(e)).status===uR.Status.NON_CHANGED&&e.cells.some((function(t,n){var i=u.cells[n];return!(i&&i.value===t.value||(e.status=uR.Status.UPDATED,0))})),this.selectionHandler.lastActionRow===u&&(this.selectionHandler.lastActionRow=e),et.replace(this.selectedRows,u,e),this.rows[r[e.id]]=e,e.filterAccepted=u.filterAccepted,this._filterCount()>0&&(t=this._applyFiltersForRow(e)||t),this._markAutoOptimizeWidthColumnsAsDirtyIfNeeded(i,u,e),e}),this),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),this._triggerRowsUpdated(e),this._isDataRendered()&&(this._renderUpdateRows(e,o),s&&this._renderRowOrderChanges()),t&&this._triggerFilter(),(t||n)&&this._renderRowDelta(),this._sortAfterUpdate(),this._updateBackgroundEffect(),this.invalidateLayoutTree()}}},{key:"_renderUpdateRows",value:function(e,t){e.forEach((function(e){var n,i=t[e.id];i.$row&&!i.$row.hasClass("hiding")&&((n=s()(this._buildRowDiv(e))).copyCssClasses(i.$row,o.SELECTION_CLASSES+" first last"),i.$row.replaceWith(n),o.linkRowToDiv(e,n),this._destroyTooltipsForRow(e),this._removeCellEditorForRow(e),this._installRow(e),i.$row.hasClass("showing")&&i.$row.outerHeight()<e.$row.outerHeight()/3&&this._showRow(e))}),this)}},{key:"_sortAfterUpdate",value:function(){this._sort()}},{key:"isHierarchical",value:function(){return this.hierarchical}},{key:"_setHierarchical",value:function(e){this.hierarchical!==e&&(e&&this.removeAllColumnGroupings(),this._setProperty("hierarchical",e))}},{key:"updateRowOrder",value:function(e){if((e=et.ensure(e)).length!==this.rows.length)throw new Error("Row order may not be updated because lengths of the arrays differ.");this.rows=e.slice(),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),this.clearAggregateRows(this._animateAggregateRows),this._isDataRendered()&&this._renderRowOrderChanges(),this._triggerRowOrderChanged(),this._group(this._animateAggregateRows),this._animateAggregateRows=!1}},{key:"_destroyTooltipsForRow",value:function(e){for(var t=this.tooltips.length-1;t>=0;t--)this.tooltips[t].row.id===e.id&&(this.tooltips[t].destroy(),this.tooltips.splice(t,1))}},{key:"_removeCellEditorForRow",value:function(e){this.cellEditorPopup&&this.cellEditorPopup.rendered&&this.cellEditorPopup.row.id===e.id&&this.cellEditorPopup.remove()}},{key:"startCellEdit",value:function(e,t,n){if(this._isDataRendered()&&this.isAttachedAndRendered()){this.trigger("startCellEdit",{column:e,row:t,field:n}),this.ensureRowRendered(t);var i=e.startCellEdit(t,n);return this.cellEditorPopup=i,i}this._postRenderActions.push(this.startCellEdit.bind(this,e,t,n))}},{key:"endCellEdit",value:function(e,t){if(this._isDataRendered()&&this.isAttachedAndRendered()){if(this.cellEditorPopup){var n=this.cellEditorPopup;if(this._destroyCellEditorPopup(),t=O.nvl(t,!1)){var i=n.column,r=n.row;this.setCellErrorStatus(i,r,e.errorStatus),e.errorStatus?this.setCellText(i,r,e.displayText):this.setCellValue(i,r,e.value)}}e.destroy()}else this._postRenderActions.push(this.endCellEdit.bind(this,e,t))}},{key:"completeCellEdit",value:function(){var e=this.cellEditorPopup.cell.field,t=new Kt({field:e,row:this.cellEditorPopup.row,column:this.cellEditorPopup.column,cell:this.cellEditorPopup.cell});if(this.trigger("completeCellEdit",t),!t.defaultPrevented)return this.endCellEdit(e,!0)}},{key:"cancelCellEdit",value:function(){var e=this.cellEditorPopup.cell.field,t=new Kt({field:e,row:this.cellEditorPopup.row,column:this.cellEditorPopup.column,cell:this.cellEditorPopup.cell});this.trigger("cancelCellEdit",t),t.defaultPrevented||this.endCellEdit(e)}},{key:"scrollTo",value:function(e,t){0!==this.viewRangeRendered.size()&&(this.ensureRowRendered(e),e.$row&&wf.scrollTo(this.$data,e.$row,t))}},{key:"scrollPageUp",value:function(){var e=Math.max(0,this.$data[0].scrollTop-this.$data.height());this.setScrollTop(e)}},{key:"scrollPageDown",value:function(){var e=Math.min(this.$data[0].scrollHeight,this.$data[0].scrollTop+this.$data.height());this.setScrollTop(e)}},{key:"setScrollTop",value:function(e){this.setProperty("scrollTop",e),this._isDataRendered()&&this._renderViewport()}},{key:"_renderScrollTop",value:function(){this.rendering||wf.scrollTop(this.get$Scrollable(),this.scrollTop)}},{key:"get$Scrollable",value:function(){return this.$data?this.$data:this.$container}},{key:"setScrollToSelection",value:function(e){this.setProperty("scrollToSelection",e)}},{key:"revealSelection",value:function(){this._isDataRendered()?this.selectedRows.length>0&&this.scrollTo(this.selectedRows[0]):this.session.layoutValidator.schedulePostValidateFunction(this.revealSelection.bind(this))}},{key:"revealChecked",value:function(){var e=et.find(this.rows,(function(e){return!0===e.checked}));e&&this.scrollTo(e)}},{key:"_rowById",value:function(e){return this.rowsMap[e]}},{key:"_rowsByIds",value:function(e){return e.map(this._rowById.bind(this))}},{key:"_rowsToIds",value:function(e){return e.map((function(e){return e.id}))}},{key:"hasRow",value:function(e){return Boolean(this.rowsMap[e.id])}},{key:"_renderSelection",value:function(e){e=et.ensure(e||this.selectedRows);for(var t=function(e,t,n){var i=e.hasClass(n);return t&&!i?(e.addClass(n),!0):!(t||!i||(e.removeClass(n),0))},n=0;n<e.length;n++){var i=e[n];if(i.$row){var r=-1!==this.selectedRows.indexOf(i),o=this.visibleRows,s=o.indexOf(i)-1,a=s>=0&&-1!==this.selectedRows.indexOf(o[s]),u=o.indexOf(i)+1,l=u<o.length&&-1!==this.selectedRows.indexOf(o[u]);r&&a&&i.aggregateRowBefore&&(a=!1),r&&l&&i.aggregateRowAfter&&(l=!1);var c=0+t(i.$row,r,"selected")+t(i.$row,r&&!a&&l,"select-top")+t(i.$row,r&&a&&!l,"select-bottom")+t(i.$row,r&&!a&&!l,"select-single")+t(i.$row,r&&a&&l,"select-middle");c&&a&&-1===e.indexOf(o[s])&&e.push(o[s]),c&&l&&-1===e.indexOf(o[u])&&e.push(o[u])}}this.cellEditorPopup&&this.cellEditorPopup.rendered&&this.selectedRows.indexOf(this.cellEditorPopup.row)>-1&&(this.cellEditorPopup.position(),this.cellEditorPopup.pack())}},{key:"_removeSelection",value:function(){this.selectedRows.forEach((function(e){e.$row&&(e.$row.select(!1),e.$row.toggleClass(o.SELECTION_CLASSES,!1))}),this)}},{key:"addRowToSelection",value:function(e,t){this.selectedRows.indexOf(e)>-1||(t=void 0===t||t,this.selectedRows.push(e),e.$row&&this._isDataRendered()&&(e.$row.select(!0),this._renderSelection(e),this.scrollToSelection&&this.revealSelection()),this._triggerRowsSelectedPending=!0,t||this.notifyRowSelectionFinished())}},{key:"removeRowFromSelection",value:function(e,t){t=void 0===t||t,et.remove(this.selectedRows,e)&&(this._isDataRendered()&&this._renderSelection(e),t?this._triggerRowsSelectedPending=!0:this._triggerRowsSelected())}},{key:"selectRow",value:function(e,t){this.selectRows(e,t)}},{key:"selectRows",value:function(e,t){e=et.ensure(e).filter((function(e){return Boolean(this.visibleRowsMap[e.id])}),this),et.equalsIgnoreOrder(e,this.selectedRows)||(this._isDataRendered()&&this._removeSelection(),!this.multiSelect&&e.length>1&&(e=[e[0]]),this.selectedRows=e,this._triggerRowsSelected(t),this._updateMenuBar(),this._isDataRendered()&&(this._renderSelection(),this.scrollToSelection&&this.revealSelection()))}},{key:"deselectRow",value:function(e){this.deselectRows(e)}},{key:"deselectRows",value:function(e){e=et.ensure(e);var t=this.selectedRows.slice();et.removeAll(t,e)&&this.selectRows(t)}},{key:"isRowSelected",value:function(e){return this.selectedRows.indexOf(e)>-1}},{key:"_filterCount",value:function(){return Object.keys(this._filterMap).length}},{key:"filteredRows",value:function(){return this._filteredRows}},{key:"$rows",value:function(e){var t=".table-row";return e&&(t+=", .table-aggregate-row"),this.$data.find(t)}},{key:"$aggregateRows",value:function(){return this.$data.find(".table-aggregate-row")}},{key:"selectedRow",value:function(){return this.selectedRows.length>0?this.selectedRows[0]:null}},{key:"$selectedRows",value:function(){return this.$data?this.$data.find(".selected"):s()()}},{key:"$cellsForColIndex",value:function(e,t){var n=".table-row > div:nth-of-type("+e+")";return t&&(n+=", .table-aggregate-row > div:nth-of-type("+e+")"),this.$data.find(n)}},{key:"$cellsForColIndexWidthFix",value:function(e,t){var n=".table-row > div:nth-of-type("+e+") > .width-fix ";return t&&(n+=", .table-aggregate-row > div:nth-of-type("+e+") > .width-fix"),this.$data.find(n)}},{key:"$cellsForRow",value:function(e){return e.children(".table-cell")}},{key:"$cell",value:function(e,t){var n=e;return"number"!=typeof e&&(n=this.visibleColumns().indexOf(e)),t.children(".table-cell").eq(n)}},{key:"columnById",value:function(e){return et.find(this.columns,(function(t){return t.id===e}))}},{key:"columnFor$Cell",value:function(e,t){t=t||e.closest(".table-row");var n=this.$cellsForRow(t).index(e);return this.visibleColumns()[n]}},{key:"columnsByIds",value:function(e){return e.map(this.columnById.bind(this))}},{key:"getVisibleRows",value:function(){return this.visibleRows}},{key:"_updateRowStructure",value:function(e){var t=O.nvl(e.updateTree,!1),n=O.nvl(e.filteredRows,t),i=O.nvl(e.applyFilters,n),r=O.nvl(e.visibleRows,n);t&&this._rebuildTreeStructure(),n&&this._updateFilteredRows(i),r&&this._updateVisibleRows()}},{key:"_rebuildTreeStructure",value:function(){var e=!1;if(this.rows.forEach((function(t){t.childRows=[],e=e||!oi.isNullOrUndefined(t.parentRow)}),this),!e)return this.rootRows=this.rows,void this._setHierarchical(e);this._setHierarchical(e),this.rootRows=[],this.rows.forEach((function(e){var t;if(oi.isNullOrUndefined(e.parentRow))return e.parentRow=null,e._parentRowId=null,void this.rootRows.push(e);if(!(t=oi.isNullOrUndefined(e.parentRow.id)?this.rowsMap[e.parentRow]:this.rowsMap[e.parentRow.id]))throw new Error("Parent row of "+e+" can not be resolved.");e.parentRow=t,e._parentRowId=t.id,t.childRows.push(e)}),this),this._maxLevel=0,this.rows=[],this.visitRows(function(e,t){e._hierarchyLevel=t,this._maxLevel=Math.max(t,this._maxLevel),this.rows.push(e)}.bind(this)),this._calculateTableNodeColumn()}},{key:"_updateFilteredRows",value:function(e,t){t=Boolean(t),e=O.nvl(e,!0),this._filteredRows=this.rows.filter((function(n){return e&&(t=this._applyFiltersForRow(n)||t),n.filterAccepted}),this),t&&this._triggerFilter()}},{key:"_updateVisibleRows",value:function(){this.visibleRows=this._computeVisibleRows(),this.visibleRowsMap=this.visibleRows.reduce((function(e,t){return e[t.id]=t,e}),{}),this.initialized&&this.deselectRows(this.selectedRows.filter((function(e){return!this.visibleRowsMap[e.id]}),this))}},{key:"_computeVisibleRows",value:function(e){var t=[];return(e=e||this.rootRows).forEach((function(e){var n=this._computeVisibleRows(e.childRows);(e.filterAccepted||n.length>0)&&t.push(e),e._expandable=n.length>0,e.expanded&&(t=t.concat(n))}),this),t}},{key:"visibleChildRows",value:function(e){return e.childRows.filter((function(e){return Boolean(this.visibleRowsMap[e.id])}),this)}},{key:"_renderRowDelta",value:function(){if(this._isDataRendered()){var e=[],t=[];this.$rows().each(function(n,i){var r=s()(i).data("row");this.visibleRows.indexOf(r)<0?(r.$row.detach(),t.push(r)):e.push(r)}.bind(this)),this._rerenderViewport(),t.forEach((function(e){e.$row.insertAfter(this.$fillBefore)}),this),this._order$Rows().insertAfter(this.$fillBefore),this._order$AggregateRows(),t.forEach((function(e){this._hideRow(e)}),this),this.$rows().each(function(t,n){var i=s()(n),r=i.data("row");i.hasClass("hiding")||e.indexOf(r)<0&&this._showRow(r)}.bind(this)),this._renderScrollTop(),this._renderEmptyData()}}},{key:"filter",value:function(){this._updateRowStructure({filteredRows:!0}),this._renderRowDelta(),this._group(),this.revealSelection()}},{key:"_order$Rows",value:function(e){return(e=e||this.$rows()).sort(function(e,t){var n=s()(e),i=s()(t),r=n.data("row"),o=i.data("row");return this.rows.indexOf(r)-this.rows.indexOf(o)}.bind(this))}},{key:"_order$AggregateRows",value:function(e){(e=e||this.$aggregateRows()).each((function(e,t){var n=s()(t),i=n.data("aggregateRow");i&&i.prevRow&&n.insertAfter(i.prevRow.$row)}))}},{key:"_rowAcceptedByFilters",value:function(e){for(var t in this._filterMap)if(!this._filterMap[t].accept(e))return!1;return!0}},{key:"_applyFiltersForRow",value:function(e){if(this._rowAcceptedByFilters(e)){if(!e.filterAccepted)return e.filterAccepted=!0,!0}else if(e.filterAccepted)return e.filterAccepted=!1,!0;return!1}},{key:"filteredBy",value:function(){var e=[];for(var t in this._filterMap){var n=this._filterMap[t];"function"==typeof n.createLabel&&e.push(n.createLabel())}return e}},{key:"resetUserFilter",value:function(){for(var e in this._filterMap)this._filterMap[e]instanceof XM&&this.removeFilterByKey(e);this.filter(),this._triggerFilterReset()}},{key:"hasUserFilter",value:function(){return oi.values(this._filterMap).filter((function(e){return e instanceof XM})).length>0}},{key:"resizeToFit",value:function(e,t){if(!e.fixedWidth){var n=e.calculateOptimalWidth();oi.isPlainObject(n)?n.always(this._resizeToFit.bind(this,e,t)):this._resizeToFit(e,t,n)}}},{key:"_resizeToFit",value:function(e,t,n){-1!==n&&(t&&t>0&&n>t&&(n=t),Mt.get().isInternetExplorer()&&n!==e.minWidth&&n++,e.width!==n&&this.resizeColumn(e,n),e.autoOptimizeWidthRequired=!1,this._triggerColumnResizedToFit())}},{key:"addFilter",value:function(e){var t=e.createKey();if(!t)throw new Error("key has to be defined");this._filterMap[t]=e,this.trigger("filterAdded",{filter:e})}},{key:"removeFilter",value:function(e){this.removeFilterByKey(e.createKey())}},{key:"removeFilterByKey",value:function(e){if(!e)throw new Error("key has to be defined");var t=this._filterMap[e];t&&(delete this._filterMap[e],this.trigger("filterRemoved",{filter:t}))}},{key:"getFilter",value:function(e){if(!e)throw new Error("key has to be defined");return this._filterMap[e]}},{key:"resizeColumn",value:function(e,t){if(!e.fixedWidth){t=Math.floor(t),e.width=t;var n=this.visibleColumns().indexOf(e);if(-1!==n){var i=n+1;this.$cellsForColIndex(i,!0).css("min-width",t).css("max-width",t),this._updateRealColumnWidth(e),this._updateRowWidth(),this.$rows(!0).css("width",this.rowWidth),this._updateRowHeights(),this._renderFiller(),this._renderViewport(),this.updateScrollbars(),this._renderEmptyData()}this._aggregateRows.forEach((function(t){t.$row&&this._resizeCell(this.$cell(e,t.$row))}),this),this._triggerColumnResized(e)}}},{key:"_resizeCell",value:function(e){var t=e.children(".table-cell-icon");t.setVisible(!0),e.isContentTruncated()&&t.setVisible(!1)}},{key:"moveColumn",value:function(e,t,n,i){n=this._considerFixedPositionColumns(t,n);var r=this.visibleColumns(),o=r[n],s=this.columns.indexOf(o);et.remove(this.columns,e),et.insert(this.columns,e,s),r=this.visibleColumns(),n=r.indexOf(e),this._calculateTableNodeColumn(),this._triggerColumnMoved(e,t,n,i),this._aggregateRows.forEach((function(e){et.move(e.contents,t,n)})),this._isDataRendered()&&this._rerenderViewport()}},{key:"_considerFixedPositionColumns",value:function(e,t){var n=-1;return t>e?(n=et.findIndexFrom(this.visibleColumns(),e,(function(e){return e.fixedPosition})))>-1&&(t=Math.min(t,n-1)):(n=et.findIndexFromReverse(this.visibleColumns(),e,(function(e){return e.fixedPosition})))>-1&&(t=Math.max(t,n+1)),t}},{key:"_renderColumnOrderChanges",value:function(e){var t,n,i,r,o,a,u,l=this;this.header&&this.header.onOrderChanged(e),this.$rows(!0).each((function(){for(u=s()(this),r=s()(),a=u.children(),n=0;n<l.columns.length;n++){for(t=l.columns[n],i=0;i<e.length;i++)if(e[i]===t){o=a[i];break}r.push(o)}u.prepend(r)}))}},{key:"_triggerRowsInserted",value:function(e){this.trigger("rowsInserted",{rows:e})}},{key:"_triggerRowsDeleted",value:function(e){this.trigger("rowsDeleted",{rows:e})}},{key:"_triggerRowsUpdated",value:function(e){this.trigger("rowsUpdated",{rows:e})}},{key:"_triggerAllRowsDeleted",value:function(e){this.trigger("allRowsDeleted",{rows:e})}},{key:"_triggerRowsSelected",value:function(e){this.trigger("rowsSelected",{debounce:e})}},{key:"_triggerRowsChecked",value:function(e){this.trigger("rowsChecked",{rows:e})}},{key:"_triggerRowsExpanded",value:function(e){this.trigger("rowsExpanded",{rows:e})}},{key:"_triggerFilter",value:function(){this.trigger("filter")}},{key:"_triggerFilterReset",value:function(){this.trigger("filterReset")}},{key:"_triggerAppLinkAction",value:function(e,t){this.trigger("appLinkAction",{column:e,ref:t})}},{key:"_triggerReload",value:function(e){this.trigger("reload",{reloadReason:e})}},{key:"_triggerClipboardExport",value:function(){var e=new Kt;this.trigger("clipboardExport",e),e.defaultPrevented||this._exportToClipboard()}},{key:"_triggerRowOrderChanged",value:function(e,t){var n={row:e,animating:t};this.trigger("rowOrderChanged",n)}},{key:"_triggerColumnResized",value:function(e){var t={column:e};this.trigger("columnResized",t)}},{key:"_triggerColumnResizedToFit",value:function(e){var t={column:e};this.trigger("columnResizedToFit",t)}},{key:"_triggerColumnMoved",value:function(e,t,n,i){var r={column:e,oldPos:t,newPos:n,dragged:i};this.trigger("columnMoved",r)}},{key:"_triggerAggregationFunctionChanged",value:function(e){var t={column:e};this.trigger("aggregationFunctionChanged",t)}},{key:"setHeaderVisible",value:function(e){this.setProperty("headerVisible",e)}},{key:"_renderHeaderVisible",value:function(){this._renderTableHeader()}},{key:"setHeaderEnabled",value:function(e){this.setProperty("headerEnabled",e)}},{key:"_renderHeaderEnabled",value:function(){this._removeTableHeader(),this._renderTableHeader()}},{key:"setHeaderMenusEnabled",value:function(e){this.setProperty("headerMenusEnabled",e),this.header&&this.header.setHeaderMenusEnabled(this.headerMenusEnabled)}},{key:"hasPermanentHeadOrTailSortColumns",value:function(){return 0!==this._permanentHeadSortColumns.length||0!==this._permanentTailSortColumns.length}},{key:"_setHeadAndTailSortColumns",value:function(){var e=this.columns.filter((function(e){return e.sortIndex>=0}));e.sort((function(e,t){return e.sortIndex-t.sortIndex})),this._permanentHeadSortColumns=[],this._permanentTailSortColumns=[],e.forEach((function(e){e.initialAlwaysIncludeSortAtBegin?this._permanentHeadSortColumns.push(e):e.initialAlwaysIncludeSortAtEnd&&this._permanentTailSortColumns.push(e)}),this)}},{key:"setTileMode",value:function(e){this.setProperty("tileMode",e)}},{key:"_setTileMode",value:function(e){e&&(this._ensureMediator(),this.tileTableHeader||this._setTileTableHeader(this._createTileTableHeader()),this.tableTileGridMediator.loadTiles(),this.tableTileGridMediator.activate()),this._setProperty("tileMode",e),!e&&this.tableTileGridMediator&&this.tableTileGridMediator.deactivate()}},{key:"_ensureMediator",value:function(){this.tableTileGridMediator||(this.tableTileGridMediator=O.create("TableTileGridMediator",{parent:this,gridColumnCount:6}))}},{key:"_renderTileMode",value:function(){this.tableTileGridMediator&&this.tableTileGridMediator.renderTileMode()}},{key:"createTiles",value:function(e){return e.map((function(e){var t=this.createTileForRow(e);return this._adaptTile(t),t.rowId=e.id,t}),this)}},{key:"_adaptTile",value:function(e){e.gridDataHints={weightX:0}}},{key:"createTileForRow",value:function(e){throw new Error("Not implemented")}},{key:"_setTileTableHeader",value:function(e){e&&e.addCssClass("tile-table-header"),this._setProperty("tileTableHeader",e)}},{key:"_createTileTableHeader",value:function(){return O.create("TileTableHeaderBox",{parent:this})}},{key:"setRowIconVisible",value:function(e){this.setProperty("rowIconVisible",e)}},{key:"_setRowIconVisible",value:function(e){this._setProperty("rowIconVisible",e);var t=this.rowIconColumn;this.rowIconVisible&&!t?(this._insertRowIconColumn(),this._calculateTableNodeColumn(),this.trigger("columnStructureChanged")):!this.rowIconVisible&&t&&(et.remove(this.columns,t),this.rowIconColumn=null,this._calculateTableNodeColumn(),this.trigger("columnStructureChanged"))}},{key:"setRowIconColumnWidth",value:function(e){this.setProperty("rowIconColumnWidth",e)}},{key:"_setRowIconColumnWidth",value:function(e){this._setProperty("rowIconColumnWidth",e);var t=this.rowIconColumn;t&&(t.width=e)}},{key:"_setSelectedRows",value:function(e){"string"==typeof e[0]&&(e=this._rowsByIds(e)),this._setProperty("selectedRows",e)}},{key:"setMenus",value:function(e){this.setProperty("menus",e)}},{key:"_setMenus",value:function(e,t){this.updateKeyStrokes(e,t),this._setProperty("menus",e),this._updateMenuBar(),this.header&&this.header.updateMenuBar()}},{key:"setMenuBarVisible",value:function(e){this.setProperty("menuBarVisible",e)}},{key:"_setMenuBarVisible",value:function(e){this._setProperty("menuBarVisible",e),this._updateMenuBar()}},{key:"_renderMenuBarVisible",value:function(){this.menuBarVisible?(this.menuBar.render(),this._refreshMenuBarPosition()):this.menuBar.remove(),this._updateMenuBar(),this.invalidateLayoutTree()}},{key:"_refreshMenuBarPosition",value:function(){this.menuBarVisible&&this.menuBar.rendered&&(this.menuBar.position===O_.Position.TOP?this.menuBar.$container.prependTo(this.$container):this.menuBar.$container.appendTo(this.$container))}},{key:"_createMenuBar",value:function(){return O.create("MenuBar",{parent:this,position:O_.Position.BOTTOM,menuOrder:new ag(this.session,"Table"),menuFilter:this._filterMenusHandler})}},{key:"_updateMenuBar",value:function(){if(this.menuBarVisible){var e=this._filterMenus(this.menus,_b.MENU_BAR,!1,!0,["Header"]);e=this.staticMenus.concat(e),this.menuBar.setMenuItems(e)}if(this.contextMenu){var t=this._filterMenus(this.menus,_b.CONTEXT_MENU,!0,!1,["Header"]);this.contextMenu.updateMenuItems(t)}}},{key:"_setKeyStrokes",value:function(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}},{key:"setFilters",value:function(e){for(var t in this._filterMap)this._filterMap[t]instanceof XM&&this.removeFilterByKey(t);e&&e.forEach((function(e){e=this._ensureFilter(e),this.addFilter(e)}),this)}},{key:"_ensureFilter",value:function(e){return e instanceof XM?e:(e.column&&(e.column=this.columnById(e.column)),e.table=this,e.session=this.session,O.create(e))}},{key:"setTableStatus",value:function(e){this.setProperty("tableStatus",e)}},{key:"_setTableStatus",value:function(e){e=pi.ensure(e),this._setProperty("tableStatus",e)}},{key:"setTableStatusVisible",value:function(e){this.setProperty("tableStatusVisible",e),this._updateFooterVisibility()}},{key:"_updateFooterVisibility",value:function(){this.setFooterVisible(this.tableStatusVisible||this._hasVisibleTableControls())}},{key:"setHierarchicalStyle",value:function(e){this.setProperty("hierarchicalStyle",e)}},{key:"_renderHierarchicalStyle",value:function(){this.$container.toggleClass("structured",o.HierarchicalStyle.STRUCTURED===this.hierarchicalStyle)}},{key:"setFooterVisible",value:function(e){this._setProperty("footerVisible",e),e&&!this.footer&&(this.footer=this._createFooter()),this.tableControls.forEach((function(e){e.tableFooter=this.footer}),this),this.rendered&&this._renderFooterVisible(),!e&&this.footer&&(this.footer.destroy(),this.footer=null)}},{key:"_renderBackgroundEffect",value:function(){this.columns.forEach((function(e){e.backgroundEffect&&e._renderBackgroundEffect()}),this)}},{key:"_renderRowChecked",value:function(e){if(this.checkable&&e.$row){var t;if(this.checkableStyle===o.CheckableStyle.TABLE_ROW)t=e.$row;else{if(!this.checkableColumn)throw new Error("checkableColumn not set");t=this.checkableColumn.$checkBox(e.$row)}t.toggleClass("checked",e.checked)}}},{key:"setCheckable",value:function(e){this.setProperty("checkable",e)}},{key:"_setCheckable",value:function(e){this._setProperty("checkable",e),this._updateCheckableColumn()}},{key:"_updateCheckableColumn",value:function(){var e=this.checkableColumn,t=this.checkable&&O.isOneOf(this.checkableStyle,o.CheckableStyle.CHECKBOX,o.CheckableStyle.CHECKBOX_TABLE_ROW);t&&!e?(this._insertBooleanColumn(),this._calculateTableNodeColumn(),this.trigger("columnStructureChanged")):!t&&e&&e.guiOnly&&(et.remove(this.columns,e),this.checkableColumn=null,this._calculateTableNodeColumn(),this.trigger("columnStructureChanged"))}},{key:"_renderCheckable",value:function(){this.columnLayoutDirty=!0,this._updateRowWidth(),this._redraw(),this.invalidateLayoutTree()}},{key:"setCheckableStyle",value:function(e){this.setProperty("checkableStyle",e)}},{key:"_setCheckableStyle",value:function(e){this._setProperty("checkableStyle",e),this._updateCheckableColumn()}},{key:"_renderCheckableStyle",value:function(){this.$container.toggleClass("checkable",O.isOneOf(this.checkableStyle,o.CheckableStyle.TABLE_ROW,o.CheckableStyle.CHECKBOX_TABLE_ROW)),this.$container.toggleClass("table-row-check",this.checkableStyle===o.CheckableStyle.TABLE_ROW),this._isDataRendered()&&this._redraw()}},{key:"_renderRowIconVisible",value:function(){this.columnLayoutDirty=!0,this._updateRowWidth(),this._redraw(),this.invalidateLayoutTree()}},{key:"_renderRowIconColumnWidth",value:function(){this.rowIconVisible&&this._renderRowIconVisible()}},{key:"setGroupingStyle",value:function(e){this.setProperty("groupingStyle",e)}},{key:"_setGroupingStyle",value:function(e){this._setProperty("groupingStyle",e),this._group()}},{key:"_renderGroupingStyle",value:function(){this._rerenderViewport()}},{key:"_redraw",value:function(){this._isDataRendered()&&(this._rerenderHeaderColumns(),this._rerenderViewport())}},{key:"_rerenderHeaderColumns",value:function(){this.header&&(this.header.rerenderColumns(),this.invalidateLayoutTree())}},{key:"_renderTableHeader",value:function(){if(!this.tileMode){var e=!1;this.headerVisible&&!this.header?(this.header=this._createHeader(),this.header.render(),this._renderEmptyData(),e=!0):!this.headerVisible&&this.header&&(this._removeTableHeader(),this._removeEmptyData(),e=!0),this.$container.toggleClass("header-invisible",!this.header),e&&this.invalidateLayoutTree()}}},{key:"_removeTableHeader",value:function(){this.header&&(this.header.destroy(),this.header=null)}},{key:"_renderEmptyData",value:function(){!this.header||this.visibleRows.length>0||(this.$emptyData||(this.$emptyData=this.$data.appendDiv().html("&nbsp;")),this.$emptyData.css("min-width",this.rowWidth).css("max-width",this.rowWidth),this.updateScrollbars())}},{key:"_removeEmptyData",value:function(){this.header&&0===this.visibleRows.length||this.$emptyData&&(this.$emptyData.remove(),this.$emptyData=null,this.updateScrollbars())}},{key:"_renderFooterVisible",value:function(){this.footer&&(this.footerVisible?this._renderFooter():this._removeFooter(),this.invalidateLayoutTree())}},{key:"_renderFooter",value:function(){this.footer.rendered||this.footer.render()}},{key:"_removeFooter",value:function(){this.footer.rendered&&this.footer.remove()}},{key:"_renderEnabled",value:function(){GP(XP(o.prototype),"_renderEnabled",this).call(this);var e=this.enabledComputed;this.tileMode||this.$data.setEnabled(e),this.$container.setTabbable(e),this._isDataRendered()&&this.$rows().each((function(){var t=s()(this),n=t.data("row");t.find("input").setEnabled(e&&n.enabled)}))}},{key:"_renderDisabledStyle",value:function(){GP(XP(o.prototype),"_renderDisabledStyle",this).call(this),this._renderDisabledStyleInternal(this.$data)}},{key:"setAutoResizeColumns",value:function(e){this.setProperty("autoResizeColumns",e)}},{key:"_renderAutoResizeColumns",value:function(){!this.autoResizeColumns&&Mt.get().hasTableCellZoomBug()&&this.visibleColumns().forEach((function(e,t){e._realWidth=null})),this.columnLayoutDirty=!0,this.invalidateLayoutTree()}},{key:"setMultilineText",value:function(e){this.setProperty("multilineText",e)}},{key:"_renderMultilineText",value:function(){this._markAutoOptimizeWidthColumnsAsDirty(),this._redraw(),this.invalidateLayoutTree()}},{key:"_renderDropType",value:function(){this.dropType?this._installDragAndDropHandler():this._uninstallDragAndDropHandler()}},{key:"_installDragAndDropHandler",value:function(e){this.dragAndDropHandler||(this.dragAndDropHandler=Gt.handler(this,{supportedScoutTypes:Gt.SCOUT_TYPES.FILE_TRANSFER,dropType:function(){return this.dropType}.bind(this),dropMaximumSize:function(){return this.dropMaximumSize}.bind(this),additionalDropProperties:function(e){var t=s()(e.currentTarget),n={rowId:""};if(t.hasClass("table-row")){var i=t.data("row");n.rowId=i.id}return n}}),this.dragAndDropHandler.install(this.$container,".table-data,.table-row"))}},{key:"_uninstallDragAndDropHandler",value:function(e){this.dragAndDropHandler&&(this.dragAndDropHandler.uninstall(),this.dragAndDropHandler=null)}},{key:"_installImageListeners",value:function(){this._imageLoadListener=this._onImageLoadOrError.bind(this),this.$data[0].addEventListener("load",this._imageLoadListener,!0),this.$data[0].addEventListener("error",this._imageLoadListener,!0)}},{key:"_uninstallImageListeners",value:function(){this.$data[0].removeEventListener("load",this._imageLoadListener,!0),this.$data[0].removeEventListener("error",this._imageLoadListener,!0)}},{key:"calculateViewRangeSize",value:function(){if(this._updateRowHeight(),0===this.rowHeight)throw new Error("Cannot calculate view range with rowHeight = 0");return 2*Math.ceil(this.$data.outerHeight()/this.rowHeight)}},{key:"setViewRangeSize",value:function(e){this.viewRangeSize!==e&&(this._setProperty("viewRangeSize",e),this._isDataRendered()&&this._renderViewport())}},{key:"_calculateCurrentViewRange",value:function(){var e,t=this.$data[0].scrollTop;return e=0==this.$data[0].scrollHeight-this.$data[0].clientHeight?0:this._rowIndexAtScrollTop(t),this._calculateViewRangeForRowIndex(e)}},{key:"_rowIndexAtScrollTop",value:function(e){var t=0,n=-1;return this.visibleRows.some(function(i,r){if(t+=this._heightForRow(i),e<t)return n=r,!0}.bind(this)),n}},{key:"_heightForRow",value:function(e){var t=0,n=e.aggregateRowAfter;return t=e.height?e.height:this.rowHeight,n&&(n.height?t+=n.height:t+=this.aggregateRowHeight),t}},{key:"_calculateViewRangeForRowIndex",value:function(e){if(!this.virtual)return new fi(0,this.visibleRows.length);var t=new fi,n=Math.floor(this.viewRangeSize/4);return t.from=Math.max(e-n,0),t.to=Math.min(t.from+this.viewRangeSize,this.visibleRows.length),this.viewRangeSize-t.size()>0&&(t.from=Math.max(t.to-this.viewRangeSize,0)),t}},{key:"_renderViewport",value:function(){if(this.isAttachedAndRendered()){if(!this._renderViewportBlocked&&0!==this.visibleColumns().length)if(this.$container.isEveryParentVisible()){var e=this._calculateCurrentViewRange();this._renderViewRange(e)}else this.invalidateLayoutTree()}else this._renderViewPortAfterAttach=!0}},{key:"_rerenderViewport",value:function(){this.isAttachedAndRendered()?(this._removeRows(),this._removeAggregateRows(),this._renderFiller(),this._renderViewport()):this._rerenderViewPortAfterAttach=!0}},{key:"_renderViewRangeForRowIndex",value:function(e){var t=this._calculateViewRangeForRowIndex(e);this._renderViewRange(t)}},{key:"_renderViewRange",value:function(e){if(e.from!==this.viewRangeRendered.from||e.to!==this.viewRangeRendered.to||this.viewRangeDirty){this._removeRangeMarkers();var t=e.subtract(this.viewRangeRendered);if(this.viewRangeRendered.subtract(e).forEach(function(e){this._removeRowsInRange(e)}.bind(this)),t.forEach(function(e){this._renderRowsInRange(e)}.bind(this)),this.viewRangeRendered.size()>0){var n=this.visibleRows,i=n[this.viewRangeRendered.from],r=n[this.viewRangeRendered.to-1];if(!i.$row||!r.$row)throw new Error("Rows not rendered as expected. "+this.viewRangeRendered+". First: "+i.$row+". Last: "+r.$row)}this._renderRangeMarkers(),this._removeAggregateRows(),this._renderAggregateRows(),this._renderFiller(),this._renderEmptyData(),this._renderBackgroundEffect(),this._renderSelection(),this.viewRangeDirty=!1}}},{key:"_removeRangeMarkers",value:function(){this._modifyRangeMarkers("removeClass")}},{key:"_renderRangeMarkers",value:function(){this._modifyRangeMarkers("addClass")}},{key:"_modifyRangeMarkers",value:function(e){if(0!==this.viewRangeRendered.size()){var t=this.visibleRows;n(t[this.viewRangeRendered.from],"first"),n(t[this.viewRangeRendered.to-1],"last")}function n(t,n){t&&t.$row&&t.$row[e](n)}}},{key:"ensureRowRendered",value:function(e){if(!e.$row){var t=this.visibleRows.indexOf(e);t<0||this._renderViewRangeForRowIndex(t)}}},{key:"_renderFiller",value:function(){this.$fillBefore||(this.$fillBefore=this.$data.prependDiv("table-data-fill"),this._applyFillerStyle(this.$fillBefore));var e=this._calculateFillerHeight(new fi(0,this.viewRangeRendered.from));this.$fillBefore.cssHeight(e),this.$fillBefore.cssWidth(this.rowWidth),s.a.log.isTraceEnabled()&&s.a.log.trace("FillBefore height: "+e),this.$fillAfter||(this.$fillAfter=this.$data.appendDiv("table-data-fill"),this._applyFillerStyle(this.$fillAfter));var t=this._calculateFillerHeight(new fi(this.viewRangeRendered.to,this.visibleRows.length));this.$fillAfter.cssHeight(t),this.$fillAfter.cssWidth(this.rowWidth),s.a.log.isTraceEnabled()&&s.a.log.trace("FillAfter height: "+t)}},{key:"_applyFillerStyle",value:function(e){var t=e.css("background-color"),n=(100*(1-1/this.rowHeight)).toFixed(2)+"%";e.css({background:"linear-gradient(to bottom, transparent, transparent "+n+", "+t+" "+n+", "+t+")",backgroundSize:"100% "+this.rowHeight+"px",backgroundColor:"transparent"})}},{key:"_calculateFillerHeight",value:function(e){for(var t=0,n=e.from;n<e.to;n++){var i=this.visibleRows[n];t+=this._heightForRow(i)}return t}},{key:"containsAggregatedNumberColumn",value:function(){return!!this.initialized&&this.visibleColumns().some((function(e){return e instanceof hF&&"none"!==e.aggregationFunction}))}},{key:"updateColumnStructure",value:function(e){this._destroyColumns(),this.columns=e,this._initColumns(),this._isDataRendered()&&(this._updateRowWidth(),this.$rows(!0).css("width",this.rowWidth),this._rerenderHeaderColumns(),this._renderEmptyData()),this.trigger("columnStructureChanged")}},{key:"updateColumnOrder",value:function(e){var t,n,i,r;if(e.length!==this.columns.length)throw new Error("Column order may not be updated because lengths of the arrays differ.");for(r=this.columns.slice(),t=0;t<e.length;t++){if(n=e[t],(i=this.columns.indexOf(n))<0)throw new Error("Column with id "+n.id+"not found.");i!==t&&(et.remove(this.columns,n),et.insert(this.columns,n,t))}this._isDataRendered()&&this._renderColumnOrderChanges(r)}},{key:"updateColumnHeaders",value:function(e){for(var t,n,i=0;i<e.length;i++)t=this.columnById(e[i].id),n=s.a.extend(n,t),t.text=e[i].text,t.headerTooltipText=e[i].headerTooltipText,t.headerTooltipHtmlEnabled=e[i].headerTooltipHtmlEnabled,t.headerCssClass=e[i].headerCssClass,t.headerHtmlEnabled=e[i].headerHtmlEnabled,t.headerBackgroundColor=e[i].headerBackgroundColor,t.headerForegroundColor=e[i].headerForegroundColor,t.headerFont=e[i].headerFont,t.headerIconId=e[i].headerIconId,t.sortActive=e[i].sortActive,t.sortAscending=e[i].sortAscending,t.grouped&&!e[i].grouped&&this._removeGroupColumn(t),t.grouped=e[i].grouped,t.sortActive||-1===t.sortIndex?t.grouped&&t.sortActive&&-1===t.sortIndex?this._addGroupColumn(t):t.sortActive&&-1===t.sortIndex?this._addSortColumn(t):t.sortIndex=e[i].sortIndex:this._removeSortColumn(t),this._isDataRendered()&&this.header&&this.header.updateHeader(t,n)}},{key:"focusCell",value:function(e,t){if(this._isDataRendered()&&this.isAttachedAndRendered()){var n=this.cell(e,t);this.enabledComputed&&t.enabled&&n.editable&&this.prepareCellEdit(e,t,!1)}else this._postRenderActions.push(this.focusCell.bind(this,e,t))}},{key:"_attach",value:function(){this.$parent.append(this.$container),GP(XP(o.prototype),"_attach",this).call(this)}},{key:"_postAttach",value:function(){var e=this.htmlComp.getParent();this.htmlComp.setSize(e.size()),GP(XP(o.prototype),"_postAttach",this).call(this)}},{key:"_renderOnAttach",value:function(){GP(XP(o.prototype),"_renderOnAttach",this).call(this),this._rerenderViewPortAfterAttach?(this._rerenderViewport(),this._rerenderViewPortAfterAttach=!1):this._renderViewPortAfterAttach&&(this._renderViewport(),this._renderViewPortAfterAttach=!1)}},{key:"_detach",value:function(){this.$container.detach(),GP(XP(o.prototype),"_detach",this).call(this)}},{key:"_onDetach",value:function(){GP(XP(o.prototype),"_onDetach",this).call(this),this._destroyCellEditorPopup()}},{key:"_destroyCellEditorPopup",value:function(){if(this.cellEditorPopup){var e=function(){this.cellEditorPopup.destroy(),this.cellEditorPopup=null}.bind(this),t=this.cellEditorPopup.waitForCompleteCellEdit();"resolved"===t.state()?e():t.then(e)}}},{key:"setVirtual",value:function(e){this._setProperty("virtual",e)}},{key:"setCellValue",value:function(e,t,n){e.setCellValue(t,n)}},{key:"setCellText",value:function(e,t,n){e.setCellText(t,n)}},{key:"setCellErrorStatus",value:function(e,t,n){e.setCellErrorStatus(t,n)}},{key:"visibleColumns",value:function(e){return e=O.nvl(e,!0),this.columns.filter((function(t){return t.isVisible()&&(e||!t.guiOnly)}),this)}},{key:"_onDesktopPopupOpen",value:function(e){var t=e.popup;this.enabledComputed&&this.has(t)&&t instanceof Rg&&(this.$container.addClass("focused"),t.one("destroy",function(){this._isDataRendered()&&this.$container.removeClass("focused")}.bind(this)))}},{key:"_onDesktopPropertyChange",value:function(e){"dense"===e.propertyName&&this.menuBar.invalidateLayoutTree()}},{key:"markRowsAsNonChanged",value:function(e){et.ensure(e||this.rows).forEach((function(e){e.status=uR.Status.NON_CHANGED}))}}])&&zP(t.prototype,n),i&&zP(t,i),o}(de);function QP(e){return(QP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tR(e,t,n){return(tR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oR(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function nR(e,t){return(nR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oR(e);if(t){var r=oR(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rR(this,n)}}function rR(e,t){return!t||"object"!==QP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oR(e){return(oR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}JP(ZP,"HierarchicalStyle",{DEFAULT:"default",STRUCTURED:"structured"}),JP(ZP,"GroupingStyle",{TOP:"top",BOTTOM:"bottom"}),JP(ZP,"CheckableStyle",{CHECKBOX:"checkbox",TABLE_ROW:"tableRow",CHECKBOX_TABLE_ROW:"checkbox_table_row"}),JP(ZP,"ReloadReason",{UNSPECIFIED:"unspecified",SEARCH:"search",OVERRIDE_ROW_LIMIT:"overrideRowLimit",RESET_ROW_LIMIT:"resetRowLimit",ORGANIZE_COLUMNS:"organizeColumns",DATA_CHANGED_TRIGGER:"dataChangedTrigger"}),JP(ZP,"SELECTION_CLASSES","select-middle select-top select-bottom select-single selected");var sR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nR(e,t)}(o,e);var t,n,i,r=iR(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["contextColumn"]),e}return t=o,i=[{key:"modifyTablePrototype",value:function(){x.get().remote&&(oi.replacePrototypeFunction(ZP,"_sortAfterInsert",(function(e){this.modelAdapter?e&&this._group():this._sortAfterInsertOrig(e)}),!0),oi.replacePrototypeFunction(ZP,"_sortAfterUpdate",(function(){this.modelAdapter?this._group():this._sortAfterUpdateOrig()}),!0),oi.replacePrototypeFunction(ZP,"_isSortingPossible",(function(e){return this.modelAdapter?O.nvl(this.uiSortPossible,!0)&&this._isSortingPossibleOrig(e):this._isSortingPossibleOrig(e)}),!0),oi.replacePrototypeFunction(ZP,"sort",(function(e,t,n,i){this.modelAdapter&&e.guiOnly||this.sortOrig(e,t,n,i)}),!0),oi.replacePrototypeFunction(ZP,"_createTileTableHeader",(function(){if(!this.modelAdapter)return this._createTileTableHeaderOrig()}),!0),oi.replacePrototypeFunction(ZP,"createTiles",(function(e){if(!this.modelAdapter)return this.createTilesOrig(e)}),!0))}},{key:"modifyColumnPrototype",value:function(){x.get().remote&&(oi.replacePrototypeFunction(gD,"init",(function(e){e.table&&e.table.modelAdapter&&(e=s.a.extend({},e),Pt.applyTo(e)),this.initOrig(e)}),!0),oi.replacePrototypeFunction(gD,"_ensureCell",(function(e){var t;return this.table.modelAdapter?(oi.isPlainObject(e)?((t=e).value=this._parseValue(t.value),t.text&&void 0===t.value&&!t.errorStatus&&(t.value=this._parseValue(t.text)),void 0===t.value&&(t.value=null)):t={value:this._parseValue(e)},Pt.applyTo(t,"Cell"),O.create("Cell",t)):this._ensureCellOrig(e)}),!0),oi.replacePrototypeFunction(gD,"isSortingPossible",(function(){return this.table.modelAdapter?O.nvl(this.uiSortPossible,!0)&&this.installComparator():this.isSortingPossibleOrig()}),!0))}},{key:"modifyBooleanColumnPrototype",value:function(){x.get().remote&&oi.replacePrototypeFunction(VD,"_toggleCellValue",(function(e,t){this.table.modelAdapter||this._toggleCellValueOrig(e,t)}),!0)}}],(n=[{key:"_postCreateWidget",value:function(){oi.values(this.widget._filterMap).some((function(e){return e instanceof XM}))&&this._onWidgetFilter()}},{key:"_sendRowsSelected",value:function(e,t){var n={rowIds:e};this._send("rowsSelected",n,{delay:t?250:0,coalesce:function(e){return this.target===e.target&&this.type===e.type}})}},{key:"_sendRowClick",value:function(e,t,n){var i={rowId:e,columnId:n,mouseButton:t};this._send("rowClick",i)}},{key:"_onWidgetRowsSelected",value:function(e){var t=this.widget._rowsToIds(this.widget.selectedRows);this._sendRowsSelected(t,e.debounce)}},{key:"_onWidgetRowClick",value:function(e){var t;void 0!==e.column&&(t=e.column.id),this._sendRowClick(e.row.id,e.mouseButton,t)}},{key:"_onWidgetFilterAdded",value:function(e){var t=e.filter;t instanceof XM&&this._send("filterAdded",t.createFilterAddedEventData())}},{key:"_onWidgetFilterRemoved",value:function(e){var t=e.filter;t instanceof XM&&this._send("filterRemoved",t.createFilterRemovedEventData())}},{key:"_onWidgetColumnResized",value:function(e){this._sendColumnResized(e.column)}},{key:"_sendColumnResized",value:function(e){if(!e.fixedWidth&&!this.widget.autoResizeColumns){var t={columnId:e.id,width:e.width};this._send("columnResized",t,{delay:750,coalesce:function(e){return this.target===e.target&&this.type===e.type&&this.columnId===e.columnId},showBusyIndicator:!1})}}},{key:"_onWidgetAggregationFunctionChanged",value:function(e){this._sendAggregationFunctionChanged(e.column)}},{key:"_sendAggregationFunctionChanged",value:function(e){var t={columnId:e.id,aggregationFunction:e.aggregationFunction};this._send("aggregationFunctionChanged",t)}},{key:"_onWidgetColumnBackgroundEffectChanged",value:function(e){this._sendColumnBackgroundEffectChanged(e.column)}},{key:"_sendColumnBackgroundEffectChanged",value:function(e){var t={columnId:e.id,backgroundEffect:e.backgroundEffect};this._send("columnBackgroundEffectChanged",t)}},{key:"_onWidgetColumnOrganizeAction",value:function(e){this._send("columnOrganizeAction",{action:e.action,columnId:e.column.id})}},{key:"_onWidgetColumnMoved",value:function(e){var t=e.newPos;this.widget.columns.forEach((function(e,n){e.guiOnly&&t--})),this._sendColumnMoved(e.column,t)}},{key:"_sendColumnMoved",value:function(e,t){var n={columnId:e.id,index:t};this._send("columnMoved",n)}},{key:"_onWidgetPrepareCellEdit",value:function(e){e.preventDefault(),this._sendPrepareCellEdit(e.row,e.column)}},{key:"_sendPrepareCellEdit",value:function(e,t){var n={rowId:e.id,columnId:t.id};this._send("prepareCellEdit",n)}},{key:"_onWidgetCompleteCellEdit",value:function(e){e.preventDefault(),this._sendCompleteCellEdit(e.field)}},{key:"_sendCompleteCellEdit",value:function(e){var t={fieldId:e.id};this._send("completeCellEdit",t)}},{key:"_onWidgetCancelCellEdit",value:function(e){e.preventDefault(),this._sendCancelCellEdit(e.field)}},{key:"_sendCancelCellEdit",value:function(e){var t={fieldId:e.id};this._send("cancelCellEdit",t)}},{key:"_onWidgetRowsChecked",value:function(e){this._sendRowsChecked(e.rows)}},{key:"_sendRowsChecked",value:function(e){for(var t={rows:[]},n=0;n<e.length;n++)t.rows.push({rowId:e[n].id,checked:e[n].checked});this._send("rowsChecked",t)}},{key:"_onWidgetRowsExpanded",value:function(e){this._sendRowsExpanded(e.rows)}},{key:"_sendRowsExpanded",value:function(e){var t={rows:e.map((function(e){return{rowId:e.id,expanded:e.expanded}}))};this._send("rowsExpanded",t)}},{key:"_onWidgetFilter",value:function(e){var t=this.widget._rowsToIds(this.widget.filteredRows());this._sendFilter(t)}},{key:"_sendFilter",value:function(e){var t={};e.length===this.widget.rows.length?t.remove=!0:t.rowIds=e,this._send("filter",t,{delay:250,coalesce:function(e){return this.target===e.target&&this.type===e.type&&this.remove===e.remove},showBusyIndicator:!1})}},{key:"_onWidgetSort",value:function(e){this._send("sort",{columnId:e.column.id,sortAscending:e.sortAscending,sortingRemoved:e.sortingRemoved,multiSort:e.multiSort,sortingRequested:e.sortingRequested})}},{key:"_onWidgetGroup",value:function(e){this._send("group",{columnId:e.column.id,groupAscending:e.groupAscending,groupingRemoved:e.groupingRemoved,multiGroup:e.multiGroup,groupingRequested:e.groupingRequested})}},{key:"_onWidgetRowAction",value:function(e){this._sendRowAction(e.row,e.column)}},{key:"_sendRowAction",value:function(e,t){this._send("rowAction",{rowId:e.id,columnId:t.id})}},{key:"_onWidgetAppLinkAction",value:function(e){this._sendAppLinkAction(e.column,e.ref)}},{key:"_sendAppLinkAction",value:function(e,t){this._send("appLinkAction",{columnId:e.id,ref:t})}},{key:"_sendContextColumn",value:function(e){e.guiOnly&&(e=null,this.widget.contextColumn=null);var t=null;e&&(t=e.id),this._send("property",{contextColumn:t})}},{key:"_onWidgetReload",value:function(e){var t={reloadReason:e.reloadReason};this._send("reload",t)}},{key:"_onWidgetExportToClipboard",value:function(e){this._send("clipboardExport"),e.preventDefault()}},{key:"_onWidgetEvent",value:function(e){"rowsSelected"===e.type?this._onWidgetRowsSelected(e):"rowsChecked"===e.type?this._onWidgetRowsChecked(e):"rowsExpanded"===e.type?this._onWidgetRowsExpanded(e):"filter"===e.type?this._onWidgetFilter(e):"sort"===e.type?this._onWidgetSort(e):"group"===e.type?this._onWidgetGroup(e):"rowClick"===e.type?this._onWidgetRowClick(e):"rowAction"===e.type?this._onWidgetRowAction(e):"prepareCellEdit"===e.type?this._onWidgetPrepareCellEdit(e):"completeCellEdit"===e.type?this._onWidgetCompleteCellEdit(e):"cancelCellEdit"===e.type?this._onWidgetCancelCellEdit(e):"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):"clipboardExport"===e.type?this._onWidgetExportToClipboard(e):"reload"===e.type?this._onWidgetReload(e):"filterAdded"===e.type?this._onWidgetFilterAdded(e):"filterRemoved"===e.type?this._onWidgetFilterRemoved(e):"columnResized"===e.type?this._onWidgetColumnResized(e):"columnMoved"===e.type?this._onWidgetColumnMoved(e):"columnBackgroundEffectChanged"===e.type?this._onWidgetColumnBackgroundEffectChanged(e):"columnOrganizeAction"===e.type?this._onWidgetColumnOrganizeAction(e):"aggregationFunctionChanged"===e.type?this._onWidgetAggregationFunctionChanged(e):tR(oR(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onRowsInserted",value:function(e){this.widget.insertRows(e),this._rebuildingTable=!1}},{key:"_onRowsDeleted",value:function(e){var t=this.widget._rowsByIds(e);this.addFilterForWidgetEventType("rowsSelected"),this.widget.deleteRows(t)}},{key:"_onAllRowsDeleted",value:function(){this.addFilterForWidgetEventType("rowsSelected"),this.widget.deleteAllRows()}},{key:"_onRowsUpdated",value:function(e){this.widget.updateRows(e)}},{key:"_onRowsSelected",value:function(e){var t=this.widget._rowsByIds(e);this.addFilterForWidgetEventType("rowsSelected"),this.widget.selectRows(t),this.widget.selectionHandler.clearLastSelectedRowMarker()}},{key:"_onRowsChecked",value:function(e){var t=[],n=[];e.forEach((function(e){var i=this.widget._rowById(e.id);e.checked?t.push(i):n.push(i)}),this),this.addFilterForWidgetEventType("rowsChecked"),this.widget.checkRows(t,{checked:!0,checkOnlyEnabled:!1}),this.widget.uncheckRows(n,{checkOnlyEnabled:!1})}},{key:"_onRowsExpanded",value:function(e){var t=[],n=[];e.forEach((function(e){var i=this.widget._rowById(e.id);e.expanded?t.push(i):n.push(i)}),this),this.addFilterForWidgetEventType("rowsExpanded"),this.widget.expandRows(t),this.widget.collapseRows(n)}},{key:"_onRowOrderChanged",value:function(e){var t=this.widget._rowsByIds(e);this.widget.updateRowOrder(t)}},{key:"_onColumnStructureChanged",value:function(e){this._rebuildingTable=!0,this.widget.updateColumnStructure(e)}},{key:"_onColumnOrderChanged",value:function(e){var t=this.widget.columnsByIds(e);this.widget.updateColumnOrder(t)}},{key:"_onColumnHeadersUpdated",value:function(e){e.forEach((function(e){Pt.applyTo(e)})),this.widget.updateColumnHeaders(e),this.widget.tileMode&&this.widget.tableTileGridMediator&&(this.widget.tableTileGridMediator._onTableGroup(),this.widget.updateRowOrder(this.widget.rows))}},{key:"_onStartCellEdit",value:function(e,t,n){var i=this.widget.columnById(e),r=this.widget._rowById(t),o=this.session.getOrCreateWidget(n,this.widget);this.widget.startCellEdit(i,r,o)}},{key:"_onEndCellEdit",value:function(e){var t=this.session.getModelAdapter(e);this.widget.endCellEdit(t.widget)}},{key:"_onRequestFocus",value:function(){this.widget.focus()}},{key:"_onScrollToSelection",value:function(){this.widget.revealSelection()}},{key:"_onColumnBackgroundEffectChanged",value:function(e){e.eventParts.forEach((function(e){var t=this.widget.columnById(e.columnId),n=e.backgroundEffect;this.addFilterForWidgetEvent((function(e){return"columnBackgroundEffectChanged"===e.type&&e.column.id===t.id&&e.column.backgroundEffect===n})),t.setBackgroundEffect(n)}),this)}},{key:"_onRequestFocusInCell",value:function(e){var t=this.widget._rowById(e.rowId),n=this.widget.columnById(e.columnId);this.widget.focusCell(n,t)}},{key:"_onAggregationFunctionChanged",value:function(e){var t=[],n=[];e.eventParts.forEach((function(e){var i=e.aggregationFunction,r=this.widget.columnById(e.columnId);this.addFilterForWidgetEvent((function(e){return"aggregationFunctionChanged"===e.type&&e.column.id===r.id&&e.column.aggregationFunction===i})),t.push(r),n.push(i)}),this),this.widget.changeAggregations(t,n)}},{key:"_onFiltersChanged",value:function(e){this.addFilterForWidgetEventType("filterAdded"),this.addFilterForWidgetEventType("filterRemoved"),this.widget.setFilters(e),this._rebuildingTable||this.widget.filter()}},{key:"onModelAction",value:function(e){"rowsInserted"===e.type?this._onRowsInserted(e.rows):"rowsDeleted"===e.type?this._onRowsDeleted(e.rowIds):"allRowsDeleted"===e.type?this._onAllRowsDeleted():"rowsSelected"===e.type?this._onRowsSelected(e.rowIds):"rowOrderChanged"===e.type?this._onRowOrderChanged(e.rowIds):"rowsUpdated"===e.type?this._onRowsUpdated(e.rows):"filtersChanged"===e.type?this._onFiltersChanged(e.filters):"rowsChecked"===e.type?this._onRowsChecked(e.rows):"rowsExpanded"===e.type?this._onRowsExpanded(e.rows):"columnStructureChanged"===e.type?this._onColumnStructureChanged(e.columns):"columnOrderChanged"===e.type?this._onColumnOrderChanged(e.columnIds):"columnHeadersUpdated"===e.type?this._onColumnHeadersUpdated(e.columns):"startCellEdit"===e.type?this._onStartCellEdit(e.columnId,e.rowId,e.fieldId):"endCellEdit"===e.type?this._onEndCellEdit(e.fieldId):"requestFocus"===e.type?this._onRequestFocus():"scrollToSelection"===e.type?this._onScrollToSelection():"aggregationFunctionChanged"===e.type?this._onAggregationFunctionChanged(e):"columnBackgroundEffectChanged"===e.type?this._onColumnBackgroundEffectChanged(e):"requestFocusInCell"===e.type?this._onRequestFocusInCell(e):tR(oR(o.prototype),"onModelAction",this).call(this,e)}},{key:"exportAdapterData",value:function(e){return delete(e=tR(oR(o.prototype),"exportAdapterData",this).call(this,e)).selectedRows,e.rows=[],e.columns.forEach((function(e){delete e.classId,delete e.modelClass})),e}}])&&eR(t.prototype,n),i&&eR(t,i),o}(fe);function aR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}x.addListener("bootstrap",sR.modifyTablePrototype),x.addListener("bootstrap",sR.modifyColumnPrototype),x.addListener("bootstrap",sR.modifyBooleanColumnPrototype);var uR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$row=null,this.aggregateRowAfter=null,this.cells=[],this.checked=!1,this.enabled=!0,this.filterAccepted=!0,this.height=null,this.hasError=!1,this.id=null,this.initialized=!1,this.parentRow=null,this.parent=null,this.childRows=[],this.expanded=!1,this.status=e.Status.NON_CHANGED}var t,n,i;return t=e,(n=[{key:"init",value:function(e){this._init(e),this.initialized=!0}},{key:"_init",value:function(e){if(!e.parent)throw new Error("missing property 'parent'");s.a.extend(this,e),Pt.applyTo(this),this._initCells()}},{key:"_initCells",value:function(){this.getTable().columns.forEach((function(e){if(!e.guiOnly){var t=this.cells[e.index];t=e.initCell(t,this),this.cells[e.index]=t}}),this)}},{key:"animateExpansion",value:function(){var e,t=this.$row;t&&(e=t.find(".table-row-control"),this.expanded?e.addClassForAnimation("expand-rotate"):e.addClassForAnimation("collapse-rotate"))}},{key:"hasFilterAcceptedChildren",value:function(){return this.childRows.some((function(e){return e.filterAccepted||e.hasFilterAcceptedChildren()}))}},{key:"getTable",value:function(){return this.parent}}])&&aR(t.prototype,n),i&&aR(t,i),e}();function lR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(uR,"Status",{NON_CHANGED:"nonChanged",INSERTED:"inserted",UPDATED:"updated"});var fR=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=n,this.locale=n.locale,this._allData=[],this._allAxis=[],this._rows=t.rows,this._table=t}var t,n,i;return t=e,(n=[{key:"addData",value:function(t,n){var i=[],r=this.locale;return this._allData.push(i),i.column=t,i.format=function(e){return r.decimalFormat.format(e)},n===e.NumberGroup.COUNT?(i.norm=function(e){return 1},i.group=function(e){return e.length}):n===e.NumberGroup.SUM?(i.norm=function(e){return isNaN(e)||null===e||""===e?null:parseFloat(e)},i.group=function(e){return e.reduce((function(e,t){return e+t}))}):n===e.NumberGroup.AVG&&(i.norm=function(e){return isNaN(e)||null===e||""===e?null:parseFloat(e)},i.group=function(e){var t=e.reduce((function(e,t){return e+t})),n=e.reduce((function(e,t){return null===t?e:e+1}),0);return 0===n?null:t/n}),i}},{key:"addAxis",value:function(t,n){var i=[],r=this.locale,o=this.session,s=this.session.text.bind(this.session),a=s("ui.EmptyCell");return this._allAxis.push(i),i.column=t,i.normTable=[],i.add=function(e){-1===i.indexOf(e)&&i.push(e)},i.reorder=function(){i.sort((function(e,t){return null===e?1:null===t?-1:e-t}))},i.norm=function(e){if(null===e||""===e)return null;var t=i.normTable.indexOf(e);return-1===t?i.normTable.push(e)-1:t},i.format=function(e){return null===e?a:i.normTable[e]},t instanceof XD?n===e.DateGroup.NONE?(i.norm=function(e){return null===e||""===e?null:e.getTime()},i.format=function(e){if(null===e)return null;var n=t.format;return(n=n?If.ensure(r,n):r.dateFormat).format(new Date(e))}):n===e.DateGroup.YEAR?(i.norm=function(e){return null===e||""===e?null:e.getFullYear()},i.format=function(e){return null===e?a:String(e)}):n===e.DateGroup.MONTH?(i.norm=function(e){return null===e||""===e?null:e.getMonth()},i.format=function(e){return null===e?a:r.dateFormatSymbols.months[e]}):n===e.DateGroup.WEEKDAY?(i.norm=function(e){return null===e||""===e?null:(e.getDay()+7-r.dateFormatSymbols.firstDayOfWeek)%7},i.format=function(e){return null===e?a:r.dateFormatSymbols.weekdaysOrdered[e]}):n===e.DateGroup.DATE&&(i.norm=function(e){return null===e||""===e?null:wt.trunc(e).getTime()},i.format=function(e){return null===e?a:wt.format(new Date(e),r,r.dateFormatPatternDefault)}):t instanceof hF?(i.norm=function(e){return isNaN(e)||null===e||""===e?null:parseFloat(e)},i.format=function(e){return isNaN(e)||null===e?a:t.decimalFormat.format(e)}):t instanceof VD?(i.norm=function(e){return t.triStateEnabled&&null===e?-1:!0===e?1:0},i.format=function(e){return-1===e?s("ui.BooleanColumnGroupingMixed"):0===e?s("ui.BooleanColumnGroupingFalse"):1===e?s("ui.BooleanColumnGroupingTrue"):void 0}):t instanceof rF?i.textIsIcon=!0:i.reorder=function(){var e=yD.TEXT;e.install(o),i.sort((function(t,n){return null===t?1:null===n?-1:e.compare(i.format(t),i.format(n))}))},i}},{key:"calculate",value:function(){var e,t,n,i,r,o,s,a={};for(e=0;e<this._rows.length;e++){var u=this._rows[e],l=[];for(n=0;n<this._allAxis.length;n++)r=this._allAxis[n].column.cellValueOrTextForCalculation(u),void 0!==(s=this._allAxis[n].norm(r))&&(this._allAxis[n].add(s),l.push(s));l=JSON.stringify(l);var c=[];for(t=0;t<this._allData.length;t++)i=this._table.cellValue(this._allData[t].column,u),void 0!==(o=this._allData[t].norm(i))&&c.push(o);a[l]?a[l].push(c):a[l]=[c]}for(t=0;t<this._allData.length;t++){for(n in(i=this._allData[t]).total=0,i.min=null,i.max=null,a)if(a.hasOwnProperty(n)){for(var f=a[n],h=[],d=0;d<f.length;d++)h.push(f[d][t]);var p=this._allData[t].group(h);if(a[n][t]=p,i.total+=p,null===p)continue;(p<i.min||null===i.min)&&(i.min=p),(p>i.max||null===i.min)&&(i.max=p)}0===O.nvl(i.max,0)&&(i.max=.1);var y=Math.ceil(Math.log(i.max)/Math.LN10)-1;i.max=Math.ceil(i.max/Math.pow(10,y))*Math.pow(10,y),i.max=4*Math.ceil(i.max/4)}for(n=0;n<this._allAxis.length;n++)(r=this._allAxis[n]).min=et.min(r),r.max=et.max(r),-1!==r.indexOf(null)&&(r.max=r.max+1),r.reorder();return a.getValue=function(e){return e=JSON.stringify(e),a.hasOwnProperty(e)?a[e]:null},a}},{key:"columnCount",value:function(e){var t,n,i,r,o,s=this.columns(e),a=[],u=0;for(t=0;t<s.length;t++){for(n=s[t],a.push([n,[]]),i=0;i<this._rows.length;i++)r=this._rows[i],o=n.cellValueOrTextForCalculation(r),-1===a[u][1].indexOf(o)&&a[u][1].push(o);a[u][1]=a[u][1].length,u++}return a}},{key:"isEmpty",value:function(){return 0===this._rows.length||0===this.columns().length}},{key:"columns",value:function(e){return e=O.nvl(e,!0),this._table.visibleColumns().filter((function(t){return!(t.guiOnly||e&&t instanceof hF)}))}},{key:"isMatrixValid",value:function(){return 0===this._table.rows.length||this.columns(!1).length===this._table.rows[0].cells.length}}])&&lR(t.prototype,n),i&&lR(t,i),e}();function hR(e){return(hR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pR(e,t,n){return(pR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mR(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function yR(e,t){return(yR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mR(e);if(t){var r=mR(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bR(this,n)}}function bR(e,t){return!t||"object"!==hR(t)&&"function"!=typeof t?gR(e):t}function gR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mR(e){return(mR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}cR(fR,"DateGroup",{NONE:0,YEAR:256,MONTH:257,WEEKDAY:258,DATE:259}),cR(fR,"NumberGroup",{COUNT:-1,SUM:1,AVG:2});var _R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yR(e,t)}(o,e);var t,n,i,r=vR(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._compactStyle=!1,e.animating=!1,e.open=!1,e.resizing=!1,e.table=null,e._tableRowsChangedHandler=e._onTableRowsChanged.bind(gR(e)),e._tableFilterHandler=e._onTableFilter.bind(gR(e)),e._tableFilterAddedHandler=e._onTableFilterAdded.bind(gR(e)),e._tableFilterRemovedHandler=e._onTableFilterRemoved.bind(gR(e)),e._tableRowsSelectedHandler=e._onTableRowsSelected.bind(gR(e)),e._tableStatusChangedHandler=e._onTableStatusChanged.bind(gR(e)),e._tablePropertyChangeHandler=e._onTablePropertyChange.bind(gR(e)),e}return t=o,(n=[{key:"_init",value:function(e){pR(mR(o.prototype),"_init",this).call(this,e),this.searchFieldKeyStrokeContext=new Fu,this.searchFieldKeyStrokeContext.$bindTarget=function(){return this._$textFilter}.bind(this),this.searchFieldKeyStrokeContext.$scopeTarget=function(){return this._$textFilter}.bind(this)}},{key:"_render",value:function(){var e,t;this.$container=this.$parent.appendDiv("table-footer"),this._$window=this.$parent.window(),this._$body=this.$parent.body(),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new PR(this)),this.$controlContainer=this.$container.appendDiv("table-control-container").hide(),this.$controlContent=this.$controlContainer.appendDiv("table-control-content"),this._$controls=this.$container.appendDiv("table-controls"),this._$info=this.$container.appendDiv("table-info"),t=this._$info.appendDiv("table-filter"),this._$textFilter=gH.makeTextField(this.$container,"table-text-filter").appendTo(t).on("input","",this._createOnFilterFieldInputFunction().bind(this)).placeholder(this.session.text("ui.FilterBy_")),(e=this.table.getFilter(MI.TYPE))&&this._$textFilter.val(e.text),this.$clearIcon=t.appendSpan("clear-icon unfocusable needsclick").on("mousedown",this._onDeleteFilterMouseDown.bind(this)),this._$infoLoad=this._$info.appendDiv("table-info-item table-info-load").on("click","",this._onInfoLoadClick.bind(this)),this._$infoFilter=this._$info.appendDiv("table-info-item table-info-filter").on("click","",this._onInfoFilterClick.bind(this)),this._$infoSelection=this._$info.appendDiv("table-info-item table-info-selection").on("click","",this._onInfoSelectionClick.bind(this)),this._$infoTableStatus=this._$info.appendDiv("table-info-item table-info-status").on("mousedown",this._onStatusMouseDown.bind(this)),this._$infoTableStatusIcon=this._$infoTableStatus.appendSpan("icon font-icon"),this._renderControls(),this._renderInfo(),this._updateInfoVisibility(),this.table.on("rowsInserted",this._tableRowsChangedHandler),this.table.on("rowsDeleted",this._tableRowsChangedHandler),this.table.on("allRowsDeleted",this._tableRowsChangedHandler),this.table.on("filter",this._tableFilterHandler),this.table.on("filterAdded",this._tableFilterAddedHandler),this.table.on("filterRemoved",this._tableFilterRemovedHandler),this.table.on("rowsSelected",this._tableRowsSelectedHandler),this.table.on("statusChanged",this._tableStatusChangedHandler),this.table.on("propertyChange",this._tablePropertyChangeHandler),this.session.keyStrokeManager.installKeyStrokeContext(this.searchFieldKeyStrokeContext)}},{key:"getFocusableElement",value:function(){return this._$textFilter}},{key:"_renderProperties",value:function(){this._updateHasFilterText()}},{key:"_remove",value:function(){this.session.keyStrokeManager.uninstallKeyStrokeContext(this.searchFieldKeyStrokeContext),this._hideTableStatusTooltip(),this.$resizer=null,this.$controlContainer.stop(!1,!0),this.animating=!1,this.open=!1,this.table.off("rowsInserted",this._tableRowsChangedHandler),this.table.off("rowsDeleted",this._tableRowsChangedHandler),this.table.off("allRowsDeleted",this._tableRowsChangedHandler),this.table.off("filter",this._tableFilterHandler),this.table.off("filterAdded",this._tableFilterAddedHandler),this.table.off("filterRemoved",this._tableFilterRemovedHandler),this.table.off("rowsSelected",this._tableRowsSelectedHandler),this.table.off("statusChanged",this._tableStatusChangedHandler),this.table.off("propertyChange",this._tablePropertyChangeHandler),pR(mR(o.prototype),"_remove",this).call(this)}},{key:"_renderResizerVisible",value:function(){this.selectedControl.resizerVisible?(this._renderResizer(),this.$controlContainer.addClass("has-resizer")):this.$resizer&&(this.$resizer.remove(),this.$resizer=null,this.$controlContainer.removeClass("has-resizer"))}},{key:"_renderResizer",value:function(){this.$resizer||(this.$resizer=this.$controlContainer.prependDiv("table-control-resize").on("mousedown","",function(e){var t=this.$controlContainer.height(),n=Math.floor(e.pageY);return this._$window.on("mousemove.tablefooter",function(e){if(this.rendered){var i=Math.floor(e.pageY)-n,r=this.table.$container.height()-this.table.footer.$container.height(),o=Math.min(t-i,r);this.$controlContainer.height(o);var s=No.insets(this.$controlContainer);this.$controlContent.outerHeight(o-s.vertical()),this._revalidateTableLayout()}}.bind(this)).one("mouseup",function(){this.rendered&&this.$controlContainer.height()<100&&this.selectedControl.setSelected(!1),this._$window.off("mousemove.tablefooter"),this._$body.removeClass("row-resize"),this.resizing=!1}.bind(this)),this._$body.addClass("row-resize"),this.resizing=!0,!1}.bind(this)))}},{key:"_renderControls",value:function(){var e=this.table.tableControls;e?e.forEach(function(e){e.setParent(this),e.render(this._$controls)}.bind(this)):this._$controls.empty()}},{key:"_renderInfo",value:function(){this._renderInfoLoad(),this._renderInfoTableStatus(),this._renderInfoFilter(),this._renderInfoSelection()}},{key:"_renderInfoLoad",value:function(){var e=this._$infoLoad,t=this.table.rows.length,n=this.table.estimatedRowCount,i=this.table.maxRowCount;e.empty(),this._compactStyle?(t<=1?e.appendSpan().text(this.session.text("ui.NumRowLoadedMin")):e.appendSpan().text(this.session.text("ui.NumRowsLoadedMin")),e.appendBr(),e.appendSpan("table-info-button").text(this.computeCountInfo(t))):(t<=1?e.appendSpan().text(this.session.text("ui.NumRowLoaded",this.computeCountInfo(t))):n&&n>t?e.appendSpan().text(this.session.text("ui.NumRowsLoaded",this.computeCountInfo(t,n))):e.appendSpan().text(this.session.text("ui.NumRowsLoaded",this.computeCountInfo(t))),this.table.hasReloadHandler&&(e.appendBr(),n&&i&&t<n&&t<i?n<i?e.appendSpan("table-info-button").text(this.session.text("ui.LoadAllData")).appendTo(e):e.appendSpan("table-info-button").text(this.session.text("ui.LoadNData",this.computeCountInfo(i))).appendTo(e):e.appendSpan("table-info-button").text(this.session.text("ui.ReloadData")).appendTo(e))),e.setEnabled(this.table.hasReloadHandler),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}},{key:"_renderInfoFilter",value:function(){var e=this._$infoFilter,t=this.table.filteredRows().length,n=this.table.filteredBy().join(", ");e.empty(),this._compactStyle?(t<=1?e.appendSpan().text(this.session.text("ui.NumRowFilteredMin")):e.appendSpan().text(this.session.text("ui.NumRowsFilteredMin")),e.appendBr(),e.appendSpan("table-info-button").text(this.computeCountInfo(t))):(n?t<=1?e.appendSpan().text(this.session.text("ui.NumRowFilteredBy",this.computeCountInfo(t),n)):e.appendSpan().text(this.session.text("ui.NumRowsFilteredBy",this.computeCountInfo(t),n)):t<=1?e.appendSpan().text(this.session.text("ui.NumRowFiltered",this.computeCountInfo(t))):e.appendSpan().text(this.session.text("ui.NumRowsFiltered",this.computeCountInfo(t))),this.table.hasUserFilter()&&(e.appendBr(),e.appendSpan("table-info-button").text(this.session.text("ui.RemoveFilter")).appendTo(e))),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}},{key:"_renderInfoSelection",value:function(){var e=this._$infoSelection,t=this.table.filteredRows().length,n=this.table.selectedRows.length,i=t>0&&t===n;e.empty(),this._compactStyle?(n<=1?e.appendSpan().text(this.session.text("ui.NumRowSelectedMin")):e.appendSpan().text(this.session.text("ui.NumRowsSelectedMin")),e.appendBr(),e.appendSpan("table-info-button").text(this.computeCountInfo(n))):(n<=1?e.appendSpan().text(this.session.text("ui.NumRowSelected",this.computeCountInfo(n))):e.appendSpan().text(this.session.text("ui.NumRowsSelected",this.computeCountInfo(n))),e.appendBr(),e.appendSpan("table-info-button").text(this.session.text(i?"ui.SelectNone":"ui.SelectAll")).appendTo(e)),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}},{key:"_renderInfoTableStatus",value:function(){var e=this._$infoTableStatus,t=this.table.tableStatus;e.removeClass(pi.SEVERITY_CSS_CLASSES),t&&e.addClass(t.cssClass()),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}},{key:"_updateInfoVisibility",value:function(){this._updateInfoFilterVisibility(),this._updateInfoSelectionVisibility(),this._updateInfoTableStatusVisibility()}},{key:"_updateInfoFilterVisibility",value:function(){var e=this.table.filteredBy().length>0;this._setInfoVisible(this._$infoFilter,e)}},{key:"_updateInfoSelectionVisibility",value:function(){var e=this.table.multiSelect;this._setInfoVisible(this._$infoSelection,e)}},{key:"_updateInfoTableStatusVisibility",value:function(){if(this.table.tableStatus){var e=null;O.isOneOf(this.table.tableStatus.uiState,"user-hidden","auto-hidden")||(this._$infoTableStatus.addClass("tooltip-active"),e=function(){this.table.tableStatus&&!O.isOneOf(this.table.tableStatus.uiState,"user-hidden","auto-hidden")&&this._showTableStatusTooltip()}.bind(this)),this._setInfoVisible(this._$infoTableStatus,!0,e)}else this._hideTableStatusTooltip(),this._setInfoVisible(this._$infoTableStatus,!1)}},{key:"_setInfoVisible",value:function(e,t,n){if(e.isVisible()!==t||t&&e.data("hiding"))if(this.rendered)if(t){var i={progress:this.revalidateLayout.bind(this),complete:function(){n&&n()}};e.data("animationComplete",i.complete),""===e[0].style.width&&e.cssWidth(0),e.stop().removeData("hiding").setVisible(!0).widthToContent(i)}else e.data("hiding",!0),e.stop().animate({width:0},{progress:this.revalidateLayout.bind(this),complete:function(){e.removeData("hiding"),e.setVisible(!1)}});else e.setVisible(t);else n&&n()}},{key:"_toggleTableInfoTooltip",value:function(e,t){this._tableInfoTooltip?this._tableInfoTooltip.destroy():(this._tableInfoTooltip=O.create(t,{parent:this,tableFooter:this,cssClass:"table-info-tooltip",arrowPosition:50,arrowPositionUnit:"%",$anchor:e}),this._tableInfoTooltip.one("destroy",function(){this._tableInfoTooltip=null}.bind(this)),this._tableInfoTooltip.render())}},{key:"computeCountInfo",value:function(e,t){return e=O.nvl(e,0),t?this.session.text("ui.TableRowCount",this.session.text("ui.CountOfApproxTotal",this.session.locale.decimalFormat.format(e),this.session.locale.decimalFormat.format(t))):0===e?this._compactStyle?this.session.text("ui.TableRowCount",0):this.session.text("ui.TableRowCount0"):1===e?this.session.text("ui.TableRowCount1"):this.session.text("ui.TableRowCount",this.session.locale.decimalFormat.format(e))}},{key:"_revalidateTableLayout",value:function(){this.table.htmlComp.revalidateLayoutTree()}},{key:"openControlContainer",value:function(e){this.open;var t=this.$controlContent.data("control");this.animating&&t!==e&&t.onControlContainerClosed(),this.animating=!0,this.open=!0;var n=this.computeControlContainerHeight(this.table,e),i=No.insets(this.$controlContainer);this.$controlContent.outerHeight(n-i.vertical()),""===this.$controlContainer[0].style.height&&this.$controlContainer.outerHeight(0),this.$controlContainer.outerHeight()>n&&this.table.invalidateLayoutTree(),this.$controlContainer.stop(!0).show().delay(1).animate({height:n},{duration:this.rendered?e.animateDuration:0,complete:function(){this.animating=!1,e.onControlContainerOpened(),this.table.invalidateLayoutTree()}.bind(this)})}},{key:"closeControlContainer",value:function(e,t){if(this.open){t=s.a.extend({},{animate:!0},t),this.open=!1,this.animating=!0,this.table.invalidateLayoutTree();var n=function(){this.animating=!1,this.$controlContainer.hide(),e.onControlContainerClosed()}.bind(this);t.animate?this.$controlContainer.stop(!0).show().animate({height:0},{duration:e.animateDuration,complete:n}):n()}}},{key:"computeControlContainerHeight",value:function(e,t,n){var i,r,o=0,s=No.size(e.$container).height,a=0,u=No.margins(O.nvl(e.$data,e.$container)),l=u.top+u.bottom,c=e.menuBar,f=e.footer,h=e.htmlComp,d=h.availableSize().subtract(h.insets());if(f){if(e.menuBarVisible&&c.visible){var p=Uo.get(c.$container);o=D_.size(p,d).height}return i=No.size(f.$container).height,f.open&&(f.animating?a=t.height:(a=No.size(f.$controlContainer).height,!f.resizing&&n&&(a=Math.max(t.height,a)))),this.table.htmlComp.layouted&&(r=s-(l+o+i),a=Math.min(a,r)),a}}},{key:"_hideTableStatusTooltip",value:function(){clearTimeout(this._autoHideTableStatusTooltipTimeoutId),this._tableStatusTooltip&&this._tableStatusTooltip.destroy()}},{key:"_showTableStatusTooltip",value:function(){if(this._tableStatusTooltip&&(this._tableStatusTooltip.destroy(),this._tableStatusTooltip=null),this.rendered||this.rendering){var e=this.table.tableStatus,t=e?e.message:null;if(!En.empty(t)){var n={parent:this,text:t,severity:e.severity,autoRemove:!e.isError(),$anchor:this._$infoTableStatusIcon};this._tableStatusTooltip=O.create("Tooltip",n),this._tableStatusTooltip.one("destroy",function(){this._tableStatusTooltip=null}.bind(this)),this._tableStatusTooltip.render(),this._$infoTableStatus.addClass("tooltip-active"),this._tableStatusTooltip.on("remove",function(){this._$infoTableStatus.removeClass("tooltip-active"),clearTimeout(this._autoHideTableStatusTooltipTimeoutId),this.table.tableStatus&&!this.table.tableStatus.isError()&&(this.table.tableStatus.uiState="auto-hidden")}.bind(this)),clearTimeout(this._autoHideTableStatusTooltipTimeoutId),e.isError()||e.isWarning()||e.uiState||(this.table.tableStatus.uiState="auto-hidden",this._autoHideTableStatusTooltipTimeoutId=setTimeout(function(){this._hideTableStatusTooltip()}.bind(this),5e3))}}}},{key:"_updateHasFilterText",value:function(){this._$textFilter.toggleClass("has-text",!!this._$textFilter.val())}},{key:"onControlSelected",value:function(e){var t=this.selectedControl;this.selectedControl=e,e&&(this._renderResizerVisible(),t&&t.height!==e.height&&this.openControlContainer(e))}},{key:"_onStatusMouseDown",value:function(e){this._tableStatusTooltip?(this._hideTableStatusTooltip(),this.table.tableStatus.uiState="user-hidden"):(this._showTableStatusTooltip(),this._tableStatusTooltip.rendered&&(this.table.tableStatus.uiState="user-shown"))}},{key:"_createOnFilterFieldInputFunction",value:function(){var e=s.a.debounce(this._applyFilter.bind(this));return function(t){this._updateHasFilterText(),e()}}},{key:"_onDeleteFilterMouseDown",value:function(e){this._$textFilter.val(""),this._updateHasFilterText(),this._applyFilter(),e.preventDefault()}},{key:"_applyFilter",value:function(e){var t,n=this._$textFilter.val();this.filterText!==n&&(this.filterText=n,n?((t=O.create("TableTextUserFilter",{session:this.session,table:this.table})).text=n,this.table.addFilter(t)):this.table.removeFilterByKey(MI.TYPE),this.table.filter(),this.validateLayoutTree())}},{key:"_onInfoLoadClick",value:function(){if(this._$infoLoad.isEnabled())if(this._compactStyle)this._toggleTableInfoTooltip(this._$infoLoad,"TableInfoLoadTooltip");else{var e=this.table.rows.length,t=this.table.estimatedRowCount,n=this.table.maxRowCount;t&&n&&e<t&&e<n?this.table.reload(ZP.ReloadReason.OVERRIDE_ROW_LIMIT):this.table.reload()}}},{key:"_onInfoFilterClick",value:function(){this._compactStyle?this._toggleTableInfoTooltip(this._$infoFilter,"TableInfoFilterTooltip"):this.table.resetUserFilter()}},{key:"_onInfoSelectionClick",value:function(){this._compactStyle?this._toggleTableInfoTooltip(this._$infoSelection,"TableInfoSelectionTooltip"):this.table.toggleSelection()}},{key:"_onTableRowsChanged",value:function(e){this._renderInfoLoad()}},{key:"_onTableFilter",value:function(e){this._renderInfoFilter(),this._renderInfoSelection()}},{key:"_onTableFilterAdded",value:function(e){this._renderInfoFilter(),this._updateInfoFilterVisibility(),e.filter.filterType===MI.TYPE&&this._$textFilter.val()!==e.filter.text&&(this._$textFilter.val(e.filter.text),this._updateHasFilterText(),this._applyFilter())}},{key:"_onTableFilterRemoved",value:function(e){this._renderInfoFilter(),this._updateInfoFilterVisibility(),e.filter.filterType===MI.TYPE&&(this._$textFilter.val(""),this._updateHasFilterText(),this._applyFilter())}},{key:"_onTableRowsSelected",value:function(e){this._renderInfoSelection()}},{key:"_onTableStatusChanged",value:function(e){this._renderInfoTableStatus(),this._updateInfoTableStatusVisibility()}},{key:"_onTablePropertyChange",value:function(e){"multiSelect"===e.propertyName&&this._updateInfoSelectionVisibility()}}])&&dR(t.prototype,n),i&&dR(t,i),o}(de);function wR(e){return(wR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SR(e,t){return(SR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=CR(e);if(t){var r=CR(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return TR(this,n)}}function TR(e,t){return!t||"object"!==wR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CR(e){return(CR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SR(e,t)}(o,e);var t,n,i,r=OR(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this))._tableFooter=e,t}return t=o,(n=[{key:"layout",value:function(e){var t,n,i=this._tableFooter._$controls,r=this._tableFooter._$info,o=r.find(".table-info-item"),a=No.size(e).width;n=No.size(i,!0).width,No.size(r).width,o.each((function(){var e=s()(this);e.isVisible()&&!e.data("hiding")&&(e.data("oldWidth",e.outerWidth()),e.css("width","auto"))})),r.css("max-width",""),this._tableFooter._compactStyle&&(this._tableFooter._compactStyle=!1,this._tableFooter._renderInfo()),n+No.size(r).width<=a&&(this._tableFooter._tableInfoTooltip&&this._tableFooter._tableInfoTooltip.destroy(),t=!0),t||(this._tableFooter._compactStyle=!0,this._tableFooter._renderInfo(),n+No.size(r).width<=a&&(t=!0),r.css("max-width",Math.max(a-n,0)));var u=this._tableFooter.htmlComp.layouted;this._setInfoItemsSize(o,u),this._tableFooter._tableStatusTooltip&&this._tableFooter._tableStatusTooltip.rendered&&this._tableFooter._tableStatusTooltip.position(),this._tableFooter._tableInfoTooltip&&this._tableFooter._tableInfoTooltip.rendered&&this._tableFooter._tableInfoTooltip.position(),this._tableFooter.table.tableControls.forEach((function(e){e.revalidateLayout()}))}},{key:"_setInfoItemsSize",value:function(e,t){e.each((function(){var e=s()(this);if(e.isVisible()&&!e.data("hiding")){var n=e.data("animationComplete");t?(e.stop().cssWidthAnimated(e.data("oldWidth"),e.outerWidth(),{complete:n}),e.removeData("oldWidth")):e.cssWidth(e.outerWidth())}}))}}])&&kR(t.prototype,n),i&&kR(t,i),o}(zo);function RR(e){return(RR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ER(e,t,n){return(ER="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$R(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function DR(e,t){return(DR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function FR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$R(e);if(t){var r=$R(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return AR(this,n)}}function AR(e,t){return!t||"object"!==RR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $R(e){return($R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DR(e,t)}(o,e);var t,n,i,r=FR(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){ER($R(o.prototype),"_init",this).call(this,e),this.tableFooter=e.tableFooter}},{key:"_renderText",value:function(){var e=this.tableFooter.table,t=e.filteredRows().length,n=e.filteredBy().join(", ");this.$content.appendSpan().text(this.session.text("ui.NumRowsFilteredBy",this.tableFooter.computeCountInfo(t),n)),this.$content.appendBr(),this.$content.appendSpan("link").text(this.session.text("ui.RemoveFilter")).on("click",this._onRemoveFilterClick.bind(this))}},{key:"_onRemoveFilterClick",value:function(){this.tableFooter.table.resetUserFilter(),this.destroy()}}])&&xR(t.prototype,n),i&&xR(t,i),o}(lh);function MR(e){return(MR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function LR(e,t,n){return(LR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VR(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function BR(e,t){return(BR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=VR(e);if(t){var r=VR(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return HR(this,n)}}function HR(e,t){return!t||"object"!==MR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function VR(e){return(VR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var WR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BR(e,t)}(o,e);var t,n,i,r=NR(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){LR(VR(o.prototype),"_init",this).call(this,e),this.tableFooter=e.tableFooter}},{key:"_renderText",value:function(){var e=this.tableFooter.table.rows.length;this.$content.appendSpan().text(this.session.text("ui.NumRowsLoaded",this.tableFooter.computeCountInfo(e))),this.$content.appendBr(),this.$content.appendSpan("link").text(this.session.text("ui.ReloadData")).on("click",this._onReloadClick.bind(this))}},{key:"_onReloadClick",value:function(){this.tableFooter.table.reload(),this.destroy()}}])&&IR(t.prototype,n),i&&IR(t,i),o}(lh);function zR(e){return(zR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function UR(e,t,n){return(UR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=XR(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function KR(e,t){return(KR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=XR(e);if(t){var r=XR(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return YR(this,n)}}function YR(e,t){return!t||"object"!==zR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XR(e){return(XR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var JR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KR(e,t)}(o,e);var t,n,i,r=qR(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){UR(XR(o.prototype),"_init",this).call(this,e),this.tableFooter=e.tableFooter}},{key:"_renderText",value:function(){var e=this.tableFooter.table.selectedRows.length;this.$content.appendSpan().text(this.session.text("ui.NumRowsSelected",this.tableFooter.computeCountInfo(e))),this.$content.appendBr(),this.$content.appendSpan("link").text(this.session.text("ui.SelectNone")).on("click",this._onSelectNoneClick.bind(this)),this.$content.appendBr(),this.$content.appendSpan("link").text(this.session.text("ui.SelectAll")).on("click",this._onSelectAllClick.bind(this))}},{key:"_onSelectNoneClick",value:function(){this.tableFooter.table.deselectAll(),this.destroy()}},{key:"_onSelectAllClick",value:function(){this.tableFooter.table.selectAll(),this.destroy()}}])&&GR(t.prototype,n),i&&GR(t,i),o}(lh);function ZR(e){return(ZR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ex(e,t,n){return(ex="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ox(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function tx(e,t){return(tx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ox(e);if(t){var r=ox(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ix(this,n)}}function ix(e,t){return!t||"object"!==ZR(t)&&"function"!=typeof t?rx(e):t}function rx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ox(e){return(ox=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tx(e,t)}(o,e);var t,n,i,r=nx(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).dragging=!1,e.headerMenusEnabled=!0,e.table=null,e._tableDataScrollHandler=e._onTableDataScroll.bind(rx(e)),e._tableAddFilterRemovedHandler=e._onTableAddFilterRemoved.bind(rx(e)),e._tableColumnResizedHandler=e._onTableColumnResized.bind(rx(e)),e._tableColumnMovedHandler=e._onTableColumnMoved.bind(rx(e)),e._renderedColumns=[],e}return t=o,(n=[{key:"_init",value:function(e){ex(ox(o.prototype),"_init",this).call(this,e),this.menuBar=O.create("MenuBar",{parent:this,tabbable:!1,position:O_.Position.BOTTOM,menuOrder:new xY}),this.menuBar.on("propertyChange",this._onMenuBarPropertyChange.bind(this)),this.updateMenuBar()}},{key:"_render",value:function(){this.$container=this.table.$data.beforeDiv("table-header"),this.$filler=this.$container.appendDiv("table-header-item filler").css("visibility","hidden"),this.$menuBarContainer=this.$container.appendDiv("menubar-container").setVisible(this.menuBar.visible),this.menuBar.render(this.$menuBarContainer),this._$window=this.$container.window(),this._$body=this.$container.body(),this._renderColumns(),this.table.$data.on("scroll",this._tableDataScrollHandler),this.table.on("filterAdded",this._tableAddFilterRemovedHandler),this.table.on("filterRemoved",this._tableAddFilterRemovedHandler),this.table.on("columnResized",this._tableColumnResizedHandler),this.table.on("columnMoved",this._tableColumnMovedHandler)}},{key:"_remove",value:function(){this.table.$data.off("scroll",this._tableDataScrollHandler),this.table.off("filterAdded",this._tableAddFilterRemovedHandler),this.table.off("filterRemoved",this._tableAddFilterRemovedHandler),this.table.off("columnResized",this._tableColumnResizedHandler),this.table.off("columnMoved",this._tableColumnMovedHandler),this._removeColumns(),ex(ox(o.prototype),"_remove",this).call(this)}},{key:"rerenderColumns",value:function(){this._removeColumns(),this._renderColumns()}},{key:"_renderColumns",value:function(){var e=this._visibleColumns();e.forEach(this._renderColumn,this),0===e.length&&this.$filler.css("visibility","visible").html("&nbsp;").addClass("empty"),this._reconcileScrollPos()}},{key:"_renderColumn",value:function(e,t){var n=e._realWidthIfAvailable(),i="",r="",o=0===t,s=t===this._visibleColumns().length-1;o?i=this.table.rowBorderLeftWidth:s&&(r=this.table.rowBorderRightWidth);var a=this.$filler.beforeDiv("table-header-item").setEnabled(this.enabled).data("column",e).cssMinWidth(n).cssMaxWidth(n).cssMarginLeft(i).cssMarginRight(r);a.appendSpan("table-header-item-text"),this.enabled&&a.on("click",this._onHeaderItemClick.bind(this)).on("mousedown",this._onHeaderItemMouseDown.bind(this)),this.session.inspector&&an.applyInfo(e,a),o?a.addClass("first"):s&&a.addClass("last"),e.$header=a,this._installHeaderItemTooltip(e),this._decorateHeader(e);var u=e.showSeparator;if(s&&!this.enabled&&(u=!1),u){var l=this.$filler.beforeDiv("table-header-resize");e.fixedWidth||!this.enabled?l.setEnabled(!1):l.on("mousedown","",this._onSeparatorMouseDown.bind(this)).on("dblclick",this._onSeparatorDblclick.bind(this)),e.$separator=l}this._renderedColumns.push(e)}},{key:"_removeColumns",value:function(){this._renderedColumns.slice().forEach(this._removeColumn,this)}},{key:"_removeColumn",value:function(e){e.$header&&(e.$header.remove(),e.$header=null),e.$separator&&(e.$separator.remove(),e.$separator=null),et.remove(this._renderedColumns,e)}},{key:"resizeHeaderItem",value:function(e){if(e&&e.$header){var t,n,i=e.$header,r=e._realWidthIfAvailable(),o="",s="",a=this.menuBar.visible?this.$menuBarContainer.outerWidth(!0):0,u=this._visibleColumns(),l=u.indexOf(e),c=0===l,f=l===u.length-1;if(c)o=this.table.rowBorderLeftWidth;else if(f&&(s=this.table.rowBorderRightWidth,(t=this.$container.width()-this.table.rowWidth+No.insets(this.table.$data).right)<a)){n=a,e.$separator&&(n+=e.$separator.width()),t>0&&(n-=t);var h=r;r=Math.max(r-n,e.minWidth),this.$filler.cssWidth(h-r)}i.css("min-width",r).css("max-width",r).css("margin-left",o).css("margin-right",s),this.tableHeaderMenu&&this.tableHeaderMenu.rendered&&this.tableHeaderMenu.column===e&&this.tableHeaderMenu.onColumnResized()}}},{key:"resizeHeaderItems",value:function(){this._visibleColumns().forEach(this.resizeHeaderItem.bind(this))}},{key:"_reconcileScrollPos",value:function(){var e=this.table.get$Scrollable().scrollLeft(),t=this._lastVisibleColumn();this.resizeHeaderItem(t),this.$container.scrollLeft(e),this.$menuBarContainer.cssRight(-1*e)}},{key:"_arrangeHeaderItems",value:function(e){var t=this;e.each((function(){s()(this).css("left",s()(this).data("old-pos")-s()(this).offset().left).animate({left:0},{progress:function(e,n,i){var r=s()(this);r.isSelected()&&(wf.scrollHorizontalTo(t.table.$data,r),t.tableHeaderMenu&&t.tableHeaderMenu.rendered&&t.tableHeaderMenu.position())}})}))}},{key:"_installHeaderItemTooltip",value:function(e){dh.install(e.$header,{parent:this,text:this._headerItemTooltipText.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Mt.get().isCustomEllipsisTooltipPossible(),htmlEnabled:this._headerItemTooltipHtmlEnabled.bind(this)})}},{key:"_installHeaderItemTooltips",value:function(){this._visibleColumns().forEach(this._installHeaderItemTooltip,this)}},{key:"_uninstallHeaderItemTooltip",value:function(e){dh.uninstall(e.$header)}},{key:"_uninstallHeaderItemTooltips",value:function(){this._visibleColumns().forEach(this._uninstallHeaderItemTooltip,this)}},{key:"_headerItemTooltipText",value:function(e){var t=e.data("column");if(t&&En.hasText(t.headerTooltipText))return t.headerTooltipText;if(e.isContentTruncated()||e.width()+e.position().left>e.parent().width()){(e=e.clone()).children(".table-header-item-state").remove();var n=En.plainText(e.html(),{trim:!0});if(En.hasText(n))return n}return null}},{key:"_headerItemTooltipHtmlEnabled",value:function(e){return e.data("column").headerTooltipHtmlEnabled}},{key:"setHeaderMenusEnabled",value:function(e){this.setProperty("headerMenusEnabled",e)}},{key:"_renderHeaderMenusEnabled",value:function(){this._visibleColumns().forEach((function(e){this._decorateHeader(e)}),this)}},{key:"openHeaderMenu",value:function(e){this.tableHeaderMenu&&this.closeHeaderMenu(),this.tableHeaderMenu=e.createTableHeaderMenu(this),this.tableHeaderMenu.open(),e.trigger("headerMenuOpen",{menu:this.tableHeaderMenu}),this.tableHeaderMenu.one("destroy",function(){e.trigger("headerMenuClose",{menu:this.tableHeaderMenu})}.bind(this))}},{key:"closeHeaderMenu",value:function(){this.tableHeaderMenu.destroy(),this.tableHeaderMenu=null}},{key:"onColumnActionsChanged",value:function(e){this.tableHeaderMenu&&this.tableHeaderMenu.onColumnActionsChanged(e)}},{key:"findHeaderItems",value:function(){return this.$container.find(".table-header-item:not(.filler)")}},{key:"updateHeader",value:function(e,t){this._decorateHeader(e,t)}},{key:"_decorateHeader",value:function(e,t){this._renderColumnCssClass(e,t),this._renderColumnText(e),this._renderColumnIconId(e),this._renderColumnState(e),this._renderColumnLegacyStyle(e),this._renderColumnHeaderMenuEnabled(e),this._renderColumnHorizontalAlignment(e)}},{key:"_renderColumnCssClass",value:function(e,t){var n=e.$header;t&&n.removeClass(t.headerCssClass),n.addClass(e.headerCssClass)}},{key:"_renderColumnText",value:function(e){var t=e.text,n=e.$header.children(".table-header-item-text");e.headerHtmlEnabled||(t=En.nl2br(t)),n.htmlOrNbsp(t,"empty"),this._updateColumnIconAndTextStyle(e)}},{key:"_renderColumnIconId",value:function(e){e.$header.icon(e.headerIconId),this._updateColumnIconAndTextStyle(e)}},{key:"_renderColumnHorizontalAlignment",value:function(e){e.$header.removeClass("halign-left halign-center halign-right"),e.$header.addClass("halign-"+ZP.parseHorizontalAlignment(e.horizontalAlignment))}},{key:"_updateColumnIconAndTextStyle",value:function(e){var t=e.$header.data("$icon"),n=e.$header.children(".table-header-item-text");t&&t.toggleClass("with-text",!!e.text),n.setVisible(!(t&&"&nbsp;"===n.html())),e.$header.toggleClass("table-header-item-icon-only",!(!e.headerIconId||e.text))}},{key:"_renderColumnLegacyStyle",value:function(e){$i.legacyStyle(e,e.$header,"header")}},{key:"_renderColumnHeaderMenuEnabled",value:function(e){e.$header.toggleClass("disabled",!this._isHeaderMenuEnabled(e)||!this.enabled)}},{key:"_renderColumnState",value:function(e){var t,n,i=e.$header,r=this.table.getFilter(e.id);if(i.children(".table-header-item-state").remove(),(n=i.appendSpan("table-header-item-state")).empty(),i.removeClass("sort-asc sort-desc sorted group-asc group-desc grouped filtered"),n.removeClass("sort-asc sort-desc sorted group-asc group-desc grouped filtered"),e.sortActive&&(t=e.sortAscending?"asc":"desc",e.grouped&&i.addClass("group-"+t),i.addClass("sorted sort-"+t),n.addClass("sorted sort-"+t)),e.grouped||r){var o=n.appendDiv("left");e.grouped&&(i.addClass("grouped"),n.addClass("grouped"),o.appendDiv().text("G")),r&&(i.addClass("filtered"),n.addClass("filtered"),o.appendDiv().text("F"))}n.appendDiv("right"),this._adjustColumnMinWidth(e)}},{key:"_adjustColumnMinWidth",value:function(e){var t=this.table.getFilter(e.id);e.sortActive||e.grouped||t?(e.minWidth<gD.DEFAULT_MIN_WIDTH&&(e.prefMinWidth=e.minWidth,e.minWidth=gD.DEFAULT_MIN_WIDTH),e.width<e.minWidth&&this.table.resizeColumn(e,e.minWidth)):null!==e.prefMinWidth&&(e.minWidth=e.prefMinWidth,e.prefMinWidth=null,e.width===gD.DEFAULT_MIN_WIDTH&&this.table.resizeColumn(e,e.minWidth))}},{key:"updateMenuBar",value:function(){var e=this.table._filterMenus(this.table.menus,_b.HEADER);this.menuBar.setHiddenByUi(!this.enabled),this.menuBar.setMenuItems(e)}},{key:"_onTableColumnResized",value:function(e){var t=e.column,n=this._lastVisibleColumn();this.resizeHeaderItem(t),n!==t&&this.resizeHeaderItem(n)}},{key:"onSortingChanged",value:function(){this._visibleColumns().forEach(this._renderColumnState,this)}},{key:"_onTableColumnMoved",value:function(e){var t=e.column,n=e.oldPos,i=e.newPos,r=t.$header,o=this.findHeaderItems(),a=o.eq(n),u=a.next(),l=this._visibleColumns(),c=l.length-1;o.each((function(){s()(this).data("old-pos",s()(this).offset().left)})),i<n?(o.eq(i).before(a),o.eq(i).before(u)):(o.eq(i).after(a),o.eq(i).after(u)),o.length>0&&(o.eq(0).removeClass("first"),o.eq(o.length-1).removeClass("last")),l.length>0&&(l[0].$header.addClass("first"),l[c].$header.addClass("last")),n!==c&&i!==c||l.forEach(function(e){this.resizeHeaderItem(e)}.bind(this)),e.dragged?r.css("left",parseInt(r.css("left"),0)+r.data("old-pos")-r.offset().left).animateAVCSD("left",0):this._arrangeHeaderItems(o)}},{key:"_visibleColumns",value:function(){return this.table.visibleColumns()}},{key:"_lastVisibleColumn",value:function(){return et.last(this._visibleColumns())}},{key:"onOrderChanged",value:function(e){var t,n,i=this.findHeaderItems();i.each((function(){s()(this).data("old-pos",s()(this).offset().left)})),this._visibleColumns().forEach((function(e){t=e.$header,n=t.next(".table-header-resize"),this.$container.append(t),this.$container.append(n)}),this),this.$container.append(this.$filler),this._arrangeHeaderItems(i)}},{key:"_isHeaderMenuEnabled",value:function(e){return!(!e.headerMenuEnabled||!this.headerMenusEnabled)}},{key:"_onHeaderItemClick",value:function(e){var t=s()(e.currentTarget),n=t.data("column");return this.dragging||this.columnMoved?(this.dragging=!1,this.columnMoved=!1):this.table.sortEnabled&&(e.shiftKey||e.ctrlKey||!this._isHeaderMenuEnabled(n))?(this.table.removeColumnGrouping(),this.table.sort(n,t.hasClass("sort-asc")?"desc":"asc",e.shiftKey)):this.tableHeaderMenu&&this.tableHeaderMenu.isOpenFor(t)?this.closeHeaderMenu():this._isHeaderMenuEnabled(n)&&this.openHeaderMenu(n),!1}},{key:"_onHeaderItemMouseDown",value:function(e){if(!(e.button>0)){var t=0,n=this,i=Math.floor(e.pageX),r=s()(e.currentTarget),o=r.data("column"),a=this._visibleColumns().indexOf(o),u=a,l=r.outerWidth(),c=r.siblings(".table-header-item:not(.filler)");o.fixedPosition||(this.dragging=!1,this.columnMoved=!1,this._$window.on("mousemove.tableheader","",(function(e){if(!(-2<(t=Math.floor(e.pageX)-i)&&t<2)){n.dragging=!0,r.addClass("moving"),n.$container&&n.$container.addClass("moving"),r.css("left",t);var o=h(r);c.each((function(e){var t=h(s()(this));o<t&&e<a?s()(this).css("left",l):o>t&&e>=a?s()(this).css("left",-l):s()(this).css("left",0)})),n.tableHeaderMenu&&(n.tableHeaderMenu.destroy(),n.tableHeaderMenu=null),n.rendered&&n._uninstallHeaderItemTooltips()}})).one("mouseup","",(function(e){if(n._$window&&n._$window.off("mousemove.tableheader"),!n.dragging)return!0;(t<0?c:s()(c.get().reverse())).each((function(e){if("0px"!==s()(this).css("left"))return u=n._visibleColumns().indexOf(s()(this).data("column")),!1})),u>-1&&a!==u?(n.table.moveColumn(r.data("column"),a,u,!0),n.dragging=!1,n.columnMoved=!0):r.animateAVCSD("left","",(function(){n.dragging=!1})),c.each((function(){s()(this).css("left","")})),r.removeClass("moving"),n.$container&&n.$container.removeClass("moving"),n.rendered&&n._installHeaderItemTooltips()})))}function f(e){var t=e.html(),n=e.html("<span>"+t+"</span>").find("span:first").width();return e.html(t),n}function h(e){return e.hasClass("halign-right")?e.offset().left+e.outerWidth()-f(e)/2:e.offset().left+f(e)/2}}},{key:"_onSeparatorDblclick",value:function(e){if(!(e.button>0))if(e.shiftKey)this._visibleColumns().forEach((function(e){this.table.resizeToFit(e)}),this);else{var t=s()(e.target).prev().data("column");this.table.resizeToFit(t)}}},{key:"_onSeparatorMouseDown",value:function(e){if(!(e.button>0)){var t=Math.floor(e.pageX),n=s()(e.target).prev().data("column"),i=this,r=n.width,o=this.$container.appendDiv("table-column-resize-helper").css("width",this.table.rowWidth+this.table.rowBorderWidth),a=this.table.$data.appendDiv("table-column-resize-helper").css("width",this.table.rowWidth);this._$window.on("mousemove.tableheader",(function(e){var o=Math.floor(e.pageX)-t,s=r+o;s=Math.max(s,n.minWidth),i.rendered&&s!==n.width&&i.table.resizeColumn(n,s)})).one("mouseup",(function(e){o.remove(),a.remove(),i._$window&&i._$window.off("mousemove.tableheader"),i._$body&&i._$body.removeClass("col-resize"),i.table.rendered&&n.width!==r&&i.table.resizeColumn(n,n.width)})),this._$body.addClass("col-resize"),e.preventDefault()}}},{key:"_onTableDataScroll",value:function(){wf.fix(this.$menuBarContainer),this._reconcileScrollPos(),this._fixTimeout=wf.unfix(this.$menuBarContainer,this._fixTimeout)}},{key:"_onMenuBarPropertyChange",value:function(e){this.rendered&&"visible"===e.propertyName&&this.$menuBarContainer.setVisible(e.newValue)}},{key:"_onTableAddFilterRemoved",value:function(e){var t=e.filter.column;e.filter.filterType===rI.TYPE&&t.$header&&this._renderColumnState(t)}}])&&QR(t.prototype,n),i&&QR(t,i),o}(de);function ax(e){return(ax="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ux(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lx(e,t,n){return(lx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=px(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function cx(e,t){return(cx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=px(e);if(t){var r=px(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return hx(this,n)}}function hx(e,t){return!t||"object"!==ax(t)&&"function"!=typeof t?dx(e):t}function dx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function px(e){return(px=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cx(e,t)}(o,e);var t,n,i,r=fx(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).column=null,e.tableHeader=null,e.table=null,e.filter=null,e.filterCheckedMode=o.CheckedMode.ALL,e.filterSortMode=o.SortMode.ALPHABETICALLY,e.hasFilterTable=!1,e.hasFilterFields=!1,e.leftGroups=[],e.moveGroup=null,e.toBeginButton=null,e.forwardButton=null,e.backwardButton=null,e.toEndButton=null,e.sortingGroup=null,e.sortDescButton=null,e.sortAscAddButton=null,e.sortDescAddButton=null,e.columnActionsGroup=null,e.addColumnButton=null,e.removeColumnButton=null,e.modifyColumnButton=null,e.groupButton=null,e.groupAddButton=null,e.barChartButton=null,e.colorGradient1Button=null,e.colorGradient2Button=null,e.$rightGroups=[],e.$headerItem=null,e.$columnActions=null,e.$columnFilters=null,e.$filterTableGroup=null,e.$filterToggleChecked=null,e.$filterTableGroupTitle=null,e.$filterSortOrder=null,e.$filterFieldsGroup=null,e._onColumnMovedHandler=e._onColumnMoved.bind(dx(e)),e._tableHeaderScrollHandler=e._onAnchorScroll.bind(dx(e)),e.on("locationChange",e._onLocationChange.bind(dx(e))),e.inheritAccessibility=!1,e}return t=o,(n=[{key:"_init",value:function(e){e.scrollType=e.scrollType||"none",lx(px(o.prototype),"_init",this).call(this,e),this.tableHeader=e.tableHeader,this.column=e.column,this.table=this.tableHeader.table,this.$headerItem=this.$anchor,this.table.on("columnMoved",this._onColumnMovedHandler),this.filter=this.table.getFilter(this.column.id),this.filter||(this.filter=this.column.createFilter()),this.filter.calculate(),this.filter.on("filterFieldsChanged",this._updateFilterTable.bind(this)),this._updateFilterTableCheckedMode(),this.hasFilterTable=this.filter.availableValues.length>0,this.hasFilterFields=this.filter.hasFilterFields,this.hasFilterTable&&(this._tableFilterHandler=this._onFilterTableChanged.bind(this),this.table.on("filterAdded",this._tableFilterHandler),this.table.on("filterRemoved",this._tableFilterHandler),this._filterTableRowsCheckedHandler=this._onFilterTableRowsChecked.bind(this))}},{key:"_createLayout",value:function(){return new Ox(this)}},{key:"_render",value:function(){this.leftGroups=[],this.$rightGroups=[],this.$headerItem.select(!0),this.$container=this.$parent.appendDiv("table-header-menu"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.$body=this.$container.appendDiv("table-header-menu-body"),Uo.install(this.$body,this.session),this._installScrollbars({axis:"y"}),this.$columnActions=this.$body.appendDiv("table-header-menu-actions"),(this.hasFilterTable||this.hasFilterFields)&&(this.$columnFilters=this.$body.appendDiv("table-header-menu-filters"),Uo.install(this.$columnFilters,this.session).setLayout(new ka)),this.tableHeader.$container.on("scroll",this._tableHeaderScrollHandler),this.$whiter=this.$container.appendDiv("table-header-menu-whiter"),this.withFocusContext&&this.focusableContainer&&this.$container.attr("tabindex",-1),this.table.visibleColumns().filter((function(e){return!e.fixedPosition})).length>1&&!this.column.fixedPosition&&this.leftGroups.push(this._renderMovingGroup()),this.table.sortEnabled&&this.leftGroups.push(this._renderSortingGroup()),this._isColumnActionsGroupVisible()&&this.leftGroups.push(this._renderColumnActionsGroup()),(this.table.isGroupingPossible(this.column)||this.column.grouped)&&this.leftGroups.push(this._renderGroupingGroup()),this.leftGroups.push(this._renderHierarchyGruop()),this.table.isAggregationPossible(this.column)&&this.leftGroups.push(this._renderAggregationGroup()),this.column instanceof hF&&this.leftGroups.push(this._renderColoringGroup()),this.hasFilterTable&&this.$rightGroups.push(this._renderFilterTable()),this.hasFilterFields&&this.$rightGroups.push(this._renderFilterFields()),this._onColumnMoved(),this.table.enabled&&this.table.$container.addClass("focused")}},{key:"get$Scrollable",value:function(){return this.$body}},{key:"_updateFirstLast",value:function(){function e(e){e.forEach((function(e,n,i){t(e,"first",0===n),t(e,"last",n===i.length-1)}),this)}function t(e,t,n){(e instanceof Fx?e.$container:e).toggleClass(t,n)}e(this.leftGroups.filter((function(e){return e.isVisible()}))),e(this.$rightGroups)}},{key:"_remove",value:function(){this.filterTable&&this.filterTable.off("rowsChecked",this._filterTableRowsCheckedHandler),this.tableHeader.$container.off("scroll",this._tableHeaderScrollHandler),this.$headerItem.select(!1),this.table.off("columnMoved",this._onColumnMovedHandler),this.table.off("filterAdded",this._tableFilterHandler),this.table.off("filterRemoved",this._tableFilterHandler),lx(px(o.prototype),"_remove",this).call(this),this.table.rendered&&this.table.$container.removeClass("focused")}},{key:"_renderMovingGroup",value:function(){var e=this.table,t=this.column,n=e.visibleColumns().indexOf(t);return this.moveGroup=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Move",cssClass:"first"}),this.toBeginButton=O.create("TableHeaderMenuButton",{parent:this.moveGroup,text:"${textKey:ui.toBegin}",cssClass:"move move-top"}),this.toBeginButton.on("action",(function(){e.moveColumn(t,n,0),n=e.visibleColumns().indexOf(t)})),this.forwardButton=O.create("TableHeaderMenuButton",{parent:this.moveGroup,text:"${textKey:ui.forward}",cssClass:"move move-up"}),this.forwardButton.on("action",(function(){e.moveColumn(t,n,Math.max(n-1,0)),n=e.visibleColumns().indexOf(t)})),this.backwardButton=O.create("TableHeaderMenuButton",{parent:this.moveGroup,text:"${textKey:ui.backward}",cssClass:"move move-down"}),this.backwardButton.on("action",(function(){e.moveColumn(t,n,Math.min(n+1,e.header.findHeaderItems().length-1)),n=e.visibleColumns().indexOf(t)})),this.toEndButton=O.create("TableHeaderMenuButton",{parent:this.moveGroup,text:"${textKey:ui.toEnd}",cssClass:"move move-bottom"}),this.toEndButton.on("action",(function(){e.moveColumn(t,n,e.header.findHeaderItems().length-1),n=e.visibleColumns().indexOf(t)})),this.moveGroup.render(this.$columnActions),this.moveGroup}},{key:"_onColumnMoved",value:function(){var e=this.table,t=this.column;if(this.moveGroup){var n=e.visibleColumns(),i=e.visibleColumns().indexOf(t),r=n[i-1]&&!n[i-1].fixedPosition,o=n[i+1]&&!n[i+1].fixedPosition;this.toBeginButton.setEnabled(r),this.forwardButton.setEnabled(r),this.backwardButton.setEnabled(o),this.toEndButton.setEnabled(o)}this.hierarchyGroup.setVisible(this.table.isTableNodeColumn(t)),this._updateFirstLast()}},{key:"_isColumnActionsGroupVisible",value:function(){return this.table.columnAddable||this.column.removable||this.column.modifiable}},{key:"_renderColumnActionsGroup",value:function(){var e=this.column,t=this;return this.columnActionsGroup=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Column"}),this.addColumnButton=O.create("TableHeaderMenuButton",{parent:this.columnActionsGroup,text:"${textKey:ui.addColumn}",cssClass:"add-column",visible:this.table.columnAddable}),this.addColumnButton.on("action",n.bind(this,"add")),this.removeColumnButton=O.create("TableHeaderMenuButton",{parent:this.columnActionsGroup,text:"${textKey:ui.removeColumn}",cssClass:"remove-column",visible:this.column.removable}),this.removeColumnButton.on("action",n.bind(this,"remove")),this.modifyColumnButton=O.create("TableHeaderMenuButton",{parent:this.columnActionsGroup,text:"${textKey:ui.changeColumn}",cssClass:"change-column",visible:this.column.modifiable}),this.modifyColumnButton.on("action",n.bind(this,"modify")),this.columnActionsGroup.render(this.$columnActions),this.columnActionsGroup;function n(n){t.close(),this.table.trigger("columnOrganizeAction",{action:n,column:e})}}},{key:"onColumnActionsChanged",value:function(e){this.addColumnButton.setVisible(e.addVisible),this.removeColumnButton.setVisible(e.removeVisible),this.modifyColumnButton.setVisible(e.modifyVisible);var t=this.columnActionsGroup.children.some((function(e){return e.visible}));this.columnActionsGroup.setVisible(t)}},{key:"_renderSortingGroup",value:function(){var e=this.table,t=this.column,n=this;return this.sortingGroup=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ColumnSorting"}),e.hasPermanentHeadOrTailSortColumns()||(this.sortAscButton=O.create("TableHeaderMenuButton",{parent:this.sortingGroup,text:"${textKey:ui.ascending}",cssClass:"sort sort-asc",direction:"asc",toggleAction:!0}),this.sortAscButton.on("action",i.bind(this.sortAscButton)),this.sortDescButton=O.create("TableHeaderMenuButton",{parent:this.sortingGroup,text:"${textKey:ui.descending}",cssClass:"sort sort-desc",direction:"desc",toggleAction:!0}),this.sortDescButton.on("action",i.bind(this.sortDescButton))),this.sortAscAddButton=O.create("TableHeaderMenuButton",{parent:this.sortingGroup,text:"${textKey:ui.ascendingAdditionally}",cssClass:"sort sort-asc-add",direction:"asc",toggleAction:!0}),this.sortAscAddButton.on("action",r.bind(this.sortAscAddButton)),this.sortDescAddButton=O.create("TableHeaderMenuButton",{parent:this.sortingGroup,text:"${textKey:ui.descendingAdditionally}",cssClass:"sort sort-desc-add",direction:"desc",toggleAction:!0}),this.sortDescAddButton.on("action",r.bind(this.sortDescAddButton)),this._updateSortingSelectedState(),this.sortingGroup.render(this.$columnActions),this.sortingGroup;function i(){n.close(),o(this.direction,!1,!this.selected)}function r(){n.close(),o(this.direction,!0,!this.selected)}function o(i,r,o){e.sort(t,i,r,o),n._updateSortingSelectedState()}}},{key:"_updateSortingSelectedState",value:function(){if(this.table.sortEnabled){var e,t=!1,n=this._sortColumnCount();this.sortingGroup.children.forEach((function(e){e.setSelected(!1)})),1!==n||this.table.hasPermanentHeadOrTailSortColumns()?(n>1||this.table.hasPermanentHeadOrTailSortColumns())&&(t=!0,this.column.sortActive&&(this.column.sortAscending?this.sortAscAddButton.setSelected(!0):this.sortDescAddButton.setSelected(!0),e=this.column.sortIndex+1,this.sortAscAddButton.setIconId(e),this.sortDescAddButton.setIconId(e))):this.column.sortActive?this.column.sortAscending?this.sortAscButton.setSelected(!0):this.sortDescButton.setSelected(!0):t=!0,this.sortAscAddButton.setVisible(t),this.sortDescAddButton.setVisible(t)}}},{key:"_renderGroupingGroup",value:function(){var e=this,t=this.table,n=this.column,i=this._groupColumnCount(),r=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Grouping"});return this.groupButton=O.create("TableHeaderMenuButton",{parent:r,text:"${textKey:ui.groupingApply}",cssClass:"group",additional:!1,toggleAction:!0}),this.groupButton.on("action",o.bind(this.groupButton)),this.groupAddButton=O.create("TableHeaderMenuButton",{parent:r,text:"${textKey:ui.additionally}",cssClass:"group-add",additional:!0,toggleAction:!0}),this.groupAddButton.on("action",o.bind(this.groupAddButton)),0===i?this.groupAddButton.setVisible(!1):1===i&&this.column.grouped?(this.groupButton.setSelected(!0),this.groupAddButton.setVisible(!1)):i>1&&this.groupAddButton.setVisible(!0),t.hasPermanentHeadOrTailSortColumns()&&i>0&&(this.groupButton.setVisible(!1),this.groupAddButton.setVisible(!0)),this.column.grouped&&(1===i?this.groupAddButton.setSelected(!0):i>1&&(this.groupAddButton.setSelected(!0),this.groupAddButton.setIconId(this.column.sortIndex+1))),r.render(this.$columnActions),r;function o(){var i=n.sortIndex>=0&&!n.sortAscending?"desc":"asc";e.close(),t.groupColumn(n,this.additional,i,!this.selected)}}},{key:"_renderHierarchyGruop",value:function(){var e=this.table,t=this;return this.hierarchyGroup=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Hierarchy",visible:this.table.isTableNodeColumn(this.column)}),O.create("TableHeaderMenuButton",{parent:this.hierarchyGroup,text:"${textKey:ui.CollapseAll}",cssClass:"hierarchy-collapse-all",enabled:!!et.find(e.rows,(function(e){return e.expanded&&!et.empty(e.childRows)}))}).on("action",(function(){t.close(),e.collapseAll()})),O.create("TableHeaderMenuButton",{parent:this.hierarchyGroup,text:"${textKey:ui.ExpandAll}",cssClass:"hierarchy-expand-all",enabled:!!et.find(e.rows,(function(e){return!e.expanded&&!et.empty(e.childRows)}))}).on("action",(function(){t.close(),e.expandAll()})),this.hierarchyGroup.render(this.$columnActions),this.hierarchyGroup}},{key:"_renderAggregationGroup",value:function(){var e=this.table,t=this.column,n=t.aggregationFunction,i=this,r=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Aggregation"}),o=et.ensure(t.allowedAggregationFunctions),s=-1!==o.indexOf("none");return a("${textKey:ui.Sum}","sum"),a("${textKey:ui.Average}","avg"),a("${textKey:ui.Minimum}","min"),a("${textKey:ui.Maximum}","max"),r.children.forEach((function(e){e.setSelected(e.aggregation===n)})),r.render(this.$columnActions),r;function a(e,t){if(-1!==o.indexOf(t)){var n=O.create("TableHeaderMenuButton",{parent:r,text:e,cssClass:"aggregation-function "+t,aggregation:t,toggleAction:s});n.on("action",u.bind(n))}}function u(){i.close(),e.changeAggregation(t,this.aggregation===n?"none":this.aggregation)}}},{key:"_renderColoringGroup",value:function(){var e=this.table,t=this.column,n=this,i=t.backgroundEffect,r=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Coloring"});return this.colorGradient1Button=O.create("TableHeaderMenuButton",{parent:r,text:"${textKey:ui.fromRedToGreen}",cssClass:"color color-gradient1",backgroundEffect:"colorGradient1",toggleAction:!0}),this.colorGradient1Button.on("action",o.bind(this.colorGradient1Button)),this.colorGradient2Button=O.create("TableHeaderMenuButton",{parent:r,text:"${textKey:ui.fromGreenToRed}",cssClass:"color color-gradient2",backgroundEffect:"colorGradient2",toggleAction:!0}),this.colorGradient2Button.on("action",o.bind(this.colorGradient2Button)),Mt.get().supportsCssGradient()&&(this.barChartButton=O.create("TableHeaderMenuButton",{parent:r,text:"${textKey:ui.withBarChart}",cssClass:"color color-bar-chart",backgroundEffect:"barChart",toggleAction:!0}),this.barChartButton.on("action",o.bind(this.barChartButton))),r.children.forEach((function(e){e.setSelected(e.backgroundEffect===i)})),r.render(this.$columnActions),r;function o(){n.close(),e.setColumnBackgroundEffect(t,this.selected?this.backgroundEffect:null)}}},{key:"_renderFilterTable",value:function(){var e;this.$filterTableGroup=this.$columnFilters.appendDiv("table-header-menu-group first"),Uo.install(this.$filterTableGroup,this.session).setLayout(new ka),e=this.$filterTableGroup.appendDiv("table-header-menu-filter-actions"),this.$filterSortOrder=e.appendDiv("table-header-menu-toggle-sort-order").on("click",this._onSortModeClick.bind(this)).addClass(this.filterSortMode.cssClass),this.$filterToggleChecked=e.appendDiv("table-header-menu-filter-toggle-checked").text(this.session.text(this.filterCheckedMode.text)).on("click",this._onFilterCheckedModeClick.bind(this)),this.$filterTableGroupTitle=this.$filterTableGroup.appendDiv("table-header-menu-group-text").text(this._filterByText()),Uo.install(this.$filterTableGroupTitle,this.session),this.filterTable=this._createFilterTable(),this.filterTable.on("rowsChecked",this._filterTableRowsCheckedHandler);var t,n=[];return this.filter.availableValues.forEach((function(e){t={cells:[O.create("Cell",{text:"NumberColumn"===this.filter.column.objectType?e.text:null,value:"NumberColumn"===this.filter.column.objectType?e.key:e.text,iconId:e.iconId,htmlEnabled:e.htmlEnabled,cssClass:e.cssClass}),e.count,null===e.key?1:0],checked:this.filter.selectedValues.indexOf(e.key)>-1,dataMap:{filterValue:e}},n.push(t)}),this),this.filterTable.insertRows(n),this.filterTable.render(this.$filterTableGroup),setTimeout(this.filterTable.revealChecked.bind(this.filterTable)),this.$filterTableGroup}},{key:"_createFilterTable",value:function(){var e="Column";return"NumberColumn"===this.column.objectType&&(e=this.column.objectType),O.create("Table",{parent:this,headerVisible:!1,multiSelect:!1,autoResizeColumns:!0,checkable:!0,checkableStyle:ZP.CheckableStyle.TABLE_ROW,columns:[{objectType:e,text:"filter-value",width:160,sortActive:!0,sortIndex:1,horizontalAlignment:-1},{objectType:"NumberColumn",text:"aggregate-count",width:40},{objectType:"NumberColumn",displayable:!1,sortActive:!0,sortIndex:0}]})}},{key:"_filterByText",value:function(){var e=this.session.text("ui.Filter"),t=this.filter.selectedValues.length,n=this.filter.availableValues.length;return t&&n?e+=" "+this.session.text("ui.FilterInfoXOfY",t,n):n&&(e+=" "+this.session.text("ui.FilterInfoCount",n)),e}},{key:"_onFilterCheckedModeClick",value:function(){var e=o.CheckedMode,t=this.filterCheckedMode.checkAll;this.filter.selectedValues=[],this.filterCheckedMode===e.ALL?(this.filterCheckedMode=e.NONE,this.filter.availableValues.forEach((function(e){this.filter.selectedValues.push(e.key)}),this)):this.filterCheckedMode=e.ALL,this.filterTable.checkAll(t),this._updateFilterTableActions()}},{key:"_onSortModeClick",value:function(){var e=o.SortMode;this.filterSortMode===e.ALPHABETICALLY?(this.filterTable.sort(this.filterTable.columns[1],"desc"),this.filterSortMode=e.AMOUNT):(this.filterTable.sort(this.filterTable.columns[2],"asc"),this.filterTable.sort(this.filterTable.columns[0],"asc",!0),this.filterSortMode=e.ALPHABETICALLY),this._updateFilterTableActions()}},{key:"_updateFilterTable",value:function(){this.filter.filterActive()?this.table.addFilter(this.filter):this.table.removeFilterByKey(this.column.id),this.table.filter()}},{key:"_updateFilterTableActions",value:function(){this.$filterToggleChecked.text(this.session.text(this.filterCheckedMode.text));var e=o.SortMode,t=this.filterSortMode===o.SortMode.ALPHABETICALLY;this.$filterSortOrder.toggleClass(e.ALPHABETICALLY.cssClass,t),this.$filterSortOrder.toggleClass(e.AMOUNT.cssClass,!t)}},{key:"_renderFilterFields",value:function(){this.filterFieldsGroupBox=O.create("GroupBox:FilterFields",{parent:this,column:this.column,filter:this.filter}),this.$filterFieldsGroup=this.$columnFilters.appendDiv("table-header-menu-group");var e=Uo.install(this.$filterFieldsGroup,this.session);e.setLayout(new ka);var t=this.$filterFieldsGroup.appendDiv("table-header-menu-group-text").text(this.filter.filterFieldsTitle());return e=Uo.install(t,this.session),this.filterFieldsGroupBox.render(this.$filterFieldsGroup),this.$filterFieldsGroup}},{key:"isOpenFor",value:function(e){return this.rendered&&this.belongsTo(e)}},{key:"_countColumns",value:function(e){return this.table.visibleColumns().reduce((function(t,n){return t+(n[e]?1:0)}),0)}},{key:"_sortColumnCount",value:function(){return this._countColumns("sortActive")}},{key:"_groupColumnCount",value:function(){return this._countColumns("grouped")}},{key:"_computeWhitherWidth",value:function(){var e=this.tableHeader.$container,t=this.$headerItem.outerWidth()-this.$headerItem.cssBorderWidthX(),n=this.$container.outerWidth()-this.$container.cssBorderWidthX(),i=e.outerWidth()-this.tableHeader.menuBar.$container.outerWidth(),r=Math.min(t,n);r=Math.min(r,i-this.$headerItem.position().left);var o=e.offset().left-this.$headerItem.offset().left-this.tableHeader.table.$container.cssBorderLeftWidth();return o>0&&(r-=o),r}},{key:"_renderCompact",value:function(){this.$body.toggleClass("compact",this.compact),this.invalidateLayoutTree()}},{key:"setCompact",value:function(e){this.setProperty("compact",e)}},{key:"_onLocationChange",value:function(e){var t,n,i=wf.isLocationInView,r=No.offsetBounds(this.$headerItem),o=this.tableHeader.$container;this.$container.setVisible(!0),n=No.offsetBounds(this.$container),(t=i(new Eo(r.x,r.y),o))||(t=(t=i(new Eo(r.x+r.width,r.y+r.height),o))&&i(new Eo(n.x+n.width,n.y),o)),this.$container.setVisible(t),n=No.offsetBounds(this.$container),this.$whiter.cssLeft(Math.max(r.x-n.x,o.offset().left-n.x-this.tableHeader.table.$container.cssBorderLeftWidth())).width(this._computeWhitherWidth())}},{key:"_onAnchorScroll",value:function(e){this.position()}},{key:"_onFilterTableRowsChecked",value:function(e){this.filter.selectedValues=[],this.filterTable.rows.forEach((function(e){e.checked&&this.filter.selectedValues.push(e.dataMap.filterValue.key)}),this),this._updateFilterTable()}},{key:"_onFilterTableChanged",value:function(){this.$filterTableGroupTitle.text(this._filterByText()),this._updateFilterTableCheckedMode(),this._updateFilterTableActions()}},{key:"_updateFilterTableCheckedMode",value:function(){0===this.filter.selectedValues.length?this.filterCheckedMode=o.CheckedMode.ALL:this.filterCheckedMode=o.CheckedMode.NONE}},{key:"_onMouseDownOutside",value:function(e){this.$headerItem.isOrHas(e.target)||this.close()}},{key:"onColumnResized",value:function(){this.$whiter.width(this._computeWhitherWidth())}}])&&ux(t.prototype,n),i&&ux(t,i),o}(kd);function bx(e){return(bx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mx(e,t,n){return(mx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sx(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _x(e,t){return(_x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Sx(e);if(t){var r=Sx(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return kx(this,n)}}function kx(e,t){return!t||"object"!==bx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sx(e){return(Sx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}yx(vx,"CheckedMode",{ALL:{checkAll:!0,text:"ui.SelectAllFilter"},NONE:{checkAll:!1,text:"ui.SelectNoneFilter"}}),yx(vx,"SortMode",{ALPHABETICALLY:{text:"ui.SortAlphabeticallyFilter",cssClass:"table-header-menu-toggle-sort-order-alphabetically"},AMOUNT:{text:"ui.SortByAmountFilter",cssClass:"table-header-menu-toggle-sort-order-amount"}});var Ox=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_x(e,t)}(o,e);var t,n,i,r=wx(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).popup=e,t.doubleCalcPrefSize=!1,t}return t=o,(n=[{key:"layout",value:function(e){if(mx(Sx(o.prototype),"layout",this).call(this,e),this.popup.hasFilterFields||this.popup.hasFilterTable){var t,n,i=this.popup.$columnFilters,r=No.insets(i),s=No.margins(i),a=new Co;if((n=this.popup.$body.hasClass("compact")?Uo.get(i).prefSize():(n=this.preferredLayoutSize(e).subtract(No.insets(e))).subtract(s)).width=i.cssWidth(),i.cssHeight(n.height),this.popup.hasFilterFields){var u=this.popup.$filterFieldsGroup;Uo.get(u.find(".form-field")).setSize(new Co(n.width-r.horizontal(),this._filterFieldsGroupBoxHeight())),a=No.size(u,!0)}if(this.popup.hasFilterTable){var l,c=this.popup.$filterTableGroup,f=No.insets(c),h=this.popup.filterTable.htmlComp;l=n.height-r.vertical(),l-=a.height,l-=this._groupTitleHeight(c),l-=f.vertical(),l=Math.min(l,o.TABLE_MAX_HEIGHT),h.setSize(new Co(n.width-r.horizontal(),l))}this._setMaxWidth(),t=No.size(this.popup.$columnActions),this._setMaxWidth(t.width),this.popup.$columnActions.css("vertical-align",t.height>=n.height?"middle":"top"),i.css("vertical-align","middle")}}},{key:"_adjustSizeWithAnchor",value:function(e){var t,n=this.popup.htmlComp,i=this.popup.windowPaddingX,r=n.margins(),s=n.offsetBounds();t=this.popup.$container.window().width()-r.horizontal()-s.x-i;var a=s.width>t;return a&&(this.popup.$body.addClass("compact",a),e=this.preferredLayoutSize(this.popup.$container)),mx(Sx(o.prototype),"_adjustSizeWithAnchor",this).call(this,e)}},{key:"_groupTitleHeight",value:function(e){return No.size(e.find(".table-header-menu-group-text"),!0).height}},{key:"_filterFieldsGroupBoxHeight",value:function(){return this.popup.filterFieldsGroupBox.htmlComp.prefSize().height}},{key:"preferredLayoutSize",value:function(e,t){var n,i,r,s,a=0,u=No.insets(e),l=this._getMaxWidth();if(this._setMaxWidth(),s=No.size(this.popup.$columnActions,!0).height,this.popup.hasFilterTable){var c,f=this.popup.$filterTableGroup,h=this.popup.filterTable.htmlComp.size(!0).height,d=No.insets(f);c=h=Math.min(h,o.TABLE_MAX_HEIGHT),c+=this._groupTitleHeight(f),a+=c+=d.vertical()}if(this.popup.hasFilterFields){var p,y=this.popup.$filterFieldsGroup,v=No.insets(y);p=this._filterFieldsGroupBoxHeight(),p+=this._groupTitleHeight(y),a+=p+=v.vertical()}return(this.popup.hasFilterFields||this.popup.hasFilterTable)&&(i=No.margins(this.popup.$columnFilters),r=No.insets(this.popup.$columnFilters),a+=i.vertical(),a+=r.vertical()),n=No.prefSize(e),this.popup.$body.hasClass("compact")?n.height=s+a+u.vertical():n.height=Math.max(s,a)+u.vertical(),this._setMaxWidth(l),n}},{key:"_getMaxWidth",value:function(){return this.popup.$columnActions.css("max-width")}},{key:"_setMaxWidth",value:function(e){this.popup.$columnActions.css("max-width",e||"")}}])&&gx(t.prototype,n),i&&gx(t,i),o}(Id);function Tx(e){return(Tx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Px(e,t,n){return(Px="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dx(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Rx(e,t){return(Rx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Dx(e);if(t){var r=Dx(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ex(this,n)}}function Ex(e,t){return!t||"object"!==Tx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dx(e){return(Dx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Ox,"TABLE_MAX_HEIGHT",330);var Fx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rx(e,t)}(o,e);var t,n,i,r=xx(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).text=null,e.textKey=null,e.visible=!0,e.last=!1,e}return t=o,(n=[{key:"_init",value:function(e){Px(Dx(o.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text(this.textKey))}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("table-header-menu-group buttons"),this.$text=this.$container.appendDiv("table-header-menu-group-text"),this.cssClass&&this.$container.addClass(this.cssClass),this._renderText(),this.children.forEach((function(e){e.render()}),this),ye.updateFirstLastMarker(this.children)}},{key:"appendText",value:function(e){this.text=this.session.text(this.textKey)+" "+e,this.rendered&&this._renderText()}},{key:"resetText",value:function(){this.text=this.session.text(this.textKey),this.rendered&&this._renderText()}},{key:"_renderText",value:function(){this.$text.text(this.text)}},{key:"setLast",value:function(e){this.setProperty("last",e)}},{key:"_renderLast",value:function(){this.$container.toggleClass("last",this.last)}}])&&Cx(t.prototype,n),i&&Cx(t,i),o}(de);function Ax(e){return(Ax="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $x(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jx(e,t,n){return(jx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bx(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Mx(e,t){return(Mx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ix(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Bx(e);if(t){var r=Bx(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Lx(this,n)}}function Lx(e,t){return!t||"object"!==Ax(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bx(e){return(Bx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mx(e,t)}(o,e);var t,n,i,r=Ix(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).textVisible=!1,e.tabbable=!0,e}return t=o,(n=[{key:"_initKeyStrokeContext",value:function(){jx(Bx(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new Kx(this)])}},{key:"_render",value:function(){jx(Bx(o.prototype),"_render",this).call(this),this.$container=this.$container.addClass("table-header-menu-command").unfocusable().on("mouseenter",this._onMouseOver.bind(this)).on("mouseleave",this._onMouseOut.bind(this)),this.$icon=this.$container.appendSpan("icon")}},{key:"_renderProperties",value:function(){jx(Bx(o.prototype),"_renderProperties",this).call(this),this._renderToggleAction()}},{key:"_onMouseOver",value:function(){var e=this.selected?this.session.text("ui.remove"):this.text;this.parent.appendText(e)}},{key:"_onMouseOut",value:function(){this.parent.resetText()}},{key:"_renderToggleAction",value:function(){this.$container.toggleClass("togglable",this.toggleAction)}},{key:"_renderIconId",value:function(){this.iconId?this.$icon.attr("data-icon",this.iconId):this.$icon.removeAttr("data-icon")}}])&&$x(t.prototype,n),i&&$x(t,i),o}(Eh);function Hx(e){return(Hx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wx(e,t){return(Wx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ux(e);if(t){var r=Ux(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gx(this,n)}}function Gx(e,t){return!t||"object"!==Hx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ux(e){return(Ux=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wx(e,t)}(o,e);var t,n,i,r=zx(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ENTER,pu.SPACE],t.renderingHints.render=!0,t.stopPropagation=!0,t}return t=o,(n=[{key:"handle",value:function(e){this.field.doAction()}}])&&Vx(t.prototype,n),i&&Vx(t,i),o}($u);function qx(e){return(qx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xx(e,t,n){return(Xx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eE(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Jx(e,t){return(Jx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=eE(e);if(t){var r=eE(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Qx(this,n)}}function Qx(e,t){return!t||"object"!==qx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eE(e){return(eE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jx(e,t)}(o,e);var t,n,i,r=Zx(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).table=e,t._dataHeightPositive=!1,t}return t=o,(n=[{key:"layout",value:function(e){var t,n=0,i=0,r=0,o=0,s=0,a=this.table.tableTileGridMediator?this.table.tableTileGridMediator.tileAccordion:null,u=this.table.$data,l=No.margins(O.nvl(u,this.table.$container)),c=l.top+l.bottom,f=this.table.menuBar,h=this.table.footer,d=this.table.header,p=this.table.tileTableHeader,y=this.table.visibleColumns(),v=y[y.length-1],b=this.table.htmlComp,g=b.availableSize({exact:!0}).subtract(b.insets());if(this.table.menuBarVisible&&f.visible){var m=Uo.get(f.$container),_=D_.size(m,g);m.setSize(_),n=_.height}if(d&&(r=No.size(d.$container).height,d.menuBar&&d.menuBar.validateLayout()),h&&(i=No.size(h.$container).height,s=h.computeControlContainerHeight(this.table,h.selectedControl,!this._dataHeightPositive),t=No.insets(h.$controlContainer),h.animating||(h.$controlContainer.cssHeight(s),h.$controlContent.outerHeight(s-t.vertical()),h.revalidateLayout())),p&&p.visible){var w=p.htmlComp.prefSize({widthHint:g.width});w.width=g.width,w=w.subtract(p.htmlComp.margins()),p.htmlComp.setSize(w),o=w.height}var k=c+n+s+i+r+o,S=g.height-k;u?(u.css("height","calc(100% - "+k+"px)"),this._dataHeightPositive=u.height()>0):a&&a.htmlComp&&(a.htmlComp.setSize(new Co(g.width,S)),wf.update(a.$container),this._dataHeightPositive=S>0),this.table.tileMode||(this._layoutColumns(),d&&d.resizeHeaderItem(v),this.table.setViewRangeSize(this.table.calculateViewRangeSize()),b.layouted||this.table._renderScrollTop(),this.table._renderViewport(),this.table.tooltips.forEach((function(e){e.rendered&&e.position()})),this.table.cellEditorPopup&&this.table.cellEditorPopup.rendered&&(this.table.cellEditorPopup.position(),this.table.cellEditorPopup.pack()),this.table.updateScrollbars())}},{key:"_layoutColumns",value:function(e){this._autoOptimizeColumnsWidths();var t=this.table.htmlComp,n=this.table.columnLayoutDirty||!t.sizeCached;if(!n){var i=e||t.size().width;n=t.sizeCached.width!==i}n&&(this.table.autoResizeColumns&&this._autoResizeColumns(e),this._updateRealColumnWidths(),this.table.columnLayoutDirty=!1)}},{key:"_updateRealColumnWidths",value:function(){this.table._updateRealColumnWidths()&&(this.table._updateRowWidth(),this.table.header&&this.table.header.rendered&&this.table.header.resizeHeaderItems(),this.table.$rows(!0).css("width",this.table.rowWidth))}},{key:"_autoOptimizeColumnsWidths",value:function(){this.table.visibleColumns().forEach((function(e){e.autoOptimizeWidth&&e.autoOptimizeWidthRequired&&this.table.resizeToFit(e,e.autoOptimizeMaxWidth)}),this)}},{key:"_autoResizeColumns",value:function(e){var t,n,i=[],r=0,o=0,s=e||this.table.$data.width(),a=Math.floor(s-this.table.rowBorderWidth);if(this.table.visibleColumns().forEach((function(e){e.fixedWidth||e.autoOptimizeWidth?a-=e.width:(i.push(e),r+=e.width,o+=e.initialWidth)})),a!==r){var u=a,l=i.filter((function(e){var r=Math.max(e.minWidth,e.initialWidth);return n=0===o?1/i.length:e.initialWidth/o,(t=Math.floor(n*u))<r&&(t=r,u=Math.max(u-t,0),!0)}));l.forEach(function(e,n){var r=Math.max(e.minWidth,e.initialWidth);et.remove(i,e),t=r,o-=e.initialWidth,n===l.length-1&&u>0&&0===i.length&&(t+=u,u=0),t!==e.width&&this.table.resizeColumn(e,t)}.bind(this)),a=u,i.forEach(function(e,r){n=0===o?1/i.length:e.initialWidth/o,t=Math.floor(n*a),u-=t,r===i.length-1&&u>0&&(t+=u,u=0),t!==e.width&&this.table.resizeColumn(e,t)}.bind(this))}}},{key:"preferredLayoutSize",value:function(e,t){return this.table.tileMode?(new ka).preferredLayoutSize(e,t):(this._layoutColumns(t.widthHint),this.table._renderViewport(),Xx(eE(o.prototype),"preferredLayoutSize",this).call(this,e,t))}}])&&Yx(t.prototype,n),i&&Yx(t,i),o}(zo);function nE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var iE=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.table=t,this.mouseMoveSelectionEnabled=!0,this._mouseDown=!1,this.lastActionRow=null,this._allRows=null,this.mouseOverHandler=null,this.select=!0,this.counterDebug=0,this.fromIndex=-1,this.toIndex=-1,this._prevSelectedRowIndex=-1,this._maxSelectedRowIndex=-1}var t,n,i;return t=e,(n=[{key:"clearLastSelectedRowMarker",value:function(){this.lastActionRow=null}},{key:"onMouseDown",value:function(e){var t=s()(e.currentTarget),n=t.data("row"),i=t.isSelected();if(this._mouseDown=!0,this._allRows=this.table.visibleRows,this.select=!0,this.table.multiSelect&&e.shiftKey){if(this.table.selectedRows.indexOf(n)>-1)return;if(0===this.table.selectedRows.length&&(this.lastActionRow=n),!this.lastActionRow){var r=this._allRows.indexOf(n),o=this.table.selectedRows[0],a=this.table.selectedRows[this.table.selectedRows.length-1];r<=(this._allRows.indexOf(o)+this._allRows.indexOf(a))/2?this.lastActionRow=o:this.lastActionRow=a,this._maxSelectedRowIndex=this._allRows.indexOf(a),this._prevSelectedRowIndex=this._allRows.indexOf(this.lastActionRow)}this.fromIndex=this._allRows.indexOf(this.lastActionRow)}else e.ctrlKey?this.select=!i:(!i||this.table.selectedRows.length>1&&3!==e.which)&&(this.table._removeSelection(),this.table.selectedRows=[]);this.fromIndex<0&&(this.fromIndex=this._allRows.indexOf(n)),3===e.which&&i||(this.toIndex=this._allRows.indexOf(n),this.handleSelection(e),this.table.notifyRowSelectionFinished()),this.mouseMoveSelectionEnabled&&3!==e.which&&(this.table.$data.off("mouseover",this.mouseOverHandler),this.mouseOverHandler=this.onMouseOver.bind(this),this.table.$data.on("mouseover",".table-row",this.mouseOverHandler)),t.window().one("mouseup.selectionHandler",this.onMouseUp.bind(this)),this.lastActionRow=n}},{key:"onMouseOver",value:function(e){var t=s()(e.currentTarget).data("row");this.toIndex=this._allRows.indexOf(t),this.handleSelection(e),this.lastActionRow=t}},{key:"handleSelection",value:function(e){var t;if(this.table.multiSelect){var n=this.toIndex,i=n<this._prevSelectedRowIndex,r=n>this._prevSelectedRowIndex,o=this._prevSelectedRowIndex<this.fromIndex,s=this._prevSelectedRowIndex>this.fromIndex;if(!e.ctrlKey){if(i&&s?t=this._allRows.slice(n+1,this._maxSelectedRowIndex+1):r&&o&&(t=this._allRows.slice(this._maxSelectedRowIndex,n)),t&&e.shiftKey){var a=this.getMinMaxSelectionIndizes();t=t.reduce(function(e,t){var n=this._allRows.indexOf(t);return O.isOneOf(n,a[0],a[1])&&e.push(t),e}.bind(this),[])}t&&t.forEach((function(e){this.table.removeRowFromSelection(e,!0)}),this)}this._maxSelectedRowIndex=i?Math.min(this._maxSelectedRowIndex,n):r?Math.max(this._maxSelectedRowIndex,n):n,this._prevSelectedRowIndex=n}else this.select&&(this.table._removeSelection(),this.table.selectedRows=[]),this.fromIndex=this.toIndex;this._selectRange(this.fromIndex,this.toIndex,this.select)}},{key:"_selectRange",value:function(e,t,n){var i=Math.min(e,t),r=Math.max(e,t)+1,o=this._allRows.slice(i,r);n?o.forEach((function(e){this.table.addRowToSelection(e,!0)}),this):o.forEach((function(e){this.table.removeRowFromSelection(e,!0)}),this)}},{key:"getMinMaxSelectionIndizes",value:function(){var e=this.table.selectedRows,t=this.table.visibleRows;if(!e||0===e.length)return[-1,-1];var n=-1,i=-1;return e.forEach((function(e){var r=t.indexOf(e);(-1===n||r<n)&&(n=r),(-1===i||r>i)&&(i=r)})),[n,i]}},{key:"onMouseUp",value:function(e){this._mouseDown&&this.table.rendered&&(this._mouseDown=!1,this.table.$data.off("mouseover",this.mouseOverHandler),this._allRows=null,this.fromIndex=-1,this.toIndex=-1,this.select=!0,this.table.notifyRowSelectionFinished())}}])&&nE(t.prototype,n),i&&nE(t,i),e}();function rE(e){return(rE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sE(e,t,n){return(sE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fE(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function aE(e,t){return(aE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=fE(e);if(t){var r=fE(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return lE(this,n)}}function lE(e,t){return!t||"object"!==rE(t)&&"function"!=typeof t?cE(e):t}function cE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fE(e){return(fE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aE(e,t)}(o,e);var t,n,i,r=uE(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).table=null,e.tileAccordion=null,e._tileGridListener=null,e._tableListener=null,e._destroyHandler=null,e.tiles=[],e.tileMappings=[],e.tilesMap={},e.tileFilterMap={},e.groups={},e.groupForTileMap={},e.tableState={},e._tileAccordionPropertyChangeHandler=e._onTileAccordionPropertyChange.bind(cE(e)),e._tileAccordionActionHandler=e._onTileAccordionAction.bind(cE(e)),e._tileAccordionClickHandler=e._onTileAccordionClick.bind(cE(e)),e._tableFilterAddedHandler=e._onTableFilterAdded.bind(cE(e)),e._tableFilterRemovedHandler=e._onTableFilterRemoved.bind(cE(e)),e._tableFilterHandler=e._onTableFilter.bind(cE(e)),e._tableGroupHandler=e._onTableGroup.bind(cE(e)),e._tableRowsSelectedHandler=e._onTableRowsSelected.bind(cE(e)),e._tableRowsInsertedHandler=e._onTableRowsInserted.bind(cE(e)),e._tableRowsDeletedHandler=e._onTableRowsDeleted.bind(cE(e)),e._tableAllRowsDeletedHandler=e._onTableAllRowsDeleted.bind(cE(e)),e._tableRowOrderChangedHandler=e._onTableRowOrderChangedHandler.bind(cE(e)),e._destroyHandler=e._uninstallListeners.bind(cE(e)),e.exclusiveExpand=!1,e.gridColumnCount=null,e.tileGridLayoutConfig=null,e.withPlaceholders=null,e._addWidgetProperties(["tileAccordion","tiles","tileMappings"]),e}return t=o,(n=[{key:"init",value:function(e){sE(fE(o.prototype),"_init",this).call(this,e),this.table=this.parent,this.tileAccordion||(this.tileAccordion=this._createTileAccordion(),this._installListeners()),this.tableState.headerVisible=this.table.headerVisible,this._setTiles(this.tiles),this._setTileMappings(this.tileMappings)}},{key:"_installListeners",value:function(){this.tileAccordion.on("propertyChange",this._tileAccordionPropertyChangeHandler),this.tileAccordion.on("tileAction",this._tileAccordionActionHandler),this.tileAccordion.on("tileClick",this._tileAccordionClickHandler),this.table.on("filterAdded",this._tableFilterAddedHandler),this.table.on("filterRemoved",this._tableFilterRemovedHandler),this.table.on("filter",this._tableFilterHandler),this.table.on("group",this._tableGroupHandler),this.table.on("rowsSelected",this._tableRowsSelectedHandler),this.table.on("rowsInserted",this._tableRowsInsertedHandler),this.table.on("rowsDeleted",this._tableRowsDeletedHandler),this.table.on("allRowsDeleted",this._tableAllRowsDeletedHandler),this.table.on("rowOrderChanged",this._tableRowOrderChangedHandler),this.tileAccordion.on("destroy",this._destroyHandler),this.table.on("destroy",this._destroyHandler)}},{key:"_uninstallListeners",value:function(){this.tileAccordion.off("propertyChange",this._tileAccordionPropertyChangeHandler),this.tileAccordion.off("tileAction",this._tileAccordionActionHandler),this.tileAccordion.off("tileClick",this._tileAccordionClickHandler),this.table.off("filterAdded",this._tableFilterAddedHandler),this.table.off("filterRemoved",this._tableFilterRemovedHandler),this.table.off("filter",this._tableFilterHandler),this.table.off("group",this._tableGroupHandler),this.table.off("rowsSelected",this._tableRowsSelectedHandler),this.table.off("rowsInserted",this._tableRowsInsertedHandler),this.table.off("rowsDeleted",this._tableRowsDeletedHandler),this.table.off("allRowsDeleted",this._tableAllRowsDeletedHandler),this.table.off("rowOrderChanged",this._tableRowOrderChangedHandler),this.tileAccordion.off("destroy",this._destroyHandler),this.table.off("destroy",this._destroyHandler)}},{key:"setGridColumnCount",value:function(e){this.setProperty("gridColumnCount",e),this.tileAccordion&&this.tileAccordion.setGridColumnCount(e)}},{key:"setTileGridLayoutConfig",value:function(e){this.setProperty("tileGridLayoutConfig",e),this.tileAccordion&&this.tileAccordion.setTileGridLayoutConfig(e)}},{key:"setWithPlaceholders",value:function(e){this.setProperty("withPlaceholders",e),this.tileAccordion&&this.tileAccordion.setWithPlaceholders(e)}},{key:"_setTileMappings",value:function(e){if(this._setProperty("tileMappings",e),e){var t=e.map(this.resolveMapping,this);this._setTiles(t)}}},{key:"setTiles",value:function(e){this.setProperty("tiles",e)}},{key:"_setTiles",value:function(e){this._isUpdatingTiles=!0,et.removeAll(this.tiles,e),this.reset(),this._setTilesInternal(e),this._isUpdatingTiles=!1}},{key:"_setTilesInternal",value:function(e){e.some((function(e){return void 0===this.table.rowsMap[e.rowId]}),this)?this.table.initialized?this.table.one("rowsInserted",this._setTilesInternal.bind(this,e)):this.table.one("init",this._setTilesInternal.bind(this,e)):(this._refreshTilesMap(e),this._initGroups(e),this._setProperty("tiles",e),this.tileAccordion.setTiles(this.tiles),this._updateGroupVisibility(),this._syncSelectionFromTableToTile())}},{key:"loadTiles",value:function(){var e=this.table.rows.filter((function(e){return!e.parentRow})),t=this.table.createTiles(e);t&&this.setTiles(t)}},{key:"resolveMapping",value:function(e){var t=e.tile;return t.rowId=e.tableRow,t.setParent(this),t.setOwner(this),t}},{key:"_refreshTilesMap",value:function(e){e||(e=this.tiles,this.tilesMap={}),e.forEach((function(e){this.tilesMap[e.rowId]=e}),this)}},{key:"getTilesForRows",value:function(e){return e.map((function(e){return this.tilesMap[e.id]}),this).filter((function(e){return!!e}))}},{key:"_initGroups",value:function(e){var t=et.find(this.table.columns,(function(e){return e.grouped&&0===e.sortIndex}));e.forEach((function(e){var n=this.table.rowsMap[e.rowId],i=t?t.cellTextForGrouping(n):"default";i=O.nvl(i,""),this.groupForTileMap[n.id]=i;var r=this.tileAccordion.getGroupById(i);r||(r=this._createTileGroup(i,t,n),this._adaptTileGrid(r.body),this.tileAccordion.insertGroup(r)),e.parent=r}),this)}},{key:"_adaptTileGrid",value:function(e){oi.mandatoryFunction(e,"_showContextMenu");var t=e._showContextMenu;e._showContextMenu=function(n){oi.mandatoryFunction(this.table,"_filterMenusForContextMenu"),n.menuItems=this.table._filterMenusForContextMenu(),O.assertProperty(this.table,"_filterMenusHandler"),n.menuFilter=this.table._filterMenusHandler,t.call(e,n)}.bind(this),e.keyStrokeContext.$bindTarget=this.table.keyStrokeContext.$bindTarget}},{key:"_createTileAccordion",value:function(){return O.create("TileAccordion",{parent:this.table,virtual:!0,selectable:!0,multiselect:this.table.multiSelect,exclusiveExpand:this.exclusiveExpand,gridColumnCount:this.gridColumnCount,tileGridLayoutConfig:this.tileGridLayoutConfig,withPlaceholders:this.withPlaceholders})}},{key:"_createTileGroup",value:function(e,t,n){var i,r,o;if(t){i=t.htmlEnabled;var s=t.createAggrGroupCell(n);r=s.text,o=s.iconId}return O.create("Group",{parent:this.tileAccordion,id:e,headerVisible:"default"!==e,title:r,titleHtmlEnabled:i,iconId:o,body:{objectType:"TileGrid",scrollable:!1}})}},{key:"activate",value:function(){this.tableState.headerVisible=this.table.headerVisible,this.table.setHeaderVisible(!1),this.table.tileTableHeader&&this.table.tileTableHeader.setVisible(!0),this.table.tableControls.forEach((function(e){e instanceof aA&&(this.tableState.aggregateTableControlSelected=e.selected,e.setSelected(!1,{closeWhenUnselected:!0,animate:!1}),e.setVisible(!1))}),this),this.tableState.loadingSupportContainer=this.table.loadingSupport.options$Container,this.table.loadingSupport.options$Container=function(){return this.tileAccordion.$container}.bind(this),null!==et.find(this.table.rows,(function(e){return e.parentRow}))&&(this.table.addFilter(O.create("TileTableHierarchyFilter",{table:this.table})),this.table.filter()),this._syncFiltersFromTableToTile(),this._syncScrollTopFromTableToTile()}},{key:"deactivate",value:function(){this.table.tableControls.forEach((function(e){e instanceof aA&&e.setVisible(!0)}),this),this.table._setProperty("headerVisible",this.tableState.headerVisible),this.table.tileTableHeader&&this.table.tileTableHeader.setVisible(!1),this.tableState.loadingSupportContainer&&(this.table.loadingSupport.options$Container=this.tableState.loadingSupportContainer),this.table.removeFilter(O.create("TileTableHierarchyFilter")),this.table.filter(),this._syncScrollTopFromTileGridToTable(),this.reset()}},{key:"reset",value:function(){this.tilesMap={},this.groups={},this.groupForTileMap={},this.tileAccordion.deleteAllTiles(),this.tileAccordion.deleteAllGroups(),this.tiles.forEach((function(e){e.destroy()}))}},{key:"renderTileMode",value:function(){this.table.tileMode?(this.table.$data&&this.table._removeData(),this._renderTileTableHeader(),this._renderTileAccordion()):(this._removeTileTableHeader(),this._removeTileAccordion(),this.table._renderData(),this.table._renderTableHeader(),this.tableState.aggregateTableControlSelected&&et.find(this.table.tableControls,(function(e){return e instanceof aA})).setSelected(!0)),this.table._refreshMenuBarPosition()}},{key:"destroy",value:function(){this.tiles.forEach((function(e){e.destroy()})),this.tileAccordion.destroy(),this.tileAccordion=null}},{key:"insertTiles",value:function(e){0!==(e=et.ensure(e)).length&&this.setTiles(this.tiles.concat(e))}},{key:"deleteTiles",value:function(e){e||(e=this.tiles.slice()),et.removeAll(this.tiles,e),e.forEach((function(e){delete this.tilesMap[e.rowId],delete this.groupForTileMap[e.rowId];var t=this.tileAccordion.getGroupByTile(e);t&&1===t.body.tiles.length&&this.tileAccordion.deleteGroup(t),e.destroy()}),this),this.tileAccordion.deleteTiles(e)}},{key:"_onTileAccordionPropertyChange",value:function(e){this.table.tileMode&&("selectedTiles"===e.propertyName&&(this._syncSelectionFromTileGridToTable(e.source.getSelectedTiles()),this.tileAccordion.rendered&&this.tileAccordion.$container.document(!0).getSelection().removeAllRanges()),"filteredTiles"===e.propertyName&&this._updateGroupVisibility())}},{key:"_onTileAccordionAction",value:function(e){this.table.tileMode&&this.table.doRowAction(this.table.rowsMap[e.tile.rowId])}},{key:"_onTileAccordionClick",value:function(e){this.table.tileMode&&this.table._triggerRowClick(this.table.rowsMap[e.tile.rowId],e.mouseButton)}},{key:"_onTableRowsSelected",value:function(e){this.table.tileMode&&this._syncSelectionFromTableToTile()}},{key:"_onTableRowsInserted",value:function(e){this.table.tileMode&&this.insertTiles(this.table.createTiles(e.rows))}},{key:"_onTableRowsDeleted",value:function(e){this.table.tileMode&&this.deleteTiles(this.getTilesForRows(e.rows))}},{key:"_onTableAllRowsDeleted",value:function(e){this.table.tileMode&&this.deleteTiles()}},{key:"_onTableRowOrderChangedHandler",value:function(e){this.table.tileMode&&!s.a.isEmptyObject(this.tilesMap)&&(this.tiles=this.table.rows.map((function(e){return this.tilesMap[e.id]}),this),this.tileAccordion.setTiles(this.tiles))}},{key:"_onTableGroup",value:function(e){this.table.tileMode&&(this.tileAccordion.deleteAllGroups(),this._initGroups(this.tiles),this.tileAccordion.setTiles(this.tiles))}},{key:"_onTableFilterAdded",value:function(e){this.table.tileMode&&this._addFilter(e.filter)}},{key:"_onTableFilterRemoved",value:function(e){this.table.tileMode&&(this.tileAccordion.removeTileFilter(this.tileFilterMap[e.filter.createKey()]),this.tileAccordion.filterTiles())}},{key:"_addFilter",value:function(e){var t={table:this.table,accept:function(t){var n=this.table.rowsMap[t.rowId];return!!n&&e.accept(n)}},n=e.createKey();this.tileFilterMap[n]&&this.tileAccordion.removeTileFilter(this.tileFilterMap[n]),this.tileFilterMap[n]=t,this.tileAccordion.addTileFilter(t)}},{key:"_onTableFilter",value:function(e){this.table.tileMode&&this.tileAccordion.filterTiles()}},{key:"_syncSelectionFromTableToTile",value:function(){this.tileAccordion&&this.tileAccordion.selectTiles(this.getTilesForRows(this.table.selectedRows))}},{key:"_syncSelectionFromTileGridToTable",value:function(e){if(!this._isUpdatingTiles){var t=e.map((function(e){return this.table.rowsMap[e.rowId]}),this).filter((function(e){return Boolean(e)}));this.table.selectRows(t)}}},{key:"_updateGroupVisibility",value:function(){this.tileAccordion.groups.forEach((function(e){var t=e.body.filters.length>0&&0===e.body.filteredTiles.length;e.setVisible(!t),e.setTitleSuffix("("+e.body.filteredTiles.length+")")}))}},{key:"_syncScrollTopFromTableToTile",value:function(){var e=this.table._rowIndexAtScrollTop(this.table.scrollTop);if(!(e<=0)){var t=this.tilesMap[this.table.rows[e].id];if(t){this.tileAccordion.scrollTop=null;var n={align:"top"};t.rendered?t.reveal(n):this.table.session.layoutValidator.schedulePostValidateFunction(t.reveal.bind(t,n))}}}},{key:"_syncScrollTopFromTileGridToTable",value:function(){var e=this.tileAccordion._tileAtScrollTop(this.tileAccordion.scrollTop);if(e){var t={align:"top"};this.table._isDataRendered()?this.table.scrollTo(this.table.rowsMap[e.rowId],t):this.table.session.layoutValidator.schedulePostValidateFunction(this.table.scrollTo.bind(this.table,this.table.rowsMap[e.rowId],t))}}},{key:"_syncFiltersFromTableToTile",value:function(){this.tileAccordion&&(this.tileAccordion.setTileFilters([]),Object.keys(this.table._filterMap).map((function(e){return this.table._filterMap[e]}),this).forEach((function(e){this._addFilter(e)}),this),this.tileAccordion.filterTiles())}},{key:"_renderTileTableHeader",value:function(){this.table.tileTableHeader&&this.table.tileTableHeader.render()}},{key:"_removeTileTableHeader",value:function(){this.table.tileTableHeader&&this.table.tileTableHeader.remove()}},{key:"_renderTileAccordion",value:function(){this.tileAccordion.rendered||this.tileAccordion.render()}},{key:"_removeTileAccordion",value:function(){this.tileAccordion.rendered&&this.tileAccordion.remove()}}])&&oE(t.prototype,n),i&&oE(t,i),o}(de);function dE(e){return(dE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yE(e,t){return(yE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=gE(e);if(t){var r=gE(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bE(this,n)}}function bE(e,t){return!t||"object"!==dE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gE(e){return(gE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yE(e,t)}(o,e);var t,n,i,r=vE(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,i=[{key:"modifyTableTileGridMediator",value:function(){x.get().remote&&(oi.replacePrototypeFunction(hE,"loadTiles",(function(){if(!this.modelAdapter)return this.loadTilesOrig()}),!0),oi.replacePrototypeFunction(hE,"_onTableRowsInserted",(function(e){if(!this.modelAdapter)return this._onTableRowsInsertedOrig(e)}),!0),oi.replacePrototypeFunction(hE,"_onTableRowsDeleted",(function(e){if(!this.modelAdapter)return this._onTableRowsDeletedOrig(e)}),!0),oi.replacePrototypeFunction(hE,"_onTableAllRowsDeleted",(function(e){if(!this.modelAdapter)return this._onTableAllRowsDeletedOrig(e)}),!0))}}],(n=null)&&pE(t.prototype,n),i&&pE(t,i),o}(fe);function _E(e){return(_E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kE(e,t,n){return(kE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PE(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function SE(e,t){return(SE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=PE(e);if(t){var r=PE(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return TE(this,n)}}function TE(e,t){return!t||"object"!==_E(t)&&"function"!=typeof t?CE(e):t}function CE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PE(e){return(PE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}x.addListener("bootstrap",mE.modifyTableTileGridMediator);var RE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SE(e,t)}(o,e);var t,n,i,r=OE(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).table=null,e.page=null,e.row=null,e._tableRowsUpdatedHandler=e._onTableRowsUpdated.bind(CE(e)),e._tableRowsInsertedHandler=e._onTableRowsInserted.bind(CE(e)),e}return t=o,(n=[{key:"_init",value:function(e){kE(PE(o.prototype),"_init",this).call(this,e),this.row=this.page.row,this.table.on("rowsUpdated",this._tableRowsUpdatedHandler),this.table.on("rowsInserted",this._tableRowsInsertedHandler)}},{key:"_destroy",value:function(){this.table.off("rowsUpdated",this._tableRowsUpdatedHandler),this.table.off("rowsInserted",this._tableRowsInsertedHandler),kE(PE(o.prototype),"_destroy",this).call(this)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("table-row-detail"),this.htmlComp=Uo.install(this.$container,this.session),this._renderRow()}},{key:"_renderRow",value:function(){this.table.visibleColumns().forEach(this._renderCell.bind(this)),this.invalidateLayoutTree()}},{key:"_renderCell",value:function(e){var t=this.table.cell(e,this.row);if(!En.empty(t.text)||t.iconId){var n;n=e.headerHtmlEnabled?En.plainText(e.text):e.text,En.empty(n)&&(n=e.headerTooltipHtmlEnabled?En.plainText(e.headerTooltipText):e.headerTooltipText);var i=e.cellTextForRowDetail(this.row),r=this.$container.appendDiv("table-row-detail-field");En.empty(n)||r.appendSpan("table-row-detail-name").text(n+": ");var o=t.iconId,s=!En.empty(i);o&&r.appendIcon(o,"table-row-detail-icon").toggleClass("with-text",s),s&&r.appendSpan("table-row-detail-value").html(i)}}},{key:"_refreshRow",value:function(){this.$container.empty(),this._renderRow()}},{key:"_onTableRowsUpdated",value:function(e){if(this.rendered){var t=et.find(e.rows,function(e){return e.id===this.row.id}.bind(this));t&&(this.row=t,this._refreshRow())}}},{key:"_onTableRowsInserted",value:function(e){this.rendered&&(e.source.rows.indexOf(this.page.row)<0||(this.row=this.page.row,this._refreshRow()))}}])&&wE(t.prototype,n),i&&wE(t,i),o}(de);function xE(e){return(xE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EE(e,t){return(EE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=AE(e);if(t){var r=AE(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return FE(this,n)}}function FE(e,t){return!t||"object"!==xE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AE(e){return(AE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EE(e,t)}(n,e);var t=DE(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).tableRow=null,e.tile=null,e._addWidgetProperties(["tile"]),e}return n}(de);function jE(e){return(jE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ME(e,t){return(ME=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=BE(e);if(t){var r=BE(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return LE(this,n)}}function LE(e,t){return!t||"object"!==jE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function BE(e){return(BE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var NE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ME(e,t)}(n,e);var t=IE(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(fe);function HE(e){return(HE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function WE(e,t,n){return(WE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KE(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function zE(e,t){return(zE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=KE(e);if(t){var r=KE(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return UE(this,n)}}function UE(e,t){return!t||"object"!==HE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KE(e){return(KE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zE(e,t)}(o,e);var t,n,i,r=GE(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){WE(KE(o.prototype),"_init",this).call(this,e),this.table=e.table}},{key:"_render",value:function(){WE(KE(o.prototype),"_render",this).call(this),this._rowOrderChangedFunc=function(e){e.animating?e.row===this.row&&this.position():this.position()}.bind(this),this.table.on("rowOrderChanged",this._rowOrderChangedFunc)}},{key:"_remove",value:function(){WE(KE(o.prototype),"_remove",this).call(this),this.table.off("rowOrderChanged",this._rowOrderChangedFunc)}}])&&VE(t.prototype,n),i&&VE(t,i),o}(lh);function YE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var XE=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._rowMap={},this.promises=[],this.table=t}var t,n,i;return t=e,(n=[{key:"pushPromise",value:function(e){this.promises.push(e),this.table._renderViewportBlocked=!0,this.table.setLoading(!0);var t=function(){et.remove(this.promises,e),0===this.promises.length&&this.process()}.bind(this);e.then(t,t)}},{key:"isBuffering",value:function(){return this.promises.length>0}},{key:"buffer",value:function(e){(e=et.ensure(e)).forEach((function(e){this._rowMap[e.id]=e}),this)}},{key:"process",value:function(){if(!this.table.destroyed){var e=oi.values(this._rowMap);this.table.updateRows(e),this._rowMap={},this.table.setLoading(!1),this.table._renderViewportBlocked=!1,this.table._isDataRendered()&&this.table._renderViewport()}}}])&&YE(t.prototype,n),i&&YE(t,i),e}();function JE(e){return(JE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QE(e,t,n){return(QE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iD(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function eD(e,t){return(eD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=iD(e);if(t){var r=iD(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return nD(this,n)}}function nD(e,t){return!t||"object"!==JE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iD(e){return(iD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eD(e,t)}(o,e);var t,n,i,r=tD(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).table=null,e}return t=o,(n=[{key:"_init",value:function(e){QE(iD(o.prototype),"_init",this).call(this,e)}},{key:"_data",value:function(){var e=[];return e.push([null,this.session.text("NoGrouping"),"BOLD"]),this.table.visibleColumns().forEach((function(t){this.table.isGroupingPossible(t)&&e.push([t,O.nvl(t.text,t.headerTooltipText)])}),this),e}},{key:"_dataToLookupRow",value:function(e){return O.create("LookupRow",{key:e[0],text:e[1],font:e[2]})}}])&&ZE(t.prototype,n),i&&ZE(t,i),o}(Rr);function oD(e){return(oD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aD(e,t,n){return(aD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fD(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function uD(e,t){return(uD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=fD(e);if(t){var r=fD(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cD(this,n)}}function cD(e,t){return!t||"object"!==oD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fD(e){return(fD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uD(e,t)}(o,e);var t,n,i,r=lD(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).table=null,e}return t=o,(n=[{key:"_init",value:function(e){aD(fD(o.prototype),"_init",this).call(this,e)}},{key:"_data",value:function(){var e=[];return this.table.visibleColumns().forEach((function(t){t.isSortingPossible()&&(e.push([{column:t,asc:!0},O.nvl(t.text,t.headerTooltipText)+" ("+this.session.text("ui.ascending")+")",sn.LONG_ARROW_UP_BOLD]),e.push([{column:t,asc:!1},O.nvl(t.text,t.headerTooltipText)+" ("+this.session.text("ui.descending")+")",sn.LONG_ARROW_DOWN_BOLD]))}),this),e}},{key:"_dataToLookupRow",value:function(e){return O.create("LookupRow",{key:e[0],text:e[1],iconId:e[2]})}}])&&sD(t.prototype,n),i&&sD(t,i),o}(Rr),dD={collator:null,installed:!1,install:function(e){return this.installed||(Mt.get().supportsInternationalization()?(this.collator=new window.Intl.Collator(e.locale.languageTag),s.a.log.isInfoEnabled()&&s.a.log.info("(comparators.TEXT#install) Browser supports i18n - installed Intl.Collator, can sort in Browser")):s.a.log.isInfoEnabled()&&s.a.log.info("(comparators.TEXT#install) Browser doesn't support i18n. Must sort on server"),this.installed=!0),!!this.collator},compare:function(e,t){return e||t?e?t?this.collator?this.collator.compare(e,t):e<t?-1:e>t?1:0:1:-1:0},compareIgnoreCase:function(e,t){return e||(e=null),t||(t=null),e===t?0:null===e?-1:null===t?1:this.compare(e.toLowerCase(),t.toLowerCase())}},pD={install:function(e){return!0},compare:function(e,t){return oi.isNullOrUndefined(e)&&oi.isNullOrUndefined(t)?0:oi.isNullOrUndefined(e)?-1:oi.isNullOrUndefined(t)?1:e<t?-1:e>t?1:0}},yD={ALPHANUMERIC:{collator:null,installed:!1,install:function(e){return dD.install(e),this.collator=dD.collator,!!this.collator&&pD.install(e)},compare:function(e,t){return this._compare(e,t,!1)},compareIgnoreCase:function(e,t){return this._compare(e,t,!0)},_compare:function(e,t,n){if(!e&&!t)return 0;if(!e)return-1;if(!t)return 1;for(var i=new RegExp("(([0-9]+)|([^0-9]+))","g"),r=new RegExp("(([0-9]+)|([^0-9]+))","g"),o=i.exec(e),s=r.exec(t);o&&s;){var a=parseInt(o[1],0),u=parseInt(s[1],0);if(isNaN(a)||isNaN(u)){var l=n?dD.compareIgnoreCase(o[1],s[1]):dD.compare(o[1],s[1]);if(0!==l)return l}else{var c=pD.compare(a,u);if(0!==c)return c}o=i.exec(e),s=r.exec(t)}return o||s?o?1:-1:0}},NUMERIC:pD,TEXT:dD};function vD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gD=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.autoOptimizeWidth=!1,this.autoOptimizeWidthRequired=!1,this.autoOptimizeMaxWidth=-1,this.cssClass=null,this.editable=!1,this.removable=!1,this.modifiable=!1,this.fixedWidth=!1,this.fixedPosition=!1,this.grouped=!1,this.headerCssClass=null,this.headerIconId=null,this.headerHtmlEnabled=!1,this.headerTooltipText=null,this.horizontalAlignment=-1,this.htmlEnabled=!1,this.index=-1,this.initialized=!1,this.mandatory=!1,this.optimalWidthMeasurer=new _D(this),this.sortActive=!1,this.sortAscending=!0,this.sortIndex=-1,this.summary=!1,this.type="text",this.width=60,this.initialWidth=void 0,this.prefMinWidth=null,this.minWidth=e.DEFAULT_MIN_WIDTH,this.showSeparator=!0,this.table=null,this.tableNodeColumn=!1,this.maxLength=4e3,this.text=null,this.textWrap=!1,this.filterType="TextColumnUserFilter",this.comparator=yD.TEXT,this.displayable=!0,this.visible=!0,this.textBased=!0,this.headerMenuEnabled=!0,this.tableNodeLevel0CellPadding=28,this.expandableIconLevel0CellPadding=13,this.nodeColumnCandidate=!0,this.events=this._createEventSupport(),this._tableColumnsChangedHandler=this._onTableColumnsChanged.bind(this),this._realWidth=null}var t,n,i;return t=e,(n=[{key:"init",value:function(e){this.session=e.session,s.a.extend(this,e),void 0===this.initialWidth&&(this.initialWidth=O.nvl(this.width,0)),this._init(e),this.initialized=!0}},{key:"_init",value:function(e){th.resolveTextProperty(this,"text"),th.resolveTextProperty(this,"headerTooltipText"),sn.resolveIconProperty(this,"headerIconId"),this._setTable(this.table),this._setDisplayable(this.displayable),this._setAutoOptimizeWidth(this.autoOptimizeWidth)}},{key:"destroy",value:function(){this._destroy(),this._setTable(null)}},{key:"_destroy",value:function(e){}},{key:"_setTable",value:function(e){this.table&&this.table.off("columnMoved columnStructureChanged",this._tableColumnsChangedHandler),this.table=e,this.table&&this.table.on("columnMoved columnStructureChanged",this._tableColumnsChangedHandler)}},{key:"initCell",value:function(e,t){var n=this._ensureCell(e);return this._initCell(n),oi.isNullOrUndefined(n.text)&&this._updateCellText(t,n),n}},{key:"_ensureCell",value:function(e){var t;return e instanceof hc?(t=e).value=this._parseValue(t.value):t=O.create("Cell",{value:this._parseValue(e)}),t}},{key:"_parseValue",value:function(e){return e}},{key:"_updateCellText",value:function(e,t){var n=t.value;if(e){var i=this._formatValue(n);i&&s.a.isFunction(i.promise)?this.setCellTextDeferred(i,e,t):this.setCellText(e,i,t)}}},{key:"_formatValue",value:function(e){return O.nvl(e,"")}},{key:"_initCell",value:function(e){return e.cssClass=O.nvl(e.cssClass,this.cssClass),e.editable=O.nvl(e.editable,this.editable),e.horizontalAlignment=O.nvl(e.horizontalAlignment,this.horizontalAlignment),e.htmlEnabled=O.nvl(e.htmlEnabled,this.htmlEnabled),e.mandatory=O.nvl(e.mandatory,this.mandatory),e}},{key:"buildCellForRow",value:function(e){var t=this.cell(e);return this.buildCell(t,e)}},{key:"buildCellForAggregateRow",value:function(e){var t;if(this.grouped){var n=this.table.groupingStyle===ZP.GroupingStyle.TOP?e.nextRow:e.prevRow;t=this.createAggrGroupCell(n)}else{var i=e.contents[this.table.columns.indexOf(this)];t=this.createAggrValueCell(i)}return this.buildCell(t,{})}},{key:"buildCell",value:function(e,t){O.assertParameter("cell",e,hc);var n=this.table.isTableNodeColumn(this),i=0;n&&(i=this.table._calcRowLevelPadding(t));var r,o=this._text(e),s=e.iconId,a=this._icon(s,!!o)||"",u=this._cellCssClass(e,n),l=this._cellStyle(e,n,i);return e.errorStatus&&(t.hasError=!0),o||a?r=a+o:(r="&nbsp;",u=En.join(" ",u,"empty")),n&&t._expandable&&(this.tableNodeColumn=!0,r=this._expandIcon(t.expanded,i)+r,t.expanded&&(u+=" expanded")),this._buildCell(r,l,u)}},{key:"_buildCell",value:function(e,t,n){return'<div class="'+n+'" style="'+t+'">'+e+"</div>"}},{key:"_expandIcon",value:function(e,t){var n="table-row-control";return e&&(n+=" expanded"),'<div class="'+n+'" style="padding-left: '+(t+this.expandableIconLevel0CellPadding)+'px"></div>'}},{key:"_icon",value:function(e,t){var n,i;if(e)return n="table-cell-icon",t&&(n+=" with-text"),(i=sn.parseIconId(e)).isFontIcon()?(n+=" font-icon",'<span class="'+i.appendCssClass(n)+'">'+i.iconCharacter+"</span>"):'<img class="'+(n+=" image-icon")+'" src="'+i.iconUrl+'">'}},{key:"_text",value:function(e){var t=e.text||"";return e.htmlEnabled||(t=e.encodedText()||"",this.table.multilineText&&(t=En.nl2br(t,!1))),t}},{key:"_cellCssClass",value:function(e,t){var n="table-cell";e.mandatory&&(n+=" mandatory"),this.table.multilineText&&this.textWrap||(n+=" white-space-nowrap"),e.editable&&(n+=" editable"),e.errorStatus&&(n+=" has-error"),n+=" halign-"+ZP.parseHorizontalAlignment(e.horizontalAlignment);var i=this.table.visibleColumns(),r=i.indexOf(this);return 0===r&&(n+=" first"),r===i.length-1&&(n+=" last"),t&&(n+=" table-node"),e.cssClass&&(n+=" "+e.cssClass),n}},{key:"_cellStyle",value:function(e,t,n){var i,r=this.width;return 0===r?"display: none;":(i="min-width: "+r+"px; max-width: "+r+"px; ",t&&(i+=" padding-left: "+(this.tableNodeLevel0CellPadding+n)+"px; "),i+=$i.legacyStyle(e))}},{key:"onMouseUp",value:function(e,t){var n=t.data("row"),i=this.cell(n);this.isCellEditable(n,i,e)&&this.table.prepareCellEdit(this,n,!0)}},{key:"isCellEditable",value:function(e,t,n){return this.table.enabledComputed&&e.enabled&&t.editable&&!n.ctrlKey&&!n.shiftKey}},{key:"startCellEdit",value:function(e,t){var n,i=e.$row,r=this.cell(e),o=this.table.$cell(this,i);return r.field=t,r.field.gridData.horizontalAlignment=r.horizontalAlignment,(n=O.create("CellEditorPopup",{parent:this.table,column:this,row:e,cell:r})).$anchor=o,n.open(this.table.$data),n}},{key:"cell",value:function(e){return this.table.cell(this,e)}},{key:"selectedCell",value:function(){var e=this.table.selectedRow();return this.table.cell(this,e)}},{key:"cellValueOrText",value:function(e){return this.textBased?this.table.cellText(this,e):this.table.cellValue(this,e)}},{key:"cellValueOrTextForCalculation",value:function(e){var t=this.cell(e),n=this.cellValueOrText(e);return oi.isNullOrUndefined(n)?null:this._preprocessValueOrTextForCalculation(n,t)}},{key:"_preprocessValueOrTextForCalculation",value:function(e,t){return"string"==typeof e?this._preprocessTextForCalculation(e,t.htmlEnabled):e}},{key:"_preprocessTextForCalculation",value:function(e,t){return this._preprocessText(e,{removeHtmlTags:t,removeNewlines:!0,trim:!0})}},{key:"cellTextForGrouping",value:function(e){var t=this.cell(e);return this._preprocessTextForGrouping(t.text,t.htmlEnabled)}},{key:"_preprocessTextForGrouping",value:function(e,t){return this._preprocessText(e,{removeHtmlTags:t,trim:!0})}},{key:"cellTextForTextFilter",value:function(e){var t=this.cell(e);return this._preprocessTextForTextFilter(t.text,t.htmlEnabled)}},{key:"_preprocessTextForTextFilter",value:function(e,t){return this._preprocessText(e,{removeHtmlTags:t})}},{key:"cellTextForRowDetail",value:function(e){var t=this.cell(e);return this._preprocessText(this._text(t),{removeHtmlTags:t.htmlEnabled})}},{key:"_preprocessText",value:function(e,t){return null==e||((t=t||{}).removeHtmlTags&&(e=En.plainText(e)),t.removeNewlines&&(e=e.replace("\n"," ")),t.trim&&(e=e.trim())),e}},{key:"setCellValue",value:function(e,t){var n=this.cell(e);t=this._parseValue(t),n.value!==t&&(n.setValue(t),e.status===uR.Status.NON_CHANGED&&(e.status=uR.Status.UPDATED),this._updateCellText(e,n))}},{key:"setCellTextDeferred",value:function(e,t,n){e.done(function(e){this.setCellText(t,e,n)}.bind(this)).fail(function(e){this.setCellText(t,"",n),s.a.log.error("Could not resolve cell text for value "+n.value,e)}.bind(this)),this.table.updateBuffer.pushPromise(e)}},{key:"setCellText",value:function(e,t,n){n||(n=this.cell(e)),n.setText(t),e.initialized&&this.table&&this.table.updateRow(e)}},{key:"setCellErrorStatus",value:function(e,t,n){n||(n=this.cell(e)),n.setErrorStatus(t)}},{key:"setHorizontalAlignment",value:function(e){this.horizontalAlignment!==e&&(this.horizontalAlignment=e,this.table.rows.forEach(function(t){this.cell(t).setHorizontalAlignment(e)}.bind(this)),this.table.updateRows(this.table.rows),this.table.header&&this.table.header.updateHeader(this))}},{key:"setEditable",value:function(e){this.editable!==e&&(this.editable=e,this.table.rows.forEach(function(t){this.cell(t).setEditable(e)}.bind(this)),this.table.updateRows(this.table.rows))}},{key:"setMandatory",value:function(e){this.mandatory!==e&&(this.mandatory=e,this.table.rows.forEach(function(t){this.cell(t).setMandatory(e)}.bind(this)),this.table.updateRows(this.table.rows))}},{key:"setCssClass",value:function(e){this.cssClass!==e&&(this.cssClass=e,this.table.rows.forEach((function(t){this.cell(t).setCssClass(e)}),this),this.table.updateRows(this.table.rows))}},{key:"setWidth",value:function(e){this.width!==e&&this.table.resizeColumn(this,e)}},{key:"createAggrGroupCell",value:function(e){var t=this.cell(e);return this.initCell(O.create("Cell",{value:t.value,text:this.cellTextForGrouping(e),iconId:t.iconId,horizontalAlignment:this.horizontalAlignment,cssClass:"table-aggregate-cell"}))}},{key:"createAggrValueCell",value:function(e){return this.createAggrEmptyCell()}},{key:"createAggrEmptyCell",value:function(){return this.initCell(O.create("Cell",{empty:!0,cssClass:"table-aggregate-cell"}))}},{key:"calculateOptimalWidth",value:function(){return this.optimalWidthMeasurer.measure()}},{key:"createFilter",value:function(e){return O.create(this.filterType,{session:this.session,table:this.table,column:this})}},{key:"createTableHeaderMenu",value:function(e){var t=this.$header;return O.create("TableHeaderMenu",{parent:e,column:t.data("column"),tableHeader:e,$anchor:t,focusableContainer:!0})}},{key:"createEditor",value:function(e){var t=this._createEditor(e),n=this.cell(e);this._initEditorField(t,n),t.setLabelVisible(!1),t.setFieldStyle(GH.FieldStyle.CLASSIC);var i=new kV(t.gridDataHints);return i.horizontalAlignment=n.horizontalAlignment,t.setGridDataHints(i),t}},{key:"_initEditorField",value:function(e,t){e.setValue(t.value)}},{key:"_createEditor",value:function(){return O.create("StringField",{parent:this.table,maxLength:this.maxLength,multilineText:this.table.multilineText,wrapText:this.textWrap})}},{key:"installComparator",value:function(){return this.comparator.install(this.session)}},{key:"isSortingPossible",value:function(){return this.installComparator(),!0}},{key:"compare",value:function(e,t){var n=this.cellValueOrText(e),i=this.cellValueOrText(t);return this.comparator.compare(n,i)}},{key:"isVisible",value:function(){return this.displayable&&this.visible}},{key:"setVisible",value:function(e){this.visible!==e&&this._setVisible(e)}},{key:"_setVisible",value:function(e){this.visible=e,this.initialized&&this.table.onColumnVisibilityChanged(this)}},{key:"setDisplayable",value:function(e){this.displayable!==e&&this._setDisplayable(e)}},{key:"_setDisplayable",value:function(e){this.displayable=e,this.initialized&&this.table.onColumnVisibilityChanged(this)}},{key:"setAutoOptimizeWidth",value:function(e){this.autoOptimizeWidth!==e&&this._setAutoOptimizeWidth(e)}},{key:"_setAutoOptimizeWidth",value:function(e){this.autoOptimizeWidth=e,this.autoOptimizeWidthRequired=e,this.initialized&&(this.table.columnLayoutDirty=!0,this.table.invalidateLayoutTree())}},{key:"setMaxLength",value:function(e){this.maxLength=e}},{key:"setText",value:function(e){this.text!==e&&(this.text=e,this.table.header&&this.table.header.updateHeader(this))}},{key:"setHeaderIconId",value:function(e){this.headerIconId!==e&&(this.headerIconId=e,this.table.header&&this.table.header.updateHeader(this))}},{key:"setHeaderCssClass",value:function(e){if(this.headerCssClass!==e){var t=s.a.extend({},this);this.headerCssClass=e,this.table.header&&this.table.header.updateHeader(this,t)}}},{key:"setHeaderHtmlEnabled",value:function(e){this.headerHtmlEnabled!==e&&(this.headerHtmlEnabled=e,this.table.header&&this.table.header.updateHeader(this))}},{key:"setHeaderTooltipText",value:function(e){this.headerTooltipText=e}},{key:"setHeaderTooltipHtmlEnabled",value:function(e){this.headerTooltipHtmlEnabled=e}},{key:"setTextWrap",value:function(e){this.textWrap!==e&&(this.textWrap=e,this.table.rendered&&this.table.multilineText&&(this.autoOptimizeWidthRequired=!0,this.table._redraw(),this.table.invalidateLayoutTree()))}},{key:"isContentValid",value:function(e){var t=this.cell(e),n=!t.errorStatus||t.errorStatus.severity!==pi.Severity.ERROR,i=!t.mandatory||this._hasCellValue(t);return{valid:n&&i,validByErrorStatus:n,validByMandatory:i}}},{key:"_hasCellValue",value:function(e){return!!e.value}},{key:"_onTableColumnsChanged",value:function(e){0===this.table.visibleColumns().indexOf(this)?(this.tableNodeLevel0CellPadding=28,this.expandableIconLevel0CellPadding=13):(this.tableNodeLevel0CellPadding=23,this.expandableIconLevel0CellPadding=8)}},{key:"_realWidthIfAvailable",value:function(){return this._realWidth||this.width}},{key:"_createEventSupport",value:function(){return new Yt}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}},{key:"when",value:function(e){return this.events.when(e)}}])&&vD(t.prototype,n),i&&vD(t,i),e}();function mD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}bD(gD,"DEFAULT_MIN_WIDTH",60),bD(gD,"NARROW_MIN_WIDTH",32);var _D=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.column=t,this.table=null,this.$measurement=null,this.deferred=null,this.imageCount=0,this.completeImageCount=0,this._imageLoadOrErrorHandler=this._onImageLoadOrError.bind(this),this._columnCellContents={}}var t,n,i;return t=e,(n=[{key:"measure",value:function(e){if(s.a.log.isDebugEnabled()&&s.a.log.debug("Optimal width measuring started for column "+this.column.id),this.table=this.column.table,this.$measurement&&(s.a.log.isDebugEnabled()&&s.a.log.debug("Optimal width measuring aborted for column "+this.column.id),this._resolve(-1)),this.$measurement=this.table.$data.makeDiv("hidden"),this.imageCount=0,this.completeImageCount=0,this._appendElements(),this.table.$data.append(this.$measurement),this.completeImageCount>=this.imageCount){var t=this._measure();return s.a.log.isDebugEnabled()&&s.a.log.debug("Optimal width measuring done (sync) for column "+this.column.id+": "+t),this.remove(),t}return s.a.log.isDebugEnabled()&&s.a.log.debug("Not all images loaded, deferring measurement for column "+this.column.id+". Images complete: "+this.completeImageCount+"/"+this.imageCount),this.$measurement[0].addEventListener("load",this._imageLoadOrErrorHandler,!0),this.$measurement[0].addEventListener("error",this._imageLoadOrErrorHandler,!0),this.deferred=s.a.Deferred(),this.deferred.promise()}},{key:"remove",value:function(){this.$measurement&&(this.$measurement[0].removeEventListener("load",this._imageLoadOrErrorHandler,!0),this.$measurement[0].removeEventListener("error",this._imageLoadOrErrorHandler,!0),this.$measurement.remove(),this.$measurement=null)}},{key:"_measure",value:function(){var e=this.column.minWidth;return this.$measurement.addClass("invisible").removeClass("hidden").children().each((function(){e=Math.max(e,No.size(s()(this)).width)})),e}},{key:"_resolve",value:function(e){this.remove(),this.deferred&&(this.deferred.resolve(e),this.deferred=null)}},{key:"_appendElements",value:function(){this._appendHeader(),this._appendRows(),this._appendAggregateRows()}},{key:"_appendHeader",value:function(){this.column.$header&&this._appendToMeasurement(this.column.$header.clone())}},{key:"_appendRows",value:function(){this.table.rows.forEach(this._appendRow.bind(this)),this._columnCellContents={}}},{key:"_appendRow",value:function(e){var t=this.column.buildCellForRow(e);this._columnCellContents[t]||(this._columnCellContents[t]=!0,this._appendToMeasurement(s()(t)))}},{key:"_appendAggregateRows",value:function(){this.table._aggregateRows.forEach(this._appendAggregateRow.bind(this))}},{key:"_appendAggregateRow",value:function(e){this._appendToMeasurement(s()(this.column.buildCellForAggregateRow(e)))}},{key:"_appendToMeasurement",value:function(e){e.find("img").each(function(e,t){var n=s()(t);n.data("measure","in-progress"),t.complete&&(n.data("complete",t.complete),this.completeImageCount++),this.imageCount++}.bind(this)),e.css({minWidth:"",maxWidth:""}).appendTo(this.$measurement)}},{key:"_onImageLoadOrError",value:function(e){if(!s()(e.target).data("complete")&&(this.completeImageCount++,s.a.log.isTraceEnabled()&&s.a.log.trace("Images complete (async) "+this.completeImageCount+"/"+this.imageCount,e.target.src),this.completeImageCount>=this.imageCount)){var t=this._measure();s.a.log.isDebugEnabled()&&s.a.log.debug("Optimal width measuring done (async) for column "+this.column.id+": "+t),this._resolve(t)}}}])&&mD(t.prototype,n),i&&mD(t,i),e}();function wD(e){return(wD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kD(e,t){return(kD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=TD(e);if(t){var r=TD(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return OD(this,n)}}function OD(e,t){return!t||"object"!==wD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TD(e){return(TD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kD(e,t)}(n,e);var t=SD(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).comparator=yD.ALPHANUMERIC,e}return n}(gD);function PD(e){return(PD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xD(e,t,n){return(xD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=AD(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function ED(e,t){return(ED=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=AD(e);if(t){var r=AD(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return FD(this,n)}}function FD(e,t){return!t||"object"!==PD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AD(e){return(AD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ED(e,t)}(o,e);var t,n,i,r=DD(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"buildCellForRow",value:function(e){var t=this.cell(e),n=this._cellCssClass(t),i=this._cellStyle(t),r=s()(xD(AD(o.prototype),"_buildCell",this).call(this,"",i,n)),a=this.table.cellValue(this,e);return t.errorStatus&&(e.hasError=!0),this._renderValue(r,a),r[0].outerHTML}},{key:"_renderValue",value:function(e,t){}},{key:"_plainTextForRow",value:function(e){var t=this.table.cell(this,e);if(!t.plainText){var n=this.buildCellForRow(e);t.plainText=En.plainText(n)}return t.plainText}},{key:"cellValueOrTextForCalculation",value:function(e){var t=this._plainTextForRow(e);return this._preprocessTextForCalculation(t)}},{key:"cellTextForGrouping",value:function(e){var t=this._plainTextForRow(e);return this._preprocessTextForGrouping(t)}},{key:"cellTextForTextFilter",value:function(e){var t=this._plainTextForRow(e);return this._preprocessTextForTextFilter(t)}},{key:"compare",value:function(e,t){var n=this._plainTextForRow(e),i=this._plainTextForRow(t);return this.comparator.compareIgnoreCase(n,i)}}])&&RD(t.prototype,n),i&&RD(t,i),o}(gD);function jD(e){return(jD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ID(e,t,n){return(ID="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HD(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function LD(e,t){return(LD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=HD(e);if(t){var r=HD(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ND(this,n)}}function ND(e,t){return!t||"object"!==jD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HD(e){return(HD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var VD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LD(e,t)}(o,e);var t,n,i,r=BD(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).comparator=yD.NUMERIC,e.filterType="ColumnUserFilter",e.horizontalAlignment=0,e.minWidth=gD.NARROW_MIN_WIDTH,e.triStateEnabled=!1,e.textBased=!1,e}return t=o,(n=[{key:"_formatValue",value:function(e){return null}},{key:"buildCell",value:function(e,t){var n,i,r,s="",a=t.enabled,u=this.table.isTableNodeColumn(this),l=0;return u&&(l=this.table._calcRowLevelPadding(t)),e.empty?ID(HD(o.prototype),"buildCell",this).call(this,e,t):(a=a&&e.editable,i=this._cellCssClass(e,u),n=this._cellStyle(e,u,l),a||(i+=" disabled"),r="check-box",!0===e.value&&(r+=" checked"),this.triStateEnabled&&!0!==e.value&&!1!==e.value&&(r+=" undefined"),a||(r+=" disabled"),u&&t._expandable&&(this.tableNodeColumn=!0,s=this._expandIcon(t.expanded,l)+s,t.expanded&&(i+=" expanded")),'<div class="'+i+'" style="'+n+'">'+(s=s+'<div class="'+r+'"/>')+"</div>")}},{key:"$checkBox",value:function(e){return this.table.$cell(this,e).children(".check-box")}},{key:"_cellCssClass",value:function(e,t){var n=ID(HD(o.prototype),"_cellCssClass",this).call(this,e);return n=n.replace(" editable",""),n+=" checkable",t&&(n+=" table-node"),n}},{key:"onMouseUp",value:function(e,t){var n=t.data("row"),i=this.cell(n);this.table.checkableColumn===this?this.table.checkRow(n,!n.checked):this.isCellEditable(n,i,e)&&this._toggleCellValue(n,i)}},{key:"_toggleCellValue",value:function(e,t){this.triStateEnabled?!1===t.value?this.setCellValue(e,!0):!0===t.value?this.setCellValue(e,null):null===t.value&&this.setCellValue(e,!1):this.setCellValue(e,!t.value)}},{key:"_createEditor",value:function(e){return O.create("CheckBoxField",{parent:this.table})}},{key:"cellTextForGrouping",value:function(e){var t=this.cell(e);return this.triStateEnabled&&null===t.value?this.session.text("ui.BooleanColumnGroupingMixed"):!0===t.value?this.session.text("ui.BooleanColumnGroupingTrue"):this.session.text("ui.BooleanColumnGroupingFalse")}}])&&MD(t.prototype,n),i&&MD(t,i),o}(gD);function WD(e){return(WD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GD(e,t,n){return(GD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=YD(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function UD(e,t){return(UD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=YD(e);if(t){var r=YD(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return qD(this,n)}}function qD(e,t){return!t||"object"!==WD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function YD(e){return(YD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var XD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UD(e,t)}(o,e);var t,n,i,r=KD(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).format,e.groupFormat="yyyy",e.hasDate=!0,e.hasTime=!1,e.filterType="DateColumnUserFilter",e.comparator=yD.NUMERIC,e.textBased=!1,e}return t=o,(n=[{key:"_init",value:function(e){GD(YD(o.prototype),"_init",this).call(this,e),this._setFormat(this.format),this._setGroupFormat(this.groupFormat)}},{key:"setFormat",value:function(e){this.format!==e&&(this._setFormat(e),this.initialized&&this.table.rows.forEach(function(e){this._updateCellText(e,this.cell(e))}.bind(this)))}},{key:"_setFormat",value:function(e){e||(e=this._getDefaultFormat(this.session.locale)),e=If.ensure(this.session.locale,e),this.format=e}},{key:"setGroupFormat",value:function(e){this.groupFormat!==e&&(this._setGroupFormat(e),this.initialized&&this.table.rows.forEach(function(e){this._updateCellText(e,this.cell(e))}.bind(this)))}},{key:"_setGroupFormat",value:function(e){e||(e=this._getDefaultFormat(this.session.locale)),e=If.ensure(this.session.locale,e),this.groupFormat=e}},{key:"_formatValue",value:function(e){return this.format.format(e)}},{key:"_parseValue",value:function(e){return wt.ensure(e)}},{key:"_getDefaultFormat",value:function(e){return this.hasDate&&this.hasTime?e.dateFormatPatternDefault+" "+e.timeFormatPatternDefault:this.hasDate?e.dateFormatPatternDefault:e.timeFormatPatternDefault}},{key:"cellTextForGrouping",value:function(e){var t=this.table.cellValue(this,e);return this.groupFormat.format(t)}},{key:"_createEditor",value:function(){return O.create("DateField",{parent:this.table,hasDate:this.hasDate,hasTime:this.hasTime})}}])&&zD(t.prototype,n),i&&zD(t,i),o}(gD);function JD(e){return(JD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QD(e,t,n){return(QD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iF(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function eF(e,t){return(eF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=iF(e);if(t){var r=iF(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return nF(this,n)}}function nF(e,t){return!t||"object"!==JD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iF(e){return(iF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eF(e,t)}(o,e);var t,n,i,r=tF(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).minWidth=gD.NARROW_MIN_WIDTH,e.filterType="ColumnUserFilter",e.textBased=!1,e}return t=o,(n=[{key:"_initCell",value:function(e){return QD(iF(o.prototype),"_initCell",this).call(this,e),e.text=null,e.iconId=e.value||e.iconId,e}},{key:"_formatValue",value:function(e){return null}},{key:"_cellCssClass",value:function(e,t){var n=QD(iF(o.prototype),"_cellCssClass",this).call(this,e,t);return n+=" table-icon-cell"}},{key:"cellTextForGrouping",value:function(e){return this.table.cell(this,e).value}},{key:"createAggrGroupCell",value:function(e){var t=QD(iF(o.prototype),"createAggrGroupCell",this).call(this,e);return t.text=null,t}}])&&ZD(t.prototype,n),i&&ZD(t,i),o}(gD);function oF(e){return(oF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aF(e,t,n){return(aF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fF(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function uF(e,t){return(uF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=fF(e);if(t){var r=fF(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cF(this,n)}}function cF(e,t){return!t||"object"!==oF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fF(e){return(fF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uF(e,t)}(o,e);var t,n,i,r=lF(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).aggregationFunction="sum",e.backgroundEffect=null,e.decimalFormat=null,e.minValue=null,e.maxValue=null,e.calcMinValue=null,e.calcMaxValue=null,e.horizontalAlignment=1,e.filterType="NumberColumnUserFilter",e.comparator=yD.NUMERIC,e.textBased=!1,e.allowedAggregationFunctions=["sum","avg","min","max","none"],e}return t=o,(n=[{key:"_init",value:function(e){aF(fF(o.prototype),"_init",this).call(this,e),this._setDecimalFormat(this.decimalFormat),this.setAggregationFunction(this.aggregationFunction)}},{key:"setDecimalFormat",value:function(e){this.decimalFormat!==e&&(this._setDecimalFormat(e),this.initialized&&this.table.rows.forEach(function(e){this._updateCellText(e,this.cell(e))}.bind(this)))}},{key:"_setDecimalFormat",value:function(e){e||(e=this._getDefaultFormat(this.session.locale)),this.decimalFormat=Bf.ensure(this.session.locale,e)}},{key:"_getDefaultFormat",value:function(e){return e.decimalFormatPatternDefault}},{key:"_formatValue",value:function(e){return this.decimalFormat.format(e)}},{key:"_parseValue",value:function(e){return Gn.ensure(e)}},{key:"setAggregationFunction",value:function(e){if(this.aggregationFunction=e,"sum"===e)this.aggrStart=zi.sumStart,this.aggrStep=zi.sumStep,this.aggrFinish=zi.sumFinish,this.aggrSymbol=zi.sumSymbol;else if("avg"===e)this.aggrStart=zi.avgStart,this.aggrStep=zi.avgStep,this.aggrFinish=zi.avgFinish,this.aggrSymbol=zi.avgSymbol;else if("min"===e)this.aggrStart=zi.minStart,this.aggrStep=zi.minStep,this.aggrFinish=zi.minFinish,this.aggrSymbol=zi.minSymbol;else if("max"===e)this.aggrStart=zi.maxStart,this.aggrStep=zi.maxStep,this.aggrFinish=zi.maxFinish,this.aggrSymbol=zi.maxSymbol;else if("none"===e){var t=function(){};this.aggrStart=t,this.aggrStep=t,this.aggrFinish=t,this.aggrSymbol=void 0}}},{key:"createAggrValueCell",value:function(e){var t=this._formatValue(e);return O.create("Cell",{text:t,iconId:t?this.aggrSymbol:null,horizontalAlignment:this.horizontalAlignment,cssClass:"table-aggregate-cell"})}},{key:"_cellStyle",value:function(e,t,n){var i=aF(fF(o.prototype),"_cellStyle",this).call(this,e,t,n);if(!this.backgroundEffect||void 0===e.value||En.contains(e.cssClass,"table-aggregate-cell"))return i;this.backgroundEffectFunc||(this.backgroundEffectFunc=this._resolveBackgroundEffectFunc());var r=this.backgroundEffectFunc(this._preprocessValueOrTextForCalculation(e.value));return r.backgroundColor&&(i+="background-color: "+r.backgroundColor+";"),r.backgroundImage&&(i+="background-image: "+r.backgroundImage+";"),i}},{key:"_preprocessValueOrTextForCalculation",value:function(e){return this.decimalFormat.round(e)}},{key:"setBackgroundEffect",value:function(e){this.backgroundEffect!==e&&(this.backgroundEffect=e,this.backgroundEffectFunc=this._resolveBackgroundEffectFunc(),this.table.trigger("columnBackgroundEffectChanged",{column:this}),!this.backgroundEffect||null!==this.calcMinValue&&null!==this.calcMaxValue||this.calculateMinMaxValues(),this.backgroundEffect||(this.calcMinValue=null,this.calcMaxValue=null),this.table.rendered&&this._renderBackgroundEffect())}},{key:"updateBackgroundEffect",value:function(){this.calculateMinMaxValues(),this.table.rendered&&this._renderBackgroundEffect()}},{key:"_resolveBackgroundEffectFunc",value:function(){var e=this.backgroundEffect;return"colorGradient1"===e?this._colorGradient1.bind(this):"colorGradient2"===e?this._colorGradient2.bind(this):"barChart"===e?this._barChart.bind(this):null!==e?(s.a.log.warn("Unsupported backgroundEffect: "+e),function(){return{}}):void 0}},{key:"_renderBackgroundEffect",value:function(){this.table.visibleRows.forEach((function(e){if(e.$row){var t=this.cell(e),n=this.table.$cell(this,e.$row);void 0!==t.value&&(n[0].style.cssText=this._cellStyle(t))}}),this)}},{key:"calculateMinMaxValues",value:function(){for(var e,t,n,i,r=this.table.rows,o=0;o<r.length;o++)e=r[o],((i=this.cellValueOrTextForCalculation(e))<t||void 0===t)&&(t=i),(i>n||void 0===n)&&(n=i);this.calcMinValue=O.nvl(t,null),this.calcMaxValue=O.nvl(n,null)}},{key:"_colorGradient1",value:function(e){var t=$i.get("column-background-effect-gradient1-start","backgroundColor"),n=$i.get("column-background-effect-gradient1-end","backgroundColor"),i=$i.rgb(t.backgroundColor),r=$i.rgb(n.backgroundColor);return this._colorGradient(e,i,r)}},{key:"_colorGradient2",value:function(e){var t=$i.get("column-background-effect-gradient2-start","backgroundColor"),n=$i.get("column-background-effect-gradient2-end","backgroundColor"),i=$i.rgb(t.backgroundColor),r=$i.rgb(n.backgroundColor);return this._colorGradient(e,i,r)}},{key:"_colorGradient",value:function(e,t,n){var i=(e-this.calcMinValue)/(this.calcMaxValue-this.calcMinValue);return{backgroundColor:"rgb("+Math.ceil(t.red-i*(t.red-n.red))+","+Math.ceil(t.green-i*(t.green-n.green))+", "+Math.ceil(t.blue-i*(t.blue-n.blue))+")"}}},{key:"_barChart",value:function(e){var t=Math.ceil((e-this.calcMinValue)/(this.calcMaxValue-this.calcMinValue)*100)+"",n=$i.get("column-background-effect-bar-chart","backgroundColor").backgroundColor;return{backgroundImage:"linear-gradient(to left, "+n+" 0%, "+n+" "+t+"%, transparent "+t+"%, transparent 100% )"}}},{key:"_createEditor",value:function(){return O.create("NumberField",{parent:this.table,maxValue:this.maxValue,minValue:this.minValue,decimalFormat:this.decimalFormat})}},{key:"_hasCellValue",value:function(e){return!oi.isNullOrUndefined(e.value)}}])&&sF(t.prototype,n),i&&sF(t,i),o}(gD);function dF(e){return(dF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yF(e,t,n){return(yF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mF(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function vF(e,t){return(vF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mF(e);if(t){var r=mF(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gF(this,n)}}function gF(e,t){return!t||"object"!==dF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mF(e){return(mF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vF(e,t)}(o,e);var t,n,i,r=bF(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).codeType=null,e.lookupCall=null,e.browseHierarchy=!1,e.browseMaxRowCount=B0.DEFAULT_BROWSE_MAX_COUNT,e.browseAutoExpandAll=!0,e.browseLoadIncremental=!1,e.activeFilterEnabled=!1,e._lookupCallBatchContext=null,e}return t=o,(n=[{key:"_init",value:function(e){yF(mF(o.prototype),"_init",this).call(this,e),this._setLookupCall(this.lookupCall),this._setCodeType(this.codeType)}},{key:"setLookupCall",value:function(e){this.lookupCall!==e&&this._setLookupCall(e)}},{key:"_setLookupCall",value:function(e){this.lookupCall=ur.ensure(e,this.session)}},{key:"setCodeType",value:function(e){this.codeType!==e&&this._setCodeType(e)}},{key:"_setCodeType",value:function(e){this.codeType=e,e&&(this.lookupCall=O.create("CodeLookupCall",{session:this.session,codeType:e}))}},{key:"setBrowseHierarchy",value:function(e){this.browseHierarchy=e}},{key:"setBrowseMaxRowCount",value:function(e){this.browseMaxRowCount=e}},{key:"setBrowseAutoExpandAll",value:function(e){this.browseAutoExpandAll=e}},{key:"setBrowseLoadIncremental",value:function(e){this.browseLoadIncremental=e}},{key:"setActiveFilterEnabled",value:function(e){this.activeFilterEnabled=e}},{key:"_formatValue",value:function(e){return this.lookupCall?this.lookupCall.batch?this._batchFormatValue(e):this.lookupCall.textByKey(e):En.nvl(e)+""}},{key:"_batchFormatValue",value:function(e){if(oi.isNullOrUndefined(e))return $.resolvedPromise("");var t=this._lookupCallBatchContext;if(!t){var n=$.Deferred();t={keySet:{},result:n.promise()},this._lookupCallBatchContext=t,setTimeout(function(){this._lookupCallBatchContext=null,this.lookupCall.textsByKeys(Object.keys(t.keySet)).then((function(e){n.resolve(e)})).catch((function(e){n.reject(e)}))}.bind(this))}return t.keySet[e]=!0,t.result.then((function(t){return t[e]||""}))}},{key:"_initEditorField",value:function(e,t){if(oi.isNullOrUndefined(t.value))e.setValue(null);else{var n=new cr;n.key=t.value,n.text=t.text,e.setLookupRow(n)}}},{key:"_createEditor",value:function(e){var t=O.create("SmartField",{parent:this.table,codeType:this.codeType,lookupCall:this.lookupCall,browseHierarchy:this.browseHierarchy,browseMaxRowCount:this.browseMaxRowCount,browseAutoExpandAll:this.browseAutoExpandAll,browseLoadIncremental:this.browseLoadIncremental,activeFilterEnabled:this.activeFilterEnabled});return t.on("prepareLookupCall",function(t){this.trigger("prepareLookupCall",{lookupCall:t.lookupCall,row:e})}.bind(this)),t.on("lookupCallDone",function(e){this.trigger("lookupCallDone",{result:e.result})}.bind(this)),t}},{key:"_hasCellValue",value:function(e){var t=e.value;return oi.isNumber(t)?!oi.isNullOrUndefined(t):!!t}}])&&pF(t.prototype,n),i&&pF(t,i),o}(gD);function wF(e){return(wF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SF(e,t){return(SF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=CF(e);if(t){var r=CF(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return TF(this,n)}}function TF(e,t){return!t||"object"!==wF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CF(e){return(CF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SF(e,t)}(o,e);var t,n,i,r=OF(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).renderingHints.offset=6,t}return t=o,(n=[{key:"handle",value:function(e){this.field.toggle()}},{key:"_postRenderKeyBox",value:function(e){if(this.field.iconId){var t=e.find(".icon").width()/2-e.find(".key-box").outerWidth()/2+e.cssPaddingLeft();e.find(".key-box").cssLeft(t)}}}])&&kF(t.prototype,n),i&&kF(t,i),o}(Uh);function RF(e){return(RF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function EF(e,t,n){return(EF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$F(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function DF(e,t){return(DF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function FF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$F(e);if(t){var r=$F(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return AF(this,n)}}function AF(e,t){return!t||"object"!==RF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $F(e){return($F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jF(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var MF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DF(e,t)}(o,e);var t,n,i,r=FF(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).tableFooter=null,e.contentRendered=!1,e.height=null,e.animateDuration=null,e.resizerVisible=!0,e.toggleAction=!0,e.showTooltipWhenSelected=!1,e}return t=o,(n=[{key:"_init",value:function(e){this.parent=e.parent,this.table=this.getTable(),EF($F(o.prototype),"_init",this).call(this,e);var t=this.session.desktop.dense?"dense":null;o.CONTAINER_SIZE=$i.getSize("table-control-container","height","height",o.CONTAINER_SIZE,t),this.height=o.CONTAINER_SIZE,this.animateDuration=o.CONTAINER_ANIMATE_DURATION,this._setSelected(this.selected)}},{key:"_initKeyStrokeContext",value:function(){EF($F(o.prototype),"_initKeyStrokeContext",this).call(this),this.tableControlKeyStrokeContext=this._createKeyStrokeContextForTableControl()}},{key:"_createKeyStrokeContextForTableControl",value:function(){var e=new Ou;return e.$scopeTarget=function(){return this.tableFooter.$controlContent}.bind(this),e.$bindTarget=function(){return this.tableFooter.$controlContent}.bind(this),e.registerKeyStroke(new j$(this)),e}},{key:"_createLayout",value:function(){return new ya}},{key:"_render",value:function(){var e="table-control ";this.cssClass&&(e+=this.cssClass+"-table-control"),this.$container=this.$parent.appendDiv(e).on("mousedown",this._onMouseDown.bind(this)).data("control",this),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}},{key:"remove",value:function(){this.removeContent(),EF($F(o.prototype),"remove",this).call(this)}},{key:"_renderContent",value:function(e){}},{key:"_removeContent",value:function(){}},{key:"removeContent",value:function(){this.contentRendered&&(this._removeContent(),this.cssClass&&(this.tableFooter.$controlContainer.removeClass(this.cssClass+"-table-control-container"),this.tableFooter.$controlContent.removeClass(this.cssClass+"-table-control-content")),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.tableControlKeyStrokeContext),this.contentRendered=!1)}},{key:"renderContent",value:function(){(this.contentRendered||this.isContentAvailable())&&(this.tableFooter.open||this.tableFooter.openControlContainer(this),this.contentRendered||(this.cssClass&&(this.tableFooter.$controlContainer.addClass(this.cssClass+"-table-control-container"),this.tableFooter.$controlContent.addClass(this.cssClass+"-table-control-content")),this.tableFooter.$controlContent.data("control",this),this._renderContent(this.tableFooter.$controlContent),this.session.keyStrokeManager.installKeyStrokeContext(this.tableControlKeyStrokeContext),this.htmlComp&&this.htmlComp.invalidateLayoutTree(!1),this.contentRendered=!0))}},{key:"get$Scrollable",value:function(){return this.$contentContainer}},{key:"_renderSelected",value:function(e,t){e=O.nvl(e,this.selected),t=$.extend({},{closeWhenUnselected:!0},t),this.$container.select(e),e?(this.tableFooter.onControlSelected(this),this.renderContent()):this.rendered&&(t.closeWhenUnselected&&this===this.tableFooter.selectedControl?(this.tableFooter.onControlSelected(null),this.tableFooter.closeControlContainer(this,t)):this.removeContent()),this._updateTooltip()}},{key:"isContentAvailable",value:function(){return!0}},{key:"toggle",value:function(){this.enabledComputed&&(this.tableFooter.selectedControl===this?this.setSelected(!1):this.setSelected(!0))}},{key:"setSelected",value:function(e,t){e&&!this.visible||e!==this.selected&&(this.tableFooter&&this.tableFooter.selectedControl&&this.tableFooter.selectedControl!==this&&this.tableFooter.selectedControl.setSelected(!1,{closeWhenUnselected:!1}),this._setSelected(e),t=$.extend({},{closeWhenUnselected:!0},t),this.rendered?this._renderSelected(e,t):t.closeWhenUnselected&&this.tableFooter&&this===this.tableFooter.selectedControl&&!e&&this.tableFooter.onControlSelected(null))}},{key:"_setSelected",value:function(e){this._setProperty("selected",e)}},{key:"_configureTooltip",value:function(){var e=EF($F(o.prototype),"_configureTooltip",this).call(this);return e.cssClass="table-control-tooltip",e}},{key:"_onMouseDown",value:function(){this.toggle()}},{key:"onControlContainerOpened",value:function(){}},{key:"onControlContainerClosed",value:function(){this.removeContent()}},{key:"_createActionKeyStroke",value:function(){return new PF(this)}},{key:"getTable",value:function(){for(var e=this.parent;e;){if(e instanceof ZP)return e;e=e.parent}return null}}])&&xF(t.prototype,n),i&&xF(t,i),o}(Eh);function IF(e){return(IF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BF(e,t){return(BF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=VF(e);if(t){var r=VF(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return HF(this,n)}}function HF(e,t){return!t||"object"!==IF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function VF(e){return(VF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}jF(MF,"CONTAINER_SIZE",345),jF(MF,"CONTAINER_ANIMATE_DURATION",350);var WF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BF(e,t)}(o,e);var t,n,i,r=NF(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_goOffline",value:function(){this.widget.isContentAvailable()||(this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1))}},{key:"_goOnline",value:function(){this.widget.isContentAvailable()||this.widget.setEnabled(this._enabledBeforeOffline)}}])&&LF(t.prototype,n),i&&LF(t,i),o}(Lh);function zF(e){return(zF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function UF(e,t,n){return(UF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=JF(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function KF(e,t){return(KF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=JF(e);if(t){var r=JF(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return YF(this,n)}}function YF(e,t){return!t||"object"!==zF(t)&&"function"!=typeof t?XF(e):t}function XF(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JF(e){return(JF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ZF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KF(e,t)}(o,e);var t,n,i,r=qF(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._tableControlPropertyChangeHandler=e._onTableControlPropertyChange.bind(XF(e)),e._tableControlDestroyHandler=e._onTableControlDestroy.bind(XF(e)),e._addCloneProperties(["tableControl"]),e}return t=o,i=[{key:"adaptTableControlProperties",value:function(e,t){for(var n in t=t||{},["text","iconId","enabled","visible","selected","tooltipText","keyStroke","keyStrokes","modelClass","classId","form"].forEach((function(n){t[n]=e[n]})),t)void 0===t[n]&&delete t[n];return t}}],(n=[{key:"_init",value:function(e){if(UF(JF(o.prototype),"_init",this).call(this,e),!this.tableControl)throw new Error("Cannot adapt to undefined tableControl");this._installListeners()}},{key:"_installListeners",value:function(){this.tableControl.on("propertyChange",this._tableControlPropertyChangeHandler),this.tableControl.on("destroy",this._tableControlDestroyHandler)}},{key:"_uninstallListeners",value:function(){this.tableControl.off("propertyChange",this._tableControlPropertyChangeHandler),this.tableControl.off("destroy",this._tableControlDestroyHandler)}},{key:"_render",value:function(){UF(JF(o.prototype),"_render",this).call(this),this.$container.attr("data-tableControlAdapter",this.tableControl.id)}},{key:"_onTableControlPropertyChange",value:function(e){var t={};for(var n in t[e.propertyName]=e.newValue,t=o.adaptTableControlProperties(t))this.setProperty(n,t[n])}},{key:"_onTableControlDestroy",value:function(e){this.destroy(),this._uninstallListeners()}},{key:"doAction",value:function(){return this.tableControl.doAction()}},{key:"setSelected",value:function(e){this.tableControl.setSelected(e)}}])&&GF(t.prototype,n),i&&GF(t,i),o}(jT);function QF(e){return(QF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tA(e,t,n){return(tA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sA(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function nA(e,t){return(nA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=sA(e);if(t){var r=sA(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rA(this,n)}}function rA(e,t){return!t||"object"!==QF(t)&&"function"!=typeof t?oA(e):t}function oA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sA(e){return(sA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var aA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nA(e,t)}(o,e);var t,n,i,r=iA(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._tableDataScrollHandler=e._onTableDataScroll.bind(oA(e)),e._tableColumnResizedHandler=e._onTableColumnResized.bind(oA(e)),e._tableColumnMovedHandler=e._onTableColumnMoved.bind(oA(e)),e._tableColumnStructureChangedHandler=e._onTableColumnStructureChanged.bind(oA(e)),e._tableChangedHandler=e._onTableChanged.bind(oA(e)),e._aggregationFunctionChangedHandler=e._onAggregationFunctionChanged.bind(oA(e)),e.animateDuration=o.CONTAINER_ANIMATE_DURATION,e.aggregateRow=[],e.cssClass="aggregate",e.height=0,e.iconId=sn.SUM,e.tooltipText="${textKey:ui.Total}",e.resizerVisible=!1,e}return t=o,(n=[{key:"_init",value:function(e){tA(sA(o.prototype),"_init",this).call(this,e),this.table.on("columnStructureChanged",this._tableColumnStructureChangedHandler),this.table.on("aggregationFunctionChanged",this._aggregationFunctionChangedHandler)}},{key:"_destroy",value:function(){tA(sA(o.prototype),"_destroy",this).call(this),this.table.off("columnStructureChanged",this._tableColumnStructureChangedHandler),this.table.off("aggregationFunctionChanged",this._aggregationFunctionChangedHandler)}},{key:"_render",value:function(){tA(sA(o.prototype),"_render",this).call(this),this._updateEnabledAndSelectedState(),this.height=this.table.rowHeight+No.insets(this.table.footer.$controlContainer).vertical()}},{key:"_renderContent",value:function(e){this.$contentContainer=e.appendDiv("table-aggregate"),this._aggregate(),this._renderAggregate(),this._reconcileScrollPos(),this.table.$data.on("scroll",this._tableDataScrollHandler),this.table.on("columnResized",this._tableColumnResizedHandler),this.table.on("columnMoved",this._tableColumnMovedHandler),this.table.on("rowsSelected rowsInserted rowsUpdated rowsDeleted filter group allRowsDeleted",this._tableChangedHandler)}},{key:"_removeContent",value:function(){this.$contentContainer.remove(),this.table.$data.off("scroll",this._tableDataScrollHandler),this.table.off("columnResized",this._tableColumnResizedHandler),this.table.off("columnMoved",this._tableColumnMovedHandler),this.table.off("rowsSelected rowsInserted rowsUpdated rowsDeleted filter group allRowsDeleted",this._tableChangedHandler)}},{key:"_renderAggregate",value:function(){this.table.visibleColumns().forEach((function(e,t){var n,i,r;i=null==(n=this.aggregateRow[t])||e.grouped?e.createAggrEmptyCell():e.createAggrValueCell(n),r=s()(e.buildCell(i,{})),this._installCellTooltip(r),this.aggregateRow.selection&&r.addClass("selection"),r.appendTo(this.$contentContainer),r.isContentTruncated()&&r.children(".table-cell-icon").setVisible(!1)}),this),this.aggregateRow.selection&&this.$contentContainer.addClass("selection")}},{key:"_rerenderAggregate",value:function(){this.$contentContainer.empty(),this._renderAggregate()}},{key:"_installCellTooltip",value:function(e){dh.install(e,{parent:this,text:this._cellTooltipText.bind(this),htmlEnabled:!0,arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Mt.get().isCustomEllipsisTooltipPossible()})}},{key:"_cellTooltipText",value:function(e){return e.text().trim()&&(e.isContentTruncated()||e.children(".table-cell-icon").length&&!e.children(".table-cell-icon").isVisible())?((e=e.clone()).children(".table-cell-icon").setVisible(!0),e.html()):null}},{key:"_aggregate",value:function(){var e,t=[],n=this.table.selectedRows;n.length>1?(e=n,t.selection=!0):e=this.table.filteredRows(),this.table._forEachVisibleColumn("aggrStart",t),e.forEach((function(e){this.table._forEachVisibleColumn("aggrStep",t,e)}),this),this.table._forEachVisibleColumn("aggrFinish",t),this.aggregateRow=t,this.contentRendered&&this.selected&&this._rerenderAggregate()}},{key:"_reconcileScrollPos",value:function(){var e=this.table.$data.scrollLeft();this.$contentContainer.scrollLeft(e)}},{key:"_updateEnabledAndSelectedState",value:function(e){if(this.initialized){var t=this.table.containsAggregatedNumberColumn();t?e&&!this.table.isGrouped()&&this.setSelected(!0):this.selected&&this.setSelected(!1),this.setEnabled(t)}}},{key:"_setEnabled",value:function(e){tA(sA(o.prototype),"_setEnabled",this).call(this,e),this._updateEnabledAndSelectedState()}},{key:"_setSelected",value:function(e){this._setProperty("selected",e),this._updateEnabledAndSelectedState()}},{key:"_onTableDataScroll",value:function(){this._reconcileScrollPos()}},{key:"_onTableChanged",value:function(){this._aggregate()}},{key:"_onAggregationFunctionChanged",value:function(){this._updateEnabledAndSelectedState(!0),this.contentRendered&&this.selected&&this._aggregate()}},{key:"_onTableColumnResized",value:function(){this._rerenderAggregate()}},{key:"_onTableColumnMoved",value:function(e){et.move(this.aggregateRow,e.oldPos,e.newPos),this._rerenderAggregate()}},{key:"_onTableColumnStructureChanged",value:function(){this._updateEnabledAndSelectedState(),this.contentRendered&&this.selected&&this._aggregate()}}])&&eA(t.prototype,n),i&&eA(t,i),o}(MF);function uA(e){return(uA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cA(e,t){return(cA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=dA(e);if(t){var r=dA(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return hA(this,n)}}function hA(e,t){return!t||"object"!==uA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dA(e){return(dA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(aA,"CONTAINER_ANIMATE_DURATION",200);var pA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cA(e,t)}(o,e);var t,n,i,r=fA(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,i=[{key:"modifyAggregateTableControlPrototype",value:function(){x.get().remote&&oi.replacePrototypeFunction(aA,"_onTableColumnStructureChanged",(function(e){this.modelAdapter?this._updateEnabledAndSelectedState():this._onTableColumnStructureChangedOrig()}),!0)}}],(n=null)&&lA(t.prototype,n),i&&lA(t,i),o}(WF);function yA(e){return(yA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bA(e,t,n){return(bA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kA(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function gA(e,t){return(gA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=kA(e);if(t){var r=kA(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _A(this,n)}}function _A(e,t){return!t||"object"!==yA(t)&&"function"!=typeof t?wA(e):t}function wA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kA(e){return(kA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}x.addListener("bootstrap",pA.modifyAggregateTableControlPrototype);var SA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gA(e,t)}(o,e);var t,n,i,r=mA(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties("form"),e._formDestroyedHandler=e._onFormDestroyed.bind(wA(e)),e}return t=o,(n=[{key:"_init",value:function(e){bA(kA(o.prototype),"_init",this).call(this,e),this._setForm(this.form)}},{key:"_createLayout",value:function(){return new MA(this)}},{key:"_renderContent",value:function(e){this.form.renderInitialFocusEnabled=!1,this.form.render(e);var t=this.form.rootGroupBox;t.controls[0]instanceof G5&&t.controls[0].$container.addClass("in-table-control"),this.form.$container.height(e.height()),this.form.$container.width(e.width()),this.form.htmlComp.validateRoot=!0,this.form.htmlComp.validateLayout()}},{key:"_removeContent",value:function(){this.form&&this.form.remove()}},{key:"_removeForm",value:function(){this.removeContent()}},{key:"_renderForm",value:function(e){this.renderContent()}},{key:"isContentAvailable",value:function(){return!!this.form}},{key:"_setForm",value:function(e){this.form&&this.form.off("destroy",this._formDestroyedHandler),e&&(e.on("destroy",this._formDestroyedHandler),this._adaptForm(e)),this._setProperty("form",e)}},{key:"_adaptForm",value:function(e){e.rootGroupBox.setMenuBarPosition(rY.MenuBarPosition.BOTTOM),e.setDisplayHint(ZO.DisplayHint.VIEW),e.setModal(!1),e.setAskIfNeedSave(!1),this.session.userAgent.deviceType!==Mt.Type.MOBILE&&e.rootGroupBox.fieldStyle===GH.FieldStyle.ALTERNATIVE&&e.rootGroupBox.setFieldStyle(GH.FieldStyle.CLASSIC)}},{key:"onControlContainerOpened",value:function(){this.form.rendered&&this.form.renderInitialFocus()}},{key:"_onFormDestroyed",value:function(e){this._removeForm(),this._setForm(null)}}])&&vA(t.prototype,n),i&&vA(t,i),o}(MF);function OA(e){return(OA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TA(e,t){return(TA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function CA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=RA(e);if(t){var r=RA(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return PA(this,n)}}function PA(e,t){return!t||"object"!==OA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RA(e){return(RA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TA(e,t)}(n,e);var t=CA(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(WF);function EA(e){return(EA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function FA(e,t){return(FA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=jA(e);if(t){var r=jA(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $A(this,n)}}function $A(e,t){return!t||"object"!==EA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jA(e){return(jA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FA(e,t)}(o,e);var t,n,i,r=AA(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).control=e,t}return t=o,(n=[{key:"layout",value:function(e){if(this.control.contentRendered&&this.control.form){var t=this.control.form,n=t.htmlComp,i=No.size(this.control.tableFooter.$controlContent).subtract(n.margins());if(n.setSize(i),t.rootGroupBox.controls[0]instanceof G5){var r=t.rootGroupBox.controls[0].selectedTab;r&&r.scrollable&&document.activeElement&&r.$body.has(document.activeElement)&&wf.scrollTo(r.$body,s()(document.activeElement))}}}}])&&DA(t.prototype,n),i&&DA(t,i),o}(zo);function IA(e){return(IA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BA(e,t,n){return(BA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zA(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function NA(e,t){return(NA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function HA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zA(e);if(t){var r=zA(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return VA(this,n)}}function VA(e,t){return!t||"object"!==IA(t)&&"function"!=typeof t?WA(e):t}function WA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zA(e){return(zA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var GA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NA(e,t)}(o,e);var t,n,i,r=HA(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).table=null,e.column=null,e.row=null,e.cell=null,e._pendingCompleteCellEdit=null,e._keyStrokeHandler=e._onKeyStroke.bind(WA(e)),e}return t=o,(n=[{key:"_init",value:function(e){e.scrollType=e.scrollType||"position",BA(zA(o.prototype),"_init",this).call(this,e),this.table=e.column.table,this.link(this.cell.field)}},{key:"_createLayout",value:function(){return new ZA(this)}},{key:"_initKeyStrokeContext",value:function(){BA(zA(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new h$(this),new _$(this)])}},{key:"_createCloseKeyStroke",value:function(){return new o$(this)}},{key:"_open",value:function(e,t){this.render(e,t),this.position(),this.pack()}},{key:"_render",value:function(){BA(zA(o.prototype),"_render",this).call(this);var e="",t=this.table.visibleColumns(),n=t.indexOf(this.column);0===n?e="first":n===t.length-1&&(e="last"),this.$container.addClass("cell-editor-popup "+e).data("popup",this);var i=this.cell.field;i.mode=GH.Mode.CELLEDITOR,i.render(),i.prepareForCellEdit({cssClass:e}),this.$anchor.css("visibility","hidden"),this._rowOrderChangedFunc=function(e){e.animating?e.row===this.row&&this.position():this.position()}.bind(this),this.table.on("rowOrderChanged",this._rowOrderChangedFunc),this.table.enabled&&this.table.$container.addClass("focused"),this.session.keyStrokeManager.on("keyStroke",this._keyStrokeHandler)}},{key:"_postRender",value:function(){BA(zA(o.prototype),"_postRender",this).call(this);var e=this.cell.field;e.onCellEditorRendered&&e.onCellEditorRendered({openFieldPopup:this.table.openFieldPopupOnCellEdit,cellEditorPopup:this})}},{key:"_remove",value:function(){BA(zA(o.prototype),"_remove",this).call(this),this.session.keyStrokeManager.off("keyStroke",this._keyStrokeHandler),this.table.off("rowOrderChanged",this._rowOrderChangedFunc),this.table.rendered&&this.table.$container.removeClass("focused"),this.$anchor.css("visibility","")}},{key:"position",value:function(){var e,t,n=this.table.$data,i=this.row.$row,r=this.$anchor,o=n.cssPxValue("padding-left")+i.cssBorderLeftWidth();(e=No.bounds(r)).x+=r.cssMarginX(),(t=No.bounds(i)).y+=i.cssMarginY(),this.setLocation(new Eo(o+e.x,n.scrollTop()+t.y))}},{key:"completeEdit",value:function(e){if(this._pendingCompleteCellEdit)return this._pendingCompleteCellEdit;var t=this.cell.field.acceptInput();return t&&O.nvl(e,!0)?this._pendingCompleteCellEdit=t.then(function(){this.table.completeCellEdit()}.bind(this)):(this._pendingCompleteCellEdit=s.a.resolvedPromise(),this.table.completeCellEdit()),this._pendingCompleteCellEdit.then(function(){this._pendingCompleteCellEdit=null}.bind(this)),this._pendingCompleteCellEdit}},{key:"isCompleteCellEditRequested",value:function(){return!!this._pendingCompleteCellEdit}},{key:"cancelEdit",value:function(){this.table.cancelCellEdit(),this.remove()}},{key:"_onMouseDownOutside",value:function(e){this.completeEdit()}},{key:"_onKeyStroke",value:function(e){this.session.keyStrokeManager.invokeAcceptInputOnActiveValueField(e.keyStroke,e.keyStrokeContext)&&(this.$container.isOrHas(e.keyStrokeContext.$getScopeTarget())||this.completeEdit(!1))}},{key:"waitForCompleteCellEdit",value:function(){return this._pendingCompleteCellEdit?this._pendingCompleteCellEdit.promise():s.a.resolvedPromise()}}])&&LA(t.prototype,n),i&&LA(t,i),o}(kd);function UA(e){return(UA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qA(e,t){return(qA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=JA(e);if(t){var r=JA(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return XA(this,n)}}function XA(e,t){return!t||"object"!==UA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function JA(e){return(JA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ZA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qA(e,t)}(o,e);var t,n,i,r=YA(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).cellEditorPopup=e,t._field=e.cell.field,t._htmlContainer=e.htmlComp,t}return t=o,(n=[{key:"layout",value:function(e){var t,n=this._field.htmlComp;t=this._htmlContainer.availableSize({exact:!0}).subtract(this._htmlContainer.insets()).subtract(n.margins()),n.setSize(t)}},{key:"preferredLayoutSize",value:function(e){var t,n,i,r=this.cellEditorPopup.row.$row,o=this.cellEditorPopup.$anchor;return(t=No.bounds(o,{exact:!0})).x+=o.cssMarginX(),(n=No.bounds(r,{exact:!0})).y+=r.cssMarginY(),(i=this.cellEditorPopup.$container.cssMarginLeft())<0&&(t.width=t.width+-i),new Co(t.width,n.height)}}])&&KA(t.prototype,n),i&&KA(t,i),o}(zo);function QA(e){return(QA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e$(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t$(e,t){return(t$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=r$(e);if(t){var r=r$(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return i$(this,n)}}function i$(e,t){return!t||"object"!==QA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r$(e){return(r$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var o$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&t$(e,t)}(o,e);var t,n,i,r=n$(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ESC],t.stopPropagation=!0,t}return t=o,(n=[{key:"handle",value:function(e){this.field.cancelEdit()}}])&&e$(t.prototype,n),i&&e$(t,i),o}($u);function s$(e){return(s$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a$(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u$(e,t){return(u$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=f$(e);if(t){var r=f$(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c$(this,n)}}function c$(e,t){return!t||"object"!==s$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f$(e){return(f$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u$(e,t)}(o,e);var t,n,i,r=l$(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ENTER],t.stopPropagation=!0,t}return t=o,(n=[{key:"handle",value:function(e){this.field.completeEdit()}}])&&a$(t.prototype,n),i&&a$(t,i),o}($u);function d$(e){return(d$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p$(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function y$(e,t,n){return(y$="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m$(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function v$(e,t){return(v$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=m$(e);if(t){var r=m$(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g$(this,n)}}function g$(e,t){return!t||"object"!==d$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m$(e){return(m$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v$(e,t)}(o,e);var t,n,i,r=b$(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.TAB],t.shift=void 0,t}return t=o,(n=[{key:"_accept",value:function(e){return y$(m$(o.prototype),"_accept",this).call(this,e)&&!this.field.isCompleteCellEditRequested()}},{key:"handle",value:function(e){var t,n=e.shiftKey,i=this.field.table,r=this.field.column,o=this.field.row;this.field.completeEdit().then((function(){(t=i.nextEditableCellPos(r,o,n))&&i.prepareCellEdit(t.column,t.row)}))}}])&&p$(t.prototype,n),i&&p$(t,i),o}($u);function w$(e){return(w$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k$(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function S$(e,t,n){return(S$="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P$(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function O$(e,t){return(O$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=P$(e);if(t){var r=P$(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return C$(this,n)}}function C$(e,t){return!t||"object"!==w$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P$(e){return(P$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O$(e,t)}(o,e);var t,n,i,r=T$(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).repeatable=!0,t.field=e,t.shift=!!e.multiSelect&&void 0,t.stopPropagation=!0,t.keyStrokeMode=$u.Mode.DOWN,t}return t=o,(n=[{key:"_accept",value:function(e){if(!S$(P$(o.prototype),"_accept",this).call(this,e))return!1;if(!this.field.visibleRows.length)return!1;var t=this.field.$container.activeElement(!0),n=t.tagName.toLowerCase();return!!("table-text-filter"===t.className||"textarea"!==n&&"input"!==n||e.originalEvent&&(!e.originalEvent||e.originalEvent.smartFieldEvent))}},{key:"_viewportInfo",value:function(){var e,t,n,i,r,o=this.field,s={},a=o.visibleRows;return 0===a.length||(e=No.offsetBounds(o.$data),t=No.insets(o.$data),n=o.$data.cssMarginTop(),e=e.subtract(t),n<0&&(e.y-=Math.abs(n),e.height+=Math.abs(n)),i=this._findFirstRowInViewport(o,e),r=this._findLastRowInViewport(o,a.indexOf(i),e),s.firstRow=i,s.lastRow=r),s}},{key:"firstRowAfterSelection",value:function(){var e=this.field.$selectedRows();if(e.length){var t=this.field.visibleRows,n=e.last().data("row");return t[this.field.filteredRows().indexOf(n)+1]}}},{key:"firstRowBeforeSelection",value:function(){var e=this.field.$selectedRows();if(e.length){var t=this.field.visibleRows,n=e.first().data("row");return t[this.field.visibleRows.indexOf(n)-1]}}},{key:"_findLastSelectedRowBefore",value:function(e,t){var n,i=e.visibleRows;return 0===t?i[t]:((n=et.findFromReverse(i,t,(function(t,n){var r=i[n-1];return!!r&&!e.isRowSelected(r)})))||(n=i[0]),n)}},{key:"_findLastSelectedRowAfter",value:function(e,t){var n,i=e.visibleRows;return t===i.length-1?i[t]:((n=et.findFrom(i,t,(function(t,n){var r=i[n+1];return!!r&&!e.isRowSelected(r)})))||(n=i[i.length-1]),n)}},{key:"_findFirstRowInViewport",value:function(e,t){var n=e.visibleRows;return et.find(n,(function(e,n){var i,r,o=e.$row;return!!e.$row&&(i=o.offset(),(r=e.$row.cssMarginTop())<0&&(i.top+=Math.abs(r)),t.contains(i.left,i.top))}))}},{key:"_findLastRowInViewport",value:function(e,t,n){var i=e.visibleRows;return t===i.length-1?i[t]:et.findFromForward(i,t,(function(e,t){var r,o,s=i[t+1];return!s||!(o=s.$row)||(r=No.offsetBounds(o),!n.contains(r.x,r.y+r.height-1))}))}},{key:"_isEnabled",value:function(){return!this.field.tileMode}}])&&k$(t.prototype,n),i&&k$(t,i),o}($u);function x$(e){return(x$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E$(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function D$(e,t){return(D$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$$(e);if(t){var r=$$(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return A$(this,n)}}function A$(e,t){return!t||"object"!==x$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $$(e){return($$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D$(e,t)}(o,e);var t,n,i,r=F$(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ESC],t.stopPropagation=!0,t.renderingHints.render=!1,t}return t=o,(n=[{key:"handle",value:function(e){this.field.toggle()}}])&&E$(t.prototype,n),i&&E$(t,i),o}($u);function M$(e){return(M$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I$(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function L$(e,t){return(L$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=H$(e);if(t){var r=H$(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return N$(this,n)}}function N$(e,t){return!t||"object"!==M$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H$(e){return(H$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var V$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L$(e,t)}(o,e);var t,n,i,r=B$(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.C],t.ctrl=!0,t.renderingHints.render=!1,t}return t=o,(n=[{key:"handle",value:function(e){this.field.exportToClipboard()}}])&&I$(t.prototype,n),i&&I$(t,i),o}($u);function W$(e){return(W$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z$(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function G$(e,t,n){return(G$="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=X$(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function U$(e,t){return(U$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=X$(e);if(t){var r=X$(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return q$(this,n)}}function q$(e,t){return!t||"object"!==W$(t)&&"function"!=typeof t?Y$(e):t}function Y$(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X$(e){return(X$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var J$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U$(e,t)}(o,e);var t,n,i,r=K$(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).field=e,t.which=[pu.SUBTRACT,pu.LEFT],t.renderingHints.text="-",t.renderingHints.$drawingArea=function(e,t){var n=this.field.selectedRows[0];if(n)return n.$row}.bind(Y$(t)),t}return t=o,(n=[{key:"_accept",value:function(e){var t=G$(X$(o.prototype),"_accept",this).call(this,e),n=this.field.selectedRows[0];return!!(t&&n&&(n.expanded&&n._expandable||n.parentRow))}},{key:"handle",value:function(e){var t=this.field,n=this.field.selectedRows[0];n&&(n.expanded&&n._expandable?t.collapseRow(n):n.parentRow&&(t.selectRow(n.parentRow),t.selectionHandler.lastActionRow=n.parentRow))}}])&&z$(t.prototype,n),i&&z$(t,i),o}(R$);function Z$(e){return(Z$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q$(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ej(e,t,n){return(ej="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oj(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function tj(e,t){return(tj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oj(e);if(t){var r=oj(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ij(this,n)}}function ij(e,t){return!t||"object"!==Z$(t)&&"function"!=typeof t?rj(e):t}function rj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oj(e){return(oj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tj(e,t)}(o,e);var t,n,i,r=nj(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).field=e,t.which=[pu.ADD,pu.RIGHT],t.renderingHints.text="+",t.renderingHints.$drawingArea=function(e,t){var n=this.field.selectedRows[0];if(n)return n.$row}.bind(rj(t)),t}return t=o,(n=[{key:"_accept",value:function(e){var t=ej(oj(o.prototype),"_accept",this).call(this,e),n=this.field.selectedRows[0];return!!t&&!!n&&n._expandable}},{key:"handle",value:function(e){var t,n=this.field,i=this.field.selectedRows[0];i&&i._expandable&&(i.expanded?(t=this.field.visibleChildRows(i),n.selectRow(t[0]),n.selectionHandler.lastActionRow=t[0]):n.expandRow(i))}}])&&Q$(t.prototype,n),i&&Q$(t,i),o}(R$);function aj(e){return(aj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lj(e,t){return(lj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=dj(e);if(t){var r=dj(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fj(this,n)}}function fj(e,t){return!t||"object"!==aj(t)&&"function"!=typeof t?hj(e):t}function hj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dj(e){return(dj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lj(e,t)}(o,e);var t,n,i,r=cj(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.ctrl=!0,t.which=[pu.A],t.renderingHints.offset=14,t.renderingHints.$drawingArea=function(e,t){return this.field.footer?this.field.footer._$infoSelection.find(".table-info-button"):null}.bind(hj(t)),t}return t=o,(n=[{key:"handle",value:function(e){var t=this.field;t.toggleSelection(),t.selectionHandler.lastActionRow=null}}])&&uj(t.prototype,n),i&&uj(t,i),o}($u);function yj(e){return(yj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bj(e,t,n){return(bj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kj(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function gj(e,t){return(gj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=kj(e);if(t){var r=kj(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _j(this,n)}}function _j(e,t){return!t||"object"!==yj(t)&&"function"!=typeof t?wj(e):t}function wj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kj(e){return(kj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gj(e,t)}(o,e);var t,n,i,r=mj(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.ctrl=!0,t.which=[pu.ENTER],t.stopPropagation=!0,t.renderingHints.$drawingArea=function(e,t){var n=t._editPosition,i=this.field.visibleColumns().indexOf(n.column);return 0===i?n.row.$row:this.field.$cell(i,n.row.$row)}.bind(wj(t)),t}return t=o,(n=[{key:"_accept",value:function(e){if(!bj(kj(o.prototype),"_accept",this).call(this,e))return!1;if(this.field.cellEditorPopup)return!1;var t=this.field.selectedRows;if(!t.length)return!1;var n=this.field.nextEditableCellPosForRow(0,t[0]);return!!n&&(e._editPosition=n,!0)}},{key:"handle",value:function(e){var t=e._editPosition;this.field.prepareCellEdit(t.column,t.row,!0)}}])&&vj(t.prototype,n),i&&vj(t,i),o}($u);function Oj(e){return(Oj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cj(e,t,n){return(Cj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dj(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Pj(e,t){return(Pj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Dj(e);if(t){var r=Dj(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xj(this,n)}}function xj(e,t){return!t||"object"!==Oj(t)&&"function"!=typeof t?Ej(e):t}function Ej(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dj(e){return(Dj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pj(e,t)}(o,e);var t,n,i,r=Rj(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.F5],t.renderingHints.offset=14,t.renderingHints.$drawingArea=function(e,t){return this.field.footer?this.field.footer._$infoLoad.find(".table-info-button"):null}.bind(Ej(t)),t}return t=o,(n=[{key:"_accept",value:function(e){return Cj(Dj(o.prototype),"_accept",this).call(this,e)&&this.field.hasReloadHandler}},{key:"handle",value:function(e){this.field.reload()}}])&&Tj(t.prototype,n),i&&Tj(t,i),o}($u);function Aj(e){return(Aj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $j(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jj(e,t,n){return(jj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bj(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Mj(e,t){return(Mj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ij(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Bj(e);if(t){var r=Bj(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Lj(this,n)}}function Lj(e,t){return!t||"object"!==Aj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bj(e){return(Bj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mj(e,t)}(o,e);var t,n,i,r=Ij(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.SPACE],t.stopPropagation=!0,t.renderingHints.render=!1,t}return t=o,(n=[{key:"_accept",value:function(e){return jj(Bj(o.prototype),"_accept",this).call(this,e)&&this.field.checkable&&this.field.selectedRows.length}},{key:"handle",value:function(e){var t=this.field.selectedRows.filter((function(e){return e.enabled})),n=t.some((function(e){return!e.checked}));t.forEach((function(e){this.field.checkRow(e,n)}),this)}}])&&$j(t.prototype,n),i&&$j(t,i),o}($u);function Hj(e){return(Hj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wj(e,t){return(Wj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Kj(e);if(t){var r=Kj(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gj(this,n)}}function Gj(e,t){return!t||"object"!==Hj(t)&&"function"!=typeof t?Uj(e):t}function Uj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kj(e){return(Kj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wj(e,t)}(o,e);var t,n,i,r=zj(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).which=[pu.UP],t.renderingHints.text="↑",t.renderingHints.$drawingArea=function(e,t){var n=this.firstRowBeforeSelection();if(n)return n.$row}.bind(Uj(t)),t}return t=o,(n=[{key:"handle",value:function(e){var t,n,i=this.field,r=i.visibleRows,o=i.selectedRows,s=i.selectionHandler.lastActionRow,a=-1,u=-1;if(s&&(a=r.indexOf(s)),r.length>1&&(o.length>0||a>-1)){if(a<0&&(s=r.length===o.length?et.last(r):et.first(o),a=r.indexOf(s)),0===a)return;if(t=[n=r[u=a-1]],e.shiftKey)if(i.isRowSelected(n)){t=[],et.pushAll(t,o);var l=i.selectionHandler.getMinMaxSelectionIndizes();O.isOneOf(a,l[0],l[1])&&et.remove(t,s)}else t=et.union(t,o),n=this._findLastSelectedRowBefore(i,u)}else n=(t=[et.last(r)])[0];i.selectionHandler.lastActionRow=n,i.selectRows(t,!0),i.scrollTo(n)}}])&&Vj(t.prototype,n),i&&Vj(t,i),o}(R$);function Yj(e){return(Yj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jj(e,t){return(Jj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=tM(e);if(t){var r=tM(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Qj(this,n)}}function Qj(e,t){return!t||"object"!==Yj(t)&&"function"!=typeof t?eM(e):t}function eM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tM(e){return(tM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jj(e,t)}(o,e);var t,n,i,r=Zj(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).which=[pu.DOWN],t.renderingHints.text="↓",t.renderingHints.$drawingArea=function(e,t){var n=this.firstRowAfterSelection();if(n)return n.$row}.bind(eM(t)),t}return t=o,(n=[{key:"handle",value:function(e){var t,n,i=this.field,r=i.visibleRows,o=i.selectedRows,s=i.selectionHandler.lastActionRow,a=-1,u=-1;if(s&&(a=r.indexOf(s)),r.length>1&&(o.length>0||a>-1)){if(a<0&&(s=r.length===o.length?et.first(r):et.last(o),a=r.indexOf(s)),a===r.length-1)return;if(t=[n=r[u=a+1]],e.shiftKey)if(i.isRowSelected(n)){t=[],et.pushAll(t,o);var l=i.selectionHandler.getMinMaxSelectionIndizes();O.isOneOf(a,l[0],l[1])&&et.remove(t,s)}else t=et.union(o,t),n=this._findLastSelectedRowAfter(i,u)}else n=(t=[et.first(r)])[0];i.selectionHandler.lastActionRow=n,i.selectRows(t,!0),i.scrollTo(n)}}])&&Xj(t.prototype,n),i&&Xj(t,i),o}(R$);function iM(e){return(iM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oM(e,t){return(oM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=lM(e);if(t){var r=lM(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return aM(this,n)}}function aM(e,t){return!t||"object"!==iM(t)&&"function"!=typeof t?uM(e):t}function uM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lM(e){return(lM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oM(e,t)}(o,e);var t,n,i,r=sM(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).which=[pu.HOME],t.renderingHints.text="Home",t.renderingHints.$drawingArea=function(e,t){var n=this._viewportInfo();if(n.firstRow)return n.firstRow.$row}.bind(uM(t)),t}return t=o,(n=[{key:"handle",value:function(e){var t=this.field,n=t.visibleRows,i=et.first(n),r=t.selectedRows,o=[],s=t.selectionHandler.lastActionRow,a=-1;e.shiftKey&&r.length>0?(s&&(a=n.indexOf(s)),a<0&&(s=et.first(r),a=n.indexOf(s)),o=n.slice(0,a),o=et.union(o,r)):o=i,t.selectionHandler.lastActionRow=i,t.selectRows(o),t.scrollTo(i)}}])&&rM(t.prototype,n),i&&rM(t,i),o}(R$);function fM(e){return(fM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dM(e,t){return(dM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=bM(e);if(t){var r=bM(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return yM(this,n)}}function yM(e,t){return!t||"object"!==fM(t)&&"function"!=typeof t?vM(e):t}function vM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bM(e){return(bM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dM(e,t)}(o,e);var t,n,i,r=pM(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).which=[pu.END],t.renderingHints.text="End",t.renderingHints.$drawingArea=function(e,t){var n=this._viewportInfo();if(n.lastRow)return n.lastRow.$row}.bind(vM(t)),t}return t=o,(n=[{key:"handle",value:function(e){var t=this.field,n=t.visibleRows,i=et.last(n),r=t.selectedRows,o=[],s=t.selectionHandler.lastActionRow,a=-1;e.shiftKey&&r.length>0?(s&&(a=n.indexOf(s)),a<0&&(s=et.last(r),a=n.indexOf(s)),o=n.slice(a+1,n.length),o=et.union(r,o)):o=i,t.selectionHandler.lastActionRow=i,t.selectRows(o),t.scrollTo(i)}}])&&hM(t.prototype,n),i&&hM(t,i),o}(R$);function mM(e){return(mM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _M(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wM(e,t){return(wM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=TM(e);if(t){var r=TM(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return SM(this,n)}}function SM(e,t){return!t||"object"!==mM(t)&&"function"!=typeof t?OM(e):t}function OM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TM(e){return(TM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wM(e,t)}(o,e);var t,n,i,r=kM(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).which=[pu.PAGE_UP],t.renderingHints.text="PgUp",t.renderingHints.$drawingArea=function(e,t){var n=this._viewportInfo();if(n.firstRow)return n.firstRow.$row}.bind(OM(t)),t}return t=o,(n=[{key:"handle",value:function(e){var t,n=this.field,i=this._viewportInfo(),r=n.visibleRows,o=n.selectedRows,s=et.first(o),a=n.selectionHandler.lastActionRow,u=-1;(i.firstRow||(n.scrollPageUp(),(i=this._viewportInfo()).firstRow))&&(a&&(u=r.indexOf(a)),u<0&&(a=s,u=r.indexOf(a)),(!(o.length>0&&a===i.firstRow)||o.length>1&&!e.shiftKey||(n.scrollPageUp(),(i=this._viewportInfo()).firstRow))&&(e.shiftKey&&o.length>0?(t=r.slice(r.indexOf(i.firstRow),u),t=et.union(o,t)):t=[i.firstRow],n.selectionHandler.lastActionRow=i.firstRow,n.selectRows(t,!0)))}}])&&_M(t.prototype,n),i&&_M(t,i),o}(R$);function PM(e){return(PM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xM(e,t){return(xM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=AM(e);if(t){var r=AM(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return DM(this,n)}}function DM(e,t){return!t||"object"!==PM(t)&&"function"!=typeof t?FM(e):t}function FM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AM(e){return(AM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xM(e,t)}(o,e);var t,n,i,r=EM(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).which=[pu.PAGE_DOWN],t.renderingHints.text="PgDn",t.renderingHints.$drawingArea=function(e,t){var n=this._viewportInfo();if(n.lastRow)return n.lastRow.$row}.bind(FM(t)),t}return t=o,(n=[{key:"handle",value:function(e){var t,n=this.field,i=this._viewportInfo(),r=n.visibleRows,o=n.selectedRows,s=et.last(o),a=n.selectionHandler.lastActionRow,u=-1;(i.lastRow||(n.scrollPageDown(),(i=this._viewportInfo()).lastRow))&&(a&&(u=r.indexOf(a)),u<0&&(a=s,u=r.indexOf(a)),(!(o.length>0&&a===i.lastRow)||o.length>1&&!e.shiftKey||(n.scrollPageDown(),(i=this._viewportInfo()).lastRow))&&(e.shiftKey&&o.length>0?(t=r.slice(u+1,r.indexOf(i.lastRow)+1),t=et.union(o,t)):t=[i.lastRow],n.selectionHandler.lastActionRow=i.lastRow,n.selectRows(t,!0)))}}])&&RM(t.prototype,n),i&&RM(t,i),o}(R$);function jM(e){return(jM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function IM(e,t){return(IM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=NM(e);if(t){var r=NM(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return BM(this,n)}}function BM(e,t){return!t||"object"!==jM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NM(e){return(NM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IM(e,t)}(o,e);var t,n,i,r=LM(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.renderingHints.$drawingArea=function(e,t){return t._$filterInput},t.virtualKeyStrokeWhich="a-Z;a-z;0-9",t.preventDefault=!1,t.keyStrokeMode=$u.Mode.DOWN,t}return t=o,(n=[{key:"_accept",value:function(e){if(!this._isKeyStrokeInRange(e))return!1;var t=s()(".table-text-filter",this.field.$container);if(!t.length)return!1;var n=this.field.$container.activeElement(!0),i=n.tagName.toLowerCase(),r="textarea"===i||"input"===i;return!("table-text-filter"===n.className&&r||(e._$filterInput=t,this._isKeyStrokeInRange(e),0))}},{key:"handle",value:function(e){var t=e._$filterInput;if(this.field.session.focusManager.requestFocus(t)){t.focus();var n=O.nvl(t.val(),"").length;t[0].setSelectionRange(n,n)}}},{key:"keys",value:function(){return[new vu(this,this.virtualKeyStrokeWhich)]}},{key:"renderKeyBox",value:function(e,t){var n=t._$filterInput,i=n.position().left+n.cssMarginLeft()+4;return n.beforeDiv("key-box char","a - z").toggleClass("disabled",!this.enabledByFilter).cssLeft(i),n.parent()}},{key:"_isKeyStrokeInRange",value:function(e){return e.which===this.virtualKeyStrokeWhich||!(e.altKey|e.ctrlKey)&&(e.which>=pu.a&&e.which<=pu.z||e.which>=pu.A&&e.which<=pu.Z||e.which>=pu[0]&&e.which<=pu[9]||e.which>=pu.NUMPAD_0&&e.which<=pu.NUMPAD_9)}}])&&MM(t.prototype,n),i&&MM(t,i),o}($u);function VM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var WM=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"createKey",value:function(){return"filterKey"}},{key:"accept",value:function(e){}}])&&VM(t.prototype,n),i&&VM(t,i),e}();function zM(e){return(zM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function UM(e,t){return(UM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=YM(e);if(t){var r=YM(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return qM(this,n)}}function qM(e,t){return!t||"object"!==zM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function YM(e){return(YM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var XM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UM(e,t)}(o,e);var t,n,i,r=KM(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"init",value:function(e){if(this.session=e.session,!this.session)throw new Error("Session expected: "+this);this._init(e)}},{key:"_init",value:function(e){s.a.extend(this,e)}},{key:"createFilterAddedEventData",value:function(){return{filterType:this.filterType}}},{key:"createFilterRemovedEventData",value:function(){return{filterType:this.filterType}}},{key:"createKey",value:function(){return this.filterType}},{key:"createLabel",value:function(){return""}},{key:"accept",value:function(e){}}])&&GM(t.prototype,n),i&&GM(t,i),o}(WM);function JM(e){return(JM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QM(e,t,n){return(QM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iI(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function eI(e,t){return(eI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=iI(e);if(t){var r=iI(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return nI(this,n)}}function nI(e,t){return!t||"object"!==JM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iI(e){return(iI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eI(e,t)}(o,e);var t,n,i,r=tI(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).filterType=o.TYPE,e.events=new Yt,e.hasFilterFields=!1,e.availableValues=[],e.selectedValues=[],e}return t=o,(n=[{key:"axisGroup",value:function(){return fR.NumberGroup.COUNT}},{key:"calculate",value:function(){var e,t;this.matrix=new fR(this.table,this.session),this.matrix.addData(this.column,fR.NumberGroup.COUNT),this.xAxis=this.matrix.addAxis(this.column,this.axisGroup());var n,i,r,o,s=this.matrix.calculate();this.selectedValues.forEach((function(n){e=!1,this._useTextInsteadOfNormValue(n)&&(n=this.xAxis.norm(n)),this.xAxis.some((function(t){return t===n&&(e=!0,!0)}),this),e||(this.xAxis.push(n),t=!0)}),this),t&&this.xAxis.reorder(),this.availableValues=[],this.xAxis.forEach((function(e){i=e,n=this.xAxis.format(e),o=null,this._useTextInsteadOfNormValue(e)&&(i=n),null!==e&&this.xAxis.textIsIcon&&(o=n,n=null),r=s.getValue([e]),this.availableValues.push({key:i,text:n,iconId:o,htmlEnabled:!1,cssClass:null,count:r?r[0]:0})}),this)}},{key:"_useTextInsteadOfNormValue",value:function(e){return!1}},{key:"createFilterAddedEventData",value:function(){var e=QM(iI(o.prototype),"createFilterAddedEventData",this).call(this);return e.columnId=this.column.id,e.selectedValues=this.selectedValues,e}},{key:"createFilterRemovedEventData",value:function(){var e=QM(iI(o.prototype),"createFilterRemovedEventData",this).call(this);return e.columnId=this.column.id,e}},{key:"createLabel",value:function(){return this.column.headerHtmlEnabled?En.plainText(this.column.text).replace(/\n/g," "):this.column.text||""}},{key:"createKey",value:function(){return this.column.id}},{key:"accept",value:function(e){this.xAxis||this.calculate();var t=!0,n=!0,i=this.column.cellValueOrTextForCalculation(e),r=this.xAxis.norm(i);return this._useTextInsteadOfNormValue(r)&&(r=this.xAxis.format(r)),this.tableFilterActive()&&(t=this.selectedValues.indexOf(r)>-1),this.fieldsFilterActive()&&(n=this.acceptByFields(i,r,e)),t&&n}},{key:"filterActive",value:function(){return this.tableFilterActive()||this.fieldsFilterActive()}},{key:"tableFilterActive",value:function(){return this.selectedValues.length>0}},{key:"triggerFilterFieldsChanged",value:function(e){this.events.trigger("filterFieldsChanged",e)}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"acceptByFields",value:function(e,t,n){return!0}},{key:"fieldsFilterActive",value:function(){return!1}},{key:"addFilterFields",value:function(e){}},{key:"modifyFilterFields",value:function(){}},{key:"filterFieldsTitle",value:function(){return null}},{key:"createComparator",value:function(){return yD.NUMERIC}}])&&ZM(t.prototype,n),i&&ZM(t,i),o}(XM);function oI(e){return(oI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aI(e,t,n){return(aI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fI(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function uI(e,t){return(uI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=fI(e);if(t){var r=fI(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cI(this,n)}}function cI(e,t){return!t||"object"!==oI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fI(e){return(fI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(rI,"TYPE","column");var hI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uI(e,t)}(o,e);var t,n,i,r=lI(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).dateFrom,e.dateFromField,e.dateTo,e.dateToField,e.hasFilterFields=!0,e}return t=o,(n=[{key:"_init",value:function(e){aI(fI(o.prototype),"_init",this).call(this,e),this.dateFrom=wt.parseJsonDate(this.dateFrom),this.dateTo=wt.parseJsonDate(this.dateTo)}},{key:"axisGroup",value:function(){return this.column.hasDate?fR.DateGroup.YEAR:fR.DateGroup.NONE}},{key:"createFilterAddedEventData",value:function(){var e=aI(fI(o.prototype),"createFilterAddedEventData",this).call(this);return e.dateFrom=wt.toJsonDate(this.dateFrom),e.dateTo=wt.toJsonDate(this.dateTo),e}},{key:"fieldsFilterActive",value:function(){return this.dateFrom||this.dateTo}},{key:"acceptByFields",value:function(e,t,n){if(!e)return!1;var i=e.valueOf(),r=this.dateFrom?this.dateFrom.valueOf():null,o=this.dateTo?wt.shift(this.dateTo,0,0,1).valueOf()-1:null;if(r&&o)return i>=r&&i<=o;if(r)return i>=r;if(o)return i<=o;throw new Error("illegal state")}},{key:"filterFieldsTitle",value:function(){return this.session.text("ui.DateRange")}},{key:"addFilterFields",value:function(e){this.dateFromField=e.addFilterField("DateField","ui.from"),this.dateFromField.setValue(this.dateFrom),this.dateFromField.on("propertyChange",this._onPropertyChange.bind(this)),this.dateToField=e.addFilterField("DateField","ui.to"),this.dateToField.setValue(this.dateTo),this.dateToField.on("propertyChange",this._onPropertyChange.bind(this))}},{key:"_onPropertyChange",value:function(e){"value"===e.propertyName&&(this.dateFrom=this.dateFromField.value,this.dateTo=this.dateToField.value,s.a.log.isDebugEnabled()&&s.a.log.debug("(DateColumnUserFilter#_onAcceptInput) dateFrom="+this.dateFrom+" dateTo="+this.dateTo),this.triggerFilterFieldsChanged(e))}},{key:"modifyFilterFields",value:function(){this.dateFromField.$field.on("input","",s.a.debounce(this._onInput.bind(this))),this.dateToField.$field.on("input","",s.a.debounce(this._onInput.bind(this)))}},{key:"_onInput",value:function(e){this.dateFromField.rendered&&(this.dateFrom=this.dateFromField.value,this.dateTo=this.dateToField.value,this.triggerFilterFieldsChanged(e))}}])&&sI(t.prototype,n),i&&sI(t,i),o}(rI);function dI(e){return(dI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yI(e,t,n){return(yI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mI(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function vI(e,t){return(vI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mI(e);if(t){var r=mI(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gI(this,n)}}function gI(e,t){return!t||"object"!==dI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mI(e){return(mI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vI(e,t)}(o,e);var t,n,i,r=bI(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).numberFrom,e.numberFromField,e.numberTo,e.numberToField,e.hasFilterFields=!0,e}return t=o,(n=[{key:"createFilterAddedEventData",value:function(){var e=yI(mI(o.prototype),"createFilterAddedEventData",this).call(this);return e.numberFrom=this.numberFrom,e.numberTo=this.numberTo,e}},{key:"fieldsFilterActive",value:function(){return oi.isNumber(this.numberFrom)||oi.isNumber(this.numberTo)}},{key:"acceptByFields",value:function(e,t,n){var i=oi.isNumber(this.numberFrom),r=oi.isNumber(this.numberTo);return i&&r?t>=this.numberFrom&&t<=this.numberTo:i?t>=this.numberFrom:r?t<=this.numberTo:void 0}},{key:"filterFieldsTitle",value:function(){return this.session.text("ui.NumberRange")}},{key:"addFilterFields",value:function(e){this.numberFromField=e.addFilterField("NumberField","ui.from"),this.numberFromField.decimalFormat=this.column.decimalFormat,this.numberFromField.setValue(this.numberFrom),this.numberFromField.on("propertyChange",this._onPropertyChange.bind(this)),this.numberToField=e.addFilterField("NumberField","ui.to"),this.numberToField.decimalFormat=this.column.decimalFormat,this.numberToField.setValue(this.numberTo),this.numberToField.on("propertyChange",this._onPropertyChange.bind(this))}},{key:"_onPropertyChange",value:function(e){"value"===e.propertyName&&(this.numberFrom=this.numberFromField.value,this.numberTo=this.numberToField.value,s.a.log.isDebugEnabled()&&s.a.log.debug("(NumberColumnUserFilter#_onPropertyChange) numberFrom="+this.numberFrom+" numberTo="+this.numberTo),this.triggerFilterFieldsChanged(e))}}])&&pI(t.prototype,n),i&&pI(t,i),o}(rI);function wI(e){return(wI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SI(e,t,n){return(SI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PI(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function OI(e,t){return(OI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function TI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=PI(e);if(t){var r=PI(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return CI(this,n)}}function CI(e,t){return!t||"object"!==wI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function PI(e){return(PI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var RI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OI(e,t)}(o,e);var t,n,i,r=TI(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).freeText=null,e.freeTextField=null,e.hasFilterFields=!0,e}return t=o,(n=[{key:"createFilterAddedEventData",value:function(){var e=SI(PI(o.prototype),"createFilterAddedEventData",this).call(this);return e.freeText=this.freeText,e}},{key:"fieldsFilterActive",value:function(){return En.hasText(this.freeText)}},{key:"acceptByFields",value:function(e,t,n){var i=En.nvl(this.freeText).toLowerCase();return En.nvl(this.column.cellTextForTextFilter(n)).toLowerCase().indexOf(i)>-1}},{key:"_useTextInsteadOfNormValue",value:function(e){return null!==e}},{key:"filterFieldsTitle",value:function(){return this.session.text("ui.FreeText")}},{key:"addFilterFields",value:function(e){this.freeTextField=O.create("StringField",{parent:e,labelVisible:!1,statusVisible:!1,maxLength:100,displayText:this.freeText,updateDisplayTextOnModify:!0}),this.freeTextField.on("acceptInput",this._onAcceptInput.bind(this)),e.addField0(this.freeTextField)}},{key:"_onAcceptInput",value:function(e){this.freeText=this.freeTextField.$field.val().trim(),s.a.log.isDebugEnabled()&&s.a.log.debug("(TextColumnUserFilter#_onAcceptInput) freeText="+this.freeText),this.triggerFilterFieldsChanged(e)}},{key:"modifyFilterFields",value:function(){this.freeTextField.removeMandatoryIndicator()}}])&&kI(t.prototype,n),i&&kI(t,i),o}(rI);function xI(e){return(xI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function DI(e,t,n){return(DI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jI(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function FI(e,t){return(FI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=jI(e);if(t){var r=jI(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $I(this,n)}}function $I(e,t){return!t||"object"!==xI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jI(e){return(jI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FI(e,t)}(o,e);var t,n,i,r=AI(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).filterType=o.TYPE,e}return t=o,(n=[{key:"createFilterAddedEventData",value:function(){var e=DI(jI(o.prototype),"createFilterAddedEventData",this).call(this);return e.text=this.text,e}},{key:"createLabel",value:function(){return this.text}},{key:"accept",value:function(e){var t=this.table.visibleColumns().reduce((function(t,n){return t+n.cellTextForTextFilter(e)+" "}),"");return this.text!==this._cachedText&&(this._cachedText=this.text,this._cachedTextLowerCase=this.text.toLowerCase()),(t=t.trim().toLowerCase()).indexOf(this._cachedTextLowerCase)>-1}}])&&EI(t.prototype,n),i&&EI(t,i),o}(XM);function II(e){return(II="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BI(e,t){return(BI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=WI(e);if(t){var r=WI(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return HI(this,n)}}function HI(e,t){return!t||"object"!==II(t)&&"function"!=typeof t?VI(e):t}function VI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WI(e){return(WI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(MI,"TYPE","text");var zI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BI(e,t)}(o,e);var t,n,i,r=NI(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=r.call(this),s.a.extend(VI(t),e),t}return t=o,(n=[{key:"createKey",value:function(){return"TileTableHierarchyFilter"}},{key:"accept",value:function(e){return!e.parentRow}},{key:"createLabel",value:function(){return this.table.session.text("ui.TileView")}}])&&LI(t.prototype,n),i&&LI(t,i),o}(WM);function GI(e){return(GI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function KI(e,t,n){return(KI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=JI(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function qI(e,t){return(qI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=JI(e);if(t){var r=JI(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return XI(this,n)}}function XI(e,t){return!t||"object"!==GI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function JI(e){return(JI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ZI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qI(e,t)}(o,e);var t,n,i,r=YI(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).preselectedTime=null,e.selectedTime=null,e.resolution=null,e.$scrollable=null,e.touch=Mt.get().supportsOnlyTouch(),e}return t=o,(n=[{key:"_init",value:function(e){KI(JI(o.prototype),"_init",this).call(this,e),this.resolution=e.timeResolution}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("time-picker").toggleClass("touch",this.touch),this.htmlComp=Uo.install(this.$container,this.session),this._renderTimeSelection(),this._installScrollbars()}},{key:"_renderTimeSelection",value:function(){var e,t,n,i=wt.trunc(new Date),r=wt.ceil(new Date,this.resolution),o=0,s=this.$parent.makeDiv("day-table");for(e=0;e<24;e++)for(i.setMinutes(0),o=i.getHours(),(n=(t=s.appendDiv("hour-row")).appendDiv("cell  hours").data("time",new Date(i)).on("click",this._onTimeClick.bind(this))).appendSpan("text").text(wt.format(i,this.session.locale,"HH"));o===i.getHours();)(n=t.appendDiv("cell minutes").data("time",new Date(i)).on("click",this._onTimeClick.bind(this))).appendSpan("text").text(wt.format(i,this.session.locale,":mm")),wt.isSameTime(r,i)&&n.addClass("now"),i.setMinutes(i.getMinutes()+this.resolution);return s.appendTo(this.$container),s}},{key:"_installScrollbars",value:function(e){this._uninstallScrollbars(),KI(JI(o.prototype),"_installScrollbars",this).call(this,{axis:"y"})}},{key:"preselectTime",value:function(e){e&&this.setSelectedTime(null),this.setPreselectedTime(e)}},{key:"setPreselectedTime",value:function(e){this.setProperty("preselectedTime",e)}},{key:"_renderPreselectedTime",value:function(){var e;this.$container.find(".cell").each(function(t,n){var i=s()(n),r=i.data("time");i.removeClass("preselected"),this.preselectedTime&&(i.hasClass("hours")&&this.preselectedTime.getHours()===r.getHours()||i.hasClass("minutes")&&wt.isSameTime(this.preselectedTime,r))&&(i.addClass("preselected"),e=i)}.bind(this)),e&&wf.scrollTo(this.$container,e,"center")}},{key:"selectTime",value:function(e){e&&this.setPreselectedTime(null),this.setSelectedTime(e)}},{key:"setSelectedTime",value:function(e){this.setProperty("selectedTime",e)}},{key:"_renderSelectedTime",value:function(){var e;this.$container.find(".cell").each(function(t,n){var i=s()(n),r=i.data("time");i.removeClass("selected"),this.selectedTime&&(i.hasClass("hours")&&this.selectedTime.getHours()===r.getHours()||i.hasClass("minutes")&&wt.isSameTime(this.selectedTime,r))&&(i.addClass("selected"),e=i)}.bind(this)),e&&wf.scrollTo(this.$container,e,"center")}},{key:"shiftViewDate",value:function(e,t,n){var i=this.viewDate;i=wt.shift(i,e,t,n),this.showDate(i)}},{key:"shiftSelectedTime",value:function(e,t,n){var i=this.preselectedTime;this.selectedTime&&(i=wt.shiftTime(this.selectedTime,e,t*this.resolution,n)),i&&this.selectTime(this._snapToTimeGrid(i))}},{key:"_snapToTimeGrid",value:function(e){if(!e)return e;var t=e.getMinutes();return t=parseInt(t/this.resolution)*this.resolution,e.setMinutes(t),e}},{key:"_findNextAllowedDate",value:function(e,t,n){var i,r,o=e+t+n>0?1:-1,s=this.selectedDate||wt.trunc(new Date);if(0!==e?s=wt.shift(s,e,0,0):0!==t&&(s=wt.shift(s,0,t,0)),1===o){for(i=0;i<this.allowedDates.length;i++)if(r=this.allowedDates[i],wt.compare(s,r)<0)return r}else if(-1===o)for(i=this.allowedDates.length-1;i>=0;i--)if(r=this.allowedDates[i],wt.compare(s,r)>0)return r;return null}},{key:"_isDateAllowed",value:function(e){if(!this.allowedDates||0===this.allowedDates.length)return!0;var t=e.getTime();return this.allowedDates.some((function(e){return e.getTime()===t}))}},{key:"_onNavigationMouseDown",value:function(e){var t=s()(e.currentTarget).data("shift");this.shiftViewDate(0,t,0)}},{key:"_onTimeClick",value:function(e){var t=s()(e.currentTarget),n=new Date(t.data("time"));this.selectTime(n),this.trigger("timeSelect",{time:n})}},{key:"_onMouseWheel",value:function(e){var t=((e=e.originalEvent||this.$container.window(!0).event.originalEvent).wheelDelta?e.wheelDelta/10:3*-e.detail)>=0?-1:1;this.shiftViewDate(0,t,0),e.preventDefault()}}])&&UI(t.prototype,n),i&&UI(t,i),o}(de);function QI(e){return(QI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tL(e,t,n){return(tL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oL(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function nL(e,t){return(nL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oL(e);if(t){var r=oL(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rL(this,n)}}function rL(e,t){return!t||"object"!==QI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oL(e){return(oL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nL(e,t)}(o,e);var t,n,i,r=iL(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){e.scrollType=e.scrollType||"layoutAndPosition",e.withFocusContext=!1,tL(oL(o.prototype),"_init",this).call(this,e),this.picker=O.create("TimePicker",{parent:this,timeResolution:e.timeResolution})}},{key:"_createLayout",value:function(){return new pL(this)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("time-picker-popup"),this.$container.toggleClass("alternative",this.field.fieldStyle===GH.FieldStyle.ALTERNATIVE),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.validateRoot=!0,this.picker.render()}},{key:"getTimePicker",value:function(){return this.picker}},{key:"_isMouseDownOnAnchor",value:function(e){return this.field.$timeField.isOrHas(e.target)||this.field.$timeFieldIcon.isOrHas(e.target)||this.field.$timeClearIcon&&this.field.$timeClearIcon.isOrHas(e.target)}}])&&eL(t.prototype,n),i&&eL(t,i),o}(kd);function aL(e){return(aL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lL(e,t,n){return(lL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dL(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function cL(e,t){return(cL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=dL(e);if(t){var r=dL(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return hL(this,n)}}function hL(e,t){return!t||"object"!==aL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dL(e){return(dL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cL(e,t)}(o,e);var t,n,i,r=fL(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).popup=e,t.doubleCalcPrefSize=!1,t}return t=o,(n=[{key:"layout",value:function(e){var t,n=this.popup.htmlComp,i=this.popup.picker.htmlComp;lL(dL(o.prototype),"layout",this).call(this,e),t=n.size().subtract(n.insets()).subtract(i.margins()),i.setSize(t),this.popup.htmlComp.layouted&&this.popup.position()}},{key:"preferredLayoutSize",value:function(e){var t,n=this.popup.htmlComp,i=this.popup.picker.htmlComp;return(t=i.prefSize().add(n.insets()).add(i.margins())).height=Math.max(15,Math.min(350,t.height)),t}}])&&uL(t.prototype,n),i&&uL(t,i),o}(Id);function yL(e){return(yL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bL(e,t,n){return(bL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wL(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function gL(e,t){return(gL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=wL(e);if(t){var r=wL(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _L(this,n)}}function _L(e,t){return!t||"object"!==yL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wL(e){return(wL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gL(e,t)}(o,e);var t,n,i,r=mL(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){bL(wL(o.prototype),"_init",this).call(this,e),this._field.on("acceptInput",this._onFieldAcceptInput.bind(this))}},{key:"_initWidget",value:function(e){this._widget=O.create("TimePicker",{parent:this,timeResolution:e.timeResolution})}},{key:"_render",value:function(){bL(wL(o.prototype),"_render",this).call(this),this._field.$container.addClass("time")}},{key:"getTimePicker",value:function(){return this._widget}},{key:"_createLayout",value:function(){return new EL(this)}},{key:"_onFieldAcceptInput",value:function(e){this._touchField.setDisplayText(e.displayText),this._touchField.setErrorStatus(e.errorStatus),e.errorStatus||this._touchField.setValue(e.value),this._touchField._triggerAcceptInput()}}])&&vL(t.prototype,n),i&&vL(t,i),o}(Lp);function SL(e){return(SL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function TL(e,t,n){return(TL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xL(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function CL(e,t){return(CL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=xL(e);if(t){var r=xL(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return RL(this,n)}}function RL(e,t){return!t||"object"!==SL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xL(e){return(xL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var EL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CL(e,t)}(o,e);var t,n,i,r=PL(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"layout",value:function(e){TL(xL(o.prototype),"layout",this).call(this,e),this.popup.getTimePicker().htmlComp.setSize(this.popup._widgetContainerHtmlComp.size())}},{key:"preferredLayoutSize",value:function(e,t){var n=this.popup.htmlComp.insets(),i=this.popup._field.htmlComp,r=this.popup._widgetContainerHtmlComp,o=i.prefSize(t).add(i.margins()),s=r.prefSize(t).add(r.margins()),a=No.size(this.popup._$header,!0).height+o.height+s.height+n.vertical(),u=Math.max(o.width,s.width);return new Co(u,a)}}])&&OL(t.prototype,n),i&&OL(t,i),o}(Up);function DL(e){return(DL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AL(e,t,n){return(AL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=LL(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function $L(e,t){return($L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=LL(e);if(t){var r=LL(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ML(this,n)}}function ML(e,t){return!t||"object"!==DL(t)&&"function"!=typeof t?IL(e):t}function IL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LL(e){return(LL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var NL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$L(e,t)}(o,e);var t,n,i,r=jL(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).toggleBreadcrumbStyleEnabled=!1,e.breadcrumbTogglingThreshold=null,e.autoCheckChildren=!1,e.checkable=!1,e.checkableStyle=o.CheckableStyle.CHECKBOX_TREE_NODE,e.displayStyle=o.DisplayStyle.DEFAULT,e.dropType=0,e.dropMaximumSize=Gt.DEFAULT_DROP_MAXIMUM_SIZE,e.filterEnabled=!1,e.lazyExpandingEnabled=!0,e.menus=[],e.contextMenu=null,e.menuBar=null,e.keyStrokes=[],e.multiCheck=!0,e.nodes=[],e.nodesMap={},e.nodePaddingLevelCheckable=23,e.nodePaddingLevelNotCheckable=18,e.nodePaddingLeft=null,e.nodeCheckBoxPaddingLeft=29,e.nodeControlPaddingLeft=null,e.nodePaddingLevel=e.nodePaddingLevelNotCheckable,e.scrollToSelection=!1,e.scrollTop=0,e.scrollTopHistory=[],e.selectedNodes=[],e.prevSelectedNode=null,e.checkedNodes=[],e.groupedNodes={},e.visibleNodesFlat=[],e.visibleNodesMap={},e._addWidgetProperties(["menus","keyStrokes"]),e._additionalContainerClasses="",e._filters=[],e._doubleClickSupport=new Lt,e._$animationWrapper=null,e._$expandAnimationWrappers=[],e._filterMenusHandler=e._filterMenus.bind(IL(e)),e._popupOpenHandler=e._onDesktopPopupOpen.bind(IL(e)),e._inSelectionPathList={},e.viewRangeRendered=new fi(0,0),e.viewRangeSize=20,e.startAnimationFunc=function(){this.runningAnimations++}.bind(IL(e)),e.runningAnimations=0,e.runningAnimationsFinishFunc=function(){this.runningAnimations--,this.runningAnimations<=0&&(this.runningAnimations=0,this._renderViewportBlocked=!1,this.invalidateLayoutTree())}.bind(IL(e)),e.nodeHeight=0,e.nodeWidth=0,e.maxNodeWidth=0,e.nodeWidthDirty=!1,e.$data=null,e._scrolldirections="both",e.requestFocusOnNodeControlMouseDown=!0,e}return t=o,i=[{key:"collectSubtree",value:function(e,t){if(!e)return s()();for(var n=parseFloat(e.attr("data-level")),i=e.next();i.length>0;){var r=parseFloat(i.attr("data-level"));if(isNaN(r)||r<=n)break;i=i.next()}var o=e.nextUntil(i);return(void 0===t||t)&&(o=o.add(e)),o}},{key:"visitNodes",value:function(e,t,n){var i,r;if(t)for(i=0;i<t.length;i++)!e(r=t[i],n)&&r.childNodes.length>0&&o.visitNodes(e,r.childNodes,r)}}],(n=[{key:"_init",value:function(e){AL(LL(o.prototype),"_init",this).call(this,e),this.addFilter(new oB(this),!0),this.breadcrumbFilter=new aB(this),this.displayStyle===o.DisplayStyle.BREADCRUMB&&this.addFilter(this.breadcrumbFilter,!0,!0),this.initialTraversing=!0,this._setCheckable(this.checkable),this._ensureTreeNodes(this.nodes),this.visitNodes(this._initTreeNode.bind(this)),this.visitNodes(this._updateFlatListAndSelectionPath.bind(this)),this.initialTraversing=!1,this.selectedNodes=this._nodesByIds(this.selectedNodes),this.menuBar=O.create("MenuBar",{parent:this,position:O_.Position.BOTTOM,menuOrder:new ag(this.session,"Tree"),menuFilter:this._filterMenusHandler}),this._updateItemPath(!0),this._setDisplayStyle(this.displayStyle),this._setKeyStrokes(this.keyStrokes),this._setMenus(this.menus)}},{key:"_ensureTreeNodes",value:function(e){var t,n;for(t=0;t<e.length;t++)(n=e[t]).childNodeIndex=O.nvl(n.childNodeIndex,t),n instanceof XL||(e[t]=this._createTreeNode(n))}},{key:"_createTreeNode",value:function(e){return(e=O.nvl(e,{})).parent=this,O.create("TreeNode",e)}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){AL(LL(o.prototype),"_initKeyStrokeContext",this).call(this),this._initTreeKeyStrokeContext()}},{key:"_initTreeKeyStrokeContext",value:function(){var e=gu.NONE;this.keyStrokeContext.registerKeyStroke([new SB(this),new DB(this,e),new BB(this,e),new tN(this,e),new lN(this,e),new KB(this,e),new gN(this,e)]),this.keyStrokeContext.registerStopPropagationInterceptor((function(e){e.ctrlKey||e.altKey||!O.isOneOf(e.which,pu.UP,pu.DOWN)||(e.stopPropagation(),e.preventDefault())}))}},{key:"_setMenus",value:function(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this._updateMenuBar()}},{key:"_updateMenuBar",value:function(){var e=this._filterMenus(this.menus,_b.MENU_BAR,!1,!0);this.menuBar.setMenuItems(e);var t=this._filterMenus(this.menus,_b.CONTEXT_MENU,!0);this.contextMenu&&this.contextMenu.updateMenuItems(t)}},{key:"_setKeyStrokes",value:function(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}},{key:"_resetTreeNode",value:function(e,t){e.reset()}},{key:"isSelectedNode",value:function(e){return this.initialTraversing?this.selectedNodes.indexOf(e.id)>-1:this.selectedNodes.indexOf(e)>-1}},{key:"_updateFlatListAndSelectionPath",value:function(e,t){if(this.isSelectedNode(e)&&(e.parentNode&&!this.visibleNodesMap[e.parentNode.id]||0===e.level))for(var n=e;n;)this._inSelectionPathList[n.id]=!0,n.filterDirty=!0,n!==e&&(e.expanded=!0,0===n.level&&(this._applyFiltersForNode(n),this._addToVisibleFlatList(n,!1),this._addChildrenToFlatList(n,this.visibleNodesFlat.length-1,!1,null,!0))),n=n.parentNode;else e.parentNode&&this.isSelectedNode(e.parentNode)&&(this._inSelectionPathList[e.id]=!0);this._applyFiltersForNode(e),this._addToVisibleFlatList(e,!1)}},{key:"_initTreeNode",value:function(e,t){this.nodesMap[e.id]=e,t&&(e.parentNode=t,e.level=e.parentNode.level+1),e.checked&&this.checkedNodes.push(e),this._initTreeNodeInternal(e,t),this._updateMarkChildrenChecked(e,!0,e.checked),e.initialized=!0}},{key:"_applyNodeDefaultValues",value:function(e){Pt.applyTo(e,"TreeNode")}},{key:"_initTreeNodeInternal",value:function(e,t){this._applyNodeDefaultValues(e)}},{key:"_destroy",value:function(){AL(LL(o.prototype),"_destroy",this).call(this),this.visitNodes(this._destroyTreeNode.bind(this)),this.nodes=[]}},{key:"_destroyTreeNode",value:function(e){delete this.nodesMap[e.id],this._removeFromFlatList(e,!1),e.destroy(),this._onNodeDeleted&&this._onNodeDeleted(e)}},{key:"visitNodes",value:function(e,t){return o.visitNodes(e,this.nodes,t)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tree"),this._additionalContainerClasses&&this.$container.addClass(this._additionalContainerClasses);var e=new iB(this);this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(e),this.$data=this.$container.appendDiv("tree-data").on("contextmenu",this._onContextMenu.bind(this)).on("mousedown",".tree-node",this._onNodeMouseDown.bind(this)).on("mouseup",".tree-node",this._onNodeMouseUp.bind(this)).on("dblclick",".tree-node",this._onNodeDoubleClick.bind(this)).on("mousedown",".tree-node-control",this._onNodeControlMouseDown.bind(this)).on("mouseup",".tree-node-control",this._onNodeControlMouseUp.bind(this)).on("dblclick",".tree-node-control",this._onNodeControlDoubleClick.bind(this)),Uo.install(this.$data,this.session),this.isHorizontalScrollingEnabled()&&this.$data.toggleClass("scrollable-tree",!0),this._installScrollbars({axis:this._scrolldirections}),this._installNodeTooltipSupport(),this.menuBar.render(),this._updateNodeDimensions(),this._renderDisplayStyle(),this._renderViewport(),this.session.desktop.on("popupOpen",this._popupOpenHandler),this._renderCheckableStyle()}},{key:"_postRender",value:function(){AL(LL(o.prototype),"_postRender",this).call(this),this._renderSelection()}},{key:"_remove",value:function(){this.session.desktop.off("popupOpen",this._popupOpenHandler),this._$animationWrapper&&this._$animationWrapper.stop(!1,!0),this.visitNodes(this._resetTreeNode.bind(this)),this._uninstallDragAndDropHandler(),this._uninstallNodeTooltipSupport(),this.$fillBefore=null,this.$fillAfter=null,this.$data=null,this.viewRangeRendered=new fi(0,0),AL(LL(o.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){AL(LL(o.prototype),"_renderProperties",this).call(this),this._renderDropType()}},{key:"isHorizontalScrollingEnabled",value:function(){return"both"===this._scrolldirections||"x"===this._scrolldirections}},{key:"isTreeNodeCheckEnabled",value:function(){return this.checkableStyle===o.CheckableStyle.CHECKBOX_TREE_NODE}},{key:"_onScroll",value:function(){var e=this.scrollToSelection;this.scrollToSelection=!1;var t=this.$data[0].scrollTop,n=this.$data[0].scrollLeft;this.scrollTop!==t&&this._renderViewport(),this.scrollTop=t,this.scrollLeft=n,this.scrollToSelection=e}},{key:"setScrollTop",value:function(e){this.setProperty("scrollTop",e),this.rendered&&(this._renderViewport(),this._renderScrollTop())}},{key:"_renderScrollTop",value:function(){this.rendering||wf.scrollTop(this.$data,this.scrollTop)}},{key:"get$Scrollable",value:function(){return this.$data}},{key:"_renderViewport",value:function(){if(!(this.runningAnimations>0||this._renderViewportBlocked)&&this.$container.isEveryParentVisible()){var e=this._calculateCurrentViewRange();this._renderViewRange(e)}}},{key:"_calculateCurrentViewRange",value:function(){var e,t=this.$data[0].scrollTop;return e=0==this.$data[0].scrollHeight-this.$data[0].clientHeight&&this.visibleNodesFlat.length>0?this.visibleNodesFlat[0]:this._nodeAtScrollTop(t),this._calculateViewRangeForNode(e)}},{key:"_rerenderViewport",value:function(){this._renderViewportBlocked||(this._removeRenderedNodes(),this._renderFiller(),this._updateDomNodeWidth(),this._updateDomNodeIconWidth(),this._renderViewport())}},{key:"_removeRenderedNodes",value:function(){this.$data.find(".tree-node").each(function(e,t){var n=s()(t),i=n.data("node");n.hasClass("hiding")||this._removeNode(i)}.bind(this)),this.viewRangeRendered=new fi(0,0)}},{key:"_renderViewRangeForNode",value:function(e){var t=this._calculateViewRangeForNode(e);this._renderViewRange(t)}},{key:"_renderNodesInRange",value:function(e){var t=this.visibleNodesFlat;if(0!==t.length){if(e=new fi(0,t.length).intersect(e),this.viewRangeRendered.size()>0&&!e.intersect(this.viewRangeRendered).equals(new fi(0,0)))throw new Error("New range must not intersect with existing.");e.to,this.viewRangeRendered.from;var n=this.viewRangeRendered.union(e);if(2===n.length)throw new Error("Can only prepend or append rows to the existing range. Existing: "+this.viewRangeRendered+". New: "+n);this.viewRangeRendered=n[0];var i=this.ensureRangeVisible(e);s.a.log.isTraceEnabled()&&s.a.log.trace(i+" new nodes rendered from "+e)}}},{key:"ensureRangeVisible",value:function(e){for(var t=this.visibleNodesFlat,n=[],i=e.from;i<e.to;i++){var r=t[i];r.attached||n.push(r)}return this._insertNodesInDOM(n),n.length}},{key:"_renderFiller",value:function(){this.$fillBefore||(this.$fillBefore=this.$data.prependDiv("tree-data-fill"));var e,t=this._calculateFillerDimension(new fi(0,this.viewRangeRendered.from));this.$fillBefore.cssHeight(t.height),this.isHorizontalScrollingEnabled()&&(this.$fillBefore.cssWidth(t.width),this.maxNodeWidth=Math.max(t.width,this.maxNodeWidth)),s.a.log.isTraceEnabled()&&s.a.log.trace("FillBefore height: "+t.height),this.$fillAfter||(this.$fillAfter=this.$data.appendDiv("tree-data-fill")),e=this._calculateFillerDimension(new fi(this.viewRangeRendered.to,this.visibleNodesFlat.length)),this.$fillAfter.cssHeight(e.height),this.isHorizontalScrollingEnabled()&&(this.$fillAfter.cssWidth(e.width),this.maxNodeWidth=Math.max(e.width,this.maxNodeWidth)),s.a.log.isTraceEnabled()&&s.a.log.trace("FillAfter height: "+e.height)}},{key:"_calculateFillerDimension",value:function(e){var t=0;this.rendered&&(t=this.$data.outerWidth());for(var n={height:0,width:Math.max(t,this.maxNodeWidth)},i=e.from;i<e.to;i++){var r=this.visibleNodesFlat[i];n.height+=this._heightForNode(r),n.width=Math.max(n.width,this._widthForNode(r))}return n}},{key:"_removeNodesInRange",value:function(e){var t,n,i=0,r=this.visibleNodesFlat;r[(e=new fi(0,r.length).intersect(e)).from],r[e.to];var o=this.viewRangeRendered.subtract(e);if(2===o.length)throw new Error("Can only remove nodes at the beginning or end of the existing range. "+this.viewRangeRendered+". New: "+o);for(this.viewRangeRendered=o[0],n=e.from;n<e.to;n++)t=r[n],this._removeNode(t),i++;s.a.log.isTraceEnabled()&&s.a.log.trace(i+" nodes removed from "+e+".")}},{key:"_removeNode",value:function(e){var t=e.$node;t&&(t.hasClass("hiding")||(t.detach(),e.attached=!1))}},{key:"_renderViewRange",value:function(e){if(e.from!==this.viewRangeRendered.from||e.to!==this.viewRangeRendered.to||this.viewRangeDirty){if(this.viewRangeDirty)this.viewRangeRendered=e,this.ensureRangeVisible(e);else{var t=e.subtract(this.viewRangeRendered),n=this.viewRangeRendered.subtract(e),i=new fi(0,this.visibleNodesFlat.length);n.forEach(function(t){this._removeNodesInRange(t),i.to<t.to&&(this.viewRangeRendered=e)}.bind(this)),t.forEach(function(e){this._renderNodesInRange(e)}.bind(this))}if(this.viewRangeRendered.size()>0){var r=this.visibleNodesFlat,o=r[this.viewRangeRendered.from],s=r[this.viewRangeRendered.to-1];if(this.viewRangeDirty){var a=o.$node.prevAll(".tree-node"),u=s.$node.nextAll(".tree-node");this._cleanupNodes(a),this._cleanupNodes(u)}if(!o.attached||!s.attached)throw new Error("Nodes not rendered as expected. "+this.viewRangeRendered+". First: "+o.$node+". Last: "+s.$node)}this._postRenderViewRange(),this.viewRangeDirty=!1}else this.nodeWidthDirty&&(this._renderFiller(),this._updateDomNodeWidth(),this._updateDomNodeIconWidth())}},{key:"_postRenderViewRange",value:function(){this._renderFiller(),this._updateDomNodeWidth(),this._updateDomNodeIconWidth(),this._renderSelection()}},{key:"_updateDomNodeIconWidth",value:function(e){(this.rendered||this.rendering)&&this._visibleNodesInViewRange().forEach((function(e){e._updateIconWidth()}))}},{key:"_visibleNodesInViewRange",value:function(){return this.visibleNodesFlat.slice(this.viewRangeRendered.from,this.viewRangeRendered.to)}},{key:"_updateDomNodeWidth",value:function(){if(this.isHorizontalScrollingEnabled()&&this.rendered&&this.nodeWidthDirty){var e=this._visibleNodesInViewRange(),t=this.maxNodeWidth;t=e.reduce((function(e,t){return Math.max(t.width,e)}),O.nvl(t,0)),e.forEach((function(e){e.$node.cssWidth(t)})),this.nodeWidthDirty=!1}}},{key:"_cleanupNodes",value:function(e){for(var t=0;t<e.length;t++)this._removeNode(e.eq(t).data("node"))}},{key:"_nodeAtScrollTop",value:function(e){var t,n=0;this.visibleNodesFlat.some(function(i,r){if(n+=this._heightForNode(i),e<n)return t=i,!0}.bind(this));var i=this.visibleNodesFlat.length;return!t&&i>0&&(t=this.visibleNodesFlat[i-1]),t}},{key:"_heightForNode",value:function(e){return e.height?e.height:this.nodeHeight}},{key:"_widthForNode",value:function(e){return e.width?e.width:this.nodeWidth}},{key:"_calculateViewRangeForNode",value:function(e){var t=new fi,n=Math.floor(this.viewRangeSize/o.VIEW_RANGE_DIVISOR),i=this.visibleNodesFlat.indexOf(e);return t.from=Math.max(i-n,0),t.to=Math.min(t.from+this.viewRangeSize,this.visibleNodesFlat.length),e&&-1!==i?(this.viewRangeSize-t.size()>0&&(t.from=Math.max(t.to-this.viewRangeSize,0)),t):t}},{key:"calculateViewRangeSize",value:function(){if(this._updateNodeDimensions(),0===this.nodeHeight)throw new Error("Cannot calculate view range with nodeHeight = 0");var e=o.VIEW_RANGE_DIVISOR/2,t=Math.ceil(this.$data.outerHeight()/this.nodeHeight)*e;return Math.max(o.VIEW_RANGE_DIVISOR,t)}},{key:"setViewRangeSize",value:function(e){this.viewRangeSize!==e&&(this._setProperty("viewRangeSize",e),this.rendered&&this._renderViewport())}},{key:"_updateNodeDimensions",value:function(){var e=this._createTreeNode(),t=this._renderNode(e).appendTo(this.$data);if(this.nodeHeight=t.outerHeight(!0),this.isHorizontalScrollingEnabled()){var n=this.nodeWidth;this.nodeWidth=t.outerWidth(!0),n!==this.nodeWidth&&(this.viewRangeDirty=!0)}e.reset()}},{key:"updateNodeHeights",value:function(){this.visibleNodesFlat.forEach((function(e){e.attached?e.height=e.$node.outerHeight(!0):e.height=null}))}},{key:"removeAllNodes",value:function(){this._removeNodes(this.nodes)}},{key:"_removeNodes",value:function(e,t){0!==e.length&&(e.forEach((function(e){this._removeFromFlatList(e,!0),e.childNodes.length>0&&this._removeNodes(e.childNodes,e),e.$node&&(this._$animationWrapper&&this._$animationWrapper.find(e.$node).length>0&&this._$animationWrapper.stop(!1,!0),e.reset())}),this),et.ensure(t).forEach((function(e){e&&e.$node&&0===e.childNodes.length&&e.$node.removeClass("expanded lazy")})),this.rendered&&(this.viewRangeDirty=!0,this.invalidateLayoutTree()))}},{key:"_renderNode",value:function(e){var t=this._computeNodePaddingLeft(e);return e.render(this.$container,t,this.checkable,this.enabledComputed),e.$node}},{key:"_removeMenus",value:function(){}},{key:"_filterMenus",value:function(e,t,n,i){return mb.filterAccordingToSelection("Tree",this.selectedNodes.length,e,t,n,i)}},{key:"_renderEnabled",value:function(){AL(LL(o.prototype),"_renderEnabled",this).call(this);var e=this.enabledComputed;this.$data.setEnabled(e),this.$container.setTabbable(e),this.rendered&&this.$nodes().each((function(){var t=s()(this),n=t.data("node");t.children(".tree-node-checkbox").children(".check-box").toggleClass("disabled",!(e&&n.enabled))}))}},{key:"_renderDisabledStyle",value:function(){AL(LL(o.prototype),"_renderDisabledStyle",this).call(this),this._renderDisabledStyleInternal(this.$data)}},{key:"setCheckable",value:function(e){this.setProperty("checkable",e)}},{key:"_setCheckable",value:function(e){this._setProperty("checkable",e),this.checkable?this.nodePaddingLevel=this.nodePaddingLevelCheckable:this.nodePaddingLevel=this.nodePaddingLevelNotCheckable}},{key:"setCheckableStyle",value:function(e){this.setProperty("checkableStyle",e)}},{key:"_renderCheckable",value:function(){var e=function(e){return Boolean(e.$node)},t=function(n){var i=n.$node,r=i.children(".tree-node-control"),o=i.children(".tree-node-checkbox");n._updateControl(r,this),this.checkable?0===o.length&&n._renderCheckbox():o.remove(),i.css("padding-left",this._computeNodePaddingLeft(n)),n.childNodes&&n.childNodes.filter(e).forEach(t)}.bind(this);this.nodes.filter(e).forEach(t)}},{key:"_renderDisplayStyle",value:function(){this.$container.toggleClass("breadcrumb",this.isBreadcrumbStyleActive()),this._updateNodePaddingsLeft(),this.invalidateLayoutTree()}},{key:"_renderExpansion",value:function(e,t){var n={expandLazyChanged:!1,expansionChanged:!1};s.a.extend(n,t);var i=e.$node,r=e.expanded;if(i&&0!==i.length){if(0===e.childNodes.length)return!0;i.toggleClass("lazy",r&&e.expandedLazy),(n.expansionChanged||n.expandLazyChanged)&&(r?i.addClass("expanded"):i.removeClass("expanded"))}}},{key:"_renderSelection",value:function(){0===this.selectedNodes.length&&this.nodes.forEach((function(e){e.rendered&&e.$node.addClass("child-of-selected")}),this),this.selectedNodes.forEach((function(e){if(this.visibleNodesMap[e.id]){var t=e.parentNode;for(t&&t.rendered&&t.$node.addClass("parent-of-selected");t;)t.rendered&&t.$node.addClass("ancestor-of-selected"),t=t.parentNode;e.expanded&&e.childNodes.forEach((function(e){e.rendered&&e.$node.addClass("child-of-selected")}),this),e.rendered&&e.$node.select(!0)}}),this);for(var e=this.viewRangeRendered.from;e<this.viewRangeRendered.to&&!(e>=this.visibleNodesFlat.length);e++){var t=this.visibleNodesFlat[e];t&&t.rendered&&t.$node.toggleClass("group",Boolean(this.groupedNodes[t.id]))}this._updateNodePaddingsLeft(),this._highlightPrevSelectedNode(),this.scrollToSelection&&this.revealSelection()}},{key:"_renderCheckableStyle",value:function(){this.$data.toggleClass("checkable",this.isTreeNodeCheckEnabled())}},{key:"_highlightPrevSelectedNode",value:function(){this.isBreadcrumbStyleActive()&&this.prevSelectedNode&&this.prevSelectedNode.rendered&&!this.prevSelectedNode.prevSelectionAnimationDone&&this.prevSelectedNode.$node.addClassForAnimation("animate-prev-selected").oneAnimationEnd(function(){this.prevSelectedNode.prevSelectionAnimationDone=!0}.bind(this))}},{key:"_removeSelection",value:function(){0===this.selectedNodes.length&&this.nodes.forEach((function(e){e.rendered&&e.$node.removeClass("child-of-selected")}),this),this.prevSelectedNode&&this.prevSelectedNode.rendered&&this.prevSelectedNode.$node.removeClass("animate-prev-selected"),this.selectedNodes.forEach(this._removeNodeSelection,this)}},{key:"_removeNodeSelection",value:function(e){e.rendered&&e.$node.select(!1);var t=e.parentNode;for(t&&t.rendered&&t.$node.removeClass("parent-of-selected");t&&t.rendered;)t.$node.removeClass("ancestor-of-selected"),t=t.parentNode;e.expanded&&e.childNodes.forEach((function(e){e.rendered&&e.$node.removeClass("child-of-selected")}),this)}},{key:"_renderDropType",value:function(){this.dropType?this._installDragAndDropHandler():this._uninstallDragAndDropHandler()}},{key:"_installDragAndDropHandler",value:function(e){this.dragAndDropHandler||(this.dragAndDropHandler=Gt.handler(this,{supportedScoutTypes:Gt.SCOUT_TYPES.FILE_TRANSFER,dropType:function(){return this.dropType}.bind(this),dropMaximumSize:function(){return this.dropMaximumSize}.bind(this),additionalDropProperties:function(e){var t=s()(e.currentTarget),n={nodeId:""};if(t.hasClass("tree-node")){var i=t.data("node");n.nodeId=i.id}return n}}),this.dragAndDropHandler.install(this.$container,".tree-data,.tree-node"))}},{key:"_uninstallDragAndDropHandler",value:function(e){this.dragAndDropHandler&&(this.dragAndDropHandler.uninstall(),this.dragAndDropHandler=null)}},{key:"_updateMarkChildrenChecked",value:function(e,t,n,i){if(this.checkable){if(i){for(var r=!1,o=0;o<e.childNodes.length>0;o++){var s=e.childNodes[o];if(s.checked||s.childrenChecked){e.childrenChecked=!0,n=!0,r=!0,this.rendered&&e.$node&&e.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!0);break}}r||(e.childrenChecked=!1,this.rendered&&e.$node&&e.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!1))}if(e.parentNode&&!e.parentNode.checked){var a=!1;if(!n&&!t){for(var u=!1,l=0;l<e.parentNode.childNodes.length>0;l++){var c=e.parentNode.childNodes[l];if(c.checked||c.childrenChecked){u=!0;break}}u!==e.parentNode.childrenChecked&&(e.parentNode.childrenChecked=u,a=!0)}n&&!e.parentNode.childrenChecked&&(e.parentNode.childrenChecked=!0,a=!0),a&&(this._updateMarkChildrenChecked(e.parentNode,t,n),this.rendered&&e.parentNode.$node&&(n?e.parentNode.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!0):e.parentNode.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!1)))}}}},{key:"_installNodeTooltipSupport",value:function(){dh.install(this.$data,{parent:this,selector:".tree-node",text:this._nodeTooltipText.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Mt.get().isCustomEllipsisTooltipPossible()})}},{key:"_uninstallNodeTooltipSupport",value:function(){dh.uninstall(this.$data)}},{key:"_nodeTooltipText",value:function(e){var t=e.data("node");return t.tooltipText?t.tooltipText:this._isTruncatedNodeTooltipEnabled()&&e.isContentTruncated()?t.$text.text():void 0}},{key:"_isTruncatedNodeTooltipEnabled",value:function(){return!0}},{key:"setDisplayStyle",value:function(e){this.displayStyle!==e&&(this._renderViewportBlocked=!0,this._setDisplayStyle(e),this.rendered&&this._renderDisplayStyle(),this._renderViewportBlocked=!1)}},{key:"_setDisplayStyle",value:function(e){if(this._setProperty("displayStyle",e),this.displayStyle===o.DisplayStyle.BREADCRUMB){if(this.selectedNodes.length>0){var t=this.selectedNodes[0];t.expanded||this.expandNode(t)}this.addFilter(this.breadcrumbFilter,!0,!0),this.filterVisibleNodes()}else this.removeFilter(this.breadcrumbFilter,!0),this.filter()}},{key:"_updateNodePaddingsLeft",value:function(){this.$nodes().each(function(e,t){var n=s()(t),i=n.data("node"),r=this._computeNodePaddingLeft(i);n.css("padding-left",oi.isNullOrUndefined(r)?"":r)}.bind(this))}},{key:"setBreadcrumbStyleActive",value:function(e){e?this.setDisplayStyle(o.DisplayStyle.BREADCRUMB):this.setDisplayStyle(o.DisplayStyle.DEFAULT)}},{key:"isNodeInBreadcrumbVisible",value:function(e){return void 0!==this._inSelectionPathList[e.id]&&this._inSelectionPathList[e.id]}},{key:"isBreadcrumbStyleActive",value:function(){return this.displayStyle===o.DisplayStyle.BREADCRUMB}},{key:"setToggleBreadcrumbStyleEnabled",value:function(e){this.setProperty("toggleBreadcrumbStyleEnabled",e)}},{key:"setBreadcrumbTogglingThreshold",value:function(e){this.setProperty("breadcrumbTogglingThreshold",e)}},{key:"expandNode",value:function(e,t){this.setNodeExpanded(e,!0,t)}},{key:"collapseNode",value:function(e,t){this.setNodeExpanded(e,!1,t)}},{key:"collapseAll",value:function(){this.rebuildSuppressed=!0,this.visitNodes(function(e){this.collapseNode(e)}.bind(this)),this.rendered&&this._rerenderViewport(),this.rebuildSuppressed=!1}},{key:"setNodeExpanded",value:function(e,t,n){var i=(n=n||{}).lazy;oi.isNullOrUndefined(i)&&(i=e.expanded===t?e.expandedLazy:!!t&&e.lazyExpandingEnabled);var r=O.nvl(n.renderAnimated,!0);if(this.lazyExpandingEnabled||(i=!1),this.isBreadcrumbStyleActive()&&!t&&this.selectedNodes.indexOf(e)>-1)this.setNodeExpanded(e,!0,n);else{if(n.collapseChildNodes){var o=oi.valueCopy(n);o.renderExpansion=!1,e.childNodes.forEach(function(e){e.expanded&&this.collapseNode(e,o)}.bind(this))}var s={expansionChanged:!1,expandLazyChanged:!1};e.expanded===t&&e.expandedLazy===i||(s.expansionChanged=e.expanded!==t,s.expandLazyChanged=e.expandedLazy!==i,e.expanded=t,e.expandedLazy=i,this._applyFiltersForNode(e)&&s.expansionChanged?e.parentNode?this._rebuildParent(e.parentNode,n):e.filterAccepted?this._addToVisibleFlatList(e,!1):this._removeFromFlatList(e,!1):s.expandLazyChanged&&e.childNodes.forEach(function(e){this._applyFiltersForNode(e)}.bind(this)),this.groupedNodes[e.id]&&this._updateItemPath(!1,e),e.expanded?e.ensureLoadChildren().done(this._addChildrenToFlatList.bind(this,e,null,r,null,!0)):this._removeChildrenFromFlatList(e,r),this.trigger("nodeExpanded",{node:e,expanded:t,expandedLazy:i}),this.viewRangeDirty=!0),this.rendered&&O.nvl(n.renderExpansion,!0)&&this._renderExpansion(e,s),this.rendered&&this.ensureExpansionVisible(e)}}},{key:"setNodeExpandedRecursive",value:function(e,t,n){o.visitNodes(function(e){this.setNodeExpanded(e,t,n)}.bind(this),e)}},{key:"_rebuildParent",value:function(e,t){!this.rebuildSuppressed&&(e.expanded||e.expandedLazy?this._addChildrenToFlatList(e,null,!1,null,!0):this._removeChildrenFromFlatList(e,!1),this.rendered&&O.nvl(t.renderExpansion,!0))&&this._renderExpansion(e,{expansionChanged:!0})}},{key:"_removeChildrenFromFlatList",value:function(e,t){if(this.visibleNodesMap[e.id]){var n=this.visibleNodesFlat.indexOf(e),i=0,r=e.level,o=[];t=t&&this.rendered,this._$animationWrapper&&this._$animationWrapper.stop(!1,!0),this._$expandAnimationWrappers.forEach((function(e){e.stop(!1,!0)}));for(var a=n+1;a<this.visibleNodesFlat.length&&this.visibleNodesFlat[a].level>r;a++){var u=this.visibleNodesFlat[a];this.isHorizontalScrollingEnabled()&&u.width===this.maxNodeWidth&&(this.maxNodeWidth=0,this.nodeWidthDirty=!0),delete this.visibleNodesMap[this.visibleNodesFlat[a].id],u.attached&&t?(this._$animationWrapper||(this._$animationWrapper=s()('<div class="animation-wrapper">').insertBefore(u.$node),this._$animationWrapper.data("parentNode",e)),u.isDescendantOf(this._$animationWrapper.data("parentNode"))&&this._$animationWrapper.append(u.$node),u.attached=!1,u.displayBackup=u.$node.css("display"),o.push(u)):u.attached&&!t&&this.hideNode(u,!1,!1),i++}return this.visibleNodesFlat.splice(n+1,i),t&&(this._renderViewportBlocked=!0,o.length>0?this._$animationWrapper.animate({height:0},{start:this.startAnimationFunc,complete:l.bind(this,o),step:this.revalidateLayoutTree.bind(this),duration:200,queue:!1}):this._$animationWrapper?(this._$animationWrapper.remove(),this._$animationWrapper=null,l.call(this,o)):this._renderViewportBlocked=!1),o}function l(e){e.forEach((function(e){e.$node.detach(),e.$node.css("display",e.displayBackup),e.displayBackup=null})),this._$animationWrapper&&(this._$animationWrapper.remove(),this._$animationWrapper=null),this.runningAnimationsFinishFunc()}}},{key:"_removeFromFlatList",value:function(e,t){var n=[];if(this.visibleNodesMap[e.id]){var i=this.visibleNodesFlat.indexOf(e);this._removeChildrenFromFlatList(e,!1),this.isHorizontalScrollingEnabled()&&e.width===this.maxNodeWidth&&(this.maxNodeWidth=0,this.nodeWidthDirty=!0),n=et.ensure(this.visibleNodesFlat.splice(i,1)),delete this.visibleNodesMap[e.id],this.hideNode(e,t)}return n.push(e),n}},{key:"_addToVisibleFlatList",value:function(e,t){if(!this.visibleNodesMap[e.id]&&e.isFilterAccepted()&&(!e.parentNode||e.parentNode.expanded&&this.visibleNodesMap[e.parentNode.id]))if(this.initialTraversing)this._addToVisibleFlatListNoCheck(e,this.visibleNodesFlat.length,t);else{var n=this._findInsertPositionInFlatList(e);this._addToVisibleFlatListNoCheck(e,n,t)}}},{key:"_addChildrenToFlatList",value:function(e,t,n,i,r){if(!this.visibleNodesMap[e.id])return 0;var o=Boolean(i);return t=t||this.visibleNodesFlat.indexOf(e),n=n&&this.rendered,this._$animationWrapper&&!o&&this._$animationWrapper.stop(!1,!0),i?i.setInsertAt(t):i=this.newInsertBatch(t+1),e.childNodes.forEach(function(t,o){t.initialized&&t.isFilterAccepted(r)&&(this.visibleNodesMap[t.id]?(this.insertBatchInVisibleNodes(i,this._showNodes(i),n),this.checkAndHandleBatchAnimationWrapper(e,n,i),i=this.newInsertBatch(i.nextBatchInsertIndex()),i=this._addChildrenToFlatListIfExpanded(1,t,void 0,n,i,r),n=!1):(i.insertNodes.push(t),this.visibleNodesMap[t.id]=!0,i=this.checkAndHandleBatch(i,e,n),i=this._addChildrenToFlatListIfExpanded(0,t,void 0,n,i,r)))}.bind(this)),o||(this.insertBatchInVisibleNodes(i,this._showNodes(i),n),this.invalidateLayoutTree()),i}},{key:"_addChildrenToFlatListIfExpanded",value:function(e,t,n,i,r,o){return t.expanded&&t.childNodes.length&&(n=r.containsNode(t.parentNode)||r.length()>1?r.insertAt():this._findInsertPositionInFlatList(t),n+=e,r=this._addChildrenToFlatList(t,n,i,r,o)),r}},{key:"_showNodes",value:function(e){return this.viewRangeRendered.from+this.viewRangeSize>=e.lastBatchInsertIndex()&&this.viewRangeRendered.from<=e.lastBatchInsertIndex()}},{key:"_findInsertPositionInFlatList",value:function(e){var t,n=e.parentNode;t=n?n.childNodes:this.nodes;var i=e,r=t.filter(function(e){return Boolean(this.visibleNodesMap[e.id])||e===i}.bind(this));if(0===r.length)return this._findPositionInFlatList(n)+1;var o=r.indexOf(e);if(0===o)return this._findPositionInFlatList(n)+1;var s,a,u=r[o-1],l=this._findPositionInFlatList(u);if(-1===l)return this._findPositionInFlatList(n)+1;for(s=l;s<this.visibleNodesFlat.length;s++)if(a=this.visibleNodesFlat[s],!this._isInSameSubTree(u,a))return s;return this.visibleNodesFlat.length}},{key:"_findPositionInFlatList",value:function(e){return this.visibleNodesFlat.indexOf(e)}},{key:"_isInSameSubTree",value:function(e,t){do{if(t===e||t.parentNode===e)return!0;t=t.parentNode}while(t);return!1}},{key:"_isChildOfSelectedNodes",value:function(e){for(;e;){if(this.selectedNodes.indexOf(e.parentNode)>-1)return!0;e=e.parentNode}return!1}},{key:"newInsertBatch",value:function(e){return{insertNodes:[e,0],$animationWrapper:null,lastBatchInsertIndex:function(){return this.isEmpty()?this.insertAt():this.insertAt()+this.insertNodes.length-3},nextBatchInsertIndex:function(){return this.lastBatchInsertIndex()+(this.isEmpty()?1:2)},isEmpty:function(){return 2===this.insertNodes.length},length:function(){return this.insertNodes.length-2},insertAt:function(){return this.insertNodes[0]},setInsertAt:function(e){this.insertNodes[0]=e},containsNode:function(e){return-1!==this.insertNodes.indexOf(e)}}}},{key:"checkAndHandleBatchAnimationWrapper",value:function(e,t,n){if(t&&this.viewRangeRendered.from<=n.lastBatchInsertIndex()&&this.viewRangeRendered.to>=n.lastBatchInsertIndex()&&!n.$animationWrapper){var i=n.lastBatchInsertIndex()-1,r=this.viewRangeRendered.from===n.lastBatchInsertIndex()?null:this.visibleNodesFlat[i];if(r&&i>=this.viewRangeRendered.from&&i<this.viewRangeRendered.to&&!r.attached&&this.showNode(r,!1,i),r&&r.attached)n.$animationWrapper=s()('<div class="animation-wrapper">').insertAfter(r.$node);else if(e.attached)n.$animationWrapper=s()('<div class="animation-wrapper">').insertAfter(e.$node);else if(this.$fillBefore)n.$animationWrapper=s()('<div class="animation-wrapper">').insertAfter(this.$fillBefore);else{var o=this.visibleNodesFlat[n.lastBatchInsertIndex()];n.$animationWrapper=s()('<div class="animation-wrapper">').insertBefore(o.$node)}n.animationCompleteFunc=function(){n.$animationWrapper.replaceWith(n.$animationWrapper.contents()),et.remove(this._$expandAnimationWrappers,n.$animationWrapper),n.$animationWrapper=null,this.runningAnimationsFinishFunc()},this._$expandAnimationWrappers.push(n.$animationWrapper)}}},{key:"checkAndHandleBatch",value:function(e,t,n){return this.viewRangeRendered.from-1===e.lastBatchInsertIndex()&&(this.insertBatchInVisibleNodes(e,!1,!1),e=this.newInsertBatch(e.lastBatchInsertIndex()+1)),this.checkAndHandleBatchAnimationWrapper(t,n,e),this.viewRangeRendered.from+this.viewRangeSize-1===e.lastBatchInsertIndex()&&(this.insertBatchInVisibleNodes(e,!0,n),e=this.newInsertBatch(e.lastBatchInsertIndex()+1)),e}},{key:"insertBatchInVisibleNodes",value:function(e,t,n){if(!e.isEmpty())if(this.visibleNodesFlat.splice.apply(this.visibleNodesFlat,e.insertNodes),t){for(var i=e.insertAt(),r=2;r<e.insertNodes.length;r++){var o=e.insertNodes[r];this.showNode(o,!1,i),e.$animationWrapper&&e.$animationWrapper.append(o.$node),i++}if(e.$animationWrapper){var s=e.$animationWrapper.outerHeight();e.$animationWrapper.css("height",0).animate({height:s},{start:this.startAnimationFunc,complete:e.animationCompleteFunc.bind(this),step:this.revalidateLayoutTree.bind(this),duration:200,queue:!1})}}else e.$animationWrapper&&e.animationCompleteFunc&&e.animationCompleteFunc.call(this)}},{key:"_addToVisibleFlatListNoCheck",value:function(e,t,n){et.insert(this.visibleNodesFlat,e,t),this.visibleNodesMap[e.id]=!0,this.rendered&&this.showNode(e,n,t)}},{key:"scrollTo",value:function(e,t){0!==this.viewRangeRendered.size()&&(e.attached||this._renderViewRangeForNode(e),e.attached&&wf.scrollTo(this.$data,e.$node,t))}},{key:"revealSelection",value:function(){this.rendered?this.selectedNodes.length>0&&(this.visibleNodesMap[this.selectedNodes[0].id]||this._expandAllParentNodes(this.selectedNodes[0]),this.scrollTo(this.selectedNodes[0]),this.ensureExpansionVisible(this.selectedNodes[0])):this.session.layoutValidator.schedulePostValidateFunction(this.revealSelection.bind(this))}},{key:"ensureExpansionVisible",value:function(e){e&&e.$node&&this.selectedNodes[0]===e&&wf.ensureExpansionVisible({element:e,$element:e.$node,$scrollable:this.get$Scrollable(),isExpanded:function(e){return e.expanded},getChildren:function(e){return e.childNodes},nodePaddingLevel:this.nodePaddingLevel,defaultChildHeight:this.nodeHeight})}},{key:"deselectAll",value:function(){this.selectNodes([])}},{key:"selectNode",value:function(e,t){this.selectNodes(e,t)}},{key:"selectNodes",value:function(e,t){e=et.ensure(e),et.equalsIgnoreOrder(e,this.selectedNodes)||(this.rendered&&(this._rememberScrollTopBeforeSelection(),this._removeSelection()),this.prevSelectedNode&&(this.prevSelectedNode.prevSelectionAnimationDone=!1),this.prevSelectedNode=this.selectedNodes[0],this._setSelectedNodes(e,t),this.rendered&&(this._renderSelection(),this._updateScrollTopAfterSelection()))}},{key:"_rememberScrollTopBeforeSelection",value:function(){this.isBreadcrumbStyleActive()?this.selectedNodes.length>0&&(this.scrollTopHistory[this.selectedNodes[0].level]=this.$data[0].scrollTop):this.scrollTopHistory=[]}},{key:"_updateScrollTopAfterSelection",value:function(){if(this.isBreadcrumbStyleActive()){var e=-1;this.selectedNodes.length>0&&(e=this.selectedNodes[0].level),this.scrollTopHistory.splice(e+1);var t=this.scrollTopHistory[e];t>=0&&this.setScrollTop(t)}}},{key:"_setSelectedNodes",value:function(e,t){this.selectedNodes=e.slice(),this._nodesSelectedInternal(),this._triggerNodesSelected(t),this.selectedNodes.length>0&&!this.visibleNodesMap[this.selectedNodes[0].id]&&this._expandAllParentNodes(this.selectedNodes[0]),this._updateItemPath(!0),this.isBreadcrumbStyleActive()&&(this.selectedNodes.length>0&&!this.selectedNodes[0].expanded&&(this.expandNode(this.selectedNodes[0]),this.selectedNodes[0].filterDirty=!0),this.filter(!0)),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_nodesSelectedInternal",value:function(e){}},{key:"deselectNode",value:function(e){this.deselectNodes(e)}},{key:"deselectNodes",value:function(e,t){e=et.ensure(e),(t=t||{}).collectChildren&&(e=e.concat(this._collectNodesIfDescendants(e,this.selectedNodes)));var n=this.selectedNodes.slice();et.removeAll(n,e)&&this.selectNodes(n)}},{key:"isNodeSelected",value:function(e){return this.selectedNodes.indexOf(e)>-1}},{key:"_computeNodePaddingLeft",value:function(e){if(this._computeNodePaddings(),this.isBreadcrumbStyleActive())return null;var t=e.level*this.nodePaddingLevel+this.nodePaddingLeft;return this.checkable&&(t+=this.nodeCheckBoxPaddingLeft),t}},{key:"_computeNodePaddings",value:function(){if(null===this.nodePaddingLeft||null===this.nodeControlPaddingLeft){var e=this.$data.appendDiv("tree-node"),t=e.appendDiv("tree-node-control");null===this.nodePaddingLeft&&(this.nodePaddingLeft=e.cssPaddingLeft()),null===this.nodeControlPaddingLeft&&(this.nodeControlPaddingLeft=t.cssPaddingLeft()),e.remove()}}},{key:"_expandAllParentNodes",value:function(e){var t,n=e,i=[];n=e;for(var r=[];n.parentNode;)i.push(n.parentNode),this.visibleNodesMap[n.id]||r.push(n),n=n.parentNode;for(t=i.length-1;t>=0;t--)-1!==r.indexOf(i[t])&&this._addToVisibleFlatList(i[t],!1),i[t].expanded||this.expandNode(i[t],{renderExpansion:!1,renderAnimated:!1});this.rendered&&r.length>0&&(this._rerenderViewport(),this.invalidateLayoutTree())}},{key:"_updateChildNodeIndex",value:function(e,t){if(e&&e.length)for(var n=O.nvl(t,0);n<e.length;n++)e[n].childNodeIndex=n}},{key:"insertNode",value:function(e,t){this.insertNodes([e],t)}},{key:"insertNodes",value:function(e,t){if(e=et.ensure(e).slice(),this._ensureTreeNodes(e),t&&!(t instanceof XL))throw new Error("parent has to be a tree node: "+t);e.sort((function(e,t){return e.childNodeIndex-t.childNodeIndex})),t?(t.childNodes&&t.childNodes.length>0?(e.forEach((function(e){t.childNodes.indexOf(e)<0&&et.insert(t.childNodes,e,e.childNodeIndex)})),this._updateChildNodeIndex(t.childNodes,e[0].childNodeIndex)):e.forEach((function(e){t.childNodes.push(e)})),o.visitNodes(this._initTreeNode.bind(this),e,t),o.visitNodes(this._updateFlatListAndSelectionPath.bind(this),e,t),this.groupedNodes[t.id]&&this._updateItemPath(!1,t),this.rendered&&(this._renderExpansion(t,{expansionChanged:!0}),this.ensureExpansionVisible(t))):(this.nodes&&this.nodes.length>0?(e.forEach(function(e){this.nodes.indexOf(e)<0&&et.insert(this.nodes,e,e.childNodeIndex)}.bind(this)),this._updateChildNodeIndex(this.nodes,e[0].childNodeIndex)):et.pushAll(this.nodes,e),o.visitNodes(this._initTreeNode.bind(this),e,t),o.visitNodes(this._updateFlatListAndSelectionPath.bind(this),e,t)),this.rendered&&(this.viewRangeDirty=!0,this.invalidateLayoutTree()),this.trigger("nodesInserted",{nodes:e,parentNode:t})}},{key:"updateNode",value:function(e){this.updateNodes([e])}},{key:"updateNodes",value:function(e){(e=et.ensure(e)).forEach((function(e){var t,n=this.nodesMap[e.id];e===n?t=!0:(this._applyNodeDefaultValues(e),t=this._applyUpdatedNodeProperties(n,e)),t&&(this._applyFiltersForNode(n)&&(n.isFilterAccepted()?this._addToVisibleFlatList(n,!1):(this._nodesFiltered([n]),this._removeFromFlatList(n,!1))),this._updateItemPath(!1,n.parentNode),this.rendered&&n._decorate())}),this),this.trigger("nodesUpdated",{nodes:e})}},{key:"_applyUpdatedNodeProperties",value:function(e,t){var n=!1;return e.leaf!==t.leaf&&(e.leaf=t.leaf,n=!0),e.enabled!==t.enabled&&(e.enabled=t.enabled,n=!0),e.lazyExpandingEnabled!==t.lazyExpandingEnabled&&(e.lazyExpandingEnabled=t.lazyExpandingEnabled,t.lazyExpandingEnabled&&this.lazyExpandingEnabled||(e.expandedLazy=!1),n=!0),n}},{key:"deleteNode",value:function(e,t){this.deleteNodes([e],t)}},{key:"deleteAllNodes",value:function(){this.deleteAllChildNodes()}},{key:"deleteNodes",value:function(e,t){var n=[],i=[],r=[];(e=et.ensure(e).slice()).forEach((function(e){var s=t||e.parentNode;if(s){if(e.parentNode!==s)throw new Error("Unexpected parent. Node.parent: "+e.parentNode+", parentNode: "+t);et.remove(s.childNodes,e),-1===i.indexOf(s)&&i.push(s)}else et.remove(this.nodes,e),r=this.nodes;this._destroyTreeNode(e),n.push(e),this._updateMarkChildrenChecked(e,!1,!1),o.visitNodes(this._destroyTreeNode.bind(this),e.childNodes)}),this),i.forEach((function(e){this._updateChildNodeIndex(e.childNodes)}),this),this._updateChildNodeIndex(r),this.deselectNodes(n,{collectChildren:!0}),this.uncheckNodes(n,{collectChildren:!0}),this.rendered&&this._removeNodes(n,t||i),this.trigger("nodesDeleted",{nodes:e,parentNode:t})}},{key:"_collectNodesIfDescendants",value:function(e,t){var n=[];return t.forEach((function(t){e.some((function(e){return e.isAncestorOf(t)}))&&n.push(t)})),n}},{key:"deleteAllChildNodes",value:function(e){var t;e?(t=e.childNodes,e.childNodes=[]):(t=this.nodes,this.nodes=[]),o.visitNodes(function(e){this._destroyTreeNode(e),this._updateMarkChildrenChecked(e,!1,!1)}.bind(this),t),this.deselectNodes(t,{collectChildren:!0}),this.uncheckNodes(t,{collectChildren:!0}),this.rendered&&this._removeNodes(t,e),this.trigger("allChildNodesDeleted",{parentNode:e})}},{key:"updateNodeOrder",value:function(e,t){if(e=et.ensure(e),this._updateChildNodeIndex(e),t){if(t.childNodes.length!==e.length)throw new Error("Node order may not be updated because lengths of the arrays differ.");t.childNodes=e.slice(),this._removeChildrenFromFlatList(t,!1),t.expanded&&this._addChildrenToFlatList(t,null,!1)}else{if(this.nodes.length!==e.length)throw new Error("Node order may not be updated because lengths of the arrays differ.");this.nodes=e.slice(),this.nodes.forEach((function(e){this._removeFromFlatList(e,!1),this._addToVisibleFlatList(e,!1),e.expanded&&this._addChildrenToFlatList(e,null,!1)}),this)}this.trigger("childNodeOrderChanged",{parentNode:t})}},{key:"checkNode",value:function(e,t,n){var i=s.a.extend(n,{checked:t});this.checkNodes([e],i)}},{key:"checkNodes",value:function(e,t){var n={checked:!0,checkOnlyEnabled:!0,checkChildren:this.autoCheckChildren,triggerNodesChecked:!0};s.a.extend(n,t);var i=[];!this.checkable||!this.enabledComputed&&n.checkOnlyEnabled||((e=et.ensure(e)).forEach((function(e){if(!e.enabled&&n.checkOnlyEnabled||e.checked===n.checked)n.checkChildren&&this.checkNodes(e.childNodes,n);else{if(!this.multiCheck&&n.checked){for(var t=0;t<this.checkedNodes.length;t++)this.checkedNodes[t].checked=!1,this._updateMarkChildrenChecked(this.checkedNodes[t],!1,!1,!0),i.push(this.checkedNodes[t]);this.checkedNodes=[]}if(e.checked=n.checked,e.checked?this.checkedNodes.push(e):et.remove(this.checkedNodes,e),i.push(e),this._updateMarkChildrenChecked(e,!1,n.checked,!0),n.checkChildren){var r=s.a.extend({},n,{triggerNodesChecked:!1});this.checkNodes(e.childNodes,r)}}}),this),n.triggerNodesChecked&&i.length>0&&this.trigger("nodesChecked",{nodes:i}),this.rendered&&i.forEach((function(e){e._renderChecked()})))}},{key:"uncheckNode",value:function(e,t){var n=s.a.extend({checkOnlyEnabled:!0},t);this.uncheckNodes([e],n)}},{key:"uncheckNodes",value:function(e,t){var n={checked:!1};s.a.extend(n,t),n.collectChildren&&(e=e.concat(this._collectNodesIfDescendants(e,this.checkedNodes))),this.checkNodes(e,n)}},{key:"_triggerNodesSelected",value:function(e){this.trigger("nodesSelected",{debounce:e})}},{key:"_showContextMenu",value:function(e){this.session.onRequestsDone(function(e){if(this.rendered){var t=this._filterMenus(this.menus,_b.CONTEXT_MENU,!0),n=s()(e.currentTarget);0!==t.length&&(this.contextMenu&&this.contextMenu.close(),this.contextMenu=O.create("ContextMenuPopup",{parent:this,menuItems:t,location:{x:e.pageX,y:e.pageY},$anchor:n,menuFilter:this._filterMenusHandler}),this.contextMenu.open())}}.bind(this),e)}},{key:"_onNodeMouseDown",value:function(e){if(this._doubleClickSupport.mousedown(e),this._doubleClickSupport.doubleClicked())return!1;var t=s()(e.currentTarget),n=t.data("node");return this.hasNode(n)?(this._$mouseDownNode=t,t.window().one("mouseup",function(){this._$mouseDownNode=null}.bind(this)),this.selectNodes(n),this.checkable&&n.enabled&&this._isCheckboxClicked(e)&&(Mt.get().loosesFocusIfPseudoElementIsRemoved()&&this.focusAndPreventDefault(e),this.checkNode(n,!n.checked)),!0):void 0}},{key:"_onNodeMouseUp",value:function(e){if(this._doubleClickSupport.doubleClicked())return!1;var t=s()(e.currentTarget),n=t.data("node");return this._$mouseDownNode&&this._$mouseDownNode[0]===t[0]?(this.trigger("nodeClick",{node:n}),!0):void 0}},{key:"_isCheckboxClicked",value:function(e){return!!this.isTreeNodeCheckEnabled()||s()(e.target).is(".check-box")}},{key:"_updateItemPath",value:function(e,t){var n,i;if(e&&(this.groupedNodes={},this._inSelectionPathList={}),!t){if(0===(n=this.selectedNodes).length)return;for(i=n[0],e&&(this._inSelectionPathList[i.id]=!0,i.childNodes&&i.childNodes.forEach(function(e){this._inSelectionPathList[e.id]=!0}.bind(this))),i.level;i.parentNode;){var r=i.parentNode;if(this._isGroupingEnd(r)&&!t&&(t=i,!e))break;e&&(this._inSelectionPathList[r.id]=!0),i=r}t=t||n[0],this.groupedNodes[t.id]=!0}(i=t)&&i.expanded&&this.groupedNodes[i.id]&&function e(t){t.forEach(function(t){this.groupedNodes[t.id]=!0,t._decorate(),t.expanded&&t.isFilterAccepted()&&e.call(this,t.childNodes)}.bind(this))}.call(this,i.childNodes)}},{key:"_isGroupingEnd",value:function(e){return!1}},{key:"selectedNode",value:function(){return 0===this.selectedNodes.length?null:this.selectedNodes[0]}},{key:"$selectedNodes",value:function(){return this.$data.find(".selected")}},{key:"$nodes",value:function(){return this.$data.find(".tree-node")}},{key:"addFilter",value:function(e,t,n){return this._filters.indexOf(e)<0&&(this._filters.push(e),t||this.filter(n),!0)}},{key:"removeFilter",value:function(e,t){et.remove(this._filters,e)&&this.filter(t)}},{key:"filter",value:function(e){var t=Boolean(!e),n=[];this.visitNodes(function(e){return this._applyFiltersForNode(e)?(e.isFilterAccepted()?this._addToVisibleFlatList(e,t):et.pushAll(n,this._removeFromFlatList(e,t)),this.viewRangeDirty=!0):e.attached||(this.showNode(e,t),e.attached&&e.$node.insertAfter(e.$node.nextAll(".hiding:last"))),!e.expanded&&!e.expandedLazy||!e.isFilterAccepted()}.bind(this)),this._nodesFiltered(n)}},{key:"filterVisibleNodes",value:function(e){for(var t=[],n=0;n<this.visibleNodesFlat.length;n++){var i=this.visibleNodesFlat[n];this._applyFiltersForNode(i)&&(i.isFilterAccepted()||(n--,et.pushAll(t,this._removeFromFlatList(i,e))),this.viewRangeDirty=!0)}this._nodesFiltered(t)}},{key:"_nodesFiltered",value:function(e){this.deselectNodes(e)}},{key:"_nodeAcceptedByFilters",value:function(e){for(var t=0;t<this._filters.length;t++)if(!this._filters[t].accept(e))return!1;return!0}},{key:"_applyFiltersForNode",value:function(e){var t=e.filterDirty;return this._nodeAcceptedByFilters(e)?e.filterAccepted||(e.filterAccepted=!0,t=!0):e.filterAccepted&&(e.filterAccepted=!1,t=!0),!!t&&(e.filterDirty=!1,e.childNodes.forEach((function(e){e.filterDirty=!0})),!0)}},{key:"_insertNodesInDOM",value:function(e,t){(this.rendered||this.rendering)&&(e=e.filter((function(e){var n=void 0===t?this.visibleNodesFlat.indexOf(e):t;return-1!==n&&this.viewRangeRendered.from+this.viewRangeSize>=n&&this.viewRangeRendered.from<=n&&this.viewRangeRendered.size()>0&&!e.attached&&(e.rendered||this._renderNode(e),e._decorate(),this._insertNodeInDOMAtPlace(e,n),this.prevSelectedNode===e&&this._highlightPrevSelectedNode(),e.rendered=!0,e.attached=!0,!0)}),this),this._installNodes(e))}},{key:"_installNodes",value:function(e){this.isHorizontalScrollingEnabled()&&e.forEach((function(e){e.$node.css("width","auto"),e.$node.css("display","inline-block")}),this),e.forEach((function(e){if(e.height=e.$node.outerHeight(!0),this.isHorizontalScrollingEnabled()){var t=e.$node.outerWidth();(e.width?e.width:0)===this.maxNodeWidth&&t<this.maxNodeWidth?(this.maxNodeWidth=0,this.nodeWidthDirty=!0):t>this.maxNodeWidth&&(this.maxNodeWidth=t,this.nodeWidthDirty=!0),e.width=t}}),this),this.isHorizontalScrollingEnabled()&&e.forEach((function(e){this.nodeWidthDirty||e.$node.css("width",this.maxNodeWidth),e.$node.css("display","")}),this)}},{key:"_ensureNodeInDOM",value:function(e,t,n){e&&!e.attached&&e===this.visibleNodesFlat[n]&&n>=this.viewRangeRendered.from&&n<this.viewRangeRendered.to&&this.showNode(e,t,n)}},{key:"_insertNodeInDOMAtPlace",value:function(e,t){var n=e.$node;if(0!==t){var i=this.visibleNodesFlat[t-1];if(this._ensureNodeInDOM(i,!1,t-1),i.attached)n.insertAfter(i.$node);else{if(t+1<this.visibleNodesFlat.length){var r=this.visibleNodesFlat[t+1];if(r.attached)return void n.insertBefore(r.$node)}this.$fillBefore?n.insertAfter(this.$fillBefore):this.$data.prepend(n)}}else this.$fillBefore?n.insertAfter(this.$fillBefore):this.$data.prepend(n)}},{key:"showNode",value:function(e,t,n){if(this.rendered&&(!e.attached||e.$node.hasClass("hiding"))&&(e.attached||(this._ensureNodeInDOM(e.parentNode,t,n-1),this._insertNodesInDOM([e],n)),e.rendered)){var i=e.$node;if(!i.is(".showing")){i.addClass("showing"),i.removeClass("hiding");var r=this;t&&(i.hide(),i.stop(!1,!0).slideDown({duration:250,start:r.startAnimationFunc,complete:function(){r.runningAnimationsFinishFunc(),i.removeClass("showing")}}))}}}},{key:"hideNode",value:function(e,t,n){if(e.attached){this.viewRangeDirty=!0;var i=this,r=e.$node;r&&(r.is(".hiding")||(r.addClass("hiding"),r.removeClass("showing"),t?(this._renderViewportBlocked=!0,r.stop(!1,!0).slideUp({duration:250,start:i.startAnimationFunc,complete:function(){i.runningAnimationsFinishFunc(),r.removeClass("hiding"),r.hasClass("showing")||(r.detach(),e.attached=!1)}})):n||(r.detach(),e.attached=!1,i.invalidateLayoutTree())))}}},{key:"_nodesToIds",value:function(e){return e.map((function(e){return e.id}))}},{key:"_nodesByIds",value:function(e){return e.map(function(e){return this.nodesMap[e]}.bind(this))}},{key:"_nodeById",value:function(e){return this.nodesMap[e]}},{key:"hasNode",value:function(e){return Boolean(this._nodeById(e.id))}},{key:"_onNodeDoubleClick",value:function(e){if(!this.isBreadcrumbStyleActive()){var t=s()(e.currentTarget),n=t.data("node"),i=!t.hasClass("expanded");this.doNodeAction(n,i)}}},{key:"doNodeAction",value:function(e,t){this.trigger("nodeAction",{node:e}),!0===this.checkable&&this.isTreeNodeCheckEnabled()&&e.enabled||this.setNodeExpanded(e,t,{lazy:!1})}},{key:"_onNodeControlMouseDown",value:function(e){if(this._doubleClickSupport.mousedown(e),this._doubleClickSupport.doubleClicked())return!1;var t=s()(e.currentTarget).parent(),n=t.data("node"),i=!t.hasClass("expanded"),r={lazy:!1};if(t.hasClass("lazy")){if(!e.ctrlKey&&!e.shiftKey)return this.expandNode(n,r),!1;i=!1,r.collapseChildNodes=!0}return this.requestFocusOnNodeControlMouseDown&&this.focus(),this.selectNodes(n),this.setNodeExpanded(n,i,r),s.a.suppressEvent(e),!0}},{key:"_onNodeControlMouseUp",value:function(e){return!1}},{key:"_onNodeControlDoubleClick",value:function(e){return!1}},{key:"_onContextMenu",value:function(e){e.preventDefault(),this._showContextMenu(e)}},{key:"changeNode",value:function(e){this._applyFiltersForNode(e)&&(e.isFilterAccepted()?this._addToVisibleFlatList(e,!1):this._removeFromFlatList(e,!1)),this.rendered&&e._decorate(),this.trigger("nodeChanged",{node:e})}},{key:"_onDesktopPopupOpen",value:function(e){var t=e.popup;this.enabledComputed&&this.has(t)&&t instanceof Rg&&(this.$container.addClass("focused"),t.one("destroy",function(){this.rendered&&this.$container.removeClass("focused")}.bind(this)))}},{key:"updateScrollbars",value:function(){wf.update(this.$data)}}])&&FL(t.prototype,n),i&&FL(t,i),o}(de);function HL(e){return(HL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function WL(e,t,n){return(WL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KL(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function zL(e,t){return(zL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=KL(e);if(t){var r=KL(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return UL(this,n)}}function UL(e,t){return!t||"object"!==HL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KL(e){return(KL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}BL(NL,"DisplayStyle",{DEFAULT:"default",BREADCRUMB:"breadcrumb"}),BL(NL,"CheckableStyle",{CHECKBOX:"checkbox",CHECKBOX_TREE_NODE:"checkbox_tree_node"}),BL(NL,"VIEW_RANGE_DIVISOR",4);var qL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zL(e,t)}(o,e);var t,n,i,r=GL(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["displayStyle"]),e}return t=o,(n=[{key:"_sendNodesSelected",value:function(e,t){var n={nodeIds:e};this._send("nodesSelected",n,{delay:t?250:0,coalesce:function(e){return this.target===e.target&&this.type===e.type}})}},{key:"_onWidgetNodeClick",value:function(e){this._send("nodeClick",{nodeId:e.node.id})}},{key:"_onWidgetNodeAction",value:function(e){this._send("nodeAction",{nodeId:e.node.id})}},{key:"_onWidgetNodesSelected",value:function(e){var t=this.widget._nodesToIds(this.widget.selectedNodes);this._sendNodesSelected(t,e.debounce)}},{key:"_onWidgetNodeExpanded",value:function(e){this._send("nodeExpanded",{nodeId:e.node.id,expanded:e.expanded,expandedLazy:e.expandedLazy})}},{key:"_onWidgetNodesChecked",value:function(e){this._sendNodesChecked(e.nodes)}},{key:"_sendNodesChecked",value:function(e){for(var t={nodes:[]},n=0;n<e.length;n++)t.nodes.push({nodeId:e[n].id,checked:e[n].checked});this._send("nodesChecked",t)}},{key:"_onWidgetEvent",value:function(e){"nodesSelected"===e.type?this._onWidgetNodesSelected(e):"nodeClick"===e.type?this._onWidgetNodeClick(e):"nodeAction"===e.type?this._onWidgetNodeAction(e):"nodeExpanded"===e.type?this._onWidgetNodeExpanded(e):"nodesChecked"===e.type?this._onWidgetNodesChecked(e):WL(KL(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"onModelAction",value:function(e){"nodesInserted"===e.type?this._onNodesInserted(e.nodes,e.commonParentNodeId):"nodesUpdated"===e.type?this._onNodesUpdated(e.nodes):"nodesDeleted"===e.type?this._onNodesDeleted(e.nodeIds,e.commonParentNodeId):"allChildNodesDeleted"===e.type?this._onAllChildNodesDeleted(e.commonParentNodeId):"nodesSelected"===e.type?this._onNodesSelected(e.nodeIds):"nodeExpanded"===e.type?this._onNodeExpanded(e.nodeId,e):"nodeChanged"===e.type?this._onNodeChanged(e.nodeId,e):"nodesChecked"===e.type?this._onNodesChecked(e.nodes):"childNodeOrderChanged"===e.type?this._onChildNodeOrderChanged(e.childNodeIds,e.parentNodeId):"requestFocus"===e.type?this._onRequestFocus():"scrollToSelection"===e.type?this._onScrollToSelection():WL(KL(o.prototype),"onModelAction",this).call(this,e)}},{key:"_onNodesInserted",value:function(e,t){var n;if(null!=t&&!(n=this.widget.nodesMap[t]))throw new Error("Parent node could not be found. Id: "+t);this.widget.insertNodes(e,n)}},{key:"_onNodesUpdated",value:function(e){this.widget.updateNodes(e)}},{key:"_onNodesDeleted",value:function(e,t){var n;if(null!=t&&!(n=this.widget.nodesMap[t]))throw new Error("Parent node could not be found. Id: "+t);this.addFilterForWidgetEventType("nodesSelected"),this.addFilterForWidgetEventType("nodesChecked");var i=this.widget._nodesByIds(e);this.widget.deleteNodes(i,n)}},{key:"_onAllChildNodesDeleted",value:function(e){var t;if(null!=e&&!(t=this.widget.nodesMap[e]))throw new Error("Parent node could not be found. Id: "+e);this.addFilterForWidgetEventType("nodesSelected"),this.addFilterForWidgetEventType("nodesChecked"),this.widget.deleteAllChildNodes(t)}},{key:"_onNodesSelected",value:function(e){this.addFilterForWidgetEvent(function(t){return"nodesSelected"===t.type&&et.equals(e,this.widget._nodesToIds(this.widget.selectedNodes))}.bind(this));var t=this.widget._nodesByIds(e);this.widget.selectNodes(t)}},{key:"_onNodeExpanded",value:function(e,t){var n=this.widget.nodesMap[e],i={lazy:t.expandedLazy},r=oi.createMap();r[e]=!0,t.recursive&&NL.visitNodes((function(e){r[e.id]=!0}),n.childNodes),this.addFilterForWidgetEvent((function(e){return"nodeExpanded"===e.type&&r[e.node.id]&&t.expanded===e.expanded&&t.expandedLazy===e.expandedLazy})),this.widget.setNodeExpanded(n,t.expanded,i),t.recursive&&this.widget.setNodeExpandedRecursive(n.childNodes,t.expanded,i)}},{key:"_onNodeChanged",value:function(e,t){var n=this.widget.nodesMap[e];Pt.applyTo(t,"TreeNode"),n.text=t.text,n.cssClass=t.cssClass,n.iconId=t.iconId,n.tooltipText=t.tooltipText,n.foregroundColor=t.foregroundColor,n.backgroundColor=t.backgroundColor,n.font=t.font,n.htmlEnabled=t.htmlEnabled,this.widget.changeNode(n)}},{key:"_onNodesChecked",value:function(e){var t=[],n=[];e.forEach((function(e){var i=this.widget._nodeById(e.id);e.checked?t.push(i):n.push(i)}),this),this.addFilterForWidgetEventType("nodesChecked"),this.widget.checkNodes(t,{checked:!0,checkChildren:!1,checkOnlyEnabled:!1}),this.widget.uncheckNodes(n,{checkChildren:!1,checkOnlyEnabled:!1})}},{key:"_onChildNodeOrderChanged",value:function(e,t){var n=this.widget._nodeById([t]),i=this.widget._nodesByIds(e);this.widget.updateNodeOrder(i,n)}},{key:"_onRequestFocus",value:function(){this.widget.focus()}},{key:"_onScrollToSelection",value:function(){this.widget.revealSelection()}}])&&VL(t.prototype,n),i&&VL(t,i),o}(fe);function YL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var XL=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$node=null,this.$text=null,this.attached=!1,this.checked=!1,this.childNodes=[],this.childrenLoaded=!1,this.childrenChecked=!1,this.cssClass=null,this.destroyed=!1,this.enabled=!0,this.expanded=!1,this.expandedLazy=!1,this.filterAccepted=!0,this.filterDirty=!1,this.htmlEnabled=!1,this.iconId=null,this.id=null,this.initialized=!1,this.initialExpanded=!1,this.lazyExpandingEnabled=!1,this.leaf=!1,this.level=0,this.parent=null,this.parentNode=void 0,this.prevSelectionAnimationDone=!1,this.rendered=!1,this.session=null,this.text=null,this._loadChildrenPromise=!1}var t,n,i;return t=e,(n=[{key:"init",value:function(e){var t=this._jsonModel();t&&(e=s.a.extend({},t,e)),this._init(e),void 0===e.initialExpanded&&(this.initialExpanded=this.expanded)}},{key:"destroy",value:function(){this.destroyed||(this._destroy(),this.destroyed=!0)}},{key:"_destroy",value:function(){}},{key:"getTree",value:function(){return this.parent}},{key:"_init",value:function(e){O.assertParameter("parent",e.parent,NL),this.session=e.session||e.parent.session,s.a.extend(this,e),Pt.applyTo(this),th.resolveTextProperty(this,"text"),sn.resolveIconProperty(this,"iconId"),this.hasChildNodes()&&this.getTree()._ensureTreeNodes(this.childNodes)}},{key:"_jsonModel",value:function(){}},{key:"reset",value:function(){this.$node&&(this.$node.remove(),this.$node=null),this.rendered=!1,this.attached=!1}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isAncestorOf",value:function(e){for(;e;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}},{key:"isDescendantOf",value:function(e){return e===this.parentNode||!!this.parentNode&&this.parentNode.isDescendantOf(e)}},{key:"isChildOf",value:function(e){return this.isDescendantOf(e)}},{key:"isFilterAccepted",value:function(e){return(this.filterDirty||e)&&this.getTree()._applyFiltersForNode(this),this.filterAccepted}},{key:"loadChildren",value:function(){return s.a.resolvedDeferred()}},{key:"ensureLoadChildren",value:function(){if(this.childrenLoaded)return s.a.resolvedPromise();if(this._loadChildrenPromise)return this._loadChildrenPromise;var e=this.loadChildren(),t=e.promise();return"resolved"===e.state()?(this._loadChildrenPromise=null,t):(this._loadChildrenPromise=t,t.done(this._onLoadChildrenDone.bind(this)),t)}},{key:"_onLoadChildrenDone",value:function(){this._loadChildrenPromise=null}},{key:"setText",value:function(e){this.text=e}},{key:"render",value:function(e,t){this.$node=e.makeDiv("tree-node").data("node",this).attr("data-nodeid",this.id).attr("data-level",this.level),oi.isNullOrUndefined(t)||this.$node.css("padding-left",t),this.$text=this.$node.appendSpan("text"),this._renderControl(),this.getTree().checkable&&this._renderCheckbox(),this._renderText(),this._renderIcon()}},{key:"_renderText",value:function(){this.htmlEnabled?this.$text.html(this.text):this.$text.textOrNbsp(this.text)}},{key:"_renderChecked",value:function(){this.rendered&&this.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("checked",this.checked)}},{key:"_renderIcon",value:function(){this.$node.icon(this.iconId,function(e){e.insertBefore(this.$text)}.bind(this))}},{key:"$icon",value:function(){return this.$node.children(".icon")}},{key:"_renderControl",value:function(){var e=this.$node.prependDiv("tree-node-control");this._updateControl(e,this.getTree())}},{key:"_updateControl",value:function(e,t){e.toggleClass("checkable",t.checkable),e.cssPaddingLeft(t.nodeControlPaddingLeft+this.level*t.nodePaddingLevel),e.setVisible(!this.leaf)}},{key:"_renderCheckbox",value:function(){this.$node.prependDiv("tree-node-checkbox").appendDiv("check-box").toggleClass("checked",this.checked).toggleClass("disabled",!(this.getTree().enabled&&this.enabled)).toggleClass("children-checked",!!this.childrenChecked)}},{key:"_decorate",value:function(){if(this.$node){var e=this.$node,t=this.getTree();e.attr("class",this._preserveCssClasses(e)),e.addClass(this.cssClass),e.toggleClass("leaf",!!this.leaf),e.toggleClass("expanded",!!this.expanded&&this.childNodes.length>0),e.toggleClass("lazy",e.hasClass("expanded")&&this.expandedLazy),e.toggleClass("group",!!t.groupedNodes[this.id]),e.setEnabled(!!this.enabled),e.children(".tree-node-control").setVisible(!this.leaf),e.children(".tree-node-checkbox").children(".check-box").toggleClass("disabled",!(t.enabled&&this.enabled)),(!this.parentNode&&0===t.selectedNodes.length||t._isChildOfSelectedNodes(this))&&e.addClass("child-of-selected"),this._renderText(),this._renderIcon(),$i.legacyStyle(this._getStyles(),e),this.parentNode&&this.parentNode.expandedLazy&&!this.parentNode.childNodes.some((function(e){return!!t.visibleNodesMap[e.id]}))&&this.parentNode.$node&&this.parentNode.$node.removeClass("lazy")}}},{key:"_getStyles",value:function(){return this}},{key:"_preserveCssClasses",value:function(e){var t="tree-node";return e.isSelected()&&(t+=" selected"),e.hasClass("ancestor-of-selected")&&(t+=" ancestor-of-selected"),e.hasClass("parent-of-selected")&&(t+=" parent-of-selected"),t}},{key:"_updateIconWidth",value:function(){var e="";this.iconId&&(e="calc(100% - "+(this.$icon().outerWidth()+1)+"px)"),this.$text.css("max-width",e)}}])&&YL(t.prototype,n),i&&YL(t,i),e}();function JL(e){return(JL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QL(e,t){return(QL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=nB(e);if(t){var r=nB(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return tB(this,n)}}function tB(e,t){return!t||"object"!==JL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nB(e){return(nB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var iB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QL(e,t)}(o,e);var t,n,i,r=eB(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tree=e,t.nodeDimensionsDirty=!1,t}return t=o,(n=[{key:"layout",value:function(e){this._layout(e),wf.update(this.tree.$data)}},{key:"_layout",value:function(e){var t,n,i,r=this.tree.menuBar,o=r.htmlComp,s=this.tree.htmlComp;n=s.availableSize({exact:!0}).subtract(s.insets()),this.tree.toggleBreadcrumbStyleEnabled&&this.tree.setBreadcrumbStyleActive(Math.floor(n.width)<=this.tree.breadcrumbTogglingThreshold),i=0,r.$container.isVisible()&&(t=D_.size(o,n),o.setSize(t),i+=t.height),this._setDataHeight(i),this.tree.setViewRangeSize(this.tree.calculateViewRangeSize()),this.nodeDimensionsDirty=this.nodeDimensionsDirty||this._sizeChanged(s),this.nodeDimensionsDirty&&(this.nodeDimensionsDirty=!1,this.tree.isHorizontalScrollingEnabled()?(this.tree.nodeWidthDirty=!0,this.tree.maxNodeWidth=0):(this.tree.updateNodeHeights(),this.tree._renderViewport(),this.tree._renderFiller())),s.layouted||this.tree._renderScrollTop(),this.tree._renderViewport(),s.layouted||this.tree._renderScrollTop()}},{key:"_sizeChanged",value:function(e){return e.sizeCached&&Math.ceil(e.sizeCached.width)!==Math.ceil(e.size().width)}},{key:"_setDataHeight",value:function(e){var t=this.tree.$data;e+=t.cssMarginTop()+t.cssMarginBottom(),t.css("height",0===e?"100%":"calc(100% - "+e+"px)")}},{key:"preferredLayoutSize",value:function(e,t){return this.tree._renderViewport(),this.tree.htmlComp.layouted||(this.nodeDimensionsDirty=!0),No.prefSize(e,t)}}])&&ZL(t.prototype,n),i&&ZL(t,i),o}(zo);function rB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var oB=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tree=t}var t,n,i;return t=e,(n=[{key:"accept",value:function(e){if(!e.expanded&&e.parentNode&&e.parentNode.expandedLazy&&e.parentNode.lazyExpandingEnabled&&this.tree.lazyExpandingEnabled){for(var t=0;t<this.tree.selectedNodes.length;t++){var n=this.tree.selectedNodes[t];if("string"==typeof n)break;if(n===e||n.isDescendantOf(e))return!0}return!1}return!0}}])&&rB(t.prototype,n),i&&rB(t,i),e}();function sB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var aB=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tree=t}var t,n,i;return t=e,(n=[{key:"accept",value:function(e){return 0===this.tree.selectedNodes.length?void 0===e.parentNode:this.tree.isNodeInBreadcrumbVisible(e)}}])&&sB(t.prototype,n),i&&sB(t,i),e}();function uB(e){return(uB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cB(e,t,n){return(cB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pB(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function fB(e,t){return(fB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pB(e);if(t){var r=pB(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dB(this,n)}}function dB(e,t){return!t||"object"!==uB(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pB(e){return(pB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fB(e,t)}(o,e);var t,n,i,r=hB(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).field=e,n.repeatable=!0,n.stopPropagation=!0,n.renderingHints.hAlign=Ni.RIGHT,n.ctrl=gu.isCtrl(t),n.shift=gu.isShift(t),n.alt=gu.isAlt(t),n.keyStrokeMode=$u.Mode.DOWN,n}return t=o,(n=[{key:"_accept",value:function(e){return!!cB(pB(o.prototype),"_accept",this).call(this,e)&&(this.field.selectedNodes.length>0&&(e._treeCurrentNode=this.field.selectedNodes[0],e._$treeCurrentNode=e._treeCurrentNode.$node),!0)}},{key:"handle",value:function(e){var t=this._computeNewSelection(e._treeCurrentNode);t&&this.selectNodesAndReveal(t,!0)}},{key:"_computeNewSelection",value:function(e){return[]}},{key:"selectNodesAndReveal",value:function(e,t){this.field.selectNodes(e,t),this.field.revealSelection()}}])&&lB(t.prototype,n),i&&lB(t,i),o}($u);function vB(e){return(vB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gB(e,t,n){return(gB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kB(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function mB(e,t){return(mB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=kB(e);if(t){var r=kB(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wB(this,n)}}function wB(e,t){return!t||"object"!==vB(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kB(e){return(kB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var SB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mB(e,t)}(o,e);var t,n,i,r=_B(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.SPACE],t.renderingHints.render=!1,t}return t=o,(n=[{key:"_accept",value:function(e){return gB(kB(o.prototype),"_accept",this).call(this,e)&&this.field.checkable&&this.field.selectedNodes.length}},{key:"handle",value:function(e){var t=this.field.selectedNodes.filter((function(e){return e.enabled})),n=t.some((function(e){return!e.checked}));t.forEach((function(e){this.field.checkNode(e,n)}),this)}}])&&bB(t.prototype,n),i&&bB(t,i),o}($u);function OB(e){return(OB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function CB(e,t){return(CB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=EB(e);if(t){var r=EB(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return RB(this,n)}}function RB(e,t){return!t||"object"!==OB(t)&&"function"!=typeof t?xB(e):t}function xB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EB(e){return(EB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var DB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CB(e,t)}(o,e);var t,n,i,r=PB(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).which=[pu.UP],n.renderingHints.text="↑",n.renderingHints.$drawingArea=function(e,t){var n=this._computeNewSelection(t._treeCurrentNode);if(n)return n.$node}.bind(xB(n)),n}return t=o,(n=[{key:"_computeNewSelection",value:function(e){var t=this.field.visibleNodesFlat;if(0!==t.length)return e?t[t.indexOf(e)-1]:et.last(t)}}])&&TB(t.prototype,n),i&&TB(t,i),o}(yB);function FB(e){return(FB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $B(e,t){return($B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=LB(e);if(t){var r=LB(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return MB(this,n)}}function MB(e,t){return!t||"object"!==FB(t)&&"function"!=typeof t?IB(e):t}function IB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LB(e){return(LB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var BB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$B(e,t)}(o,e);var t,n,i,r=jB(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).which=[pu.DOWN],n.renderingHints.text="↓",n.renderingHints.$drawingArea=function(e,t){var n=this._computeNewSelection(t._treeCurrentNode);if(n)return n.$node}.bind(IB(n)),n}return t=o,(n=[{key:"_computeNewSelection",value:function(e){var t=this.field.visibleNodesFlat;if(0!==t.length)return e?t[t.indexOf(e)+1]:t[0]}}])&&AB(t.prototype,n),i&&AB(t,i),o}(yB);function NB(e){return(NB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function VB(e,t){return(VB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function WB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=UB(e);if(t){var r=UB(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return zB(this,n)}}function zB(e,t){return!t||"object"!==NB(t)&&"function"!=typeof t?GB(e):t}function GB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UB(e){return(UB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var KB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VB(e,t)}(o,e);var t,n,i,r=WB(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).which=[pu.END],n.renderingHints.$drawingArea=function(e,t){var n=this._computeNewSelection(t._treeCurrentNode);if(n)return n.$node}.bind(GB(n)),n}return t=o,(n=[{key:"handle",value:function(e){var t=this._computeNewSelection(e._treeCurrentNode);t&&this.selectNodesAndReveal(t)}},{key:"_computeNewSelection",value:function(e){var t=this.field.visibleNodesFlat;if(0!==t.length)return et.last(t)}}])&&HB(t.prototype,n),i&&HB(t,i),o}(yB);function qB(e){return(qB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function XB(e,t){return(XB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function JB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=eN(e);if(t){var r=eN(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ZB(this,n)}}function ZB(e,t){return!t||"object"!==qB(t)&&"function"!=typeof t?QB(e):t}function QB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eN(e){return(eN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XB(e,t)}(o,e);var t,n,i,r=JB(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).which=[pu.HOME],n.renderingHints.hAlign=Ni.RIGHT,n.renderingHints.$drawingArea=function(e,t){if(this.field.visibleNodesFlat.length>0)return this.field.visibleNodesFlat[0].$node}.bind(QB(n)),n}return t=o,(n=[{key:"handle",value:function(e){this.field.collapseAll(),this.field.visibleNodesFlat.length>0&&this.selectNodesAndReveal(this.field.visibleNodesFlat[0])}}])&&YB(t.prototype,n),i&&YB(t,i),o}(yB);function nN(e){return(nN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rN(e,t,n){return(rN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uN(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function oN(e,t){return(oN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=uN(e);if(t){var r=uN(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return aN(this,n)}}function aN(e,t){return!t||"object"!==nN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uN(e){return(uN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oN(e,t)}(o,e);var t,n,i,r=sN(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).which=[pu.SUBTRACT],n.renderingHints.text="-",n.renderingHints.$drawingArea=function(e,t){var n=t._treeCurrentNode;return n.expanded?n.$node:n.parentNode?n.parentNode.$node:void 0},n}return t=o,(n=[{key:"_accept",value:function(e){var t=rN(uN(o.prototype),"_accept",this).call(this,e),n=e._treeCurrentNode;return t&&n&&(n.expanded||n.parentNode)}},{key:"handle",value:function(e){var t=e._treeCurrentNode;t.expanded?this.field.collapseNode(t):t.parentNode&&this.selectNodesAndReveal(t.parentNode,!0)}}])&&iN(t.prototype,n),i&&iN(t,i),o}(yB);function cN(e){return(cN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hN(e,t,n){return(hN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bN(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function dN(e,t){return(dN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=bN(e);if(t){var r=bN(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return yN(this,n)}}function yN(e,t){return!t||"object"!==cN(t)&&"function"!=typeof t?vN(e):t}function vN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bN(e){return(bN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dN(e,t)}(o,e);var t,n,i,r=pN(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).which=[pu.ADD],n.renderingHints.text="+",n.renderingHints.$drawingArea=function(e,t){var n=t._treeCurrentNode;return this.isNodeExpandable(n)?n.$node:n.childNodes.length>0?n.childNodes[0].$node:void 0}.bind(vN(n)),n}return t=o,(n=[{key:"_accept",value:function(e){var t=hN(bN(o.prototype),"_accept",this).call(this,e),n=e._treeCurrentNode;return t&&n&&(this.isNodeExpandable(n)||n.childNodes.length>0)}},{key:"isNodeExpandable",value:function(e){return!e.expanded&&!e.leaf}},{key:"handle",value:function(e){var t=e._treeCurrentNode;if(this.isNodeExpandable(t))this.field.expandNode(t,{lazy:!1});else{var n=t.childNodes.filter((function(e){return this.field.visibleNodesFlat.indexOf(e)>-1}),this);n.length>0&&this.selectNodesAndReveal(n[0],!0)}}}])&&fN(t.prototype,n),i&&fN(t,i),o}(yB);function mN(e){return(mN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _N(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wN(e,t,n){return(wN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TN(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function kN(e,t){return(kN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=TN(e);if(t){var r=TN(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ON(this,n)}}function ON(e,t){return!t||"object"!==mN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TN(e){return(TN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kN(e,t)}(o,e);var t,n,i,r=SN(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).$nodesContainer,e._scrolldirections="y",e}return t=o,(n=[{key:"_initTreeKeyStrokeContext",value:function(){this.keyStrokeContext.registerKeyStroke([new qN(this),new tH(this),new uH(this),new yH(this)])}},{key:"_createTreeNode",value:function(e){return(e=O.nvl(e,{})).parent=this,O.create("CompactTreeNode",e)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("compact-tree");var e=new iB(this);this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(e),this.$data=this.$container.appendDiv("tree-data"),this._installScrollbars({borderless:!0}),this.menuBar=O.create("MenuBar",{parent:this,menuOrder:new ag(this.session,"Tree")}),this.menuBar.render(),this.$nodesContainer=this.$data.appendDiv("nodes"),this._updateNodeDimensions(),this._renderViewport(),this.invalidateLayoutTree()}},{key:"_calculateCurrentViewRange",value:function(){return this.viewRangeSize=this.visibleNodesFlat.length,new fi(0,Math.max(this.visibleNodesFlat.length,0))}},{key:"calculateViewRangeSize",value:function(){return this.visibleNodesFlat.length}},{key:"_insertNodeInDOMAtPlace",value:function(e,t){var n,i=this.visibleNodesFlat[t-1];if(i)if(i.level<e.level)e.$node.insertAfter(i.$node.children()[0]);else{n=i.$node;for(var r=0;r<i.level-e.level;r++)n=n.parent();e.$node.insertAfter(n)}else e.$node.prependTo(this.$nodesContainer)}},{key:"selectNodes",value:function(e,t){var n=[];(e=et.ensure(e)).forEach((function(e){e.isSection()?e.childNodes.length>0&&n.push(e.childNodes[0]):n.push(e)}),this),wN(TN(o.prototype),"selectNodes",this).call(this,n)}},{key:"_renderExpansion",value:function(e){}},{key:"_updateItemPath",value:function(){}}])&&_N(t.prototype,n),i&&_N(t,i),o}(NL);function PN(e){return(PN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xN(e,t){return(xN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=FN(e);if(t){var r=FN(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return DN(this,n)}}function DN(e,t){return!t||"object"!==PN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FN(e){return(FN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var AN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xN(e,t)}(o,e);var t,n,i,r=EN(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"render",value:function(){var e=this.getTree();if(this.isSection()){var t=e.$container.makeDiv("section expanded").data("node",this);t.appendDiv("title").text(this.text),this.$node=t}else{var n=this.parentNode.$node.makeDiv("section-node").data("node",this).on("mousedown",e._onNodeMouseDown.bind(e)).on("mouseup",e._onNodeMouseUp.bind(e));this.$node=n}return this.$node}},{key:"_decorate",value:function(){if(this.$node){var e,t=this.$node;t.hasClass("section")?(t=t.children("title"),e="title"):(e="section-node",t.isSelected()&&(e+=" selected")),t.removeClass(),t.addClass(e),t.addClass(this.cssClass),t.text(this.text),$i.legacyStyle(this,t),En.hasText(this.tooltipText)&&t.attr("title",this.tooltipText)}}},{key:"isSection",value:function(){return 0===this.level}},{key:"_updateIconWidth",value:function(){}}])&&RN(t.prototype,n),i&&RN(t,i),o}(XL);function $N(e){return($N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function MN(e,t,n){return(MN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=NN(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function IN(e,t){return(IN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=NN(e);if(t){var r=NN(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return BN(this,n)}}function BN(e,t){return!t||"object"!==$N(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NN(e){return(NN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IN(e,t)}(o,e);var t,n,i,r=LN(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).repeatable=!0,t.field=e,t.keyStrokeMode=$u.Mode.DOWN,t}return t=o,(n=[{key:"_accept",value:function(e){if(!MN(NN(o.prototype),"_accept",this).call(this,e))return!1;if(!this.field.nodes||!this.field.nodes.length)return!1;var t=this.field.$nodesContainer.find(".section-node.selected"),n=t.data("node"),i=this._findNextNode(t,n);return!!i&&(e._nextNode=i,!0)}},{key:"handle",value:function(e){this.field.selectNodes(e._nextNode),this.field.checkNode(e._nextNode,!0)}},{key:"_findNextNode",value:function(e,t){throw new Error("method must be overwritten by subclass")}}])&&jN(t.prototype,n),i&&jN(t,i),o}($u);function VN(e){return(VN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zN(e,t){return(zN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=KN(e);if(t){var r=KN(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return UN(this,n)}}function UN(e,t){return!t||"object"!==VN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KN(e){return(KN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zN(e,t)}(o,e);var t,n,i,r=GN(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).which=[pu.UP],t.renderingHints.text="↑",t}return t=o,(n=[{key:"_findNextNode",value:function(e,t){return t?e.prev(".section-node").data("node")||e.parent().prev(".section").children(".section-node").last().data("node"):et.last(et.last(this.field.nodes).childNodes)}}])&&WN(t.prototype,n),i&&WN(t,i),o}(HN);function YN(e){return(YN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function JN(e,t){return(JN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=eH(e);if(t){var r=eH(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return QN(this,n)}}function QN(e,t){return!t||"object"!==YN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eH(e){return(eH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JN(e,t)}(o,e);var t,n,i,r=ZN(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).which=[pu.DOWN],t.renderingHints.text="↓",t}return t=o,(n=[{key:"_findNextNode",value:function(e,t){return t?e.next(".section-node").data("node")||e.parent().next(".section").children(".section-node").first().data("node"):et.first(et.first(this.field.nodes).childNodes)}}])&&XN(t.prototype,n),i&&XN(t,i),o}(HN);function nH(e){return(nH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iH(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rH(e,t){return(rH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=aH(e);if(t){var r=aH(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sH(this,n)}}function sH(e,t){return!t||"object"!==nH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aH(e){return(aH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rH(e,t)}(o,e);var t,n,i,r=oH(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).renderingHints.text="←",t.which=[pu.LEFT],t}return t=o,(n=[{key:"_findNextNode",value:function(e,t){return e.parent().prev(".section").children(".section-node").first().data("node")||e.parent().children(".section-node").not(e).first().data("node")}}])&&iH(t.prototype,n),i&&iH(t,i),o}(HN);function lH(e){return(lH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cH(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fH(e,t){return(fH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pH(e);if(t){var r=pH(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dH(this,n)}}function dH(e,t){return!t||"object"!==lH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pH(e){return(pH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fH(e,t)}(o,e);var t,n,i,r=hH(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).renderingHints.text="→",t.which=[pu.RIGHT],t}return t=o,(n=[{key:"_findNextNode",value:function(e,t){return e.parent().next(".section").children(".section-node").first().data("node")}}])&&cH(t.prototype,n),i&&cH(t,i),o}(HN);function vH(e,t){return e.makeElement("<input>",t).attr("type","text").attr("autocomplete","NoAutocomplete").disableSpellcheck()}function bH(e,t){return e.$container.makeDiv(En.join(" ","input-field",t))}var gH={activateFirstField:function(e,t){var n=ye.findFirstFocusableWidget(t,e);n&&n.activate()},appendIcon:function(e,t){var n=e.appendSpan("icon unfocusable");return t&&n.addClass(t),n},eventOutsideProposalField:function(e,t){var n=o(e.$field,t)||o(e.$icon,t)||o(e.$clearIcon,t),i=s(e.popup,t),r=s(e._tooltip(),t);return!n&&!i&&!r;function o(e,t){return e&&e.isOrHas(t)}function s(e,t){return e&&e.rendered&&e.$container.isOrHas(t)}},handleOnClick:function(e){return e.enabledComputed&&!e.embedded&&!e.popup},initTouch:function(e,t){e.embedded=O.nvl(t.embedded,!1),e.touchMode=O.nvl(t.touchMode,Mt.get().supportsOnlyTouch())},linkElementWithLabel:function(e,t){var n=t.attr("id");n||(n=ye.createUniqueId("lbl"),t.attr("id",n));var i=e.attr("aria-labelledby")||"";i&&(n+=" "+i),e.attr("aria-labelledby",n)},makeInputDiv:bH,makeInputOrDiv:function(e,t){return e.touchMode?bH(e,t):vH(e.$container,t)},makeTextField:vH,valOrText:function(e,t){var n=e.is("div");if(2!==arguments.length)return n?e.text():e.val();n?e.text(t):e.val(t)}};function mH(e){return(mH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _H(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wH(e,t,n){return(wH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TH(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function kH(e,t){return(kH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=TH(e);if(t){var r=TH(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return OH(this,n)}}function OH(e,t){return!t||"object"!==mH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TH(e){return(TH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kH(e,t)}(o,e);var t,n,i,r=SH(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).field=e,n.appLinkTriggerFunction=t,n.which=[pu.SPACE],n.renderingHints.render=!1,n}return t=o,(n=[{key:"_accept",value:function(e){return wH(TH(o.prototype),"_accept",this).call(this,e)&&s()(e.target).hasClass("app-link")}},{key:"handle",value:function(e){this.appLinkTriggerFunction.call(this.field,e)}}])&&_H(t.prototype,n),i&&_H(t,i),o}($u);function PH(e){return(PH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RH(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xH(e,t,n){return(xH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$H(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function EH(e,t){return(EH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$H(e);if(t){var r=$H(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return FH(this,n)}}function FH(e,t){return!t||"object"!==PH(t)&&"function"!=typeof t?AH(e):t}function AH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $H(e){return($H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EH(e,t)}(o,e);var t,n,i,r=DH(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).tooltip=null,e.contextMenu=null,e.status=null,e.updating=!1,e.autoRemove=!0,e.position=GH.StatusPosition.DEFAULT,e._parents=[],e._parentPropertyChangeListener=e._onParentPropertyChange.bind(AH(e)),e._parentHierarchyChangeListener=e._onParentHierarchyChange.bind(AH(e)),e}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendSpan("status").on("mousedown",this._onStatusMouseDown.bind(this)),this.htmlComp=Uo.install(this.$container,this.session)}},{key:"_remove",value:function(){xH($H(o.prototype),"_remove",this).call(this),this.tooltip&&(this.tooltip.destroy(),this.tooltip=null),this.contextMenu&&(this.contextMenu.destroy(),this.contextMenu=null),this._removeParentListeners()}},{key:"_renderProperties",value:function(){xH($H(o.prototype),"_renderProperties",this).call(this),this._renderPosition()}},{key:"update",value:function(e,t,n,i){this.updating=!0,this.setStatus(e),this.setMenus(t),this.setAutoRemove(n),this.updating=!1,this._updatePopup(i)}},{key:"clearStatus",value:function(){this.setStatus(null)}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"_setStatus",value:function(e){e=pi.ensure(e),this._setProperty("status",e)}},{key:"_renderStatus",value:function(){this.updating||this._updatePopup()}},{key:"setPosition",value:function(e){this.setProperty("position",e)}},{key:"_renderPosition",value:function(){this.$container.toggleClass("top",this.position===GH.StatusPosition.TOP),this.invalidateLayoutTree()}},{key:"_renderVisible",value:function(){xH($H(o.prototype),"_renderVisible",this).call(this),this.visible||this.hidePopup()}},{key:"setMenus",value:function(e){this.setProperty("menus",et.ensure(e))}},{key:"_renderMenus",value:function(){this.updating||this._updatePopup()}},{key:"setAutoRemove",value:function(e){this.setProperty("autoRemove",e)}},{key:"_renderAutoRemove",value:function(){this.updating||this._updatePopup()}},{key:"hideTooltip",value:function(){var e=new Kt;this.tooltip&&(this.trigger("hideTooltip",e),e.defaultPrevented||(this.tooltip.destroy(),this.tooltip=null,this._removeParentListeners()))}},{key:"_updatePopup",value:function(e){this._requiresTooltip()||this.hideTooltip(),et.empty(this.menus)&&this.hideContextMenu(),!0===e?this.showTooltip():!1===e&&this.hideTooltip()}},{key:"_requiresTooltip",value:function(){return!(!this.status||!this.rendered||et.empty(this.menus)&&!En.hasText(this.status.message))}},{key:"showTooltip",value:function(){if(this._requiresTooltip()){var e=new Kt;this.trigger("showTooltip",e),e.defaultPrevented||(this._updateParentListeners(),this.hideContextMenu(),this.tooltip&&this.tooltip.autoRemove!==this.autoRemove&&this.hideTooltip(),this.tooltip?(this.tooltip.setText(this.status.message),this.tooltip.setSeverity(this.status.severity),this.tooltip.setMenus(this.menus)):(this.tooltip=O.create("Tooltip",{parent:this,$anchor:this.$container,text:this.status.message,severity:this.status.severity,autoRemove:this.autoRemove,menus:this.menus}),this.tooltip.one("destroy",function(){this.hideTooltip()}.bind(this)),this.tooltip.render()))}}},{key:"hideContextMenu",value:function(){this.contextMenu&&(this.contextMenu.destroy(),this.contextMenu=null)}},{key:"showContextMenu",value:function(){et.empty(this.menus)||(this.hidePopup(),this.contextMenu=O.create("ContextMenuPopup",{parent:this,$anchor:this.$container,menuItems:this.menus,cloneMenuItems:!1,closeOnAnchorMouseDown:!1}),this.contextMenu.one("destroy",function(){this.hideContextMenu()}.bind(this)),this.contextMenu.open())}},{key:"hidePopup",value:function(){this.hideTooltip(),this.hideContextMenu()}},{key:"togglePopup",value:function(){if(this.status)return this.hideContextMenu(),void(this.tooltip?this.hideTooltip():this.showTooltip());if(et.empty(this.menus))this.hidePopup();else{this.hideTooltip();var e=function(){this.rendered&&(this.contextMenu?this.hideContextMenu():this.showContextMenu())}.bind(this);this.session.onRequestsDone(e)}}},{key:"_onStatusMouseDown",value:function(e){this.trigger("statusMouseDown",e),e.defaultPrevented||this.togglePopup()}},{key:"_updateTooltipVisibility",value:function(e){this.isEveryParentVisible()?setTimeout(function(){this.rendered&&this.isEveryParentVisible()&&this.tooltip&&!this.tooltip.rendered&&this.tooltip.render()}.bind(this)):this.tooltip&&this.tooltip.rendered&&this.tooltip.remove()}},{key:"_onParentHierarchyChange",value:function(e){this._updateParentListeners()}},{key:"_onParentPropertyChange",value:function(e){"visible"===e.propertyName&&this._updateTooltipVisibility(e.source)}},{key:"_removeParentListeners",value:function(){this._parents.forEach(function(e){e.off("hierarchyChange",this._parentHierarchyChangeListener),e.off("propertyChange",this._parentPropertyChangeListener)}.bind(this)),this._parents=[]}},{key:"_updateParentListeners",value:function(){this._removeParentListeners();for(var e=this.parent;e;)e.on("hierarchyChange",this._parentHierarchyChangeListener),e.on("propertyChange",this._parentPropertyChangeListener),this._parents.push(e),e=e.parent}}])&&RH(t.prototype,n),i&&RH(t,i),o}(de);function MH(e){return(MH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IH(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function LH(e,t,n){return(LH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WH(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function BH(e,t){return(BH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=WH(e);if(t){var r=WH(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return HH(this,n)}}function HH(e,t){return!t||"object"!==MH(t)&&"function"!=typeof t?VH(e):t}function VH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WH(e){return(WH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zH(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var GH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BH(e,t)}(o,e);var t,n,i,r=NH(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).dropType=0,e.dropMaximumSize=Gt.DEFAULT_DROP_MAXIMUM_SIZE,e.empty=!0,e.errorStatus=null,e.fieldStyle=o.DEFAULT_FIELD_STYLE,e.gridData=null,e.gridDataHints=new kV,e.mode=o.Mode.DEFAULT,e.keyStrokes=[],e.label=null,e.labelVisible=!0,e.labelPosition=o.LabelPosition.DEFAULT,e.labelWidthInPixel=0,e.labelHtmlEnabled=!1,e.mandatory=!1,e.statusMenuMappings=[],e.menus=[],e.menusVisible=!0,e.preventInitialFocus=!1,e.requiresSave=!1,e.statusPosition=o.StatusPosition.DEFAULT,e.statusVisible=!0,e.suppressStatus=!1,e.touched=!1,e.tooltipText=null,e.tooltipAnchor=o.TooltipAnchor.DEFAULT,e.onFieldTooltipOptionsCreator=null,e.$label=null,e.$field=null,e.$fieldContainer=null,e.$icon=null,e.$status=null,e.disabledCopyOverlay=!1,e.$disabledCopyOverlay=null,e._addWidgetProperties(["keyStrokes","menus","statusMenuMappings"]),e._addCloneProperties(["dropType","dropMaximumSize","errorStatus","fieldStyle","gridDataHints","gridData","label","labelVisible","labelPosition","labelWidthInPixel","mandatory","mode","preventInitialFocus","requiresSave","touched","statusVisible","statusPosition","statusMenuMappings","tooltipText","tooltipAnchor"]),e._menuPropertyChangeHandler=e._onMenuPropertyChange.bind(VH(e)),e}return t=o,(n=[{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_createLoadingSupport",value:function(){return new te({widget:this})}},{key:"_init",value:function(e){LH(WH(o.prototype),"_init",this).call(this,e),this.resolveConsts([{property:"labelPosition",constType:o.LabelPosition}]),this.resolveTextKeys(["label","tooltipText"]),this._setKeyStrokes(this.keyStrokes),this._setMenus(this.menus),this._setErrorStatus(this.errorStatus),this._setGridDataHints(this.gridDataHints),this._setGridData(this.gridData),this._updateEmpty()}},{key:"_initProperty",value:function(e,t){"gridDataHints"===e?this._initGridDataHints(t):LH(WH(o.prototype),"_initProperty",this).call(this,e,t)}},{key:"_initGridDataHints",value:function(e){e instanceof kV?this.gridDataHints=e:oi.isPlainObject(e)?s.a.extend(this.gridDataHints,e):this.gridDataHints=e}},{key:"_render",value:function(){throw new Error("sub-classes of FormField must implement a _render method")}},{key:"_renderProperties",value:function(){LH(WH(o.prototype),"_renderProperties",this).call(this),this._renderMandatory(),this._renderTooltipText(),this._renderErrorStatus(),this._renderMenus(),this._renderLabel(),this._renderLabelVisible(),this._renderStatusVisible(),this._renderStatusPosition(),this._renderFont(),this._renderForegroundColor(),this._renderBackgroundColor(),this._renderLabelFont(),this._renderLabelForegroundColor(),this._renderLabelBackgroundColor(),this._renderGridData(),this._renderPreventInitialFocus(),this._renderFieldStyle()}},{key:"_remove",value:function(){LH(WH(o.prototype),"_remove",this).call(this),this._removeField(),this._removeStatus(),this._removeLabel(),this._removeIcon(),this.removeMandatoryIndicator(),this._removeDisabledCopyOverlay(),this._uninstallDragAndDropHandler()}},{key:"setFieldStyle",value:function(e){this.setProperty("fieldStyle",e)}},{key:"_renderFieldStyle",value:function(){if(this._renderFieldStyleInternal(this.$container),this._renderFieldStyleInternal(this.$fieldContainer),this._renderFieldStyleInternal(this.$field),this.rendered){var e=this.htmlComp.getParent();e&&e.invalidateLayoutTree(),this.invalidateLayoutTree()}}},{key:"_renderFieldStyleInternal",value:function(e){e&&e.toggleClass("alternative",this.fieldStyle===o.FieldStyle.ALTERNATIVE)}},{key:"setMandatory",value:function(e){this.setProperty("mandatory",e)}},{key:"_renderMandatory",value:function(){this.$container.toggleClass("mandatory",this.mandatory)}},{key:"_errorStatus",value:function(){return this.errorStatus}},{key:"setErrorStatus",value:function(e){this.setProperty("errorStatus",e)}},{key:"_setErrorStatus",value:function(e){e=pi.ensure(e),this._setProperty("errorStatus",e)}},{key:"clearErrorStatus",value:function(){this.setErrorStatus(null)}},{key:"_renderErrorStatus",value:function(){var e=this._errorStatus(),t=!!e,n=t?"has-"+e.cssClass():"";this._updateErrorStatusClasses(n,t),this._updateFieldStatus()}},{key:"_updateErrorStatusClasses",value:function(e,t){this.$container.removeClass(o.SEVERITY_CSS_CLASSES),this.$container.addClass(e,t),this.$field&&(this.$field.removeClass(o.SEVERITY_CSS_CLASSES),this.$field.addClass(e,t))}},{key:"setTooltipText",value:function(e){this.setProperty("tooltipText",e)}},{key:"_renderTooltipText",value:function(){this._updateTooltip()}},{key:"setTooltipAnchor",value:function(e){this.setProperty("tooltipAnchor",e)}},{key:"_renderTooltipAnchor",value:function(){this._updateTooltip()}},{key:"_updateTooltip",value:function(){var e=this.hasStatusTooltip();if(this.$container.toggleClass("has-tooltip",e),this.$field&&this.$field.toggleClass("has-tooltip",e),this._updateFieldStatus(),this.$fieldContainer)if(this.hasOnFieldTooltip()){var t=this.onFieldTooltipOptionsCreator||this._createOnFieldTooltipOptions;dh.install(this.$fieldContainer,t.call(this))}else dh.uninstall(this.$fieldContainer)}},{key:"hasStatusTooltip",value:function(){return this.tooltipAnchor===o.TooltipAnchor.DEFAULT&&En.hasText(this.tooltipText)}},{key:"hasOnFieldTooltip",value:function(){return this.tooltipAnchor===o.TooltipAnchor.ON_FIELD&&En.hasText(this.tooltipText)}},{key:"setOnFieldTooltipOptionsCreator",value:function(e){this.onFieldTooltipOptionsCreator=e}},{key:"_createOnFieldTooltipOptions",value:function(){return{parent:this,text:this.tooltipText,arrowPosition:50}}},{key:"_renderVisible",value:function(){LH(WH(o.prototype),"_renderVisible",this).call(this),this.rendered&&this._renderErrorStatus()}},{key:"setLabel",value:function(e){this.setProperty("label",e)}},{key:"_renderLabel",value:function(){var e=this.label;this.labelPosition===o.LabelPosition.ON_FIELD?(this._renderPlaceholder(),this.$label&&this.$label.text("")):this.$label&&(this._removePlaceholder(),this.$label.contentOrNbsp(this.labelHtmlEnabled,e,"empty").toggleClass("top",this.labelPosition===o.LabelPosition.TOP),(this.labelUseUiWidth||this.labelWidthInPixel===o.LabelWidth.UI)&&this.invalidateLayoutTree())}},{key:"_renderEmptyLabel",value:function(){this.$label.html("&nbsp;").toggleClass("top",this.labelPosition===o.LabelPosition.TOP)}},{key:"_renderPlaceholder",value:function(e){(e=O.nvl(e,this.$field))&&e.placeholder(this.label)}},{key:"_removePlaceholder",value:function(e){(e=O.nvl(e,this.$field))&&e.placeholder("")}},{key:"setLabelVisible",value:function(e){this.setProperty("labelVisible",e)}},{key:"_renderLabelVisible",value:function(){var e=this.labelVisible;if(this._renderChildVisible(this.$label,e),this.$container.toggleClass("label-hidden",!e),this.rendered&&this.labelPosition===o.LabelPosition.TOP){var t=this.htmlComp.getParent();t&&t.invalidateLayoutTree()}}},{key:"setLabelWidthInPixel",value:function(e){this.setProperty("labelWidthInPixel",e)}},{key:"_renderLabelWidthInPixel",value:function(){this.invalidateLayoutTree()}},{key:"setStatusVisible",value:function(e){this.setProperty("statusVisible",e)}},{key:"_renderStatusVisible",value:function(){this._updateFieldStatus()}},{key:"setStatusPosition",value:function(e){this.setProperty("statusPosition",e)}},{key:"_renderStatusPosition",value:function(e){this._updateFieldStatus()}},{key:"_tooltip",value:function(){return this.fieldStatus?this.fieldStatus.tooltip:null}},{key:"_updateFieldStatus",value:function(){if(this.fieldStatus){var e,t=this._errorStatus(),n=null,i=this._computeStatusVisible(),r=!0;if(this.fieldStatus.setPosition(this.statusPosition),this.fieldStatus.setVisible(i),i){if(t){if(this.mode===o.Mode.CELLEDITOR)return;r=!(n=t).isError(),e=this._getMenusForStatus(t)}else this.hasStatusTooltip()?(n=O.create("Status",{message:this.tooltipText,severity:pi.Severity.OK}),e=this._getCurrentMenus()):e=this._getCurrentMenus();this.fieldStatus.update(n,e,r,this._isInitialShowStatus())}}}},{key:"_isInitialShowStatus",value:function(){return!!this._errorStatus()}},{key:"_computeStatusVisible",value:function(){var e=this._errorStatus(),t=this.statusVisible,n=!!e,i=this.hasStatusTooltip();return!this.suppressStatus&&this.visible&&(t||n||i||this._hasMenus()&&this.menusVisible)}},{key:"_renderChildVisible",value:function(e,t){if(e)return e.isVisible()!==t?(e.setVisible(t),this.invalidateLayoutTree(),!0):void 0}},{key:"setLabelPosition",value:function(e){this.setProperty("labelPosition",e)}},{key:"_renderLabelPosition",value:function(e){if(this._renderLabel(),this.rendered){var t=this.htmlComp.getParent();t&&t.invalidateLayoutTree(),this.invalidateLayoutTree()}}},{key:"setLabelHtmlEnabled",value:function(e){this.setProperty("labelHtmlEnabled",e)}},{key:"_renderLabelHtmlEnabled",value:function(){this._renderLabel()}},{key:"_renderEnabled",value:function(){LH(WH(o.prototype),"_renderEnabled",this).call(this),this.$field&&this.$field.setEnabled(this.enabledComputed),this._updateDisabledCopyOverlay(),this._updateDropType()}},{key:"_renderDisabledStyle",value:function(){this._renderDisabledStyleInternal(this.$container),this._renderDisabledStyleInternal(this.$fieldContainer),this._renderDisabledStyleInternal(this.$field),this._renderDisabledStyleInternal(this.$mandatory)}},{key:"setFont",value:function(e){this.setProperty("font",e)}},{key:"_renderFont",value:function(){$i.legacyFont(this,this.$field)}},{key:"setForegroundColor",value:function(e){this.setProperty("foregroundColor",e)}},{key:"_renderForegroundColor",value:function(){$i.legacyForegroundColor(this,this.$field)}},{key:"setBackgroundColor",value:function(e){this.setProperty("backgroundColor",e)}},{key:"_renderBackgroundColor",value:function(){$i.legacyBackgroundColor(this,this.$field)}},{key:"setLabelFont",value:function(e){this.setProperty("labelFont",e)}},{key:"_renderLabelFont",value:function(){$i.legacyFont(this,this.$label,"label")}},{key:"setLabelForegroundColor",value:function(e){this.setProperty("labelForegroundColor",e)}},{key:"_renderLabelForegroundColor",value:function(){$i.legacyForegroundColor(this,this.$label,"label")}},{key:"setLabelBackgroundColor",value:function(e){this.setProperty("labelBackgroundColor",e)}},{key:"_renderLabelBackgroundColor",value:function(){$i.legacyBackgroundColor(this,this.$label,"label")}},{key:"setGridDataHints",value:function(e){this.setProperty("gridDataHints",e)}},{key:"_setGridDataHints",value:function(e){e||(e=new kV),this._setProperty("gridDataHints",kV.ensure(e))}},{key:"_renderGridDataHints",value:function(){this.parent.invalidateLogicalGrid()}},{key:"_setGridData",value:function(e){e||(e=new kV),this._setProperty("gridData",kV.ensure(e))}},{key:"_renderGridData",value:function(){if(this.rendered){var e=this.htmlComp.getParent();e&&e.invalidateLayoutTree()}}},{key:"setMenus",value:function(e){this.setProperty("menus",e)}},{key:"_setMenus",value:function(e){e=et.ensure(e),this.menus.forEach((function(e){e.off("propertyChange",this._menuPropertyChangeHandler)}),this),this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this.menus.forEach((function(e){e.on("propertyChange",this._menuPropertyChangeHandler)}),this)}},{key:"insertMenu",value:function(e){this.insertMenus([e])}},{key:"insertMenus",value:function(e){0!==(e=et.ensure(e)).length&&this.setMenus(this.menus.concat(e))}},{key:"deleteMenu",value:function(e){this.deleteMenus([e])}},{key:"deleteMenus",value:function(e){if(0!==(e=et.ensure(e)).length){var t=this.menus.slice();et.removeAll(t,e),this.setMenus(t)}}},{key:"_onMenuPropertyChange",value:function(e){"visible"===e.propertyName&&this.rendered&&this._updateMenus()}},{key:"_getCurrentMenus",value:function(){return this.menus.filter((function(e){return e.visible}))}},{key:"_getMenusForStatus",value:function(e){return this.statusMenuMappings.filter((function(t){return!(!t.menu||!t.menu.visible)&&(0===t.codes.length||t.codes.indexOf(e.code)>-1)&&(0===t.severities.length||t.severities.indexOf(e.severity)>-1)})).map((function(e){return e.menu}))}},{key:"_hasMenus",value:function(){return!!(this.menus&&this._getCurrentMenus().length>0)}},{key:"_updateMenus",value:function(){this.$container.toggleClass("has-menus",this._hasMenus()&&this.menusVisible),this._updateFieldStatus()}},{key:"_renderMenus",value:function(){this._updateMenus()}},{key:"_renderStatusMenuMappings",value:function(){this._updateMenus()}},{key:"setMenusVisible",value:function(e){this.setProperty("menusVisible",e)}},{key:"_setMenusVisible",value:function(e){this._setProperty("menusVisible",e)}},{key:"_renderMenusVisible",value:function(){this._updateMenus()}},{key:"_setKeyStrokes",value:function(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}},{key:"_$tooltipParent",value:function(){}},{key:"_hideStatusMessage",value:function(){this.fieldStatus&&this.fieldStatus.hideTooltip()}},{key:"_showContextMenu",value:function(){var e=this._getCurrentMenus();0!==e.length&&(this._hideStatusMessage(),this.contextPopup=O.create("ContextMenuPopup",{parent:this,$anchor:this.$status,menuItems:e,cloneMenuItems:!1,closeOnAnchorMouseDown:!1}),this.contextPopup.open())}},{key:"_hideContextMenu",value:function(){this.contextPopup&&(this.contextPopup.close(),this.contextPopup=null)}},{key:"_renderPreventInitialFocus",value:function(){this.$container.toggleClass("prevent-initial-focus",!!this.preventInitialFocus)}},{key:"focus",value:function(){if(!this.rendered)return this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1;if(!this.enabledComputed)return!1;var e=this.getFocusableElement();return!!e&&this.session.focusManager.requestFocus(e)}},{key:"getFocusableElement",value:function(){return this.rendered&&this.$field?this.$field[0]:null}},{key:"_onFieldFocus",value:function(e){this.setFocused(!0)}},{key:"_onFieldBlur",value:function(){this.setFocused(!1)}},{key:"activate",value:function(){if(this.enabledComputed&&this.rendered){var e=this.getFocusableElement();e&&s.a.ensure(e).focus()}}},{key:"get$Scrollable",value:function(){return this.$field}},{key:"getParentGroupBox",value:function(){for(var e=this.parent;e&&!(e instanceof rY);)e=e.parent;return e}},{key:"getParentField",value:function(){return this.parent}},{key:"addLabel",value:function(){this.$label=this.$container.appendElement("<label>"),dh.installForEllipsis(this.$label,{parent:this}),this.$label.on("click",this._onLabelClick.bind(this))}},{key:"_onLabelClick",value:function(e){En.hasText(this.label)&&this.activate()}},{key:"_removeLabel",value:function(){this.$label&&(dh.uninstall(this.$label),this.$label.remove(),this.$label=null)}},{key:"_linkWithLabel",value:function(e){this.$label&&e&&gH.linkElementWithLabel(e,this.$label)}},{key:"_removeIcon",value:function(){this.$icon&&(this.$icon.remove(),this.$icon=null)}},{key:"addField",value:function(e){this.$fieldContainer||this.addFieldContainer(e),this.$field=e,this._linkWithLabel(e),this.$field.on("blur",this._onFieldBlur.bind(this)).on("focus",this._onFieldFocus.bind(this))}},{key:"addFieldContainer",value:function(e){this.$fieldContainer=e.addClass("field"),(0===this.$container.has(e).length||e.next().length>0)&&e.appendTo(this.$container)}},{key:"_removeField",value:function(){this.$field&&(this.$field.remove(),this.$field=null),this.$fieldContainer&&(this.$fieldContainer.remove(),this.$fieldContainer=null)}},{key:"addStatus",value:function(){this.fieldStatus||(this.fieldStatus=O.create("FieldStatus",{parent:this,position:this.statusPosition,visible:this._computeStatusVisible()}),this.fieldStatus.render(),this.$status=this.fieldStatus.$container,this._updateFieldStatus())}},{key:"_removeStatus",value:function(){this.fieldStatus&&(this.fieldStatus.remove(),this.$status=null,this.fieldStatus=null)}},{key:"addPseudoStatus",value:function(){this.$pseudoStatus=this.$container.appendSpan("status")}},{key:"addMandatoryIndicator",value:function(){this.$mandatory=this.$container.appendSpan("mandatory-indicator")}},{key:"removeMandatoryIndicator",value:function(){this.$mandatory&&(this.$mandatory.remove(),this.$mandatory=null)}},{key:"addIcon",value:function(e){e||(e=this.$container),this.$icon=gH.appendIcon(e).on("mousedown",this._onIconMouseDown.bind(this))}},{key:"_onIconMouseDown",value:function(e){this.enabledComputed&&this.$field.focus()}},{key:"addContainer",value:function(e,t,n){this.$container=e.appendDiv("form-field"),t&&this.$container.addClass(t);var i=Uo.install(this.$container,this.session);i.setLayout(n||this._createLayout()),this.htmlComp=i}},{key:"_createLayout",value:function(){return new sV(this)}},{key:"updateInnerAlignment",value:function(e){var t=(e=e||{}).$fieldContainer||this.$fieldContainer;this._updateElementInnerAlignment(e,t),t!==this.$container&&this._updateElementInnerAlignment(e,this.$container)}},{key:"_updateElementInnerAlignment",value:function(e,t){e=e||{};var n=O.nvl(e.useHorizontalAlignment,!0),i=O.nvl(e.useVerticalAlignment,!0);if(t&&(t.removeClass("has-inner-alignment halign-left halign-center halign-right valign-top valign-middle valign-bottom"),n||i)){t.addClass("has-inner-alignment");var r=this.gridData;if(this.parent.logicalGrid&&(r=this.gridDataHints),n){var o=r.horizontalAlignment;t.addClass(o<0?"halign-left":o>0?"halign-right":"halign-center")}if(i){var s=r.verticalAlignment;t.addClass(s<0?"valign-top":s>0?"valign-bottom":"valign-middle")}this.invalidateLayout()}}},{key:"addCellEditorFieldCssClasses",value:function(e,t){e.addClass("cell-editor-field").addClass(Mt.get().cssClassForEdge()),t.cssClass&&e.addClass(t.cssClass)}},{key:"prepareForCellEdit",value:function(e){e=e||{},this.$mandatory&&this.removeMandatoryIndicator(),this.$status&&(this.$status.remove(),this.$status=null),this.$container&&this.$container.addClass("cell-editor-form-field"),this.$field&&this.addCellEditorFieldCssClasses(this.$field,e)}},{key:"_renderDropType",value:function(){this._updateDropType()}},{key:"_updateDropType",value:function(){this.dropType&&this.enabledComputed?this._installDragAndDropHandler():this._uninstallDragAndDropHandler()}},{key:"_createDragAndDropHandler",value:function(){return Gt.handler(this,{supportedScoutTypes:Gt.SCOUT_TYPES.FILE_TRANSFER,dropType:function(){return this.dropType}.bind(this),dropMaximumSize:function(){return this.dropMaximumSize}.bind(this)})}},{key:"_installDragAndDropHandler",value:function(e){this.dragAndDropHandler||(this.dragAndDropHandler=this._createDragAndDropHandler(),this.dragAndDropHandler.install(this.$field))}},{key:"_uninstallDragAndDropHandler",value:function(e){this.dragAndDropHandler&&(this.dragAndDropHandler.uninstall(),this.dragAndDropHandler=null)}},{key:"_updateDisabledCopyOverlay",value:function(){this.disabledCopyOverlay&&!Mt.get().supportsCopyFromDisabledInputFields()&&(this.enabledComputed?this._removeDisabledCopyOverlay():(this._renderDisabledCopyOverlay(),this.revalidateLayout()))}},{key:"_renderDisabledCopyOverlay",value:function(){this.$disabledCopyOverlay||(this.$disabledCopyOverlay=this.$container.appendDiv("disabled-overlay").on("contextmenu",this._createCopyContextMenu.bind(this)))}},{key:"_removeDisabledCopyOverlay",value:function(){this.$disabledCopyOverlay&&(this.$disabledCopyOverlay.remove(),this.$disabledCopyOverlay=null)}},{key:"_createCopyContextMenu",value:function(e){if(this.visible&&!En.empty(this.displayText)){var t=O.create("Menu",{parent:this,text:this.session.text("ui.Copy"),inheritAccessibility:!1});t.on("action",function(e){this.exportToClipboard()}.bind(this)),O.create("ContextMenuPopup",{parent:this,menuItems:[t],cloneMenuItems:!1,location:{x:e.pageX,y:e.pageY}}).open()}}},{key:"visitFields",value:function(e){return e(this)}},{key:"visitParents",value:function(e){for(var t=this.parent;t instanceof o;)e(t),t=t.parent}},{key:"markAsSaved",value:function(){this.setProperty("touched",!1),this.updateRequiresSave()}},{key:"touch",value:function(){this.setProperty("touched",!0),this.updateRequiresSave()}},{key:"updateRequiresSave",value:function(){this.initialized&&(this.requiresSave=this.touched||this.computeRequiresSave())}},{key:"computeRequiresSave",value:function(){return!1}},{key:"getValidationResult",value:function(){var e=!this._errorStatus(),t=!this.mandatory||!this.empty;return{valid:e&&t,validByErrorStatus:e,validByMandatory:t}}},{key:"_updateEmpty",value:function(){}},{key:"requestInput",value:function(){this.enabledComputed&&this.rendered&&this.focus()}},{key:"clone",value:function(e,t){var n=LH(WH(o.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,"menus",t),n}},{key:"exportToClipboard",value:function(){if(this.displayText){var e=new Kt({text:this.displayText});this.trigger("clipboardExport",e),e.defaultPrevented||this._exportToClipboard(e.text)}}},{key:"_exportToClipboard",value:function(e){ot.copyText({parent:this,text:e})}}])&&IH(t.prototype,n),i&&IH(t,i),o}(de);function UH(e){return(UH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KH(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qH(e,t){return(qH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=JH(e);if(t){var r=JH(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return XH(this,n)}}function XH(e,t){return!t||"object"!==UH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function JH(e){return(JH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}zH(GH,"FieldStyle",{CLASSIC:"classic",ALTERNATIVE:"alternative"}),zH(GH,"DEFAULT_FIELD_STYLE",GH.FieldStyle.ALTERNATIVE),zH(GH,"StatusPosition",{DEFAULT:"default",TOP:"top"}),zH(GH,"LabelPosition",{DEFAULT:0,LEFT:1,ON_FIELD:2,RIGHT:3,TOP:4}),zH(GH,"TooltipAnchor",{DEFAULT:"default",ON_FIELD:"onField"}),zH(GH,"LabelWidth",{DEFAULT:0,UI:-1}),zH(GH,"FULL_WIDTH",0),zH(GH,"Mode",{DEFAULT:"default",CELLEDITOR:"celleditor"}),zH(GH,"SEVERITY_CSS_CLASSES","has-error has-warning has-info has-ok");var ZH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qH(e,t)}(o,e);var t,n,i,r=YH(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).enabledWhenOffline=!1,e}return t=o,(n=[{key:"_goOffline",value:function(){this.enabledWhenOffline||(this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1))}},{key:"_goOnline",value:function(){this.enabledWhenOffline||this.widget.setEnabled(this._enabledBeforeOffline)}}])&&KH(t.prototype,n),i&&KH(t,i),o}(fe);function QH(e){return(QH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eV(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tV(e,t){return(tV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oV(e);if(t){var r=oV(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return iV(this,n)}}function iV(e,t){return!t||"object"!==QH(t)&&"function"!=typeof t?rV(e):t}function rV(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oV(e){return(oV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tV(e,t)}(o,e);var t,n,i,r=nV(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).formField=e,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmenPropertyChange.bind(rV(t)),Vo.get().on("propertyChange",t.htmlPropertyChangeHandler),t.formField.one("remove",function(){Vo.get().off("propertyChange",this.htmlPropertyChangeHandler)}.bind(rV(t))),t}return t=o,(n=[{key:"_initDefaults",value:function(){this.mandatoryIndicatorWidth=Vo.get().fieldMandatoryIndicatorWidth,this.statusWidth=Vo.get().fieldStatusWidth,this.rowHeight=Vo.get().formRowHeight}},{key:"_onHtmlEnvironmenPropertyChange",value:function(){this._initDefaults(),this.formField.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,i,r,s,a,u,l,c,f,h=Uo.get(e),d=this.formField,p=d._tooltip(),y=this.labelWidth(),v=this.statusWidth;if(u=(t=h.insets({includeBorder:!1})).top,f=t.right,l=t.bottom,c=t.left,this._isLabelVisible())if((d.labelWidthInPixel===GH.LabelWidth.UI||d.labelUseUiWidth)&&(y=d.$label.hasClass("empty")?0:No.prefSize(d.$label).width),O.isOneOf(d.labelPosition,GH.LabelPosition.DEFAULT,GH.LabelPosition.LEFT))No.setBounds(d.$label,c,u,y,this.rowHeight),c+=y+d.$label.cssMarginX();else if(d.labelPosition===GH.LabelPosition.TOP){var b=No.prefSize(d.$label).height;d.$label.cssHeight(b),u+=b+d.$label.cssMarginY(),a=!0}if(d.$mandatory&&d.$mandatory.isVisible()&&(d.$mandatory.cssTop(u).cssLeft(c).cssWidth(this.mandatoryIndicatorWidth),c+=d.$mandatory.outerWidth(!0)),this._isStatusVisible())if(d.$status.cssWidth(v),d.statusPosition===GH.StatusPosition.TOP&&a){var g=No.prefSize(d.$status,{useCssSize:!0}).height,m=t.top+d.$label.cssPaddingTop()+d.$label.height()/2-g/2;d.$status.cssTop(m).cssRight(f+d.$label.cssMarginRight()).cssHeight(g).cssLineHeight(null);var _=No.size(d.$status,!0).width;d.$label.cssPaddingRight(_)}else d.$status.cssTop(u).cssRight(f).cssHeight(this.rowHeight).cssLineHeight(this.rowHeight),f+=v+d.$status.cssMarginX();if(d.$fieldContainer){n=new Ro(u-t.top,f-t.right,l-t.bottom,c-t.left);var w=No.margins(d.$fieldContainer);if(i=h.availableSize({exact:!0}).subtract(h.insets()).subtract(n).subtract(w),r=new Fo(c,u,i.width,i.height),"absolute"!==d.$fieldContainer.css("position")&&(r.x=0,r.y=0),(s=Uo.optGet(d.$fieldContainer))?s.setBounds(r):No.setBounds(d.$fieldContainer,r),d.$field.toggleClass("compact",r.width<=o.MIN_FIELD_WIDTH),d.$container.toggleClass("compact",r.width<=o.MIN_FIELD_WIDTH),a){var k=i.add(w).width-d.$label.cssMarginX();d.$mandatory&&d.$mandatory.isVisible()&&(k+=d.$mandatory.outerWidth(!0)),d.$label.cssWidth(k)}}if(d.$fieldContainer){var S=this._$elementForIconLayout(),T=No.borders(S),C=No.offsetBounds(S);u+=T.top,f+=T.right,r.x+=T.left,r.y+=T.top,r.height=C.height-T.top-T.bottom,r.width=C.width-T.left-T.right,d.$icon&&this._layoutIcon(d,r,f,u),d.$clearIcon&&this._layoutClearIcon(d,r,f,u)}p&&p.rendered&&p.position(),d.$field&&wf.update(d.$field),this._layoutDisabledCopyOverlay()}},{key:"_layoutDisabledCopyOverlay",value:function(){if(this.formField.$field&&this.formField.$disabledCopyOverlay){var e=this.formField.$disabledCopyOverlay,t=this.formField.$field,n=t.position(),i=No.insets(t,{includePadding:!0}),r=t[0],o=t.css("overflow-x"),s=t.css("overflow-y"),a="scroll"===o||"auto"===o&&r.scrollWidth-r.clientWidth>0,u="scroll"===s||"auto"===s&&r.scrollHeight-r.clientHeight>0,l=Mt.get().scrollbarWidth;e.css("top",n.top).css("left",n.left).width(t.width()+i.horizontal()-(u?l:0)).height(t.height()+i.vertical()-(a?l:0))}}},{key:"_isLabelVisible",value:function(){return!!this.formField.$label&&this.formField.labelVisible}},{key:"_isStatusVisible",value:function(){return!!this.formField.$status&&(this.formField.statusVisible||this.formField.$status.isVisible())}},{key:"preferredLayoutSize",value:function(e,t){var n=Uo.get(this.formField.$container),i=this.formField,r=new Co,o=new Co,s=new Co,a=new Co,u=O.nvl(t.widthHint,0),l=O.nvl(t.heightHint,0),c=i.statusPosition===GH.StatusPosition.TOP&&this._isLabelVisible()&&i.labelPosition===GH.LabelPosition.TOP;if(i.$mandatory&&i.$mandatory.isVisible()&&(o.width=this.mandatoryIndicatorWidth+i.$mandatory.cssMarginX(),u-=o.width),this._isLabelVisible()&&(r.width=this.labelWidth()+i.$label.cssMarginX(),r.height=this.rowHeight,i.labelPosition===GH.LabelPosition.TOP?(r.width=0,r.height=No.prefSize(i.$label,!0).height):(i.labelWidthInPixel===GH.LabelWidth.UI||i.labelUseUiWidth)&&(i.$label.hasClass("empty")?r.width=0:r=No.prefSize(i.$label,!0)),O.isOneOf(i.labelPosition,GH.LabelPosition.DEFAULT,GH.LabelPosition.LEFT)?u-=r.width:i.labelPosition===GH.LabelPosition.TOP&&(l-=r.height)),this._isStatusVisible()&&(s.width=this.statusWidth+i.$status.cssMarginX(),c||(s.height=this.rowHeight,u-=s.width)),i.$fieldContainer){var f=No.margins(i.$fieldContainer),h=Uo.optGet(i.$fieldContainer);h||(u-=f.horizontal(),l-=f.vertical()),t.widthHint&&(t.widthHint=u),t.heightHint&&(t.heightHint=l),a=h?h.prefSize(t).add(f):No.prefSize(i.$fieldContainer,t).add(f)}var d=new Co;return d.width=a.width,d.height=a.height,d.width+=o.width,d.height=Math.max(d.height,o.height),O.isOneOf(i.labelPosition,GH.LabelPosition.DEFAULT,GH.LabelPosition.LEFT)?(d.width+=r.width,d.height=Math.max(d.height,r.height)):i.labelPosition===GH.LabelPosition.TOP&&(d.width=Math.max(d.width,r.width),d.height+=r.height),c||(d.width+=s.width,d.height=Math.max(d.height,s.height)),d=d.add(n.insets())}},{key:"_$elementForIconLayout",value:function(){return this.formField.$field}},{key:"_layoutIcon",value:function(e,t,n,i){var r=this.rowHeight;t&&(r=t.height),e.$icon.cssRight(n).cssTop(t.y).cssHeight(r).cssLineHeight(r)}},{key:"_layoutClearIcon",value:function(e,t,n,i){var r=this.rowHeight;t&&(r=t.height),e instanceof aW&&e.gridData.horizontalAlignment>0?e.$clearIcon.cssLeft(t.x).cssRight("").cssTop(t.y).cssHeight(r).cssLineHeight(r):e.$clearIcon.cssLeft("").cssRight(n).cssTop(t.y).cssHeight(r).cssLineHeight(r)}},{key:"labelWidth",value:function(){return GH.LabelWidth.DEFAULT===this.formField.labelWidthInPixel?Vo.get().fieldLabelWidth:this.formField.labelWidthInPixel}}])&&eV(t.prototype,n),i&&eV(t,i),o}(zo);function aV(e){return(aV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uV(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lV(e,t,n){return(lV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dV(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function cV(e,t){return(cV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=dV(e);if(t){var r=dV(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return hV(this,n)}}function hV(e,t){return!t||"object"!==aV(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dV(e){return(dV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(sV,"MIN_FIELD_WIDTH",61);var pV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cV(e,t)}(o,e);var t,n,i,r=fV(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).codes=[],e.severities=[],e.menu=null,e._addWidgetProperties(["menu"]),e}return t=o,(n=[{key:"_createChild",value:function(e){if("string"==typeof e){var t=this.parent.widget(e);if(!t)throw new Error("Referenced widget not found: "+e);return t}return lV(dV(o.prototype),"_createChild",this).call(this,e)}}])&&uV(t.prototype,n),i&&uV(t,i),o}(de);function yV(e){return(yV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vV(e,t){return(vV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mV(e);if(t){var r=mV(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gV(this,n)}}function gV(e,t){return!t||"object"!==yV(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mV(e){return(mV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _V=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vV(e,t)}(n,e);var t=bV(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(fe);function wV(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var kV=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.x=-1,this.y=-1,this.w=1,this.h=1,this.weightX=-1,this.weightY=-1,this.useUiWidth=!1,this.useUiHeight=!1,this.horizontalAlignment=-1,this.verticalAlignment=-1,this.fillHorizontal=!0,this.fillVertical=!0,this.widthInPixel=0,this.heightInPixel=0,s.a.extend(this,t)}var t,n,i;return t=e,i=[{key:"createFromHints",value:function(t,n){var i=new e(t.gridDataHints);return i.w===GH.FULL_WIDTH&&(i.w=n),i}},{key:"ensure",value:function(t){return t?t instanceof e?t:new e(t):t}}],(n=null)&&wV(t.prototype,n),i&&wV(t,i),e}();function SV(e){return(SV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OV(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function TV(e,t,n){return(TV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xV(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function CV(e,t){return(CV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=xV(e);if(t){var r=xV(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return RV(this,n)}}function RV(e,t){return!t||"object"!==SV(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xV(e){return(xV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var EV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CV(e,t)}(o,e);var t,n,i,r=PV(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"getFields",value:function(){throw new Error("Not implemented")}},{key:"setFields",value:function(e){throw new Error("Not implemented")}},{key:"visitFields",value:function(e){var t=TV(xV(o.prototype),"visitFields",this).call(this,e);if(t===JW.TERMINATE)return JW.TERMINATE;if(t===JW.SKIP_SUBTREE)return JW.CONTINUE;for(var n=this.getFields(),i=0;i<n.length;i++)if((t=n[i].visitFields(e))===JW.TERMINATE)return JW.TERMINATE}},{key:"setFieldStyle",value:function(e){this.getFields().forEach((function(t){t.setFieldStyle(e)})),TV(xV(o.prototype),"setFieldStyle",this).call(this,e)}},{key:"activate",value:function(){gH.activateFirstField(this,this.getFields())}},{key:"getFocusableElement",value:function(){var e=ye.findFirstFocusableWidget(this.getFields(),this);return e?e.getFocusableElement():null}}])&&OV(t.prototype,n),i&&OV(t,i),o}(GH);function DV(e){return(DV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FV(e,t){return(FV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=jV(e);if(t){var r=jV(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $V(this,n)}}function $V(e,t){return!t||"object"!==DV(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jV(e){return(jV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FV(e,t)}(n,e);var t=AV(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).enabledWhenOffline=!0,e}return n}(ZH);function IV(e){return(IV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LV(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BV(e,t,n){return(BV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zV(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function NV(e,t){return(NV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function HV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zV(e);if(t){var r=zV(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return VV(this,n)}}function VV(e,t){return!t||"object"!==IV(t)&&"function"!=typeof t?WV(e):t}function WV(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zV(e){return(zV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var GV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NV(e,t)}(o,e);var t,n,i,r=HV(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).clearable=o.Clearable.FOCUSED,e.displayText=null,e.formatter=e._formatValue.bind(WV(e)),e.hasText=!1,e.initialValue=null,e.invalidValueMessageKey="InvalidValueMessageX",e.parser=e._parseValue.bind(WV(e)),e.value=null,e.validators=[],e.validators.push(e._validateValue.bind(WV(e))),e.$clearIcon=null,e._addCloneProperties(["value","displayText","clearable"]),e}return t=o,i=[{key:"invokeValueFieldAboutToBlurByMouseDown",value:function(e){var t=this._getActiveValueField(e);t&&t.aboutToBlurByMouseDown(e)}},{key:"invokeValueFieldAcceptInput",value:function(e){var t=this._getActiveValueField(e);t&&t.acceptInput()}},{key:"_getActiveValueField",value:function(e){var t=s()(e).activeElement(),n=O.widget(t);return n instanceof o&&n.enabledComputed?n:null}}],(n=[{key:"_init",value:function(e){BV(zV(o.prototype),"_init",this).call(this,e),this.validator&&(this.setValidator(this.validator),delete this.validator),this._initValue(this.value)}},{key:"_initValue",value:function(e){this.value=null,this._setValue(e),this._updateEmpty()}},{key:"_renderProperties",value:function(){BV(zV(o.prototype),"_renderProperties",this).call(this),this._renderDisplayText(),this._renderClearable(),this._renderHasText()}},{key:"_remove",value:function(){BV(zV(o.prototype),"_remove",this).call(this),this.$clearIcon=null}},{key:"_renderDisplayText",value:function(){this._updateHasText()}},{key:"_readDisplayText",value:function(){return""}},{key:"_onClearIconMouseDown",value:function(e){this.clear(),e.preventDefault()}},{key:"_onFieldBlur",value:function(){BV(zV(o.prototype),"_onFieldBlur",this).call(this),this.acceptInput(!1)}},{key:"acceptInput",value:function(e){e=!!e;var t=O.nvl(this._readDisplayText(),"");this._checkDisplayTextChanged(t,e)&&(this._setProperty("displayText",t),e||this.parseAndSetValue(t),this._triggerAcceptInput(e))}},{key:"parseAndSetValue",value:function(e){this.clearErrorStatus();try{var t=new Kt({displayText:e});if(this.trigger("parse",t),!t.defaultPrevented){var n=this.parseValue(e);this.setValue(n)}}catch(t){this._parsingFailed(e,t)}}},{key:"_parsingFailed",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("Parsing failed for field with id "+this.id,t);var n=new Kt({displayText:e,error:t});if(this.trigger("parseError",n),!n.defaultPrevented){var i=this._createParsingFailedStatus(e,t);this.setErrorStatus(i)}}},{key:"_createParsingFailedStatus",value:function(e,t){return this._createInvalidValueStatus(e,t)}},{key:"setParser",value:function(e){this.setProperty("parser",e),this.initialized&&this.parseAndSetValue(this.displayText)}},{key:"_setParser",value:function(e){e||(e=this._parseValue.bind(this)),this._setProperty("parser",e)}},{key:"parseValue",value:function(e){var t=this._parseValue.bind(this);return this.parser(e,t)}},{key:"_parseValue",value:function(e){return e}},{key:"_checkDisplayTextChanged",value:function(e,t){return e!==O.nvl(this.displayText,"")}},{key:"aboutToBlurByMouseDown",value:function(e){this.isFocusOnField(e)||this.acceptInput()}},{key:"isFocused",value:function(){return this.rendered&&Cc.isActiveElement(this.$field)}},{key:"isFocusOnField",value:function(e){return this.$field.isOrHas(e)||this.$clearIcon&&this.$clearIcon.isOrHas(e)}},{key:"_triggerAcceptInput",value:function(e){var t={displayText:this.displayText,whileTyping:!!e};this.trigger("acceptInput",t)}},{key:"setDisplayText",value:function(e){this.setProperty("displayText",e)}},{key:"_updateHasText",value:function(){this.setHasText(En.hasText(this._readDisplayText()))}},{key:"setHasText",value:function(e){this.setProperty("hasText",e)}},{key:"_renderHasText",value:function(){this.$field&&this.$field.toggleClass("has-text",this.hasText),this.$container.toggleClass("has-text",this.hasText)}},{key:"setClearable",value:function(e){this.setProperty("clearable",e)}},{key:"_renderClearable",value:function(){this.isClearable()?this.$clearIcon||this.addClearIcon():this.$clearIcon&&(this.$clearIcon.remove(),this.$clearIcon=null),this.invalidateLayoutTree(!1),this._updateClearableStyles()}},{key:"_updateClearableStyles",value:function(){this.$container.removeClass("clearable-always clearable-focused"),this.isClearable()&&(this.clearable===o.Clearable.ALWAYS?this.$container.addClass("clearable-always"):this.clearable===o.Clearable.FOCUSED&&this.$container.addClass("clearable-focused"))}},{key:"isClearable",value:function(){return this.clearable===o.Clearable.ALWAYS||this.clearable===o.Clearable.FOCUSED}},{key:"clear",value:function(){this._clear(),this._updateHasText(),this.acceptInput(),this._triggerClear()}},{key:"_clear",value:function(){}},{key:"_triggerClear",value:function(){this.trigger("clear")}},{key:"setValue",value:function(e){e=this._prepareProperty("value",e),this.rendered&&this._callRemoveProperty("value"),this._callSetProperty("value",e),this.rendered&&this._callRenderProperty("value")}},{key:"resetValue",value:function(){this.setValue(this.initialValue)}},{key:"_ensureValue",value:function(e){return e}},{key:"_setValue",value:function(e){var t=this.value;this._updateErrorStatus(null);var n=null;try{n=this._ensureValue(e),this.value=this.validateValue(n)}catch(t){return n=n||e,void this._validationFailed(n,t)}this._updateDisplayText(),this._valueEquals(t,this.value)||(this._valueChanged(),this._updateTouched(),this._updateEmpty(),this.triggerPropertyChange("value",t,this.value))}},{key:"_valueEquals",value:function(e,t){return oi.equals(e,t)}},{key:"_valueChanged",value:function(){}},{key:"validate",value:function(){this._setValue(this.value)}},{key:"addValidator",value:function(e,t){var n=this.validators.slice();n.push(e),this.setValidators(n,t)}},{key:"removeValidator",value:function(e,t){var n=this.validators.slice();et.remove(n,e),this.setValidators(n,t)}},{key:"setValidator",value:function(e,t){e||(e=this._validateValue.bind(this));var n=[];e&&(n=[e]),this.setValidators(n,t)}},{key:"setValidators",value:function(e,t){this.setProperty("validators",e),this.initialized&&O.nvl(t,!0)&&this.validate()}},{key:"validateValue",value:function(e){var t=this._validateValue.bind(this);return this.validators.forEach((function(n){e=n(e,t)})),e=O.nvl(e,null)}},{key:"_validateValue",value:function(e){return"string"==typeof e&&""===e&&(e=null),e}},{key:"_validationFailed",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("Validation failed for field with id "+this.id,t);var n=this._createValidationFailedStatus(e,t);this._updateErrorStatus(n),this._updateDisplayText(e)}},{key:"_createValidationFailedStatus",value:function(e,t){return this._createInvalidValueStatus(e,t)}},{key:"_createInvalidValueStatus",value:function(e,t){return t instanceof pi?t:"string"==typeof t?pi.error({message:t}):pi.error({message:this.session.text(this.invalidValueMessageKey,e)})}},{key:"_updateErrorStatus",value:function(e){!this.initialized&&this.errorStatus||(e?this.setErrorStatus(e):this.clearErrorStatus())}},{key:"_updateDisplayText",value:function(e){if(this.initialized||oi.isNullOrUndefined(this.displayText)){e=O.nvl(e,this.value);var t=this.formatValue(e);t&&s.a.isFunction(t.promise)?t.done(this.setDisplayText.bind(this)).fail(function(){this.setDisplayText(""),s.a.log.isInfoEnabled()&&s.a.log.info("Could not resolve display text for value: "+e)}.bind(this)):this.setDisplayText(t)}}},{key:"setFormatter",value:function(e){this.setProperty("formatter",e),this.initialized&&this.validate()}},{key:"_setFormatter",value:function(e){e||(e=this._formatValue.bind(this)),this._setProperty("formatter",e)}},{key:"formatValue",value:function(e){var t=this._formatValue.bind(this);return this.formatter(e,t)}},{key:"_formatValue",value:function(e){return O.nvl(e,"")+""}},{key:"_updateTouched",value:function(){this.touched=!this._valueEquals(this.value,this.initialValue)}},{key:"addClearIcon",value:function(e){e||(e=this.$container),this.$clearIcon=e.appendSpan("clear-icon needsclick unfocusable").on("mousedown",this._onClearIconMouseDown.bind(this))}},{key:"addContainer",value:function(e,t,n){BV(zV(o.prototype),"addContainer",this).call(this,e,t,n),this.$container.addClass("value-field")}},{key:"addField",value:function(e){BV(zV(o.prototype),"addField",this).call(this,e),this.$field.data("valuefield",this)}},{key:"setCurrentMenuTypes",value:function(e){this.setProperty("currentMenuTypes",e)}},{key:"_renderCurrentMenuTypes",value:function(){this._updateFieldStatus()}},{key:"_getCurrentMenus",value:function(){if(this.currentMenuTypes){var e=this.currentMenuTypes.map((function(e){return"ValueField."+e}));return mb.filter(this.menus,e)}return BV(zV(o.prototype),"_getCurrentMenus",this).call(this)}},{key:"markAsSaved",value:function(){BV(zV(o.prototype),"markAsSaved",this).call(this),this.initialValue=this.value}},{key:"_updateEmpty",value:function(){this.empty=null===this.value||void 0===this.value}}])&&LV(t.prototype,n),i&&LV(t,i),o}(GH);function UV(e){return(UV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KV(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qV(e,t,n){return(qV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ZV(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function YV(e,t){return(YV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ZV(e);if(t){var r=ZV(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return JV(this,n)}}function JV(e,t){return!t||"object"!==UV(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZV(e){return(ZV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(GV,"Clearable",{ALWAYS:"always",FOCUSED:"focused",NEVER:"never"});var QV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YV(e,t)}(o,e);var t,n,i,r=XV(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetAcceptInput",value:function(e){this._send("acceptInput",{displayText:e.displayText,whileTyping:e.whileTyping},{showBusyIndicator:!e.whileTyping,coalesce:function(e){return this.target===e.target&&this.type===e.type&&this.whileTyping===e.whileTyping}})}},{key:"_onWidgetEvent",value:function(e){"acceptInput"===e.type?this._onWidgetAcceptInput(e):qV(ZV(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"exportAdapterData",value:function(e){return delete(e=qV(ZV(o.prototype),"exportAdapterData",this).call(this,e)).displayText,e}},{key:"_syncDisplayText",value:function(e){this.widget.setDisplayText(e),this.widget.parseAndSetValue(e)}},{key:"_createPropertySortFunc",value:function(e){return function(t,n){var i=e.indexOf(t),r=e.indexOf(n);return i>-1&&r>-1?i-r:i>-1?-1:r>-1?1:yD.TEXT.compare(t,n)}}}])&&KV(t.prototype,n),i&&KV(t,i),o}(ZH);function eW(e){return(eW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tW(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nW(e,t,n){return(nW="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sW(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function iW(e,t){return(iW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=sW(e);if(t){var r=sW(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return oW(this,n)}}function oW(e,t){return!t||"object"!==eW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sW(e){return(sW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var aW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iW(e,t)}(o,e);var t,n,i,r=rW(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).disabledCopyOverlay=!0,e._displayTextModifiedTimeoutId=null,e.updateDisplayTextOnModify=!1,e.updateDisplayTextOnModifyDelay=250,e}return t=o,(n=[{key:"addField",value:function(e){nW(sW(o.prototype),"addField",this).call(this,e),e&&e.on("input",this._onFieldInput.bind(this))}},{key:"setUpdateDisplayTextOnModify",value:function(e){null!==this._displayTextModifiedTimeoutId&&(clearTimeout(this._displayTextModifiedTimeoutId),this._acceptInputWhileTyping()),this.setProperty("updateDisplayTextOnModify",e)}},{key:"setUpdateDisplayTextOnModifyDelay",value:function(e){this.setProperty("updateDisplayTextOnModifyDelay",e)}},{key:"_clear",value:function(){this.$field.val("")}},{key:"_onFieldInput",value:function(){this._updateHasText(),this.updateDisplayTextOnModify&&this._onDisplayTextModified()}},{key:"_onDisplayTextModified",value:function(){clearTimeout(this._displayTextModifiedTimeoutId),this.updateDisplayTextOnModifyDelay?this._displayTextModifiedTimeoutId=setTimeout(this._acceptInputWhileTyping.bind(this),this.updateDisplayTextOnModifyDelay):this._acceptInputWhileTyping()}},{key:"_acceptInputWhileTyping",value:function(){this._displayTextModifiedTimeoutId=null,this.rendered&&this.acceptInput(!0)}},{key:"acceptInput",value:function(e){null!==this._displayTextModifiedTimeoutId&&(clearTimeout(this._displayTextModifiedTimeoutId),this._displayTextModifiedTimeoutId=null),nW(sW(o.prototype),"acceptInput",this).call(this,e)}},{key:"_renderDisplayText",value:function(){this.$field.val(this.displayText),nW(sW(o.prototype),"_renderDisplayText",this).call(this)}},{key:"_readDisplayText",value:function(){return this.$field.val()}},{key:"_checkDisplayTextChanged",value:function(e,t){var n=nW(sW(o.prototype),"_checkDisplayTextChanged",this).call(this,e,t);return t?this.updateDisplayTextOnModify&&n&&(this._displayTextChangedWhileTyping=!0):(this._displayTextChangedWhileTyping&&(n=!0),this._displayTextChangedWhileTyping=!1),n}}])&&tW(t.prototype,n),i&&tW(t,i),o}(GV);function uW(e){return(uW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lW(e,t){return(lW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=hW(e);if(t){var r=hW(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fW(this,n)}}function fW(e,t){return!t||"object"!==uW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hW(e){return(hW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lW(e,t)}(n,e);var t=cW(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).enabledWhenOffline=!0,e}return n}(QV);function pW(e){return(pW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yW(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vW(e,t,n){return(vW="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_W(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function bW(e,t){return(bW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_W(e);if(t){var r=_W(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return mW(this,n)}}function mW(e,t){return!t||"object"!==pW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _W(e){return(_W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bW(e,t)}(o,e);var t,n,i,r=gW(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).scrollable=!0,e.fieldWidget=null,e._addWidgetProperties(["fieldWidget"]),e}return t=o,(n=[{key:"_init",value:function(e){vW(_W(o.prototype),"_init",this).call(this,e)}},{key:"_render",value:function(){this.addContainer(this.$parent,"widget-field",new jW(this)),this.addLabel(),this.addMandatoryIndicator(),this.addStatus()}},{key:"_renderProperties",value:function(){vW(_W(o.prototype),"_renderProperties",this).call(this),this._renderFieldWidget(),this._renderScrollable()}},{key:"setFieldWidget",value:function(e){this.setProperty("fieldWidget",e)}},{key:"_renderFieldWidget",value:function(){this.fieldWidget&&(this.fieldWidget.render(),this.addField(this.fieldWidget.$container),this.invalidateLayoutTree())}},{key:"_removeFieldWidget",value:function(){this.fieldWidget&&(this.fieldWidget.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this._uninstallScrollbars(),this.scrollable&&this._installScrollbars()}},{key:"get$Scrollable",value:function(){return this.$fieldContainer}}])&&yW(t.prototype,n),i&&yW(t,i),o}(GH);function kW(e){return(kW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SW(e,t){return(SW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=CW(e);if(t){var r=CW(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return TW(this,n)}}function TW(e,t){return!t||"object"!==kW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CW(e){return(CW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SW(e,t)}(n,e);var t=OW(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function RW(e){return(RW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xW(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function EW(e,t,n){return(EW="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$W(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function DW(e,t){return(DW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function FW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$W(e);if(t){var r=$W(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return AW(this,n)}}function AW(e,t){return!t||"object"!==RW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $W(e){return($W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DW(e,t)}(o,e);var t,n,i,r=FW(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"layout",value:function(e){EW($W(o.prototype),"layout",this).call(this,e),wf.update(this.$fieldContainer)}}])&&xW(t.prototype,n),i&&xW(t,i),o}(sV);function MW(e){return(MW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IW(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function LW(e,t,n){return(LW="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VW(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function BW(e,t){return(BW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=VW(e);if(t){var r=VW(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return HW(this,n)}}function HW(e,t){return!t||"object"!==MW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function VW(e){return(VW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var WW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BW(e,t)}(o,e);var t,n,i,r=NW(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).filterBox=null,e.gridDataHints.weightY=1,e.gridDataHints.h=2,e.value=[],e.lookupCall=null,e._pendingLookup=null,e._currentLookupCall=null,e._pendingLookup=null,e._lookupExecuted=!1,e._valueSyncing=!1,e._addCloneProperties(["lookupCall"]),e}return t=o,(n=[{key:"_init",value:function(e){LW(VW(o.prototype),"_init",this).call(this,e),this.filterBox&&(this.filterBox.enabledComputed=!0,this.filterBox.recomputeEnabled(!0),this.filterBox.on("propertyChange",this._onFilterBoxPropertyChange.bind(this)))}},{key:"_initValue",value:function(e){this.lookupCall&&this._setLookupCall(this.lookupCall),this._initStructure(e),LW(VW(o.prototype),"_initValue",this).call(this,e)}},{key:"_render",value:function(){this.addContainer(this.$parent,"lookup-box"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.addFieldContainer(this.$parent.makeDiv()),Uo.install(this.$fieldContainer,this.session).setLayout(this._createFieldContainerLayout()),this._ensureLookupCallExecuted(),this._renderStructure(),this.$field.addDeviceClass(),this.$field.addClass("structure"),this._renderFilterBox()}},{key:"_renderFilterBox",value:function(){this.filterBox&&this.filterBox.visible&&this.filterBox.render(this.$fieldContainer)}},{key:"_ensureValue",value:function(e){return et.ensure(e)}},{key:"_updateEmpty",value:function(){this.empty=et.empty(this.value)}},{key:"_lookupByAll",value:function(){if(this.lookupCall){this._clearPendingLookup();var e=s.a.Deferred(),t=function(t){this._lookupByAllDone(t),e.resolve(t)}.bind(this);return this._executeLookup(this.lookupCall.cloneForAll(),!0).done(t),e.promise()}}},{key:"_clearPendingLookup",value:function(){this._pendingLookup&&(clearTimeout(this._pendingLookup),this._pendingLookup=null)}},{key:"_executeLookup",value:function(e,t){return this.setLoading(!0),t&&this._currentLookupCall&&this._currentLookupCall.abort(),this._currentLookupCall=e,this.trigger("prepareLookupCall",{lookupCall:e}),e.execute().always(function(){this._currentLookupCall=null,this._lookupExecuted=!0,this.setLoading(!1),this._clearLookupStatus()}.bind(this))}},{key:"_lookupByAllDone",value:function(e){try{return e.exception?(this.setErrorStatus(pi.error({message:e.exception})),!1):0!==e.lookupRows.length||(this.setLookupStatus(pi.warning({message:this.session.text("SmartFieldNoDataFound"),code:o.ErrorCode.NO_DATA})),!1)}finally{this.trigger("lookupCallDone",{result:e})}}},{key:"_errorStatus",value:function(){return this.lookupStatus||this.errorStatus}},{key:"setLookupStatus",value:function(e){this.setProperty("lookupStatus",e),this.rendered&&this._renderErrorStatus()}},{key:"clearErrorStatus",value:function(){this.setErrorStatus(null),this._clearLookupStatus()}},{key:"_clearLookupStatus",value:function(){this.setLookupStatus(null)}},{key:"setLookupCall",value:function(e){this.setProperty("lookupCall",e)}},{key:"_setLookupCall",value:function(e){this._setProperty("lookupCall",ur.ensure(e,this.session)),this._lookupExecuted=!1,this.rendered&&this._ensureLookupCallExecuted()}},{key:"refreshLookup",value:function(){this._lookupExecuted=!1,this._ensureLookupCallExecuted()}},{key:"_ensureLookupCallExecuted",value:function(){return!this._lookupExecuted&&(this._lookupByAll(),!0)}},{key:"_formatValue",value:function(e){return oi.isNullOrUndefined(e)?"":this._formatLookupRows(this.getCheckedLookupRows())}},{key:"_formatLookupRows",value:function(e){if(0===(e=et.ensure(e)).length)return"";var t=[];return e.forEach((function(e){t.push(e.text)})),En.join(", ",t)}},{key:"_readDisplayText",value:function(){return this.displayText}},{key:"_clear",value:function(){this.setValue(null)}},{key:"_onFilterBoxPropertyChange",value:function(e){if("visible"===e.propertyName){if(!this.rendered)return;this.filterBox.visible?this._renderFilterBox():this.filterBox.remove()}}}])&&IW(t.prototype,n),i&&IW(t,i),o}(GV);function zW(e){return(zW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GW(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function UW(e,t){return(UW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=YW(e);if(t){var r=YW(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return qW(this,n)}}function qW(e,t){return!t||"object"!==zW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function YW(e){return(YW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(WW,"ErrorCode",{NO_DATA:1});var XW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UW(e,t)}(o,e);var t,n,i,r=KW(o);function o(e,t,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this)).box=e,i.structure=t,i.filterBox=n,i}return t=o,(n=[{key:"layout",value:function(e){var t,n=Uo.get(e).size(),i=n.height;this.filterBox&&this.filterBox.rendered&&(i-=t=Uo.get(this.filterBox.$container).prefSize().height),i=Math.max(i,20),Uo.get(this.structure.$container).setSize(new Co(n.width,i)),this.filterBox&&this.filterBox.rendered&&Uo.get(this.filterBox.$container).setSize(new Co(n.width,t))}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n,i,r,o,s=0,a=Uo.get(e),u=Vo.get().formRowHeight,l=this.box;return t.heightHint=null,l.$label&&l.labelVisible&&(s+=Vo.get().fieldLabelWidth),l.$mandatory&&l.$mandatory.isVisible()&&(s+=l.$mandatory.outerWidth(!0)),l.$status&&l.statusVisible&&(s+=l.$status.outerWidth(!0)),n=(r=Uo.optGet(this.structure.$container))?r.prefSize(t).add(a.insets()).add(r.margins()):this.naturalSize(l),i=new Co(0,0),this.filterBox&&(o=Uo.optGet(this.filterBox.$container))&&(i=o.prefSize(t).add(a.insets()).add(o.margins())),s+=Math.max(n.width,i.width),u=Math.max(u,n.height+i.height),new Co(s,u)}},{key:"naturalSize",value:function(e){return new Co(e.$fieldContainer.width(),e.$fieldContainer.height())}}])&&GW(t.prototype,n),i&&GW(t,i),o}(zo),JW={CONTINUE:"continue",TERMINATE:"terminate",SKIP_SUBTREE:"skip_subtree"};function ZW(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var QW=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.displayParent=t.displayParent,this.session=t.session}var t,n,i;return t=e,(n=[{key:"registerAndRender",value:function(e,t,n){O.assertProperty(e,"displayParent"),e.isPopupWindow()?this._renderPopupWindow(e):e.isView()?this._renderView(e,!0,t,n):this._renderDialog(e,!0)}},{key:"_renderPopupWindow",value:function(e,t){throw new Error("popup window only supported by DesktopFormController")}},{key:"unregisterAndRemove",value:function(e){e&&(e.isPopupWindow()?this._removePopupWindow(e):e.isView()?this._removeView(e):this._removeDialog(e))}},{key:"_removePopupWindow",value:function(e){throw new Error("popup window only supported by DesktopFormController")}},{key:"render",value:function(){this._renderViews(),this._renderDialogs()}},{key:"_renderViews",value:function(){this.displayParent.views.forEach(function(e,t){e.setDisplayParent(this.displayParent),this._renderView(e,!1,t,!1)}.bind(this))}},{key:"_renderDialogs",value:function(){this.displayParent.dialogs.forEach(function(e){e.setDisplayParent(this.displayParent),this._renderDialog(e,!1)}.bind(this))}},{key:"remove",value:function(){this.displayParent.dialogs.forEach(function(e){this._removeDialog(e,!1)}.bind(this)),this.displayParent.views.forEach(function(e,t){this._removeView(e,!1)}.bind(this))}},{key:"activateForm",value:function(e){for(var t=this.displayParent;t;){if(t instanceof ahe){this.session.desktop.setOutline(t);break}t=t.displayParent}e.displayHint===ZO.DisplayHint.VIEW?this._activateView(e):this._activateDialog(e)}},{key:"acceptView",value:function(e,t,n,i){return this.displayParent.rendered}},{key:"_renderView",value:function(e,t,n,i){if(t&&(void 0!==n?et.insert(this.displayParent.views,e,n):this.displayParent.views.push(e)),this.displayParent.acceptView){if(!this.displayParent.acceptView(e))return}else if(!this.acceptView(e))return;if(e.rendered)return!1;if(this.session.desktop.displayStyle!==poe.DisplayStyle.COMPACT||this.session.desktop.bench){if(this.session.desktop.bench.removalPending)return void setTimeout(this._renderView.bind(this,e,t,n,i))}else this.session.desktop.sendOutlineToBack(),this.session.desktop.switchToBench();this.session.desktop.bench.addView(e,i)}},{key:"acceptDialog",value:function(e){return this.displayParent.rendered}},{key:"_renderDialog",value:function(e,t){var n=this.session.desktop;if(t&&this.displayParent.dialogs.push(e),this.displayParent.acceptDialog){if(!this.displayParent.acceptDialog(e))return}else if(!this.acceptDialog(e))return;if(e.rendered)return!1;e.on("remove",function(){var e=this._findFormToActivateAfterDialogRemove();e?n._setFormActivated(e):n._setOutlineActivated()}.bind(this)),e.isPopupWindow()?this._renderPopupWindow(e):(e.setTrackFocus(!0),e.render(n.$container),this._layoutDialog(e),n._setFormActivated(e),this.displayParent.inFront()||e.detach())}},{key:"_findFormToActivateAfterDialogRemove",value:function(){if(this.displayParent.dialogs.length>0)return this.displayParent.dialogs[this.displayParent.dialogs.length-1];if(this.displayParent instanceof ZO&&!this.displayParent.detailForm)return this.displayParent;var e=this.session.desktop;if(e.bench){var t=e.bench.activeViews()[0];if(t instanceof ZO&&!t.detailForm)return t}}},{key:"_removeView",value:function(e,t){(t=O.nvl(t,!0))&&et.remove(this.displayParent.views,e),this.session.desktop.bench&&this.session.desktop.bench.removeView(e)}},{key:"_removeDialog",value:function(e,t){(t=O.nvl(t,!0))&&et.remove(this.displayParent.dialogs,e),e.rendered&&e.remove()}},{key:"_activateView",value:function(e){var t=this.session.desktop.bench;t&&t.activateView(e)}},{key:"_activateDialog",value:function(e){if(e.displayParent instanceof ZO&&(e.displayParent.displayHint===ZO.DisplayHint.VIEW||e.displayParent.displayHint===ZO.DisplayHint.DIALOG&&e.modal)&&this.activateForm(e.displayParent),e.rendered){var t=e.$container.nextAll().toArray(),n=t.filter((function(t){var n=O.widget(t);return n instanceof ZO&&(!n.modal||!e.has(n)&&n.displayParent!==this.session.desktop)}),this),i=t.filter((function(e){return et.find(n,(function(t){var n=O.widget(e);return!(n instanceof ZO)&&O.widget(t).has(n)}))}));n=n.concat(i),this.session.desktop.moveOverlaysBehindAndFocus(n,e.$container)}}},{key:"attachDialogs",value:function(){this.displayParent.dialogs.forEach((function(e){e.attach()}),this)}},{key:"detachDialogs",value:function(){this.displayParent.dialogs.forEach((function(e){e.detach()}),this)}},{key:"_layoutDialog",value:function(e){var t,n;e.htmlComp.validateLayout(),n=(t=e.readCacheBounds())?t.point():aP.positionContainerInWindow(e.$container),e.$container.cssPosition(n),e.trigger("move",{left:n.x,top:n.y}),e.updateCacheBounds(),this.session.focusManager.validateFocus(),e.$container.addClassForAnimation("animate-open"),e.$container.addDeviceClass()}}])&&ZW(t.prototype,n),i&&ZW(t,i),e}();function ez(e){return(ez="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tz(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nz(e,t,n){return(nz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sz(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function iz(e,t){return(iz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=sz(e);if(t){var r=sz(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return oz(this,n)}}function oz(e,t){return!t||"object"!==ez(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sz(e){return(sz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var az=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iz(e,t)}(o,e);var t,n,i,r=rz(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).severity=null,e.body=null,e.cancelButtonText=null,e.header=null,e.hiddenText=null,e.html=null,e.noButtonText=null,e.yesButtonText=null,e.$content=null,e.$header=null,e.$body=null,e.$buttons=null,e.$yesButton=null,e.$noButton=null,e.$cancelButton=null,e._$abortButton=null,e.displayParent=null,e}return t=o,(n=[{key:"_init",value:function(e){nz(sz(o.prototype),"_init",this).call(this,e),this._setDisplayParent(this.displayParent)}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){nz(sz(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new Az(this),new cl(this.session,this),new il(this,[pu.SPACE,pu.ENTER]),new Ol(this,function(){return this._$abortButton}.bind(this))])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("messagebox").on("mousedown",this._onMouseDown.bind(this)).on("copy",this._onCopy.bind(this));var e=this.$container.appendDiv("drag-handle");this.$container.draggable(e),this.$content=this.$container.appendDiv("messagebox-content"),this.$header=this.$content.appendDiv("messagebox-label messagebox-header"),this.$body=this.$content.appendDiv("messagebox-label messagebox-body"),this.$html=this.$content.appendDiv("messagebox-label messagebox-html prevent-initial-focus"),this.$buttons=this.$container.appendDiv("messagebox-buttons").on("copy",this._onCopy.bind(this));var t=new Yl(this.$buttons,this._onButtonClick.bind(this));this._$abortButton=null,this.yesButtonText&&(this.$yesButton=t.addButton({text:this.yesButtonText,option:o.Buttons.YES}),this._$abortButton=this.$yesButton),this.noButtonText&&(this.$noButton=t.addButton({text:this.noButtonText,option:o.Buttons.NO}),this._$abortButton=this.$noButton),this.cancelButtonText&&(this.$cancelButton=t.addButton({text:this.cancelButtonText,option:o.Buttons.CANCEL}),this._$abortButton=this.$cancelButton),this._installScrollbars({axis:"y"}),this._renderIconId(),this._renderSeverity(),this._renderHeader(),this._renderBody(),this._renderHtml(),this._renderHiddenText(),this.$container.addClass("calc-helper");var n=this.$container.width();this.$container.removeClass("calc-helper"),this.$container.css("min-width",Math.max(n,100*t.buttonCount())),t.updateButtonWidths(this.$container.width()),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new Cz(this)),this.htmlComp.validateLayout(),this.$container.addClassForAnimation("animate-open"),this.$container.select(),this._glassPaneRenderer=new Bc(this),this._glassPaneRenderer.renderGlassPanes()}},{key:"get$Scrollable",value:function(){return this.$content}},{key:"_postRender",value:function(){nz(sz(o.prototype),"_postRender",this).call(this),this._installFocusContext()}},{key:"_remove",value:function(){this._glassPaneRenderer.removeGlassPanes(),this._uninstallFocusContext(),nz(sz(o.prototype),"_remove",this).call(this)}},{key:"_installFocusContext",value:function(){this.session.focusManager.installFocusContext(this.$container,Pc.AUTO)}},{key:"_uninstallFocusContext",value:function(){this.session.focusManager.uninstallFocusContext(this.$container)}},{key:"_renderIconId",value:function(){}},{key:"_renderSeverity",value:function(){this.$container.removeClass("severity-error"),this.severity===pi.Severity.ERROR&&this.$container.addClass("severity-error")}},{key:"_renderHeader",value:function(){this.$header.html(En.nl2br(this.header)),this.$header.setVisible(this.header)}},{key:"_renderBody",value:function(){this.$body.html(En.nl2br(this.body)),this.$body.setVisible(this.body)}},{key:"_renderHtml",value:function(){this.$html.html(this.html),this.$html.setVisible(this.html),this.$html.find("a, .app-link").attr("tabindex","0").unfocusable()}},{key:"_renderHiddenText",value:function(){this.$hiddenText&&this.$hiddenText.remove(),this.hiddenText&&(this.$hiddenText=this.$content.appendElement("\x3c!-- \n"+this.hiddenText.replace(/<!--|-->/g,"")+"\n --\x3e"))}},{key:"_onMouseDown",value:function(){var e=this.findParent((function(e){return e instanceof ZO&&e.isDialog()}));e&&e.activate()}},{key:"_setCopyable",value:function(e){this.$header.toggleClass("copyable",e),this.$body.toggleClass("copyable",e),this.$html.toggleClass("copyable",e)}},{key:"copy",value:function(){this._setCopyable(!0);var e=this.$container.document(!0),t=e.createRange();t.selectNodeContents(this.$content[0]);var n=this.$container.window(!0).getSelection();n.removeAllRanges(),n.addRange(t),e.execCommand("copy")}},{key:"_onCopy",value:function(e){var t=Mt.get().isInternetExplorer(),n=t?this.$container.window(!0).clipboardData:oi.optProperty(e,"originalEvent","clipboardData");if(n){if(!t){var i=En.join("<br/>",this.$header[0].outerHTML,this.$body[0].outerHTML,this.$html[0].outerHTML,this.hiddenText);n.setData("text/html",i)}var r=t?"Text":"text/plain",o=En.join("\n\n",this.$header.text(),this.$body.text(),this.$html.text(),this.hiddenText);n.setData(r,o),this.$container.window(!0).getSelection().removeAllRanges(),this._setCopyable(!1),ot.showNotification(this),e.preventDefault()}}},{key:"_onButtonClick",value:function(e,t){this.trigger("action",{option:t})}},{key:"setDisplayParent",value:function(e){this.setProperty("displayParent",e)}},{key:"_setDisplayParent",value:function(e){this._setProperty("displayParent",e),e&&this.setParent(this.findDesktop().computeParentForDisplayParent(e))}},{key:"open",value:function(){this.setDisplayParent(this.displayParent||this.session.desktop),this.displayParent.messageBoxController.registerAndRender(this)}},{key:"close",value:function(){this.displayParent&&this.displayParent.messageBoxController.unregisterAndRemove(this),this.destroy()}},{key:"abort",value:function(){this._$abortButton&&this.session.focusManager.requestFocus(this._$abortButton)&&this._$abortButton.click()}},{key:"_attach",value:function(){this.$parent.append(this.$container),nz(sz(o.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.$container.detach(),nz(sz(o.prototype),"_detach",this).call(this)}}])&&tz(t.prototype,n),i&&tz(t,i),o}(de);function uz(e){return(uz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lz(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cz(e,t,n){return(cz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pz(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function fz(e,t){return(fz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pz(e);if(t){var r=pz(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dz(this,n)}}function dz(e,t){return!t||"object"!==uz(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pz(e){return(pz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(az,"Buttons",{YES:"yes",NO:"no",CANCEL:"cancel"});var yz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fz(e,t)}(o,e);var t,n,i,r=hz(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetAction",value:function(e){this._send("action",{option:e.option})}},{key:"_onWidgetEvent",value:function(e){"action"===e.type?this._onWidgetAction(e):cz(pz(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&lz(t.prototype,n),i&&lz(t,i),o}(fe);function vz(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var bz=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.displayParent=t,this.session=n}var t,n,i;return t=e,(n=[{key:"registerAndRender",value:function(e){O.assertProperty(e,"displayParent"),this.displayParent.messageBoxes.push(e),this._render(e)}},{key:"unregisterAndRemove",value:function(e){e&&(et.remove(this.displayParent.messageBoxes,e),this._remove(e))}},{key:"remove",value:function(){this.displayParent.messageBoxes.forEach(this._remove.bind(this))}},{key:"render",value:function(){this.displayParent.messageBoxes.forEach(function(e){e.setDisplayParent(this.displayParent),this._render(e)}.bind(this))}},{key:"_render",value:function(e){if(e.displayParent||e._setProperty("displayParent",this.displayParent),this.displayParent.acceptView){if(!this.displayParent.acceptView(e))return}else if(!this.acceptView(e))return;var t;e.rendered||(t=this.displayParent instanceof ZO&&this.displayParent.isPopupWindow()?this.displayParent.popupWindow.$container:this.session.desktop.$container,e.setTrackFocus(!0),e.render(t),this.displayParent.inFront()||e.detach())}},{key:"_remove",value:function(e){e.remove()}},{key:"attach",value:function(){this.displayParent.messageBoxes.forEach((function(e){e.attach()}),this)}},{key:"detach",value:function(){this.displayParent.messageBoxes.forEach((function(e){e.detach()}),this)}},{key:"acceptView",value:function(e){return this.displayParent.rendered}}])&&vz(t.prototype,n),i&&vz(t,i),e}();function gz(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var mz=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=null,this.yesText=null,this.noText=null,this.cancelText=null,this.bodyText=null,this.severity=pi.Severity.INFO,this.headerText=null,this.closeOnClick=!0,this.html=!1}var t,n,i;return t=e,i=[{key:"create",value:function(e){return O.create("MessageBoxes",{parent:e})}},{key:"createOk",value:function(e){return this.create(e).withYes(e.session.text("Ok"))}},{key:"createYesNo",value:function(e){return this.create(e).withYes().withNo()}},{key:"createYesNoCancel",value:function(e){return this.create(e).withYes().withNo().withCancel()}},{key:"openOk",value:function(e,t,n){return this.createOk(e).withBody(t).withSeverity(n).buildAndOpen()}},{key:"openYesNo",value:function(e,t,n){return this.createYesNo(e).withBody(t).withSeverity(n).buildAndOpen()}}],(n=[{key:"init",value:function(e){O.assertParameter("parent",e.parent),s.a.extend(this,e)}},{key:"withHeader",value:function(e){return this.headerText=e,this}},{key:"withBody",value:function(e,t){return this.bodyText=e,this.html=O.nvl(t,!1),this}},{key:"withSeverity",value:function(e){return this.severity=O.nvl(e,pi.Severity.INFO),this}},{key:"withYes",value:function(e){return this.yesText=O.nvl(e,this.parent.session.text("Yes")),this}},{key:"withNo",value:function(e){return this.noText=O.nvl(e,this.parent.session.text("No")),this}},{key:"withCancel",value:function(e){return this.cancelText=O.nvl(e,this.parent.session.text("Cancel")),this}},{key:"build",value:function(){var e={parent:this.parent,header:this.headerText,body:this.bodyText,severity:this.severity};return En.hasText(this.yesText)&&(e.yesButtonText=this.yesText),En.hasText(this.noText)&&(e.noButtonText=this.noText),En.hasText(this.cancelText)&&(e.cancelButtonText=this.cancelText),this.html&&(e.html=e.body,delete e.body),O.create("MessageBox",e)}},{key:"buildAndOpen",value:function(){var e=s.a.Deferred(),t=this.build();return t.on("action",function(n){this.closeOnClick&&t.close(),e.resolve(n.option)}.bind(this)),t.open(),e.promise()}}])&&gz(t.prototype,n),i&&gz(t,i),e}();function _z(e){return(_z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wz(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kz(e,t){return(kz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Tz(e);if(t){var r=Tz(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Oz(this,n)}}function Oz(e,t){return!t||"object"!==_z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tz(e){return(Tz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kz(e,t)}(o,e);var t,n,i,r=Sz(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).messageBox=e,t}return t=o,(n=[{key:"layout",value:function(e){var t=Uo.get(e),n=e.windowSize(),i=t.offsetBounds(!0),r=t.size(),o=t.margins();r=aP.fitContainerInWindow(n,i.point(),r,o),e.toggleClass("full-width",0===i.x&&0===o.horizontal()&&n.width===r.width).toggleClass("full-height",0===i.y&&0===o.vertical()&&n.height===r.height),No.setSize(e,r);var s=No.size(this.messageBox.$buttons,{exact:!0});this.messageBox.$content.css("height","calc(100% - "+s.height+"px)"),wf.update(this.messageBox.$content),e.cssPosition(aP.positionContainerInWindow(e))}}])&&wz(t.prototype,n),i&&wz(t,i),o}(zo);function Pz(e){return(Pz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rz(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xz(e,t){return(xz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ez(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Fz(e);if(t){var r=Fz(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Dz(this,n)}}function Dz(e,t){return!t||"object"!==Pz(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fz(e){return(Fz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Az=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xz(e,t)}(o,e);var t,n,i,r=Ez(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.C],t.ctrl=!0,t.preventDefault=!1,t.renderingHints.render=!0,t.renderingHints.$drawingArea=function(t,n){return e.$container},t}return t=o,(n=[{key:"handle",value:function(e){this.field.copy()}}])&&Rz(t.prototype,n),i&&Rz(t,i),o}($u);function $z(e){return($z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jz(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Mz(e,t,n){return(Mz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Nz(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Iz(e,t){return(Iz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Nz(e);if(t){var r=Nz(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Bz(this,n)}}function Bz(e,t){return!t||"object"!==$z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nz(e){return(Nz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iz(e,t)}(o,e);var t,n,i,r=Lz(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).accordion=null,e.eventDelegator=null,e._addWidgetProperties(["accordion"]),e}return t=o,(n=[{key:"_init",value:function(e){Mz(Nz(o.prototype),"_init",this).call(this,e),this._setAccordion(this.accordion)}},{key:"_createLoadingSupport",value:function(){return null}},{key:"_render",value:function(){this.addContainer(this.$parent,"accordion-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.accordion&&this._renderAccordion()}},{key:"_renderProperties",value:function(){Mz(Nz(o.prototype),"_renderProperties",this).call(this),this._renderDropType()}},{key:"setAccordion",value:function(e){this.setProperty("accordion",e)}},{key:"_setAccordion",value:function(e){this.accordion&&this.eventDelegator&&(this.eventDelegator.destroy(),this.eventDelegator=null),this._setProperty("accordion",e),e&&(this.eventDelegator=at.create(this,e,{delegateProperties:["loading"]}),e.setLoading(this.loading),e.setScrollTop(this.scrollTop))}},{key:"_renderAccordion",value:function(){this.accordion&&(this.accordion.render(),this.addField(this.accordion.$container),this.invalidateLayoutTree())}},{key:"_removeAccordion",value:function(){this.accordion&&(this.accordion.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"getFocusableElement",value:function(){return this.accordion?this.accordion.getFocusableElement():null}},{key:"getDelegateScrollable",value:function(){return this.accordion}}])&&jz(t.prototype,n),i&&jz(t,i),o}(GH);function Vz(e){return(Vz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wz(e,t){return(Wz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Uz(e);if(t){var r=Uz(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gz(this,n)}}function Gz(e,t){return!t||"object"!==Vz(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uz(e){return(Uz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wz(e,t)}(n,e);var t=zz(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function qz(e){return(qz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yz(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xz(e,t,n){return(Xz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eG(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Jz(e,t){return(Jz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=eG(e);if(t){var r=eG(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Qz(this,n)}}function Qz(e,t){return!t||"object"!==qz(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eG(e){return(eG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jz(e,t)}(o,e);var t,n,i,r=Zz(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).preventInitialFocus=!0,e}return t=o,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"bean-field"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus()}},{key:"_renderProperties",value:function(){Xz(eG(o.prototype),"_renderProperties",this).call(this),this._renderValue()}},{key:"_initKeyStrokeContext",value:function(){Xz(eG(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new CH(this,this._onAppLinkAction))}},{key:"_formatValue",value:function(e){return this.displayText}},{key:"_parseValue",value:function(e){return this.value}},{key:"_readDisplayText",value:function(){return this.displayText}},{key:"_renderDisplayText",value:function(){}},{key:"_renderValue",value:function(){}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}}])&&Yz(t.prototype,n),i&&Yz(t,i),o}(GV);function nG(e){return(nG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rG(e,t,n){return(rG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uG(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function oG(e,t){return(oG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=uG(e);if(t){var r=uG(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return aG(this,n)}}function aG(e,t){return!t||"object"!==nG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uG(e){return(uG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oG(e,t)}(o,e);var t,n,i,r=sG(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):rG(uG(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&iG(t.prototype,n),i&&iG(t,i),o}(QV);function cG(e){return(cG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hG(e,t,n){return(hG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vG(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function dG(e,t){return(dG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=vG(e);if(t){var r=vG(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return yG(this,n)}}function yG(e,t){return!t||"object"!==cG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vG(e){return(vG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dG(e,t)}(o,e);var t,n,i,r=pG(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).autoCloseExternalWindow=!1,e.externalWindowButtonText=null,e.externalWindowFieldText=null,e.location=null,e.trackLocation=!1,e.sandboxEnabled=!0,e.sandboxPermissions=null,e.scrollBarEnabled=!0,e.showInExternalWindow=!1,e._messageListener=null,e._popupWindow=null,e._externalWindowTextField=null,e._externalWindowButton=null,e}return t=o,(n=[{key:"_init",value:function(e){hG(vG(o.prototype),"_init",this).call(this,e),this.iframe=O.create("IFrame",{parent:this,location:this.location,sandboxEnabled:this.sandboxEnabled,sandboxPermissions:this.sandboxPermissions,scrollBarEnabled:this.scrollBarEnabled,trackLocation:this.trackLocation}),this.iframe.on("propertyChange",this._onIFramePropertyChange.bind(this))}},{key:"_render",value:function(){this.addContainer(this.$parent,"browser-field",new AG(this)),this.addLabel(),this.addStatus(),this.showInExternalWindow?(this.addField(this.$parent.makeDiv()),this._externalWindowTextField=this.$field.appendDiv().addClass("alt"),this._externalWindowButton=this.$field.appendDiv().addClass("button").on("click",this._openPopupWindow.bind(this))):(this.iframe.render(),this.addFieldContainer(this.iframe.$container),this.addField(this.iframe.$iframe),this.$field.on("load",this._onLoad.bind(this))),this.myWindow=this.$parent.window(!0),this._messageListener=this._onMessage.bind(this),this.myWindow.addEventListener("message",this._messageListener),this.enabledComputed&&setTimeout(this._openPopupWindow.bind(this,!0),20)}},{key:"_renderProperties",value:function(){hG(vG(o.prototype),"_renderProperties",this).call(this),this._renderExternalWindowButtonText(),this._renderExternalWindowFieldText()}},{key:"_remove",value:function(){hG(vG(o.prototype),"_remove",this).call(this),this.myWindow.removeEventListener("message",this._messageListener),this._messageListener=null,this.showInExternalWindow&&this.autoCloseExternalWindow&&this._popupWindow&&!this._popupWindow.closed&&this._popupWindow.close()}},{key:"setLocation",value:function(e){this.setProperty("location",e),this.iframe.setLocation(e)}},{key:"_renderLocation",value:function(){var e=this.location||"about:blank";this.showInExternalWindow&&this._popupWindow&&!this._popupWindow.closed&&(this._popupWindow.location=e)}},{key:"setAutoCloseExternalWindow",value:function(e){this.setProperty("autoCloseExternalWindow",e)}},{key:"setExternalWindowButtonText",value:function(e){this.setProperty("externalWindowButtonText",e)}},{key:"_renderExternalWindowButtonText",value:function(){this.showInExternalWindow&&this._externalWindowButton.text(this.externalWindowButtonText||"")}},{key:"setExternalWindowFieldText",value:function(e){this.setProperty("externalWindowFieldText",e)}},{key:"_renderExternalWindowFieldText",value:function(){this.showInExternalWindow&&this._externalWindowTextField.text(this.externalWindowFieldText||"")}},{key:"_calcPopupBounds",value:function(){var e=this.$container.window(!0),t=new Fo(e.screenX,e.screenY,s()(e).width(),s()(e).height()+55),n=new Fo(this.$field.offset().left,this.$field.offset().top,this.$field.width(),this.$field.height()),i=t.x+n.x,r=t.y+n.y+55,o=n.width,a=n.height+38,u=r+a,l=t.y+t.height;return u>l&&(a-=u-l+38),new Fo(Gn.round(i),Gn.round(r),Gn.round(o),Gn.round(a))}},{key:"_openPopupWindow",value:function(e){if(e=O.nvl(e,!0),this.showInExternalWindow)if(!this._popupWindow||e&&this._popupWindow.closed){var t=new jue(this.session),n=this._calcPopupBounds(),i=En.join(",","directories=no","location=no","menubar=no","resizable=yes","status=no","scrollbars="+(this.scrollBarEnabled?"yes":"no"),"toolbar=no","dependent=yes","left="+n.x,"top="+n.y,"width="+n.width,"height="+n.height),r=this.location||"about:blank";t.openWindow(r,void 0,i,this._popupWindowOpen.bind(this))}else e&&this._popupWindow.focus()}},{key:"_popupWindowOpen",value:function(e){if(this._popupWindow=e,this._popupWindow&&!this._popupWindow.closed){this.trigger("externalWindowStateChange",{windowState:o.WindowStates.WINDOW_OPEN});var t=window.setInterval(function(){var e=!1;try{e=null===this._popupWindow||this._popupWindow.closed}catch(e){return void(s.a.log.isInfoEnabled()&&s.a.log.info("Reading the property popupWindow.closed threw an error (Retry in 500ms)"))}e&&(window.clearInterval(t),this.trigger("externalWindowStateChange",{windowState:o.WindowStates.WINDOW_CLOSED}))}.bind(this),500)}}},{key:"_onMessage",value:function(e){e.source===this.$field[0].contentWindow?(s.a.log.isDebugEnabled()&&s.a.log.debug("received post-message data="+e.data+" origin="+e.origin),this.trigger("message",{data:e.data,origin:e.origin})):s.a.log.isTraceEnabled()&&s.a.log.trace("skipped post-message, because different source. data="+e.data+" origin="+e.origin)}},{key:"setTrackLocation",value:function(e){this.setProperty("trackLocation",e),this.iframe.setTrackLocation(e)}},{key:"_onIFramePropertyChange",value:function(e){this.trackLocation&&"location"===e.propertyName&&this._setProperty("location",e.newValue)}},{key:"_onLoad",value:function(e){this.rendered&&this.invalidateLayoutTree()}},{key:"setSandboxEnabled",value:function(e){this.setProperty("sandboxEnabled",e),this.iframe.setSandboxEnabled(e)}},{key:"setSandboxPermissions",value:function(e){this.setProperty("sandboxPermissions",e),this.iframe.setSandboxPermissions(e)}},{key:"setScrollBarEnabled",value:function(e){this.setProperty("scrollBarEnabled",e),this.iframe.setScrollBarEnabled(e)}}])&&fG(t.prototype,n),i&&fG(t,i),o}(GV);function gG(e){return(gG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _G(e,t,n){return(_G="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=OG(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function wG(e,t){return(wG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=OG(e);if(t){var r=OG(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return SG(this,n)}}function SG(e,t){return!t||"object"!==gG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OG(e){return(OG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(bG,"WindowStates",{WINDOW_OPEN:"true",WINDOW_CLOSED:"false"});var TG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wG(e,t)}(o,e);var t,n,i,r=kG(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["location"]),e}return t=o,(n=[{key:"_onWidgetMessage",value:function(e){this._send("postMessage",{data:e.data,origin:e.origin})}},{key:"_onWidgetExternalWindowStateChange",value:function(e){this._send("externalWindowStateChange",{windowState:e.windowState})}},{key:"_onWidgetEvent",value:function(e){"message"===e.type?this._onWidgetMessage(e):"externalWindowStateChange"===e.type?this._onWidgetExternalWindowStateChange(e):_G(OG(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e).sort(this._createPropertySortFunc(["scrollBarEnabled","location"]))}}])&&mG(t.prototype,n),i&&mG(t,i),o}(QV);function CG(e){return(CG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function RG(e,t,n){return(RG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FG(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function xG(e,t){return(xG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=FG(e);if(t){var r=FG(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return DG(this,n)}}function DG(e,t){return!t||"object"!==CG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FG(e){return(FG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var AG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xG(e,t)}(o,e);var t,n,i,r=EG(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).browserField=e,t}return t=o,(n=[{key:"preferredLayoutSize",value:function(e,t){var n=RG(FG(o.prototype),"preferredLayoutSize",this).call(this,e,t);return this._isIFrameReadable()&&(n.height=this.browserField.$field.contents().height()+this.browserField.iframe.htmlComp.insets().vertical()+this.browserField.htmlComp.insets().vertical()),n}},{key:"_isIFrameReadable",value:function(){var e=this.browserField,t=e.sandboxPermissions;if(e.sandboxEnabled&&t&&-1===t.indexOf("allow-same-origin"))return s.a.log.isWarnEnabled()&&s.a.log.warn('Access to IFrame denied, cannot read height. Reason: sandbox is enabled or "allow-same-origin" is not set'),!1;try{e.$field[0].contentWindow.document}catch(e){return s.a.log.isWarnEnabled()&&s.a.log.warn("Access to IFrame denied, cannot read height. Reason: denied by browser"),!1}return"loading"!==e.$field.contents().attr("readyState")||(s.a.log.isWarnEnabled()&&s.a.log.warn('Access to IFrame denied, cannot read height. Reason: readyState == "loading"'),!1)}}])&&PG(t.prototype,n),i&&PG(t,i),o}(sV);function $G(e){return($G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function MG(e,t,n){return(MG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HG(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function IG(e,t){return(IG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=HG(e);if(t){var r=HG(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return BG(this,n)}}function BG(e,t){return!t||"object"!==$G(t)&&"function"!=typeof t?NG(e):t}function NG(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HG(e){return(HG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VG(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var WG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IG(e,t)}(o,e);var t,n,i,r=LG(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).adaptedBy=null,e.defaultButton=!1,e.displayStyle=o.DisplayStyle.DEFAULT,e.gridDataHints.fillHorizontal=!1,e.iconId=null,e.keyStroke=null,e.keyStrokeScope=null,e.processButton=!0,e.selected=!1,e.statusVisible=!1,e.systemType=o.SystemType.NONE,e.preventDoubleClick=!1,e.stackable=!0,e.shrinkable=!1,e.$buttonLabel=null,e.buttonKeyStroke=new pU(NG(e),null),e._doubleClickSupport=new Lt,e._addCloneProperties(["defaultButton","displayStyle","iconId","keyStroke","processButton","selected","systemType","preventDoubleClick","stackable","shrinkable"]),e}return t=o,(n=[{key:"_init",value:function(e){MG(HG(o.prototype),"_init",this).call(this,e),this.resolveIconIds(["iconId"]),this._setKeyStroke(this.keyStroke),this._setKeyStrokeScope(this.keyStrokeScope),this._setInheritAccessibility(this.inheritAccessibility&&!this._isIgnoreAccessibilityFlags())}},{key:"_initKeyStrokeContext",value:function(){MG(HG(o.prototype),"_initKeyStrokeContext",this).call(this),this._initDefaultKeyStrokes(),this.formKeyStrokeContext=new Ou,this.formKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.formKeyStrokeContext.registerKeyStroke(this.buttonKeyStroke),this.formKeyStrokeContext.$bindTarget=function(){if(this.keyStrokeScope)return this.keyStrokeScope.$container;var e=this.getForm();return e?e.$container:this.session.desktop.$container}.bind(this)}},{key:"_isIgnoreAccessibilityFlags",value:function(){return this.systemType===o.SystemType.CANCEL||this.systemType===o.SystemType.CLOSE}},{key:"_initDefaultKeyStrokes",value:function(){this.keyStrokeContext.registerKeyStroke([new pU(this,"ENTER"),new pU(this,"SPACE")])}},{key:"_createLoadingSupport",value:function(){return new te({widget:this,$container:function(){return this.$field}.bind(this)})}},{key:"_render",value:function(){var e,t=this;if(this.displayStyle===o.DisplayStyle.LINK?(e=this.$parent.makeDiv("link-button"),this.$link=e.appendDiv("menu-item link"),this.$buttonLabel=this.$link.appendSpan("button-label text")):(e=this.$parent.makeElement("<button>").addClass("button"),this.$buttonLabel=e.appendSpan("button-label"),Mt.get().supportsOnlyTouch()&&e.setTabbable(!1)),this.addContainer(this.$parent,"button-field",new JG(this)),this.addField(e),this.addStatus(),e.on("mousedown",(function(e){return t._doubleClickSupport.mousedown(e)})).on("click",this._onClick.bind(this)).unfocusable(),this.menus&&this.menus.length>0&&(this.menus.forEach((function(e){this.keyStrokeContext.registerKeyStroke(e)}),this),this.label||!this.iconId)){var n=sn.parseIconId(o.SUBMENU_ICON);this.$submenuIcon=(this.$link||e).appendSpan("submenu-icon").text(n.iconCharacter)}this.session.keyStrokeManager.installKeyStrokeContext(this.formKeyStrokeContext),dh.installForEllipsis(this.$buttonLabel,{parent:this})}},{key:"_remove",value:function(){MG(HG(o.prototype),"_remove",this).call(this),dh.uninstall(this.$buttonLabel),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.formKeyStrokeContext),this.$submenuIcon=null}},{key:"_renderProperties",value:function(){MG(HG(o.prototype),"_renderProperties",this).call(this),this._renderIconId(),this._renderSelected(),this._renderDefaultButton()}},{key:"_renderForegroundColor",value:function(){MG(HG(o.prototype),"_renderForegroundColor",this).call(this),$i.legacyForegroundColor(this,this.$buttonLabel),$i.legacyForegroundColor(this,this.get$Icon()),$i.legacyForegroundColor(this,this.$submenuIcon)}},{key:"_renderBackgroundColor",value:function(){MG(HG(o.prototype),"_renderBackgroundColor",this).call(this),$i.legacyBackgroundColor(this,this.$fieldContainer)}},{key:"_renderFont",value:function(){MG(HG(o.prototype),"_renderFont",this).call(this),$i.legacyFont(this,this.$buttonLabel),this.invalidateLayoutTree()}},{key:"doAction",value:function(){return!(!this.enabledComputed||!this.visible||(this.displayStyle===o.DisplayStyle.TOGGLE?this.setSelected(!this.selected):this.menus.length>0&&this.togglePopup(),this._doAction(),0))}},{key:"_doAction",value:function(){this.trigger("click")}},{key:"togglePopup",value:function(){this.popup?this.popup.close():(this.popup=this._openPopup(),this.popup.one("destroy",function(e){this.popup=null}.bind(this)))}},{key:"_openPopup",value:function(){var e=O.create("ContextMenuPopup",{parent:this,menuItems:this.menus,cloneMenuItems:!1,closeOnAnchorMouseDown:!1,$anchor:this.$field});return e.open(),e}},{key:"_doActionTogglesSubMenu",value:function(){return!1}},{key:"setDefaultButton",value:function(e){this.setProperty("defaultButton",e)}},{key:"_renderDefaultButton",value:function(){this.$field.toggleClass("default",this.defaultButton)}},{key:"_renderEnabled",value:function(){MG(HG(o.prototype),"_renderEnabled",this).call(this),this.displayStyle===o.DisplayStyle.LINK&&(this.$link.setEnabled(this.enabledComputed),this.$field.setTabbable(this.enabledComputed&&!Mt.get().supportsOnlyTouch()))}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.displayStyle===o.DisplayStyle.TOGGLE&&this.$field.toggleClass("selected",this.selected)}},{key:"_renderLabel",value:function(){this.$buttonLabel.contentOrNbsp(this.labelHtmlEnabled,this.label,"empty"),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(){var e=this.$link||this.$fieldContainer;e.icon(this.iconId);var t=e.data("$icon");function n(e){t.removeClass("loading"),t.toggleClass("broken",!e),this.invalidateLayoutTree()}t&&(t.removeClass("loading broken"),t.is("img")&&(t.addClass("loading"),t.off("load error").on("load",n.bind(this,!0)).on("error",n.bind(this,!1))),this.rendered||$i.legacyForegroundColor(this,t)),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}},{key:"get$Icon",value:function(){return(this.$link||this.$fieldContainer).children(".icon")}},{key:"_updateLabelAndIconStyle",value:function(){var e=!!this.label;this.$buttonLabel.setVisible(e||!this.iconId),this.get$Icon().toggleClass("with-label",e)}},{key:"setKeyStroke",value:function(e){this.setProperty("keyStroke",e)}},{key:"_setKeyStroke",value:function(e){this._setProperty("keyStroke",e),this.buttonKeyStroke.parseAndSetKeyStroke(this.keyStroke)}},{key:"_setKeyStrokeScope",value:function(e){("string"!=typeof e||(e=this._resolveKeyStrokeScope(e)))&&this._setProperty("keyStrokeScope",e)}},{key:"_resolveKeyStrokeScope",value:function(e){var t=this.findNonWrappedForm();if(!t)throw new Error("Could not resolve keyStrokeScope "+e+" because no form has been found.");if(t.initialized){if(!(e=t.widget(e)))throw new Error("Could not resolve keyStrokeScope "+e+" using form "+t);return e}t.one("init",this._setKeyStrokeScope.bind(this,e))}},{key:"_onClick",value:function(e){1===e.which&&(this.preventDoubleClick&&this._doubleClickSupport.doubleClicked()||this.enabledComputed&&this.doAction())}},{key:"setStackable",value:function(e){this.setProperty("stackable",e)}},{key:"setShrinkable",value:function(e){this.setProperty("shrinkable",e)}},{key:"setPreventDoubleClick",value:function(e){this.setProperty("preventDoubleClick",e)}},{key:"getFocusableElement",value:function(){return this.adaptedBy?this.adaptedBy.getFocusableElement():MG(HG(o.prototype),"getFocusableElement",this).call(this)}},{key:"isFocusable",value:function(){return this.adaptedBy?this.adaptedBy.isFocusable():MG(HG(o.prototype),"isFocusable",this).call(this)}},{key:"focus",value:function(){return this.adaptedBy?this.adaptedBy.focus():MG(HG(o.prototype),"focus",this).call(this)}}])&&jG(t.prototype,n),i&&jG(t,i),o}(GH);function zG(e){return(zG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function UG(e,t,n){return(UG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=XG(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function KG(e,t){return(KG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=XG(e);if(t){var r=XG(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return YG(this,n)}}function YG(e,t){return!t||"object"!==zG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XG(e){return(XG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}VG(WG,"SystemType",{NONE:0,CANCEL:1,CLOSE:2,OK:3,RESET:4,SAVE:5,SAVE_WITHOUT_MARKER_CHANGE:6}),VG(WG,"DisplayStyle",{DEFAULT:0,TOGGLE:1,RADIO:2,LINK:3}),VG(WG,"SUBMENU_ICON",sn.ANGLE_DOWN_BOLD);var JG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KG(e,t)}(o,e);var t,n,i,r=qG(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).button=e,t}return t=o,(n=[{key:"layout",value:function(e){UG(XG(o.prototype),"layout",this).call(this,e);var t=this.button.get$Icon(),n=this.button.$submenuIcon,i=this.button.$buttonLabel,r=this.button.$fieldContainer;i.css("max-width","");var s=n?No.size(n,{includeMargin:!0,exact:!0}).width:0,a=t.length?No.size(t,{includeMargin:!0,exact:!0}).width:0,u=Math.ceil(r.width()-(s+a));i.css("max-width",u)}},{key:"preferredLayoutSize",value:function(e,t){var n=this.button.$buttonLabel,i=n.css("max-width");n.css("max-width","");var r=UG(XG(o.prototype),"preferredLayoutSize",this).call(this,e,t);return n.css("max-width",i),r}}])&&GG(t.prototype,n),i&&GG(t,i),o}(sV);function ZG(e){return(ZG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eU(e,t,n){return(eU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rU(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function tU(e,t){return(tU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=rU(e);if(t){var r=rU(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return iU(this,n)}}function iU(e,t){return!t||"object"!==ZG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rU(e){return(rU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var oU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tU(e,t)}(o,e);var t,n,i,r=nU(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["selected"]),e}return t=o,(n=[{key:"_onWidgetClick",value:function(e){this.widget.displayStyle===WG.DisplayStyle.TOGGLE||this.widget.menus.length>0||this._send("click")}},{key:"_onWidgetEvent",value:function(e){"click"===e.type?this._onWidgetClick(e):eU(rU(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&QG(t.prototype,n),i&&QG(t,i),o}(ZH);function sU(e){return(sU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function uU(e,t,n){return(uU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dU(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function lU(e,t){return(lU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=dU(e);if(t){var r=dU(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fU(this,n)}}function fU(e,t){return!t||"object"!==sU(t)&&"function"!=typeof t?hU(e):t}function hU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dU(e){return(dU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lU(e,t)}(o,e);var t,n,i,r=cU(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).field=e,n.parseAndSetKeyStroke(t),n.stopPropagation=!0,n.stopImmediatePropagation=!0,n.renderingHints.hAlign=Ni.RIGHT,n.renderingHints.$drawingArea=function(e,t){return this.field.$container}.bind(hU(n)),n}return t=o,(n=[{key:"_accept",value:function(e){return uU(dU(o.prototype),"_accept",this).call(this,e)&&this.field.$field.isAttached()}},{key:"handle",value:function(e){this.field.doAction()}}])&&aU(t.prototype,n),i&&aU(t,i),o}($u);function yU(e){return(yU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bU(e,t){return(bU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_U(e);if(t){var r=_U(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return mU(this,n)}}function mU(e,t){return!t||"object"!==yU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _U(e){return(_U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bU(e,t)}(o,e);var t,n,i,r=gU(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).gridDataHints.weightY=1,e._addWidgetProperties(["calendar"]),e}return t=o,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"calendar-field"),this.addLabel(),this.addStatus(),this.calendar&&(this.calendar.render(),this.addField(this.calendar.$container))}}])&&vU(t.prototype,n),i&&vU(t,i),o}(GH);function kU(e){return(kU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SU(e,t){return(SU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=CU(e);if(t){var r=CU(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return TU(this,n)}}function TU(e,t){return!t||"object"!==kU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CU(e){return(CU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SU(e,t)}(n,e);var t=OU(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function RU(e){return(RU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function EU(e,t){return(EU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=AU(e);if(t){var r=AU(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return FU(this,n)}}function FU(e,t){return!t||"object"!==RU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AU(e){return(AU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EU(e,t)}(o,e);var t,n,i,r=DU(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).gridDataHints.weightY=1,e._addWidgetProperties(["carousel"]),e}return t=o,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"carousel-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.carousel&&this._renderCarousel()}},{key:"_renderCarousel",value:function(){this.carousel.render(),this.addField(this.carousel.$container)}},{key:"_removeCarousel",value:function(){this.carousel.remove(),this._removeField()}}])&&xU(t.prototype,n),i&&xU(t,i),o}(GH);function jU(e){return(jU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function IU(e,t,n){return(IU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VU(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function LU(e,t){return(LU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=VU(e);if(t){var r=VU(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return NU(this,n)}}function NU(e,t){return!t||"object"!==jU(t)&&"function"!=typeof t?HU(e):t}function HU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VU(e){return(VU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var WU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LU(e,t)}(o,e);var t,n,i,r=BU(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).triStateEnabled=!1,e.wrapText=!1,e.keyStroke=null,e.checkBoxKeyStroke=new iK(HU(e)),e.$checkBox=null,e.$checkBoxLabel=null,e}return t=o,(n=[{key:"_init",value:function(e){IU(VU(o.prototype),"_init",this).call(this,e),this._setKeyStroke(this.keyStroke)}},{key:"_initKeyStrokeContext",value:function(){IU(VU(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new iK(this)),this.formKeyStrokeContext=new Ou,this.formKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.formKeyStrokeContext.registerKeyStroke(this.checkBoxKeyStroke),this.formKeyStrokeContext.$bindTarget=function(){var e=this.getForm();return e?e.$container:this.session.desktop.$container}.bind(this)}},{key:"_render",value:function(){this.addContainer(this.$parent,"check-box-field"),this.addLabel(),this.addMandatoryIndicator(),this.addFieldContainer(this.$parent.makeDiv()),this.$checkBox=this.$fieldContainer.appendDiv("check-box").on("mousedown",this._onMouseDown.bind(this)).data("valuefield",this),this.addField(this.$checkBox),this.$checkBoxLabel=this.$fieldContainer.appendDiv("label").on("mousedown",this._onMouseDown.bind(this)),gH.linkElementWithLabel(this.$checkBox,this.$checkBoxLabel),dh.installForEllipsis(this.$checkBoxLabel,{parent:this}),this.addStatus(),this.session.keyStrokeManager.installKeyStrokeContext(this.formKeyStrokeContext)}},{key:"_renderProperties",value:function(){IU(VU(o.prototype),"_renderProperties",this).call(this),this._renderValue(),this._renderWrapText()}},{key:"_remove",value:function(){dh.uninstall(this.$checkBoxLabel),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.formKeyStrokeContext),IU(VU(o.prototype),"_remove",this).call(this)}},{key:"_renderDisplayText",value:function(){}},{key:"setValue",value:function(e){this.setProperty("value",e)}},{key:"_renderValue",value:function(){this.$fieldContainer.toggleClass("checked",!0===this.value),this.$checkBox.toggleClass("checked",!0===this.value),this.$checkBox.toggleClass("undefined",this.triStateEnabled&&!0!==this.value&&!1!==this.value)}},{key:"_renderEnabled",value:function(){IU(VU(o.prototype),"_renderEnabled",this).call(this),this.$checkBox.setTabbable(this.enabledComputed&&!Mt.get().supportsOnlyTouch()).setEnabled(this.enabledComputed)}},{key:"setTriStateEnabled",value:function(e){this.setProperty("triStateEnabled",e),this.rendered&&this._renderValue()}},{key:"_renderLabel",value:function(){this.$checkBoxLabel.contentOrNbsp(this.labelHtmlEnabled,this.label,"empty"),this._renderEmptyLabel()}},{key:"_renderFont",value:function(){$i.legacyFont(this,this.$fieldContainer),this.invalidateLayoutTree()}},{key:"_renderForegroundColor",value:function(){$i.legacyForegroundColor(this,this.$fieldContainer)}},{key:"_renderBackgroundColor",value:function(){$i.legacyBackgroundColor(this,this.$fieldContainer)}},{key:"_renderGridData",value:function(){IU(VU(o.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_renderGridDataHints",value:function(){IU(VU(o.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"setKeyStroke",value:function(e){this.setProperty("keyStroke",e)}},{key:"_setKeyStroke",value:function(e){this._setProperty("keyStroke",e),this.checkBoxKeyStroke.parseAndSetKeyStroke(this.keyStroke)}},{key:"setWrapText",value:function(e){this.setProperty("wrapText",e)}},{key:"_renderWrapText",value:function(){this.$checkBoxLabel.toggleClass("white-space-nowrap",!this.wrapText),this.invalidateLayoutTree()}},{key:"acceptInput",value:function(e,t){}},{key:"toggleChecked",value:function(){this.enabledComputed&&(this.triStateEnabled?!1===this.value?this.setValue(!0):!0===this.value?this.setValue(null):this.setValue(!1):this.setValue(!this.value))}},{key:"prepareForCellEdit",value:function(e){IU(VU(o.prototype),"prepareForCellEdit",this).call(this,e),this.$checkBoxLabel.hide()}},{key:"_onMouseDown",value:function(e){if(this.enabledComputed){this.toggleChecked();var t=this.$checkBox.is(e.currentTarget),n=this.$checkBoxLabel.isOrHas(e.currentTarget);(t||n)&&this.focusAndPreventDefault(e)}}}])&&MU(t.prototype,n),i&&MU(t,i),o}(GV);function zU(e){return(zU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GU(e,t){return(GU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=qU(e);if(t){var r=qU(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return KU(this,n)}}function KU(e,t){return!t||"object"!==zU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qU(e){return(qU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var YU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GU(e,t)}(n,e);var t=UU(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["value"]),e}return n}(QV);function XU(e){return(XU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZU(e,t){return(ZU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=nK(e);if(t){var r=nK(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return eK(this,n)}}function eK(e,t){return!t||"object"!==XU(t)&&"function"!=typeof t?tK(e):t}function tK(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nK(e){return(nK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var iK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZU(e,t)}(o,e);var t,n,i,r=QU(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.SPACE],t.stopPropagation=!0,t.stopImmediatePropagation=!0,t.renderingHints.hAlign=Ni.LEFT,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(tK(t)),t}return t=o,(n=[{key:"handle",value:function(e){this.field.toggleChecked()}}])&&JU(t.prototype,n),i&&JU(t,i),o}($u);function rK(e){return(rK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oK(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sK(e,t,n){return(sK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cK(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function aK(e,t){return(aK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=cK(e);if(t){var r=cK(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return lK(this,n)}}function lK(e,t){return!t||"object"!==rK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cK(e){return(cK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aK(e,t)}(o,e);var t,n,i,r=uK(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).dropType=0,e.dropMaximumSize=Gt.DEFAULT_DROP_MAXIMUM_SIZE,e._fileUploadWaitRetryCountTimeout=99,e._fullSelectionLength=0,e}return t=o,(n=[{key:"_createKeyStrokeContext",value:function(){return new Fu}},{key:"_render",value:function(){this.addContainer(this.$parent,"clipboard-field"),this.addLabel(),this.addField(this.$parent.makeElement("<div>").addClass("input-field")),this.addStatus(),this.$field.disableSpellcheck().attr("contenteditable",!0).attr("tabindex","0").on("keydown",this._onKeyDown.bind(this)).on("input",this._onInput.bind(this)).on("paste",this._onPaste.bind(this)).on("copy",this._onCopy.bind(this)).on("cut",this._onCopy.bind(this))}},{key:"_renderProperties",value:function(){sK(cK(o.prototype),"_renderProperties",this).call(this),this._renderDropType()}},{key:"_createDragAndDropHandler",value:function(){return Gt.handler(this,{supportedScoutTypes:Gt.SCOUT_TYPES.FILE_TRANSFER,dropType:function(){return this.dropType}.bind(this),dropMaximumSize:function(){return this.maximumSize}.bind(this),allowedTypes:function(){return this.allowedMimeTypes}.bind(this)})}},{key:"_renderDisplayText",value:function(){var e,t=this.displayText;this.$field.children().each((function(t,n){e||"IMG"!==n.nodeName||(e=n)})),En.hasText(t)?(this.$field.html(En.nl2br(t,!0)),this._installScrollbars(),setTimeout(function(){this.$field.selectAllText();var e=this._getSelection();this._fullSelectionLength=e?e.toString().length:0}.bind(this))):this.$field.empty(),e&&this.$field.prepend(e)}},{key:"_readDisplayText",value:function(){return this.displayText}},{key:"_getSelection",value:function(){var e,t=this.$container.window(!0);return t.getSelection?e=t.getSelection():document.getSelection&&(e=document.getSelection()),e&&0!==e.toString().length?e:null}},{key:"_onKeyDown",value:function(e){return!O.isOneOf(e.which,o.ALWAYS_DESTRUCTIVE_KEYS)&&!!(e.ctrlKey||e.altKey||e.metaKey||O.isOneOf(e.which,o.NON_DESTRUCTIVE_KEYS))&&void 0}},{key:"_onInput",value:function(e){return this._renderDisplayText(),!1}},{key:"_onCopy",value:function(e){if(!Mt.get().isIos()||!1!==this._onIosCopy(e)){var t,n,i,r=this.$container.window(!0);try{e.originalEvent.clipboardData?i=e.originalEvent.clipboardData:r.clipboardData&&(i=r.clipboardData)}catch(e){s.a.log.error('Error while reading "clipboardData"',e)}if(!i)return s.a.log.error("Unable to access clipboard data."),!1;if(this._uninstallScrollbars(),t=this._getSelection()){n=t.toString().length===this._fullSelectionLength?this.displayText:t.toString();try{i.setData("text/plain",n)}catch(e){i.setData("Text",n)}return this._installScrollbars(),!1}}}},{key:"_onIosCopy",value:function(e){var t=this.$field.attr("style");return this.$field.css({color:"#000","background-color":"transparent"}),setTimeout(function(){this.$field.attrOrRemove("style",t)}.bind(this)),!1}},{key:"_onPaste",value:function(e){if(this.readOnly)return!1;var t,n=Date.now(),i=this.$container.window(!0);if(this.$field.selectAllText(),e.originalEvent.clipboardData)t=e.originalEvent.clipboardData;else{if(!i.clipboardData)throw new Error("Unable to access clipboard data.");t=i.clipboardData}var r=[],o={},a=0,u=0,l=t.getData("Text");l&&(window.Blob?(r.push(new Blob([l],{type:Bn.TEXT_PLAIN})),u++):(o["textTransferObject"+a++]=l,u++)),0===u&&t.items&&(Array.prototype.forEach.call(t.items,(function(e){if(e.type===Bn.TEXT_PLAIN)e.getAsString((function(e){r.push(new Blob([e],{type:Bn.TEXT_PLAIN})),u++}));else if(O.isOneOf(e.type,[Bn.IMAGE_PNG,Bn.IMAGE_JPG,Bn.IMAGE_JPEG,Bn.IMAGE_GIF])){var t=e.getAsFile();t&&(n-t.lastModified<1e3&&(t.scoutName=wo.EMPTY_UPLOAD_FILENAME),r.push(t),u++)}})),this._cleanupFiles(r));var c=0;0===u&&t.files&&Array.prototype.forEach.call(t.files,(function(e){var t=new FileReader;t.onload=function(t){var n=new Blob([t.target.result],{type:e.type});n.name=e.name,r.push(n),c--},t.onerror=function(t){c--,s.a.log.error("Error while reading file "+e.name+" / "+t.target.error.code)},c++,u++,t.readAsArrayBuffer(e)}));var f=0,h=function(){if(0===c||f++===this._fileUploadWaitRetryCountTimeout)if(f>=this._fileUploadWaitRetryCountTimeout){var e={entryPoint:this.$container.entryPoint(),header:this.session.text("ui.ClipboardTimeoutTitle"),body:this.session.text("ui.ClipboardTimeout"),yesButtonText:this.session.text("Ok")};this.session.showFatalMessage(e)}else(r.length>0||Object.keys(o).length>0)&&this.session.uploadFiles(this,r,o,this.maximumSize,this.allowedMimeTypes);else setTimeout(h,150)}.bind(this),d=function(){this._uninstallScrollbars();var e=this.$field.html();this.$field.html("");var t=function(){this.$field.html(e),this._installScrollbars()}.bind(this);setTimeout(function(){var e=!1;if(this.$field.children().each((function(t,n){if("IMG"===n.nodeName){var i=s()(n).attr("src"),o=/^data:(.*);base64,(.*)/.exec(i),a=o&&o[1];if(O.isOneOf(a,Bn.IMAGE_PNG,Bn.IMAGE_JPG,Bn.IMAGE_JPEG,Bn.IMAGE_GIF)){for(var u=window.atob(o[2]),l=[],c=0;c<u.length;c++)l[c]=u.charCodeAt(c);var f=new Uint8Array(l),h=new Blob([f],{type:a});h.name="",r.push(h),e=!0}}})),e)t();else{var n=this.$field.text();En.hasText(n)?(this.setDisplayText(n),r.push(new Blob([n],{type:Bn.TEXT_PLAIN}))):t()}h()}.bind(this),0)}.bind(this);return u>0?(h(),!1):(d(),!0)}},{key:"_cleanupFiles",value:function(e){var t,n;2===e.length&&(e.forEach((function(e){"image.png"===e.name&&e.scoutName?t=e:"image.jpeg"===e.name&&e.scoutName&&(n=e)})),t&&n&&et.remove(e,n))}}])&&oK(t.prototype,n),i&&oK(t,i),o}(GV);function dK(e){return(dK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pK(e,t){return(pK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=bK(e);if(t){var r=bK(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return vK(this,n)}}function vK(e,t){return!t||"object"!==dK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bK(e){return(bK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fK(hK,"NON_DESTRUCTIVE_KEYS",[pu.ESC,pu.ENTER,pu.TAB,pu.PAGE_UP,pu.PAGE_DOWN,pu.END,pu.HOME,pu.LEFT,pu.UP,pu.RIGHT,pu.DOWN,pu.F1,pu.F2,pu.F3,pu.F4,pu.F5,pu.F6,pu.F7,pu.F8,pu.F9,pu.F10,pu.F11,pu.F12]),fK(hK,"ALWAYS_DESTRUCTIVE_KEYS",[pu.BACKSPACE,pu.DELETE]);var gK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pK(e,t)}(n,e);var t=yK(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(QV);function mK(e){return(mK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _K(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wK(e,t){return(wK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=OK(e);if(t){var r=OK(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return SK(this,n)}}function SK(e,t){return!t||"object"!==mK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OK(e){return(OK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var TK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wK(e,t)}(o,e);var t,n,i,r=kK(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"color-field"),this.addLabel(),this.addField(this.$parent.makeDiv("not-implemented").text("not implemented yet")),this.addMandatoryIndicator(),this.addStatus()}}])&&_K(t.prototype,n),i&&_K(t,i),o}(GV);function CK(e){return(CK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PK(e,t){return(PK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=EK(e);if(t){var r=EK(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xK(this,n)}}function xK(e,t){return!t||"object"!==CK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function EK(e){return(EK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var DK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PK(e,t)}(n,e);var t=RK(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(QV);function FK(e){return(FK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AK(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $K(e,t,n){return($K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=LK(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function jK(e,t){return(jK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function MK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=LK(e);if(t){var r=LK(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return IK(this,n)}}function IK(e,t){return!t||"object"!==FK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function LK(e){return(LK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var BK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jK(e,t)}(o,e);var t,n,i,r=MK(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).popup=null,e.autoDate=null,e.dateDisplayText=null,e.dateHasText=!1,e.dateFocused=!1,e.dateFormatPattern=null,e.disabledCopyOverlay=!0,e.hasDate=!0,e.oldDisplayText=null,e.touchMode=!1,e.embedded=!1,e.hasTime=!1,e.hasTimePopup=!0,e.timeDisplayText=null,e.timeHasText=!1,e.timeDisplayText=null,e.timePickerResolution=30,e.timeFormatPattern=null,e.timeFocused=!1,e.$dateField=null,e.$timeField=null,e.$dateFieldIcon=null,e.$timeFieldIcon=null,e.$dateClearIcon=null,e.$timeClearIcon=null,e._$predictDateField=null,e._$predictTimeField=null,e._tempTimeDate=null,e.invalidValueMessageKey="ui.InvalidDate",e._addCloneProperties(["hasDate","hasTime","dateFormatPattern","timeFormatPattern","allowedDates","autoDate"]),e}return t=o,(n=[{key:"_createKeyStrokeContext",value:function(){return new Fu}},{key:"_init",value:function(e){$K(LK(o.prototype),"_init",this).call(this,e),gH.initTouch(this,e),this.popup=e.popup,this._setAutoDate(this.autoDate),this._setDisplayText(this.displayText),this._setAllowedDates(this.allowedDates),this._setTimePickerResolution(this.timePickerResolution)}},{key:"_initValue",value:function(e){this._setDateFormatPattern(this.dateFormatPattern),this._setTimeFormatPattern(this.timeFormatPattern),$K(LK(o.prototype),"_initValue",this).call(this,e)}},{key:"createDatePopup",value:function(){var e=this.touchMode?"DatePickerTouchPopup":"DatePickerPopup";return O.create(e,{parent:this,$anchor:this.$field,boundToAnchor:!this.touchMode,cssClass:this._errorStatusClass(),closeOnAnchorMouseDown:!1,field:this,allowedDates:this.allowedDates,dateFormat:this.isolatedDateFormat,displayText:this.dateDisplayText})}},{key:"createTimePopup",value:function(){var e=this.touchMode?"TimePickerTouchPopup":"TimePickerPopup";return O.create(e,{parent:this,$anchor:this.$timeField,boundToAnchor:!this.touchMode,cssClass:this._errorStatusClass(),closeOnAnchorMouseDown:!1,field:this,timeResolution:this.timePickerResolution})}},{key:"_render",value:function(){this.addContainer(this.$parent,"date-field"),this.addLabel(),this.addField(this.$parent.makeDiv("date-time-composite")),this.addStatus(this.$field),this.embedded||this.addMandatoryIndicator(),this.htmlDateTimeComposite=Uo.install(this.$field,this.session),this.htmlDateTimeComposite.setLayout(new tq(this))}},{key:"_renderProperties",value:function(){this._renderHasDate(),this._renderHasTime(),$K(LK(o.prototype),"_renderProperties",this).call(this),this._renderDateHasText(),this._renderTimeHasText()}},{key:"_remove",value:function(){$K(LK(o.prototype),"_remove",this).call(this),this.$dateField=null,this.$timeField=null,this.$dateFieldIcon=null,this.$timeFieldIcon=null,this.$dateClearIcon=null,this.$timeClearIcon=null,this._$predictDateField=null,this._$predictTimeField=null,this.popup=null}},{key:"setHasDate",value:function(e){this.setProperty("hasDate",e)}},{key:"_setHasDate",value:function(e){this._setProperty("hasDate",e),this.initialized&&this._updateDisplayTextProperty()}},{key:"_renderHasDate",value:function(){this.hasDate&&!this.$dateField?(this.$dateField=gH.makeInputOrDiv(this,"date").on("mousedown",this._onDateFieldMouseDown.bind(this)).appendTo(this.$field),this.$timeField&&this.$dateField.insertBefore(this.$timeField),this.touchMode||this.$dateField.on("keydown",this._onDateFieldKeyDown.bind(this)).on("input",this._onDateFieldInput.bind(this)).on("blur",this._onDateFieldBlur.bind(this)).on("focus",this._onDateFieldFocus.bind(this)),this._linkWithLabel(this.$dateField),Uo.install(this.$dateField,this.session),this.$dateFieldIcon=gH.appendIcon(this.$field,"date").on("mousedown",this._onDateIconMouseDown.bind(this)),this.$dateFieldIcon.addClass("needsclick")):!this.hasDate&&this.$dateField&&(this.$dateField.remove(),this.$dateField=null,this.$dateFieldIcon.remove(),this.$dateFieldIcon=null),this.rendering||(this._renderDisplayText(),this._renderFieldStyle(),this._renderEnabled(),this.htmlDateTimeComposite.invalidateLayoutTree()),this._renderDateClearable()}},{key:"setHasTime",value:function(e){this.setProperty("hasTime",e)}},{key:"_setHasTime",value:function(e){this._setProperty("hasTime",e),this.initialized&&this._updateDisplayTextProperty()}},{key:"_renderHasTime",value:function(){this.hasTime&&!this.$timeField?(this.$timeField=gH.makeInputOrDiv(this,"time").on("mousedown",this._onTimeFieldMouseDown.bind(this)).appendTo(this.$field),this.$dateField&&this.$timeField.insertAfter(this.$dateField),this.touchMode&&this.hasTimePopup||this.$timeField.on("keydown",this._onTimeFieldKeyDown.bind(this)).on("input",this._onTimeFieldInput.bind(this)).on("blur",this._onTimeFieldBlur.bind(this)).on("focus",this._onTimeFieldFocus.bind(this)),this._linkWithLabel(this.$timeField),Uo.install(this.$timeField,this.session),this.$timeFieldIcon=gH.appendIcon(this.$field,"time").on("mousedown",this._onTimeIconMouseDown.bind(this)),this.$timeFieldIcon.addClass("needsclick")):!this.hasTime&&this.$timeField&&(this.$timeField.remove(),this.$timeField=null,this.$timeFieldIcon.remove(),this.$timeFieldIcon=null),this.rendering||(this._renderDisplayText(),this._renderFieldStyle(),this._renderEnabled(),this.htmlDateTimeComposite.invalidateLayoutTree()),this._renderTimeClearable()}},{key:"setTimePickerResolution",value:function(e){this.setProperty("timePickerResolution",e)}},{key:"_setTimePickerResolution",value:function(e){e<1?(e=10,this.hasTimePopup=!1):this.hasTimePopup=!0,this._setProperty("timePickerResolution",e)}},{key:"_renderPlaceholder",value:function(e){$K(LK(o.prototype),"_renderPlaceholder",this).call(this,this._fieldForPlaceholder())}},{key:"_removePlaceholder",value:function(e){$K(LK(o.prototype),"_removePlaceholder",this).call(this,this._fieldForPlaceholder())}},{key:"_fieldForPlaceholder",value:function(){return this.hasDate?this.$dateField:this.hasTime?this.$timeField:null}},{key:"setDateFormatPattern",value:function(e){this.setProperty("dateFormatPattern",e)}},{key:"_setDateFormatPattern",value:function(e){e||(e=this.session.locale.dateFormatPatternDefault),this._setProperty("dateFormatPattern",e),this.isolatedDateFormat=new If(this.session.locale,this.dateFormatPattern),this.initialized&&this._updateDisplayText()}},{key:"setTimeFormatPattern",value:function(e){this.setProperty("timeFormatPattern",e)}},{key:"_setTimeFormatPattern",value:function(e){e||(e=this.session.locale.timeFormatPatternDefault),this._setProperty("timeFormatPattern",e),this.isolatedTimeFormat=new If(this.session.locale,this.timeFormatPattern),this.initialized&&this._updateDisplayText()}},{key:"_renderEnabled",value:function(){$K(LK(o.prototype),"_renderEnabled",this).call(this),this.$container.setEnabled(this.enabledComputed),this.$dateField&&this.$dateField.setEnabled(this.enabledComputed),this.$timeField&&this.$timeField.setEnabled(this.enabledComputed),Mt.get().isInternetExplorer()&&!this.enabledComputed&&this.closePopup()}},{key:"_renderDisplayText",value:function(){this.hasDate&&this._renderDateDisplayText(),this.hasTime&&this._renderTimeDisplayText(),this._removePredictionFields()}},{key:"_readDisplayText",value:function(){var e,t;return this.hasDate&&(e=this._readDateDisplayText()),this.hasTime&&(t=this._readTimeDisplayText()),this._computeDisplayText(e,t)}},{key:"_renderDateDisplayText",value:function(){gH.valOrText(this.$dateField,this.dateDisplayText),this._updateDateHasText()}},{key:"_readDateDisplayText",value:function(){return this._$predictDateField?gH.valOrText(this._$predictDateField):gH.valOrText(this.$dateField)}},{key:"_renderTimeDisplayText",value:function(){gH.valOrText(this.$timeField,this.timeDisplayText),this._updateTimeHasText()}},{key:"_readTimeDisplayText",value:function(){return this._$predictTimeField?gH.valOrText(this._$predictTimeField):gH.valOrText(this.$timeField)}},{key:"setDisplayText",value:function(e){this._setDisplayText(e),this.rendered&&this._renderDisplayText()}},{key:"_setDisplayText",value:function(e){this.oldDisplayText=this.displayText,this._setProperty("displayText",e);var t=this._splitDisplayText(e);this.hasDate&&(this.dateDisplayText=t.dateText),this.hasTime&&(this.timeDisplayText=t.timeText)}},{key:"_ensureValue",value:function(e){return wt.ensure(e)}},{key:"_validateValue",value:function(e){if(oi.isNullOrUndefined(e))return e;if(!(e instanceof Date))throw this.session.text(this.invalidValueMessageKey);return this.hasDate||this.value||(e=wt.combineDateTime(null,e)),e}},{key:"_valueEquals",value:function(e,t){return wt.equals(e,t)}},{key:"setAutoDate",value:function(e){this.setProperty("autoDate",e)}},{key:"_setAutoDate",value:function(e){e=wt.ensure(e),this._setProperty("autoDate",e)}},{key:"_setAllowedDates",value:function(e){Array.isArray(e)?(e=e.map((function(e){return wt.ensure(e)})),this._setProperty("allowedDates",e)):this._setProperty("allowedDates",null)}},{key:"_renderErrorStatus",value:function(){$K(LK(o.prototype),"_renderErrorStatus",this).call(this);var e=!!this.errorStatus,t=this._errorStatusClass();this.$dateField&&(this.$dateField.removeClass(GH.SEVERITY_CSS_CLASSES),this.$dateField.toggleClass(t,e),this._$predictDateField&&(this._$predictDateField.removeClass(GH.SEVERITY_CSS_CLASSES),this._$predictDateField.toggleClass(t,e))),this.$timeField&&(this.$timeField.removeClass(GH.SEVERITY_CSS_CLASSES),this.$timeField.toggleClass(t,e),this._$predictTimeField&&(this._$predictTimeField.removeClass(GH.SEVERITY_CSS_CLASSES),this._$predictTimeField.toggleClass(t,e))),this.popup&&(this.popup.$container.removeClass(GH.SEVERITY_CSS_CLASSES),this.popup.$container.toggleClass(t,e))}},{key:"_errorStatusClass",value:function(){return this.errorStatus?"has-"+this.errorStatus.cssClass():""}},{key:"_renderFont",value:function(){this.$dateField&&$i.legacyFont(this,this.$dateField),this.$timeField&&$i.legacyFont(this,this.$timeField)}},{key:"_renderForegroundColor",value:function(){this.$dateField&&$i.legacyForegroundColor(this,this.$dateField),this.$timeField&&$i.legacyForegroundColor(this,this.$timeField)}},{key:"_renderBackgroundColor",value:function(){this.$dateField&&$i.legacyBackgroundColor(this,this.$dateField),this.$timeField&&$i.legacyBackgroundColor(this,this.$timeField)}},{key:"activate",value:function(){this.enabledComputed&&this.rendered&&(this.$dateField?(this.$dateField.focus(),this._onDateFieldMouseDown()):this.$timeField&&(this.$timeField.focus(),this._onTimeFieldMouseDown()))}},{key:"getFocusableElement",value:function(){return this.$dateField?this.$dateField:this.$timeField?this.$timeField:null}},{key:"_onDateFieldMouseDown",value:function(){gH.handleOnClick(this)&&this.openDatePopupAndSelect(this.value)}},{key:"_onTimeFieldMouseDown",value:function(){gH.handleOnClick(this)&&this.openTimePopupAndSelect(this.value)}},{key:"setDateFocused",value:function(e){this.setProperty("dateFocused",e)}},{key:"_renderDateFocused",value:function(){this.$container.toggleClass("date-focused",this.dateFocused)}},{key:"_updateTimeHasText",value:function(){this.setTimeHasText(En.hasText(this._readTimeDisplayText()))}},{key:"setTimeHasText",value:function(e){this.setProperty("timeHasText",e)}},{key:"_renderTimeHasText",value:function(){this.$timeField&&this.$timeField.toggleClass("has-text",this.timeHasText),this.$container.toggleClass("time-has-text",this.timeHasText)}},{key:"_updateDateHasText",value:function(){this.setDateHasText(En.hasText(this._readDateDisplayText()))}},{key:"setDateHasText",value:function(e){this.setProperty("dateHasText",e)}},{key:"_renderDateHasText",value:function(){this.$dateField&&this.$dateField.toggleClass("has-text",this.dateHasText),this.$container.toggleClass("date-has-text",this.dateHasText)}},{key:"clear",value:function(){this.hasDate&&this.hasTime?(this._clear(),this.dateFocused||this.timeFocused||this.acceptInput(),this._triggerClear()):$K(LK(o.prototype),"clear",this).call(this)}},{key:"_clear",value:function(){this._removePredictionFields(),this.hasDate&&!this.timeFocused&&(gH.valOrText(this.$dateField,""),this._setDateValid(!0),this._updateDateHasText()),this.hasTime&&!this.dateFocused&&(gH.valOrText(this.$timeField,""),this._setTimeValid(!0),this._updateTimeHasText())}},{key:"_onDateClearIconMouseDown",value:function(e){this.enabledComputed&&(this.$dateField.focus(),this.clear(),this.value?this.selectDate(this.value,!1):this.preselectDate(this._referenceDate(),!1),e.preventDefault())}},{key:"_onDateIconMouseDown",value:function(e){this.enabledComputed&&(this.$dateField.focus(),this.embedded||this.openDatePopupAndSelect(this.value))}},{key:"setTimeFocused",value:function(e){this.setProperty("timeFocused",e)}},{key:"_renderTimeFocused",value:function(){this.$container.toggleClass("time-focused",this.timeFocused)}},{key:"_renderClearable",value:function(){this._renderDateClearable(),this._renderTimeClearable(),this._updateClearableStyles()}},{key:"_renderDateClearable",value:function(){this.hasDate||this.isClearable()?this.$dateClearIcon||(this.$dateClearIcon=this.$field.appendSpan("icon date-clear unfocusable").on("mousedown",this._onDateClearIconMouseDown.bind(this)),this.$dateClearIcon.addClass("needsclick")):this.$dateClearIcon&&(this.$dateClearIcon.remove(),this.$dateClearIcon=null)}},{key:"_renderTimeClearable",value:function(){this.hasTime&&this.isClearable()&&!this.$timeClearIcon?(this.$timeClearIcon=this.$field.appendSpan("icon time-clear unfocusable").on("mousedown",this._onTimeClearIconMouseDown.bind(this)),this.$timeClearIcon.addClass("needsclick")):this.hasTime&&this.isClearable()||!this.$timeClearIcon||(this.$timeClearIcon.remove(),this.$timeClearIcon=null)}},{key:"_onTimeClearIconMouseDown",value:function(e){this.enabledComputed&&(this.$timeField.focus(),this.clear(),this.value?this.selectTime(this.value,!1):this.preselectTime(this._referenceDate(),!1),e.preventDefault())}},{key:"_onTimeIconMouseDown",value:function(e){this.enabledComputed&&(this.$timeField.focus(),this.embedded||this.openTimePopupAndSelect(this.value))}},{key:"_onDateFieldBlur",value:function(e){this.setFocused(!1),this.setDateFocused(!1),this.embedded||(this.popup instanceof Dy&&this.closePopup(),this.setDateFocused(!1),this.acceptDate(),this._removePredictionFields())}},{key:"_onDateFieldFocus",value:function(e){this.setFocused(!0),this.setDateFocused(!0)}},{key:"_onTimeFieldBlur",value:function(e){this._tempTimeDate=null,this.setFocused(!1),this.setTimeFocused(!1),this.embedded||(this.popup instanceof sL&&this.closePopup(),this._tempTimeDate=null,this.setTimeFocused(!1),this.acceptTime(),this._removePredictionFields())}},{key:"_onTimeFieldFocus",value:function(){this.setFocused(!0),this.setTimeFocused(!0)}},{key:"_onDateFieldKeyDown",value:function(e){var t=0,n=0,i=0,r=0,o=this.$dateField[0].selectionStart,a=gH.valOrText(this.$dateField),u=this._$predictDateField&&gH.valOrText(this._$predictDateField),l=(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.altKey?1:0)+(e.metaKey?1:0),c=this.value||this._referenceDate(),f=!0;if(this.hasTime&&this.mode===GH.Mode.CELLEDITOR&&e.which===pu.TAB&&0===l)e.stopPropagation();else if(e.which!==pu.TAB&&e.which!==pu.SHIFT&&e.which!==pu.HOME&&e.which!==pu.END&&e.which!==pu.CTRL&&e.which!==pu.ALT)if(e.which!==pu.ENTER)if(e.which!==pu.ESC)if(e.which!==pu.RIGHT||o!==a.length){if((e.which===pu.UP||e.which===pu.DOWN||e.which===pu.PAGE_UP||e.which===pu.PAGE_DOWN)&&a&&!this._isDateValid()){var h=this.isolatedDateFormat.parse(a,c);h&&(c=h,this._setDateValid(!0))}if(e.which===pu.PAGE_UP||e.which===pu.PAGE_DOWN)return a&&this._isDateValid()?this.popup||this.openDatePopupAndSelect(c):(c=this._referenceDate(),this.hasTime&&(c=wt.combineDateTime(c,this.value||this._referenceDate())),this.openDatePopupAndSelect(c),this._updateDisplayText(c),this._setDateValid(!0),f=!1),f&&(i=e.which===pu.PAGE_UP?-1:1,this.shiftSelectedDate(0,i,0),this._updateDisplayText(this.getDatePicker().selectedDate)),void s.a.suppressEvent(e);if(e.which===pu.UP||e.which===pu.DOWN){if(t=e.which===pu.UP?-1:1,(e.ctrlKey||e.metaKey)&&1===l)n=t;else if(e.shiftKey&&1===l)i=t;else{if(0!==l)return void s.a.suppressEvent(e);r=t}a&&this._isDateValid()?this.popup||this.openDatePopupAndSelect(c):(c=this._referenceDate(),this.hasTime&&(c=wt.combineDateTime(c,this.value||this._referenceDate())),this.openDatePopupAndSelect(c),this._updateDisplayText(c),this._setDateValid(!0),f=!1),f&&(this.shiftSelectedDate(n,i,r),this._updateDisplayText(this.getDatePicker().selectedDate)),s.a.suppressEvent(e)}}else u&&this._setDateDisplayText(u.substring(0,a.length+1));else this.popup&&(this.closePopup(),s.a.suppressEvent(e));else(this.popup||this._$predictDateField)&&(this.acceptDate(),this.closePopup(),s.a.suppressEvent(e))}},{key:"_onDateFieldInput",value:function(e){var t=gH.valOrText(this.$dateField);if(this.$dateField[0]===this.$dateField.activeElement(!0)){this._$predictDateField||(this._$predictDateField=this._createPredictionField(this.$dateField));var n=this._predictDate(t);n?(gH.valOrText(this._$predictDateField,n.text),this.openDatePopupAndSelect(n.date)):this._removePredictionFields(),this._updateDateHasText(),setTimeout(function(){this._$predictDateField&&this._$predictDateField.setVisible(0===this.$dateField.scrollLeft())}.bind(this),50)}}},{key:"acceptInput",value:function(){var e=O.nvl(this._readDisplayText(),""),t=this._checkDisplayTextChanged(e);if(t)this.parseAndSetValue(e);else{var n=this.value;this.parseAndSetValue(e),wt.equals(this.value,n)||(t=!0)}t&&this._triggerAcceptInput()}},{key:"acceptDate",value:function(){this.hasTime&&!this.errorStatus&&En.empty(this.$dateField.val())&&this.$timeField.val(""),this.acceptInput()}},{key:"acceptTime",value:function(){this.hasDate&&!this.errorStatus&&En.empty(this.$timeField.val())&&this.$dateField.val(""),this.acceptInput()}},{key:"acceptDateTime",value:function(e,t){e?this.acceptDate():t&&this.acceptTime()}},{key:"_onTimeFieldKeyDown",value:function(e){var t=0,n=0,i=0,r=0,o=this.$timeField[0].selectionStart,a=this.$timeField.val(),u=this._$predictTimeField&&this._$predictTimeField.val(),l=(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.altKey?1:0)+(e.metaKey?1:0),c=this.value||this._referenceDate(),f=!0;if(this.hasDate&&this.mode===GH.Mode.CELLEDITOR&&e.which===pu.TAB&&e.shiftKey&&1===l)e.stopPropagation();else if(e.which!==pu.TAB&&e.which!==pu.SHIFT&&e.which!==pu.HOME&&e.which!==pu.END&&e.which!==pu.CTRL&&e.which!==pu.ALT)if(e.which!==pu.ENTER)if(e.which!==pu.ESC)if(e.which!==pu.RIGHT||o!==a.length){if(e.which===pu.UP||e.which===pu.DOWN){if(t=e.which===pu.UP?-1:1,e.ctrlKey&&1===l)r=t;else if(e.shiftKey&&1===l)n=t;else{if(0!==l)return void s.a.suppressEvent(e);i=t}if(this.hasTimePopup)a&&this._isTimeValid()?this.popup||this.openTimePopupAndSelect(c):(c=this._referenceDate(),this.openTimePopupAndSelect(c),this._updateDisplayText(c),this._setTimeValid(!0),f=!1),f&&(this.shiftSelectedTime(n,i,r),this._updateDisplayText(this.getTimePicker().selectedTime)),s.a.suppressEvent(e);else{if(!this._tempTimeDate){var h=this._predictTime(a);h&&h.date?this._tempTimeDate=h.date:(this._tempTimeDate=this._referenceDate(),f=!1)}f&&(this._tempTimeDate=wt.shiftTime(this._tempTimeDate,n,i,r)),this.hasDate&&(this._tempTimeDate=wt.combineDateTime(this.value||this._referenceDate(),this._tempTimeDate)),this._updateDisplayText(this._tempTimeDate),this._setTimeValid(!0),s.a.suppressEvent(e)}}}else u&&this._setTimeDisplayText(u.substring(0,a.length+1));else this.popup&&(this.closePopup(),s.a.suppressEvent(e));else(this.popup||this._$predictDateField)&&(this._tempTimeDate=null,this.acceptTime(),this.closePopup(),s.a.suppressEvent(e))}},{key:"_onTimeFieldInput",value:function(e){var t=this.$timeField.val();if(this.$timeField[0]===this.$timeField.activeElement(!0)){this._$predictTimeField||(this._$predictTimeField=this._createPredictionField(this.$timeField));var n=this._predictTime(t);n?(this._$predictTimeField.val(n.text),this.openTimePopupAndSelect(n.date)):(this._tempTimeDate=null,this._removePredictionFields()),this._updateTimeHasText(),setTimeout(function(){this._$predictTimeField&&this._$predictTimeField.setVisible(0===this.$timeField.scrollLeft())}.bind(this),50)}}},{key:"_onDatePickerDateSelect",value:function(e){this._setDateValid(!0),this._setTimeValid(!0);var t=this._newTimestampAsDate(e.date,this.value);this.setValue(t),this.closePopup(),this._triggerAcceptInput()}},{key:"_onTimePickerTimeSelect",value:function(e){this._setDateValid(!0),this._setTimeValid(!0);var t=this._newTimestampAsDate(this.value,e.time);this.setValue(t),this.closePopup(),this._triggerAcceptInput()}},{key:"_createPredictionField",value:function(e){var t=e.clone().addClass("predict").attr("tabIndex","-1").insertBefore(e);return e.hasClass("has-error")&&t.addClass("has-error"),t}},{key:"_removePredictionFields",value:function(){this._$predictDateField&&(this._$predictDateField.remove(),this._$predictDateField=null),this._$predictTimeField&&(this._$predictTimeField.remove(),this._$predictTimeField=null)}},{key:"_setDateDisplayText",value:function(e){this.dateDisplayText=e,this._updateDisplayTextProperty(),this.rendered&&this._renderDateDisplayText()}},{key:"_setTimeDisplayText",value:function(e){this.timeDisplayText=e,this._updateDisplayTextProperty(),this.rendered&&this._renderTimeDisplayText()}},{key:"_computeDisplayText",value:function(e,t){var n=e||"",i=t||"",r=(this.hasDate?n:"")+(this.hasDate&&this.hasTime?"\n":"")+(this.hasTime?i:"");return"\n"===r&&(r=""),r}},{key:"_splitDisplayText",value:function(e){var t="",n="";if(En.hasText(e)){var i=e.split("\n");t=this.hasDate?i[0]:"",n=this.hasTime?this.hasDate?i[1]:i[0]:""}return{dateText:t,timeText:n}}},{key:"_updateDisplayTextProperty",value:function(){this._setProperty("displayText",this._computeDisplayText(this.dateDisplayText,this.timeDisplayText))}},{key:"aboutToBlurByMouseDown",value:function(e){var t,n,i,r,o=!!this.$dateField&&(this.$dateField.isOrHas(e)||this.$dateFieldIcon.isOrHas(e)||this.$dateClearIcon&&this.$dateClearIcon.isOrHas(e)),s=!!this.$timeField&&(this.$timeField.isOrHas(e)||this.$timeFieldIcon.isOrHas(e)||this.$timeClearIcon&&this.$timeClearIcon.isOrHas(e)),a=this.popup&&this.popup.$container.isOrHas(e),u=this.fieldStatus&&this.fieldStatus.$container.isOrHas(e),l=this.getDatePicker(),c=this.getTimePicker();if(!(o||s||a||u))return t=Cc.isActiveElement(this.$dateField),n=Cc.isActiveElement(this.$timeField),void this.acceptDateTime(t,n);this.embedded&&(i=l&&l.$container.isOrHas(e),r=c&&c.$container.isOrHas(e),i&&r&&this.acceptTime())}},{key:"_newTimestampAsDate",value:function(e,t){var n=null;return(e||t)&&(n=this.value||this._referenceDate(),e&&(n=wt.combineDateTime(e,n)),t&&(n=wt.combineDateTime(n,t))),n}},{key:"_referenceDate",value:function(){var e=this.autoDate||wt.ceil(wt.newDate(),this.timePickerResolution);return e=this.autoDate?this.autoDate:this.hasTime?wt.ceil(wt.newDate(),this.timePickerResolution):wt.trunc(wt.newDate()),this.allowedDates&&(e=this._findAllowedReferenceDate(e)),e}},{key:"_findAllowedReferenceDate",value:function(e){var t,n;for(t=0;t<this.allowedDates.length;t++)if(n=this.allowedDates[t],wt.compare(n,e)>=0)return n;for(t=this.allowedDates.length-1;t>=0;t--)if(n=this.allowedDates[t],wt.compare(n,e)<=0)return n;return e}},{key:"openDatePopup",value:function(e){this.popup||(this.popup=this.createDatePopup(),this.popup.open(),this.$dateField.addClass("focused"),this.popup.on("remove",function(e){this._onPopupRemove(e),this.popup=null,this.$dateField.removeClass("focused")}.bind(this)),this.getDatePicker().on("dateSelect",this._onDatePickerDateSelect.bind(this)))}},{key:"closePopup",value:function(){this.popup&&this.popup.close()}},{key:"toggleDatePopup",value:function(){s.a.log.isInfoEnabled()&&s.a.log.info("(DateField#toggleDatePopup) popupOpen=",!!this.popup),this.popup?this.closePopup():this.openDatePopupAndSelect(this.value)}},{key:"openTimePopup",value:function(e){this.hasTimePopup&&!this.popup&&(this.popup=this.createTimePopup(),this.popup.open(),this.$timeField.addClass("focused"),this.popup.on("remove",function(e){this._onPopupRemove(e),this.popup=null,this.$timeField.removeClass("focused")}.bind(this)),this.getTimePicker().on("timeSelect",this._onTimePickerTimeSelect.bind(this)))}},{key:"toggleTimePopup",value:function(){s.a.log.isInfoEnabled()&&s.a.log.info("(DateField#toggleTimePopup) popupOpen=",!!this.popup),this.popup?this.closePopup():this.openTimePopupAndSelect(this.value)}},{key:"_parseValue",value:function(e){var t=this._splitDisplayText(e),n=t.dateText,i={},r=t.timeText,o={},s=!0;if(this.hasDate&&((i=this._predictDate(n))||(s=!1),this._setDateDisplayText(n)),this.hasTime&&((o=this._predictTime(r))||(s=!1),this._setTimeDisplayText(r)),!s)throw this.errorStatus;return i.date||o.date?this._newTimestampAsDate(i.date,o.date):null}},{key:"_predictDate",value:function(e){var t=(e=e||"").match(/^([+-])(\d*)$/);if(t){var n=wt.newDate(),i=Number(t[1]+(t[2]||"0"));return n.setDate(n.getDate()+i),isNaN(n.valueOf())||n.getDate()<0?(this._setDateValid(!1),null):(this._setDateValid(!0),{date:n,text:e})}var r=this._analyzeInputAsDate(e,this.value||this._referenceDate());if(r.error)return this._setDateValid(!1),null;if(!r.predictedDate)return this._setDateValid(!0),{date:null,text:""};var o=r.predictedDate,s=new If(this.isolatedDateFormat.locale,r.parsedPattern).format(o,!0);return(t=s.match(new RegExp("^"+En.quote(e)+"(.*)$","i")))&&(s=e+t[1]),this._setDateValid(!0),{date:o,text:s}}},{key:"_predictTime",value:function(e){e=e||"";var t=this._analyzeInputAsTime(e,this.value||this._referenceDate());if(t.error)return this._setTimeValid(!1),null;if(!t.predictedDate)return this._setTimeValid(!0),{date:null,text:""};var n=t.predictedDate,i=new If(this.isolatedTimeFormat.locale,t.parsedPattern).format(n,!0),r=i.match(new RegExp("^"+En.quote(e)+"(.*)$","i"));return r&&(i=e+r[1]),this._setTimeValid(!0),{date:n,text:i}}},{key:"_analyzeInputAsDate",value:function(e,t){return this.isolatedDateFormat.analyze(e,t)}},{key:"_analyzeInputAsTime",value:function(e,t){return this.isolatedTimeFormat.analyze(e,t)}},{key:"_setErrorStatusPart",value:function(e,t){if(t)this.setErrorStatus(null);else{var n=this.errorStatus;n||(n=this._createErrorStatus()),n[e]=!0,this.setErrorStatus(n)}}},{key:"_createErrorStatus",value:function(){return new pi({message:this.session.text("ui.InvalidDate"),severity:pi.Severity.ERROR,code:o.ErrorCode.PARSE_ERROR})}},{key:"_createInvalidValueStatus",value:function(e,t){var n=$K(LK(o.prototype),"_createInvalidValueStatus",this).call(this,e,t);return n.invalidDate=!0,n.invalidTime=!0,n}},{key:"_setDateValid",value:function(e){this._setErrorStatusPart("invalidDate",e)}},{key:"_setTimeValid",value:function(e){this._setErrorStatusPart("invalidTime",e)}},{key:"_isErrorStatusPartValid",value:function(e){return!this.errorStatus||!this.errorStatus[e]}},{key:"_isDateValid",value:function(){return this._isErrorStatusPartValid("invalidDate")}},{key:"_isTimeValid",value:function(){return this._isErrorStatusPartValid("invalidTime")}},{key:"onCellEditorRendered",value:function(e){e.openFieldPopup&&(this.hasDate&&!this.hasTime?this.openDatePopupAndSelect(this.value):!this.hasDate&&this.hasTime?this.openTimePopupAndSelect(this.value):Mt.get().supportsOnlyTouch()||this.openDatePopupAndSelect(this.value)),this.touchMode&&(this._cellEditorPopup=e.cellEditorPopup)}},{key:"_onPopupRemove",value:function(e){this.touchMode&&this._cellEditorPopup&&(this.hasDate&&this.hasTime||(this._cellEditorPopup.completeEdit(),this._cellEditorPopup=null))}},{key:"prepareForCellEdit",value:function(e){e=e||{},$K(LK(o.prototype),"prepareForCellEdit",this).call(this,e),this.$field.removeClass("cell-editor-field first last"),this.$dateField&&this.addCellEditorFieldCssClasses(this.$dateField,e),this.$timeField&&(this.$dateField||(e.cssClass=""),this.addCellEditorFieldCssClasses(this.$timeField,e))}},{key:"getDatePicker",value:function(){if(this.popup&&this.popup.getDatePicker)return this.popup.getDatePicker()}},{key:"openDatePopupAndSelect",value:function(e){this.openDatePopup(),e?this.selectDate(e,!1):this.preselectDate(this._referenceDate(),!1)}},{key:"preselectDate",value:function(e,t){var n=this.getDatePicker();n&&n.preselectDate(e,t)}},{key:"selectDate",value:function(e,t){var n=this.getDatePicker();n&&n.selectDate(e,t)}},{key:"getTimePicker",value:function(){if(this.popup&&this.popup.getTimePicker)return this.popup.getTimePicker()}},{key:"openTimePopupAndSelect",value:function(e){this.hasTimePopup&&(this.openTimePopup(),e?this.selectTime(e):this.preselectTime(this._referenceDate()))}},{key:"preselectTime",value:function(e){var t=this.getTimePicker();t&&t.preselectTime(e)}},{key:"selectTime",value:function(e){var t=this.getTimePicker();t&&t.selectTime(e)}},{key:"shiftSelectedDate",value:function(e,t,n){this.openDatePopup(),this.getDatePicker().shiftSelectedDate(e,t,n)}},{key:"shiftSelectedTime",value:function(e,t,n){this.openTimePopup(),this.getTimePicker().shiftSelectedTime(e,t,n)}},{key:"_formatValue",value:function(e){var t="",n="";return this.hasDate&&(e&&(t=this.isolatedDateFormat.format(e)),this.dateDisplayText=t),this.hasTime&&(e&&(n=this.isolatedTimeFormat.format(e)),this.timeDisplayText=n),this._computeDisplayText(this.dateDisplayText,this.timeDisplayText)}},{key:"_renderFieldStyle",value:function(){$K(LK(o.prototype),"_renderFieldStyle",this).call(this),this._renderFieldStyleInternal(this.$dateField),this._renderFieldStyleInternal(this.$timeField)}},{key:"_renderDisabledStyle",value:function(){$K(LK(o.prototype),"_renderDisabledStyle",this).call(this),this._renderDisabledStyleInternal(this.$dateField),this._renderDisabledStyleInternal(this.$timeField)}},{key:"_triggerAcceptInput",value:function(){var e={displayText:this.displayText,errorStatus:this.errorStatus,value:this.value};this.trigger("acceptInput",e)}}])&&AK(t.prototype,n),i&&AK(t,i),o}(GV);function NK(e){return(NK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HK(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function VK(e,t,n){return(VK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=UK(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function WK(e,t){return(WK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=UK(e);if(t){var r=UK(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return GK(this,n)}}function GK(e,t){return!t||"object"!==NK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function UK(e){return(UK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(BK,"ErrorCode",{PARSE_ERROR:-1});var KK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WK(e,t)}(o,e);var t,n,i,r=zK(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._errorStatus=null,e._errorStatusDisplayText=null,e}return t=o,(n=[{key:"_initProperties",value:function(e){VK(UK(o.prototype),"_initProperties",this).call(this,e),this._updateErrorStatus(e.errorStatus,e.displayText)}},{key:"_attachWidget",value:function(){VK(UK(o.prototype),"_attachWidget",this).call(this),this.widget.setValidator(function(e,t){var n=this.formatValue(e);if(this.modelAdapter._errorStatus&&n===this.modelAdapter._errorStatusDisplayText)throw this.modelAdapter._errorStatus;return t(e)}.bind(this.widget),!1)}},{key:"_onWidgetAcceptInput",value:function(e){var t={displayText:this.widget.displayText,errorStatus:this.widget.errorStatus};this.widget.errorStatus||(t.value=wt.toJsonDate(this.widget.value)),this._send("acceptInput",t,{showBusyIndicator:!e.whileTyping,coalesce:function(e){return this.target===e.target&&this.type===e.type}}),this._errorStatus=null,this._errorStatusDisplayText=null}},{key:"_syncDisplayText",value:function(e){this.widget.setDisplayText(e),this._updateErrorStatus(this._errorStatus,e)}},{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e).sort(this._createPropertySortFunc(o.PROPERTIES_ORDER))}},{key:"_syncErrorStatus",value:function(e){e&&(this.widget.errorStatus?(e.invalidDate=this.widget.errorStatus.invalidDate,e.invalidTime=this.widget.errorStatus.invalidTime):(e.invalidDate=!0,e.invalidTime=!0)),this._updateErrorStatus(e,this.widget.displayText),this.widget.setErrorStatus(e)}},{key:"_updateErrorStatus",value:function(e,t){var n=null;(e=pi.ensure(e))&&(n=et.find(e.asFlatList(),(function(e){return e.code!==BK.ErrorCode.PARSE_ERROR}))),n?(this._errorStatus=n,this._errorStatusDisplayText=t):(this._errorStatus=null,this._errorStatusDisplayText=null)}}])&&HK(t.prototype,n),i&&HK(t,i),o}(QV);function qK(e){return(qK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YK(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function XK(e,t){return(XK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function JK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=eq(e);if(t){var r=eq(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ZK(this,n)}}function ZK(e,t){return!t||"object"!==qK(t)&&"function"!=typeof t?QK(e):t}function QK(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eq(e){return(eq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(KK,"PROPERTIES_ORDER",["hasTime","hasDate"]);var tq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XK(e,t)}(o,e);var t,n,i,r=JK(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this))._dateField=e,t.MIN_DATE_FIELD_WIDTH=90,t.PREF_DATE_FIELD_WIDTH=110,t.MIN_TIME_FIELD_WIDTH=60,t.PREF_TIME_FIELD_WIDTH=90,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmenPropertyChange.bind(QK(t)),Vo.get().on("propertyChange",t.htmlPropertyChangeHandler),t._dateField.one("remove",function(){Vo.get().off("propertyChange",this.htmlPropertyChangeHandler)}.bind(QK(t))),t}return t=o,(n=[{key:"_initDefaults",value:function(){this.hgap=Vo.get().smallColumnGap}},{key:"_onHtmlEnvironmenPropertyChange",value:function(){this._initDefaults(),this._dateField.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,i=Uo.get(e),r=this._dateField.$dateField,o=this._dateField.$timeField,s=this._dateField.$dateFieldIcon,a=this._dateField.$timeFieldIcon,u=this._dateField.$dateClearIcon,l=this._dateField.$timeClearIcon,c=this._dateField._$predictDateField,f=this._dateField._$predictTimeField,h=r?Uo.get(r):null,d=o?Uo.get(o):null,p=!!r&&!r.isDisplayNone(),y=!!o&&!o.isDisplayNone(),v=i.availableSize({exact:!0}).subtract(i.insets());if(p&&y){var b=h.margins(),g=d.margins(),m=new Ro(Math.max(b.top,g.top),Math.max(b.right,g.right),Math.max(b.bottom,g.bottom),Math.max(b.left,g.left)),_=v.subtract(m),w=this._hgap(),k=_.width-w,S=.6*k,O=k-S;t=new Co(S,_.height),n=new Co(O,_.height),h.setSize(t),d.setSize(n),o.cssRight(0),s.cssTop(r.cssBorderTopWidth()).cssRight(O+w).cssHeight(t.height-r.cssBorderWidthY()).cssLineHeight(t.height-r.cssBorderWidthY()),u&&u.cssTop(r.cssBorderTopWidth()).cssRight(O+w).cssHeight(t.height-r.cssBorderWidthY()).cssLineHeight(t.height-r.cssBorderWidthY()),a.cssTop(o.cssBorderTopWidth()).cssRight(0).cssHeight(n.height-o.cssBorderWidthY()).cssLineHeight(n.height-o.cssBorderWidthY()),l&&l.cssTop(o.cssBorderTopWidth()).cssRight(0).cssHeight(n.height-o.cssBorderWidthY()).cssLineHeight(n.height-o.cssBorderWidthY()),r.toggleClass("compact",t.width<this.MIN_DATE_FIELD_WIDTH),o.toggleClass("compact",n.width<this.MIN_TIME_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-date",t.width<this.MIN_DATE_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-time",n.width<this.MIN_TIME_FIELD_WIDTH),c&&No.setSize(c,t),f&&(No.setSize(f,n),f.cssRight(0))}else p?(t=v.subtract(h.margins()),h.setSize(t),s.cssTop(r.cssBorderTopWidth()).cssRight(0).cssHeight(t.height-r.cssBorderWidthY()).cssLineHeight(t.height-r.cssBorderWidthY()),u&&u.cssTop(r.cssBorderTopWidth()).cssRight(0).cssHeight(t.height-r.cssBorderWidthY()).cssLineHeight(t.height-r.cssBorderWidthY()),r.toggleClass("compact",t.width<this.MIN_DATE_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-date",t.width<this.MIN_DATE_FIELD_WIDTH),c&&No.setSize(c,t)):y&&(n=v.subtract(d.margins()),d.setSize(n),a.cssTop(o.cssBorderTopWidth()).cssRight(0).cssHeight(n.height-o.cssBorderWidthY()).cssLineHeight(n.height-o.cssBorderWidthY()),l&&l.cssTop(o.cssBorderTopWidth()).cssRight(0).cssHeight(n.height-o.cssBorderWidthY()).cssLineHeight(n.height-o.cssBorderWidthY()),o.toggleClass("compact",n.width<this.MIN_TIME_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-time",n.width<this.MIN_TIME_FIELD_WIDTH),f&&No.setSize(f,n));var T=this._dateField.popup;T&&T.rendered&&T.position()}},{key:"_hgap",value:function(){return this._dateField.cellEditor?0:this.hgap}},{key:"preferredLayoutSize",value:function(e){var t=new Co,n=this._dateField.$dateField,i=this._dateField.$timeField,r=!!n&&!n.isDisplayNone(),o=!!i&&!i.isDisplayNone();return r&&o?(t=No.prefSize(this._dateField.$dateField)).width=this.PREF_DATE_FIELD_WIDTH+this._hgap()+this.PREF_TIME_FIELD_WIDTH:r?(t=No.prefSize(this._dateField.$dateField)).width=this.PREF_DATE_FIELD_WIDTH:o&&((t=No.prefSize(this._dateField.$timeField)).width=this.PREF_TIME_FIELD_WIDTH),t}}])&&YK(t.prototype,n),i&&YK(t,i),o}(zo);function nq(e){return(nq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iq(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rq(e,t,n){return(rq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uq(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function oq(e,t){return(oq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=uq(e);if(t){var r=uq(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return aq(this,n)}}function aq(e,t){return!t||"object"!==nq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uq(e){return(uq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oq(e,t)}(o,e);var t,n,i,r=sq(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).button=null,e.fileInput=null,e.acceptTypes=null,e.maximumUploadSize=LS.DEFAULT_MAXIMUM_UPLOAD_SIZE,e}return t=o,(n=[{key:"_init",value:function(e){rq(uq(o.prototype),"_init",this).call(this,e),this.button=O.create("Button",{parent:this,label:this._buttonLabel(),iconId:this.iconId,labelHtmlEnabled:this.labelHtmlEnabled}),this.button.on("click",this._onButtonClick.bind(this)),this.fileInput.on("change",this._onFileChange.bind(this)),this.on("propertyChange",function(e){"enabledComputed"===e.propertyName&&(this.button.setEnabled(e.newValue),this.fileInput.setEnabled(e.newValue))}.bind(this))}},{key:"_initValue",value:function(e){this.fileInput=O.create("FileInput",{parent:this,acceptTypes:this.acceptTypes,text:this.displayText,enabled:this.enabledComputed,maximumUploadSize:this.maximumUploadSize,visible:!Mt.get().supportsFile()}),rq(uq(o.prototype),"_initValue",this).call(this,e)}},{key:"_buttonLabel",value:function(){return this.label}},{key:"_render",value:function(){this.addContainer(this.$parent,"file-chooser-button has-icon"),this.addLabel();var e=this.$parent.makeDiv(),t=Uo.install(e,this.session);this.button.render(e),t.setLayout(new xa(this.button.htmlComp)),this.fileInput.render(e),this.addField(e),e.setTabbable(!1),this.addStatus()}},{key:"setDisplayText",value:function(e){rq(uq(o.prototype),"setDisplayText",this).call(this,e),this.fileInput.setText(e),e||this.fileInput.clear()}},{key:"_readDisplayText",value:function(){return this.fileInput.text}},{key:"_renderLabel",value:function(){this._renderEmptyLabel()}},{key:"_onButtonClick",value:function(e){this.fileInput.browse()}},{key:"setLabel",value:function(e){rq(uq(o.prototype),"setLabel",this).call(this,e),this.button.setLabel(this._buttonLabel())}},{key:"setIconId",value:function(e){this.setProperty("iconId",e),this.button.setIconId(e)}},{key:"setAcceptTypes",value:function(e){this.setProperty("acceptTypes",e),this.fileInput.setAcceptTypes(e)}},{key:"setFileExtensions",value:function(e){this.setProperty("fileExtensions",e);var t=et.ensure(e);t=t.map((function(e){return"."===e.indexOf(0)?e:"."+e})),this.setAcceptTypes(En.join(",",t)),this.fileInput.acceptTypes=this.acceptTypes}},{key:"setMaximumUploadSize",value:function(e){this.setProperty("maximumUploadSize",e),this.fileInput.setMaximumUploadSize(e)}},{key:"_onFileChange",value:function(e){this.setValue(et.first(e.files))}},{key:"_validateValue",value:function(e){return this.fileInput.validateMaximumUploadSize(e),e}},{key:"_formatValue",value:function(e){return e?e.name:""}},{key:"getFocusableElement",value:function(){return this.button.getFocusableElement()}}])&&iq(t.prototype,n),i&&iq(t,i),o}(GV);function cq(e){return(cq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fq(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hq(e,t,n){return(hq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vq(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function dq(e,t){return(dq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=vq(e);if(t){var r=vq(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return yq(this,n)}}function yq(e,t){return!t||"object"!==cq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vq(e){return(vq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dq(e,t)}(o,e);var t,n,i,r=pq(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetPropertyChange",value:function(e){hq(vq(o.prototype),"_onWidgetPropertyChange",this).call(this,e),"value"===e.propertyName&&this._onValueChange(e)}},{key:"_onValueChange",value:function(e){this.widget.fileInput.upload()||this.widget.fileInput.clear()}},{key:"_syncDisplayText",value:function(e){this.widget.setDisplayText(e)}}])&&fq(t.prototype,n),i&&fq(t,i),o}(QV);function gq(e){return(gq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mq(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _q(e,t,n){return(_q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Oq(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function wq(e,t){return(wq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Oq(e);if(t){var r=Oq(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Sq(this,n)}}function Sq(e,t){return!t||"object"!==gq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oq(e){return(Oq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wq(e,t)}(o,e);var t,n,i,r=kq(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).fileInput=null,e.acceptTypes=null,e.maximumUploadSize=LS.DEFAULT_MAXIMUM_UPLOAD_SIZE,e}return t=o,(n=[{key:"_init",value:function(e){_q(Oq(o.prototype),"_init",this).call(this,e),this.fileInput.on("change",this._onFileChange.bind(this)),this.on("propertyChange",function(e){"enabledComputed"===e.propertyName&&this.fileInput.setEnabled(e.newValue)}.bind(this))}},{key:"_initValue",value:function(e){this.fileInput=O.create("FileInput",{parent:this,acceptTypes:this.acceptTypes,text:this.displayText,enabled:this.enabledComputed,maximumUploadSize:this.maximumUploadSize}),_q(Oq(o.prototype),"_initValue",this).call(this,e)}},{key:"_initKeyStrokeContext",value:function(){_q(Oq(o.prototype),"_initKeyStrokeContext",this).call(this),this.fileInput.legacy||(this.keyStrokeContext.registerKeyStroke(new Hq(this)),this.keyStrokeContext.registerKeyStroke(new Yq(this)))}},{key:"_render",value:function(){this.addContainer(this.$parent,"file-chooser-field has-icon"),this.addLabel(),this.addMandatoryIndicator(),this._renderFileInput(),this.addIcon(),this.addStatus()}},{key:"_renderFileInput",value:function(){this.fileInput.render(),this.addField(this.fileInput.$container)}},{key:"setDisplayText",value:function(e){_q(Oq(o.prototype),"setDisplayText",this).call(this,e),this.fileInput.setText(e),e||this.fileInput.clear()}},{key:"_readDisplayText",value:function(){return this.fileInput.text}},{key:"setAcceptTypes",value:function(e){this.setProperty("acceptTypes",e),this.fileInput.setAcceptTypes(e)}},{key:"_renderEnabled",value:function(){_q(Oq(o.prototype),"_renderEnabled",this).call(this),this.$field.setTabbable(this.enabledComputed)}},{key:"_renderPlaceholder",value:function(){var e=this.fileInput.$text;e&&e.placeholder(this.label)}},{key:"_removePlaceholder",value:function(){var e=this.fileInput.$text;e&&e.placeholder("")}},{key:"setMaximumUploadSize",value:function(e){this.setProperty("maximumUploadSize",e),this.fileInput.setMaximumUploadSize(e)}},{key:"_clear",value:function(){this.fileInput.clear()}},{key:"_onIconMouseDown",value:function(e){_q(Oq(o.prototype),"_onIconMouseDown",this).call(this,e),this.activate()}},{key:"_onFileChange",value:function(e){var t=et.first(e.files);oi.isNullOrUndefined(t)&&this.acceptInput(!1),this.setValue(t)}},{key:"activate",value:function(){this.enabledComputed&&this.rendered&&(this.$field.focus(),this.fileInput.browse())}},{key:"_validateValue",value:function(e){return this.fileInput.validateMaximumUploadSize(e),e}},{key:"_formatValue",value:function(e){return e?e.name:""}}])&&mq(t.prototype,n),i&&mq(t,i),o}(GV);function Cq(e){return(Cq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pq(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Rq(e,t,n){return(Rq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fq(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function xq(e,t){return(xq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Eq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Fq(e);if(t){var r=Fq(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Dq(this,n)}}function Dq(e,t){return!t||"object"!==Cq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fq(e){return(Fq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Aq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xq(e,t)}(o,e);var t,n,i,r=Eq(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetPropertyChange",value:function(e){Rq(Fq(o.prototype),"_onWidgetPropertyChange",this).call(this,e),"value"===e.propertyName&&this._onValueChange(e)}},{key:"_onValueChange",value:function(e){this.widget.fileInput.upload()||this.widget.fileInput.clear()}},{key:"_syncDisplayText",value:function(e){this.widget.setDisplayText(e)}}])&&Pq(t.prototype,n),i&&Pq(t,i),o}(QV);function $q(e){return($q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jq(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Mq(e,t){return(Mq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Iq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Nq(e);if(t){var r=Nq(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Lq(this,n)}}function Lq(e,t){return!t||"object"!==$q(t)&&"function"!=typeof t?Bq(e):t}function Bq(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nq(e){return(Nq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mq(e,t)}(o,e);var t,n,i,r=Iq(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.SPACE],t.stopPropagation=!0,t.renderingHints.hAlign=Ni.LEFT,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(Bq(t)),t}return t=o,(n=[{key:"handle",value:function(e){this.field.fileInput.browse()}}])&&jq(t.prototype,n),i&&jq(t,i),o}($u);function Vq(e){return(Vq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wq(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zq(e,t){return(zq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=qq(e);if(t){var r=qq(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Uq(this,n)}}function Uq(e,t){return!t||"object"!==Vq(t)&&"function"!=typeof t?Kq(e):t}function Kq(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qq(e){return(qq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zq(e,t)}(o,e);var t,n,i,r=Gq(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.DELETE],t.stopPropagation=!0,t.renderingHints.offset=25,t.renderingHints.hAlign=Ni.RIGHT,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(Kq(t)),t}return t=o,(n=[{key:"handle",value:function(e){this.field.clear()}}])&&Wq(t.prototype,n),i&&Wq(t,i),o}($u);function Xq(e){return(Xq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jq(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zq(e,t,n){return(Zq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nY(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Qq(e,t){return(Qq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=nY(e);if(t){var r=nY(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return tY(this,n)}}function tY(e,t){return!t||"object"!==Xq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nY(e){return(nY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iY(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qq(e,t)}(o,e);var t,n,i,r=eY(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["fields","notification","staticMenus"]),e._addCloneProperties(["menuBarVisible","bodyLayoutConfig","borderDecoration","borderVisible","expandable","expanded","gridColumnCount","scrollable","subLabel"]),e.fields=[],e.menus=[],e.menuBarVisible=!0,e.menuBarPosition=o.MenuBarPosition.AUTO,e.menuBarEllipsisPosition=O_.EllipsisPosition.RIGHT,e.notification=null,e.bodyLayoutConfig=null,e.borderDecoration=o.BorderDecoration.AUTO,e.borderVisible=!0,e.mainBox=!1,e.scrollable=null,e.expandable=!1,e.expanded=!0,e.logicalGrid=O.create("scout.VerticalSmartGrid"),e.gridColumnCount=2,e.gridDataHints.useUiHeight=!0,e.gridDataHints.w=GH.FULL_WIDTH,e.controls=[],e.systemButtons=[],e.customButtons=[],e.processButtons=[],e.processMenus=[],e.staticMenus=[],e.responsive=null,e.$body=null,e.$title=null,e.$subLabel=null,e}return t=o,(n=[{key:"_init",value:function(e){Zq(nY(o.prototype),"_init",this).call(this,e),this.resolveConsts([{property:"menuBarPosition",constType:o.MenuBarPosition}]),this._setBodyLayoutConfig(this.bodyLayoutConfig),this.menuBar=O.create("MenuBar",{parent:this,menuOrder:new xY,ellipsisPosition:this.menuBarEllipsisPosition}),this._setFields(this.fields),this._setMainBox(this.mainBox),this._updateMenuBar(),lP.get().registerHandler(this,O.create("GroupBoxResponsiveHandler",{widget:this})),this._setResponsive(this.responsive)}},{key:"_destroy",value:function(){lP.get().unregisterHandler(this),Zq(nY(o.prototype),"_destroy",this).call(this)}},{key:"getFields",value:function(){return this.fields}},{key:"insertField",value:function(e,t){var n=this.fields.slice();t=O.nvl(t,this.fields.length),n.splice(t,0,e),this.setFields(n)}},{key:"insertFieldBefore",value:function(e,t){O.assertParameter("sibling",t);var n=this.fields.indexOf(t);this.insertField(e,n)}},{key:"insertFieldAfter",value:function(e,t){O.assertParameter("sibling",t);var n=this.fields.indexOf(t)+1;this.insertField(e,n)}},{key:"deleteField",value:function(e){var t=this.fields.slice(),n=this.fields.indexOf(e);n<0||(t.splice(n,1),this.setFields(t))}},{key:"setFields",value:function(e){this.setProperty("fields",e)}},{key:"_setFields",value:function(e){this._setProperty("fields",e),this._prepareFields()}},{key:"_renderFields",value:function(e){this._renderExpanded(),this.invalidateLogicalGrid(!0)}},{key:"_initKeyStrokeContext",value:function(){Zq(nY(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.keyStrokeContext.$bindTarget=this._keyStrokeBindTarget.bind(this)}},{key:"_setKeyStrokes",value:function(e){e=et.ensure(e);var t={render:function(){return!0},offset:0,hAlign:Ni.RIGHT,$drawingArea:function(e,t){return this.labelVisible?this.$title:this.$body}.bind(this)};e.forEach((function(e){e.actionKeyStroke.renderingHints=s.a.extend({},e.actionKeyStroke.renderingHints,t)}),this),Zq(nY(o.prototype),"_setKeyStrokes",this).call(this,e)}},{key:"_keyStrokeBindTarget",value:function(){var e=this.getForm();return e?e.$container:this.$container}},{key:"_render",value:function(){this.addContainer(this.$parent,this.mainBox?"root-group-box":"group-box"),this.$title=this.$container.appendDiv("group-box-title"),this.addLabel(),this.addSubLabel(),this.addStatus(),this.$body=this.$container.appendDiv("group-box-body"),this.htmlBody=Uo.install(this.$body,this.session),this.htmlBody.setLayout(this._createBodyLayout())}},{key:"_remove",value:function(){this._removeSubLabel(),Zq(nY(o.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){this._renderScrollable(),this._renderExpanded(),Zq(nY(o.prototype),"_renderProperties",this).call(this),this._renderBodyLayoutConfig(),this._renderNotification(),this._renderBorderVisible(),this._renderExpandable(),this._renderMenuBarPosition(),this._renderMenuBarEllipsisPosition(),this._renderMenuBarVisible(),this._renderSubLabel()}},{key:"_createLayout",value:function(){return new PY(this)}},{key:"_createBodyLayout",value:function(){return new ls(this,this.bodyLayoutConfig)}},{key:"setBodyLayoutConfig",value:function(e){this.setProperty("bodyLayoutConfig",e)}},{key:"_setBodyLayoutConfig",value:function(e){e||(e=new fs),this._setProperty("bodyLayoutConfig",fs.ensure(e))}},{key:"_renderBodyLayoutConfig",value:function(){var e=this.htmlBody.layout.minWidth;this.bodyLayoutConfig.applyToLayout(this.htmlBody.layout),e!==this.bodyLayoutConfig.minWidth&&this._renderScrollable(),this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"rerenderControls",value:function(){this._removeControls(),this._renderControls(),this.htmlBody.invalidateLayoutTree()}},{key:"_removeControls",value:function(){this.controls.forEach((function(e){e.remove()}),this)}},{key:"_renderControls",value:function(){this.controls.forEach((function(e){e.rendered||(e.render(this.$body),e.setLayoutData(new ts(e)))}),this)}},{key:"addSubLabel",value:function(){this.$subLabel||(this.$subLabel=this.$title.appendDiv("sub-label"),dh.installForEllipsis(this.$subLabel,{parent:this}))}},{key:"_removeSubLabel",value:function(){this.$subLabel&&(dh.uninstall(this.$subLabel),this.$subLabel.remove(),this.$subLabel=null)}},{key:"setSubLabel",value:function(e){this.setProperty("subLabel",e)}},{key:"_renderSubLabel",value:function(){this.$subLabel.setVisible(En.hasText(this.subLabel)),this.$subLabel.textOrNbsp(this.subLabel),this.$container.toggleClass("has-sub-label",this.$subLabel.isVisible()),this.invalidateLayoutTree()}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this._uninstallScrollbars(),this.scrollable?this._installScrollbars({axis:this.bodyLayoutConfig.minWidth>0?"both":"y"}):this.bodyLayoutConfig.minWidth>0&&this._installScrollbars({axis:"x"})}},{key:"get$Scrollable",value:function(){return this.$body}},{key:"setMainBox",value:function(e){this.setProperty("mainBox",e)}},{key:"_setMainBox",value:function(e){this._setProperty("mainBox",e),this.mainBox&&(this.menuBar.setCssClass("main-menubar"),null===this.scrollable&&this.setScrollable(!0),null===this.responsive&&this.setResponsive(!0))}},{key:"addLabel",value:function(){this.$label||(this.$label=this.$title.appendDiv("label"),dh.installForEllipsis(this.$label,{parent:this}))}},{key:"_renderLabel",value:function(){this.$label.textOrNbsp(this.label),this.rendered&&this._renderLabelVisible()}},{key:"addStatus",value:function(){Zq(nY(o.prototype),"addStatus",this).call(this),this._updateStatusPosition()}},{key:"_renderStatusPosition",value:function(){this._updateStatusPosition()}},{key:"_updateStatusPosition",value:function(){this.fieldStatus&&(this.statusPosition===GH.StatusPosition.TOP?this.$status.appendTo(this.$title):this.$status.appendTo(this.$container),this.invalidateLayoutTree())}},{key:"setNotification",value:function(e){this.setProperty("notification",e)}},{key:"_renderNotification",value:function(){this.notification?(this.notification.render(),this.notification.$container.insertBefore(this.$body),this.invalidateLayoutTree()):this.invalidateLayoutTree()}},{key:"_prepareFields",value:function(){var e,t;for(this.processButtons.forEach(this._unregisterButtonKeyStrokes.bind(this)),this.controls=[],this.systemButtons=[],this.customButtons=[],this.processButtons=[],this.processMenus=[],e=0;e<this.fields.length;e++)if((t=this.fields[e])instanceof WG)t.processButton?(this.processButtons.push(t),t.systemType!==WG.SystemType.NONE?this.systemButtons.push(t):this.customButtons.push(t)):(this.controls.push(t),this._registerButtonKeyStrokes(t));else if(t instanceof G5){this.controls.push(t);for(var n=0;n<t.tabItems.length;n++)t.tabItems[n].selectionKeystroke&&this.keyStrokeContext.registerKeyStroke(new Fl(t.tabItems[n].selectionKeystroke,t.tabItems[n]))}else this.controls.push(t);this.processMenus=this.processButtons.map((function(e){return O.create("ButtonAdapterMenu",Im.adaptButtonProperties(e,{parent:this,menubar:this.menuBar,button:e,defaultMenu:!!e.defaultButton||null}))}),this),this.registerKeyStrokes(this.processMenus)}},{key:"_unregisterButtonKeyStrokes",value:function(e){e.keyStrokes&&e.keyStrokes.forEach((function(e){this.keyStrokeContext.unregisterKeyStroke(e)}),this)}},{key:"_registerButtonKeyStrokes",value:function(e){e.keyStrokes&&e.keyStrokes.forEach((function(e){this.keyStrokeContext.registerKeyStroke(e)}),this)}},{key:"setBorderVisible",value:function(e){this.setProperty("borderVisible",e)}},{key:"_renderBorderVisible",value:function(){var e=this.borderVisible;this.borderDecoration===o.BorderDecoration.AUTO&&(e=this._computeBorderVisible(e)),this.$body.toggleClass("y-padding-invisible",!e),this.invalidateLayoutTree()}},{key:"setBorderDecoration",value:function(e){this.setProperty("borderDecoration",e)}},{key:"_renderBorderDecoration",value:function(){this._renderBorderVisible()}},{key:"_getCurrentMenus",value:function(){return this.menuBarVisible?[]:Zq(nY(o.prototype),"_getCurrentMenus",this).call(this)}},{key:"setMenuBarVisible",value:function(e){this.setProperty("menuBarVisible",e)}},{key:"_setMenuBarVisible",value:function(e){this._setProperty("menuBarVisible",e),this._updateMenuBar()}},{key:"_renderMenuBarVisible",value:function(){this.menuBarVisible?this._renderMenuBar():this.menuBar.remove(),this._updateMenus(),this.invalidateLayoutTree()}},{key:"_renderMenuBar",value:function(){this.menuBar.render(),this.menuBarPosition===o.MenuBarPosition.TITLE?this.menuBar.$container.insertAfter(this.$subLabel):this.menuBar.position===O_.Position.TOP&&this.menuBar.$container.insertAfter(this.$title)}},{key:"setMenuBarPosition",value:function(e){this.setProperty("menuBarPosition",e)}},{key:"_renderMenuBarPosition",value:function(){var e=this.menuBarPosition;e===o.MenuBarPosition.AUTO&&(e=o.MenuBarPosition.TOP);var t=e===o.MenuBarPosition.TITLE;this.$title.toggleClass("has-menubar",t),e===o.MenuBarPosition.BOTTOM?this.menuBar.setPosition(O_.Position.BOTTOM):this.menuBar.setPosition(O_.Position.TOP),this.rendered&&(this.menuBar.remove(),this._renderMenuBarVisible())}},{key:"setMenuBarEllipsisPosition",value:function(e){this.setProperty("menuBarEllipsisPosition",e),this.menuBar.setEllipsisPosition(e)}},{key:"_renderMenuBarEllipsisPosition",value:function(){this.menuBar.reorderMenus(),this.rendered&&(this.menuBar.remove(),this._renderMenuBarVisible())}},{key:"_computeBorderVisible",value:function(e){return(this.mainBox||this.parent instanceof o&&this.parent.parent instanceof ZO&&this.parent.parent.parent instanceof J8&&this.parent.parent.parent.parent instanceof h3&&1===this.parent.getFields().length)&&(e=!1),e}},{key:"setExpandable",value:function(e){this.setProperty("expandable",e)}},{key:"_renderExpandable",value:function(){var e=this.expandable,t=this.$title.children(".group-box-control");e?(0===t.length&&this.$container.makeDiv("group-box-control").on("click",this._onControlClick.bind(this)).insertAfter(this.$label),this.$title.addClass("expandable").on("click.group-box-control",this._onControlClick.bind(this))):(t.remove(),this.$title.removeClass("expandable").off(".group-box-control"))}},{key:"setExpanded",value:function(e){this.setProperty("expanded",e)}},{key:"_renderExpanded",value:function(){this.$container.toggleClass("collapsed",!this.expanded),this.expanded?(void 0!==this._collapsedWeightY&&(this.gridData.weightY=this._collapsedWeightY,delete this._collapsedWeightY),this.invalidateLayout(),this._renderControls()):0!==this.gridData.weightY&&(this._collapsedWeightY=this.gridData.weightY,this.gridData.weightY=0),this.invalidateLayoutTree()}},{key:"setGridColumnCount",value:function(e){this.setProperty("gridColumnCount",e),this.invalidateLogicalGrid()}},{key:"invalidateLogicalGrid",value:function(e){Zq(nY(o.prototype),"invalidateLogicalGrid",this).call(this,!1),O.nvl(e,!0)&&this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"_setLogicalGrid",value:function(e){Zq(nY(o.prototype),"_setLogicalGrid",this).call(this,e),this.logicalGrid&&this.logicalGrid.setGridConfig(new fY)}},{key:"_renderLabelVisible",value:function(e){this.$title.setVisible(this._computeTitleVisible(e)),this._updateFieldStatus(),this.menuBarPosition===o.MenuBarPosition.TITLE&&this.invalidateLayoutTree()}},{key:"_computeTitleVisible",value:function(e){return!(!(e=O.nvl(e,this.labelVisible))||!this.label||this.mainBox)}},{key:"_computeStatusVisible",value:function(){return Zq(nY(o.prototype),"_computeStatusVisible",this).call(this)&&this._computeTitleVisible()}},{key:"_setMenus",value:function(e){Zq(nY(o.prototype),"_setMenus",this).call(this,e),this.menuBar&&this._updateMenuBar()}},{key:"_updateMenuBar",value:function(){if(this.menuBarVisible){var e=this.staticMenus.concat(this.processMenus).concat(this.menus);this.menuBar.setMenuItems(e)}}},{key:"_removeMenus",value:function(){}},{key:"setStaticMenus",value:function(e){this.setProperty("staticMenus",e),this._updateMenuBar()}},{key:"_onControlClick",value:function(e){this.expandable&&(this.setExpanded(!this.expanded),this.validateLayoutTree()),s.a.suppressEvent(e)}},{key:"setResponsive",value:function(e){this.setProperty("responsive",e)}},{key:"_setResponsive",value:function(e){if(this._setProperty("responsive",e),this.initialized){if(this.responsive)lP.get().reset(this,!0);else if(lP.get().reset(this,!0),null===this.responsive){var t=this.findParent((function(e){return e instanceof o&&e.responsive}));lP.get().reset(t,!0)}this.invalidateLayoutTree()}}},{key:"clone",value:function(e,t){var n=Zq(nY(o.prototype),"clone",this).call(this,e);return this._deepCloneProperties(n,["fields"],t),n._prepareFields(),n}}])&&Jq(t.prototype,n),i&&Jq(t,i),o}(EV);function oY(e){return(oY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sY(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aY(e,t){return(aY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=cY(e);if(t){var r=cY(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return lY(this,n)}}function lY(e,t){return!t||"object"!==oY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cY(e){return(cY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}iY(rY,"BorderDecoration",{AUTO:"auto",EMPTY:"empty",LINE:"line"}),iY(rY,"MenuBarPosition",{AUTO:"auto",TOP:"top",BOTTOM:"bottom",TITLE:"title"});var fY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aY(e,t)}(o,e);var t,n,i,r=uY(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"getGridWidgets",value:function(){return this.widget.controls}},{key:"getGridColumnCount",value:function(){var e=-1,t=this.widget;do{e=O.nvl(t.gridColumnCount,e)}while(e<0&&t.getParentGroupBox&&(t=t.getParentGroupBox()));return e<0?2:e}}])&&sY(t.prototype,n),i&&sY(t,i),o}(Qo);function hY(e){return(hY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dY(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pY(e,t,n){return(pY="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gY(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function yY(e,t){return(yY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=gY(e);if(t){var r=gY(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bY(this,n)}}function bY(e,t){return!t||"object"!==hY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gY(e){return(gY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yY(e,t)}(o,e);var t,n,i,r=vY(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["expanded"]),e}return t=o,(n=[{key:"_initModel",value:function(e,t){return(e=pY(gY(o.prototype),"_initModel",this).call(this,e,t)).logicalGrid=null,e}},{key:"_postCreateWidget",value:function(){pY(gY(o.prototype),"_postCreateWidget",this).call(this),this.widget.responsiveHandler&&(this.widget.responsiveHandler.setAllowedStates([lP.ResponsiveState.NORMAL,lP.ResponsiveState.CONDENSED]),this.widget.responsiveHandler.getGridData=this._getGridData,this.widget.responsiveHandler.setGridData=this._setGridData)}},{key:"destroy",value:function(){pY(gY(o.prototype),"destroy",this).call(this)}},{key:"_getGridData",value:function(e){return new kV(e.gridData)}},{key:"_setGridData",value:function(e,t){e._setGridData(t)}}])&&dY(t.prototype,n),i&&dY(t,i),o}(MV);function _Y(e){return(_Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wY(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kY(e,t){return(kY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=CY(e);if(t){var r=CY(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return OY(this,n)}}function OY(e,t){return!t||"object"!==_Y(t)&&"function"!=typeof t?TY(e):t}function TY(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CY(e){return(CY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kY(e,t)}(o,e);var t,n,i,r=SY(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).groupBox=e,t._initDefaults(),t._htmlPropertyChangeHandler=t._onHtmlEnvironmentPropertyChange.bind(TY(t)),Vo.get().on("propertyChange",t._htmlPropertyChangeHandler),t.groupBox.one("remove",function(){Vo.get().off("propertyChange",this._htmlPropertyChangeHandler)}.bind(TY(t))),t}return t=o,(n=[{key:"_initDefaults",value:function(){this._statusWidth=Vo.get().fieldStatusWidth}},{key:"_onHtmlEnvironmentPropertyChange",value:function(){this._initDefaults(),this.groupBox.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,i=0,r=0,o=this.groupBox.statusPosition,a=this.groupBox.htmlComp,u=this._htmlGbBody(),l=this._htmlMenuBar(),c=this.groupBox._tooltip(),f=this.groupBox.$title,h=this.groupBox.$label,d=this.groupBox.$status,p=a.availableSize().subtract(a.insets());if(this.groupBox.responsive&&lP.get().handleResponsive(this.groupBox,p.width),d&&d.isVisible()&&(this._layoutStatus(),r=d.outerWidth(!0)),l){if(this.groupBox.menuBarPosition===rY.MenuBarPosition.TITLE){n=l.prefSize({exact:!0});var y=No.prefSize(this.groupBox.$title),v=Math.ceil(No.prefSize(this.groupBox.$label,!0).width)+1,b=n.width,g=y.width-r;if(v+b<g)b=Math.floor(g-v),n.width=b,h.cssWidth("");else{var m=(v+b)/g,_=v/g/m,w=b/g/m;_<w?w=1-(_=Math.max(.33,_)):_=1-(w=Math.max(.33,w)),v=_*g,b=w*g,n.width=Math.floor(b),h.cssWidth(Math.floor(v))}}else i=(n=this._menuBarSize(l,p,r)).height,k(h);l.setSize(n)}else k(h);function k(e,t){if(t){var n=e.cssMarginX()+t;e.cssWidth("calc(100% - "+n+"px)")}else e.cssWidth("")}k(f),o===GH.StatusPosition.TOP?this.groupBox.menuBarPosition!==rY.MenuBarPosition.TITLE&&k(h,r):k(f,r),(t=p.subtract(u.margins())).height-=this._titleHeight(),t.height-=this._notificationHeight(),t.height-=i,s.a.log.isTraceEnabled()&&s.a.log.trace("(GroupBoxLayout#layout) gbBodySize="+t),u.setSize(t),c&&c.rendered&&c.position(),(u.scrollable||this.groupBox.bodyLayoutConfig.minWidth>0)&&wf.update(u.$comp)}},{key:"_layoutStatus",value:function(){var e=this.groupBox.htmlComp.insets({includeBorder:!1}),t=e.top,n=e.right,i=this.groupBox.$title,r=i.innerHeight(),o=this.groupBox.$status,s=No.margins(o),a=this.groupBox.statusPosition;o.cssWidth(this._statusWidth),a===GH.StatusPosition.DEFAULT&&o.cssTop(t+i.cssMarginTop()).cssRight(n).cssHeight(r-s.vertical()).cssLineHeight(r-s.vertical())}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n,i,r=this.groupBox.htmlComp,o=this._htmlGbBody(),s=0,a=0,u=this.groupBox.gridData,l=!1;return this.groupBox.responsive&&t.widthHint&&(l=lP.get().handleResponsive(this.groupBox,t.widthHint)),u&&(s=u.widthInPixel,a=u.heightInPixel),s&&a?i=new Co(s,a).add(r.insets()):(!t.widthHint&&s&&(t.widthHint=s),t.heightHint=null,this.groupBox.expanded?(i=o.prefSize(t).add(o.margins()),(n=this._htmlMenuBar())&&this.groupBox.menuBarPosition!==rY.MenuBarPosition.TITLE&&(i.height+=n.prefSize(t).height)):i=new Co(0,0),(i=i.add(r.insets())).height+=this._titleHeight(),i.height+=this._notificationHeight(t),s&&(i.width=s),a&&(i.height=a),l&&lP.get().reset(this.groupBox),i)}},{key:"_titleHeight",value:function(){return No.prefSize(this.groupBox.$title,!0).height}},{key:"_notificationHeight",value:function(e){return e=e||{},this.groupBox.notification?(e.includeMargin=!0,this.groupBox.notification.htmlComp.prefSize(e).height):0}},{key:"_menuBarSize",value:function(e,t,n){var i=D_.size(e,t);return this.groupBox.mainBox||(i.width-=n),i}},{key:"_htmlMenuBar",value:function(){if(this.groupBox.menuBar&&this.groupBox.menuBarVisible){var e=Uo.optGet(this.groupBox.menuBar.$container);if(e&&e.isVisible())return e}return null}},{key:"_htmlGbBody",value:function(){return Uo.get(this.groupBox.$body)}}])&&wY(t.prototype,n),i&&wY(t,i),o}(zo);function RY(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var xY=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"order",value:function(e){var t=[],n=[],i=[],r=[];return e.forEach((function(e){if(e.isButton()){var o=e.horizontalAlignment;void 0===o&&(o=e.gridData&&e.gridData.horizontalAlignment),1===o?i.push(e):t.push(e)}else 1===e.horizontalAlignment?r.push(e):n.push(e)})),{left:t.concat(n),right:r.concat(i),all:t.concat(n).concat(r).concat(i)}}}])&&RY(t.prototype,n),i&&RY(t,i),e}();function EY(e){return(EY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DY(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function FY(e,t,n){return(FY="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MY(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function AY(e,t){return(AY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=MY(e);if(t){var r=MY(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jY(this,n)}}function jY(e,t){return!t||"object"!==EY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MY(e){return(MY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var IY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AY(e,t)}(o,e);var t,n,i,r=$Y(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).scrollBarEnabled=!1,e.preventInitialFocus=!0,e}return t=o,(n=[{key:"_initKeyStrokeContext",value:function(){FY(MY(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new CH(this,this._onAppLinkAction))}},{key:"_render",value:function(){this.addContainer(this.$parent,"html-field"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus()}},{key:"_renderProperties",value:function(){FY(MY(o.prototype),"_renderProperties",this).call(this),this._renderScrollBarEnabled(),this._renderScrollToAnchor()}},{key:"_readDisplayText",value:function(){return this.$field.html()}},{key:"_renderDisplayText",value:function(){this.displayText?(this.$field.html(this.displayText),this.$field.find(".app-link").on("click",this._onAppLinkAction.bind(this)),this.$field.find("a, .app-link").attr("tabindex","0").unfocusable(),this.$field.find("img").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this)),this.rendered&&(this._uninstallScrollbars(),this._renderScrollBarEnabled()),this.invalidateLayoutTree()):this.$field.empty()}},{key:"setScrollBarEnabled",value:function(e){this.setProperty("scrollBarEnabled",e)}},{key:"_renderScrollBarEnabled",value:function(){this.scrollBarEnabled?this._installScrollbars():this._uninstallScrollbars()}},{key:"scrollToEnd",value:function(){this.scrollToBottom()}},{key:"_renderScrollToAnchor",value:function(){if(this.rendered){var e=this.scrollToAnchor;if(this.scrollBarEnabled&&e&&this.$field.find(e)){var t=this.$field.find("#".concat(e));t&&t.length>0&&wf.scrollTo(this.$field,t)}}else this.session.layoutValidator.schedulePostValidateFunction(this._renderScrollToAnchor.bind(this))}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}},{key:"_onImageLoad",value:function(e){this.invalidateLayoutTree()}},{key:"_onImageError",value:function(e){this.invalidateLayoutTree()}}])&&DY(t.prototype,n),i&&DY(t,i),o}(GV);function LY(e){return(LY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BY(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function NY(e,t,n){return(NY="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zY(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function HY(e,t){return(HY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zY(e);if(t){var r=zY(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return WY(this,n)}}function WY(e,t){return!t||"object"!==LY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zY(e){return(zY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var GY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HY(e,t)}(o,e);var t,n,i,r=VY(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_initProperties",value:function(e){void 0!==e.scrollToEnd&&delete e.scrollToEnd}},{key:"_syncScrollToEnd",value:function(){this.widget.scrollToBottom()}},{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):NY(zY(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&BY(t.prototype,n),i&&BY(t,i),o}(QV);function UY(e){return(UY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KY(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qY(e,t,n){return(qY="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ZY(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function YY(e,t){return(YY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ZY(e);if(t){var r=ZY(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return JY(this,n)}}function JY(e,t){return!t||"object"!==UY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZY(e){return(ZY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var QY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YY(e,t)}(o,e);var t,n,i,r=XY(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).autoFit=!1,e.scrollBarEnabled=!1,e.uploadEnabled=!1,e.acceptTypes=null,e.maximumUploadSize=LS.DEFAULT_MAXIMUM_UPLOAD_SIZE,e._clickHandler=null,e}return t=o,(n=[{key:"_init",value:function(e){qY(ZY(o.prototype),"_init",this).call(this,e),this.resolveIconIds(["imageUrl"]),this.icon=O.create("Icon",{parent:this,iconDesc:this.imageUrl,autoFit:this.autoFit,prepend:!0}),this.icon.on("load",this._onImageLoad.bind(this)),this.icon.on("error",this._onImageError.bind(this))}},{key:"_render",value:function(){this.addContainer(this.$parent,"image-field",new yX(this)),this.addFieldContainer(this.$parent.makeDiv()),Uo.install(this.$fieldContainer,this.session).setLayout(new xa),this.icon.render(this.$fieldContainer),this.addLabel(),this.addField(this.icon.$container),this.addStatus()}},{key:"_renderProperties",value:function(){qY(ZY(o.prototype),"_renderProperties",this).call(this),this._renderScrollBarEnabled(),this._renderDropType(),this._renderImageUrl(),this._renderUploadEnabled()}},{key:"_remove",value:function(){qY(ZY(o.prototype),"_remove",this).call(this),this._clickHandler=null,this.fileInput&&(this.fileInput.destroy(),this.fileInput=null)}},{key:"_installDragAndDropHandler",value:function(e){this.dragAndDropHandler||(this.dragAndDropHandler=this._createDragAndDropHandler(),this.dragAndDropHandler.install(this.$fieldContainer))}},{key:"setImageUrl",value:function(e){this.setProperty("imageUrl",e)}},{key:"_setImageUrl",value:function(e){this._setProperty("imageUrl",e),this.icon.setIconDesc(e)}},{key:"_renderImageUrl",value:function(){var e=!!this.imageUrl;this.$fieldContainer.toggleClass("has-image",e),this.$container.toggleClass("has-image",e),wf.update(this.$fieldContainer)}},{key:"setAutoFit",value:function(e){this.setProperty("autoFit",e)}},{key:"_setAutoFit",value:function(e){this._setProperty("autoFit",e),this.icon.setAutoFit(e)}},{key:"_renderAutoFit",value:function(){wf.update(this.$fieldContainer)}},{key:"_renderScrollBarEnabled",value:function(){this._updateInnerAlignment(),this.scrollBarEnabled?this._installScrollbars():this._uninstallScrollbars()}},{key:"get$Scrollable",value:function(){return this.$fieldContainer}},{key:"_renderGridData",value:function(){qY(ZY(o.prototype),"_renderGridData",this).call(this),this._updateInnerAlignment()}},{key:"_renderGridDataHints",value:function(){qY(ZY(o.prototype),"_renderGridDataHints",this).call(this),this._updateInnerAlignment()}},{key:"_updateInnerAlignment",value:function(){this.updateInnerAlignment({useHorizontalAlignment:!this.scrollBarEnabled,useVerticalAlignment:!this.scrollBarEnabled})}},{key:"setUploadEnabled",value:function(e){this.setProperty("uploadEnabled",e)}},{key:"_renderEnabled",value:function(){qY(ZY(o.prototype),"_renderEnabled",this).call(this),this._updateUploadEnabled()}},{key:"_renderUploadEnabled",value:function(){this._updateUploadEnabled()}},{key:"_updateUploadEnabled",value:function(){var e=this.enabledComputed&&this.uploadEnabled;this.$fieldContainer.toggleClass("clickable",e),e?(this._clickHandler||(this._clickHandler=this._onClickUpload.bind(this),this.$fieldContainer.on("click",this._clickHandler)),this.fileInput||(this.fileInput=O.create("FileInput",{parent:this,acceptTypes:this.acceptTypes,text:this.displayText,enabled:this.enabledComputed,maximumUploadSize:this.maximumUploadSize,visible:!Mt.get().supportsFile()}),this.fileInput.render(this.$fieldContainer),this.fileInput.on("change",this._onFileChange.bind(this)))):(this.$fieldContainer.off("click",this._clickHandler),this._clickHandler=null,this.fileInput&&(this.fileInput.destroy(),this.fileInput=null))}},{key:"_onClickUpload",value:function(e){s()(e.target).isOrHas(this.$field)&&this.fileInput.browse()}},{key:"_onFileChange",value:function(e){this.trigger("fileUpload",{file:et.first(e.files)})}},{key:"_onImageLoad",value:function(e){this._onIconUpdated()}},{key:"_onImageError",value:function(e){this._onIconUpdated()}},{key:"_onIconUpdated",value:function(){wf.update(this.$fieldContainer),this.$field=this.icon.$container}}])&&KY(t.prototype,n),i&&KY(t,i),o}(GH);function eX(e){return(eX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tX(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nX(e,t,n){return(nX="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sX(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function iX(e,t){return(iX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=sX(e);if(t){var r=sX(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return oX(this,n)}}function oX(e,t){return!t||"object"!==eX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sX(e){return(sX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var aX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iX(e,t)}(o,e);var t,n,i,r=rX(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetEvent",value:function(e){"fileUpload"===e.type?this._onFileUpload(e):nX(sX(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onFileUpload",value:function(e){this.widget.fileInput.upload()||this.widget.fileInput.clear()}}])&&tX(t.prototype,n),i&&tX(t,i),o}(ZH);function uX(e){return(uX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lX(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cX(e,t,n){return(cX="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pX(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function fX(e,t){return(fX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pX(e);if(t){var r=pX(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dX(this,n)}}function dX(e,t){return!t||"object"!==uX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pX(e){return(pX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fX(e,t)}(o,e);var t,n,i,r=hX(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"layout",value:function(e){cX(pX(o.prototype),"layout",this).call(this,e),wf.update(this.formField.$fieldContainer)}}])&&lX(t.prototype,n),i&&lX(t,i),o}(sV);function vX(e){return(vX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bX(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gX(e,t,n){return(gX="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kX(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function mX(e,t){return(mX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=kX(e);if(t){var r=kX(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wX(this,n)}}function wX(e,t){return!t||"object"!==vX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kX(e){return(kX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var SX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mX(e,t)}(o,e);var t,n,i,r=_X(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).htmlEnabled=!1,e.selectable=!0,e.wrapText=!1,e}return t=o,(n=[{key:"_initValue",value:function(e){e=th.resolveText(e,this.session.locale.languageTag),gX(kX(o.prototype),"_initValue",this).call(this,e)}},{key:"_render",value:function(){this.addContainer(this.$parent,"label-field"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus()}},{key:"_renderProperties",value:function(){gX(kX(o.prototype),"_renderProperties",this).call(this),this._renderWrapText()}},{key:"acceptInput",value:function(){}},{key:"setHtmlEnabled",value:function(e){this.setProperty("htmlEnabled",e)}},{key:"_renderHtmlEnabled",value:function(){this._renderDisplayText()}},{key:"_renderDisplayText",value:function(){var e=this.displayText||"";this.htmlEnabled?(this.$field.html(e),this.$field.find(".app-link").on("click",this._onAppLinkAction.bind(this))):this.$field.html(En.nl2br(e)),this.invalidateLayoutTree()}},{key:"setWrapText",value:function(e){this.setProperty("wrapText",e)}},{key:"_renderWrapText",value:function(){this.$field.toggleClass("white-space-nowrap",!this.wrapText),this.invalidateLayoutTree()}},{key:"_renderGridData",value:function(){gX(kX(o.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_renderGridDataHints",value:function(){gX(kX(o.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_onAppLinkAction",value:function(e){var t=$(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}}])&&bX(t.prototype,n),i&&bX(t,i),o}(GV);function OX(e){return(OX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TX(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function CX(e,t,n){return(CX="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=EX(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function PX(e,t){return(PX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=EX(e);if(t){var r=EX(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xX(this,n)}}function xX(e,t){return!t||"object"!==OX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function EX(e){return(EX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var DX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PX(e,t)}(o,e);var t,n,i,r=RX(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):CX(EX(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&TX(t.prototype,n),i&&TX(t,i),o}(QV);function FX(e){return(FX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AX(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $X(e,t,n){return($X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=LX(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function jX(e,t){return(jX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function MX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=LX(e);if(t){var r=LX(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return IX(this,n)}}function IX(e,t){return!t||"object"!==FX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function LX(e){return(LX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var BX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jX(e,t)}(o,e);var t,n,i,r=MX(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).table=null,e.lookupStatus=null,e.clearable=GV.Clearable.NEVER,e._addWidgetProperties(["table","filterBox"]),e}return t=o,(n=[{key:"_init",value:function(e){$X(LX(o.prototype),"_init",this).call(this,e),this.table.on("rowsChecked",this._onTableRowsChecked.bind(this)),this.table.setScrollTop(this.scrollTop)}},{key:"_initStructure",value:function(e){this.table||(this.table=this._createDefaultListBoxTable())}},{key:"_render",value:function(){$X(LX(o.prototype),"_render",this).call(this),this.$container.addClass("list-box")}},{key:"_createFieldContainerLayout",value:function(){return new JX(this,this.table,this.filterBox)}},{key:"_renderStructure",value:function(){this.table.render(this.$fieldContainer),this.addField(this.table.$container)}},{key:"_onTableRowsChecked",value:function(e){this._syncTableToValue()}},{key:"_syncTableToValue",value:function(){if(this.lookupCall&&!this._valueSyncing){this._valueSyncing=!0;var e=[];this.table.rows.forEach((function(t){t.checked&&e.push(t.lookupRow.key)}),this),this.setValue(e),this._valueSyncing=!1}}},{key:"_valueChanged",value:function(){$X(LX(o.prototype),"_valueChanged",this).call(this),this._syncValueToTable(this.value)}},{key:"_syncValueToTable",value:function(e){if(this.lookupCall&&!this._valueSyncing&&this.initialized){this._valueSyncing=!0;var t={checkOnlyEnabled:!1};try{if(et.empty(e))this.table.uncheckRows(this.table.rows,t);else{if(this._ensureLookupCallExecuted())return;var n=[];this.table.uncheckRows(this.table.rows,t),this.table.rows.forEach((function(t){et.containsAny(e,t.lookupRow.key)&&n.push(t)}),this),this.table.checkRows(n,t)}this._updateDisplayText()}finally{this._valueSyncing=!1}}}},{key:"_lookupByAllDone",value:function(e){$X(LX(o.prototype),"_lookupByAllDone",this).call(this,e)&&this._populateTable(e)}},{key:"_populateTable",value:function(e){var t=[];e.lookupRows.forEach((function(e){t.push(this._createTableRow(e))}),this),this.table.deleteAllRows(),this.table.insertRows(t),this._syncValueToTable(this.value)}},{key:"getCheckedLookupRows",value:function(){return null===this.value||et.empty(this.value)||0===this.table.rows.length?[]:this.table.rows.filter((function(e){return e.checked})).map((function(e){return e.lookupRow}))}},{key:"_createTableRow",value:function(e){var t=O.create("Cell",{text:e.text}),n={cells:[t],lookupRow:e};return e.iconId&&(t.iconId=e.iconId),e.tooltipText&&(t.tooltipText=e.tooltipText),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.foregroundColor&&(t.foregroundColor=e.foregroundColor),e.font&&(t.font=e.font),!1===e.enabled&&(n.enabled=!1),!1===e.active&&(n.active=!1),e.cssClass&&(n.cssClass=e.cssClass),n}},{key:"_createDefaultListBoxTable",value:function(){return O.create("Table",{parent:this,autoResizeColumns:!0,checkable:!0,checkableStyle:ZP.CheckableStyle.CHECKBOX_TABLE_ROW,headerVisible:!1,footerVisible:!1,columns:[{objectType:"Column"}]})}},{key:"getDelegateScrollable",value:function(){return this.table}}])&&AX(t.prototype,n),i&&AX(t,i),o}(WW);function NX(e){return(NX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HX(e,t){return(HX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zX(e);if(t){var r=zX(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return WX(this,n)}}function WX(e,t){return!t||"object"!==NX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zX(e){return(zX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var GX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HX(e,t)}(n,e);var t=VX(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(QV);function UX(e){return(UX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KX(e,t){return(KX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=XX(e);if(t){var r=XX(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return YX(this,n)}}function YX(e,t){return!t||"object"!==UX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XX(e){return(XX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var JX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KX(e,t)}(n,e);var t=qX(n);function n(e,i,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,i,r)}return n}(XW);function ZX(e,t,n){var i=O.create("Cell");return t&&t.propertyName?i.text=n[t.propertyName]:(i.text=e.text,e.iconId&&(i.iconId=e.iconId),e.tooltipText&&(i.tooltipText=e.tooltipText),e.backgroundColor&&(i.backgroundColor=e.backgroundColor),e.foregroundColor&&(i.foregroundColor=e.foregroundColor),e.font&&(i.font=e.font)),i}var QX={createTableCell:ZX,createTableRow:function(e,t){t=O.nvl(t,!1);var n=[],i={cells:n,lookupRow:e};return!1===e.enabled&&(i.enabled=!1),!1===e.active&&(i.active=!1),e.cssClass&&(i.cssClass=e.cssClass),t||n.push(ZX(e,null,null)),i}};function eJ(e){return(eJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tJ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nJ(e,t){return(nJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oJ(e);if(t){var r=oJ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rJ(this,n)}}function rJ(e,t){return!t||"object"!==eJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oJ(e){return(oJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nJ(e,t)}(o,e);var t,n,i,r=iJ(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"sendLookup",value:function(e,t){var n=e.toLowerCase(),i="lookupBy"+En.toUpperCaseFirstLetter(n),r={showBusyIndicator:!1};oi.isNullOrUndefined(t)||(r[n]=t),this._send(i,r)}}])&&tJ(t.prototype,n),i&&tJ(t,i),o}(QV);function aJ(e){return(aJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uJ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lJ(e,t){return(lJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=dJ(e);if(t){var r=dJ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fJ(this,n)}}function fJ(e,t){return!t||"object"!==aJ(t)&&"function"!=typeof t?hJ(e):t}function hJ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dJ(e){return(dJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lJ(e,t)}(o,e);var t,n,i,r=cJ(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["modeSelector","modes"]),e._modeSelectorPropertyChangeHandler=e._onModeSelectorPropertyChange.bind(hJ(e)),e}return t=o,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"mode-selector-field"),this.addLabel(),this.addStatus(),this.modeSelector&&(this._renderModeSelector(),this.modeSelector.on("propertyChange",this._modeSelectorPropertyChangeHandler))}},{key:"_renderModeSelector",value:function(){this.modeSelector.render(),this.addField(this.modeSelector.$container)}},{key:"_removeModeSelector",value:function(){this.modeSelector.remove(),this._removeField()}},{key:"_onModeSelectorPropertyChange",value:function(e){"selectedMode"===e.propertyName&&(e.newValue?this.setValue(e.newValue.ref):this.modeSelector.selectedMode&&this.modeSelector.selectedMode.id?this.setValue(this.modeSelector.selectedMode.id):this.setValue(null))}}])&&uJ(t.prototype,n),i&&uJ(t,i),o}(GV);function yJ(e){return(yJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vJ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bJ(e,t,n){return(bJ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wJ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function gJ(e,t){return(gJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=wJ(e);if(t){var r=wJ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _J(this,n)}}function _J(e,t){return!t||"object"!==yJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wJ(e){return(wJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gJ(e,t)}(o,e);var t,n,i,r=mJ(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_createWidget",value:function(e){return this._addModeSelector(e),bJ(wJ(o.prototype),"_createWidget",this).call(this,e)}},{key:"_addModeSelector",value:function(e){e.modeSelector={objectType:"ModeSelector"}}},{key:"_postCreateWidget",value:function(){this.widget.modeSelector.setModes(this.widget.modes),delete this.widget.modes}}])&&vJ(t.prototype,n),i&&vJ(t,i),o}(QV);function SJ(e){return(SJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OJ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function TJ(e,t,n){return(TJ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xJ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function CJ(e,t){return(CJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=xJ(e);if(t){var r=xJ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return RJ(this,n)}}function RJ(e,t){return!t||"object"!==SJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xJ(e){return(xJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var EJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CJ(e,t)}(o,e);var t,n,i,r=PJ(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).calc=new NJ,e.minValue=null,e.maxValue=null,e.decimalFormat=null,e.invalidValueMessageKey="InvalidNumberMessageX",e.gridDataHints.horizontalAlignment=1,e}return t=o,(n=[{key:"_init",value:function(e){TJ(xJ(o.prototype),"_init",this).call(this,e),this._setMinValue(this.minValue),this._setMaxValue(this.maxValue),this._setDecimalFormat(this.decimalFormat)}},{key:"_initValue",value:function(e){this._setDecimalFormat(this.decimalFormat),TJ(xJ(o.prototype),"_initValue",this).call(this,e)}},{key:"_createKeyStrokeContext",value:function(){return new Fu}},{key:"_render",value:function(){this.addContainer(this.$parent,"number-field"),this.addLabel(),this.addMandatoryIndicator();var e=gH.makeTextField(this.$parent);this.addField(e),this.addStatus()}},{key:"_renderGridData",value:function(){TJ(xJ(o.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_renderGridDataHints",value:function(){TJ(xJ(o.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_getDefaultFormat",value:function(e){return e.decimalFormatPatternDefault}},{key:"setDecimalFormat",value:function(e){this.setProperty("decimalFormat",e)}},{key:"_setDecimalFormat",value:function(e){e||(e=this._getDefaultFormat(this.session.locale)),e=Bf.ensure(this.session.locale,e),this._setProperty("decimalFormat",e),this.initialized&&this._updateDisplayText()}},{key:"_parseValue",value:function(e){return e?this.decimalFormat.parse(e,this._evaluateNumber.bind(this)):null}},{key:"_evaluateNumber",value:function(e){if(this.calc.isFormula(e)){var t=this.calc.evalFormula(e);if(isNaN(t))throw new Error(e+" is not a valid expression");return t}return Number(e)}},{key:"_ensureValue",value:function(e){return Gn.ensure(e)}},{key:"_validateValue",value:function(e){if(oi.isNullOrUndefined(e))return e;if(!Gn.isNumber(e))throw this.session.text(this.invalidValueMessageKey,e);return!oi.isNullOrUndefined(this.minValue)&&e<this.minValue&&this._onNumberTooSmall(),!oi.isNullOrUndefined(this.maxValue)&&e>this.maxValue&&this._onNumberTooLarge(),e}},{key:"_onNumberTooLarge",value:function(){if(oi.isNullOrUndefined(this.minValue))throw this.session.text("NumberTooLargeMessageX",this._formatValue(this.maxValue));throw this.session.text("NumberTooLargeMessageXY",this._formatValue(this.minValue),this._formatValue(this.maxValue))}},{key:"_onNumberTooSmall",value:function(){if(oi.isNullOrUndefined(this.maxValue))throw this.session.text("NumberTooSmallMessageX",this._formatValue(this.minValue));throw this.session.text("NumberTooSmallMessageXY",this._formatValue(this.minValue),this._formatValue(this.maxValue))}},{key:"_formatValue",value:function(e){return oi.isNullOrUndefined(e)?"":"number"!=typeof e?e+"":this.decimalFormat.format(e,!0)}},{key:"setMinValue",value:function(e){this.minValue!==e&&(this._setMinValue(e),this.validate())}},{key:"_setMinValue",value:function(e){this._setProperty("minValue",e),!oi.isNullOrUndefined(this.maxValue)&&!oi.isNullOrUndefined(this.minValue)&&e>this.maxValue&&this._setMaxValue(e)}},{key:"setMaxValue",value:function(e){this.maxValue!==e&&(this._setMaxValue(e),this.validate())}},{key:"_setMaxValue",value:function(e){this._setProperty("maxValue",e),!oi.isNullOrUndefined(this.maxValue)&&!oi.isNullOrUndefined(this.minValue)&&e<this.minValue&&this._setMinValue(e)}}])&&OJ(t.prototype,n),i&&OJ(t,i),o}(aW);function DJ(e){return(DJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FJ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AJ(e,t,n){return(AJ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=IJ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function $J(e,t){return($J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=IJ(e);if(t){var r=IJ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return MJ(this,n)}}function MJ(e,t){return!t||"object"!==DJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function IJ(e){return(IJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var LJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$J(e,t)}(o,e);var t,n,i,r=jJ(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,i=[{key:"modifyPrototype",value:function(){x.get().remote&&oi.replacePrototypeFunction(EJ,"clearErrorStatus",(function(){if(!this.modelAdapter)return this.clearErrorStatusOrig()}),!0)}}],(n=[{key:"_onWidgetParseError",value:function(e){e.preventDefault()}},{key:"_onWidgetEvent",value:function(e){"parseError"===e.type?this._onWidgetParseError(e):AJ(IJ(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&FJ(t.prototype,n),i&&FJ(t,i),o}(dW);function BJ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}x.addListener("bootstrap",LJ.modifyPrototype);var NJ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"isFormula",value:function(e){return e.match(/^[\d()+\-*/.]+$/)}},{key:"evalFormula",value:function(e){return this._tokens=e.split(/([\d.]+|\(|\)|[+\-*/])/).filter((function(e){return 0!==e.length})),this._expr()}},{key:"_next",value:function(){if(0!==this._tokens.length)return this._tokens[0]}},{key:"_consumeNext",value:function(){var e=this._tokens[0];return this._tokens=this._tokens.slice(1,this._tokens.length),e}},{key:"_expr",value:function(){return this._sum()}},{key:"_sum",value:function(){for(var e=this._prod();"+"===this._next()||"-"===this._next();)switch(this._consumeNext()){case"+":e+=this._prod();break;case"-":e-=this._prod()}return e}},{key:"_prod",value:function(){for(var e=this._unary();"*"===this._next()||"/"===this._next();)switch(this._consumeNext()){case"*":e*=this._unary();break;case"/":e/=this._unary()}return e}},{key:"_unary",value:function(){var e,t=1;return"+"===this._next()?this._consumeNext():"-"===this._next()&&(this._consumeNext(),t=-1),void 0!==(e=this._group())?t*e:t*(e=this._consumeNext())}},{key:"_group",value:function(){if("("===this._next()){this._consumeNext();var e=this._expr();if(")"!==this._next())throw"missing closing bracket";return this._consumeNext(),e}}}])&&BJ(t.prototype,n),i&&BJ(t,i),e}();function HJ(e){return(HJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VJ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function WJ(e,t,n){return(WJ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KJ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function zJ(e,t){return(zJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=KJ(e);if(t){var r=KJ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return UJ(this,n)}}function UJ(e,t){return!t||"object"!==HJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KJ(e){return(KJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qJ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var YJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zJ(e,t)}(o,e);var t,n,i,r=GJ(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).minValue=o.MIN_VALUE,e.maxValue=o.MAX_VALUE,e}return t=o,(n=[{key:"_getDefaultFormat",value:function(e){return"#,##0"}},{key:"_parseValue",value:function(e){var t=WJ(KJ(o.prototype),"_parseValue",this).call(this,e);return oi.isNullOrUndefined(t)?null:this.decimalFormat.round(t,!1)}}])&&VJ(t.prototype,n),i&&VJ(t,i),o}(EJ);function XJ(e){return(XJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JJ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZJ(e,t){return(ZJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=tZ(e);if(t){var r=tZ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return eZ(this,n)}}function eZ(e,t){return!t||"object"!==XJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tZ(e){return(tZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}qJ(YJ,"MIN_VALUE",Number.MIN_SAFE_INTEGER),qJ(YJ,"MAX_VALUE",Number.MAX_SAFE_INTEGER);var nZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZJ(e,t)}(o,e);var t,n,i,r=QJ(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"placeholder-field"),this.addLabel()}},{key:"_renderLabel",value:function(){this._renderEmptyLabel()}}])&&JJ(t.prototype,n),i&&JJ(t,i),o}(GH);function iZ(e){return(iZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rZ(e,t){return(rZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=aZ(e);if(t){var r=aZ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sZ(this,n)}}function sZ(e,t){return!t||"object"!==iZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aZ(e){return(aZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rZ(e,t)}(n,e);var t=oZ(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function lZ(e){return(lZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fZ(e,t){return(fZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pZ(e);if(t){var r=pZ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dZ(this,n)}}function dZ(e,t){return!t||"object"!==lZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pZ(e){return(pZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fZ(e,t)}(o,e);var t,n,i,r=hZ(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["planner"]),e.gridDataHints.weightY=1,e}return t=o,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"planner-field"),this.addLabel(),this.addStatus(),this.planner&&this._renderPlanner()}},{key:"_renderPlanner",value:function(){this.planner.render(),this.addField(this.planner.$container)}},{key:"_removePlanner",value:function(){this.planner.remove(),this._removeField()}}])&&cZ(t.prototype,n),i&&cZ(t,i),o}(GH);function vZ(e){return(vZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bZ(e,t){return(bZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_Z(e);if(t){var r=_Z(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return mZ(this,n)}}function mZ(e,t){return!t||"object"!==vZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _Z(e){return(_Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bZ(e,t)}(n,e);var t=gZ(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function kZ(e){return(kZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OZ(e,t,n){return(OZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xZ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function TZ(e,t){return(TZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function CZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=xZ(e);if(t){var r=xZ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return PZ(this,n)}}function PZ(e,t){return!t||"object"!==kZ(t)&&"function"!=typeof t?RZ(e):t}function RZ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xZ(e){return(xZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var EZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TZ(e,t)}(o,e);var t,n,i,r=CZ(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).gridDataHints.fillHorizontal=!0,e.focusWhenSelected=!0,e.wrapText=!1,e.buttonKeyStroke=new GQ(RZ(e),null),e.radioValue=null,e}return t=o,(n=[{key:"_initDefaultKeyStrokes",value:function(){this.keyStrokeContext.registerKeyStroke([new GQ(this,"ENTER"),new GQ(this,"SPACE")])}},{key:"_render",value:function(){this.addContainer(this.$parent,"radio-button",new LZ(this)),this.addFieldContainer(this.$parent.makeDiv()),this.$radioButton=this.$fieldContainer.appendDiv("radio-button-circle").data("radiobutton",this),this.addField(this.$radioButton),this.$buttonLabel=this.$fieldContainer.appendDiv("label"),gH.linkElementWithLabel(this.$radioButton,this.$buttonLabel),this.$fieldContainer.on("mousedown",this._onMouseDown.bind(this)),dh.installForEllipsis(this.$buttonLabel,{parent:this}),this.addStatus(),this.session.keyStrokeManager.installKeyStrokeContext(this.formKeyStrokeContext)}},{key:"_remove",value:function(){dh.uninstall(this.$buttonLabel),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.formKeyStrokeContext),OZ(xZ(o.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){OZ(xZ(o.prototype),"_renderProperties",this).call(this),this._renderWrapText(),this._renderSelected()}},{key:"setWrapText",value:function(e){this.setProperty("wrapText",e)}},{key:"_renderWrapText",value:function(){this.$buttonLabel.toggleClass("white-space-nowrap",!this.wrapText),this.invalidateLayoutTree()}},{key:"select",value:function(){this.setSelected(!0)}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$fieldContainer.toggleClass("checked",this.selected),this.$field.toggleClass("checked",this.selected)}},{key:"setTabbable",value:function(e){this.rendered&&this.$field.setTabbable(e&&!Mt.get().supportsOnlyTouch())}},{key:"isTabbable",value:function(){return this.rendered&&this.$field.isTabbable()}},{key:"_renderIconId",value:function(){OZ(xZ(o.prototype),"_renderIconId",this).call(this);var e=this.get$Icon();e.length>0&&e.insertAfter(this.$radioButton)}},{key:"doAction",value:function(){return!(!this.enabledComputed||!this.visible||(this.select(),0))}},{key:"_onMouseDown",value:function(e){if(this.enabledComputed){var t=this.get$Icon().is(e.target),n=this.$radioButton.is(e.target),i=this.$buttonLabel.isOrHas(e.target);(n||i||t)&&(this.select(),this.focusWhenSelected&&(i||t)&&this.focusAndPreventDefault(e))}}}])&&SZ(t.prototype,n),i&&SZ(t,i),o}(WG);function DZ(e){return(DZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AZ(e,t,n){return(AZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=IZ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function $Z(e,t){return($Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=IZ(e);if(t){var r=IZ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return MZ(this,n)}}function MZ(e,t){return!t||"object"!==DZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function IZ(e){return(IZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var LZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$Z(e,t)}(o,e);var t,n,i,r=jZ(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).radioButton=e,t}return t=o,(n=[{key:"layout",value:function(e){AZ(IZ(o.prototype),"layout",this).call(this,e);var t=this.radioButton.get$Icon(),n=this.radioButton.$radioButton,i=this.radioButton.$buttonLabel,r=this.radioButton.$fieldContainer.width()-(n.outerWidth(!0)+(t.length?t.outerWidth(!0):0));i.css("max-width",r)}}])&&FZ(t.prototype,n),i&&FZ(t,i),o}(JG);function BZ(e){return(BZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NZ(e,t){return(NZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function HZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=WZ(e);if(t){var r=WZ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return VZ(this,n)}}function VZ(e,t){return!t||"object"!==BZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function WZ(e){return(WZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NZ(e,t)}(n,e);var t=HZ(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["selected"]),e}return n}(oU);function GZ(e){return(GZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function KZ(e,t,n){return(KZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ZZ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function qZ(e,t){return(qZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ZZ(e);if(t){var r=ZZ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return XZ(this,n)}}function XZ(e,t){return!t||"object"!==GZ(t)&&"function"!=typeof t?JZ(e):t}function JZ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZZ(e){return(ZZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QZ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qZ(e,t)}(o,e);var t,n,i,r=YZ(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).logicalGrid=O.create("scout.HorizontalGrid"),e.layoutConfig=null,e.fields=[],e.radioButtons=[],e.gridColumnCount=o.DEFAULT_GRID_COLUMN_COUNT,e.selectedButton=null,e.$body=null,e.lookupStatus=null,e.lookupCall=null,e._lookupExecuted=!1,e._selectButtonLocked=!1,e._pendingLookup=null,e._lookupInProgress=!1,e._currentLookupCall=null,e._addWidgetProperties(["fields"]),e._addCloneProperties(["lookupCall","layoutConfig","gridColumnCount"]),e._buttonPropertyChangeHandler=e._onButtonPropertyChange.bind(JZ(e)),e}return t=o,(n=[{key:"_init",value:function(e){KZ(ZZ(o.prototype),"_init",this).call(this,e),this._setLayoutConfig(this.layoutConfig),this._setGridColumnCount(this.gridColumnCount)}},{key:"_initValue",value:function(e){this.lookupCall&&this._setLookupCall(this.lookupCall),this._setFields(this.fields),KZ(ZZ(o.prototype),"_initValue",this).call(this,e)}},{key:"_initKeyStrokeContext",value:function(){KZ(ZZ(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new EQ(this),new IQ(this)])}},{key:"_initButtons",value:function(){this.radioButtons=this.fields.filter((function(e){return e instanceof EZ})),this.radioButtons.forEach(this._initButton.bind(this))}},{key:"_initButton",value:function(e){0===e.events.count("propertyChange",this._buttonPropertyChangeHandler)&&e.on("propertyChange",this._buttonPropertyChangeHandler),e.selected&&(this.setValue(e.radioValue),this.selectButton(e),e.focused&&this.setFocused(!0))}},{key:"_render",value:function(){this.addContainer(this.$parent,"radiobutton-group"),this.addLabel(),this.addMandatoryIndicator(),this.$body=this.$container.appendDiv("radiobutton-group-body"),this.htmlBody=Uo.install(this.$body,this.session),this.htmlBody.setLayout(this._createBodyLayout()),this.addField(this.$body),this.addStatus()}},{key:"_renderProperties",value:function(){KZ(ZZ(o.prototype),"_renderProperties",this).call(this),this._renderFields(),this._renderLayoutConfig()}},{key:"_createBodyLayout",value:function(){return new SQ(this,this.layoutConfig)}},{key:"_setLogicalGrid",value:function(e){KZ(ZZ(o.prototype),"_setLogicalGrid",this).call(this,e),this.logicalGrid&&this.logicalGrid.setGridConfig(new yQ)}},{key:"invalidateLogicalGrid",value:function(e){KZ(ZZ(o.prototype),"invalidateLogicalGrid",this).call(this,!1),O.nvl(e,!0)&&this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"setLayoutConfig",value:function(e){this.setProperty("layoutConfig",e)}},{key:"_setLayoutConfig",value:function(e){e||(e=new fs),this._setProperty("layoutConfig",fs.ensure(e))}},{key:"_renderLayoutConfig",value:function(){this.layoutConfig.applyToLayout(this.htmlBody.layout),this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"isClearable",value:function(){return!1}},{key:"getFields",value:function(){return this.fields}},{key:"visitFields",value:function(e){var t=KZ(ZZ(o.prototype),"visitFields",this).call(this,e);if(t===JW.TERMINATE)return JW.TERMINATE;if(t!==JW.SKIP_SUBTREE)for(var n=this.getFields(),i=0;i<n.length;i++)if((t=n[i].visitFields(e))===JW.TERMINATE)return JW.TERMINATE}},{key:"getFocusableElement",value:function(){return this.session.focusManager.findFirstFocusableElement(this.$container)}},{key:"setFields",value:function(e){this.setProperty("fields",e)}},{key:"_setFields",value:function(e){this._setProperty("fields",e),this._initButtons()}},{key:"_renderFields",value:function(){this._ensureLookupCallExecuted(),this.fields.forEach((function(e){e.render(this.$body),e.setLayoutData(new ts(e)),this._linkWithLabel(e.$field)}),this),this._provideTabIndex(),this.invalidateLogicalGrid(),this.validateLayoutTree()}},{key:"_renderEnabled",value:function(){KZ(ZZ(o.prototype),"_renderEnabled",this).call(this),this._provideTabIndex()}},{key:"_provideTabIndex",value:function(){var e;this.radioButtons.forEach((function(t){t.enabledComputed&&this.enabledComputed&&!e?(t.setTabbable(!0),e=t):e&&this.enabledComputed&&t.enabledComputed&&t.selected?(e.setTabbable(!1),t.setTabbable(!0),e=t):t.setTabbable(!1)}),this)}},{key:"setGridColumnCount",value:function(e){this.setProperty("gridColumnCount",e)}},{key:"_setGridColumnCount",value:function(e){return e<0&&(e=this._calcDefaultGridColumnCount()),e!==this.gridColumnCount&&(this._setProperty("gridColumnCount",e),this.invalidateLogicalGrid(),!0)}},{key:"_calcDefaultGridColumnCount",value:function(){var e=1,t=this.gridDataHints;return t&&t.h>1&&(e=t.h),Math.ceil(this.fields.length/e)}},{key:"getButtonForRadioValue",value:function(e){return null===e?null:et.find(this.radioButtons,(function(t){return oi.equals(t.radioValue,e)}))}},{key:"_validateValue",value:function(e){if(KZ(ZZ(o.prototype),"_validateValue",this).call(this,e),!this.initialized&&this.lookupCall)return e;if(this._ensureLookupCallExecuted())return e;if(!this.getButtonForRadioValue(e)&&null!=e&&!this._lookupInProgress)throw this.session.text("InvalidValueMessageX",e);return e}},{key:"_valueChanged",value:function(){KZ(ZZ(o.prototype),"_valueChanged",this).call(this),(null!==this.value||this.initialized)&&this.selectButton(this.getButtonForRadioValue(this.value))}},{key:"selectFirstButton",value:function(){this.selectButtonByIndex(0)}},{key:"selectLastButton",value:function(){this.selectButtonByIndex(this.radioButtons.length-1)}},{key:"selectButtonByIndex",value:function(e){this.radioButtons.length&&e>=0&&e<this.radioButtons.length&&this.selectButton(this.radioButtons[e])}},{key:"selectButton",value:function(e){if(this.selectedButton!==e&&!this._selectButtonLocked){if(this._selectButtonLocked=!0,this.selectedButton&&this.selectedButton.setSelected(!1),e){var t=this.getTabbableButton(),n=!1;t&&(n=t.isFocused()),e.setSelected(!0),e.setTabbable(!0),n&&e.focus(),t&&t!==e&&t.setTabbable(!1)}this._selectButtonLocked=!1,this.setProperty("selectedButton",e)}}},{key:"getTabbableButton",value:function(){return et.find(this.radioButtons,(function(e){return e.visible&&e.isTabbable()}))}},{key:"insertButton",value:function(e){var t=this.fields.slice();t.push(e),this.setFields(t)}},{key:"_onButtonPropertyChange",value:function(e){"selected"===e.propertyName?e.newValue?(this.setValue(e.source.radioValue),this.selectButton(e.source)):e.source===this.selectedButton&&this.selectButton(null):"focused"===e.propertyName&&this.setFocused(e.newValue)}},{key:"_setLookupCall",value:function(e){this._setProperty("lookupCall",ur.ensure(e,this.session)),this._lookupExecuted=!1,this.rendered&&this._ensureLookupCallExecuted()}},{key:"_ensureLookupCallExecuted",value:function(){return!!this.lookupCall&&!this._lookupExecuted&&(this._lookupByAll(),!0)}},{key:"_createLoadingSupport",value:function(){return new te({widget:this,$container:function(){return this.$body}.bind(this)})}},{key:"_lookupByAll",value:function(){if(this.lookupCall){this._clearPendingLookup();var e=s.a.Deferred(),t=function(t){this._lookupByAllDone(t),e.resolve(t)}.bind(this);return this._executeLookup(this.lookupCall.cloneForAll(),!0).done(t),e.promise()}}},{key:"_clearPendingLookup",value:function(){this._pendingLookup&&(clearTimeout(this._pendingLookup),this._pendingLookup=null)}},{key:"_executeLookup",value:function(e,t){return t&&this._currentLookupCall&&this._currentLookupCall.abort(),this._lookupInProgress=!0,this.setLoading(!0),this._currentLookupCall=e,this.trigger("prepareLookupCall",{lookupCall:e}),e.execute().always(function(){this._lookupInProgress=!1,this._lookupExecuted=!0,this._currentLookupCall=null,this.setLoading(!1),this._clearLookupStatus()}.bind(this))}},{key:"_lookupByAllDone",value:function(e){try{if(e.exception)return void this.setErrorStatus(pi.error({message:e.exception}));if(0===e.lookupRows.length)return void this.setLookupStatus(pi.warning({message:this.session.text("SmartFieldNoDataFound"),code:o.ErrorCode.NO_DATA}));this._populateRadioButtonGroup(e)}finally{this.trigger("lookupCallDone",{result:e})}}},{key:"_populateRadioButtonGroup",value:function(e){var t=e.lookupRows,n=this.fields.slice();t.forEach((function(e){n.push(this._createLookupRowRadioButton(e))}),this),this.setFields(n),this.setValue(this.value),this.selectButton(this.getButtonForRadioValue(this.value))}},{key:"_clearLookupStatus",value:function(){this.setLookupStatus(null)}},{key:"setLookupStatus",value:function(e){this.setProperty("lookupStatus",e),this.rendered&&this._renderErrorStatus()}},{key:"_errorStatus",value:function(){return this.lookupStatus||this.errorStatus}},{key:"_createLookupRowRadioButton",value:function(e){var t={parent:this,label:e.text,radioValue:e.key,lookupRow:e};return e.iconId&&(t.iconId=e.iconId),e.tooltipText&&(t.tooltipText=e.tooltipText),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.foregroundColor&&(t.foregroundColor=e.foregroundColor),e.font&&(t.font=e.font),!1===e.enabled&&(t.enabled=!1),!1===e.active&&(t.visible=!1),e.cssClass&&(t.cssClass=e.cssClass),O.create("RadioButton",t)}},{key:"clone",value:function(e,t){var n=KZ(ZZ(o.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,"fields",t),n._initButtons(),n}}])&&UZ(t.prototype,n),i&&UZ(t,i),o}(GV);function tQ(e){return(tQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nQ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iQ(e,t,n){return(iQ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aQ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function rQ(e,t){return(rQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=aQ(e);if(t){var r=aQ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sQ(this,n)}}function sQ(e,t){return!t||"object"!==tQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aQ(e){return(aQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}QZ(eQ,"DEFAULT_GRID_COLUMN_COUNT",-1),QZ(eQ,"ErrorCode",{NO_DATA:1});var uQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rQ(e,t)}(o,e);var t,n,i,r=oQ(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_initModel",value:function(e,t){return(e=iQ(aQ(o.prototype),"_initModel",this).call(this,e,t)).logicalGrid=null,e}}])&&nQ(t.prototype,n),i&&nQ(t,i),o}(QV);function lQ(e){return(lQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cQ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fQ(e,t){return(fQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pQ(e);if(t){var r=pQ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dQ(this,n)}}function dQ(e,t){return!t||"object"!==lQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pQ(e){return(pQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fQ(e,t)}(o,e);var t,n,i,r=hQ(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"getGridColumnCount",value:function(){return this.widget.gridColumnCount}},{key:"getGridWidgets",value:function(){return this.widget.fields}}])&&cQ(t.prototype,n),i&&cQ(t,i),o}(Qo);function vQ(e){return(vQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bQ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gQ(e,t,n){return(gQ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kQ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function mQ(e,t){return(mQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=kQ(e);if(t){var r=kQ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wQ(this,n)}}function wQ(e,t){return!t||"object"!==vQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kQ(e){return(kQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var SQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mQ(e,t)}(o,e);var t,n,i,r=_Q(o);function o(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e,t)}return t=o,(n=[{key:"_initDefaults",value:function(){gQ(kQ(o.prototype),"_initDefaults",this).call(this),this.hgap=Vo.get().smallColumnGap}}])&&bQ(t.prototype,n),i&&bQ(t,i),o}(ls);function OQ(e){return(OQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TQ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function CQ(e,t){return(CQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=xQ(e);if(t){var r=xQ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return RQ(this,n)}}function RQ(e,t){return!t||"object"!==OQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xQ(e){return(xQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var EQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CQ(e,t)}(o,e);var t,n,i,r=PQ(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.LEFT],t.renderingHints.render=!1,t}return t=o,(n=[{key:"handle",value:function(e){var t,n=s()(e.target).data("radiobutton");this.field.radioButtons.some((function(e){return t&&e===n?(t.select(),t.focus(),!0):(e.enabledComputed&&e.visible&&(t=e),!1)}),this)}}])&&TQ(t.prototype,n),i&&TQ(t,i),o}($u);function DQ(e){return(DQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FQ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AQ(e,t){return(AQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=MQ(e);if(t){var r=MQ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jQ(this,n)}}function jQ(e,t){return!t||"object"!==DQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MQ(e){return(MQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var IQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AQ(e,t)}(o,e);var t,n,i,r=$Q(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.RIGHT],t.renderingHints.render=!1,t}return t=o,(n=[{key:"handle",value:function(e){var t,n=s()(e.target).data("radiobutton");this.field.radioButtons.some((function(e){return t&&e.enabledComputed&&e.visible?(e.select(),e.focus(),!0):(e===n&&e.enabledComputed&&e.visible&&(t=e),!1)}),this)}}])&&FQ(t.prototype,n),i&&FQ(t,i),o}($u);function LQ(e){return(LQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BQ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function NQ(e,t,n){return(NQ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zQ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function HQ(e,t){return(HQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zQ(e);if(t){var r=zQ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return WQ(this,n)}}function WQ(e,t){return!t||"object"!==LQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zQ(e){return(zQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var GQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HQ(e,t)}(o,e);var t,n,i,r=VQ(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).renderingHints.hAlign=Ni.LEFT,n}return t=o,(n=[{key:"_accept",value:function(e){return NQ(zQ(o.prototype),"_accept",this).call(this,e)&&!this.field.selected}}])&&BQ(t.prototype,n),i&&BQ(t,i),o}(pU);function UQ(e){return(UQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KQ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qQ(e,t,n){return(qQ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ZQ(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function YQ(e,t){return(YQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ZQ(e);if(t){var r=ZQ(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return JQ(this,n)}}function JQ(e,t){return!t||"object"!==UQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZQ(e){return(ZQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var QQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YQ(e,t)}(o,e);var t,n,i,r=XQ(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties("fields"),e._addCloneProperties(["layoutConfig"]),e.logicalGrid=O.create("scout.HorizontalGrid"),e.layoutConfig=null,e.fields=[],e}return t=o,(n=[{key:"_init",value:function(e){qQ(ZQ(o.prototype),"_init",this).call(this,e),this._setLayoutConfig(this.layoutConfig),this._initDateFields(),this.setErrorStatus(this.errorStatus),this.setTooltipText(this.tooltipText),this.setMenus(this.menus),this.setMenusVisible(this.menusVisible)}},{key:"_initDateFields",value:function(){for(var e=this._getDateFields(),t=null,n=0;n<e.length;n++){var i=e[n];i.autoDate&&(i.hasModelAutoDateSet=!0),i.hasModelAutoDateSet||i.setAutoDate(t),t=this._getAutoDateProposal(i)}}},{key:"_render",value:function(){var e,t;for(this.addContainer(this.$parent,"sequence-box"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus(),this._handleStatus(),this.htmlBody=Uo.install(this.$field,this.session),this.htmlBody.setLayout(this._createBodyLayout()),t=0;t<this.fields.length;t++)(e=this.fields[t]).labelUseUiWidth=!0,e.on("propertyChange",this._onFieldPropertyChange.bind(this)),e.render(this.$field),this._modifyLabel(e),e.setLayoutData(new ts(e))}},{key:"_renderProperties",value:function(){qQ(ZQ(o.prototype),"_renderProperties",this).call(this),this._renderLayoutConfig()}},{key:"_createBodyLayout",value:function(){return new p0(this,this.layoutConfig)}},{key:"invalidateLogicalGrid",value:function(e){qQ(ZQ(o.prototype),"invalidateLogicalGrid",this).call(this,!1),O.nvl(e,!0)&&this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"_setLogicalGrid",value:function(e){qQ(ZQ(o.prototype),"_setLogicalGrid",this).call(this,e),this.logicalGrid&&this.logicalGrid.setGridConfig(new s0)}},{key:"setLayoutConfig",value:function(e){this.setProperty("layoutConfig",e)}},{key:"_setLayoutConfig",value:function(e){e||(e=new fs),this._setProperty("layoutConfig",fs.ensure(e))}},{key:"_renderLayoutConfig",value:function(){this.layoutConfig.applyToLayout(this.htmlBody.layout),this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"_onFieldPropertyChange",value:function(e){var t="visible"===e.propertyName;O.isOneOf(e.propertyName,["errorStatus","tooltipText","visible","menus","menusVisible"])&&this._handleStatus(t),"value"===e.propertyName&&this._onFieldValueChange(e)}},{key:"_handleStatus",value:function(e){e&&this._lastVisibleField&&(this._lastVisibleField.suppressStatus=!1,this._lastVisibleField.rendered&&(this._lastVisibleField._renderErrorStatus(),this._lastVisibleField._renderTooltipText(),this._lastVisibleField._renderMenus())),this._lastVisibleField=this._getLastVisibleField(),this._lastVisibleField&&(this._isOverwritingStatusFromField=!0,this._lastVisibleField.errorStatus?(this.setErrorStatus(this._lastVisibleField.errorStatus),this._isErrorStatusOverwritten=!0):(this.setErrorStatus(this.boxErrorStatus),this._isErrorStatusOverwritten=!1),this._lastVisibleField.hasStatusTooltip()?(this.setTooltipText(this._lastVisibleField.tooltipText),this._isTooltipTextOverwritten=!0):(this.setTooltipText(this.boxTooltipText),this._isTooltipTextOverwritten=!1),this._lastVisibleField.menus&&this._lastVisibleField.menus.length>0?(this._updateBoxMenuOwner(this.fieldStatus),this.setMenus(this._lastVisibleField.menus),this.setMenusVisible(this._lastVisibleField.menusVisible),this._isMenusOverwritten=!0):(this._updateBoxMenuOwner(this),this.setMenus(this.boxMenus),this.setMenusVisible(this.boxMenusVisible),this._isMenusOverwritten=!1),this._isOverwritingStatusFromField=!1,this._lastVisibleField.suppressStatus=!0,e&&this._lastVisibleField.rendered&&(this._lastVisibleField._renderErrorStatus(),this._lastVisibleField._renderTooltipText(),this._lastVisibleField._renderMenus()))}},{key:"setErrorStatus",value:function(e){this._isOverwritingStatusFromField&&!this._isErrorStatusOverwritten?this.boxErrorStatus=this.errorStatus:this._isOverwritingStatusFromField||(this.boxErrorStatus=e),!this._isOverwritingStatusFromField&&this._isErrorStatusOverwritten||qQ(ZQ(o.prototype),"setErrorStatus",this).call(this,e)}},{key:"setTooltipText",value:function(e){this._isOverwritingStatusFromField&&!this._isTooltipTextOverwritten?this.boxTooltipText=this.tooltipText:this._isOverwritingStatusFromField||(this.boxTooltipText=e),!this._isOverwritingStatusFromField&&this._isTooltipTextOverwritten||qQ(ZQ(o.prototype),"setTooltipText",this).call(this,e)}},{key:"setMenus",value:function(e){e=this._createChildren(e),this._isOverwritingStatusFromField&&!this._isMenusOverwritten?this.boxMenus=this.menus:this._isOverwritingStatusFromField||(this.boxMenus=e),!this._isOverwritingStatusFromField&&this._isMenusOverwritten||qQ(ZQ(o.prototype),"setMenus",this).call(this,e)}},{key:"_updateBoxMenuOwner",value:function(e){this.boxMenus.forEach((function(t){t.setOwner(e)}))}},{key:"setMenusVisible",value:function(e){this._isOverwritingStatusFromField&&!this._isMenusOverwritten?this.boxMenusVisible=this.menusVisible:this._isOverwritingStatusFromField||(this.boxMenusVisible=e),!this._isOverwritingStatusFromField&&this._isMenusOverwritten||qQ(ZQ(o.prototype),"setMenusVisible",this).call(this,e)}},{key:"_getLastVisibleField",value:function(){var e=this.fields.filter((function(e){return e.visible}));if(0!==e.length)return e[e.length-1]}},{key:"_onFieldValueChange",value:function(e){e.source instanceof BK&&this._onDateFieldValueChange(e)}},{key:"_onDateFieldValueChange",value:function(e){for(var t=e.source,n=this._getDateFields(),i=this._getAutoDateProposal(t),r=n.indexOf(t)+1;r<n.length;r++){var o=n[r];if(o.hasModelAutoDateSet||o.setAutoDate(i),o.value)break}}},{key:"_getDateFields",value:function(){return this.fields.filter((function(e){return e instanceof BK}))}},{key:"_getAutoDateProposal",value:function(e){var t=null;return e&&e.value&&(t=!e.hasDate&&e.hasTime?wt.shiftTime(e.value,1,0,0):wt.shift(e.value,0,0,1)),t}},{key:"_modifyLabel",value:function(e){e instanceof WU&&(e.labelVisible=!1),e instanceof BK?(e.$dateField&&this._linkWithLabel(e.$dateField),e.$timeField&&this._linkWithLabel(e.$timeField)):e.$field&&this._linkWithLabel(e.$field)}},{key:"setFields",value:function(e){if(this.rendered)throw new Error("Setting fields is not supported if sequence box is already rendered.");this.setProperty("fields",e)}},{key:"getFields",value:function(){return this.fields}},{key:"clone",value:function(e,t){var n=qQ(ZQ(o.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,"fields",t),n}}])&&KQ(t.prototype,n),i&&KQ(t,i),o}(EV);function e0(e){return(e0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t0(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n0(e,t){return(n0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=o0(e);if(t){var r=o0(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return r0(this,n)}}function r0(e,t){return!t||"object"!==e0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o0(e){return(o0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n0(e,t)}(o,e);var t,n,i,r=i0(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"getGridColumnCount",value:function(){return this.widget.fields.length}},{key:"getGridWidgets",value:function(){return this.widget.fields}}])&&t0(t.prototype,n),i&&t0(t,i),o}(Qo);function a0(e){return(a0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u0(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l0(e,t,n){return(l0="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d0(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function c0(e,t){return(c0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d0(e);if(t){var r=d0(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h0(this,n)}}function h0(e,t){return!t||"object"!==a0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d0(e){return(d0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c0(e,t)}(o,e);var t,n,i,r=f0(o);function o(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e,t)}return t=o,(n=[{key:"_initDefaults",value:function(){l0(d0(o.prototype),"_initDefaults",this).call(this),this.hgap=Vo.get().smallColumnGap}}])&&u0(t.prototype,n),i&&u0(t,i),o}(ls);function y0(e){return(y0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v0(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function b0(e,t,n){return(b0="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w0(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function g0(e,t){return(g0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w0(e);if(t){var r=w0(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _0(this,n)}}function _0(e,t){return!t||"object"!==y0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w0(e){return(w0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g0(e,t)}(o,e);var t,n,i,r=m0(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_initModel",value:function(e,t){return(e=b0(w0(o.prototype),"_initModel",this).call(this,e,t)).logicalGrid=null,e}}])&&v0(t.prototype,n),i&&v0(t,i),o}(MV);function S0(e){return(S0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O0(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function T0(e,t,n){return(T0="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x0(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function C0(e,t){return(C0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=x0(e);if(t){var r=x0(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return R0(this,n)}}function R0(e,t){return!t||"object"!==S0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x0(e){return(x0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C0(e,t)}(o,e);var t,n,i,r=P0(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).slider,e}return t=o,(n=[{key:"_init",value:function(e){T0(x0(o.prototype),"_init",this).call(this,e);var t=s.a.extend({parent:this},e);this.slider=O.create("Slider",t)}},{key:"_render",value:function(){this.addContainer(this.$parent,"slider-field"),this.addLabel(),this.addMandatoryIndicator(),this._renderSlider()}},{key:"_renderSlider",value:function(){this.slider.render(),this.addField(this.slider.$container)}},{key:"_readDisplayText",value:function(){return String(this.slider.value)}},{key:"_parseValue",value:function(e){return Number(e)}},{key:"setValue",value:function(e){this.slider.setValue(e)}},{key:"getValue",value:function(){return this.slider.value}}])&&O0(t.prototype,n),i&&O0(t,i),o}(GV);function D0(e){return(D0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F0(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function A0(e,t,n){return(A0="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I0(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function $0(e,t){return($0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=I0(e);if(t){var r=I0(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return M0(this,n)}}function M0(e,t){return!t||"object"!==D0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I0(e){return(I0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L0(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$0(e,t)}(o,e);var t,n,i,r=j0(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).popup=null,e.lookupCall=null,e.codeType=null,e._pendingLookup=null,e._pendingOpenPopup=!1,e._tabPrevented=null,e.lookupRow=null,e.browseHierarchy=!1,e.browseMaxRowCount=o.DEFAULT_BROWSE_MAX_COUNT,e.browseAutoExpandAll=!0,e.browseLoadIncremental=!1,e.searchRequired=!1,e.activeFilterEnabled=!1,e.activeFilter=null,e.activeFilterLabels=[],e.columnDescriptors=null,e.displayStyle=o.DisplayStyle.DEFAULT,e.touchMode=!1,e.embedded=!1,e._userWasTyping=!1,e._acceptInputEnabled=!0,e._acceptInputDeferred=s.a.Deferred(),e._notUnique=!1,e._lastSearchText=null,e.lookupStatus=null,e._currentLookupCall=null,e.lookupSeqNo=0,e.initActiveFilter=null,e.disabledCopyOverlay=!0,e._addCloneProperties(["lookupRow","codeType","lookupCall","activeFilter","activeFilterEnabled","activeFilterLabels","browseHierarchy","browseMaxRowCount","browseAutoExpandAll","browseLoadIncremental","searchRequired","columnDescriptors","displayStyle"]),e}return t=o,(n=[{key:"_init",value:function(e){A0(I0(o.prototype),"_init",this).call(this,e),0===this.activeFilterLabels.length&&(this.activeFilterLabels=[this.session.text("ui.All"),this.session.text("ui.Inactive"),this.session.text("ui.Active")]),gH.initTouch(this,e)}},{key:"_initValue",value:function(e){this._setLookupCall(this.lookupCall),this._setCodeType(this.codeType),this._setLookupRow(this.lookupRow),A0(I0(o.prototype),"_initValue",this).call(this,e)}},{key:"markAsSaved",value:function(){A0(I0(o.prototype),"markAsSaved",this).call(this),this.setInitActiveFilter(this.activeFilter)}},{key:"resetValue",value:function(){A0(I0(o.prototype),"resetValue",this).call(this),this.setActiveFilter(this.initActiveFilter)}},{key:"_createKeyStrokeContext",value:function(){return new Fu}},{key:"_initKeyStrokeContext",value:function(){A0(I0(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new c1(this))}},{key:"_render",value:function(){this.addContainer(this.$parent,"has-icon "+this.cssClassName(),new t1(this)),this.addLabel();var e=(this.isDropdown()?gH.makeInputDiv:gH.makeInputOrDiv).call(O.fields,this).on("mousedown",this._onFieldMouseDown.bind(this));this.touchMode||e.keyup(this._onFieldKeyUp.bind(this)).keydown(this._onFieldKeyDown.bind(this)).on("input",this._onFieldInput.bind(this)),this.addField(e),this.embedded||this.addMandatoryIndicator(),this.addIcon(),this.$icon.addClass("needsclick"),this.addStatus()}},{key:"_renderGridData",value:function(){A0(I0(o.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!this.browseHierarchy})}},{key:"_renderGridDataHints",value:function(){A0(I0(o.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!this.browseHierarchy})}},{key:"cssClassName",value:function(){var e=this.displayStyle;return this.displayStyle===o.DisplayStyle.DEFAULT&&(e="smart"),e+"-field"}},{key:"_readSearchText",value:function(){var e=this._readDisplayText(),t=O.nvl(this.displayText,"").split("\n");return 1===t.length||En.empty(e)?e:(t.shift(),et.insert(t,e,0),En.join("\n",t))}},{key:"_readDisplayText",value:function(){return gH.valOrText(this.$field)}},{key:"_renderDisplayText",value:function(){var e=O.nvl(this.displayText,""),t=e.split("\n");t.length&&(e=t[0]),gH.valOrText(this.$field,e),A0(I0(o.prototype),"_renderDisplayText",this).call(this)}},{key:"acceptInput",value:function(e){if(!this._acceptInputEnabled)return s.a.log.isTraceEnabled()&&s.a.log.trace("(SmartField#acceptInput) Skipped acceptInput because _acceptInputEnabled=false"),this._acceptInputDeferred.promise();this._acceptInputEnabled=!1,setTimeout(function(){this._acceptInputEnabled=!0}.bind(this));var t=this._readSearchText(),n=En.empty(t),i=this._checkSearchTextChanged(t),r=this._getSelectedLookupRow(i);return this._setProperty("displayText",t),this._acceptInputDeferred=s.a.Deferred(),this._flushLookupStatus(),this._clearPendingLookup(),this.touchMode?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#acceptInput) Always send acceptInput for touch field"),void this._inputAccepted()):this._acceptInput(e,t,n,i,r)}},{key:"_getSelectedLookupRow",value:function(e){return!this.isPopupOpen()||e&&this._userWasTyping?null:this.lookupSeqNo===this.popup.lookupResult.seqNo?this.popup.getSelectedLookupRow():null}},{key:"_checkSearchTextChanged",value:function(e){return!(this.isDropdown()||!this._userWasTyping||this._searchTextEquals(e,this._lastSearchText))}},{key:"_searchTextEquals",value:function(e,t){var n=En.nullIfEmpty(this._firstTextLine(e)),i=En.nullIfEmpty(t);return En.equalsIgnoreCase(n,i)}},{key:"_clearPendingLookup",value:function(){this._pendingLookup&&(clearTimeout(this._pendingLookup),this._pendingLookup=null)}},{key:"_acceptInput",value:function(e,t,n,i,r){return!r&&this.lookupRow&&En.nvl(this.lookupRow.text)===t?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptInput) unchanged: text is equals. Close popup"),this._clearLookupStatus(),void this._inputAccepted(!1)):(this._notUnique&&!n&&this._setNotUniqueError(t),r||this.lookupRow||!n?!r&&n?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptInput) empty. Set lookup-row to null, close popup"),this._clearLookupStatus(),this.setLookupRow(null),void this._inputAccepted()):r?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptInput) lookup-row selected. Set lookup-row, close popup lookupRow=",r.toString()),this._clearLookupStatus(),this.setLookupRow(r),void this._inputAccepted()):(i||this._userWasTyping?this._acceptByText(e,this._firstTextLine(t)):this._hasUiError()?this._hasNotUniqueError()&&this.popup?this.popup.selectFirstLookupRow():this._acceptInputDeferred.resolve():this._inputAccepted(!1),this._acceptInputDeferred.promise()):(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptInput) unchanged: text is empty. Close popup"),this._clearLookupStatus(),this.errorStatus&&this.errorStatus.code===o.ErrorCode.NO_RESULTS&&this.clearErrorStatus(),void this._inputAccepted(i||this._userWasTyping)))}},{key:"_firstTextLine",value:function(e){return En.empty(e)?e:e.split("\n")[0]}},{key:"_acceptByText",value:function(e,t){e=O.nvl(e,!1),s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptByText) sync="+e+" searchText=",t),e?this._acceptByTextSync(t):this._acceptByTextAsync(t)}},{key:"_acceptByTextSync",value:function(e){this._lastSearchText=null,this._inputAccepted(),this._hasUiError()||this.resetDisplayText()}},{key:"_acceptByTextAsync",value:function(e){this._lastSearchText=e,this._executeLookup(this.lookupCall.cloneForText(e),!0).done(this._acceptByTextDone.bind(this)).done(this._triggerLookupCallDone.bind(this)),this._triggerAcceptByText(e)}},{key:"_inputAccepted",value:function(e,t){e=O.nvl(e,!0),t=O.nvl(t,!0),this.embedded||this.closePopup(),this._userWasTyping=!1,e&&this._triggerAcceptInput(t),this._focusNextTabbable(),this._acceptInputDeferred.resolve()}},{key:"_focusNextTabbable",value:function(){if(this._tabPrevented){var e=this.entryPoint().find(":tabbable"),t=this._tabPrevented.shiftKey?-1:1,n=e.index(this.$field),i=n+t;i<0?i=e.length-1:i>=e.length&&(i=0),s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_inputAccepted) tab-index="+n+" next tab-index="+i);var r=e.eq(i).focus();oi.isFunction(r[0].select)&&r[0].select(),this._tabPrevented=null}}},{key:"_acceptByTextDone",value:function(e){if(this._userWasTyping=!1,this._extendResult(e),this._notUnique=e.numLookupRows>1,e.uniqueMatch){var t=e.uniqueMatch;this._isLookupRowActive(t)?(this.setLookupRow(t),this._inputAccepted()):this.setErrorStatus(pi.error({message:this.session.text("SmartFieldInactiveRow",e.text)}))}else this._acceptInputFail(e)}},{key:"_extendResult",value:function(e){e.seqNo=this.lookupSeqNo,e.uniqueMatch=null;var t="by"+En.toUpperCaseFirstLetter(e.queryBy.toLowerCase());if(e[t]=!0,this.browseHierarchy){var n=O.create("TreeProposalChooser",{parent:this,smartField:this});n.setLookupResult(e);var i=n.findLeafs();e.numLookupRows=i.length,1===e.numLookupRows&&(e.uniqueMatch=i[0].lookupRow)}else e.numLookupRows=e.lookupRows.length,1===e.numLookupRows&&(e.uniqueMatch=e.lookupRows[0]);e.empty=0===e.numLookupRows}},{key:"_acceptInputFail",value:function(e){var t=e.text;e.empty&&(this.embedded||this.closePopup(),this.setValue(null),this.setDisplayText(t),this.setErrorStatus(pi.error({message:this.session.text("SmartFieldCannotComplete",t),code:o.ErrorCode.NO_RESULTS}))),e.numLookupRows>1&&(this.setValue(null),this.setDisplayText(t),this._setNotUniqueError(t),this.isPopupOpen()?this.popup.setLookupResult(e):this._lookupByTextOrAllDone(e),this.isPopupOpen()&&this.popup.selectFirstLookupRow()),this._acceptInputDeferred.resolve(),this._triggerAcceptInputFail()}},{key:"lookupByRec",value:function(e){return s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#lookupByRec) rec=",e),this._lastSearchText=null,this._executeLookup(this.lookupCall.cloneForRec(e)).then(function(t){t.appendResult=!0,t.rec=e,this.isPopupOpen()&&this.popup.setLookupResult(t)}.bind(this)).then(this._triggerLookupCallDone.bind(this))}},{key:"_isLookupRowActive",value:function(e){return!!e.enabled&&(!this.activeFilterEnabled||("TRUE"===this.activeFilter?e.active:"FALSE"!==this.activeFilter||!e.active))}},{key:"_renderEnabled",value:function(){A0(I0(o.prototype),"_renderEnabled",this).call(this),this.$field.setTabbable(this.enabledComputed)}},{key:"setLookupCall",value:function(e){this.setProperty("lookupCall",e)}},{key:"_setLookupCall",value:function(e){this._setProperty("lookupCall",ur.ensure(e,this.session))}},{key:"_setCodeType",value:function(e){if(this._setProperty("codeType",e),e){var t=O.create("CodeLookupCall",{session:this.session,codeType:e});this.setProperty("lookupCall",t)}}},{key:"_formatValue",value:function(e){return oi.isNullOrUndefined(e)?"":this.lookupRow?this._formatLookupRow(this.lookupRow):(this._lastSearchText=null,this._executeLookup(this.lookupCall.cloneForKey(e),!0).then(this._lookupByKeyDone.bind(this)).then(this._triggerLookupCallDone.bind(this)))}},{key:"_lookupByKeyDone",value:function(e){this._notUnique=!1;var t=ur.firstLookupRow(e);return this.setLookupRow(t),this._formatLookupRow(t)}},{key:"_formatLookupRow",value:function(e){return e?e.text:""}},{key:"openPopup",value:function(e){var t=this._readDisplayText(),n=!!this.searchRequired||null;return s.a.log.isInfoEnabled()&&s.a.log.info("SmartField#openPopup browse="+e+" searchText="+t+" popup="+this.popup+" pendingOpenPopup="+this._pendingOpenPopup),this._tabPrevented=null,this._pendingOpenPopup=!0,En.empty(t)?e=!0:this.errorStatus&&(this._hasNotUniqueError()?(n=!0,e=!1):this.searchRequired||(e=!0)),this._lookupByTextOrAll(e,t,n)}},{key:"_hasUiError",value:function(e){var t=this._errorStatus();if(!t)return!1;e=e?et.ensure(e):[o.ErrorCode.NO_RESULTS,o.ErrorCode.NOT_UNIQUE];var n=pi.asFlatList(t).reduce((function(e,t){return t.code&&-1===e.indexOf(t.code)&&e.push(t.code),e}),[]);return e.some((function(e){return n.indexOf(e)>-1}))}},{key:"_lookupByTextOrAll",value:function(e,t,n){if(t=O.nvl(t,this._readDisplayText()),e=O.nvl(e,En.empty(t)),n=O.nvl(n,!1),this.isDropdown()&&(e=!0),!e&&!n){var i=null;if(i=this._lastSearchText?this._lastSearchText:this._getLastSearchText(),this._searchTextEquals(t,i))return this._pendingOpenPopup=!1,void s.a.log.debug("(SmartField#_lookupByTextOrAll) searchText is equals -> skip lookup")}this._clearPendingLookup();var r=s.a.Deferred(),a=function(e){this._lookupByTextOrAllDone(e),r.resolve(e)}.bind(this);return e?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_lookupByTextOrAll) lookup byAll (searchText empty)"),this._lastSearchText=null,this.searchRequired?(a({queryBy:_r.TEXT,lookupRows:[]}),this.setLookupStatus(pi.warning({message:this.session.text("TooManyRows"),code:o.ErrorCode.SEARCH_REQUIRED}))):this._executeLookup(this.lookupCall.cloneForAll(),!0).done(a).done(this._triggerLookupCallDone.bind(this))):this._pendingLookup=setTimeout(function(){s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_lookupByTextOrAll) lookup byText searchText="+t),this._lastSearchText=t,this._executeLookup(this.lookupCall.cloneForText(t),!0).done(a).done(this._triggerLookupCallDone.bind(this))}.bind(this),o.DEBOUNCE_DELAY),r.promise()}},{key:"_getLastSearchText",value:function(){return oi.optProperty(this.lookupRow,"text")}},{key:"_lookupByTextOrAllDone",value:function(e){if(this._extendResult(e),this._notUnique=!e.byAll&&e.numLookupRows>1,!this._handleException(e))if(this.rendered&&(this.isFocused()||this.isTouchable())){if(e.empty&&e.byAll)return this.activeFilterEnabled?this._ensurePopup(e):this.closePopup(),void this.setLookupStatus(pi.warning({message:this.session.text("SmartFieldNoDataFound"),code:o.ErrorCode.NO_DATA}));if(e.empty)return this._handleEmptyResult(),void this.setLookupStatus(pi.warning({message:this.session.text("SmartFieldCannotComplete",e.text),code:o.ErrorCode.NO_RESULTS}));var t=null;e.numLookupRows>this.browseMaxRowCount&&(e.lookupRows=e.lookupRows.slice(0,this.browseMaxRowCount),t=pi.info({message:this.session.text("SmartFieldMoreThanXRows",this.browseMaxRowCount)})),this._ensurePopup(e,t)}else this.closePopup()}},{key:"_ensurePopup",value:function(e,t){this.popup?(this.popup.setLookupResult(e),this.popup.setStatus(t)):this._renderPopup(e,t)}},{key:"_handleException",value:function(e){return!!e.exception&&(this.setErrorStatus(pi.error({message:e.exception})),this.closePopup(),!0)}},{key:"_handleEmptyResult",value:function(){this.touchMode||this.activeFilterEnabled?this._ensurePopup({lookupRows:[]}):this.embedded?this.popup.clearLookupRows():this.closePopup()}},{key:"_renderPopup",value:function(e,t){this.$field.addClass("focused"),this.$container.addClass("popup-open");var n=this.touchMode&&!this.isDropdown(),i=n?"SmartFieldTouchPopup":"SmartFieldPopup";this._pendingOpenPopup=!1,this.popup=O.create(i,{parent:this,$anchor:this.$field,boundToAnchor:!n,closeOnAnchorMouseDown:!1,field:this,lookupResult:e,status:t}),this.popup.open();var r=n?this.popup._field:this;this.popup.on("lookupRowSelected",r._onLookupRowSelected.bind(r)),this.popup.on("activeFilterSelected",this._onActiveFilterSelected.bind(this)),this.popup.one("remove",function(){this.popup=null,this.rendered&&(this.$container.removeClass("popup-open"),this.$field.removeClass("focused"),this._renderErrorStatus())}.bind(this))}},{key:"closePopup",value:function(){this._pendingOpenPopup=!1,this.popup&&this.popup.close()}},{key:"aboutToBlurByMouseDown",value:function(e){if(this.touchMode)return!1;gH.eventOutsideProposalField(this,e)&&this.acceptInput(!0)}},{key:"_onFieldMouseDown",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_onFieldMouseDown)"),this.activate(!0)}},{key:"activate",value:function(e){this.enabledComputed&&this.rendered&&(this.isDropdown()||gH.handleOnClick(this)?(e&&!Mt.get().supportsOnlyTouch()||this.$field.focus(),this.togglePopup()):this.popup&&this.popup.removalPending&&this.popup.one("remove",function(){this.rendered&&this.activate(e)}.bind(this)))}},{key:"_onIconMouseDown",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_onIconMouseDown)"),this.enabledComputed&&(e.preventDefault(),this.$field.focus(),this.embedded||(this.isDropdown()?this.togglePopup():this.popup||this.openPopup(!this.searchRequired)))}},{key:"_onClearIconMouseDown",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_onClearIconMouseDown)"),this.enabledComputed&&(e.preventDefault(),this.$field.focus(),this.clear())}},{key:"_clear",value:function(){this._tabPrevented=null,this._lastSearchText=this._readDisplayText(),this._userWasTyping=!0,gH.valOrText(this.$field,""),this.touchMode&&this.setValue(null),this.isPopupOpen()&&setTimeout(this._lookupByTextOrAll.bind(this,!0)),this._updateHasText()}},{key:"togglePopup",value:function(){s.a.log.isInfoEnabled()&&s.a.log.info("(SmartField#togglePopup) popupOpen=",this.isPopupOpen()),this.isPopupOpen()?this.closePopup():this.openPopup(!this.searchRequired)}},{key:"_onFieldBlur",value:function(e){this.setFocused(!1),this.setLoading(!1),this.isTouchable()||(this.acceptInput(!1),this.closePopup())}},{key:"isTouchable",value:function(){return this.embedded||this.touchMode}},{key:"_onFieldKeyUp",value:function(e){if(e.which!==pu.ESC){var t=e.which,n=(e.ctrlKey||e.metaKey)&&t===pu.V||e.shiftKey&&t===pu.INSERT,i=(e.ctrlKey||e.metaKey)&&t===pu.X||e.shiftKey&&t===pu.DELETE;(!n&&!i||this.isDropdown())&&(e.ctrlKey||e.altKey||e.metaKey||t===pu.ENTER||t===pu.TAB||t===pu.SHIFT||t===pu.CTRL||t===pu.ALT||t===pu.HOME||t===pu.END||t===pu.LEFT||t===pu.RIGHT||t===pu.WIN_LEFT||t===pu.WIN_RIGHT||t===pu.SELECT||t===pu.NUM_LOCK||t===pu.CAPS_LOCK||t===pu.SCROLL_LOCK||t===pu.PAUSE||t===pu.PRINT_SCREEN||this._isNavigationKey(e)||this._isFunctionKey(e))||this._handleInput()}}},{key:"_handleInput",value:function(){this._pendingOpenPopup||this.isPopupOpen()?this.isDropdown()||this._lookupByTextOrAll():this._pendingOpenPopup||this.openPopup()}},{key:"isPopupOpen",value:function(){return!(!this.popup||this.popup.removalPending)}},{key:"_onFieldKeyDown",value:function(e){if(this._updateUserWasTyping(e),e.which===pu.TAB)return this.mode===GH.Mode.DEFAULT&&(e.preventDefault(),e.stopPropagation(),s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_onFieldKeyDown) set _tabPrevented"),this._tabPrevented={shiftKey:e.shiftKey}),void this.acceptInput();if(e.which!==pu.ENTER){var t=e.which;this.isDropdown()&&(e.ctrlKey||e.altKey||e.metaKey||t===pu.ESC||t===pu.SHIFT||t===pu.CTRL||t===pu.ALT||t===pu.WIN_LEFT||t===pu.WIN_RIGHT||t===pu.SELECT||t===pu.NUM_LOCK||t===pu.CAPS_LOCK||t===pu.SCROLL_LOCK||t===pu.PAUSE||t===pu.PRINT_SCREEN||this._isFunctionKey(e))||(this._isNavigationKey(e)||this.isDropdown())&&(this.isPopupOpen()?this.popup.delegateKeyEvent(e):this._pendingOpenPopup||this.openPopup(!this.searchRequired),e.stopPropagation(),e.preventDefault())}else this._handleEnterKey(e)}},{key:"_onFieldInput",value:function(){this._updateHasText(),Mt.get().isInternetExplorer()||this._userWasTyping||(this.isFocused()||this.focus(),this._handleInput())}},{key:"_updateUserWasTyping",value:function(e){var t=e.which,n=(e.ctrlKey||e.metaKey)&&t===pu.V||e.shiftKey&&t===pu.INSERT,i=(e.ctrlKey||e.metaKey)&&t===pu.X||e.shiftKey&&t===pu.DELETE;(!n&&!i||this.isDropdown())&&(e.ctrlKey||e.altKey||e.metaKey||t===pu.ESC||t===pu.TAB||t===pu.SHIFT||t===pu.CTRL||t===pu.ALT||t===pu.HOME||t===pu.END||t===pu.LEFT||t===pu.RIGHT||t===pu.WIN_LEFT||t===pu.WIN_RIGHT||t===pu.SELECT||t===pu.NUM_LOCK||t===pu.CAPS_LOCK||t===pu.SCROLL_LOCK||t===pu.PAUSE||t===pu.PRINT_SCREEN||this._isFunctionKey(e))||(this._userWasTyping=!(this._isNavigationKey(e)||t===pu.ENTER))}},{key:"_isNavigationKey",value:function(e){var t=[pu.PAGE_UP,pu.PAGE_DOWN,pu.UP,pu.DOWN];return this.isDropdown()&&(t.push(pu.HOME),t.push(pu.END)),O.isOneOf(e.which,t)}},{key:"_handleEnterKey",value:function(e){this.isPopupOpen()&&(this.popup.selectLookupRow(),e.stopPropagation())}},{key:"_isFunctionKey",value:function(e){return e.which>=pu.F1&&e.which<=pu.F12}},{key:"_onLookupRowSelected",value:function(e){this._clearPendingLookup();var t=this.original()._currentLookupCall;t&&(t.abort(),this.original()._currentLookupCall=null,this.setLoading(!1)),this.setLookupRow(e.lookupRow),this._inputAccepted(),this.closePopup()}},{key:"_onActiveFilterSelected",value:function(e){this.setActiveFilter(e.activeFilter);var t=!this.searchRequired,n=this._readSearchText();this.lookupRow?this.lookupRow.text!==n&&(t=!1):En.hasText(n)&&(t=!1),this._lookupByTextOrAll(t,n,!0)}},{key:"setBrowseMaxRowCount",value:function(e){this.setProperty("browseMaxRowCount",e)}},{key:"setBrowseAutoExpandAll",value:function(e){this.setProperty("browseAutoExpandAll",e)}},{key:"setBrowseLoadIncremental",value:function(e){this.setProperty("browseLoadIncremental",e),this.lookupCall&&this.lookupCall.setLoadIncremental(e)}},{key:"setActiveFilter",value:function(e){this.setProperty("activeFilter",this.activeFilterEnabled?e:null)}},{key:"setActiveFilterEnabled",value:function(e){this.setProperty("activeFilterEnabled",e)}},{key:"setInitActiveFilter",value:function(e){this.setProperty("initActiveFilter",e)}},{key:"setSearchRequired",value:function(e){this.setProperty("searchRequired",e)}},{key:"_executeLookup",value:function(e,t){this.lookupSeqNo++,this.setLoading(!0);var n=this.original()._currentLookupCall;return t&&n&&n.abort(),this.original()._currentLookupCall=e,this.trigger("prepareLookupCall",{lookupCall:e}),e.execute().always(function(){this.original()._currentLookupCall=null,this.setLoading(!1),this._clearLookupStatus(),this._clearNoResultsErrorStatus()}.bind(this))}},{key:"_clearNoResultsErrorStatus",value:function(){this.isTouchable()||this._userWasTyping&&this.errorStatus&&this.errorStatus.code===o.ErrorCode.NO_RESULTS&&this.setErrorStatus(null)}},{key:"virtual",value:function(){return this.browseMaxRowCount>o.DEFAULT_BROWSE_MAX_COUNT}},{key:"isDropdown",value:function(){return this.displayStyle===o.DisplayStyle.DROPDOWN}},{key:"_setLookupRow",value:function(e){this.lookupRow&&this.removeCssClass(this.lookupRow.cssClass),this._setProperty("lookupRow",e),e&&this.addCssClass(e.cssClass)}},{key:"setLookupRow",value:function(e){this.lookupRow!==e&&(this._notUnique=!1,this.clearErrorStatus(),this._setLookupRow(e),this._lockLookupRow=!0,e?this.setValue(this._getValueFromLookupRow(e)):this.setValue(null),this._lockLookupRow=!1,this.resetDisplayText())}},{key:"setDisplayText",value:function(e){A0(I0(o.prototype),"setDisplayText",this).call(this,e),this._userWasTyping=!1}},{key:"resetDisplayText",value:function(){var e=this.formatValue(this.value);e&&s.a.isFunction(e.promise)?e.done(this._setAndRenderDisplayText.bind(this)).fail(function(){s.a.log.isInfoEnabled()&&s.a.log.info("Could not resolve display text for value: "+this.value)}.bind(this)):this._setAndRenderDisplayText(e)}},{key:"_setAndRenderDisplayText",value:function(e){this._setProperty("displayText",e),this.rendered&&this._renderDisplayText()}},{key:"_getValueFromLookupRow",value:function(e){return e.key}},{key:"_setValue",value:function(e){this._lockLookupRow||(oi.isNullOrUndefined(e)||this._checkResetLookupRow(e))&&this._setLookupRow(null),A0(I0(o.prototype),"_setValue",this).call(this,e),this._notUnique=!1}},{key:"_checkResetLookupRow",value:function(e){return this.lookupRow&&this.lookupRow.key!==e}},{key:"getValueForSelection",value:function(){return this._showSelection()?this.value:null}},{key:"_showSelection",value:function(){if(oi.isNullOrUndefined(this.value)||oi.isNullOrUndefined(this.lookupRow))return!1;var e;if(this.rendered){e=this._readDisplayText();var t=this.additionalLines();t&&(e=[e].concat(t).join("\n"))}else e=this.displayText;return e===this.lookupRow.text}},{key:"isClearable",value:function(){return A0(I0(o.prototype),"isClearable",this).call(this)&&!this.isDropdown()&&!this.touchMode}},{key:"_triggerLookupCallDone",value:function(e){return this.trigger("lookupCallDone",{result:e}),e}},{key:"_triggerAcceptInputFail",value:function(){this._triggerAcceptInput(!1,!0)}},{key:"_triggerAcceptInput",value:function(e,t){this.trigger("acceptInput",{displayText:this.displayText,errorStatus:this.errorStatus,value:this.value,lookupRow:this.lookupRow,acceptByLookupRow:O.nvl(e,!0),failure:O.nvl(t,!1)})}},{key:"_triggerAcceptByText",value:function(e){this.trigger("acceptByText",{searchText:e,errorStatus:this.errorStatus})}},{key:"onCellEditorRendered",value:function(e){e.openFieldPopup&&(this._cellEditorPopup=e.cellEditorPopup,this.openPopup(!this.searchRequired))}},{key:"additionalLines",value:function(){var e=O.nvl(this.displayText,"").split("\n");return e.length>1?(e.shift(),e):null}},{key:"_createLoadingSupport",value:function(){return new ue({widget:this,loadingIndicatorDelay:400})}},{key:"_isInitialShowStatus",value:function(){return(!this.touchMode||!this._pendingOpenPopup&&!this.isPopupOpen())&&A0(I0(o.prototype),"_isInitialShowStatus",this).call(this)}},{key:"acceptInputFromField",value:function(e){this._copyValuesFromField(e),this._cellEditorPopup?(this._cellEditorPopup.completeEdit(),this._cellEditorPopup=null):this.acceptInput()}},{key:"_copyValuesFromField",value:function(e){this.lookupRow!==e.lookupRow&&this.setLookupRow(e.lookupRow),this.setErrorStatus(e.errorStatus),this.setDisplayText(e.displayText)}},{key:"_setNotUniqueError",value:function(e){this.setErrorStatus(pi.error({message:this.session.text("SmartFieldNotUnique",e),code:o.ErrorCode.NOT_UNIQUE}))}},{key:"_hasNotUniqueError",value:function(e){return this._notUnique||this._hasUiError(o.ErrorCode.NOT_UNIQUE)}},{key:"_errorStatus",value:function(){return this.lookupStatus||this.errorStatus}},{key:"setLookupStatus",value:function(e){this.setProperty("lookupStatus",e),this.rendered&&this._renderErrorStatus()}},{key:"clearErrorStatus",value:function(){this.setErrorStatus(null),this._clearLookupStatus()}},{key:"_clearLookupStatus",value:function(){this.setLookupStatus(null)}},{key:"_flushLookupStatus",value:function(){if(this.lookupStatus){if(this.lookupStatus.code===o.ErrorCode.NO_RESULTS||this.lookupStatus.code===o.ErrorCode.NOT_UNIQUE){var e=this.lookupStatus.clone();e.severity=pi.Severity.ERROR,this.setErrorStatus(e)}this._clearLookupStatus()}}},{key:"requestInput",value:function(){this.enabledComputed&&this.rendered&&(this.focus(),this.openPopup(!this.searchRequired))}}])&&F0(t.prototype,n),i&&F0(t,i),o}(GV);function N0(e){return(N0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H0(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function V0(e,t,n){return(V0="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=U0(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function W0(e,t){return(W0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=U0(e);if(t){var r=U0(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return G0(this,n)}}function G0(e,t){return!t||"object"!==N0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function U0(e){return(U0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}L0(B0,"DisplayStyle",{DEFAULT:"default",DROPDOWN:"dropdown"}),L0(B0,"ErrorCode",{NOT_UNIQUE:1,NO_RESULTS:2,NO_DATA:3,SEARCH_REQUIRED:4}),L0(B0,"DEBOUNCE_DELAY",200),L0(B0,"DEFAULT_BROWSE_MAX_COUNT",100),L0(B0,"ACTIVE_FILTER_VALUES",["UNDEFINED","FALSE","TRUE"]);var K0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W0(e,t)}(o,e);var t,n,i,r=z0(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["activeFilter"]),e}return t=o,(n=[{key:"_postCreateWidget",value:function(){V0(U0(o.prototype),"_postCreateWidget",this).call(this),this.widget.lookupCall=O.create("RemoteLookupCall",this)}},{key:"_syncResult",value:function(e){var t=this.widget._currentLookupCall;!t&&this.widget.touchMode&&this.widget.popup&&this.widget.popup._field&&(t=this.widget.popup._field._currentLookupCall),t&&t.resolveLookup(e)}},{key:"_syncDisplayText",value:function(e){this.widget.setDisplayText(e)}},{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e).sort(this._createPropertySortFunc(o.PROPERTIES_ORDER))}},{key:"_onWidgetEvent",value:function(e){"acceptByText"===e.type?this._onWidgetAcceptByText(e):V0(U0(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onWidgetAcceptByText",value:function(e){this._sendProperty("errorStatus",e.errorStatus)}},{key:"_onWidgetAcceptInput",value:function(e){var t={displayText:e.displayText,errorStatus:e.errorStatus};e.errorStatus?En.empty(e.displayText)&&(t.value=null):(t.value=e.value,e.acceptByLookupRow&&(t.lookupRow=e.lookupRow)),this._send("acceptInput",t,{showBusyIndicator:!e.whileTyping,coalesce:function(e){return this.target===e.target&&this.type===e.type&&this.whileTyping===e.whileTyping}})}}])&&H0(t.prototype,n),i&&H0(t,i),o}(sJ);function q0(e){return(q0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y0(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function X0(e,t,n){return(X0="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=e1(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function J0(e,t){return(J0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=e1(e);if(t){var r=e1(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q0(this,n)}}function Q0(e,t){return!t||"object"!==q0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function e1(e){return(e1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(K0,"PROPERTIES_ORDER",["lookupRow","value","errorStatus","displayText"]);var t1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J0(e,t)}(o,e);var t,n,i,r=Z0(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e))._smartField=e,t}return t=o,(n=[{key:"layout",value:function(e){if(X0(e1(o.prototype),"layout",this).call(this,e),!this._smartField.embedded){var t=this._smartField.popup;t&&t.rendered&&(t.position(),t.validateLayout())}}}])&&Y0(t.prototype,n),i&&Y0(t,i),o}(sV);function n1(e){return(n1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i1(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r1(e,t,n){return(r1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l1(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function o1(e,t){return(o1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=l1(e);if(t){var r=l1(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return a1(this,n)}}function a1(e,t){return!t||"object"!==n1(t)&&"function"!=typeof t?u1(e):t}function u1(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l1(e){return(l1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o1(e,t)}(o,e);var t,n,i,r=s1(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ESC],t.stopPropagation=!0,t.preventInvokeAcceptInputOnActiveValueField=!0,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(u1(t)),t}return t=o,(n=[{key:"_accept",value:function(e){return!!r1(l1(o.prototype),"_accept",this).call(this,e)&&!!this.field.popup}},{key:"handle",value:function(e){this.field.closePopup(),this.field.resetDisplayText()}}])&&i1(t.prototype,n),i&&i1(t,i),o}($u);function f1(e){return(f1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h1(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d1(e,t,n){return(d1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b1(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p1(e,t){return(p1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b1(e);if(t){var r=b1(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v1(this,n)}}function v1(e,t){return!t||"object"!==f1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b1(e){return(b1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p1(e,t)}(o,e);var t,n,i,r=y1(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).animateRemoval=o.hasPopupAnimation(),e}return t=o,i=[{key:"hasPopupAnimation",value:function(){return Mt.get().supportsCssAnimation()&&!Mt.get().isInternetExplorer()}}],(n=[{key:"_init",value:function(e){e.withFocusContext=!1,d1(b1(o.prototype),"_init",this).call(this,e),this.smartField=this.parent,this.proposalChooser=this._createProposalChooser(),this.proposalChooser.on("lookupRowSelected",this._triggerEvent.bind(this)),this.proposalChooser.on("activeFilterSelected",this._triggerEvent.bind(this)),this.smartField.on("remove",this._onRemoveSmartField.bind(this)),this.setLookupResult(e.lookupResult),this.setStatus(e.status)}},{key:"_createProposalChooser",value:function(){var e=this.smartField.browseHierarchy?"TreeProposalChooser":"TableProposalChooser";return O.create(e,{parent:this})}},{key:"_createLayout",value:function(){return new $1(this,this.proposalChooser)}},{key:"_render",value:function(){var e=this.smartField.cssClassName()+"-popup";d1(b1(o.prototype),"_render",this).call(this),this.$container.addClass(e).on("mousedown",this._onContainerMouseDown.bind(this)),this.$container.toggleClass("alternative",this.smartField.fieldStyle===GH.FieldStyle.ALTERNATIVE),this.proposalChooser.render()}},{key:"setLookupResult",value:function(e){this._setProperty("lookupResult",e),this.proposalChooser.setLookupResult(e)}},{key:"getSelectedLookupRow",value:function(){var e=this.proposalChooser.getSelectedLookupRow();return e&&e.enabled?e:null}},{key:"setStatus",value:function(e){this.proposalChooser.setStatus(e)}},{key:"selectFirstLookupRow",value:function(){this.proposalChooser.selectFirstLookupRow()}},{key:"selectLookupRow",value:function(){this.proposalChooser.triggerLookupRowSelected()}},{key:"delegateKeyEvent",value:function(e){e.originalEvent.smartFieldEvent=!0,this.proposalChooser.delegateKeyEvent(e)}},{key:"_triggerEvent",value:function(e){this.trigger(e.type,e)}},{key:"_onContainerMouseDown",value:function(e){return!1}},{key:"_onRemoveSmartField",value:function(e){this.animateRemoval=!1,this.remove()}},{key:"_isMouseDownOnAnchor",value:function(e){return this.field.$field.isOrHas(e.target)||this.field.$icon.isOrHas(e.target)||this.field.$clearIcon&&this.field.$clearIcon.isOrHas(e.target)}},{key:"_onAnimationEnd",value:function(){this.proposalChooser.updateScrollbars()}}])&&h1(t.prototype,n),i&&h1(t,i),o}(kd);function m1(e){return(m1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _1(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w1(e,t,n){return(w1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T1(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function k1(e,t){return(k1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=T1(e);if(t){var r=T1(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return O1(this,n)}}function O1(e,t){return!t||"object"!==m1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T1(e){return(T1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k1(e,t)}(o,e);var t,n,i,r=S1(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){e.withFocusContext=!1,e.smartField=e.parent,w1(T1(o.prototype),"_init",this).call(this,e),this.setLookupResult(e.lookupResult),this.setStatus(e.status),this.one("close",this._beforeClosePopup.bind(this)),this.smartField.on("propertyChange",this._onPropertyChange.bind(this))}},{key:"_initWidget",value:function(e){this._widget=this._createProposalChooser(),this._widget.on("lookupRowSelected",this._triggerEvent.bind(this)),this._widget.on("activeFilterSelected",this._triggerEvent.bind(this))}},{key:"_createProposalChooser",value:function(){var e=this.parent.browseHierarchy?"TreeProposalChooser":"TableProposalChooser";return O.create(e,{parent:this,touch:!0,smartField:this._field})}},{key:"_fieldOverrides",value:function(){var e=w1(T1(o.prototype),"_fieldOverrides",this).call(this);return e.proposalChooser=null,e}},{key:"_onMouseDownOutside",value:function(){this._acceptInput()}},{key:"delegateKeyEvent",value:function(e){e.originalEvent.smartFieldEvent=!0,this._widget.delegateKeyEvent(e)}},{key:"getSelectedLookupRow",value:function(){return this._widget.getSelectedLookupRow()}},{key:"_triggerEvent",value:function(e){this.trigger(e.type,e)}},{key:"setLookupResult",value:function(e){this._widget.setLookupResult(e)}},{key:"setStatus",value:function(e){this._widget.setStatus(e)}},{key:"clearLookupRows",value:function(){this._widget.clearLookupRows()}},{key:"selectFirstLookupRow",value:function(){this._widget.selectFirstLookupRow()}},{key:"selectLookupRow",value:function(){this._widget.triggerLookupRowSelected()}},{key:"_onPropertyChange",value:function(e){"lookupStatus"===e.propertyName&&this._field.setLookupStatus(e.newValue)}},{key:"_beforeClosePopup",value:function(e){this.smartField.acceptInputFromField(this._field)}}])&&_1(t.prototype,n),i&&_1(t,i),o}(Lp);function P1(e){return(P1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R1(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function x1(e,t,n){return(x1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A1(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function E1(e,t){return(E1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=A1(e);if(t){var r=A1(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return F1(this,n)}}function F1(e,t){return!t||"object"!==P1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A1(e){return(A1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E1(e,t)}(o,e);var t,n,i,r=D1(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).animating=!1,t.doubleCalcPrefSize=!1,t}return t=o,(n=[{key:"layout",value:function(e){var t,n=this._htmlProposalChooser();this.animating?this.popup.htmlComp.$comp.oneAnimationEnd(function(){this.popup.revalidateLayout()}.bind(this)):(x1(A1(o.prototype),"layout",this).call(this,e),t=this.popup.htmlComp.size().subtract(this.popup.htmlComp.insets()),n.setSize(t),this.popup.htmlComp.layouted?this.popup.position():g1.hasPopupAnimation()&&(this.animating=!0,this.popup.htmlComp.$comp.css("visibility","hidden"),this.popup.session.layoutValidator.schedulePostValidateFunction(function(){this.popup.htmlComp.$comp.css("visibility",""),this.popup.htmlComp.$comp.addClassForAnimation("animate-open"),this.popup.htmlComp.$comp.oneAnimationEnd(function(){this.animating=!1,this.popup._onAnimationEnd()}.bind(this))}.bind(this))))}},{key:"preferredLayoutSize",value:function(e,t){var n,i=this._htmlProposalChooser(),r=No.offsetBounds(this.popup.smartField.$field);return(n=i?(n=i.prefSize(t)).add(this.popup.htmlComp.insets()):new Co(Vo.get().formColumnWidth,2*Vo.get().formRowHeight)).width=Math.max(r.width,n.width),n.height=Math.max(15,Math.min(350,n.height)),n.width>this._maxWindowSize()&&(n.width=this._maxWindowSize()),n}},{key:"_htmlProposalChooser",value:function(){var e=this.popup.proposalChooser;return e?e.htmlComp:null}},{key:"_maxWindowSize",value:function(){return this.popup.$container.window().width()-2*this.popup.windowPaddingX}}])&&R1(t.prototype,n),i&&R1(t,i),o}(Id);function j1(e){return(j1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M1(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function I1(e,t,n){return(I1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=H1(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function L1(e,t){return(L1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=H1(e);if(t){var r=H1(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return N1(this,n)}}function N1(e,t){return!t||"object"!==j1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H1(e){return(H1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var V1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L1(e,t)}(o,e);var t,n,i,r=B1(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._$multilineLines=null,e}return t=o,(n=[{key:"_render",value:function(){var e;this.addContainer(this.$parent,"smart-field has-icon",new t1(this)),this.addLabel(),this.addFieldContainer(this.$parent.makeDiv("multiline")),Uo.install(this.$fieldContainer,this.session).setLayout(new n2(this)),e=gH.makeInputOrDiv(this,"multiline-input").on("mousedown",this._onFieldMouseDown.bind(this)).appendTo(this.$fieldContainer),this.touchMode||e.keyup(this._onFieldKeyUp.bind(this)).keydown(this._onFieldKeyDown.bind(this)).on("input",this._onFieldInput.bind(this)),this.addField(e),this._$multilineLines=this.$fieldContainer.appendDiv("multiline-lines").on("click",this._onMultilineLinesClick.bind(this)),this.embedded||this.addMandatoryIndicator(),this.addIcon(),this.$icon.addClass("needsclick"),this.addStatus()}},{key:"_renderEnabled",value:function(){I1(H1(o.prototype),"_renderEnabled",this).call(this),this._$multilineLines.setEnabled(this.enabledComputed)}},{key:"_onMultilineLinesClick",value:function(e){this.enabledComputed&&(this.$field.window(!0).getSelection().toString()||this.$field.focus())}},{key:"_renderDisplayText",value:function(){I1(H1(o.prototype),"_renderDisplayText",this).call(this);var e=this.additionalLines();e?this._$multilineLines.html(et.formatEncoded(e,"<br/>")):this._$multilineLines.empty()}},{key:"_getInputBounds",value:function(){var e=No.offsetBounds(this.$fieldContainer),t=No.offsetBounds(this.$field);return e.height=t.height,e}},{key:"_renderFocused",value:function(){I1(H1(o.prototype),"_renderFocused",this).call(this),this._$multilineLines.toggleClass("focused",this.focused)}},{key:"_updateErrorStatusClasses",value:function(e,t){I1(H1(o.prototype),"_updateErrorStatusClasses",this).call(this,e,t),this._$multilineLines.removeClass(GH.SEVERITY_CSS_CLASSES),this._$multilineLines.addClass(e,t)}}])&&M1(t.prototype,n),i&&M1(t,i),o}(B0);function W1(e){return(W1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z1(e,t){return(z1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=K1(e);if(t){var r=K1(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U1(this,n)}}function U1(e,t){return!t||"object"!==W1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K1(e){return(K1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var q1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z1(e,t)}(n,e);var t=G1(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(K0);function Y1(e){return(Y1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X1(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function J1(e,t){return(J1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=t2(e);if(t){var r=t2(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q1(this,n)}}function Q1(e,t){return!t||"object"!==Y1(t)&&"function"!=typeof t?e2(e):t}function e2(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t2(e){return(t2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J1(e,t)}(o,e);var t,n,i,r=Z1(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).smartField=e,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmenPropertyChange.bind(e2(t)),Vo.get().on("propertyChange",t.htmlPropertyChangeHandler),t.smartField.one("remove",function(){Vo.get().off("propertyChange",this.htmlPropertyChangeHandler)}.bind(e2(t))),t}return t=o,(n=[{key:"_initDefaults",value:function(){this.rowHeight=Vo.get().formRowHeight}},{key:"_onHtmlEnvironmenPropertyChange",value:function(){this._initDefaults(),this.smartField.invalidateLayoutTree()}},{key:"layout",value:function(e){var t=Uo.get(e),n=e.children(".multiline-input"),i=e.children(".multiline-lines"),r=t.availableSize().subtract(t.insets());n.cssHeight(this.rowHeight),i.cssHeight(r.height-this.rowHeight)}}])&&X1(t.prototype,n),i&&X1(t,i),o}(zo);function i2(e){return(i2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r2(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o2(e,t,n){return(o2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l2(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function s2(e,t){return(s2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=l2(e);if(t){var r=l2(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u2(this,n)}}function u2(e,t){return!t||"object"!==i2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l2(e){return(l2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s2(e,t)}(o,e);var t,n,i,r=a2(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).maxLength=4e3,e.trimText=!0,e.lookupOnAcceptByText=!1,e}return t=o,(n=[{key:"_getValueFromLookupRow",value:function(e){return e.text}},{key:"_getLastSearchText",value:function(){return this.value}},{key:"cssClassName",value:function(){return"proposal-field"}},{key:"_handleEnterKey",value:function(e){var t=!!this.popup;this.acceptInput(),this.popup&&this.closePopup(),t&&e.stopPropagation()}},{key:"_lookupByTextOrAllDone",value:function(e){if(!o2(l2(o.prototype),"_handleException",this).call(this,e))return 0===e.lookupRows.length?(this.setLoading(!1),void this._handleEmptyResult()):void o2(l2(o.prototype),"_lookupByTextOrAllDone",this).call(this,e)}},{key:"_formatValue",value:function(e){return O.nvl(e,"")}},{key:"_validateValue",value:function(e){if(oi.isNullOrUndefined(e))return e;var t=En.asString(e);return this.trimText&&(t=t.trim()),t.length>this.maxLength&&(t=t.substring(0,this.maxLength)),""===t&&(t=null),t}},{key:"_ensureValue",value:function(e){return En.asString(e)}},{key:"_acceptByText",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("(ProposalField#_acceptByText) searchText=",t),!e&&this.lookupOnAcceptByText&&En.hasText(t)?o2(l2(o.prototype),"_acceptByTextAsync",this).call(this,t):this._customTextAccepted(t)}},{key:"_acceptByTextDone",value:function(e){if(this._userWasTyping=!1,this._extendResult(e),e.uniqueMatch){var t=e.uniqueMatch;if(this._isLookupRowActive(t))return this.setLookupRow(t),void this._inputAccepted()}this._customTextAccepted(e.text)}},{key:"_checkResetLookupRow",value:function(e){return this.lookupRow&&this.lookupRow.text!==e}},{key:"_checkSearchTextChanged",value:function(e){return this._checkDisplayTextChanged(e)}},{key:"_customTextAccepted",value:function(e){this._setLookupRow(null),this._setValue(e),this._inputAccepted(!0,!1)}},{key:"getValueForSelection",value:function(){return this._showSelection()?this.lookupRow.key:null}},{key:"_acceptLookupRowAndValueFromField",value:function(e){this.lookupRow!==e.lookupRow&&this.setLookupRow(e.lookupRow)}},{key:"_copyValuesFromField",value:function(e){this.lookupRow!==e.lookupRow&&this.setLookupRow(e.lookupRow),this.value!==e.value&&this.setValue(e.value)}},{key:"_acceptInput",value:function(e,t,n,i,r){return!r&&this.lookupRow&&this.lookupRow.text===t?(s.a.log.isDebugEnabled()&&s.a.log.debug("(ProposalField#_acceptInput) unchanged: text is equals. Close popup"),void this._inputAccepted(!1)):r?(s.a.log.isDebugEnabled()&&s.a.log.debug("(ProposalField#_acceptInput) lookup-row selected. Set lookup-row, close popup lookupRow=",r.toString()),this.clearErrorStatus(),this.setLookupRow(r),void this._inputAccepted()):(i?this._acceptByText(e,t):this._hasUiError()?this._acceptInputDeferred.resolve():this._inputAccepted(!1),this._acceptInputDeferred.promise())}},{key:"setTrimText",value:function(e){this.setProperty("trimText",e)}},{key:"setMaxLength",value:function(e){this.setProperty("maxLength",e)}},{key:"_updateEmpty",value:function(){this.empty=En.empty(this.value)}}])&&r2(t.prototype,n),i&&r2(t,i),o}(B0);function f2(e){return(f2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h2(e,t){return(h2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=y2(e);if(t){var r=y2(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return p2(this,n)}}function p2(e,t){return!t||"object"!==f2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y2(e){return(y2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h2(e,t)}(n,e);var t=d2(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["lookupRows"]),e}return n}(K0);function b2(e){return(b2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g2(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function m2(e,t,n){return(m2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S2(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _2(e,t){return(_2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S2(e);if(t){var r=S2(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return k2(this,n)}}function k2(e,t){return!t||"object"!==b2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S2(e){return(S2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_2(e,t)}(o,e);var t,n,i,r=w2(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){m2(S2(o.prototype),"_init",this).call(this,e)}},{key:"_renderText",value:function(){var e=this.text;!1===this.lookupRow.active&&(e+=" ("+this.session.text("InactiveState")+")"),this.htmlEnabled?this.$text.html(e):this.$text.textOrNbsp(e)}},{key:"_getStyles",value:function(){return this.lookupRow}},{key:"_decorate",value:function(){this.$node&&(m2(S2(o.prototype),"_decorate",this).call(this),this.$node.toggleClass("inactive",!this.lookupRow.active))}},{key:"isBrowseLoadIncremental",value:function(){return this.proposalChooser.isBrowseLoadIncremental()}},{key:"loadChildren",value:function(){if(this.isBrowseLoadIncremental()){var e=this.lookupRow.key;return this.proposalChooser.smartField.lookupByRec(e)}return s.a.resolvedDeferred()}},{key:"hasChildNodes",value:function(){return!(!this.isBrowseLoadIncremental()||this.childrenLoaded)||m2(S2(o.prototype),"hasChildNodes",this).call(this)}}])&&g2(t.prototype,n),i&&g2(t,i),o}(XL);function T2(e){return(T2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C2(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P2(e,t,n){return(P2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=D2(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function R2(e,t){return(R2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=D2(e);if(t){var r=D2(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return E2(this,n)}}function E2(e,t){return!t||"object"!==T2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D2(e){return(D2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var F2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R2(e,t)}(o,e);var t,n,i,r=x2(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).$container=null,e.$status=null,e.activeFilterGroup=null,e.htmlComp=null,e._updateStatusTimeout=null,e.status=null,e.statusVisible=!0,e.touch=!1,e}return t=o,(n=[{key:"_init",value:function(e){P2(D2(o.prototype),"_init",this).call(this,e),e.smartField||(this.smartField=this.parent.smartField),this.model=this._createModel()}},{key:"_createModel",value:function(e){throw new Error("_createModel() not implemented")}},{key:"setLookupResult",value:function(e){throw new Error("setLookupResult() not implemented")}},{key:"selectFirstLookupRow",value:function(){throw new Error("selectFirstLookupRow() not implemented")}},{key:"clearSelection",value:function(){throw new Error("clearSelection() not implemented")}},{key:"clearLookupRows",value:function(){throw new Error("clearLookupRows() not implemented")}},{key:"triggerLookupRowSelected",value:function(e){(e=e||this.selectedRow())&&e.enabled&&this.trigger("lookupRowSelected",{lookupRow:e.lookupRow})}},{key:"selectedRow",value:function(){throw new Error("selectedRow() not implemented")}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("proposal-chooser").toggleClass("touch",this.touch),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new B2(this)),this._renderModel(),this.$status=this.$container.appendDiv("status").setVisible(!1),this.smartField.activeFilterEnabled&&(this.activeFilterGroup=O.create("RadioButtonGroup",{parent:this,labelVisible:!1,statusVisible:!1,gridColumnCount:B0.ACTIVE_FILTER_VALUES.length}),B0.ACTIVE_FILTER_VALUES.forEach((function(e,t){this._insertActiveFilterButton(e,t)}),this),this.activeFilterGroup.render(),this.activeFilterGroup.$container.addClass("active-filter"),this.activeFilterGroup.removeMandatoryIndicator())}},{key:"_renderModel",value:function(){this.model.render()}},{key:"_renderProperties",value:function(){P2(D2(o.prototype),"_renderProperties",this).call(this),this._updateStatus()}},{key:"delegateEvent",value:function(e){e.originalEvent.smartFieldEvent=!0,this.model.$container.trigger(e)}},{key:"delegateKeyEvent",value:function(e){this.model.$container.trigger(e)}},{key:"_renderStatus",value:function(){this._updateStatus()}},{key:"_renderStatusVisible",value:function(){this._updateStatus()}},{key:"_computeStatusVisible",value:function(){return!(!this.statusVisible||!this.status)}},{key:"_updateStatus",value:function(){clearTimeout(this._updateStatusTimeout),oi.optProperty(this.status,"severity")===pi.Severity.OK?this._updateStatusTimeout=setTimeout(this._updateStatusImpl.bind(this),250):this._updateStatusImpl()}},{key:"_updateStatusImpl",value:function(){if(this.rendered||this.rendering){var e=this.$status.isVisible(),t=this.$status.text(),n=this._computeStatusVisible();e===n&&t===oi.optProperty(this.status,"message")||(s.a.log.isDebugEnabled()&&s.a.log.debug("(ProposalChooser#_updateStatusImpl) $status.visible="+n),this.$status.setVisible(n),this.status?this._setStatusMessage(this.status.message):this.$status.text(""),this.htmlComp.invalidateLayoutTree())}}},{key:"_setStatusMessage",value:function(e){pi.animateStatusMessage(this.$status,e)}},{key:"_insertActiveFilterButton",value:function(e,t){var n=O.create("RadioButton",{parent:this.activeFilterGroup,label:this._activeFilterLabel(t),radioValue:B0.ACTIVE_FILTER_VALUES[t],selected:this.smartField.activeFilter===e,focusWhenSelected:!1,gridDataHints:{useUiWidth:!0}});n.on("propertyChange",function(e){"selected"===e.propertyName&&!0===e.newValue&&this.trigger("activeFilterSelected",{activeFilter:e.source.radioValue})}.bind(this)),this.activeFilterGroup.insertButton(n)}},{key:"setVirtual",value:function(e){this.model instanceof ZP&&this.model.setVirtual(e)}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"setBusy",value:function(e){this.model.setProperty("loading",e),this.model.setProperty("enabled",!e)}},{key:"_activeFilterLabel",value:function(e){return this.smartField.activeFilterLabels[e]}},{key:"updateScrollbars",value:function(){this.model.updateScrollbars()}},{key:"_isProposal",value:function(){return this.smartField instanceof c2}},{key:"_selectProposal",value:function(e,t){this._isProposal()||(e.byAll?this.trySelectCurrentValue():1===t.length&&this.selectFirstLookupRow())}}])&&C2(t.prototype,n),i&&C2(t,i),o}(de);function A2(e){return(A2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $2(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function j2(e,t){return(j2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=L2(e);if(t){var r=L2(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return I2(this,n)}}function I2(e,t){return!t||"object"!==A2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L2(e){return(L2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j2(e,t)}(o,e);var t,n,i,r=M2(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this))._proposalChooser=e,t._typeHandler=t._createTypeHandler(e),t}return t=o,(n=[{key:"_createTypeHandler",value:function(e){var t=e.model.objectType+"LayoutResetter";return O.create(t,e.model)}},{key:"layout",value:function(e){var t,n=Uo.get(e),i=Uo.get(e.children(this._typeHandler.cssSelector)),r=n.size().subtract(n.insets()),o=this._proposalChooser.$status,s=o&&o.isVisible(),a=this._proposalChooser.activeFilterGroup;s&&(r.height-=No.size(o).height),a&&(t=a.htmlComp.prefSize(),r.height-=t.height),i.setSize(r),a&&a.htmlComp.setSize(new Co(r.width,t.height))}},{key:"preferredLayoutSize",value:function(e,t){var n,i,r,o,s,a,u,l=this._proposalChooser.htmlComp,c=this._proposalChooser.$status,f=this._proposalChooser.activeFilterGroup,h=e.parent();return i=r=this._proposalChooser.model.htmlComp.prefSize(t),wf.storeScrollPositions(e,this._proposalChooser.session),a=e.css("width"),u=e.css("height"),e.detach(),this._typeHandler.modifyDom(),e.css("display","inline-block").css("width","auto").css("height","auto"),h.append(e),r.width=No.prefSize(e,{restoreScrollPositions:!1}).width,e.detach(),this._typeHandler.restoreDom(),e.css("display","block").css("width",a).css("height",u),h.append(e),wf.restoreScrollPositions(e,this._proposalChooser.session),c&&c.isVisible()&&(n=c.css("display"),c.css("display","inline-block"),o=No.prefSize(c,{includeMargin:!0,useCssSize:!0}),c.css("display",n),i=new Co(Math.max(i.width,o.width),i.height+o.height)),f&&(s=f.htmlComp.prefSize(),i=new Co(Math.max(i.width,s.width),i.height+s.height)),e.toggleClass("empty",0===r.height),i.add(l.insets())}}])&&$2(t.prototype,n),i&&$2(t,i),o}(zo);function N2(e){return(N2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H2(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function V2(e,t){return(V2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=G2(e);if(t){var r=G2(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return z2(this,n)}}function z2(e,t){return!t||"object"!==N2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G2(e){return(G2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V2(e,t)}(o,e);var t,n,i,r=W2(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_createModel",value:function(){var e=!1,t=[],n=this.smartField.columnDescriptors;n?n.forEach((function(n,i){e=e||!!n.text,t.push(this._createColumnForDescriptor(n))}),this):t.push(this._createColumn());var i=this._createTable(t,e);return i.on("rowClick",this._onRowClick.bind(this)),i}},{key:"_createColumn",value:function(){return O.create("Column",{session:this.session,width:gD.NARROW_MIN_WIDTH,horizontalAlignment:this.smartField.gridData.horizontalAlignment})}},{key:"_createColumnForDescriptor",value:function(e){var t=gD.NARROW_MIN_WIDTH;return e.width&&e.width>0&&(t=e.width),O.create("Column",{session:this.session,text:e.text,cssClass:O.nvl(e.cssClass,null),width:t,autoOptimizeWidth:O.nvl(e.autoOptimizeWidth,!1),fixedWidth:O.nvl(e.fixedWidth,!1),fixedPosition:O.nvl(e.fixedPosition,!1),horizontalAlignment:O.nvl(e.horizontalAlignment,this.smartField.gridData.horizontalAlignment),visible:O.nvl(e.visible,!0),htmlEnabled:O.nvl(e.htmlEnabled,!1)})}},{key:"_createTable",value:function(e,t){return O.create("Table",{parent:this,headerVisible:t,autoResizeColumns:!0,multiSelect:!1,multilineText:!0,scrollToSelection:!0,columns:e,headerMenusEnabled:!1})}},{key:"_onRowClick",value:function(e){var t=e.row;t&&t.enabled&&(this.setBusy(!0),this.triggerLookupRowSelected(t))}},{key:"selectedRow",value:function(){return this.model.selectedRow()}},{key:"setLookupResult",value:function(e){var t=[],n=e.lookupRows,i=!!this.smartField.columnDescriptors;this.model.deleteAllRows(),n.forEach((function(e){t.push(this._createTableRow(e,i))}),this),this.model.insertRows(t),this._selectProposal(e,t)}},{key:"trySelectCurrentValue",value:function(){var e=this.smartField.getValueForSelection();if(!oi.isNullOrUndefined(e)){var t=et.find(this.model.rows,(function(t){return t.lookupRow.key===e}));t&&this.model.selectRow(t)}}},{key:"selectFirstLookupRow",value:function(){this.model.rows.length&&this.model.selectRow(this.model.rows[0])}},{key:"clearSelection",value:function(){this.model.deselectAll()}},{key:"clearLookupRows",value:function(){this.model.removeAllRows()}},{key:"_createTableRow",value:function(e,t){var n=QX.createTableRow(e,t);return t&&et.pushAll(n.cells,this._transformTableRowData(e,e.additionalTableRowData)),n}},{key:"_renderModel",value:function(){this.model.setVirtual(this.smartField.virtual()),this.model.render(),this.model.$container.setTabbable(!1),this.model.$container.addClass("focused")}},{key:"getSelectedLookupRow",value:function(){var e=this.model.selectedRow();return e?e.lookupRow:null}},{key:"_transformTableRowData",value:function(e,t){var n=this.smartField.columnDescriptors,i=[];return n.forEach((function(n){i.push(QX.createTableCell(e,n,t))})),i}}])&&H2(t.prototype,n),i&&H2(t,i),o}(F2);function K2(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var q2=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._table=t,this._fillerWidth=null,this.cssSelector=".table"}var t,n,i;return t=e,(n=[{key:"modifyDom",value:function(){this._table.$container.css("display","inline-block").css("width","auto").css("height","auto"),this._table.$data.css("display","inline-block"),this._modifyFiller(this._table.$fillBefore),this._modifyFiller(this._table.$fillAfter),this._modifyTableData(this._cssBackup)}},{key:"restoreDom",value:function(){this._table.$container.css("display","block").css("width","100%").css("height","100%"),this._table.$data.css("display","block"),this._restoreFiller(this._table.$fillBefore),this._restoreFiller(this._table.$fillAfter),this._modifyTableData(this._cssRestore)}},{key:"_cssBackup",value:function(e,t){var n=e.css(t);e.css(t,"").data("backup"+t,n)}},{key:"_cssRestore",value:function(e,t){var n="backup"+t,i=e.data(n);e.css(t,i).removeData(n)}},{key:"_modifyTableData",value:function(e){var t=this;this._table.$rows().each((function(){var n=s()(this);e(n,"width"),t._table.$cellsForRow(n).each((function(){var t=s()(this);e(t,"min-width"),e(t,"max-width")}))}))}},{key:"_modifyFiller",value:function(e){e&&(this._fillerWidth=e.css("width"),e.css("width",""))}},{key:"_restoreFiller",value:function(e){e&&e.css("width",this._fillerWidth)}}])&&K2(t.prototype,n),i&&K2(t,i),e}();function Y2(e){return(Y2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X2(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function J2(e,t){return(J2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=e3(e);if(t){var r=e3(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q2(this,n)}}function Q2(e,t){return!t||"object"!==Y2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function e3(e){return(e3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var t3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J2(e,t)}(o,e);var t,n,i,r=Z2(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_createModel",value:function(){var e=O.create("Tree",{parent:this,requestFocusOnNodeControlMouseDown:!1,scrollToSelection:!0});return e.on("nodeClick",this._onNodeClick.bind(this)),e}},{key:"_onNodeClick",value:function(e){this.triggerLookupRowSelected(e.node)}},{key:"selectedRow",value:function(){return this.model.selectedNode()}},{key:"isBrowseLoadIncremental",value:function(){return this.smartField.browseLoadIncremental}},{key:"getSelectedLookupRow",value:function(){var e=this.model.selectedNode();return e?e.lookupRow:null}},{key:"selectFirstLookupRow",value:function(){this.model.nodes.length&&this.model.selectNode(this.model.nodes[0])}},{key:"clearSelection",value:function(){this.model.deselectAll()}},{key:"setLookupResult",value:function(e){var t,n,i=e.lookupRows;if(O.nvl(e.appendResult,!1))if(n=i.map(this._createTreeNode.bind(this)),(t=this._flatListToSubTree(n)).length){var r=null;t.forEach(function(e){r=this.model.nodesMap[e.parentId],this._appendChildNode(r,e)}.bind(this)),r&&this.model.insertNodes(t,r)}else{var o=this.model.nodesMap[e.rec];o.leaf=!0,o.childrenLoaded=!0,this.model.updateNode(o)}else this.model.deleteAllChildNodes(),n=i.map(this._createTreeNode.bind(this)),t=this._flatListToSubTree(n),e.byText&&this._expandAllParentNodes(n),this.model.insertNodes(t);this._selectProposal(e,n)}},{key:"_expandAllParentNodes",value:function(e){e.reduce((function(e,t){return(t.leaf||!t.childNodesLoaded&&0===t.childNodes.length)&&e.push(t),e}),[]).forEach(function(e){if(e.parentNode&&!e.parentNode.expanded)for(e=e.parentNode;e;)this.model.setNodeExpanded(e,!0),e=e.parentNode}.bind(this))}},{key:"trySelectCurrentValue",value:function(){var e=this.smartField.getValueForSelection();if(!oi.isNullOrUndefined(e)){var t=oi.values(this.model.nodesMap),n=et.find(t,(function(t){return t.lookupRow.key===e}));n&&this.model.selectNode(n)}}},{key:"_createTreeNode",value:function(e){var t=!0,n=this.smartField.browseAutoExpandAll;return this.isBrowseLoadIncremental()&&(n=!1,t=!1),O.create("ProposalTreeNode",{parent:this.model,proposalChooser:this,childNodeIndex:0,enabled:e.enabled,htmlEnabled:!1,iconId:e.iconId,id:e.key,parentId:e.parentKey,expanded:n,initialExpanded:n,text:e.text,lookupRow:e,leaf:t,tooltipText:e.tooltipText})}},{key:"findLeafs",value:function(){var e=[];return NL.visitNodes((function(t,n){!t.leaf&&t.childNodes.length||e.push(t)}),this.model.nodes),e}},{key:"_flatListToSubTree",value:function(e){var t={};e.forEach((function(e){t[e.id]=e}));var n=[];return e.forEach(function(e){var i=t[e.parentId];i?this._appendChildNode(i,e):(e.childNodeIndex=n.length,e.parentNode=null,n.push(e))}.bind(this)),n}},{key:"_appendChildNode",value:function(e,t){e.childNodes||(e.childNodes=[]),t.childNodeIndex=e.childNodes.length,t.parentNode=e,e.childNodes.push(t),e.leaf=!1,e.childrenLoaded=!0}},{key:"clearLookupRows",value:function(){this.model.deleteAllNodes()}}])&&X2(t.prototype,n),i&&X2(t,i),o}(F2);function n3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i3=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._tree=t,this.cssSelector=".tree"}var t,n,i;return t=e,(n=[{key:"modifyDom",value:function(){this._ensureFirstLast(),this._tree.$container.css("display","inline-block").css("width","auto").css("height","auto"),this._tree.$data.css("display","inline-block")}},{key:"restoreDom",value:function(){this._tree.$container.css("display","block").css("width","100%").css("height","100%"),this._tree.$data.css("display","block")}},{key:"_ensureFirstLast",value:function(){var e=this._tree.$data.children(".tree-node").removeClass("first last");e.first().addClass("first"),e.last().addClass("last")}}])&&n3(t.prototype,n),i&&n3(t,i),e}();function r3(e){return(r3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s3(e,t,n){return(s3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c3(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function a3(e,t){return(a3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=c3(e);if(t){var r=c3(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l3(this,n)}}function l3(e,t){return!t||"object"!==r3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c3(e){return(c3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f3(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a3(e,t)}(o,e);var t,n,i,r=u3(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["firstField","secondField","collapsibleField"]),e._addPreserveOnPropertyChangeProperties(["collapsibleField"]),e.firstField=null,e.secondField=null,e.collapsibleField=null,e.fieldCollapsed=!1,e.toggleCollapseKeyStroke=null,e.firstCollapseKeyStroke=null,e.secondCollapseKeyStroke=null,e.splitHorizontal=!0,e.splitterEnabled=!0,e.splitterPosition=.5,e.minSplitterPosition=0,e.splitterPositionType=o.SPLITTER_POSITION_TYPE_RELATIVE_FIRST,e.fieldMinimized=!1,e.minimizeEnabled=!0,e._$splitArea=null,e._$splitter=null,e}return t=o,(n=[{key:"_init",value:function(e){s3(c3(o.prototype),"_init",this).call(this,e),this._setToggleCollapseKeyStroke(this.toggleCollapseKeyStroke),this._setFirstCollapseKeyStroke(this.firstCollapseKeyStroke),this._setSecondCollapseKeyStroke(this.secondCollapseKeyStroke),this._updateCollapseHandle(),this._initResponsive()}},{key:"_initResponsive",value:function(){this.getFields().forEach((function(e){e instanceof rY&&null===e.responsive&&e.setResponsive(!0)}))}},{key:"_render",value:function(){function e(e){"visible"===e.propertyName&&(this._updateFieldVisibilityClasses(),this.htmlSplitArea.invalidateLayoutTree(!1))}this.addContainer(this.$parent,"split-box"),this._$splitArea=this.$parent.makeDiv("split-area"),this.addField(this._$splitArea),this.htmlSplitArea=Uo.install(this._$splitArea,this.session),this.htmlSplitArea.setLayout(new q3(this)),this._$window=this.$parent.window(),this._$body=this.$parent.body(),this.firstField&&(this.firstField.render(this._$splitArea),this.firstField.$container.addClass("first-field").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.firstField.on("propertyChange",e.bind(this)),this.secondField&&(this.secondField.render(this._$splitArea),this.secondField.$container.addClass("second-field").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.secondField.on("propertyChange",e.bind(this)),this._$splitter=this._$splitArea.appendDiv("splitter").addClass(this.splitHorizontal?"x-axis":"y-axis").on("mousedown",function(e){if(1===e.which){if(this.splitterEnabled){var t={x:e.pageX,y:e.pageY};this._$window.on("mousemove.splitbox",function(e){if(e.pageX!==t.x||e.pageY!==t.y)if(t={x:e.pageX,y:e.pageY},this.splitHorizontal){var r,s,c=e.pageX-n.left,f=Math.floor((a.width+Vo.get().fieldMandatoryIndicatorWidth)/2);this.splitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST?(r=O.nvl(this.minSplitterPosition,0),s=i.width-a.width+f):this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?(r=(i.width-a.width)*O.nvl(this.minSplitterPosition,0),s=i.width-a.width+f):this.splitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND?(r=0,s=i.width-a.width+f-O.nvl(this.minSplitterPosition,0)):this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_SECOND&&(r=0,s=i.width-a.width+f-Math.floor(O.nvl(this.minSplitterPosition,0)*(i.width-a.width)));var h=f;c<r+f+10?(c=r,h=0):c>s-10&&(c=s),u.cssLeft(c-h),l=c-h,this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?l/=i.width-a.width:this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?l=1-l/(i.width-a.width):this.splitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND&&(l=i.width-a.width-l)}else{var d=e.pageY-n.top,p=Math.floor(a.height/2);d<10?(d=0,p=0):i.height-d<10&&(d=i.height,p=a.height),u.cssTop(d-p),l=d-p,this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?l/=i.height-a.height:this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?l=1-l/(i.height-a.height):this.splitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND&&(l=i.height-l-a.height)}}.bind(this)).on("mouseup.splitbox",function(e){1===e.which&&(this._$window.off("mousemove.splitbox").off("mouseup.splitbox"),u&&(this._$body.removeClass(this.splitHorizontal?"col-resize":"row-resize"),s()("iframe").removeClass("dragging-in-progress"),u.remove(),this._$splitter.removeClass("dragging"),this.newSplitterPosition(l,!0)))}.bind(this)),this._$body.addClass(this.splitHorizontal?"col-resize":"row-resize"),s()("iframe").addClass("dragging-in-progress");var n=this._$splitArea.offset(),i=No.size(this._$splitArea,!0),r=this._$splitter.offset(),a=No.size(this._$splitter,!0),u=this._$splitArea.appendDiv("temp-splitter").addClass(this.splitHorizontal?"x-axis":"y-axis");this.splitHorizontal?u.cssLeft(r.left-n.left):u.cssTop(r.top-n.top),this._$splitter.addClass("dragging")}var l=this.splitterPosition;return!1}}.bind(this)))),this._updateFieldVisibilityClasses()}},{key:"_renderProperties",value:function(){s3(c3(o.prototype),"_renderProperties",this).call(this),this._renderSplitterPosition(),this._renderSplitterEnabled(),this._renderCollapsibleField(),this._renderCollapseHandle(),this._renderFieldMinimized()}},{key:"_remove",value:function(){this._$splitArea=null,this._$splitter=null,s3(c3(o.prototype),"_remove",this).call(this)}},{key:"_setSplitterPosition",value:function(e){this._setProperty("splitterPosition",e),this._oldSplitterPositionType=null}},{key:"_renderSplitterPosition",value:function(){this.newSplitterPosition(this.splitterPosition,!1)}},{key:"_setSplitterPositionType",value:function(e){this.rendered&&!this._oldSplitterPositionType&&(this._oldSplitterPositionType=this.splitterPositionType),this._setProperty("splitterPositionType",e)}},{key:"_renderSplitterPositionType",value:function(){if(this._oldSplitterPositionType){var e=this.htmlSplitArea.size(),t=this.splitterPosition,n=No.size(this._$splitter,!0),i=this.minSplitterPosition,r=0;r=this.splitHorizontal?e.width-n.width:e.height-n.height;var s=this._isSplitterPositionTypeRelative(this._oldSplitterPositionType),a=this._isSplitterPositionTypeRelative(this.splitterPositionType),u=!s,l=!a;s&&l?(this._oldSplitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_FIRST&&this.splitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND||this._oldSplitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_SECOND&&this.splitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST?t=r-r*t:t*=r,i&&(i*=r)):u&&a?(this._oldSplitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST&&this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_SECOND||this._oldSplitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND&&this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?t=(r-t)/r:t/=r,i&&(i/=r)):t=u&&l?r-t:1-t,this.setMinSplitterPosition(i),this._oldSplitterPositionType=null,this.newSplitterPosition(t,!0)}}},{key:"_isSplitterPositionTypeRelative",value:function(e){return e===o.SPLITTER_POSITION_TYPE_RELATIVE_FIRST||e===o.SPLITTER_POSITION_TYPE_RELATIVE_SECOND}},{key:"_renderSplitterEnabled",value:function(){this._$splitter&&this._$splitter.setEnabled(this.splitterEnabled)}},{key:"setFieldCollapsed",value:function(e){this.setProperty("fieldCollapsed",e),this._updateCollapseHandleButtons()}},{key:"_renderFieldCollapsed",value:function(){this._renderCollapsibleField()}},{key:"setCollapsibleField",value:function(e){this.setProperty("collapsibleField",e),this._updateCollapseHandle()}},{key:"_updateCollapseHandle",value:function(){if(this.toggleCollapseKeyStroke&&this.unregisterKeyStrokes(this.toggleCollapseKeyStroke),this.firstCollapseKeyStroke&&this.unregisterKeyStrokes(this.firstCollapseKeyStroke),this.secondCollapseKeyStroke&&this.unregisterKeyStrokes(this.secondCollapseKeyStroke),this.collapsibleField){var e=_c.HorizontalAlignment.LEFT;this.collapsibleField!==this.firstField&&(e=_c.HorizontalAlignment.RIGHT),this._collapseHandle?this._collapseHandle.setHorizontalAlignment(e):(this._collapseHandle=O.create("CollapseHandle",{parent:this,horizontalAlignment:e}),this._collapseHandle.on("action",this.collapseHandleButtonPressed.bind(this)),this.toggleCollapseKeyStroke&&this.registerKeyStrokes(this.toggleCollapseKeyStroke),this.firstCollapseKeyStroke&&this.registerKeyStrokes(this.firstCollapseKeyStroke),this.secondCollapseKeyStroke&&this.registerKeyStrokes(this.secondCollapseKeyStroke),this.rendered&&this._renderCollapseHandle()),this._updateCollapseHandleButtons()}else this._collapseHandle&&(this._collapseHandle.destroy(),this._collapseHandle=null)}},{key:"_updateCollapseHandleButtons",value:function(){if(this._collapseHandle){var e,t,n=this.fieldCollapsed,i=this.fieldMinimized,r=this._isMinimizable(),s=this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_FIRST||this.splitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST,a=s&&this.collapsibleField===this.secondField||!s&&this.collapsibleField===this.firstField;s?a?(e=!i&&r||n,t=!n):(e=!n,t=n||i&&r):a?(e=!n,t=!i&&r||n):(e=n||i&&r,t=!n),this._collapseHandle.setLeftVisible(e),this._collapseHandle.setRightVisible(t),this.firstCollapseKeyStroke&&(e?this.registerKeyStrokes(this.firstCollapseKeyStroke):this.unregisterKeyStrokes(this.firstCollapseKeyStroke)),this.secondCollapseKeyStroke&&(t?this.registerKeyStrokes(this.secondCollapseKeyStroke):this.unregisterKeyStrokes(this.secondCollapseKeyStroke))}}},{key:"getEffectiveSplitterPosition",value:function(){return this._isMinimizable()&&this.fieldMinimized?this.minSplitterPosition:this.splitterPosition}},{key:"setMinSplitterPosition",value:function(e){this.setProperty("minSplitterPosition",e),this._updateCollapseHandleButtons()}},{key:"_renderMinSplitterPosition",value:function(){this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}},{key:"setFieldMinimized",value:function(e){this.setProperty("fieldMinimized",e),this._updateCollapseHandleButtons()}},{key:"_renderFieldMinimized",value:function(){this.$container.removeClass("first-field-minimized second-field-minimized"),this.firstField&&this.firstField.$container.removeClass("minimized"),this.secondField&&this.secondField.$container.removeClass("minimized"),this.collapsibleField&&this.fieldMinimized&&(this.collapsibleField.$container.addClass("minimized"),this.$container.toggleClass("first-field-minimized",this.firstField===this.collapsibleField),this.$container.toggleClass("second-field-minimized",this.secondField===this.collapsibleField)),this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}},{key:"setMinimizeEnabled",value:function(e){this.setProperty("minimizeEnabled",e),this._isMinimizable()&&this._isSplitterPositionInMinimalRange(this.splitterPosition)&&this.setFieldMinimized(!0),this._updateCollapseHandleButtons()}},{key:"_renderMinimizeEnabled",value:function(){this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}},{key:"_isMinimizable",value:function(){return!!this.minSplitterPosition&&this.minimizeEnabled}},{key:"_renderCollapsibleField",value:function(){this.$container.removeClass("first-field-collapsed second-field-collapsed"),this.firstField&&this.firstField.$container.removeClass("collapsed"),this.secondField&&this.secondField.$container.removeClass("collapsed"),this.collapsibleField&&this.fieldCollapsed&&(this.collapsibleField.$container.addClass("collapsed"),this.$container.toggleClass("first-field-collapsed",this.firstField===this.collapsibleField),this.$container.toggleClass("second-field-collapsed",this.secondField===this.collapsibleField)),this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}},{key:"_setToggleCollapseKeyStroke",value:function(e){e&&(this.toggleCollapseKeyStroke instanceof $u&&this.unregisterKeyStrokes(this.collapseKeyStroke),this.toggleCollapseKeyStroke=new P3(this,e),this._collapseHandle&&this.registerKeyStrokes(this.toggleCollapseKeyStroke))}},{key:"_setFirstCollapseKeyStroke",value:function(e){e&&(this.firstCollapseKeyStroke instanceof $u&&this.unregisterKeyStrokes(this.firstCollapseKeyStroke),this.firstCollapseKeyStroke=new $3(this,e),this._collapseHandle&&this.registerKeyStrokes(this.firstCollapseKeyStroke))}},{key:"_setSecondCollapseKeyStroke",value:function(e){e&&(this.secondCollapseKeyStroke instanceof $u&&this.unregisterKeyStrokes(this.secondCollapseKeyStroke),this.secondCollapseKeyStroke=new H3(this,e),this._collapseHandle&&this.registerKeyStrokes(this.secondCollapseKeyStroke))}},{key:"_renderCollapseHandle",value:function(){this._collapseHandle&&this._collapseHandle.render()}},{key:"newSplitterPosition",value:function(e,t){if(e=this._isSplitterPositionTypeRelative(this.splitterPositionType)?Math.max(0,Math.min(1,e)):Math.max(0,e),this._isMinimizable()&&this._isSplitterPositionInMinimalRange(e))this.setFieldMinimized(!0);else{var n=this.splitterPosition!==e;this.splitterPosition=e,n&&(this.trigger("positionChange",{position:e}),t&&this._updateFieldMinimized()),this._updateCollapseHandleButtons(),this.htmlSplitArea.invalidateLayoutTree(!1)}}},{key:"_updateFieldMinimized",value:function(){this._isMinimizable()?this.setFieldMinimized(this._isSplitterPositionInMinimalRange(this.splitterPosition)):this.setFieldMinimized(!1)}},{key:"_isSplitterPositionInMinimalRange",value:function(e){return!!this._isMinimizable()&&e<=this.minSplitterPosition}},{key:"toggleFieldCollapsed",value:function(){this.setFieldCollapsed(!this.fieldCollapsed)}},{key:"collapseHandleButtonPressed",value:function(e){var t=this.fieldCollapsed,n=this.fieldMinimized,i=this._isMinimizable(),r=this.splitterPositionType===o.SPLITTER_POSITION_TYPE_RELATIVE_FIRST||this.splitterPositionType===o.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST,s=!!e.left&&!r||!!e.right&&r;r&&this.collapsibleField===this.secondField||!r&&this.collapsibleField===this.firstField?s?t||(n&&i?this.setFieldMinimized(!1):this.setFieldCollapsed(!0)):t?this.setFieldCollapsed(!1):n||i&&this.setFieldMinimized(!0):s?t?this.setFieldCollapsed(!1):n&&this.setFieldMinimized(!1):t||(n||!i?this.setFieldCollapsed(!0):this.setFieldMinimized(!0))}},{key:"getFields",value:function(){var e=[];return this.firstField&&e.push(this.firstField),this.secondField&&e.push(this.secondField),e}},{key:"_updateFieldVisibilityClasses",value:function(){if(this.rendered||this.rendering){var e=this.firstField&&this.firstField.isVisible(),t=this.secondField&&this.secondField.isVisible(),n=!(e&&t)&&(e||t);this.$container.toggleClass("single-field",n)}}}])&&o3(t.prototype,n),i&&o3(t,i),o}(EV);function d3(e){return(d3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function y3(e,t,n){return(y3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m3(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function v3(e,t){return(v3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=m3(e);if(t){var r=m3(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g3(this,n)}}function g3(e,t){return!t||"object"!==d3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m3(e){return(m3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}f3(h3,"SPLITTER_POSITION_TYPE_RELATIVE_FIRST","relativeFirst"),f3(h3,"SPLITTER_POSITION_TYPE_RELATIVE_SECOND","relativeSecond"),f3(h3,"SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST","absoluteFirst"),f3(h3,"SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND","absoluteSecond");var _3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v3(e,t)}(o,e);var t,n,i,r=b3(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["collapsibleField","fieldCollapsed","minSplitterPosition","fieldMinimized"]),e}return t=o,(n=[{key:"_onWidgetPositionChange",value:function(e){this._send("setSplitterPosition",{splitterPosition:e.position})}},{key:"_onWidgetEvent",value:function(e){"positionChange"===e.type?this._onWidgetPositionChange(e):y3(m3(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&p3(t.prototype,n),i&&p3(t,i),o}(MV);function w3(e){return(w3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function S3(e,t){return(S3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=C3(e);if(t){var r=C3(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return T3(this,n)}}function T3(e,t){return!t||"object"!==w3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C3(e){return(C3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S3(e,t)}(o,e);var t,n,i,r=O3(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).field=e,n.parseAndSetKeyStroke(t),n}return t=o,(n=[{key:"handle",value:function(e){this.field.toggleFieldCollapsed()}},{key:"_postRenderKeyBox",value:function(e,t){var n,i=this.field._collapseHandle.$container;t.addClass("split-box-collapse-key-box"),n=i.offsetTo(this.field.$container),t.cssLeft(n.left-t.outerWidth()).cssTop(n.top)}}])&&k3(t.prototype,n),i&&k3(t,i),o}($u);function R3(e){return(R3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function E3(e,t){return(E3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=A3(e);if(t){var r=A3(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return F3(this,n)}}function F3(e,t){return!t||"object"!==R3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A3(e){return(A3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E3(e,t)}(o,e);var t,n,i,r=D3(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).field=e,n.parseAndSetKeyStroke(t),n}return t=o,(n=[{key:"handle",value:function(e){this.field.collapseHandleButtonPressed({left:!0})}},{key:"_postRenderKeyBox",value:function(e,t){var n,i=this.field._collapseHandle.$container;t.addClass("split-box-collapse-key-box left"),n=i.offsetTo(this.field.$container),t.cssLeft(n.left-t.outerWidth()).cssTop(n.top)}}])&&x3(t.prototype,n),i&&x3(t,i),o}($u);function j3(e){return(j3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function I3(e,t){return(I3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=N3(e);if(t){var r=N3(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return B3(this,n)}}function B3(e,t){return!t||"object"!==j3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N3(e){return(N3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I3(e,t)}(o,e);var t,n,i,r=L3(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).field=e,n.parseAndSetKeyStroke(t),n}return t=o,(n=[{key:"handle",value:function(e){this.field.collapseHandleButtonPressed({right:!0})}},{key:"_postRenderKeyBox",value:function(e,t){var n,i=this.field._collapseHandle.$container;t.addClass("split-box-collapse-key-box right"),n=i.offsetTo(this.field.$container),t.cssLeft(n.left+i.width()-t.outerWidth()).cssTop(n.top-t.outerHeight())}}])&&M3(t.prototype,n),i&&M3(t,i),o}($u);function V3(e){return(V3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function z3(e,t){return(z3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=K3(e);if(t){var r=K3(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U3(this,n)}}function U3(e,t){return!t||"object"!==V3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K3(e){return(K3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var q3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z3(e,t)}(o,e);var t,n,i,r=G3(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).splitBox=e,t}return t=o,(n=[{key:"layout",value:function(e){var t=Uo.get(e),n=e.children(".splitter"),i=e.children(".form-field"),r=Uo.optGet(i.eq(0)),o=Uo.optGet(i.eq(1)),s=this.splitBox.splitHorizontal;n.removeClass("hidden");var a,u,l,c,f=t.availableSize().subtract(t.insets()),h=r&&r.isVisible(),d=o&&o.isVisible(),p=h&&d,y=!p&&(h||d),v=this.splitBox.getEffectiveSplitterPosition(),b=new Co(f);if(p&&(s?b.width-=r.margins().right:b.height-=r.margins().bottom),p)a=new Co(b),u=new Co(b),this.computeInnerFieldsDimensions(s,a,u,v),l=new Fo(0,0,a.width,a.height),c=new Fo(0,0,u.width,u.height),s?(n.cssLeft(l.width),c.x=l.width+r.margins().right):(n.cssTop(l.height),c.y=l.height+r.margins().bottom),r.setBounds(l),o.setBounds(c);else{if(y){var g=h?r:o,m=f.subtract(g.margins());g.setBounds(new Fo(0,0,m.width,m.height))}n.addClass("hidden")}if(this.splitBox._collapseHandle){var _=this.splitBox._collapseHandle.$container,w=this.splitBox.firstField&&this.splitBox.firstField.visible&&this.splitBox.secondField&&this.splitBox.secondField.visible;_.setVisible(w);var k=null;if(p&&this.splitBox.collapsibleField===this.splitBox.firstField){var S=No.size(_);k=l.width-S.width}_.cssLeft(k)}}},{key:"preferredLayoutSize",value:function(e,t){var n=Uo.get(e),i=e.children(".form-field"),r=Uo.optGet(i.eq(0)),o=Uo.optGet(i.eq(1)),a=this.splitBox.splitHorizontal,u=this.splitBox.getEffectiveSplitterPosition(),l=s.a.extend({},t),c=s.a.extend({},t);if(t.widthHint){var f=new Co(t.widthHint,0),h=new Co(t.widthHint,0);this.computeInnerFieldsDimensions(a,f,h,u),l.widthHint=f.width,c.widthHint=h.width}var d=new Co(0,0);r&&(d=r.prefSize(l).add(r.margins()));var p=new Co(0,0);return o&&(p=o.prefSize(c).add(o.margins())),(a?new Co(d.width+p.width,Math.max(d.height,p.height)):new Co(Math.max(d.width,p.width),d.height+p.height)).add(n.insets())}},{key:"computeInnerFieldsDimensions",value:function(e,t,n,i){e?this.splitBox.splitterPositionType===h3.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?(t.width=Math.floor(t.width*i),n.width-=t.width):this.splitBox.splitterPositionType===h3.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?(n.width=Math.floor(n.width*i),t.width-=n.width):(i=Math.min(i,t.width),this.splitBox.splitterPositionType===h3.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND?(t.width=t.width-i,n.width=i):(t.width=i,n.width=n.width-i)):this.splitBox.splitterPositionType===h3.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?(t.height=Math.floor(t.height*i),n.height-=t.height):this.splitBox.splitterPositionType===h3.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?(n.height=Math.floor(n.height*i),t.height-=n.height):(i=Math.min(i,t.height),this.splitBox.splitterPositionType===h3.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND?(t.height=t.height-i,n.height=i):(t.height=i,n.height=n.height-i))}}])&&W3(t.prototype,n),i&&W3(t,i),o}(zo);function Y3(e){return(Y3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function J3(e,t,n){return(J3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n5(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Z3(e,t){return(Z3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=n5(e);if(t){var r=n5(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return e5(this,n)}}function e5(e,t){return!t||"object"!==Y3(t)&&"function"!=typeof t?t5(e):t}function t5(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n5(e){return(n5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i5(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var r5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z3(e,t)}(o,e);var t,n,i,r=Q3(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).format,e.hasAction=!1,e.inputMasked=!1,e.inputObfuscated=!1,e.maxLength=4e3,e.multilineText=!1,e.selectionStart=0,e.selectionEnd=0,e.selectionTrackingEnabled=!1,e.spellCheckEnabled=!1,e.trimText=!0,e.wrapText=!1,e._onSelectionChangingActionHandler=e._onSelectionChangingAction.bind(t5(e)),e}return t=o,(n=[{key:"_initValue",value:function(e){e=th.resolveText(e,this.session.locale.languageTag),J3(n5(o.prototype),"_initValue",this).call(this,e)}},{key:"_initKeyStrokeContext",value:function(){J3(n5(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new R5(this),new M5(this)])}},{key:"_createKeyStrokeContext",value:function(){return new Fu}},{key:"_render",value:function(){var e;this.addContainer(this.$parent,"string-field",new h5(this)),this.addLabel(),this.addMandatoryIndicator(),this.multilineText?(e=this._makeMultilineField(),this.$container.addClass("multiline")):e=gH.makeTextField(this.$parent),e.on("paste",this._onFieldPaste.bind(this)),this.addField(e),this.addStatus()}},{key:"_makeMultilineField",value:function(){var e=function(){this.mouseClicked=!0}.bind(this);return this.$parent.makeElement("<textarea>").on("DOMMouseScroll mousewheel",this._onMouseWheel.bind(this)).on("mousedown",e).on("focus",function(t){this.$field.off("mousedown",e),this.mouseClicked||setTimeout(function(){this.rendered&&!this.session.focusManager.isElementCovertByGlassPane(this.$field)&&(this._renderSelectionStart(),this._renderSelectionEnd())}.bind(this)),this.mouseClicked=!1}.bind(this)).on("focusout",function(){this.$field.on("mousedown",e)}.bind(this)).addDeviceClass()}},{key:"_onFieldBlur",value:function(){J3(n5(o.prototype),"_onFieldBlur",this).call(this),this.multilineText&&this._updateSelection(),this.inputObfuscated&&this.$field.val(this.displayText)}},{key:"_onMouseWheel",value:function(e){var t=(e=e.originalEvent||this.$container.window(!0).event.originalEvent).wheelDelta?-e.wheelDelta:e.detail,n=this.$field[0].scrollTop;if(!(t<0&&0===n)){var i=this.$field[0].scrollHeight-this.$field[0].clientHeight;t>0&&n>=i-1?this.$field[0].scrollTop=i:e.stopPropagation()}}},{key:"_renderProperties",value:function(){J3(n5(o.prototype),"_renderProperties",this).call(this),this._renderInputMasked(),this._renderWrapText(),this._renderFormat(),this._renderSpellCheckEnabled(),this._renderHasAction(),this._renderMaxLength(),this._renderSelectionTrackingEnabled(),this._renderDropType()}},{key:"addIcon",value:function(){this.$icon=gH.appendIcon(this.$container).on("click",this._onIconClick.bind(this))}},{key:"isClearable",value:function(){return J3(n5(o.prototype),"isClearable",this).call(this)&&!this.multilineText}},{key:"setMaxLength",value:function(e){this.setProperty("maxLength",e)}},{key:"_renderMaxLength",value:function(){function e(){var e=this.$field.val();e.length>this.maxLength&&this.$field.val(e.slice(0,this.maxLength))}this.$field[0].maxLength?this.$field.attr("maxlength",this.maxLength):this.$field.on("keyup paste",function(t){setTimeout(e.bind(this),0)}.bind(this)),e.call(this),this.rendering||this.parseAndSetValue(this._readDisplayText())}},{key:"setSelectionStart",value:function(e){this.setProperty("selectionStart",e)}},{key:"_renderSelectionStart",value:function(){null!==O.nvl(this.selectionStart,null)&&(this.$field[0].selectionStart=this.selectionStart)}},{key:"setSelectionEnd",value:function(e){this.setProperty("selectionEnd",e)}},{key:"_renderSelectionEnd",value:function(){null!==O.nvl(this.selectionEnd,null)&&(this.$field[0].selectionEnd=this.selectionEnd)}},{key:"setSelectionTrackingEnabled",value:function(e){this.setProperty("selectionTrackingEnabled",e)}},{key:"_renderSelectionTrackingEnabled",value:function(){this.$field.off("select",this._onSelectionChangingActionHandler).off("mousedown",this._onSelectionChangingActionHandler).off("keydown",this._onSelectionChangingActionHandler).off("input",this._onSelectionChangingActionHandler),this.selectionTrackingEnabled&&this.$field.on("select",this._onSelectionChangingActionHandler).on("mousedown",this._onSelectionChangingActionHandler).on("keydown",this._onSelectionChangingActionHandler).on("input",this._onSelectionChangingActionHandler)}},{key:"setInputMasked",value:function(e){this.setProperty("inputMasked",e)}},{key:"_renderInputMasked",value:function(){this.multilineText||this.$field.attr("type",this.inputMasked?"password":"text")}},{key:"_renderInputObfuscated",value:function(){this.inputObfuscated&&this.focused&&this.$field.val("")}},{key:"setHasAction",value:function(e){this.setProperty("hasAction",e)}},{key:"_renderHasAction",value:function(){this.hasAction?(this.$icon||this.addIcon(),this.$container.addClass("has-icon")):(this._removeIcon(),this.$container.removeClass("has-icon")),this.revalidateLayout()}},{key:"setFormatUpper",value:function(e){e?this.setFormat(o.Format.UPPER):this.setFormat(null)}},{key:"setFormatLower",value:function(e){e?this.setFormat(o.Format.LOWER):this.setFormat(null)}},{key:"setFormat",value:function(e){this.setProperty("format",e)}},{key:"_renderFormat",value:function(){this.format===o.Format.LOWER?this.$field.css("text-transform","lowercase"):this.format===o.Format.UPPER?this.$field.css("text-transform","uppercase"):this.$field.css("text-transform","")}},{key:"setSpellCheckEnabled",value:function(e){this.setProperty("spellCheckEnabled",e)}},{key:"_renderSpellCheckEnabled",value:function(){this.spellCheckEnabled?this.$field.attr("spellcheck","true"):this.$field.attr("spellcheck","false")}},{key:"_renderDisplayText",value:function(){if(this.inputObfuscated&&this.focused)this.$field.val("");else{var e=En.nvl(this.displayText),t=En.nvl(this.$field.val()),n=this._getSelection();if(J3(n5(o.prototype),"_renderDisplayText",this).call(this),this.trimText&&t!==e){var i=t.match(o.TRIM_REGEXP);i&&i[2]===e&&this._setSelection({start:Math.max(n.start-i[1].length,0),end:Math.min(n.end-i[1].length,e.length)})}}}},{key:"insertText",value:function(e){this.rendered?this._insertText(e):this._postRenderActions.push(this.insertText.bind(this,e))}},{key:"_insertText",value:function(e){if(e){var t=this._getSelection(),n=this._applyTextToSelection(this.$field.val(),e,t);n.length>this.maxLength?this._showNotification("ui.CannotInsertTextTooLong"):(this.$field.val(n),this._setSelection(t.start+e.length),this.updateDisplayTextOnModify&&this.acceptInput(!0),this.acceptInput())}}},{key:"_applyTextToSelection",value:function(e,t,n){return this.inputObfuscated&&(e=""),e.slice(0,n.start)+t+e.slice(n.end)}},{key:"setWrapText",value:function(e){this.setProperty("wrapText",e)}},{key:"_renderWrapText",value:function(){this.$field.attr("wrap",this.wrapText?"soft":"off")}},{key:"setTrimText",value:function(e){this.setProperty("trimText",e)}},{key:"_renderTrimText",value:function(){}},{key:"_renderGridData",value:function(){J3(n5(o.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!this.multilineText})}},{key:"_renderGridDataHints",value:function(){J3(n5(o.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_onIconClick",value:function(e){this.acceptInput(),this.$field.focus(),this.trigger("action")}},{key:"_onSelectionChangingAction",value:function(e){"mousedown"===e.type?this.$field.window().one("mouseup.stringfield",function(){setTimeout(this._updateSelection.bind(this))}.bind(this)):"keydown"===e.type?setTimeout(this._updateSelection.bind(this)):this._updateSelection()}},{key:"_getSelection",value:function(){var e=O.nvl(this.$field[0].selectionStart,null),t=O.nvl(this.$field[0].selectionEnd,null);return null!==e&&null!==t||(e=0,t=0),{start:e,end:t}}},{key:"_setSelection",value:function(e,t){"number"==typeof e?t=O.nvl(t,e):"object"===Y3(e)&&(t=e.end,e=e.start),this.$field[0].selectionStart=e,this.$field[0].selectionEnd=t,this._updateSelection()}},{key:"_updateSelection",value:function(){var e=this.selectionStart,t=this.selectionEnd;this.selectionStart=this.$field[0].selectionStart,this.selectionEnd=this.$field[0].selectionEnd,this.selectionTrackingEnabled&&(this.selectionStart!==e||this.selectionEnd!==t)&&this.triggerSelectionChange()}},{key:"triggerSelectionChange",value:function(){this.trigger("selectionChange",{selectionStart:this.selectionStart,selectionEnd:this.selectionEnd})}},{key:"_validateValue",value:function(e){return oi.isNullOrUndefined(e)?e:(e=En.asString(e),this.trimText&&(e=e.trim()),J3(n5(o.prototype),"_validateValue",this).call(this,e))}},{key:"_clear",value:function(){J3(n5(o.prototype),"_clear",this).call(this),this.inputObfuscated=!1}},{key:"_updateEmpty",value:function(){this.empty=En.empty(this.value)}},{key:"acceptInput",value:function(e){var t=O.nvl(this._readDisplayText(),"");this.inputObfuscated&&""!==t&&(this.inputObfuscated=!1),J3(n5(o.prototype),"acceptInput",this).call(this,e)}},{key:"_onFieldFocus",value:function(e){J3(n5(o.prototype),"_onFieldFocus",this).call(this,e),this.inputObfuscated&&(this.$field.val(""),setTimeout(function(){if(this.rendered){var e=this.$field[0];e.selectionStart=0,e.selectionEnd=0}}.bind(this)))}},{key:"_getClipboardData",value:function(e,t){var n=e.originalEvent.clipboardData||this.$container.window(!0).clipboardData;if(n){if(n.items&&n.items.length){var i=et.find(n.items,(function(e){return"text/plain"===e.type}));return void(i&&i.getAsString(t))}n.getData&&t(n.getData("Text"))}}},{key:"_onFieldPaste",value:function(e){var t=this.$field.val(),n=this._getSelection();this._getClipboardData(e,function(e){e&&(t=this._applyTextToSelection(t,e,n)).length>this.maxLength&&this._showNotification("ui.PastedTextTooLong")}.bind(this))}},{key:"_showNotification",value:function(e){O.create("DesktopNotification",{parent:this,severity:pi.Severity.WARNING,message:this.session.text(e)}).show()}},{key:"_checkDisplayTextChanged",value:function(e,t){var n=J3(n5(o.prototype),"_checkDisplayTextChanged",this).call(this,e,t);return(!n||!this.inputObfuscated||""!==e)&&n}}])&&X3(t.prototype,n),i&&X3(t,i),o}(aW);function o5(e){return(o5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s5(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a5(e,t,n){return(a5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f5(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function u5(e,t){return(u5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=f5(e);if(t){var r=f5(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c5(this,n)}}function c5(e,t){return!t||"object"!==o5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f5(e){return(f5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i5(r5,"Format",{LOWER:"a",UPPER:"A"}),i5(r5,"TRIM_REGEXP",new RegExp("^(\\s*)(.*?)(\\s*)$"));var h5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u5(e,t)}(o,e);var t,n,i,r=l5(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"_layoutClearIcon",value:function(e,t,n,i){e.$icon&&e.$icon.isVisible()&&(n+=No.prefSize(e.$icon,!0).width),a5(f5(o.prototype),"_layoutClearIcon",this).call(this,e,t,n,i)}}])&&s5(t.prototype,n),i&&s5(t,i),o}(sV);function d5(e){return(d5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p5(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function y5(e,t,n){return(y5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m5(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function v5(e,t){return(v5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=m5(e);if(t){var r=m5(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g5(this,n)}}function g5(e,t){return!t||"object"!==d5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m5(e){return(m5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v5(e,t)}(o,e);var t,n,i,r=b5(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_initProperties",value:function(e){void 0!==e.insertText&&delete e.insertText}},{key:"_syncInsertText",value:function(e){this.widget.insertText(e)}},{key:"_onWidgetSelectionChange",value:function(e){this._send("selectionChange",{selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},{showBusyIndicator:!1,delay:500,coalesce:function(e){return this.target===e.target&&this.type===e.type}})}},{key:"_onWidgetAction",value:function(e){this._send("action")}},{key:"_onWidgetEvent",value:function(e){"selectionChange"===e.type?this._onWidgetSelectionChange(e):"action"===e.type?this._onWidgetAction(e):y5(m5(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&p5(t.prototype,n),i&&p5(t,i),o}(dW);function w5(e){return(w5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k5(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function S5(e,t,n){return(S5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P5(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function O5(e,t){return(O5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=P5(e);if(t){var r=P5(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return C5(this,n)}}function C5(e,t){return!t||"object"!==w5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P5(e){return(P5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O5(e,t)}(o,e);var t,n,i,r=T5(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ENTER],t.renderingHints.render=!1,t.preventDefault=!1,t}return t=o,(n=[{key:"_applyPropagationFlags",value:function(e){S5(P5(o.prototype),"_applyPropagationFlags",this).call(this,e);var t=this.field.$container.activeElement(!0);this.preventInvokeAcceptInputOnActiveValueField=!e.isPropagationStopped()&&"textarea"===t.tagName.toLowerCase(),this.preventInvokeAcceptInputOnActiveValueField&&e.stopPropagation()}},{key:"handle",value:function(e){}}])&&k5(t.prototype,n),i&&k5(t,i),o}($u);function x5(e){return(x5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E5(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function D5(e,t,n){return(D5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j5(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function F5(e,t){return(F5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j5(e);if(t){var r=j5(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $5(this,n)}}function $5(e,t){return!t||"object"!==x5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j5(e){return(j5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F5(e,t)}(o,e);var t,n,i,r=A5(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ENTER],t.ctrl=!0,t}return t=o,(n=[{key:"_accept",value:function(e){return D5(j5(o.prototype),"_accept",this).call(this,e)&&this.field.hasAction}},{key:"handle",value:function(e){this.field._onIconClick()}}])&&E5(t.prototype,n),i&&E5(t,i),o}($u);function I5(e){return(I5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L5(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function B5(e,t,n){return(B5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=z5(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function N5(e,t){return(N5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=z5(e);if(t){var r=z5(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return V5(this,n)}}function V5(e,t){return!t||"object"!==I5(t)&&"function"!=typeof t?W5(e):t}function W5(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z5(e){return(z5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N5(e,t)}(o,e);var t,n,i,r=H5(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).gridDataHints.useUiHeight=!0,e.gridDataHints.w=GH.FULL_WIDTH,e.menusVisible=!1,e.selectedTab=null,e.tabItems=[],e.tabAreaStyle=q4.DisplayStyle.DEFAULT,e._addWidgetProperties(["tabItems","selectedTab"]),e._addPreserveOnPropertyChangeProperties(["selectedTab"]),e._$tabContent=null,e._tabBoxHeaderPropertyChangeHander=e._onTabBoxHeaderPropertyChange.bind(W5(e)),e}return t=o,(n=[{key:"_init",value:function(e){B5(z5(o.prototype),"_init",this).call(this,e),this.header=O.create("TabBoxHeader",{parent:this,tabBox:this}),this._initProperties(e),this.header.on("propertyChange",this._tabBoxHeaderPropertyChangeHander)}},{key:"_initProperties",value:function(e){this._setTabItems(this.tabItems),this._setSelectedTab(this.selectedTab),this._setTabAreaStyle(this.tabAreaStyle)}},{key:"_destroy",value:function(){B5(z5(o.prototype),"_destroy",this).call(this),this.header.off("propertyChange",this._tabBoxHeaderPropertyChangeHander)}},{key:"_render",value:function(){this.addContainer(this.$parent,"tab-box",new c6(this)),this.header.render(this.$container),this.addStatus(),this._$tabContent=this.$container.appendDiv("tab-content"),Uo.install(this._$tabContent,this.session).setLayout(new xa)}},{key:"_renderProperties",value:function(){B5(z5(o.prototype),"_renderProperties",this).call(this),this._renderSelectedTab()}},{key:"_remove",value:function(){B5(z5(o.prototype),"_remove",this).call(this),this._removeSelectedTab()}},{key:"_getCurrentMenus",value:function(){return[]}},{key:"_removeMenus",value:function(){}},{key:"deleteTabItem",value:function(e){var t=this.tabItems.indexOf(e),n=this.tabItems.slice();t>=0&&(n.splice(t,1),this.setTabItems(n))}},{key:"insertTabItem",value:function(e,t){if(e){t=O.nvl(t,this.tabItems.length);var n=this.tabItems.slice();n.splice(t,0,e),this.setTabItems(n)}}},{key:"setTabItems",value:function(e){this.setProperty("tabItems",e)}},{key:"_setTabItems",value:function(e){e=e||[],(this.tabItems||[]).filter((function(t){return e.indexOf(t)<0}),this).forEach((function(e){e.remove()})),this._setProperty("tabItems",e),this.header.setTabItems(this.tabItems),this.tabItems.indexOf(this.selectedTab)<0&&this.setSelectedTab(this.tabItems[0])}},{key:"_renderTabItems",value:function(e){}},{key:"_removeTabItems",value:function(e){}},{key:"_removeTabContent",value:function(){this.tabItems.forEach((function(e){e.remove()}),this)}},{key:"selectTabById",value:function(e){var t=this.getTabItem(e);if(!t)throw new Error("Tab with ID '"+e+"' does not exist");this.setSelectedTab(t)}},{key:"setSelectedTab",value:function(e){this.setProperty("selectedTab",e)}},{key:"_setSelectedTab",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(TabBox#_selectTab) tab="+e),this.selectedTab&&this.selectedTab.rendered&&this.selectedTab.remove(),this._setProperty("selectedTab",e),this.header.setSelectedTabItem(this.selectedTab)}},{key:"_renderSelectedTab",value:function(){this.selectedTab&&this.selectedTab.render(this._$tabContent),this.rendered&&Uo.get(this._$tabContent).revalidateLayoutTree()}},{key:"_removeSelectedTab",value:function(){this.selectedTab&&this.selectedTab.remove()}},{key:"setTabAreaStyle",value:function(e){this.setProperty("tabAreaStyle",e)}},{key:"_setTabAreaStyle",value:function(e){this.tabAreaStyle=e,this.header&&this.header.tabArea&&this.header.tabArea.setDisplayStyle(e)}},{key:"_renderStatusPosition",value:function(){B5(z5(o.prototype),"_renderStatusPosition",this).call(this),this.fieldStatus&&(this.statusPosition===GH.StatusPosition.TOP?this.$status.appendTo(this.header.$container):this.$status.appendTo(this.$container),this.invalidateLayoutTree())}},{key:"getFields",value:function(){return this.tabItems}},{key:"getTabItem",value:function(e){return et.find(this.tabItems,(function(t){return t.id===e}))}},{key:"focus",value:function(){return this.rendered?this.selectedTab?this.selectedTab.focus():void 0:(this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1)}},{key:"getFocusableElement",value:function(){return this.selectedTab?this.selectedTab.getFocusableElement():null}},{key:"isTabItemFocused",value:function(e){return this.header.isTabItemFocused(e)}},{key:"focusTabItem",value:function(e){this.selectedTab!==e&&this.selectTab(e),this.header.focusTabItem(e)}},{key:"focusTab",value:function(e){this.focusTabItem(e)}},{key:"_onTabBoxHeaderPropertyChange",value:function(e){"selectedTabItem"===e.propertyName&&this.setSelectedTab(e.newValue)}}])&&L5(t.prototype,n),i&&L5(t,i),o}(EV);function U5(e){return(U5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K5(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function q5(e,t){return(q5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=J5(e);if(t){var r=J5(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return X5(this,n)}}function X5(e,t){return!t||"object"!==U5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J5(e){return(J5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Z5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q5(e,t)}(o,e);var t,n,i,r=Y5(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.LEFT],t.renderingHints.render=!1,t.stopPropagation=!0,t.keyStrokeMode=$u.Mode.DOWN,t}return t=o,(n=[{key:"handle",value:function(e){this.field.selectPreviousTab(!0)}}])&&K5(t.prototype,n),i&&K5(t,i),o}($u);function Q5(e){return(Q5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e4(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t4(e,t){return(t4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=r4(e);if(t){var r=r4(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return i4(this,n)}}function i4(e,t){return!t||"object"!==Q5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r4(e){return(r4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var o4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&t4(e,t)}(o,e);var t,n,i,r=n4(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.RIGHT],t.renderingHints.render=!1,t.stopPropagation=!0,t.keyStrokeMode=$u.Mode.DOWN,t}return t=o,(n=[{key:"handle",value:function(e){this.field.selectNextTab(!0)}}])&&e4(t.prototype,n),i&&e4(t,i),o}($u);function s4(e){return(s4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a4(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u4(e,t,n){return(u4="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h4(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l4(e,t){return(l4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=h4(e);if(t){var r=h4(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return f4(this,n)}}function f4(e,t){return!t||"object"!==s4(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h4(e){return(h4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l4(e,t)}(o,e);var t,n,i,r=c4(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["selectedTab"]),e}return t=o,(n=[{key:"exportAdapterData",value:function(e){return delete(e=u4(h4(o.prototype),"exportAdapterData",this).call(this,e)).selectedTab,e}}])&&a4(t.prototype,n),i&&a4(t,i),o}(MV);function p4(e){return(p4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y4(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function v4(e,t){return(v4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_4(e);if(t){var r=_4(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g4(this,n)}}function g4(e,t){return!t||"object"!==p4(t)&&"function"!=typeof t?m4(e):t}function m4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _4(e){return(_4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v4(e,t)}(o,e);var t,n,i,r=b4(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tabBoxHeader=e,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmenPropertyChange.bind(m4(t)),Vo.get().on("propertyChange",t.htmlPropertyChangeHandler),t.tabBoxHeader.one("remove",function(){Vo.get().off("propertyChange",this.htmlPropertyChangeHandler)}.bind(m4(t))),t}return t=o,(n=[{key:"_initDefaults",value:function(){this.fieldStatusWidth=Vo.get().fieldStatusWidth}},{key:"_onHtmlEnvironmenPropertyChange",value:function(){this._initDefaults(),this.tabBoxHeader.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,i=Uo.get(e),r=this.tabBoxHeader.tabArea,o=r.htmlComp.margins(),s=this.tabBoxHeader.menuBar,a=s.htmlComp.margins(),u=this.tabBoxHeader.tabBox.$status,l=new Co,c=i.insets(),f=i.availableSize({exact:!0}).subtract(i.insets()),h=new Fo(c.left,c.top,f.width,f.height),d=h.x;n=s.htmlComp.prefSize({widthHint:0}),this.tabBoxHeader.tabBox.statusPosition===GH.StatusPosition.TOP&&u&&u.isVisible()&&(l.height=u.outerHeight(!0),l.width=this.fieldStatusWidth+No.margins(u).horizontal()),t=r.htmlComp.prefSize({widthHint:h.width-n.width-a.horizontal()-l.width,exact:!1}),r.htmlComp.setBounds(new Fo(h.x+o.left,c.top+o.top,t.width,h.height-o.vertical())),s.htmlComp.layout.collapsed=r.htmlComp.layout.overflowTabs.length>0,s.htmlComp.setBounds(new Fo(d+t.width+o.horizontal()+a.left,c.top+a.top,h.width-t.width-o.horizontal()-a.horizontal()-l.width,h.height-a.vertical())),this.tabBoxHeader.tabBox.statusPosition===GH.StatusPosition.TOP&&u&&u.isVisible()&&u.cssWidth(this.fieldStatusWidth).cssRight(c.left).cssHeight(h.height-No.margins(u).vertical()).cssLineHeight(h.height-No.margins(u).vertical())}},{key:"preferredLayoutSize",value:function(e,t){var n,i,r,o=Uo.get(e),s=o.insets(),a=(t.widthHint||o.availableSize().width)-o.insets().horizontal(),u=new Co,l=this.tabBoxHeader.tabBox.$status,c=new Co,f=this.tabBoxHeader.tabArea,h=f.htmlComp.margins(),d=this.tabBoxHeader.menuBar,p=d.htmlComp.margins();return i=d.htmlComp.prefSize({widthHint:0}),this.tabBoxHeader.tabBox.statusPosition===GH.StatusPosition.TOP&&l&&l.isVisible()&&(c.height=l.outerHeight(!0),c.width=this.fieldStatusWidth+No.margins(l).horizontal(),u.width+=c.width,u.height=Math.max(u.height,c.height)),n=f.htmlComp.prefSize({widthHint:a-i.width-p.horizontal()-h.horizontal()-c.width}),u.width+=n.width+h.horizontal(),u.height=Math.max(u.height,n.height+h.vertical()),r=d.htmlComp.prefSize({widthHint:a-n.width-h.horizontal()-p.horizontal()-c.width}),u.width+=r.width+p.horizontal(),u.height=Math.max(u.height,r.height+p.vertical()),u.add(s)}}])&&y4(t.prototype,n),i&&y4(t,i),o}(zo);function k4(e){return(k4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S4(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function O4(e,t,n){return(O4="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x4(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function T4(e,t){return(T4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=x4(e);if(t){var r=x4(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return P4(this,n)}}function P4(e,t){return!t||"object"!==k4(t)&&"function"!=typeof t?R4(e):t}function R4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x4(e){return(x4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T4(e,t)}(o,e);var t,n,i,r=C4(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).tabBox=null,e.tabArea=null,e.menuBar=null,e.$container=null,e.htmlComp=null,e.$borderBottom=null,e._tabBoxPropertyChangeHandler=e._onTabBoxPropertyChange.bind(R4(e)),e._tabAreaPropertyChangeHandler=e._onTabAreaPropertyChange.bind(R4(e)),e}return t=o,(n=[{key:"_init",value:function(e){O4(x4(o.prototype),"_init",this).call(this,e),this.tabBox=e.tabBox,this.tabArea=O.create("TabArea",{parent:this,tabBox:this.tabBox}),this.tabArea.on("propertyChange",this._tabAreaPropertyChangeHandler),this.menuBar=O.create("MenuBar",{parent:this,menuOrder:new xY}),this.tabBox.on("propertyChange",this._tabBoxPropertyChangeHandler),this.menuBar.setMenuItems(this.tabBox.menus)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tab-box-header"),this.$borderBottom=this.$container.appendDiv("tab-box-header-bottom-border"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new w4(this)),this.tabArea.render(this.$container),this.menuBar.render(this.$container),this.$container.append(this.menuBar.$container)}},{key:"_destroy",value:function(){this.tabBox.off("propertyChange",this._tabBoxPropertyChangeHandler),this.tabArea.off("propertyChange",this._tabAreaPropertyChangeHandler),O4(x4(o.prototype),"_destroy",this).call(this)}},{key:"setTabItems",value:function(e){this.tabArea.setTabItems(e)}},{key:"_setSelectedTab",value:function(e){e?this.setSelectedTabItem(e.tabItem):this.setSelectedTabItem(null)}},{key:"setSelectedTabItem",value:function(e){this.setProperty("selectedTabItem",e)}},{key:"_setSelectedTabItem",value:function(e){this._setProperty("selectedTabItem",e),this.tabArea.setSelectedTabItem(e)}},{key:"isTabItemFocused",value:function(e){return this.tabArea.isTabItemFocused(e)}},{key:"focusTabItem",value:function(e){this.tabArea.focusTabItem(e)}},{key:"_onTabBoxPropertyChange",value:function(e){"menus"===e.propertyName&&this.menuBar.setMenuItems(this.tabBox.menus)}},{key:"_onTabAreaPropertyChange",value:function(e){"selectedTab"===e.propertyName&&this._setSelectedTab(e.newValue)}}])&&S4(t.prototype,n),i&&S4(t,i),o}(de);function D4(e){return(D4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F4(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function A4(e,t,n){return(A4="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L4(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function $4(e,t){return($4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=L4(e);if(t){var r=L4(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return M4(this,n)}}function M4(e,t){return!t||"object"!==D4(t)&&"function"!=typeof t?I4(e):t}function I4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L4(e){return(L4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$4(e,t)}(o,e);var t,n,i,r=j4(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).label=null,e.subLabel=null,e.selected=!1,e.overflown=!1,e._preventTabSelection=!1,e.$label=null,e.$subLabel=null,e._tabPropertyChangeHandler=e._onTabPropertyChange.bind(I4(e)),e._statusMouseDownHandler=e._onStatusMouseDown.bind(I4(e)),e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(I4(e)),e}return t=o,(n=[{key:"_init",value:function(e){A4(L4(o.prototype),"_init",this).call(this,e),this.visible=this.tabItem.visible,this.label=this.tabItem.label,this.subLabel=this.tabItem.subLabel,this.cssClass=this.tabItem.cssClass,this.marked=this.tabItem.marked,this.tooltipText=this.tabItem.tooltipText,this.fieldStatus=O.create("FieldStatus",{parent:this,visible:!1}),this.fieldStatus.on("statusMouseDown",this._statusMouseDownHandler),this.tabItem.on("propertyChange",this._tabPropertyChangeHandler)}},{key:"_destroy",value:function(){A4(L4(o.prototype),"_destroy",this).call(this),this.tabItem.off("propertyChange",this._tabPropertyChangeHandler),this.fieldStatus.off("statusMouseDown",this._statusMouseDownHandler)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tab-item"),this.htmlComp=Uo.install(this.$container,this.session),this.$title=this.$container.appendDiv("title"),this.$label=this.$title.appendDiv("label"),dh.installForEllipsis(this.$label,{parent:this}),this.$subLabel=this.$title.appendDiv("sub-label"),dh.installForEllipsis(this.$subLabel,{parent:this}),this.fieldStatus.render(),this.fieldStatus.$container.cssWidth(Vo.get().fieldStatusWidth),this.$container.on("mousedown",this._onTabMouseDown.bind(this)),this.session.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}},{key:"_renderProperties",value:function(){A4(L4(o.prototype),"_renderProperties",this).call(this),this._renderVisible(),this._renderLabel(),this._renderSubLabel(),this._renderTabbable(),this._renderSelected(),this._renderMarked(),this._renderOverflown(),this._renderTooltipText(),this._renderErrorStatus()}},{key:"_renderVisible",value:function(){A4(L4(o.prototype),"_renderVisible",this).call(this),this._updateStatus()}},{key:"setLabel",value:function(e){this.setProperty("label",e)}},{key:"_renderLabel",value:function(e){this.$label.textOrNbsp(this.label),this.invalidateLayoutTree()}},{key:"setSubLabel",value:function(e){this.setProperty("subLabel",e)}},{key:"_renderSubLabel",value:function(){this.$subLabel.textOrNbsp(this.subLabel),this.invalidateLayoutTree()}},{key:"setTooltipText",value:function(e){this.setProperty("tooltipText",e)}},{key:"_renderTooltipText",value:function(){this.$container.toggleClass("has-tooltip",En.hasText(this.tooltipText)),this._updateStatus()}},{key:"setErrorStatus",value:function(e){this.setProperty("errorStatus",e)}},{key:"_renderErrorStatus",value:function(){var e=!!this.errorStatus,t=e?"has-"+this.errorStatus.cssClass():"";this._updateErrorStatusClasses(t,e),this._updateStatus()}},{key:"_updateErrorStatusClasses",value:function(e,t){this.$container.removeClass(GH.SEVERITY_CSS_CLASSES),this.$container.addClass(e,t)}},{key:"_updateStatus",value:function(){var e=this._computeVisible(),t=null,n=!0,i=!1;this.fieldStatus.setVisible(e),e&&(this.errorStatus?(n=!(t=this.errorStatus).isError(),i=!0):t=O.create("Status",{message:this.tooltipText,severity:pi.Severity.OK}),this.fieldStatus.update(t,null,n,i))}},{key:"_computeVisible",value:function(){return this.visible&&!this.overflown&&(this.errorStatus||En.hasText(this.tooltipText))}},{key:"setTabbable",value:function(e){this.setProperty("tabbable",e)}},{key:"_renderTabbable",value:function(){this.$container.setTabbable(this.tabbable&&!Mt.get().supportsOnlyTouch())}},{key:"select",value:function(){this.setSelected(!0)}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.select(this.selected),this.$container.setTabbable(this.selected&&!Mt.get().supportsOnlyTouch())}},{key:"setMarked",value:function(e){this.setProperty("marked",e)}},{key:"_renderMarked",value:function(e){this.$container.toggleClass("marked",this.marked)}},{key:"setOverflown",value:function(e){this.setProperty("overflown",e)}},{key:"_renderOverflown",value:function(){this.$container.toggleClass("overflown",this.overflown),this._updateStatus()}},{key:"_remove",value:function(){this.session.desktop.off("propertyChange",this._desktopPropertyChangeHandler),A4(L4(o.prototype),"_remove",this).call(this)}},{key:"_onDesktopPropertyChange",value:function(e){"dense"===e.propertyName&&this.invalidateLayout()}},{key:"_onTabMouseDown",value:function(e){this._preventTabSelection?this._preventTabSelection=!1:(this.setTabbable(!0),this.$container.focus(),this.select(),this.$label&&(dh.cancel(this.$label),dh.close(this.$label)),this.$subLabel&&(dh.cancel(this.$subLabel),dh.close(this.$subLabel)))}},{key:"_onStatusMouseDown",value:function(e){this._preventTabSelection=!0,e.preventDefault()}},{key:"_onTabPropertyChange",value:function(e){"visible"===e.propertyName?this.setVisible(e.newValue):"label"===e.propertyName?this.setLabel(this.tabItem.label):"subLabel"===e.propertyName?this.setSubLabel(this.tabItem.subLabel):"cssClass"===e.propertyName?this.setCssClass(this.tabItem.cssClass):"marked"===e.propertyName?this.setMarked(this.tabItem.marked):"errorStatus"===e.propertyName?this.setErrorStatus(e.newValue):"tooltipText"===e.propertyName&&this.setTooltipText(e.newValue)}}])&&F4(t.prototype,n),i&&F4(t,i),o}(de);function N4(e){return(N4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H4(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function V4(e,t,n){return(V4="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=K4(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function W4(e,t){return(W4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=K4(e);if(t){var r=K4(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return G4(this,n)}}function G4(e,t){return!t||"object"!==N4(t)&&"function"!=typeof t?U4(e):t}function U4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K4(e){return(K4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var q4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W4(e,t)}(o,e);var t,n,i,r=z4(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).tabBox=null,e.tabs=[],e.displayStyle=o.DisplayStyle.DEFAULT,e._tabItemPropertyChangeHandler=e._onTabItemPropertyChange.bind(U4(e)),e._tabPropertyChangeHandler=e._onTabPropertyChange.bind(U4(e)),e.ellipsis=null,e.$selectionMarker=null,e}return t=o,(n=[{key:"_init",value:function(e){V4(K4(o.prototype),"_init",this).call(this,e),this.tabBox=e.tabBox,this.ellipsis=O.create("EllipsisMenu",{parent:this,cssClass:"overflow-tab-item unfocusable",iconId:null,inheritAccessibility:!1,text:"0"})}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){V4(K4(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new Z5(this),new o4(this)])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tab-area"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new n6(this)),this.ellipsis.render(this.$container),this.$selectionMarker=this.$container.appendDiv("selection-marker")}},{key:"_renderProperties",value:function(){V4(K4(o.prototype),"_renderProperties",this).call(this),this._renderTabs(),this._renderSelectedTab(),this._renderHasSubLabel(),this._renderDisplayStyle()}},{key:"_remove",value:function(){V4(K4(o.prototype),"_remove",this).call(this),this._removeTabs()}},{key:"setSelectedTabItem",value:function(e){this.setSelectedTab(this.getTabForItem(e))}},{key:"getTabForItem",value:function(e){return et.find(this.tabs,(function(t){return t.tabItem===e}),this)}},{key:"setSelectedTab",value:function(e){this.setProperty("selectedTab",e)}},{key:"_setSelectedTab",value:function(e){this.selectedTab&&this.selectedTab.setSelected(!1),e&&e.setSelected(!0),this._setProperty("selectedTab",e),this._setTabbableItem(e)}},{key:"_renderSelectedTab",value:function(){this.selectedTab&&this.selectedTab.overflown&&this.invalidateLayoutTree()}},{key:"isTabItemFocused",value:function(e){return this.getTabForItem(e).isFocused()}},{key:"focusTabItem",value:function(e){this.focusTab(this.getTabForItem(e))}},{key:"focusTab",value:function(e){e.focus()}},{key:"setTabItems",value:function(e){this.setProperty("tabs",e),this._updateHasSubLabel(),this.invalidateLayoutTree()}},{key:"_setTabs",value:function(e){var t=this.tabs.slice(),n=e.map((function(e){var n=this.getTabForItem(e);return n?et.remove(t,n):(n=O.create("Tab",{parent:this,tabItem:e}),e.on("propertyChange",this._tabItemPropertyChangeHandler),n.on("propertyChange",this._tabPropertyChangeHandler)),n}),this);t.forEach((function(e){e.tabItem.off("propertyChange",this._tabItemPropertyChangeHandler)}),this),this._removeTabs(t),this._setProperty("tabs",n)}},{key:"_renderTabs",value:function(){this.tabs.slice().reverse().forEach((function(e,t,n){e.rendered||e.render(),e.$container.on("blur",this._onTabItemBlur.bind(this)).on("focus",this._onTabItemFocus.bind(this)),e.$container.prependTo(this.$container),e.$container.on("blur",this._onTabItemBlur.bind(this)).on("focus",this._onTabItemFocus.bind(this))}),this)}},{key:"_removeTabs",value:function(e){(e=e||this.tabs).forEach((function(e){e.remove()}))}},{key:"setDisplayStyle",value:function(e){this.setProperty("displayStyle",e)}},{key:"_renderDisplayStyle",value:function(){this.$container.toggleClass("spread-even",this.displayStyle===o.DisplayStyle.SPREAD_EVEN),this.invalidateLayoutTree()}},{key:"_onTabItemFocus",value:function(){this.setFocused(!0)}},{key:"_onTabItemBlur",value:function(){this.setFocused(!1)}},{key:"_updateHasSubLabel",value:function(){var e=this.tabs||[];this._setHasSubLabel(e.some((function(e){return En.hasText(e.subLabel)})))}},{key:"_setHasSubLabel",value:function(e){this.hasSubLabel!==e&&(this._setProperty("hasSubLabel",e),this.rendered&&this._renderHasSubLabel())}},{key:"_renderHasSubLabel",value:function(){this.$container.toggleClass("has-sub-label",this.hasSubLabel),this.invalidateLayoutTree()}},{key:"selectNextTab",value:function(e){this._moveSelectionHorizontal(!0,e)}},{key:"selectPreviousTab",value:function(e){this._moveSelectionHorizontal(!1,e)}},{key:"_moveSelectionHorizontal",value:function(e,t){var n=this.tabs.slice(),i=this.$container.activeElement(),r=!1;e||(n.reverse(),r=i[0]===this.ellipsis.$container[0]),n.forEach((function(e,n){if(r&&e.visible&&!e.overflown)return this.setSelectedTab(e),this._setTabbableItem(e),t&&e.focus(),void(r=!1);i[0]===e.$container[0]&&(r=!0)}),this),e&&r&&this.ellipsis.isTabTarget()&&(this._setTabbableItem(this.ellipsis),t&&this.ellipsis.focus())}},{key:"_setTabbableItem",value:function(e){var t=this.tabs;e&&(this.ellipsis.setTabbable(!1),t.forEach((function(e){e.setTabbable(!1)})),e.setTabbable(!0))}},{key:"_onTabPropertyChange",value:function(e){"selected"===e.propertyName&&this.setSelectedTab(e.source)}},{key:"_onTabItemPropertyChange",value:function(e){"visible"===e.propertyName&&this.invalidateLayoutTree(),"subLabel"===e.propertyName&&this._updateHasSubLabel()}}])&&H4(t.prototype,n),i&&H4(t,i),o}(de);function Y4(e){return(Y4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X4(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function J4(e,t){return(J4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=t6(e);if(t){var r=t6(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q4(this,n)}}function Q4(e,t){return!t||"object"!==Y4(t)&&"function"!=typeof t?e6(e):t}function e6(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t6(e){return(t6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(q4,"DisplayStyle",{DEFAULT:"default",SPREAD_EVEN:"spreadEven"});var n6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J4(e,t)}(o,e);var t,n,i,r=Z4(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tabArea=e,t.overflowTabs=[],t.visibleTabs=[],t._tabAreaPropertyChangeHandler=t._onTabAreaPropertyChange.bind(e6(t)),t.tabArea.on("propertyChange",t._tabAreaPropertyChangeHandler),t.tabArea.one("remove",function(){this.tabArea.off("propertyChange",this._tabAreaPropertyChangeHandler)}.bind(e6(t))),t}return t=o,(n=[{key:"layout",value:function(e){var t=this.tabArea.ellipsis,n=Uo.get(e),i=n.availableSize().subtract(n.insets());this.preferredLayoutSize(e,{widthHint:i.width}),this.overflowTabs.length>0&&t.setHidden(!1),this.visibleTabs.forEach((function(e){e.setOverflown(!1)})),this.overflowTabs.forEach((function(e){e.setOverflown(!0)})),0===this.overflowTabs.length&&t.setHidden(!0),t.setText(this.overflowTabs.length+""),t.setChildActions(this.overflowTabs.map((function(e){var n=O.create("Menu",{parent:t,text:e.label,tab:e,visible:e.visible});return n.on("action",(function(n){s.a.log.isDebugEnabled()&&s.a.log.debug("(TabAreaLayout#_onClickEllipsis) tabItem="+e),t.popup.close(),e.select(),e.focus()})),n}),this)),this._layoutSelectionMarker()}},{key:"_layoutSelectionMarker",value:function(){var e,t=this.tabArea.$selectionMarker,n=this.tabArea.selectedTab;n?(t.setVisible(!0),e=No.bounds(n.$container),t.cssLeft(e.x),t.cssWidth(e.width)):t.setVisible(!1)}},{key:"preferredLayoutSize",value:function(e,t){var n=Uo.get(e),i=new Co(0,0),r=Number.MAX_VALUE,o=this.tabArea.tabs.filter((function(e){return e.isVisible()})),s=o.map((function(e,t){return e.selected?-1:t})).filter((function(e){return e>=0}));if(this.overflowTabs=[],(0===t.widthHint||t.widthHint)&&(r=t.widthHint-n.insets().horizontal()),r<=0)return this._minSize(o).add(n.insets());var a=-1;for(this._setFirstLastMarker(o),i=this._prefSize(o);i.width>r&&s.length>0;)a=s.splice(-1)[0],this.overflowTabs.splice(0,0,o[a]),o.splice(a,1),this._setFirstLastMarker(o),i=this._prefSize(o);return this.visibleTabs=o,this.tabArea.displayStyle===q4.DisplayStyle.SPREAD_EVEN?No.prefSize(e,t):No.exactPrefSize(i.add(n.insets()),t)}},{key:"_minSize",value:function(e){var t=[];return this.overflowTabs=e.filter((function(e){return!e.selected||(t.push(e),!1)}),this),this.visibleTabs=t,this._setFirstLastMarker(t),this._prefSize(t)}},{key:"_prefSize",value:function(e,t){var n=e.map((function(e){return this._tabItemSize(e.htmlComp)}),this).reduce((function(e,t){return e.height=Math.max(e.height,t.height),e.width+=t.width,e}),new Co(0,0)),i=new Co(0,0);return(t=O.nvl(t,this.overflowTabs.length>0))&&(i=this._tabItemSize(this.tabArea.ellipsis.htmlComp),n.height=Math.max(n.height,i.height),n.width+=i.width),n}},{key:"_setFirstLastMarker",value:function(e,t){t=O.nvl(t,this.overflowTabs.length>0),this.tabArea.tabs.forEach((function(e){e.htmlComp.$comp.removeClass("first last")})),this.tabArea.ellipsis.$container.removeClass("first last"),e.length>0&&(e[0].$container.addClass("first"),t?this.tabArea.ellipsis.$container.addClass("last"):e[e.length-1].$container.addClass("last"))}},{key:"_tabItemSize",value:function(e){var t,n=e.$comp.attr("class");return this.tabArea.displayStyle===q4.DisplayStyle.SPREAD_EVEN&&this.tabArea.$container.removeClass("spread-even"),e.$comp.removeClass("overflown"),e.$comp.removeClass("hidden"),t=e.prefSize({useCssSize:!0,exact:!0}).add(No.margins(e.$comp)),e.$comp.attrOrRemove("class",n),this.tabArea.displayStyle===q4.DisplayStyle.SPREAD_EVEN&&this.tabArea.$container.addClass("spread-even"),t}},{key:"_onTabAreaPropertyChange",value:function(e){"selectedTab"===e.propertyName&&this._layoutSelectionMarker()}}])&&X4(t.prototype,n),i&&X4(t,i),o}(zo);function i6(e){return(i6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r6(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o6(e,t){return(o6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=l6(e);if(t){var r=l6(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return a6(this,n)}}function a6(e,t){return!t||"object"!==i6(t)&&"function"!=typeof t?u6(e):t}function u6(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l6(e){return(l6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o6(e,t)}(o,e);var t,n,i,r=s6(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this))._tabBox=e,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmenPropertyChange.bind(u6(t)),Vo.get().on("propertyChange",t.htmlPropertyChangeHandler),t._tabBox.one("remove",function(){Vo.get().off("propertyChange",this.htmlPropertyChangeHandler)}.bind(u6(t))),t}return t=o,(n=[{key:"_initDefaults",value:function(){this._statusWidth=Vo.get().fieldStatusWidth}},{key:"_onHtmlEnvironmenPropertyChange",value:function(){this._initDefaults(),this._tabBox.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,i,r,o=Uo.get(e),s=Uo.get(this._tabBox._$tabContent),a=Uo.get(this._tabBox.header.$container),u=0,l=new Co,c=this._tabBox._tooltip(),f=this._tabBox.$status,h=this._tabBox.statusPosition;t=o.availableSize().subtract(o.insets()),a.isVisible()&&(i=a.margins(),u=t.subtract(i).width,f&&f.isVisible()&&(this._layoutStatus(),h===GH.StatusPosition.DEFAULT&&(u-=this._statusWidth+No.margins(f).horizontal())),r=a.prefSize({widthHint:u}),f&&f.isVisible()&&this._layoutStatus(r.height),r.width=u,a.setSize(r),l=r.add(i)),(n=t.subtract(s.margins())).height-=l.height,s.setSize(n),c&&c.rendered&&c.position()}},{key:"_layoutStatus",value:function(e){var t=this._tabBox.htmlComp.insets({includeBorder:!1}),n=t.top,i=t.right,r=this._tabBox.header.$container,o=this._tabBox.$status,s=No.margins(o),a=n,u=this._tabBox.statusPosition,l=e-s.vertical();u===GH.StatusPosition.DEFAULT?a+=r.cssMarginTop():l-=o.cssBorderWidthY(),o.cssWidth(this._statusWidth).cssTop(a).cssRight(i).cssHeight(l).cssLineHeight(l)}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n=Uo.get(e),i=Uo.get(this._tabBox._$tabContent),r=Uo.get(this._tabBox.header.$container),o=new Co,s=new Co,a=this._tabBox.$status,u=this._tabBox.statusPosition,l=n.availableSize().subtract(n.insets()).width;return t.heightHint=null,r.isVisible()&&(a&&a.isVisible()&&u===GH.StatusPosition.DEFAULT&&(l-=a.outerWidth(!0)),o=r.prefSize({widthHint:l}).add(r.margins())),s=i.prefSize(t).add(n.insets()).add(i.margins()),new Co(Math.max(o.width,s.width),s.height+o.height)}}])&&r6(t.prototype,n),i&&r6(t,i),o}(zo);function f6(e){return(f6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h6(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d6(e,t,n){return(d6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b6(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p6(e,t){return(p6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b6(e);if(t){var r=b6(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v6(this,n)}}function v6(e,t){return!t||"object"!==f6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b6(e){return(b6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p6(e,t)}(o,e);var t,n,i,r=y6(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).marked=!1,e}return t=o,(n=[{key:"_init",value:function(e){d6(b6(o.prototype),"_init",this).call(this,e),this._setMenusVisible(this.menusVisible)}},{key:"_createLayout",value:function(){return new D6(this)}},{key:"_computeTitleVisible",value:function(e){return!1}},{key:"addStatus",value:function(){}},{key:"_computeStatusVisible",value:function(){return!1}},{key:"setMarked",value:function(e){this.setProperty("marked",e)}},{key:"_setMenusVisible",value:function(){this._setProperty("menusVisible",!1)}},{key:"focus",value:function(){this.parent.selectedTab!==this&&this.parent.setSelectedTab(this),this.parent.focusTabItem(this)}},{key:"isFocused",value:function(){return this.parent.isTabItemFocused(this)}}])&&h6(t.prototype,n),i&&h6(t,i),o}(rY);function m6(e){return(m6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _6(e,t){return(_6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S6(e);if(t){var r=S6(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return k6(this,n)}}function k6(e,t){return!t||"object"!==m6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S6(e){return(S6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_6(e,t)}(n,e);var t=w6(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(mY);function T6(e){return(T6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C6(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P6(e,t){return(P6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=E6(e);if(t){var r=E6(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return x6(this,n)}}function x6(e,t){return!t||"object"!==T6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E6(e){return(E6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var D6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P6(e,t)}(o,e);var t,n,i,r=R6(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"_layoutStatus",value:function(){}},{key:"_menuBarSize",value:function(e,t,n){var i=D_.size(e,t),r=this.groupBox.parent;return i.width=r.header.$container.outerWidth(),i}},{key:"_titleHeight",value:function(){return 0}}])&&C6(t.prototype,n),i&&C6(t,i),o}(PY);function F6(e){return(F6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A6(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $6(e,t,n){return($6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=B6(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function j6(e,t){return(j6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=B6(e);if(t){var r=B6(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return I6(this,n)}}function I6(e,t){return!t||"object"!==F6(t)&&"function"!=typeof t?L6(e):t}function L6(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B6(e){return(B6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var N6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j6(e,t)}(o,e);var t,n,i,r=M6(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).gridDataHints.weightY=1,e.gridDataHints.h=3,e.eventDelegator=null,e._tableChangedHandler=e._onTableChanged.bind(L6(e)),e._deletedRows=oi.createMap(),e._insertedRows=oi.createMap(),e._updatedRows=oi.createMap(),e._checkedRows=oi.createMap(),e._addWidgetProperties(["table"]),e}return t=o,(n=[{key:"_init",value:function(e){$6(B6(o.prototype),"_init",this).call(this,e),this._setTable(this.table)}},{key:"_render",value:function(){this.addContainer(this.$parent,"table-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this._renderTable()}},{key:"setTable",value:function(e){this.setProperty("table",e)}},{key:"_setTable",value:function(e){this.table&&(this.table.off(o.TABLE_CHANGE_EVENTS,this._tableChangedHandler),this.eventDelegator&&(this.eventDelegator.destroy(),this.eventDelegator=null)),this._setProperty("table",e),e&&(e.on(o.TABLE_CHANGE_EVENTS,this._tableChangedHandler),this.eventDelegator=at.create(this,e,{delegateProperties:["enabled","disabledStyle","loading"]}),e.setDisabledStyle(this.disabledStyle),e.setLoading(this.loading),e.setScrollTop(this.scrollTop))}},{key:"_renderTable",value:function(){this.table&&(this.table.render(),this.addField(this.table.$container),this.$field.addDeviceClass(),this.invalidateLayoutTree())}},{key:"_removeTable",value:function(){this.table&&(this.table.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"computeRequiresSave",value:function(){return Object.keys(this._deletedRows).length>0||Object.keys(this._insertedRows).length>0||Object.keys(this._updatedRows).length>0||Object.keys(this._checkedRows).length>0}},{key:"_onTableChanged",value:function(e){O.isOneOf(e.type,"rowsDeleted","allRowsDeleted")?this._updateDeletedRows(e.rows):"rowsInserted"===e.type?this._updateInsertedRows(e.rows):"rowsUpdated"===e.type?this._updateUpdatedRows(e.rows):"rowsChecked"===e.type&&this._updateCheckedRows(e.rows)}},{key:"_updateDeletedRows",value:function(e){e.forEach((function(e){if(e.id in this._insertedRows)return delete this._insertedRows[e.id],delete this._updatedRows[e.id],void delete this._checkedRows[e.id];this._deletedRows[e.id]=e}),this)}},{key:"_updateInsertedRows",value:function(e){e.forEach((function(e){this._insertedRows[e.id]=e}),this)}},{key:"_updateUpdatedRows",value:function(e){e.forEach((function(e){e.status!==uR.Status.NON_CHANGED&&(this._updatedRows[e.id]=e)}),this)}},{key:"_updateCheckedRows",value:function(e){e.forEach((function(e){e.id in this._checkedRows?delete this._checkedRows[e.id]:this._checkedRows[e.id]=e}),this)}},{key:"markAsSaved",value:function(){$6(B6(o.prototype),"markAsSaved",this).call(this),this._deletedRows=oi.createMap(),this._insertedRows=oi.createMap(),this._updatedRows=oi.createMap(),this._checkedRows=oi.createMap(),this.table.markRowsAsNonChanged()}},{key:"getValidationResult",value:function(){var e=$6(B6(o.prototype),"getValidationResult",this).call(this);if(e&&!e.valid)return e;var t=!this.errorStatus,n=!this.mandatory||!this.empty,i=et.ensure(this.table.rows),r=et.ensure(this.table.columns);return i.some((function(e){return r.some((function(i){var r=i.isContentValid(e);return!(r.valid||(t=t&&r.validByErrorStatus,n=n&&r.validByMandatory,t||n))}),this)}),this),{valid:t&&n,validByErrorStatus:t,validByMandatory:n}}},{key:"getDelegateScrollable",value:function(){return this.table}}])&&A6(t.prototype,n),i&&A6(t,i),o}(GH);function H6(e){return(H6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V6(e,t){return(V6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=G6(e);if(t){var r=G6(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return z6(this,n)}}function z6(e,t){return!t||"object"!==H6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G6(e){return(G6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(N6,"TABLE_CHANGE_EVENTS","rowsInserted rowsDeleted allRowsDeleted rowsUpdated rowsChecked");var U6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V6(e,t)}(n,e);var t=W6(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function K6(e){return(K6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q6(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Y6(e,t,n){return(Y6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Q6(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function X6(e,t){return(X6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Q6(e);if(t){var r=Q6(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Z6(this,n)}}function Z6(e,t){return!t||"object"!==K6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q6(e){return(Q6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X6(e,t)}(o,e);var t,n,i,r=J6(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).table=null,e}return t=o,(n=[{key:"_init",value:function(e){Y6(Q6(o.prototype),"_init",this).call(this,e);var t=O.create("Column",{index:0,session:this.session,text:"Tag",autoOptimizeWidth:!1});this.table=O.create("Table",{parent:this,headerVisible:!1,autoResizeColumns:!0,multiSelect:!1,scrollToSelection:!0,columns:[t],headerMenusEnabled:!1}),this.table.on("rowClick",this._onRowClick.bind(this))}},{key:"_createLayout",value:function(){return new u9(this)}},{key:"_render",value:function(){Y6(Q6(o.prototype),"_render",this).call(this),this.$container.addClass("tag-chooser-popup").on("mousedown",this._onContainerMouseDown.bind(this)),this._renderTable()}},{key:"_renderTable",value:function(){this.table.setVirtual(!1),this.table.render(),this.table.$container.setTabbable(!1).addClass("focused")}},{key:"setLookupResult",value:function(e){var t=[],n=e.lookupRows;this.table.deleteAllRows(),n.forEach((function(e){t.push(QX.createTableRow(e))}),this),this.table.insertRows(t)}},{key:"_onRowClick",value:function(e){this.triggerLookupRowSelected()}},{key:"_onContainerMouseDown",value:function(e){return!1}},{key:"_isMouseDownOnAnchor",value:function(e){return this.field.$field.isOrHas(e.target)}},{key:"delegateKeyEvent",value:function(e){e.originalEvent.smartFieldEvent=!0,this.table.$container.trigger(e)}},{key:"triggerLookupRowSelected",value:function(e){(e=e||this.selectedRow())&&e.enabled&&this.trigger("lookupRowSelected",{lookupRow:e.lookupRow})}},{key:"selectedRow",value:function(){return this.table.selectedRow()}}])&&q6(t.prototype,n),i&&q6(t,i),o}(kd);function t9(e){return(t9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n9(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i9(e,t,n){return(i9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a9(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function r9(e,t){return(r9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=a9(e);if(t){var r=a9(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s9(this,n)}}function s9(e,t){return!t||"object"!==t9(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a9(e){return(a9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r9(e,t)}(o,e);var t,n,i,r=o9(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).doubleCalcPrefSize=!1,t}return t=o,(n=[{key:"layout",value:function(e){i9(a9(o.prototype),"layout",this).call(this,e);var t=this.popup.htmlComp,n=t.size().subtract(t.insets());this.popup.table.htmlComp.setSize(n),this.popup.position()}},{key:"preferredLayoutSize",value:function(e){var t=O.create("TableLayoutResetter",this.popup.table);t.modifyDom();var n=i9(a9(o.prototype),"preferredLayoutSize",this).call(this,e);return t.restoreDom(),n}}])&&n9(t.prototype,n),i&&n9(t,i),o}(Id);function l9(e){return(l9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c9(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function f9(e,t,n){return(f9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y9(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function h9(e,t){return(h9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=y9(e);if(t){var r=y9(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return p9(this,n)}}function p9(e,t){return!t||"object"!==l9(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y9(e){return(y9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h9(e,t)}(o,e);var t,n,i,r=d9(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).$field=null,e.fieldHtmlComp=null,e.popup=null,e.lookupCall=null,e._currentLookupCall=null,e.tagBar=null,e}return t=o,i=[{key:"createFieldAdapter",value:function(e){return{$container:function(){return e.$fieldContainer},enabled:function(){return En.empty(e._readDisplayText())},focus:function(){e.$field.focus()},one:function(t,n){e.one(t,n)},off:function(t,n){e.off(t,n)},removeTag:function(t){e.removeTag(t)}}}}],(n=[{key:"_init",value:function(e){f9(y9(o.prototype),"_init",this).call(this,e),this.tagBar=O.create("TagBar",{parent:this,tags:this.value}),this.tagBar.on("tagRemove",this._onTagRemove.bind(this)),this.on("propertyChange",this._onValueChange.bind(this)),this._setLookupCall(this.lookupCall)}},{key:"_onTagRemove",value:function(e){this.removeTag(e.tag)}},{key:"_initKeyStrokeContext",value:function(){f9(y9(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new A9(this),new H9(this),new i7(this._createFieldAdapter()),new Y9(this._createFieldAdapter()),new f7(this)])}},{key:"_createKeyStrokeContext",value:function(){return new Fu}},{key:"_render",value:function(){this.addContainer(this.$parent,"tag-field",new g7(this)),this.addLabel(),this.addMandatoryIndicator();var e=this.$container.appendDiv();this.fieldHtmlComp=Uo.install(e,this.session),this.fieldHtmlComp.setLayout(new T7(this)),this.tagBar.render(e);var t=e.appendElement("<input>","field").on("keydown",this._onInputKeydown.bind(this)).on("keyup",this._onInputKeyup.bind(this)).on("input",this._onFieldInput.bind(this));this.addFieldContainer(e),this.addField(t),this.addStatus()}},{key:"_renderProperties",value:function(){f9(y9(o.prototype),"_renderProperties",this).call(this),this._renderValue()}},{key:"_renderValue",value:function(){this.tagBar.updateTags()}},{key:"_setValue",value:function(e){f9(y9(o.prototype),"_setValue",this).call(this,e),this.tagBar&&this.tagBar.setTags(this.value)}},{key:"_setLookupCall",value:function(e){this._setProperty("lookupCall",ur.ensure(e,this.session))}},{key:"formatValue",value:function(e){return""}},{key:"_validateValue",value:function(e){var t=et.ensure(e),n=[];return t.forEach((function(e){En.empty(e)||(e=e.toLowerCase(),n.indexOf(e)<0&&n.push(e))})),n}},{key:"_parseValue",value:function(e){var t=et.ensure(this.value);return(t=t.slice()).push(e),t}},{key:"_renderDisplayText",value:function(){this.$field.val(this.displayText),f9(y9(o.prototype),"_renderDisplayText",this).call(this),this._updateInputVisible()}},{key:"_renderEnabled",value:function(){f9(y9(o.prototype),"_renderEnabled",this).call(this),this._updateInputVisible()}},{key:"_renderFieldStyle",value:function(){f9(y9(o.prototype),"_renderFieldStyle",this).call(this),this.rendered&&this.fieldHtmlComp.invalidateLayoutTree()}},{key:"_updateInputVisible",value:function(){var e,t=!this.$field.isVisible();e=!!this.enabledComputed||En.hasText(this.displayText),this.$field.setVisible(e),e!==t&&this._renderValue()}},{key:"_readDisplayText",value:function(){return this.$field.val()}},{key:"_clear",value:function(){this.$field.val("")}},{key:"acceptInput",value:function(e){this.popup?this.popup.selectedRow()?this.popup.triggerLookupRowSelected():this.closePopup():f9(y9(o.prototype),"acceptInput",this).call(this,!1)}},{key:"_triggerAcceptInput",value:function(){this.trigger("acceptInput",{displayText:this.displayText,value:this.value})}},{key:"aboutToBlurByMouseDown",value:function(e){gH.eventOutsideProposalField(this,e)&&this.acceptInput(!0)}},{key:"_onFieldBlur",value:function(e){this.closePopup(),f9(y9(o.prototype),"_onFieldBlur",this).call(this,e),this.rendered&&!this.removing&&this.tagBar.blur()}},{key:"_onFieldFocus",value:function(e){f9(y9(o.prototype),"_onFieldFocus",this).call(this,e),this.rendered&&!this.removing&&this.tagBar.focus()}},{key:"_onFieldInput",value:function(){this._updateHasText()}},{key:"addTag",value:function(e){var t=this._parseValue(e);this.setValue(t),this._triggerAcceptInput()}},{key:"removeTag",value:function(e){if(!En.empty(e)){e=e.toLowerCase();var t=et.ensure(this.value);-1!==t.indexOf(e)&&(t=t.slice(),et.remove(t,e),this.setValue(t),this._triggerAcceptInput(),this.focus())}}},{key:"_onInputKeydown",value:function(e){this._isNavigationKey(e)&&this.popup?this.popup.delegateKeyEvent(e):e.which===pu.ESC&&this.closePopup()}},{key:"_isNavigationKey",value:function(e){return O.isOneOf(e.which,[pu.PAGE_UP,pu.PAGE_DOWN,pu.UP,pu.DOWN])}},{key:"_onInputKeyup",value:function(e){e.which!==pu.ESC&&(this._isNavigationKey(e)||this._lookupByText(this.$field.val()))}},{key:"_lookupByText",value:function(e){return this.lookupCall?En.empty(e)||e.length<2?void this.closePopup():(this._currentLookupCall=this.lookupCall.cloneForText(e),this.trigger("prepareLookupCall",{lookupCall:this._currentLookupCall}),this._currentLookupCall.execute().always(function(){this._currentLookupCall=null}.bind(this)).done(this._onLookupDone.bind(this))):null}},{key:"_onLookupDone",value:function(e){try{if(!this.rendered||!this.isFocused()||0===e.lookupRows.length)return void this.closePopup();this.openPopup(),this.popup.setLookupResult(e)}finally{this.trigger("lookupCallDone",{result:e})}}},{key:"openPopup",value:function(){this.popup||(this.popup=O.create("TagChooserPopup",{parent:this,$anchor:this.$field,boundToAnchor:!0,closeOnAnchorMouseDown:!1,field:this}),this.popup.on("lookupRowSelected",this._onLookupRowSelected.bind(this)),this.popup.one("close",this._onPopupClose.bind(this)),this.popup.open())}},{key:"closePopup",value:function(){this.popup&&!this.popup.destroying&&this.popup.close()}},{key:"_onLookupRowSelected",value:function(e){this._clear(),this._updateHasText(),this.addTag(e.lookupRow.key),this.closePopup()}},{key:"_onPopupClose",value:function(e){this.popup=null}},{key:"isInputFocused",value:function(){var e=this.$fieldContainer.activeElement();return this.$field.is(e)}},{key:"_onValueChange",value:function(e){"value"===e.propertyName&&this._renderLabel()}},{key:"_renderPlaceholder",value:function(e){var t=!!et.ensure(this.value).length;(e=O.nvl(e,this.$field))&&e.placeholder(t?"":this.label)}},{key:"_createFieldAdapter",value:function(){return o.createFieldAdapter(this)}}])&&c9(t.prototype,n),i&&c9(t,i),o}(GV);function b9(e){return(b9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g9(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function m9(e,t,n){return(m9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S9(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _9(e,t){return(_9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S9(e);if(t){var r=S9(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return k9(this,n)}}function k9(e,t){return!t||"object"!==b9(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S9(e){return(S9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_9(e,t)}(o,e);var t,n,i,r=w9(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_initProperties",value:function(e){void 0!==e.insertText&&delete e.insertText}},{key:"_postCreateWidget",value:function(){m9(S9(o.prototype),"_postCreateWidget",this).call(this),this.widget.lookupCall=O.create("RemoteLookupCall",this)}},{key:"_syncResult",value:function(e){this.widget._currentLookupCall&&this.widget._currentLookupCall.resolveLookup(e)}},{key:"_onWidgetAcceptInput",value:function(e){this._send("acceptInput",{displayText:e.displayText,value:e.value})}}])&&g9(t.prototype,n),i&&g9(t,i),o}(sJ);function T9(e){return(T9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C9(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P9(e,t,n){return(P9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=F9(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function R9(e,t){return(R9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=F9(e);if(t){var r=F9(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return E9(this,n)}}function E9(e,t){return!t||"object"!==T9(t)&&"function"!=typeof t?D9(e):t}function D9(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F9(e){return(F9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R9(e,t)}(o,e);var t,n,i,r=x9(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ESC],t.stopPropagation=!0,t.preventInvokeAcceptInputOnActiveValueField=!0,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(D9(t)),t}return t=o,(n=[{key:"_accept",value:function(e){return!!P9(F9(o.prototype),"_accept",this).call(this,e)&&!!this.field.chooser}},{key:"handle",value:function(e){this.field.closeChooserPopup()}}])&&C9(t.prototype,n),i&&C9(t,i),o}($u);function $9(e){return($9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j9(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function M9(e,t,n){return(M9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=N9(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function I9(e,t){return(I9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=N9(e);if(t){var r=N9(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return B9(this,n)}}function B9(e,t){return!t||"object"!==$9(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N9(e){return(N9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I9(e,t)}(o,e);var t,n,i,r=L9(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ENTER],t.renderingHints.render=!1,t.preventDefault=!1,t.stopPropagation=!0,t}return t=o,(n=[{key:"_accept",value:function(e){return!!M9(N9(o.prototype),"_accept",this).call(this,e)&&(this.stopPropagation=En.hasText(this.field._readDisplayText()),this.field.isInputFocused())}},{key:"handle",value:function(e){this.field.acceptInput()}}])&&j9(t.prototype,n),i&&j9(t,i),o}($u);function V9(e){return(V9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W9(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function z9(e,t,n){return(z9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=q9(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function G9(e,t){return(G9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=q9(e);if(t){var r=q9(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return K9(this,n)}}function K9(e,t){return!t||"object"!==V9(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q9(e){return(q9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Y9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G9(e,t)}(o,e);var t,n,i,r=U9(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).fieldAdapter=e,t.which=[pu.DELETE],t.renderingHints.render=!1,t.preventDefault=!1,t}return t=o,(n=[{key:"_accept",value:function(e){return!!z9(q9(o.prototype),"_accept",this).call(this,e)&&this._$focusedTag().length>0}},{key:"handle",value:function(e){var t=this._$focusedTag(),n=mee.getTagData(t);this.fieldAdapter.removeTag(n)}},{key:"_$focusedTag",value:function(){return mee.findFocusedTagElement(this.fieldAdapter.$container())}}])&&W9(t.prototype,n),i&&W9(t,i),o}($u);function X9(e){return(X9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J9(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Z9(e,t,n){return(Z9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n7(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Q9(e,t){return(Q9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function e7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=n7(e);if(t){var r=n7(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return t7(this,n)}}function t7(e,t){return!t||"object"!==X9(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function n7(e){return(n7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var i7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q9(e,t)}(o,e);var t,n,i,r=e7(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).fieldAdapter=e,t.which=[pu.LEFT,pu.RIGHT],t.preventDefault=!1,t.preventInvokeAcceptInputOnActiveValueField=!0,t}return t=o,(n=[{key:"_accept",value:function(e){return!!Z9(n7(o.prototype),"_accept",this).call(this,e)&&this.fieldAdapter.enabled()}},{key:"handle",value:function(e){e.which===pu.LEFT?this._focusTagElement(-1):e.which===pu.RIGHT&&this._focusTagElement(1)}},{key:"_focusTagElement",value:function(e){var t=mee.findFocusableTagElements(this.fieldAdapter.$container()),n=t.length;if(0!==n){var i=-1;if(t.each((function(e){s()(this).hasClass("focused")&&(i=e)})),-1===i)-1===e&&(i=n-1);else{var r=i+e;r>=n?i=-2:r<0?i=-1:(mee.unfocusTagElement(t.eq(i)),i=r)}-1===i||(-2===i?this.fieldAdapter.focus():mee.focusTagElement(t.eq(i)))}}}])&&J9(t.prototype,n),i&&J9(t,i),o}($u);function r7(e){return(r7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o7(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s7(e,t,n){return(s7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c7(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function a7(e,t){return(a7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=c7(e);if(t){var r=c7(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l7(this,n)}}function l7(e,t){return!t||"object"!==r7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c7(e){return(c7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a7(e,t)}(o,e);var t,n,i,r=u7(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.ENTER,pu.SPACE],t.renderingHints.render=!1,t.preventDefault=!1,t}return t=o,(n=[{key:"_accept",value:function(e){return!!s7(c7(o.prototype),"_accept",this).call(this,e)&&this.field.tagBar&&this.field.tagBar.isOverflowIconFocused()}},{key:"handle",value:function(e){this.field.tagBar.openOverflowPopup()}}])&&o7(t.prototype,n),i&&o7(t,i),o}($u);function h7(e){return(h7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d7(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p7(e,t){return(p7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b7(e);if(t){var r=b7(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v7(this,n)}}function v7(e,t){return!t||"object"!==h7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b7(e){return(b7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p7(e,t)}(o,e);var t,n,i,r=y7(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"_$elementForIconLayout",value:function(){return this.formField.$fieldContainer}}])&&d7(t.prototype,n),i&&d7(t,i),o}(sV);function m7(e){return(m7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _7(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w7(e,t){return(w7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=O7(e);if(t){var r=O7(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return S7(this,n)}}function S7(e,t){return!t||"object"!==m7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O7(e){return(O7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w7(e,t)}(o,e);var t,n,i,r=k7(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tagField=e,t}return t=o,(n=[{key:"layout",value:function(e){var t=Uo.get(e),n=this.tagField.value&&this.tagField.value.length>0,i=this.tagField.$field,r=this.tagField.tagBar.htmlComp;if(this.tagField.tagBar.setVisible(n),n){i.removeClass("fullwidth");var s=t.availableSize().subtract(t.insets()),a=s.width;i.isVisible()&&(a=s.width*(1-o.MIN_INPUT_TAG_RATIO));var u=r.prefSize(),l=Math.min(a,u.width);r.setSize(new Co(l,s.height));var c=s.width-l;i.cssWidth(c)}else i.addClass("fullwidth").removeAttr("style")}}])&&_7(t.prototype,n),i&&_7(t,i),o}(zo);function C7(e){return(C7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P7(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function R7(e,t,n){return(R7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=F7(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function x7(e,t){return(x7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=F7(e);if(t){var r=F7(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return D7(this,n)}}function D7(e,t){return!t||"object"!==C7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function F7(e){return(F7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(T7,"MIN_INPUT_TAG_RATIO",.33);var A7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x7(e,t)}(o,e);var t,n,i,r=E7(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).eventDelegator=null,e._addWidgetProperties(["tileGrid"]),e}return t=o,(n=[{key:"_init",value:function(e){R7(F7(o.prototype),"_init",this).call(this,e),this._setTileGrid(this.tileGrid)}},{key:"_createLoadingSupport",value:function(){return null}},{key:"_render",value:function(){this.addContainer(this.$parent,"tile-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.tileGrid&&this._renderTileGrid()}},{key:"_renderProperties",value:function(){R7(F7(o.prototype),"_renderProperties",this).call(this),this._renderDropType()}},{key:"setTileGrid",value:function(e){this.setProperty("tileGrid",e)}},{key:"_setTileGrid",value:function(e){this.tileGrid&&this.eventDelegator&&(this.eventDelegator.destroy(),this.eventDelegator=null),this._setProperty("tileGrid",e),e&&(this.eventDelegator=at.create(this,e,{delegateProperties:["loading"]}),e.setLoading(this.loading),e.setScrollTop(this.scrollTop))}},{key:"_renderTileGrid",value:function(){this.tileGrid&&(this.tileGrid.render(),this.addField(this.tileGrid.$container),this.invalidateLayoutTree())}},{key:"_removeTileGrid",value:function(){this.tileGrid&&(this.tileGrid.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"getDelegateScrollable",value:function(){return this.tileGrid}}])&&P7(t.prototype,n),i&&P7(t,i),o}(GH);function $7(e){return($7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j7(e,t){return(j7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=L7(e);if(t){var r=L7(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return I7(this,n)}}function I7(e,t){return!t||"object"!==$7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L7(e){return(L7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j7(e,t)}(n,e);var t=M7(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function N7(e){return(N7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H7(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function V7(e,t,n){return(V7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=U7(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function W7(e,t){return(W7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=U7(e);if(t){var r=U7(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return G7(this,n)}}function G7(e,t){return!t||"object"!==N7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function U7(e){return(U7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var K7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W7(e,t)}(o,e);var t,n,i,r=z7(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).tree=null,e._populating=!1,e._addWidgetProperties(["tree","filterBox"]),e}return t=o,(n=[{key:"_init",value:function(e){V7(U7(o.prototype),"_init",this).call(this,e),this.tree.on("nodesChecked",this._onTreeNodesChecked.bind(this)),this.tree.setScrollTop(this.scrollTop)}},{key:"_initStructure",value:function(e){this.tree||(this.tree=this._createDefaultTreeBoxTree())}},{key:"_initValue",value:function(e){this.tree||(this.tree=this._createDefaultTreeBoxTree()),V7(U7(o.prototype),"_initValue",this).call(this,e)}},{key:"_render",value:function(){V7(U7(o.prototype),"_render",this).call(this),this.$container.addClass("tree-box")}},{key:"_createFieldContainerLayout",value:function(){return new o8(this,this.tree,this.filterBox)}},{key:"_renderStructure",value:function(e){this.tree.render(this.$fieldContainer),this.addField(this.tree.$container)}},{key:"_onTreeNodesChecked",value:function(e){this._populating||this._syncTreeToValue()}},{key:"_syncTreeToValue",value:function(){if(this.lookupCall&&!this._valueSyncing){this._valueSyncing=!0;var e=oi.values(this.tree.nodesMap).filter((function(e){return e.checked})).map((function(e){return e.id}));this.setValue(e),this._valueSyncing=!1}}},{key:"_valueChanged",value:function(){V7(U7(o.prototype),"_valueChanged",this).call(this),this._syncValueToTree(this.value)}},{key:"_syncValueToTree",value:function(e){if(this.lookupCall&&!this._valueSyncing&&this.initialized){this._valueSyncing=!0;var t={checkOnlyEnabled:!1,checkChildren:!1};try{if(et.empty(e))this.uncheckAll(t);else{if(this._ensureLookupCallExecuted())return;this.uncheckAll(t),oi.values(this.tree.nodesMap).forEach((function(n){et.containsAny(e,n.id)&&this.tree.checkNode(n,!0,t)}),this)}this._updateDisplayText()}finally{this._valueSyncing=!1}}}},{key:"uncheckAll",value:function(e){for(var t in this.tree.nodesMap)this.tree.nodesMap.hasOwnProperty(t)&&this.tree.uncheckNode(this.tree.nodesMap[t],e)}},{key:"_lookupByAllDone",value:function(e){V7(U7(o.prototype),"_lookupByAllDone",this).call(this,e)&&this._populateTree(e)}},{key:"_populateTree",value:function(e){var t=[];this._populating=!0,this._populateTreeRecursive(null,t,e.lookupRows),this.tree.deleteAllNodes(),this.tree.insertNodes(t),this._populating=!1,this._syncValueToTree(this.value)}},{key:"_populateTreeRecursive",value:function(e,t,n){var i;n.forEach((function(r){r.parentKey===e&&(i=this._createNode(r),this._populateTreeRecursive(i.id,i.childNodes,n),i.leaf=!i.childNodes.length,t.push(i))}),this)}},{key:"getCheckedLookupRows",value:function(){return null===this.value||et.empty(this.value)||0===this.tree.nodes.length?[]:oi.values(this.tree.nodesMap).filter((function(e){return e.checked})).map((function(e){return e.lookupRow}))}},{key:"_createNode",value:function(e){var t=O.create("TreeNode",{parent:this.tree,id:e.key,text:e.text,lookupRow:e});return e.iconId&&(t.iconId=e.iconId),e.tooltipText&&(t.tooltipText=e.tooltipText),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.foregroundColor&&(t.foregroundColor=e.foregroundColor),e.font&&(t.font=e.font),!1===e.enabled&&(t.enabled=!1),!1===e.active&&(t.active=!1),e.cssClass&&(t.cssClass=e.cssClass),t}},{key:"_createDefaultTreeBoxTree",value:function(){return O.create("Tree",{parent:this,checkable:!0})}},{key:"getDelegateScrollable",value:function(){return this.tree}}])&&H7(t.prototype,n),i&&H7(t,i),o}(WW);function q7(e){return(q7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y7(e,t){return(Y7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Z7(e);if(t){var r=Z7(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return J7(this,n)}}function J7(e,t){return!t||"object"!==q7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z7(e){return(Z7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Q7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y7(e,t)}(n,e);var t=X7(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(QV);function e8(e){return(e8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t8(e,t){return(t8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=r8(e);if(t){var r=r8(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return i8(this,n)}}function i8(e,t){return!t||"object"!==e8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r8(e){return(r8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var o8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&t8(e,t)}(n,e);var t=n8(n);function n(e,i,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,i,r)}return n}(XW);function s8(e){return(s8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a8(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u8(e,t){return(u8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=f8(e);if(t){var r=f8(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c8(this,n)}}function c8(e,t){return!t||"object"!==s8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f8(e){return(f8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u8(e,t)}(o,e);var t,n,i,r=l8(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).gridDataHints.weightY=1,e.gridDataHints.h=3,e._addWidgetProperties(["tree"]),e}return t=o,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"tree-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.tree&&this._renderTree()}},{key:"setTree",value:function(e){this.setProperty("tree",e)}},{key:"_setTree",value:function(e){this._setProperty("tree",e),e&&e.setScrollTop(this.scrollTop)}},{key:"_renderTree",value:function(){this.tree&&(this.tree.render(),this.addField(this.tree.$container),this.$field.addDeviceClass(),this.invalidateLayoutTree())}},{key:"_removeTree",value:function(){this.tree&&(this.tree.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"getDelegateScrollable",value:function(){return this.tree}}])&&a8(t.prototype,n),i&&a8(t,i),o}(GH);function d8(e){return(d8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p8(e,t){return(p8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b8(e);if(t){var r=b8(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v8(this,n)}}function v8(e,t){return!t||"object"!==d8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b8(e){return(b8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p8(e,t)}(n,e);var t=y8(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function m8(e){return(m8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _8(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w8(e,t,n){return(w8="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T8(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function k8(e,t){return(k8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=T8(e);if(t){var r=T8(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return O8(this,n)}}function O8(e,t){return!t||"object"!==m8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T8(e){return(T8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k8(e,t)}(o,e);var t,n,i,r=S8(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).steps=[],e.previousActiveStepIndex,e.stepsMap={},e}return t=o,(n=[{key:"_init",value:function(e){w8(T8(o.prototype),"_init",this).call(this,e),this._updateStepsMap()}},{key:"_render",value:function(){this.addContainer(this.$parent,"wizard-progress-field",new V8(this)),this.addField(this.$parent.makeDiv("wizard-steps")),this.addStatus(),this.addLabel(),this.$wizardStepsBody=this.$field.appendDiv("wizard-steps-body"),this._installScrollbars({axis:"x"}),this.parent instanceof rY&&this.parent.controls[0]===this&&this.parent.parent instanceof ZO&&this.parent.parent.$container.addClass("wizard-container-form")}},{key:"_renderProperties",value:function(){w8(T8(o.prototype),"_renderProperties",this).call(this),this._renderSteps(),this._renderActiveStepIndex()}},{key:"_setSteps",value:function(e){this._setProperty("steps",e),this._updateStepsMap()}},{key:"_renderSteps",value:function(){this.$wizardStepsBody.children(".wizard-step").each((function(){dh.uninstall(s()(this).children(".wizard-step-content"))})),this.$wizardStepsBody.empty(),this.steps.forEach(function(e,t){var n=this.$wizardStepsBody.appendDiv("wizard-step").addClass(e.cssClass).data("wizard-step",e);e.$step=n,this._updateStepClasses(e),this.session.inspector&&(an.applyInfo(e,n),n.attr("data-step-index",e.index));var i=n.appendDiv("wizard-step-content");En.hasText(e.tooltipText)&&dh.install(i,{parent:this,text:e.tooltipText,tooltipPosition:"bottom"});var r=i.appendDiv("wizard-step-content-icon-container").appendDiv("wizard-step-content-icon");e.iconId?r.icon(e.iconId):e.finished?r.icon(sn.CHECKED_BOLD):r.text(t+1);var o=i.appendDiv("wizard-step-content-text");o.appendDiv("wizard-step-title").textOrNbsp(e.title),e.subTitle&&o.appendDiv("wizard-step-sub-title").textOrNbsp(e.subTitle),t<this.steps.length-1&&this.$wizardStepsBody.appendDiv("wizard-step-separator").icon(sn.ANGLE_RIGHT)}.bind(this)),this.invalidateLayoutTree(!1)}},{key:"_setActiveStepIndex",value:function(e){this.previousActiveStepIndex=this.activeStepIndex,this._setProperty("activeStepIndex",O.nvl(e,-1))}},{key:"_renderActiveStepIndex",value:function(){this.steps.forEach(this._updateStepClasses.bind(this)),this.invalidateLayoutTree(!1)}},{key:"_updateStepClasses",value:function(e){var t=e.$step;t.removeClass("active-step before-active-step after-active-step first last action-enabled disabled"),t.off("click.active-step");var n=this.steps.indexOf(e),i=this.steps.indexOf(this.stepsMap[this.activeStepIndex]);this.enabledComputed&&e.enabled&&e.actionEnabled&&n!==this.activeStepIndex?(t.addClass("action-enabled"),t.on("click.active-step",this._onStepClick.bind(this))):this.enabledComputed&&e.enabled||t.addClass("disabled"),n>=0&&i>=0&&(n<i?t.addClass("before-active-step"):n>i?t.addClass("after-active-step"):t.addClass("active-step"),0===n&&t.addClass("first"),n===this.steps.length-1&&t.addClass("last")),n===this.steps.length-1&&this.$wizardStepsBody.css("background-color",t.css("background-color"))}},{key:"_stepIndex",value:function(e){if(e){var t=e.data("wizard-step");if(t)return t.index}return-1}},{key:"_updateStepsMap",value:function(){this.stepsMap={},this.steps.forEach(function(e){this.stepsMap[e.index]=e}.bind(this))}},{key:"_resolveStep",value:function(e){for(var t=0;t<this.steps.length;t++){var n=this.steps[t];if(n.index===e)return n}return null}},{key:"_onStepClick",value:function(e){var t=s()(e.currentTarget),n=this._stepIndex(t);n>=0&&n!==this.activeStepIndex&&this.trigger("stepAction",{stepIndex:n})}},{key:"scrollToActiveStep",value:function(){var e=this.stepsMap[this.activeStepIndex];if(e){var t=e.$step,n=this.$field.scrollLeft(),i=t.position().left,r=t.width(),o=this.$field.width(),s=this.previousActiveStepIndex>this.activeStepIndex,a=n+Math.floor(o*(s?.25:.75)),u=i+Math.floor(r/2);(s&&u<a||!s&&u>a)&&wf.scrollLeft(this.$field,n+(u-a))}}}])&&_8(t.prototype,n),i&&_8(t,i),o}(GH);function P8(e){return(P8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R8(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function x8(e,t,n){return(x8="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A8(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function E8(e,t){return(E8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=A8(e);if(t){var r=A8(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return F8(this,n)}}function F8(e,t){return!t||"object"!==P8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A8(e){return(A8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E8(e,t)}(o,e);var t,n,i,r=D8(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetStepAction",value:function(e){this._send("doStepAction",{stepIndex:e.stepIndex})}},{key:"_onWidgetEvent",value:function(e){"stepAction"===e.type?this._onWidgetStepAction(e):x8(A8(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&R8(t.prototype,n),i&&R8(t,i),o}(ZH);function j8(e){return(j8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M8(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function I8(e,t,n){return(I8="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=H8(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function L8(e,t){return(L8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=H8(e);if(t){var r=H8(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return N8(this,n)}}function N8(e,t){return!t||"object"!==j8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H8(e){return(H8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var V8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L8(e,t)}(o,e);var t,n,i,r=B8(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"layout",value:function(e){I8(H8(o.prototype),"layout",this).call(this,e);var t=this.formField.$field.scrollLeft(),n=this.formField.$wizardStepsBody;n.width("auto");var i=n[0].scrollWidth;n.width(i),this.formField.$field.scrollLeft(t),this.formField.scrollToActiveStep()}}])&&M8(t.prototype,n),i&&M8(t,i),o}(sV);function W8(e){return(W8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z8(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function G8(e,t,n){return(G8="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=X8(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function U8(e,t){return(U8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=X8(e);if(t){var r=X8(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return q8(this,n)}}function q8(e,t){return!t||"object"!==W8(t)&&"function"!=typeof t?Y8(e):t}function Y8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X8(e){return(X8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var J8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U8(e,t)}(o,e);var t,n,i,r=K8(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["innerForm"]),e.innerForm=null,e.initialFocusEnabled=!1,e._formDestroyHandler=e._onInnerFormDestroy.bind(Y8(e)),e}return t=o,(n=[{key:"_init",value:function(e){G8(X8(o.prototype),"_init",this).call(this,e),this._setInnerForm(this.innerForm)}},{key:"_render",value:function(){this.addContainer(this.$parent,"wrapped-form-field"),this.addLabel(),this.addStatus()}},{key:"_renderProperties",value:function(){G8(X8(o.prototype),"_renderProperties",this).call(this),this._renderInnerForm()}},{key:"setInnerForm",value:function(e){this.setProperty("innerForm",e)}},{key:"_setInnerForm",value:function(e){this.innerForm&&this.innerForm.off("destroy",this._formDestroyHandler),e&&e.on("destroy",this._formDestroyHandler),this._setProperty("innerForm",e)}},{key:"_renderInnerForm",value:function(){this.innerForm&&(this.innerForm.displayHint=ZO.DisplayHint.VIEW,this.innerForm.modal=!1,this.innerForm.renderInitialFocusEnabled=this.initialFocusEnabled,this.innerForm.render(),this.addField(this.innerForm.$container),this.innerForm.invalidateLayoutTree(),this._renderInitialFocusEnabled())}},{key:"_removeInnerForm",value:function(){this.innerForm&&this.innerForm.remove(),this._removeField()}},{key:"_onInnerFormDestroy",value:function(e){this._removeInnerForm(),this._setInnerForm(null)}},{key:"_renderInitialFocusEnabled",value:function(){this.innerForm&&this.initialFocusEnabled&&this.innerForm.renderInitialFocus()}}])&&z8(t.prototype,n),i&&z8(t,i),o}(GH);function Z8(e){return(Z8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q8(e,t){return(Q8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=nee(e);if(t){var r=nee(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return tee(this,n)}}function tee(e,t){return!t||"object"!==Z8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nee(e){return(nee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var iee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q8(e,t)}(n,e);var t=eee(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function ree(e){return(ree="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function see(e,t,n){return(see="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cee(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function aee(e,t){return(aee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=cee(e);if(t){var r=cee(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return lee(this,n)}}function lee(e,t){return!t||"object"!==ree(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cee(e){return(cee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aee(e,t)}(o,e);var t,n,i,r=uee(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).activated=!1,e.label=null,e.htmlEnabled=!1,e.$label=null,e.$button=null,e.tooltipText=null,e}return t=o,(n=[{key:"_init",value:function(e){see(cee(o.prototype),"_init",this).call(this,e),this.setTooltipText(e.tooltipText)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("switch"),this.$label=this.$container.appendDiv("switch-label"),this.$button=this.$container.appendDiv("switch-button").on("click",this._onSwitchButtonClick.bind(this))}},{key:"_renderProperties",value:function(){see(cee(o.prototype),"_renderProperties",this).call(this),this._renderActivated(),this._renderLabel(),this._renderTooltipText()}},{key:"_onSwitchButtonClick",value:function(){var e=new Kt;this.trigger("switch",e),e.defaultPrevented||this.setActivated(!this.activated)}},{key:"setLabel",value:function(e){this.setProperty("label",e)}},{key:"_renderLabel",value:function(){this.htmlEnabled?this.$label.html(this.label):this.$label.text(this.label)}},{key:"setActivated",value:function(e){this.setProperty("activated",e)}},{key:"_renderActivated",value:function(){this.$button.toggleClass("activated",this.activated)}},{key:"setTooltipText",value:function(e){this.setProperty("tooltipText",e)}},{key:"_renderTooltipText",value:function(){En.hasText(this.tooltipText)?dh.install(this.$container,{parent:this,text:this.tooltipText}):dh.uninstall(this.$container)}}])&&oee(t.prototype,n),i&&oee(t,i),o}(de);function hee(e){return(hee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pee(e,t,n){return(pee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gee(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function yee(e,t){return(yee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=gee(e);if(t){var r=gee(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bee(this,n)}}function bee(e,t){return!t||"object"!==hee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gee(e){return(gee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yee(e,t)}(o,e);var t,n,i,r=vee(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).overflowEnabled=!0,e.$overflowIcon=null,e.overflowVisible=!1,e.overflow=null,e.tags=[],e.clickable=!1,e}return t=o,i=[{key:"findFocusedTagElement",value:function(e){return e.find(".tag-element.focused")}},{key:"findFocusableTagElements",value:function(e){return e.find(".tag-element:not(.hidden),.overflow-icon")}},{key:"focusFirstTagElement",value:function(e){this.focusTagElement(this.firstTagElement(e))}},{key:"firstTagElement",value:function(e){return e.find(".tag-element").first()}},{key:"focusTagElement",value:function(e){e.setTabbable(!0).addClass("focused").focus()}},{key:"unfocusTagElement",value:function(e){e.setTabbable(!1).removeClass("focused")}},{key:"getTagData",value:function(e){var t=e.data("tag");return t||e.parent().data("tag")}},{key:"renderTags",value:function(e,t,n,i,r){e.find(".tag-element").remove(),t.forEach((function(t){o.renderTag(e,t,n,i,r)}),this)}},{key:"renderTag",value:function(e,t,n,i,r){var o=e.appendDiv("tag-element").data("tag",t),s=o.appendSpan("tag-text",t);return i&&s.addClass("clickable").on("mousedown",i),n?o.appendSpan("tag-remove-icon").on("click",r):o.addClass("disabled"),o}}],(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tag-bar"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new Cee(this)),this._installTooltipSupport()}},{key:"_renderProperties",value:function(){pee(gee(o.prototype),"_renderProperties",this).call(this),this._renderTags(),this._renderOverflowVisible()}},{key:"_remove",value:function(){this.$overflowIcon=null,this.overflowVisible=!1,this.closeOverflowPopup(),this._uninstallTooltipSupport(),pee(gee(o.prototype),"_remove",this).call(this)}},{key:"setTags",value:function(e){this.setProperty("tags",e)}},{key:"updateTags",value:function(){this.rendered&&this._renderTags()}},{key:"_renderTags",value:function(){var e=et.ensure(this.tags),t=this.clickable?this._onTagClick.bind(this):null,n=this._onTagRemoveClick.bind(this);o.renderTags(this.$container,e,this.enabledComputed,t,n),this.invalidateLayoutTree()}},{key:"_onTagClick",value:function(e){var t=o.getTagData(s()(e.currentTarget));return this._triggerTagClick(t),!1}},{key:"_triggerTagClick",value:function(e){this.trigger("tagClick",{tag:e})}},{key:"_onTagRemoveClick",value:function(e){return this.enabledComputed&&this.removeTagByElement(s()(e.currentTarget)),!1}},{key:"removeTagByElement",value:function(e){var t=o.getTagData(e);t&&this._triggerTagRemove(t,e)}},{key:"_triggerTagRemove",value:function(e,t){this.trigger("tagRemove",{tag:e,$tag:t})}},{key:"_onOverflowIconMousedown",value:function(e){return this.openOverflowPopup(),!1}},{key:"isOverflowIconFocused",value:function(){if(!this.$overflowIcon)return!1;var e=this.$container.activeElement();return this.$overflowIcon.is(e)}},{key:"openOverflowPopup",value:function(){this.overflow||(this.overflow=this._createOverflowPopup(),this.overflow.on("close",this._onOverflowPopupClose.bind(this)),this.overflow.open())}},{key:"_createOverflowPopup",value:function(){return O.create("TagBarOverflowPopup",{parent:this,closeOnAnchorMouseDown:!1,focusableContainer:!0,$anchor:this.$container,$headBlueprint:this.$overflowIcon,cssClass:this.cssClass})}},{key:"closeOverflowPopup",value:function(){this.overflow&&!this.overflow.destroying&&this.overflow.close()}},{key:"_onOverflowPopupClose",value:function(){this.overflow=null}},{key:"_installTooltipSupport",value:function(){dh.install(this.$container,{parent:this,selector:".tag-text",text:this._tagTooltipText.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Mt.get().isCustomEllipsisTooltipPossible()})}},{key:"_uninstallTooltipSupport",value:function(){dh.uninstall(this.$container)}},{key:"_tagTooltipText",value:function(e){return e.isContentTruncated()?e.text():null}},{key:"_removeFocusFromTagElements",value:function(){o.findFocusableTagElements(this.$container).removeClass("focused").setTabbable(!1)}},{key:"focus",value:function(){this.$container.addClass("focused"),this._removeFocusFromTagElements(),this.closeOverflowPopup()}},{key:"blur",value:function(){this.$container.removeClass("focused"),this.overflow&&this.overflow.$container.has(event.relatedTarget)||this.closeOverflowPopup()}},{key:"setOverflowVisible",value:function(e){this.setProperty("overflowVisible",e)}},{key:"_renderOverflowVisible",value:function(){this.overflowVisible?this.$overflowIcon||(this.$overflowIcon=this.$container.prependDiv("overflow-icon").on("mousedown",this._onOverflowIconMousedown.bind(this))):this.$overflowIcon&&(this.$overflowIcon.remove(),this.$overflowIcon=null)}},{key:"_updateErrorStatusClasses",value:function(e,t){pee(gee(o.prototype),"_updateErrorStatusClasses",this).call(this,e,t),this.$container.removeClass(GH.SEVERITY_CSS_CLASSES),this.$container.addClass(e,t)}},{key:"visibleTags",value:function(){if(!this.rendered)return[];var e=[];return this.$container.find(".tag-element:not(.hidden)").each((function(){e.push(o.getTagData(s()(this)))})),e}}])&&dee(t.prototype,n),i&&dee(t,i),o}(de);function _ee(e){return(_ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kee(e,t){return(kee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function See(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Tee(e);if(t){var r=Tee(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Oee(this,n)}}function Oee(e,t){return!t||"object"!==_ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tee(e){return(Tee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kee(e,t)}(o,e);var t,n,i,r=See(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tagBar=e,t}return t=o,(n=[{key:"layout",value:function(e){var t=Uo.get(e);if(this.tagBar.tags&&this.tagBar.tags.length>0){var n,i,r=t.availableSize().subtract(t.insets()).width,o=0,a=!1,u=e.find(".tag-element"),l=u.length,c=[];for(u.removeClass("hidden"),i=l-1;i>=0&&(n=s()(u[i]),c[i]=No.size(n,{includeMargin:!0}),!(a=o+c[i].width>r));i--)o+=c[i].width;if(this.tagBar.setOverflowVisible(a),a)for(o=No.size(this.tagBar.$overflowIcon,{includeMargin:!0}).width,i=l-1;i>=0;i--)n=s()(u[i]),c[i]?o+c[i].width>r?n.addClass("hidden"):o+=c[i].width:n.addClass("hidden")}}},{key:"preferredLayoutSize",value:function(e,t){var n=Uo.get(e),i=this.tagBar.tags&&this.tagBar.tags.length>0,r=n.availableSize(),o=0;if(!i)return new Co(0,r.height);var a=e.find(".tag-element");return a.removeClass("hidden"),a.each((function(){o+=No.size(s()(this),{includeMargin:!0}).width})),new Co(o,r.height)}}])&&wee(t.prototype,n),i&&wee(t,i),o}(zo);function Pee(e){return(Pee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ree(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xee(e,t,n){return(xee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Aee(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Eee(e,t){return(Eee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Aee(e);if(t){var r=Aee(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Fee(this,n)}}function Fee(e,t){return!t||"object"!==Pee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Aee(e){return(Aee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eee(e,t)}(o,e);var t,n,i,r=Dee(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._tagBarPropertyChangeListener=null,e.initialFocus=function(){return mee.firstTagElement(this.$body).setTabbable(!0).addClass("focused")[0]},e}return t=o,i=[{key:"createFieldAdapter",value:function(e){return{$container:function(){return e.$body},enabled:function(){return!0},focus:function(){},one:function(t,n){e.one(t,n)},off:function(t,n){e.off(t,n)},removeTag:function(t){e.parent.parent.removeTag(t)}}}}],(n=[{key:"_init",value:function(e){xee(Aee(o.prototype),"_init",this).call(this,e),this._tagBarPropertyChangeListener=this._onTagBarPropertyChange.bind(this),this.parent.on("propertyChange",this._tagBarPropertyChangeListener)}},{key:"_initKeyStrokeContext",value:function(){xee(Aee(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStrokes([new i7(this._createFieldAdapter()),new Y9(this._createFieldAdapter())])}},{key:"_destroy",value:function(){this.parent.off("propertyChange",this._tagBarPropertyChangeListener),xee(Aee(o.prototype),"_destroy",this).call(this)}},{key:"_render",value:function(){xee(Aee(o.prototype),"_render",this).call(this),this.$body.addClass("tag-overflow-popup"),this._renderTags()}},{key:"_renderTags",value:function(){var e=this.parent,t=e.visibleTags(),n=et.ensure(e.tags).filter((function(e){return-1===t.indexOf(e)})),i=e._onTagClick.bind(e),r=e._onTagRemoveClick.bind(e);mee.renderTags(this.$body,n,e.enabledComputed,i,r),this.rendering||this.revalidateLayout()}},{key:"_renderHead",value:function(){xee(Aee(o.prototype),"_renderHead",this).call(this),this._copyCssClassToHead("overflow-icon"),this.$head.removeClass("popup-head menu-item").addClass("tag-overflow-popup-head")}},{key:"_focusFirstTagElement",value:function(){mee.focusFirstTagElement(this.$body)}},{key:"_onTagRemoveClick",value:function(e){this.parent._onTagRemoveClick(e)}},{key:"_onTagBarPropertyChange",value:function(e){if("tags"===e.propertyName){var t=et.ensure(this.parent.tags),n=this.parent.visibleTags(),i=t.length;0===i||i===n.length?this.close():(this._renderTags(),this._focusFirstTagElement())}}},{key:"_createFieldAdapter",value:function(){return o.createFieldAdapter(this)}}])&&Ree(t.prototype,n),i&&Ree(t,i),o}(op);function jee(e){return(jee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Iee(e,t,n){return(Iee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Hee(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Lee(e,t){return(Lee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Hee(e);if(t){var r=Hee(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Nee(this,n)}}function Nee(e,t){return!t||"object"!==jee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hee(e){return(Hee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lee(e,t)}(o,e);var t,n,i,r=Bee(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).displayStyle=o.DisplayStyle.DEFAULT,e.filterAccepted=!0,e.gridData=null,e.gridDataHints=new kV,e.colorScheme=null,e.selected=!1,e.selectable=!1,e}return t=o,(n=[{key:"_createLoadingSupport",value:function(){return new te({widget:this})}},{key:"_init",value:function(e){Iee(Hee(o.prototype),"_init",this).call(this,e),this._setGridDataHints(this.gridDataHints),this._setColorScheme(this.colorScheme),this._setSelectable(this.selectable)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tile"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new xa)}},{key:"_renderProperties",value:function(){Iee(Hee(o.prototype),"_renderProperties",this).call(this),this._renderColorScheme(),this._renderSelectable(),this._renderSelected(),this._renderDisplayStyle()}},{key:"_postRender",value:function(){this.$container.addClass("tile"),this.htmlComp.layout.animateClasses=["animate-visible","animate-invisible","animate-insert","animate-remove"]}},{key:"_renderDisplayStyle",value:function(){this.$container.toggleClass("default-tile",this.displayStyle===o.DisplayStyle.DEFAULT)}},{key:"setGridDataHints",value:function(e){this.setProperty("gridDataHints",e),this.rendered&&this.parent.invalidateLogicalGrid()}},{key:"_setGridDataHints",value:function(e){e||(e=new kV),this._setProperty("gridDataHints",kV.ensure(e))}},{key:"setColorScheme",value:function(e){this.setProperty("colorScheme",e)}},{key:"_setColorScheme",value:function(e){var t={scheme:o.ColorSchemeId.DEFAULT,inverted:!1};e=this._ensureColorScheme(e),e=s.a.extend({},t,e),this._setProperty("colorScheme",e)}},{key:"_ensureColorScheme",value:function(e){if("object"===jee(e))return e;var t={};return"string"==typeof e&&(En.startsWith(e,o.ColorSchemeId.ALTERNATIVE)&&(t.scheme=o.ColorSchemeId.ALTERNATIVE),En.startsWith(e,o.ColorSchemeId.RAINBOW)&&(t.scheme=o.ColorSchemeId.RAINBOW),t.inverted=En.endsWith(e,"-inverted")),t}},{key:"_renderColorScheme",value:function(){this.$container.toggleClass("color-alternative",this.colorScheme.scheme===o.ColorSchemeId.ALTERNATIVE),this.$container.toggleClass("color-rainbow",this.colorScheme.scheme===o.ColorSchemeId.RAINBOW),this.$container.toggleClass("inverted",this.colorScheme.inverted)}},{key:"setSelected",value:function(e){e&&!this.selectable||this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.toggleClass("selected",this.selected)}},{key:"setSelectable",value:function(e){this.setProperty("selectable",e)}},{key:"_setSelectable",value:function(e){this._setProperty("selectable",e),this.selectable||this.setSelected(!1)}},{key:"_renderSelectable",value:function(){this.$container.toggleClass("selectable",this.selectable)}},{key:"setFilterAccepted",value:function(e){this.setProperty("filterAccepted",e)}},{key:"_renderFilterAccepted",value:function(){this._renderVisible()}},{key:"_renderVisible",value:function(){this.rendering?this.$container.setVisible(this.isVisible()):this.removalPending||(this.isVisible()?(this.$container.addClass("invisible"),this.$container.setVisible(!0),this.session.layoutValidator.schedulePostValidateFunction(function(){this.rendered&&this.isVisible()&&(this.$container.removeClass("invisible animate-invisible"),this.$container.addClassForAnimation("animate-visible"))}.bind(this))):(this.$container.removeClass("invisible animate-visible"),this.$container.addClassForAnimation("animate-invisible"),this.$container.oneAnimationEnd(function(){this.$container.setVisible(this.isVisible())}.bind(this))),this.invalidateParentLogicalGrid())}},{key:"isVisible",value:function(){return this.visible&&this.filterAccepted}}])&&Mee(t.prototype,n),i&&Mee(t,i),o}(de);function zee(e){return(zee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gee(e,t){return(Gee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Uee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=qee(e);if(t){var r=qee(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Kee(this,n)}}function Kee(e,t){return!t||"object"!==zee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qee(e){return(qee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Vee(Wee,"ColorSchemeId",{DEFAULT:"default",ALTERNATIVE:"alternative",RAINBOW:"rainbow"}),Vee(Wee,"DisplayStyle",{DEFAULT:"default",PLAIN:"plain"});var Yee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gee(e,t)}(n,e);var t=Uee(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(fe);function Xee(e){return(Xee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zee(e,t,n){return(Zee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ite(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Qee(e,t){return(Qee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ete(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ite(e);if(t){var r=ite(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return tte(this,n)}}function tte(e,t){return!t||"object"!==Xee(t)&&"function"!=typeof t?nte(e):t}function nte(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ite(e){return(ite=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qee(e,t)}(o,e);var t,n,i,r=ete(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).animateTileRemoval=!0,e.animateTileInsertion=!0,e.comparator=null,e._doubleClickSupport=new Lt,e.empty=!1,e.filters=[],e.filteredTiles=[],e.filteredTilesDirty=!0,e.focusedTile=null,e.gridColumnCount=4,e.prefGridColumnCount=e.gridColumnCount,e.logicalGrid=O.create("scout.HorizontalGrid"),e.layoutConfig=null,e.menus=[],e.multiSelect=!0,e.renderAnimationEnabled=!1,e.selectable=!1,e.selectedTiles=[],e.selectionHandler=new Ite(nte(e)),e.scrollable=!0,e.scrolling=!1,e.scrollTopDirty=!1,e.startupAnimationDone=!1,e.startupAnimationEnabled=!1,e.tiles=[],e.tileRemovalPendingCount=0,e.viewRangeSize=0,e.viewRangeRendered=new fi(0,0),e.virtual=!1,e.virtualScrolling=null,e.withPlaceholders=!1,e._filterMenusHandler=e._filterMenus.bind(nte(e)),e._renderViewPortAfterAttach=!1,e._scrollParentScrollHandler=e._onScrollParentScroll.bind(nte(e)),e._addWidgetProperties(["tiles","selectedTiles","menus"]),e._addPreserveOnPropertyChangeProperties(["selectedTiles"]),e.$fillBefore=null,e.$fillAfter=null,e}return t=o,(n=[{key:"_init",value:function(e){Zee(ite(o.prototype),"_init",this).call(this,e),this._setGridColumnCount(this.gridColumnCount),this._setLayoutConfig(this.layoutConfig),this._initVirtualScrolling(),this._initTiles(),this._applyFilters(this.tiles),this._updateFilteredTiles(),this._setMenus(this.menus)}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initVirtualScrolling",value:function(){this.virtualScrolling=this._createVirtualScrolling()}},{key:"_createVirtualScrolling",value:function(){return new Sf({widget:this,enabled:this.virtual,viewRangeSize:this.viewRangeSize,rowHeight:this._heightForRow.bind(this),rowCount:this.rowCount.bind(this),_renderViewRange:this._renderViewRange.bind(this)})}},{key:"_createLoadingSupport",value:function(){return new te({widget:this})}},{key:"_initKeyStrokeContext",value:function(){Zee(ite(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new uie(this),new vie(this),new Oie(this),new Fie(this),new Nie(this),new qie(this),new nre(this),new Yu(this,this.showContextMenu,this)])}},{key:"_initTiles",value:function(){this.tiles.forEach((function(e){this._initTile(e)}),this)}},{key:"_initTile",value:function(e){e.setSelectable(this.selectable),e.setSelected(this.selectedTiles.indexOf(e)>=0),e.setParent(this),e.setFilterAccepted(!0)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tile-grid"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.$container.on("mousedown","> .tile",this._onTileMouseDown.bind(this)).on("click","> .tile",this._onTileClick.bind(this)).on("dblclick","> .tile",this._onTileDoubleClick.bind(this))}},{key:"_createLayout",value:function(){return new Pte(this,this.layoutConfig)}},{key:"_renderProperties",value:function(){Zee(ite(o.prototype),"_renderProperties",this).call(this),this._renderLayoutConfig(),this._renderScrollable(),this._renderVirtual(),this._renderSelectable(),this._renderEmpty()}},{key:"_remove",value:function(){this.$fillBefore=null,this.$fillAfter=null,this.viewRangeRendered=new fi(0,0),this._updateVirtualScrollable(),Zee(ite(o.prototype),"_remove",this).call(this)}},{key:"_renderOnAttach",value:function(){Zee(ite(o.prototype),"_renderOnAttach",this).call(this),this._renderViewPortAfterAttach&&(this._renderViewPort(),this._renderViewPortAfterAttach=!1)}},{key:"_renderEnabled",value:function(){Zee(ite(o.prototype),"_renderEnabled",this).call(this),this._updateTabbable()}},{key:"_updateTabbable",value:function(){this.$container.setTabbable(this.enabled&&this.selectable)}},{key:"insertTile",value:function(e){this.insertTiles([e])}},{key:"insertTiles",value:function(e,t){0!==(e=et.ensure(e)).length&&this.setTiles(this.tiles.concat(e),t)}},{key:"deleteTile",value:function(e){this.deleteTiles([e])}},{key:"deleteTiles",value:function(e,t){if(0!==(e=et.ensure(e)).length){var n=this.tiles.slice();et.removeAll(n,e),this.setTiles(n,t)}}},{key:"deleteAllTiles",value:function(){this.setTiles([])}},{key:"setTiles",value:function(e,t){if(e=et.ensure(e),!oi.equals(this.tiles,e)){e=this._createChildren(e),this.withPlaceholders&&O.nvl(t,!0)&&this._deletePlaceholders(e);var n=et.diff(e,this.tiles);if(this._insertTiles(n),this.withPlaceholders&&O.nvl(t,!0)){var i=this.placeholders();i=i.slice(Math.min(this._filterTiles(n).length,i.length),i.length),et.pushAll(e,i)}var r=et.diff(this.tiles,e);this._deleteTiles(r),this._sort(e),this.filteredTilesDirty=this.filteredTilesDirty||r.length>0||n.length>0||!et.equals(this.tiles,e);var o=this.tiles;this._setProperty("tiles",e),this._updateFilteredTiles(),this.rendered&&(this._renderTileDelta(),this._renderTileOrder(o),this._renderInsertTiles(n))}}},{key:"_insertTiles",value:function(e){0!==e.length&&e.forEach((function(e){this._insertTile(e)}),this)}},{key:"_insertTile",value:function(e){this._initTile(e),this._applyFilters([e]),!this.virtual&&this.rendered&&this._renderTile(e)}},{key:"_renderTile",value:function(e){e.removalPending?e.one("remove",function(){e.rendered||(this._renderTile(e),this._renderTileVisibleForFilter(e),0===this.tileRemovalPendingCount&&this.invalidateLayoutTree())}.bind(this)):(e.render(),e.setLayoutData(new ts(e)),e.$container.addClass("newly-rendered"))}},{key:"_renderInsertTiles",value:function(e){e.forEach((function(e){e.rendered&&(e.$container.addClass("invisible"),this.one("layoutAnimationDone",function(){e.rendered&&(e.$container.removeClass("invisible"),this._animateTileInsertion(e)&&e.$container.addClassForAnimation("animate-insert"))}.bind(this)))}),this),this.htmlComp.layouting||this.invalidateLayoutTree()}},{key:"_removeAllTiles",value:function(){this.tiles.forEach((function(e){e.remove()})),this.viewRangeRendered=new fi(0,0)}},{key:"_renderAllTiles",value:function(){this.tiles.forEach((function(e){this._renderTile(e)}),this)}},{key:"_deleteTiles",value:function(e){0!==e.length&&(e.forEach((function(e){this._deleteTile(e)}),this),this.deselectTiles(e),this.rendered&&!this.htmlComp.layouting&&this.invalidateLayoutTree())}},{key:"_deleteTile",value:function(e){this._animateTileRemoval(e)&&(e.animateRemoval=!0),e.owner===this?e.destroy():this.rendered&&e.remove(),this._onAnimatedTileRemove(e),e.animateRemoval=!1,e===this.focusedTile&&this.setFocusedTile(null)}},{key:"_animateTileRemoval",value:function(e){return this.animateTileRemoval&&!(e instanceof Pre)}},{key:"_animateTileInsertion",value:function(e){return this.animateTileInsertion&&!(e instanceof Pre)}},{key:"_onAnimatedTileRemove",value:function(e){e.rendered&&e.animateRemoval&&(this.tileRemovalPendingCount++,e.one("remove",function(){this.tileRemovalPendingCount--,this.rendered&&0===this.tileRemovalPendingCount&&!this.htmlComp.layouting&&this.invalidateLayoutTree()}.bind(this)))}},{key:"setComparator",value:function(e){this.comparator!==e&&(this.comparator=e)}},{key:"sort",value:function(){var e=this.tiles.slice();if(this._sort(e),!et.equals(this.tiles,e)){var t=this.tiles;this._setProperty("tiles",e),this.filteredTilesDirty=!0,this._updateFilteredTiles(),this.rendered&&(this._renderTileDelta(),this._renderTileOrder(t),this.validateLayoutTree())}}},{key:"_sort",value:function(e){if(null!==this.comparator){var t=[];this.withPlaceholders&&(t=this._deletePlaceholders(e)),e.sort(this.comparator),et.pushAll(e,t)}}},{key:"invalidateLayoutTree",value:function(e){this.tileRemovalPendingCount>0||Zee(ite(o.prototype),"invalidateLayoutTree",this).call(this,e)}},{key:"setGridColumnCount",value:function(e){this.setProperty("gridColumnCount",e)}},{key:"_setGridColumnCount",value:function(e){this._setProperty("gridColumnCount",e),this.prefGridColumnCount=e,this.invalidateLogicalGrid()}},{key:"setLayoutConfig",value:function(e){this.setProperty("layoutConfig",e)}},{key:"_setLayoutConfig",value:function(e){e||(e=new jte),this._setProperty("layoutConfig",jte.ensure(e))}},{key:"_renderLayoutConfig",value:function(){var e=this.htmlComp.layout.minWidth;this.layoutConfig.applyToLayout(this.htmlComp.layout),this.virtualScrolling&&(this.virtualScrolling.setMinRowHeight(this._minRowHeight()),this.setViewRangeSize(this.virtualScrolling.viewRangeSize,!1)),e!==this.htmlComp.layout.minWidth&&this._renderScrollable(),this.invalidateLayoutTree()}},{key:"_setMenus",value:function(e,t){this.updateKeyStrokes(e,t),this._setProperty("menus",e)}},{key:"_filterMenus",value:function(e,t,n,i,r){return mb.filterAccordingToSelection("TileGrid",this.selectedTiles.length,e,t,n,i,r)}},{key:"showContextMenu",value:function(e){this.session.onRequestsDone(this._showContextMenu.bind(this,e))}},{key:"_showContextMenu",value:function(e){if(e=e||{},this.rendered&&this.attached&&0!==this.selectedTiles.length){var t=e.menuItems||this._filterMenus(this.menus,_b.CONTEXT_MENU,!0,!1);if(0!==t.length){var n=O.nvl(e.pageX,null),i=O.nvl(e.pageY,null);if(null===n||null===i){var r,o=this.$container.scrollParent();0===o.length&&(o=this.$container);var s=No.offsetBounds(o),a=this.focusedTile||et.last(this.selectedTiles);n=(r=this.isTileInView(a)?a.$container.offset():this.$container.offset()).left+10,i=r.top+10,n=Math.min(Math.max(n,s.x+1),s.right()-1),i=Math.min(Math.max(i,s.y+1),s.bottom()-1)}this.contextMenu&&this.contextMenu.close(),this.contextMenu=O.create("ContextMenuPopup",{parent:this,menuItems:t,location:{x:n,y:i},$anchor:this.$container,menuFilter:e.menuFilter||this._filterMenusHandler}),this.contextMenu.open()}}}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this._uninstallScrollbars(),this.scrollable?this._installScrollbars({axis:this.layoutConfig.minWidth>0?"both":"y"}):this.layoutConfig.minWidth>0&&this._installScrollbars({axis:"x"}),this.$container.toggleClass("scrollable",this.scrollable),this._updateVirtualScrollable(),this.invalidateLayoutTree()}},{key:"_onScroll",value:function(){var e=this.$container[0].scrollTop,t=this.$container[0].scrollLeft;this.scrollTop!==e&&this.virtual&&(this.scrolling=!0,this.revalidateLayout(),this.scrolling=!1),this.scrollTop=e,this.scrollLeft=t}},{key:"_onScrollParentScroll",value:function(e){this.scrolling=!0,this.revalidateLayoutTree(!1),this.scrolling=!1}},{key:"setWithPlaceholders",value:function(e){this.setProperty("withPlaceholders",e)}},{key:"_renderWithPlaceholders",value:function(){this.invalidateLayoutTree()}},{key:"fillUpWithPlaceholders",value:function(){this.withPlaceholders?(this._deleteObsoletePlaceholders(),this._insertMissingPlaceholders()):this._deleteAllPlaceholders()}},{key:"tilesWithoutPlaceholders",value:function(){return this.withPlaceholders?this.tiles.filter((function(e){return!(e instanceof Pre)})):this.tiles}},{key:"_createPlaceholders",value:function(){var e,t,n=this.gridColumnCount,i=this.filteredTiles,r=[];if((t=i.length>0?i[i.length-1].gridData.x:-1)===n-1)return[];e=n-1-t;for(var o=0;o<e;o++)r.push(this._createPlaceholder());return r}},{key:"_createPlaceholder",value:function(){return O.create("PlaceholderTile",{parent:this})}},{key:"_deleteObsoletePlaceholders",value:function(){var e=[],t=!1;this.placeholders().forEach((function(n){0===n.gridData.x&&this.filteredTiles[0]!==n&&(t=!0),t&&e.push(n)}),this),this.deleteTiles(e,!1)}},{key:"_deleteAllPlaceholders",value:function(){this.deleteTiles(this.placeholders(),!1)}},{key:"placeholders",value:function(){var e,t=[];for(e=this.tiles.length-1;e>=0&&this.tiles[e]instanceof Pre;e--)et.insert(t,this.tiles[e],0);return t}},{key:"_insertMissingPlaceholders",value:function(){var e=this._createPlaceholders();this.insertTiles(e,!1)}},{key:"_deletePlaceholders",value:function(e){var t,n=[];for(t=e.length-1;t>=0;t--)e[t]instanceof Pre&&(n.push(e[t]),et.remove(e,e[t]));return n.reverse()}},{key:"_replacePlaceholders",value:function(e,t){for(var n=et.findIndexFromReverse(e,e.length-1,(function(e){return!(e instanceof Pre)})),i=e.length-1-n,r=1;r<=i;r++){var o=e[n+r];!t[r-1]||t[r-1]instanceof Pre||et.remove(e,o)}}},{key:"validateLogicalGrid",value:function(){this.logicalGrid.dirty&&(this.logicalGrid.validate(this),this.fillUpWithPlaceholders(),this.logicalGrid.setDirty(!0),this.logicalGrid.validate(this))}},{key:"_setLogicalGrid",value:function(e){Zee(ite(o.prototype),"_setLogicalGrid",this).call(this,e),this.logicalGrid&&this.logicalGrid.setGridConfig(new mte)}},{key:"setFocusedTile",value:function(e){if(this.focusedTile!==e&&(this.focusedTile=e,this.rendered&&e&&!this.isFocused())){var t=this.$container.scrollParents();if(0!==t.length){var n=t.map((function(e,t){return t.scrollTop()})).toArray();this.focus()&&n.forEach((function(e,n){t[n].scrollTop(e)}),this)}}}},{key:"setSelectable",value:function(e){this.setProperty("selectable",e),e||this.deselectAllTiles(),this.tiles.forEach((function(t){t.setSelectable(e)}))}},{key:"_renderSelectable",value:function(){this.$container.toggleClass("selectable",this.selectable),this._updateTabbable(),this.invalidateLayoutTree()}},{key:"setMultiSelect",value:function(e){this.setProperty("multiSelect",e)}},{key:"selectTiles",value:function(e){if(e=et.ensure(e),e=this._createChildren(e),e=this._filterTiles(e),this.selectable||(e=[]),!this.multiSelect&&e.length>1&&(e=[e[0]]),!et.equals(this.selectedTiles,e)){var t=this.selectedTiles;et.removeAll(t,e),t.forEach((function(e){e.setSelected(!1),e===this.focusedTile&&this.setFocusedTile(null)}),this),e.forEach((function(e){e.setSelected(!0)}),this),this.setProperty("selectedTiles",e.slice())}}},{key:"selectTile",value:function(e){this.selectTiles([e])}},{key:"selectAllTiles",value:function(){this.selectTiles(this.filteredTiles)}},{key:"deselectTiles",value:function(e){e=et.ensure(e);var t=this.selectedTiles.slice();et.removeAll(t,e)&&this.selectTiles(t)}},{key:"deselectTile",value:function(e){this.deselectTiles([e])}},{key:"deselectAllTiles",value:function(){this.selectTiles([])}},{key:"toggleSelection",value:function(){this.selectedTiles.length===this.filteredTiles.length?this.deselectAllTiles():this.selectAllTiles()}},{key:"addTilesToSelection",value:function(e){e=et.ensure(e),this.selectTiles(this.selectedTiles.concat(e))}},{key:"addTileToSelection",value:function(e){this.addTilesToSelection([e])}},{key:"isTileInView",value:function(e){var t=this.$container.scrollParent();return 0===t.length&&(t=this.$container),!!(e&&e.$container&&t)&&No.offsetBounds(e.$container).intersects(No.offsetBounds(t))}},{key:"_onTileMouseDown",value:function(e){if(this._doubleClickSupport.mousedown(e),this._selectTileOnMouseDown(e),3===e.which)return this.showContextMenu({pageX:e.pageX,pageY:e.pageY}),!1}},{key:"_onTileClick",value:function(e){var t=s()(e.currentTarget).data("widget");if(!(t instanceof Pre||this._doubleClickSupport.doubleClicked())){var n=e.which;this._triggerTileClick(t,n)}}},{key:"_triggerTileClick",value:function(e,t){var n={tile:e,mouseButton:t};this.trigger("tileClick",n)}},{key:"_onTileDoubleClick",value:function(e){var t=s()(e.currentTarget).data("widget");t instanceof Pre||this.doTileAction(t)}},{key:"doTileAction",value:function(e){e&&this._triggerTileAction(e)}},{key:"_triggerTileAction",value:function(e){this.trigger("tileAction",{tile:e})}},{key:"setSelectionHandler",value:function(e){this.selectionHandler=e}},{key:"_selectTileOnMouseDown",value:function(e){this.selectionHandler.selectTileOnMouseDown(e)}},{key:"scrollTo",value:function(e,t){this.ensureTileRendered(e),this.scrolling=!0,this.scrollTopDirty=!0,this.validateLayoutTree(),this.scrolling=!1,e.reveal(t),this.scrollTopDirty=!1}},{key:"revealSelection",value:function(){this.rendered?this.selectedTiles.length>0&&this.scrollTo(this.selectedTiles[0]):this.session.layoutValidator.schedulePostValidateFunction(this.revealSelection.bind(this))}},{key:"addFilter",value:function(e){this.addFilters([e])}},{key:"addFilters",value:function(e){e=et.ensure(e);var t=this.filters.slice();e.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t.length!==this.filters.length&&this.setFilters(t)}},{key:"removeFilter",value:function(e){this.removeFilters([e])}},{key:"removeFilters",value:function(e){e=et.ensure(e);var t=this.filters.slice();et.removeAll(t,e)&&this.setFilters(t)}},{key:"setFilters",value:function(e){this.setProperty("filters",e.slice())}},{key:"filter",value:function(){var e=this.tiles,t=this._applyFilters(this.tiles,!0);this._updateFilteredTiles(),this.rendered&&(this._renderTileDelta(t),this._renderTileOrder(e))}},{key:"_applyFilters",value:function(e,t){if(0!==this.filters.length||O.nvl(t,!1)){var n=[],i=[],r=!1;return e.forEach((function(e){this._applyFiltersForTile(e)&&(r=!0,e.filterAccepted?n.push(e):(i.push(e),e===this.focusedTile&&this.setFocusedTile(null)))}),this),r&&(this.filteredTilesDirty=!0),this.deselectTiles(i),{newlyHiddenTiles:i,newlyShownTiles:n}}}},{key:"_updateFilteredTiles",value:function(){var e=this.tiles;this.filters.length>0&&(e=this._filterTiles()),this.filteredTilesDirty&&(this.setProperty("filteredTiles",e),this.invalidateLogicalGrid(!1),this.filteredTilesDirty=!1),this._updateEmpty()}},{key:"_updateEmpty",value:function(){this.setEmpty(0===this.filteredTiles.length)}},{key:"setEmpty",value:function(e){this.setProperty("empty",e)}},{key:"_renderEmpty",value:function(){this.$container.toggleClass("empty",this.empty),this.invalidateLayoutTree()}},{key:"_applyFiltersForTile",value:function(e){if(this._tileAcceptedByFilters(e)){if(!e.filterAccepted)return e.setFilterAccepted(!0),!0}else if(e.filterAccepted)return e.setFilterAccepted(!1),!0;return!1}},{key:"_tileAcceptedByFilters",value:function(e){return!this.filters.some((function(t){return!(e instanceof Pre||t.accept(e))}))}},{key:"_filterTiles",value:function(e){return e=O.nvl(e,this.tiles),0===this.filters.length?e.slice():e.filter((function(e){return e.filterAccepted}))}},{key:"findTileIndexAt",value:function(e,t,n,i){return n=O.nvl(n,0),et.findIndexFrom(this.filteredTiles,n,(function(n,i){return n.gridData.x===e&&n.gridData.y===t}),i)}},{key:"findTilesInRange",value:function(e,t){if(e.equals(this.virtualScrolling.maxViewRange()))return this.filteredTiles;for(var n=[],i=e.from;i<e.to;i++)this.eachTileInRow(i,(function(e){t&&!t(e)||n.push(e)}));return n}},{key:"findTilesInRow",value:function(e){var t=[];return this.eachTileInRow(e,(function(e){t.push(e)})),t}},{key:"eachTileInRow",value:function(e,t){for(var n=e*this.gridColumnCount,i=n;i<n+this.gridColumnCount;i++)this.filteredTiles[i]&&t(this.filteredTiles[i],i);return[]}},{key:"setVirtual",value:function(e){this.setProperty("virtual",e)}},{key:"_setVirtual",value:function(e){this._setProperty("virtual",e),this.virtualScrolling.setEnabled(this.virtual)}},{key:"_renderVirtual",value:function(){this._updateVirtualScrollable(),this.rendering||this.setViewRangeSize(this.calculateViewRangeSize(),!1),this.rendered&&(this._removeAllTiles(),this.virtual&&this._renderFiller()),this.virtual||this._renderAllTiles(),this._renderViewPort(),this.invalidateLayoutTree()}},{key:"_updateVirtualScrollable",value:function(){var e=this.virtualScrolling.$scrollable;e&&e.off("scroll",this._scrollParentScrollHandler),this.virtual&&!this.removing?this.scrollable?this.virtualScrolling.set$Scrollable(this.$container):(this.virtualScrolling.set$Scrollable(this.$container.scrollParent()),this.virtualScrolling.$scrollable.on("scroll",this._scrollParentScrollHandler)):this.virtualScrolling.set$Scrollable(null)}},{key:"calculateViewRangeSize",value:function(){return this.virtualScrolling.calculateViewRangeSize()}},{key:"setViewRangeSize",value:function(e,t){this.viewRangeSize!==e&&(this._setProperty("viewRangeSize",e),this.virtualScrolling.setViewRangeSize(e,t))}},{key:"_heightForRow",value:function(e){var t=0;if(t=this.htmlComp.layout.rowHeight,e!==this.rowCount()-1&&(t+=this.htmlComp.layout.vgap),!Gn.isNumber(t))throw new Error("Calculated height is not a number: "+t);return t}},{key:"_minRowHeight",value:function(){return this.htmlComp.layout.rowHeight+this.htmlComp.layout.vgap/2}},{key:"rowCount",value:function(e){return e=O.nvl(e,this.gridColumnCount),Math.ceil(this.filteredTiles.length/e)}},{key:"_renderViewPort",value:function(){this.isAttachedAndRendered()?this.virtual&&this.virtualScrolling._renderViewPort():this._renderViewPortAfterAttach=!0}},{key:"_renderViewRange",value:function(e){e.equals(this.viewRangeRendered)?0===e.size()&&this._renderFiller():(this.viewRangeRendered.subtract(e).filter((function(e){return e.size()>0})).forEach(function(e){this._removeTilesInRange(e)}.bind(this)),e.subtract(this.viewRangeRendered).filter((function(e){return e.size()>0})).forEach(function(e){this._renderTilesInRange(e)}.bind(this)),this._renderFiller())}},{key:"_renderTilesInRange",value:function(e){var t=0;if(0!==this.filteredTiles.length){e=this.virtualScrolling.maxViewRange().intersect(e);var n=this.viewRangeRendered.union(e);if(2===n.length)throw new Error("Can only prepend or append rows to the existing range. Existing: "+this.viewRangeRendered+". New: "+n);this.viewRangeRendered=n[0];for(var i=e.from;i<e.to;i++)this.eachTileInRow(i,r.bind(this)),t++;s.a.log.isTraceEnabled()&&(s.a.log.trace(t+" new rows rendered from "+e),s.a.log.trace(this._rowsRenderedInfo()))}function r(e){e.rendered||this._renderTile(e)}}},{key:"_renderTileDelta",value:function(e){if(!this.virtual)return[];var t=this.renderedTiles(),n=this.virtualScrolling.calculateCurrentViewRange(),i=this.findTilesInRange(n),r=et.diff(t,i),o=et.diff(i,t);return e&&e.newlyHiddenTiles.forEach((function(e){e.rendered&&this._removeTileByFilter(e)}),this),r.forEach((function(e){e.remove()})),o.forEach((function(e){this._renderTile(e)}),this),e&&(this.htmlComp.suppressInvalidate=!0,e.newlyShownTiles.forEach((function(e){e.rendered&&this._renderTileVisibleForFilter(e)}),this),this.htmlComp.suppressInvalidate=!1),this.viewRangeRendered=n,this._renderFiller(),this.htmlComp.layouting||this.invalidateLayoutTree(),o}},{key:"_removeTileByFilter",value:function(e){e.$container.removeClass("animate-invisible"),e.animateRemoval=!0,e.animateRemovalClass="animate-invisible",e.remove(),this._onAnimatedTileRemove(e),e.animateRemoval=!1,setTimeout((function(){e.animateRemovalClass="animate-remove"}))}},{key:"_renderTileVisibleForFilter",value:function(e){e.filterAccepted&&!e.$container.hasClass("animate-visible")&&(e.removalPending||(e.$container.setVisible(!1),e._renderVisible()))}},{key:"_renderTileOrder",value:function(e){var t=!1;this.tiles.forEach((function(n,i){if(e[i]!==n||t){if(this.virtual&&!n.rendered)return;t=!0,n.$container.appendTo(this.$container)}}),this),t&&!this.virtual&&this.invalidateLayoutTree()}},{key:"_rowsRenderedInfo",value:function(){return this.$container.children(".tile").length+" tiles rendered in range ("+this.viewRangeRendered+")"}},{key:"_removeTilesInRange",value:function(e){var t=0,n=this.viewRangeRendered.subtract(e);if(2===n.length)throw new Error("Can only remove rows at the beginning or end of the existing range. "+this.viewRangeRendered+". New: "+n);this.viewRangeRendered=n[0];for(var i=e.from;i<e.to;i++)this._removeTilesInRow(i),t++;s.a.log.isTraceEnabled()&&(s.a.log.trace(t+" rows removed from "+e+"."),s.a.log.trace(this._rowsRenderedInfo()))}},{key:"_removeTilesInRow",value:function(e){this.findTilesInRow(e).forEach((function(e){e.remove()}))}},{key:"rowHasRenderedTiles",value:function(e){return this.findTilesInRow(e).some((function(e){return e.rendered&&!e.removing}))}},{key:"ensureTileRendered",value:function(e){if(!e.rendered){var t=e.gridData.y;this.virtualScrolling._renderViewRangeForRowIndex(t),this.invalidateLayoutTree()}}},{key:"_renderFiller",value:function(){this.$fillBefore||(this.$fillBefore=this.$container.prependDiv("filler"));var e=this._calculateFillerHeight(new fi(0,this.viewRangeRendered.from));this.$fillBefore.cssHeight(e),this.$fillBefore.css("width","100%"),s.a.log.isTraceEnabled()&&s.a.log.trace("FillBefore height: "+e),this.$fillAfter||(this.$fillAfter=this.$container.appendDiv("filler")),this.$fillAfter.appendTo(this.$container);var t=this._calculateFillerHeight(new fi(this.viewRangeRendered.from,this.viewRangeRendered.to));this.$fillAfter.cssTop(e+t);var n=this._calculateFillerHeight(new fi(this.viewRangeRendered.to,this.rowCount()));this.$fillAfter.cssHeight(n),this.$fillAfter.css("width","100%"),s.a.log.isTraceEnabled()&&s.a.log.trace("FillAfter height: "+n)}},{key:"_calculateFillerHeight",value:function(e){for(var t=0,n=e.from;n<e.to;n++)t+=this._heightForRow(n);return t}},{key:"renderedTiles",value:function(){if(!this.rendered)return[];if(!this.virtual)return this.filteredTiles;var e=[];return this.$container.children(".tile").each((function(t,n){var i=O.widget(n);i.removalPending||e.push(i)})),e}}])&&Jee(t.prototype,n),i&&Jee(t,i),o}(de);function ote(e){return(ote="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ste(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ate(e,t,n){return(ate="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fte(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function ute(e,t){return(ute=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lte(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=fte(e);if(t){var r=fte(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cte(this,n)}}function cte(e,t){return!t||"object"!==ote(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fte(e){return(fte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ute(e,t)}(o,e);var t,n,i,r=lte(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["selectedTiles"]),e._tileFilter=null,e}return t=o,(n=[{key:"_syncSelectedTiles",value:function(e){this.addFilterForPropertyName("selectedTiles"),this.widget.selectTiles(e)}},{key:"_syncTiles",value:function(e){this.addFilterForPropertyName("selectedTiles"),this.widget.setTiles(e)}},{key:"_initProperties",value:function(e){ate(fte(o.prototype),"_initProperties",this).call(this,e),oi.isNullOrUndefined(e.filteredTiles)||(this.tileFilter=O.create("RemoteTileFilter",{tileIds:e.filteredTiles}),e.filters=[this.tileFilter]),delete e.filteredTiles}},{key:"_syncFilteredTiles",value:function(e){oi.isNullOrUndefined(e)?(this.widget.removeFilter(this.tileFilter),this.tileFilter=null):(this.tileFilter||(this.tileFilter=O.create("RemoteTileFilter"),this.widget.addFilter(this.tileFilter)),this.tileFilter.setTileIds(e)),this.widget.filter()}},{key:"_onWidgetTileClick",value:function(e){var t={tile:e.tile.id,mouseButton:e.mouseButton};this._send("tileClick",t)}},{key:"_onWidgetTileAction",value:function(e){var t={tile:e.tile.id};this._send("tileAction",t)}},{key:"_onWidgetEvent",value:function(e){"tileClick"===e.type?this._onWidgetTileClick(e):"tileAction"===e.type?this._onWidgetTileAction(e):ate(fte(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&ste(t.prototype,n),i&&ste(t,i),o}(fe);function dte(e){return(dte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pte(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yte(e,t){return(yte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vte(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=gte(e);if(t){var r=gte(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bte(this,n)}}function bte(e,t){return!t||"object"!==dte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gte(e){return(gte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yte(e,t)}(o,e);var t,n,i,r=vte(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"getGridWidgets",value:function(){return this.widget.filteredTiles}}])&&pte(t.prototype,n),i&&pte(t,i),o}(Qo);function _te(e){return(_te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wte(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kte(e,t,n){return(kte="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Cte(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ste(e,t){return(Ste=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ote(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Cte(e);if(t){var r=Cte(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Tte(this,n)}}function Tte(e,t){return!t||"object"!==_te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cte(e){return(Cte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ste(e,t)}(o,e);var t,n,i,r=Ote(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).containerPos=null,n.containerScrollTop=null,n.tiles=[],n._calculatingPrimitivePrefSize=!1,n}return t=o,i=[{key:"getTileDimensions",value:function(){if(!(o._DEFAULTSIZE instanceof Fo)){var e=$i.getSize("tile-grid-layout-config","height","height",-1),t=$i.getSize("tile-grid-layout-config","width","width",-1),n=$i.getSize("tile-grid-layout-config","margin-left","marginLeft",-1),i=$i.getSize("tile-grid-layout-config","margin-top","marginTop",-1);o._DEFAULTSIZE=new Fo(n,i,t,e)}return o._DEFAULTSIZE}}],(n=[{key:"_initDefaults",value:function(){kte(Cte(o.prototype),"_initDefaults",this).call(this);var e=o.getTileDimensions();this.hgap=e.x,this.vgap=e.y,this.columnWidth=e.width,this.rowHeight=e.height,this.maxWidth=-1}},{key:"layout",value:function(e){var t=this.widget.htmlComp;if(this.widget.scrolling)return this.widget.scrollTopDirty||this.widget._renderViewPort(),this._layout(e),void this.widget.trigger("layoutAnimationDone");var n=t.layouted||this.widget.startupAnimationEnabled&&!this.widget.startupAnimationDone||this.widget.renderAnimationEnabled;this.tiles=this.widget.renderedTiles(),wf.setVisible(e,!1),n&&this._storeBounds(this.tiles),this._updateMaxWidth(),this._resetGridColumnCount(),this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1);var i=!1,r=e.outerWidth();for(r=Math.max(r,this.minWidth),t.prefSize().width<=r&&(this._layout(e),i=!0);!i&&this.widget.gridColumnCount>1;)this.widget.gridColumnCount--,this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1),t.prefSize().width<=r&&(this._layout(e),i=!0);if(i||this._layout(e),t.layouted||this.widget._renderScrollTop(),this.widget.virtual&&(!t.layouted||this._sizeChanged(t)||this.widget.withPlaceholders)){this.widget.setViewRangeSize(this.widget.calculateViewRangeSize(),!1);var o=this.widget._renderTileDelta();this._storeBounds(o),et.pushAll(this.tiles,o),this._layout(e)}var a=[];n&&(a=this._animateTiles()),this.widget.startupAnimationDone=!0,a.length>0?s.a.promiseAll(a).done(this._onAnimationDone.bind(this)):this._onAnimationDone()}},{key:"_sizeChanged",value:function(e){return e.sizeCached&&!e.sizeCached.equals(e.size())}},{key:"_storeBounds",value:function(e){e.forEach((function(e,t){var n=No.cssBounds(e.$container);e.$container.data("oldBounds",n),e.$container.data("was-layouted",e.htmlComp.layouted)}),this)}},{key:"_validateGridData",value:function(e){return e.$comp.removeClass("newly-rendered"),kte(Cte(o.prototype),"_validateGridData",this).call(this,e)}},{key:"_layoutCellBounds",value:function(e,t){return this.widget.virtual&&(t.top+=this.widget.$fillBefore.outerHeight(!0)),kte(Cte(o.prototype),"_layoutCellBounds",this).call(this,e,t)}},{key:"_animateTiles",value:function(){var e=this.widget.htmlComp,t=e.$comp;this.containerPos=e.offset(),this.containerScrollTop=t.scrollTop(),wf.setVisible(t,!0),wf.opacity(t,0);var n=[];return this.tiles.forEach((function(e,t){if(e.rendered){var i=this._animateTile(e);i&&n.push(i),e.$container.removeData("oldBounds"),e.$container.removeData("was-layouted")}}),this),n}},{key:"_animateTile",value:function(e){var t=this.widget.htmlComp;if(e.$container.stop(),!e.$container.hasClass("invisible")&&!e.$container.hasClass("animate-visible")){var n=No.cssBounds(e.$container),i=e.$container.data("oldBounds");if(e instanceof Pre&&!e.$container.data("was-layouted")&&(i=n.clone()),!t.layouted&&this.widget.startupAnimationDone&&this.widget.renderAnimationEnabled&&(i=new Fo(.95*n.x,.95*n.y,n.width,n.height)),!i.equals(n)&&(this._inViewport(n)||this._inViewport(i))&&(e.$container.data("was-layouted")||this._inViewport(n)))return this._animateTileBounds(e,i,n)}}},{key:"_inViewport",value:function(e){e=e.translate(this.containerPos.x,this.containerPos.y).translate(0,-this.containerScrollTop);var t=new Eo(e.x,e.y),n=new Eo(e.x+e.width,e.y+e.height),i=this.widget.$container.scrollParent();return wf.isLocationInView(t,i)||wf.isLocationInView(n,i)}},{key:"_onAnimationDone",value:function(){this._updateScrollbar(),this.widget.trigger("layoutAnimationDone")}},{key:"_animateTileBounds",value:function(e,t,n){var i=e.$container[0],r=[i.style.overflow,i.style.overflowX,i.style.overflowY],o=[];return e.$container.cssLeftAnimated(t.x,n.x,{start:function(e){o.push(e)},queue:!1}).cssTopAnimated(t.y,n.y,{start:function(e){o.push(e)},queue:!1}).cssWidthAnimated(t.width,n.width,{start:function(e){o.push(e)},queue:!1}).cssHeightAnimated(t.height,n.height,{start:function(e){o.push(e)},queue:!1}),s.a.promiseAll(o).then((function(){i.style.overflow=r[0],i.style.overflowX=r[1],i.style.overflowY=r[2]}))}},{key:"_updateScrollbar",value:function(){wf.setVisible(this.widget.$container,!0),wf.opacity(this.widget.$container,1);for(var e=this.widget.htmlComp;e;){if(e.scrollable){wf.update(e.$comp,!0);break}e=e.getParent()}}},{key:"_updateMaxWidth",value:function(){var e=this.widget.htmlComp;if(e.$comp.cssPaddingRight(null),!(this.maxWidth<=0)){var t=e.$comp.cssPaddingRight(),n=e.size(),i=n.width-Math.min(n.width,this.maxWidth)-e.$comp.cssPaddingLeft()-e.$comp.cssBorderWidthX();i>t&&e.$comp.cssPaddingRight(i)}}},{key:"_resetGridColumnCount",value:function(){this.widget.gridColumnCount=this.widget.prefGridColumnCount}},{key:"preferredLayoutSize",value:function(e,t){return t=s.a.extend({},t),this.widget.virtual?this.virtualPrefSize(e,t):this.primitivePrefSize(e,t)}},{key:"virtualPrefSize",value:function(e,t){var n,i,r=Uo.get(e).insets(),o=new Co,s=this.columnWidth,a=this.rowHeight,u=this.hgap,l=this.vgap;if(t.widthHint){var c=(i=Math.floor(t.widthHint/(s+u)))*(s+u);return t.widthHint-c>s&&i++,i=Math.max(Math.min(this.widget.prefGridColumnCount,i),1),n=this.widget.rowCount(i),o.width=t.widthHint,o.height=Math.max(n*a+(n-1)*l,0),o.width+=r.horizontal(),o.height+=r.vertical(),o}return i=this.widget.gridColumnCount,n=this.widget.rowCount(),o.width=Math.max(i*s+(i-1)*u,0),o.height=Math.max(n*a+(n-1)*l,0),o.width+=r.horizontal(),o.height+=r.vertical(),o}},{key:"primitivePrefSize",value:function(e,t){if(!t.widthHint||this._calculatingPrimitivePrefSize)return kte(Cte(o.prototype),"preferredLayoutSize",this).call(this,e,t);this._calculatingPrimitivePrefSize=!0;var n=this._primitivePrefSize(t);return this._calculatingPrimitivePrefSize=!1,n}},{key:"_primitivePrefSize",value:function(e){var t,n=this.widget.htmlComp,i=!1,r=this.widget.gridColumnCount,o=e.widthHint;for(e.removeInsetsFromHints=!1,o+=n.insets().horizontal(),this._resetGridColumnCount(),this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1),(t=n.prefSize(e)).width<=o&&(i=!0);!i&&this.widget.gridColumnCount>1;)this.widget.gridColumnCount--,this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1),(t=n.prefSize(e)).width<=o&&(i=!0);return this.widget.gridColumnCount=r,t}}])&&wte(t.prototype,n),i&&wte(t,i),o}(ls);function Rte(e){return(Rte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xte(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ete(e,t,n){return(Ete="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$te(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Dte(e,t){return(Dte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fte(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$te(e);if(t){var r=$te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ate(this,n)}}function Ate(e,t){return!t||"object"!==Rte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $te(e){return($te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Pte,"_DEFAULTSIZE",void 0);var jte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dte(e,t)}(o,e);var t,n,i,r=Fte(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,i=[{key:"ensure",value:function(e){return e?e instanceof o?e:new o(e):e}}],(n=[{key:"_extend",value:function(e){Ete($te(o.prototype),"_extend",this).call(this,e),(e=e||{}).maxWidth>-2&&(this.maxWidth=e.maxWidth)}},{key:"applyToLayout",value:function(e){Ete($te(o.prototype),"applyToLayout",this).call(this,e),this.maxWidth&&(e.maxWidth=this.maxWidth)}},{key:"clone",value:function(){return new o(this)}}])&&xte(t.prototype,n),i&&xte(t,i),o}(fs);function Mte(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ite=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tileGrid=t}var t,n,i;return t=e,(n=[{key:"selectTileOnMouseDown",value:function(e){if(this.isSelectable()){var t=s()(e.currentTarget).data("widget");if(!(t instanceof Pre||t.selected&&3===e.which)){var n=!0;if(e.ctrlKey&&(n=!t.selected),e.ctrlKey&&this.isMultiSelect())n?(this.addTilesToSelection(t),this._checkAndSetFocusedTile(e,t)):(this.deselectTile(t),this._checkAndSetFocusedTile(e,null));else if(e.shiftKey&&this.isMultiSelect()){if(!this.isHorizontalGridActive())return;var i=this.getVisibleTiles(),r=this.getFocusedTile();r||(r=i[0]);var o=this.computeSelectionBetween(i.indexOf(r),i.indexOf(t),!0);o&&(this.selectTiles(o.selectedTiles),this._checkAndSetFocusedTile(e,o.focusedTile))}else n?(this.selectTile(t),this._checkAndSetFocusedTile(e,t)):(this.deselectAllTiles(),this._checkAndSetFocusedTile(e,null))}}}},{key:"getFilteredTiles",value:function(){return this.tileGrid.filteredTiles}},{key:"getFilteredTileCount",value:function(){return this.tileGrid.filteredTiles.length}},{key:"getVisibleTiles",value:function(){return this.tileGrid.filteredTiles}},{key:"getVisibleTileCount",value:function(){return this.tileGrid.filteredTiles.length}},{key:"getGridColumnCount",value:function(){return this.tileGrid.gridColumnCount}},{key:"getVisibleGridRowCount",value:function(){return this.tileGrid.logicalGrid.gridRows}},{key:"getVisibleGridX",value:function(e){return e.gridData.x}},{key:"getVisibleGridY",value:function(e){return e.gridData.y}},{key:"getSelectedTiles",value:function(e){return this.tileGrid.selectedTiles}},{key:"isSelectable",value:function(){return this.tileGrid.selectable}},{key:"isMultiSelect",value:function(){return this.tileGrid.multiSelect}},{key:"addTilesToSelection",value:function(e){this.tileGrid.addTilesToSelection(e)}},{key:"selectTile",value:function(e){this.tileGrid.selectTile(e)}},{key:"selectTiles",value:function(e){this.tileGrid.selectTiles(e)}},{key:"deselectTile",value:function(e){this.tileGrid.deselectTile(e)}},{key:"deselectTiles",value:function(e){this.tileGrid.deselectTiles(e)}},{key:"deselectAllTiles",value:function(){this.tileGrid.deselectAllTiles()}},{key:"toggleSelection",value:function(){this.tileGrid.toggleSelection()}},{key:"getFocusedTile",value:function(){return this.tileGrid.focusedTile}},{key:"_checkAndSetFocusedTile",value:function(e,t){e.isDefaultPrevented()||t&&t.rendered&&t.$container.hasClass("unfocusable")||this.setFocusedTile(t)}},{key:"setFocusedTile",value:function(e){this.tileGrid.setFocusedTile(e)}},{key:"scrollTo",value:function(e){this.tileGrid.scrollTo(e)}},{key:"scrollToTop",value:function(){this.tileGrid.scrollToTop()}},{key:"scrollToBottom",value:function(){this.tileGrid.scrollToBottom()}},{key:"findVisibleTileIndexAt",value:function(e,t,n,i){return this.tileGrid.findTileIndexAt(e,t,n,i)}},{key:"getTileGridByRow",value:function(e){return e<0||e>=this.getVisibleGridRowCount()?null:this.tileGrid}},{key:"isHorizontalGridActive",value:function(){return this.tileGrid.logicalGrid instanceof Ps}},{key:"computeSelectionX",value:function(e,t){var n,i,r=this.getVisibleTiles(),o=this._computeFocusedTile(e,t);return null!==o.selectedTiles?o:(n=o.focusedTile,i=r.indexOf(n),this.computeSelectionBetween(i,i+e,t))}},{key:"computeSelectionY",value:function(e,t){var n,i,r,o,s=this.getVisibleTiles(),a=this.getVisibleGridRowCount(),u=this._computeFocusedTile(e,t);if(null!==u.selectedTiles)return u;if(n=u.focusedTile,o=s.indexOf(n),i=this.getVisibleGridY(n),r=this.getVisibleGridX(n),!(e>0&&i===a-1||e<0&&0===i)){var l=this.findVisibleTileIndexAt(r,i+e,o,e<0);if(l<0){var c=this.getTileGridByRow(i+e);if(!c)return;l=s.indexOf(et.last(c.filteredTiles))}return this.computeSelectionBetween(o,l,t)}}},{key:"computeSelectionToFirst",value:function(e){var t,n=this.getVisibleTiles(),i=this.getFocusedTile(),r=this.getSelectedTiles();return 0===r.length?{selectedTiles:[i=et.first(n)],focusedTile:i}:(i||(i=et.last(r)),t=n.indexOf(i),this.computeSelectionBetween(t,0,e))}},{key:"computeSelectionToLast",value:function(e){var t,n=this.getVisibleTiles(),i=this.getFocusedTile(),r=this.getSelectedTiles();return 0===r.length?{selectedTiles:[i=et.last(n)],focusedTile:i}:(i||(i=et.last(r)),t=n.indexOf(i),this.computeSelectionBetween(t,n.length-1,e))}},{key:"_computeFocusedTile",value:function(e,t){var n=this.getVisibleTiles(),i=this.getSelectedTiles(),r=this.getFocusedTile();return 0===i.length?{focusedTile:r=e>0?et.first(n):et.last(n),selectedTiles:[r]}:(r||(r=e>0?et.last(i):et.first(i)),{focusedTile:r,selectedTiles:null})}},{key:"computeSelectionBetween",value:function(e,t,n){var i=this.getVisibleTiles(),r=this.getSelectedTiles(),o=i[t];if(!(e<0||e>i.length-1||t<0||t>i.length-1||e===t)){if(!n)return{selectedTiles:[o],focusedTile:o};var s=[];return o.selected?t>e?(s=r.slice(),et.removeAll(s,i.slice(e,t))):(s=r.slice(),et.removeAll(s,i.slice(t+1,e+1))):t>e?(s=et.union(r,i.slice(e,t+1)),o=this._findLastSelectedTileAfter(i,t)):(s=et.union(i.slice(t,e+1),r),o=this._findLastSelectedTileBefore(i,t)),{selectedTiles:s,focusedTile:o}}}},{key:"executeSelection",value:function(e){if(e){if(e.selectedTiles.length>0){this.selectTiles(e.selectedTiles),this.scrollTo(e.focusedTile);var t=this.getVisibleGridY(e.focusedTile),n=this.getVisibleGridRowCount();0===t?this.scrollToTop():t===n-1&&this.scrollToBottom()}this.setFocusedTile(e.focusedTile)}}},{key:"_findLastSelectedTileBefore",value:function(e,t){if(0===t)return e[t];var n=et.findFromReverse(e,t,(function(t,n){var i=e[n-1];return!!i&&!i.selected}));return n||(n=e[0]),n}},{key:"_findLastSelectedTileAfter",value:function(e,t){if(t===e.length-1)return e[t];var n=et.findFrom(e,t,(function(t,n){var i=e[n+1];return!!i&&!i.selected}));return n||(n=e[e.length-1]),n}}])&&Mte(t.prototype,n),i&&Mte(t,i),e}();function Lte(e){return(Lte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bte(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nte(e,t){return(Nte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hte(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Wte(e);if(t){var r=Wte(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Vte(this,n)}}function Vte(e,t){return!t||"object"!==Lte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wte(e){return(Wte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nte(e,t)}(o,e);var t,n,i,r=Hte(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tileOverview=e,t}return t=o,(n=[{key:"layout",value:function(e){var t=this.tileOverview.htmlComp,n=this.tileOverview.pageTileGrid,i=this.tileOverview.$content,r=t.availableSize().subtract(t.insets()),o=r.subtract(No.insets(i,{includeMargin:!0})),s=this._htmlRootGroupBox();if(s){var a=r.subtract(s.margins()),u=s.prefSize();s.setSize(new Co(a.width,u.height))}var l=n.htmlComp,c=n.htmlComp.prefSize({widthHint:o.width});l.setSize(c)}},{key:"_htmlRootGroupBox",value:function(){var e=this.tileOverview.$container.children(".root-group-box");return e.length?Uo.get(e):null}}])&&Bte(t.prototype,n),i&&Bte(t,i),o}(zo);function Gte(e){return(Gte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ute(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Kte(e,t,n){return(Kte="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Jte(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function qte(e,t){return(qte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yte(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Jte(e);if(t){var r=Jte(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Xte(this,n)}}function Xte(e,t){return!t||"object"!==Gte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jte(e){return(Jte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qte(e,t)}(o,e);var t,n,i,r=Yte(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).content=null,e}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("html-tile"),this.htmlComp=Uo.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){Kte(Jte(o.prototype),"_renderProperties",this).call(this),this._renderContent()}},{key:"setContent",value:function(e){this.setProperty("content",e)}},{key:"_renderContent",value:function(){this.content?(this.$container.html(this.content),this.$container.find("img").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this)),this.invalidateLayoutTree()):this.$container.empty()}},{key:"_onImageLoad",value:function(e){this.invalidateLayoutTree()}},{key:"_onImageError",value:function(e){this.invalidateLayoutTree()}}])&&Ute(t.prototype,n),i&&Ute(t,i),o}(Wee);function Qte(e){return(Qte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ene(e,t){return(ene=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ine(e);if(t){var r=ine(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return nne(this,n)}}function nne(e,t){return!t||"object"!==Qte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ine(e){return(ine=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ene(e,t)}(n,e);var t=tne(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Yee);function one(e){return(one="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ane(e,t,n){return(ane="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fne(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function une(e,t){return(une=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=fne(e);if(t){var r=fne(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cne(this,n)}}function cne(e,t){return!t||"object"!==one(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fne(e){return(fne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&une(e,t)}(o,e);var t,n,i,r=lne(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).bean=null,e}return t=o,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("bean-tile"),this.htmlComp=Uo.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){ane(fne(o.prototype),"_renderProperties",this).call(this),this._renderBean()}},{key:"_renderBean",value:function(){}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}}])&&sne(t.prototype,n),i&&sne(t,i),o}(Wee);function dne(e){return(dne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yne(e,t,n){return(yne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mne(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function vne(e,t){return(vne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mne(e);if(t){var r=mne(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gne(this,n)}}function gne(e,t){return!t||"object"!==dne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mne(e){return(mne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vne(e,t)}(o,e);var t,n,i,r=bne(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):yne(mne(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&pne(t.prototype,n),i&&pne(t,i),o}(Yee);function wne(e){return(wne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Sne(e,t,n){return(Sne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rne(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function One(e,t){return(One=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Rne(e);if(t){var r=Rne(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Cne(this,n)}}function Cne(e,t){return!t||"object"!==wne(t)&&"function"!=typeof t?Pne(e):t}function Pne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rne(e){return(Rne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&One(e,t)}(o,e);var t,n,i,r=Tne(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).exclusiveExpand=!1,e.gridColumnCount=null,e.multiSelect=null,e.selectable=null,e.takeTileFiltersFromGroup=!0,e.tileComparator=null,e.tileFilters=[],e.tileGridLayoutConfig=null,e.tileGridSelectionHandler=new zne(Pne(e)),e.withPlaceholders=null,e.virtual=null,e._selectionUpdateLocked=!1,e._tileGridPropertyChangeHandler=e._onTileGridPropertyChange.bind(Pne(e)),e._groupBodyHeightChangeHandler=e._onGroupBodyHeightChange.bind(Pne(e)),e}return t=o,(n=[{key:"_render",value:function(){Sne(Rne(o.prototype),"_render",this).call(this),this.$container.addClass("tile-accordion")}},{key:"_initGroup",value:function(e){Sne(Rne(o.prototype),"_initGroup",this).call(this,e),e.body.setSelectionHandler(this.tileGridSelectionHandler),null!==this.gridColumnCount&&e.body.setGridColumnCount(this.gridColumnCount),this.setProperty("gridColumnCount",e.body.gridColumnCount),null!==this.multiSelect&&e.body.setMultiSelect(this.multiSelect),this.setProperty("multiSelect",e.body.multiSelect),null!==this.selectable&&e.body.setSelectable(this.selectable),this.setProperty("selectable",e.body.selectable),null!==this.tileGridLayoutConfig&&e.body.setLayoutConfig(this.tileGridLayoutConfig),this.setProperty("tileGridLayoutConfig",e.body.layoutConfig),null!==this.tileComparator&&(e.body.setComparator(this.tileComparator),e.body.sort()),this.setProperty("tileComparator",e.body.comparator),this.tileFilters.length>0&&(e.body.addFilters(this.tileFilters),e.body.filter()),this.takeTileFiltersFromGroup&&this.setProperty("tileFilters",e.body.filters),null!==this.withPlaceholders&&e.body.setWithPlaceholders(this.withPlaceholders),this.setProperty("withPlaceholders",e.body.withPlaceholders),null!==this.virtual&&e.body.setVirtual(this.virtual),this.setProperty("virtual",e.body.virtual),e.body.selectedTiles.length>0&&this._handleSelectionChanged(e.body),e.body.on("propertyChange",this._tileGridPropertyChangeHandler),this._handleCollapsed(e),e.body.__tileAccordionEventDelegator=at.create(e.body,this,{delegateEvents:["tileClick","tileAction"]})}},{key:"_deleteGroup",value:function(e){e.body&&(e.body.off("propertyChange",this._tileGridPropertyChangeHandler),e.body.__tileAccordionEventDelegator.destroy(),e.body.__tileAccordionEventDelegator=null),Sne(Rne(o.prototype),"_deleteGroup",this).call(this,e)}},{key:"setGroups",value:function(e){var t=this.getTileCount(),n=this.getFilteredTileCount(),i=this.getSelectedTileCount();Sne(Rne(o.prototype),"setGroups",this).call(this,e);var r=this.getTileCount(),s=this.getFilteredTileCount(),a=this.getSelectedTileCount();r!==t&&this.triggerPropertyChange("tiles",null,null),s!==n&&this.triggerPropertyChange("filteredTiles",null,null),a!==i&&this.triggerPropertyChange("selectedTiles",null,null)}},{key:"setGridColumnCount",value:function(e){this.groups.forEach((function(t){t.body.setGridColumnCount(e)})),this.setProperty("gridColumnCount",e)}},{key:"setTileGridLayoutConfig",value:function(e){this.groups.forEach((function(t){t.body.setLayoutConfig(e),e=t.body.layoutConfig})),this.setProperty("tileGridLayoutConfig",e)}},{key:"setWithPlaceholders",value:function(e){this.groups.forEach((function(t){t.body.setWithPlaceholders(e)})),this.setProperty("withPlaceholders",e)}},{key:"setVirtual",value:function(e){this.groups.forEach((function(t){t.body.setVirtual(e)})),this.setProperty("virtual",e)}},{key:"setSelectable",value:function(e){this.groups.forEach((function(t){t.body.setSelectable(e)})),this.setProperty("selectable",e)}},{key:"setMultiSelect",value:function(e){this.groups.forEach((function(t){t.body.setMultiSelect(e)})),this.setProperty("multiSelect",e)}},{key:"getGroupById",value:function(e){return et.find(this.groups,(function(t){return t.id===e}))}},{key:"getGroupByTile",value:function(e){return e.findParent((function(e){return e instanceof uv}))}},{key:"_groupTiles",value:function(e){var t={};return this.groups.forEach((function(e){t[e.id]=[]})),e.forEach((function(e){var n=this.getGroupByTile(e);if(!n)throw new Error("No group found for tile "+e.id);t[n.id]||(t[n.id]=[]),t[n.id].push(e)}),this),t}},{key:"deleteTile",value:function(e){this.deleteTiles([e])}},{key:"deleteTiles",value:function(e,t){if(0!==(e=et.ensure(e)).length){var n=this.getTiles();et.removeAll(n,e),this.setTiles(n,t)}}},{key:"deleteAllTiles",value:function(){this.setTiles([])}},{key:"setTiles",value:function(e){if(e=et.ensure(e),!oi.equals(this.getTiles(),e)){e=this._createChildren(e);var t=this._groupTiles(e);for(var n in t)this.getGroupById(n).body.setTiles(t[n])}}},{key:"getTiles",value:function(){var e=[];return this.groups.forEach((function(t){et.pushAll(e,t.body.tiles)})),e}},{key:"getTileCount",value:function(){var e=0;return this.groups.forEach((function(t){e+=t.body.tiles.length})),e}},{key:"addTileFilter",value:function(e){var t=this.tileFilters.slice();t.indexOf(e)>=0||(t.push(e),this.setTileFilters(t))}},{key:"removeTileFilter",value:function(e){var t=this.tileFilters.slice();et.remove(t,e)&&this.setTileFilters(t)}},{key:"setTileFilters",value:function(e){e=et.ensure(e),this.groups.forEach((function(t){t.body.setFilters(e)})),this.setProperty("tileFilters",e.slice())}},{key:"filterTiles",value:function(){this.groups.forEach((function(e){e.body.filter()}))}},{key:"getFilteredTiles",value:function(){var e=[];return this.groups.forEach((function(t){et.pushAll(e,t.body.filteredTiles)})),e}},{key:"getFilteredTileCount",value:function(){var e=0;return this.groups.forEach((function(t){e+=t.body.filteredTiles.length})),e}},{key:"getVisibleTiles",value:function(){var e=[];return this.expandedGroups().forEach((function(t){et.pushAll(e,t.body.filteredTiles)})),e}},{key:"getVisibleTileCount",value:function(){var e=0;return this.expandedGroups().forEach((function(t){e+=t.body.filteredTiles.length})),e}},{key:"findVisibleTileIndexAt",value:function(e,t,n,i){return n=O.nvl(n,0),et.findIndexFrom(this.getVisibleTiles(),n,function(n,i){return this.getVisibleGridX(n)===e&&this.getVisibleGridY(n)===t}.bind(this),i)}},{key:"selectTiles",value:function(e){e=et.ensure(e),e=this._createChildren(e);var t=this._groupTiles(e);for(var n in t)this.getGroupById(n).body.selectTiles(t[n])}},{key:"selectTile",value:function(e){this.selectTiles([e])}},{key:"selectAllTiles",value:function(){this.selectTiles(this.getVisibleTiles())}},{key:"deselectTiles",value:function(e){e=et.ensure(e);var t=this.getSelectedTiles().slice();et.removeAll(t,e)&&this.selectTiles(t)}},{key:"deselectTile",value:function(e){this.deselectTiles([e])}},{key:"deselectAllTiles",value:function(){this.selectTiles([])}},{key:"addTilesToSelection",value:function(e){e=et.ensure(e),this.selectTiles(this.getSelectedTiles().concat(e))}},{key:"addTileToSelection",value:function(e){this.addTilesToSelection([e])}},{key:"getSelectedTiles",value:function(){var e=[];return this.groups.forEach((function(t){et.pushAll(e,t.body.selectedTiles)})),e}},{key:"getSelectedTile",value:function(){return this.getSelectedTiles()[0]}},{key:"getSelectedTileCount",value:function(){var e=0;return this.groups.forEach((function(t){e+=t.body.selectedTiles.length})),e}},{key:"toggleSelection",value:function(){this.getSelectedTileCount()===this.getVisibleTileCount()?this.deselectAllTiles():this.selectAllTiles()}},{key:"setTileComparator",value:function(e){this.groups.forEach((function(t){t.body.setComparator(e)})),this.setProperty("tileComparator",e)}},{key:"sortTiles",value:function(){this.groups.forEach((function(e){e.body.sort()}))}},{key:"setFocusedTile",value:function(e){var t=null;null!==e&&(t=this.getGroupByTile(e)),this.groups.forEach((function(n){n===t?n.body.setFocusedTile(e):n.body.setFocusedTile(null)}))}},{key:"getFocusedTile",value:function(){var e=null;return this.groups.some((function(t){return!!t.body.focusedTile&&(e=t.body.focusedTile,!0)})),e}},{key:"getVisibleGridRowCount",value:function(){return this.expandedGroups().reduce((function(e,t){return e+t.body.logicalGrid.gridRows}),0)}},{key:"getVisibleGridX",value:function(e){return e.gridData.x}},{key:"getVisibleGridY",value:function(e){var t=this.getGroupByTile(e),n=this.getVisibleRowByGroup(t);return e.gridData.y+n}},{key:"getGroupByVisibleRow",value:function(e){if(e<0||e>=this.getVisibleGridRowCount())return null;var t=0;return et.find(this.expandedGroups(),(function(n){var i=n.body.logicalGrid.gridRows;if(t<=e&&e<t+i)return!0;t+=i}))}},{key:"getVisibleRowByGroup",value:function(e){var t=0;return this.expandedGroups().some((function(n){var i=n.body.logicalGrid.gridRows;return n===e||(t+=i,!1)}))?t:-1}},{key:"expandedGroups",value:function(){return this.groups.filter((function(e){return!e.collapsed}))}},{key:"_handleSelectionChanged",value:function(e){if(!this._selectionUpdateLocked){var t=e.parent;e.selectedTiles.length>0&&t.collapsed?e.deselectAllTiles():!this.multiSelect&&e.selectedTiles.length>0&&(this._selectionUpdateLocked=!0,this.groups.forEach((function(t){t.body!==e&&t.body.deselectAllTiles()})),this._selectionUpdateLocked=!1)}}},{key:"_onTileGridPropertyChange",value:function(e){"selectedTiles"===e.propertyName?(this._handleSelectionChanged(e.source),this.triggerPropertyChange("selectedTiles",null,null)):"filteredTiles"===e.propertyName?this.triggerPropertyChange("filteredTiles",null,null):"tiles"===e.propertyName&&this.triggerPropertyChange("tiles",null,null)}},{key:"_onGroupCollapsedChange",value:function(e){Sne(Rne(o.prototype),"_onGroupCollapsedChange",this).call(this,e),this._handleCollapsed(e.source)}},{key:"_handleCollapsed",value:function(e){e.collapsed&&e.body.deselectAllTiles(),e.rendered&&(e.on("bodyHeightChange",this._groupBodyHeightChangeHandler),e.one("bodyHeightChangeDone",this._onGroupBodyHeightChangeDone.bind(this)))}},{key:"_onGroupBodyHeightChange",value:function(e){this.groups.forEach((function(t){e.source===t||t.bodyAnimating||t.body.virtual&&(t.body.scrolling=!0,t.body.revalidateLayout(),t.body.scrolling=!1)}))}},{key:"_onGroupBodyHeightChangeDone",value:function(e){e.source.off("bodyHeightChange",this._groupBodyHeightChangeHandler)}},{key:"_tileAtScrollTop",value:function(e){return et.find(this.getTiles().filter((function(e){return e.rendered})),(function(t){return t.$container.position().top>=e}),this)}}])&&kne(t.prototype,n),i&&kne(t,i),o}(Hl);function Ene(e){return(Ene="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fne(e,t,n){return(Fne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mne(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ane(e,t){return(Ane=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Mne(e);if(t){var r=Mne(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jne(this,n)}}function jne(e,t){return!t||"object"!==Ene(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mne(e){return(Mne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ine=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ane(e,t)}(o,e);var t,n,i,r=$ne(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_initProperties",value:function(e){Fne(Mne(o.prototype),"_initProperties",this).call(this,e),e.takeTileFiltersFromGroup=!1}}])&&Dne(t.prototype,n),i&&Dne(t,i),o}(Kl);function Lne(e){return(Lne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nne(e,t){return(Nne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Wne(e);if(t){var r=Wne(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Vne(this,n)}}function Vne(e,t){return!t||"object"!==Lne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wne(e){return(Wne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nne(e,t)}(o,e);var t,n,i,r=Hne(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).tileAccordion=t.tileGrid,t}return t=o,(n=[{key:"getFilteredTiles",value:function(){return this.tileAccordion.getFilteredTiles()}},{key:"getFilteredTileCount",value:function(){return this.tileAccordion.getFilteredTileCount()}},{key:"getVisibleTiles",value:function(){return this.tileAccordion.getVisibleTiles()}},{key:"getVisibleTileCount",value:function(){return this.tileAccordion.getVisibleTileCount()}},{key:"getSelectedTiles",value:function(e){return this.tileAccordion.getSelectedTiles()}},{key:"getFocusedTile",value:function(){return this.tileAccordion.getFocusedTile()}},{key:"getVisibleGridRowCount",value:function(){return this.tileAccordion.getVisibleGridRowCount()}},{key:"getVisibleGridX",value:function(e){return this.tileAccordion.getVisibleGridX(e)}},{key:"getVisibleGridY",value:function(e){return this.tileAccordion.getVisibleGridY(e)}},{key:"scrollTo",value:function(e){this.tileAccordion.getGroupByTile(e).body.scrollTo(e)}},{key:"getTileGridByRow",value:function(e){var t=this.tileAccordion.getGroupByVisibleRow(e);return t?t.body:null}},{key:"findVisibleTileIndexAt",value:function(e,t,n,i){return this.tileAccordion.findVisibleTileIndexAt(e,t,n,i)}},{key:"isHorizontalGridActive",value:function(){return 0!==this.tileAccordion.groups.length&&this.tileAccordion.groups[0].body.logicalGrid instanceof Ps}}])&&Bne(t.prototype,n),i&&Bne(t,i),o}(Ite);function Gne(e){return(Gne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Une(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Kne(e,t,n){return(Kne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zne(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function qne(e,t){return(qne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Zne(e);if(t){var r=Zne(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Xne(this,n)}}function Xne(e,t){return!t||"object"!==Gne(t)&&"function"!=typeof t?Jne(e):t}function Jne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zne(e){return(Zne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qne(e,t)}(o,e);var t,n,i,r=Yne(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.shift=!!e.multiSelect&&void 0,t.renderingHints.$drawingArea=function(e,t){var n=this._computeNewSelection();if(n&&n.focusedTile)return n.focusedTile.$container}.bind(Jne(t)),t}return t=o,(n=[{key:"getSelectionHandler",value:function(){return this.field.selectionHandler}},{key:"_accept",value:function(e){return!!Kne(Zne(o.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isSelectable()&&0!==this.getSelectionHandler().getFilteredTileCount()}},{key:"handle",value:function(e){this.getSelectionHandler().executeSelection(this._computeNewSelection(e.shiftKey))}},{key:"_computeNewSelection",value:function(e){}}])&&Une(t.prototype,n),i&&Une(t,i),o}($u);function eie(e){return(eie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nie(e,t,n){return(nie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aie(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function iie(e,t){return(iie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=aie(e);if(t){var r=aie(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return oie(this,n)}}function oie(e,t){return!t||"object"!==eie(t)&&"function"!=typeof t?sie(e):t}function sie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aie(e){return(aie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iie(e,t)}(o,e);var t,n,i,r=rie(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).ctrl=!0,t.shift=!1,t.which=[pu.A],t.renderingHints.$drawingArea=function(e,t){var n=this.getSelectionHandler().getVisibleTiles()[0];if(n)return n.$container}.bind(sie(t)),t}return t=o,(n=[{key:"_accept",value:function(e){return!!nie(aie(o.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isMultiSelect()}},{key:"handle",value:function(e){this.getSelectionHandler().toggleSelection()}}])&&tie(t.prototype,n),i&&tie(t,i),o}(Qne);function lie(e){return(lie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fie(e,t,n){return(fie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yie(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function hie(e,t){return(hie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function die(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=yie(e);if(t){var r=yie(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pie(this,n)}}function pie(e,t){return!t||"object"!==lie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yie(e){return(yie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hie(e,t)}(o,e);var t,n,i,r=die(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).stopPropagation=!0,t.repeatable=!0,t.which=[pu.LEFT],t.renderingHints.text="←",t}return t=o,(n=[{key:"_accept",value:function(e){return!!fie(yie(o.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionX(-1,e)}}])&&cie(t.prototype,n),i&&cie(t,i),o}(Qne);function bie(e){return(bie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mie(e,t,n){return(mie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sie(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _ie(e,t){return(_ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Sie(e);if(t){var r=Sie(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return kie(this,n)}}function kie(e,t){return!t||"object"!==bie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sie(e){return(Sie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_ie(e,t)}(o,e);var t,n,i,r=wie(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).stopPropagation=!0,t.repeatable=!0,t.which=[pu.RIGHT],t.renderingHints.text="→",t}return t=o,(n=[{key:"_accept",value:function(e){return!!mie(Sie(o.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionX(1,e)}}])&&gie(t.prototype,n),i&&gie(t,i),o}(Qne);function Tie(e){return(Tie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pie(e,t,n){return(Pie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Die(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Rie(e,t){return(Rie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Die(e);if(t){var r=Die(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Eie(this,n)}}function Eie(e,t){return!t||"object"!==Tie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Die(e){return(Die=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rie(e,t)}(o,e);var t,n,i,r=xie(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).stopPropagation=!0,t.repeatable=!0,t.which=[pu.DOWN],t.renderingHints.text="↓",t}return t=o,(n=[{key:"_accept",value:function(e){return!!Pie(Die(o.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionY(1,e)}}])&&Cie(t.prototype,n),i&&Cie(t,i),o}(Qne);function Aie(e){return(Aie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $ie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jie(e,t,n){return(jie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bie(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Mie(e,t){return(Mie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Iie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Bie(e);if(t){var r=Bie(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Lie(this,n)}}function Lie(e,t){return!t||"object"!==Aie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bie(e){return(Bie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mie(e,t)}(o,e);var t,n,i,r=Iie(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).stopPropagation=!0,t.repeatable=!0,t.which=[pu.UP],t.renderingHints.text="↑",t}return t=o,(n=[{key:"_accept",value:function(e){return!!jie(Bie(o.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionY(-1,e)}}])&&$ie(t.prototype,n),i&&$ie(t,i),o}(Qne);function Hie(e){return(Hie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wie(e,t,n){return(Wie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kie(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function zie(e,t){return(zie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Kie(e);if(t){var r=Kie(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Uie(this,n)}}function Uie(e,t){return!t||"object"!==Hie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kie(e){return(Kie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zie(e,t)}(o,e);var t,n,i,r=Gie(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).stopPropagation=!0,t.which=[pu.HOME],t}return t=o,(n=[{key:"_accept",value:function(e){return!!Wie(Kie(o.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionToFirst(e)}}])&&Vie(t.prototype,n),i&&Vie(t,i),o}(Qne);function Yie(e){return(Yie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jie(e,t,n){return(Jie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tre(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Zie(e,t){return(Zie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=tre(e);if(t){var r=tre(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ere(this,n)}}function ere(e,t){return!t||"object"!==Yie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tre(e){return(tre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zie(e,t)}(o,e);var t,n,i,r=Qie(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).stopPropagation=!0,t.which=[pu.END],t}return t=o,(n=[{key:"_accept",value:function(e){return!!Jie(tre(o.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionToLast(e)}}])&&Xie(t.prototype,n),i&&Xie(t,i),o}(Qne);function ire(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var rre=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.tileMap={},t.tileIds&&this.setTileIds(t.tileIds)}var t,n,i;return t=e,(n=[{key:"setTileIds",value:function(e){this.tileMap={},e.forEach((function(e){this.tileMap[e]=e}),this)}},{key:"accept",value:function(e){return!!this.tileMap[e.id]}}])&&ire(t.prototype,n),i&&ire(t,i),e}();function ore(e){return(ore="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sre(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function are(e,t,n){return(are="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hre(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function ure(e,t){return(ure=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=hre(e);if(t){var r=hre(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cre(this,n)}}function cre(e,t){return!t||"object"!==ore(t)&&"function"!=typeof t?fre(e):t}function fre(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hre(e){return(hre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ure(e,t)}(o,e);var t,n,i,r=lre(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).tileWidget=null,e._addWidgetProperties(["tileWidget"]),e._widgetPropertyChangeHandler=e._onWidgetPropertyChange.bind(fre(e)),e}return t=o,(n=[{key:"_init",value:function(e){are(hre(o.prototype),"_init",this).call(this,e),this._setTileWidget(this.tileWidget)}},{key:"_destroy",value:function(){this.tileWidget&&this.tileWidget.off("propertyChange",this._widgetPropertyChangeHandler),are(hre(o.prototype),"_destroy",this).call(this)}},{key:"_renderProperties",value:function(){are(hre(o.prototype),"_renderProperties",this).call(this),this._renderTileWidget()}},{key:"_renderTileWidget",value:function(){this.tileWidget&&this.tileWidget.render()}},{key:"_removeTileWidget",value:function(){this.tileWidget&&this.tileWidget.remove()}},{key:"_onWidgetPropertyChange",value:function(e){"visible"===e.propertyName?this.setVisible(e.newValue):"enabled"===e.propertyName?this.setEnabled(e.newValue):"disabledStyle"===e.propertyName&&this.setDisabledStyle(e.newValue)}},{key:"_setTileWidget",value:function(e){this.tileWidget&&this.tileWidget.off("propertyChange",this._widgetPropertyChangeHandler),this._setProperty("tileWidget",e),e&&(this.tileWidget.visible||this.setVisible(!1),this.tileWidget.enabled||this.setEnabled(!1),this.tileWidget.disabledStyle!==de.DisabledStyle.DEFAULT&&this.setDisabledStyle(this.tileWidget.disabledStyle),this.tileWidget.on("propertyChange",this._widgetPropertyChangeHandler)),this.invalidateLayoutTree()}}])&&sre(t.prototype,n),i&&sre(t,i),o}(Wee);function pre(e){return(pre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yre(e,t){return(yre=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=gre(e);if(t){var r=gre(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bre(this,n)}}function bre(e,t){return!t||"object"!==pre(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gre(e){return(gre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yre(e,t)}(n,e);var t=vre(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Yee);function _re(e){return(_re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wre(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kre(e,t,n){return(kre="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Cre(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Sre(e,t){return(Sre=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ore(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Cre(e);if(t){var r=Cre(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Tre(this,n)}}function Tre(e,t){return!t||"object"!==_re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cre(e){return(Cre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sre(e,t)}(o,e);var t,n,i,r=Ore(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).cssClass="placeholder-tile",e.displayStyle=Wee.DisplayStyle.PLAIN,e}return t=o,(n=[{key:"_setSelectable",value:function(e){kre(Cre(o.prototype),"_setSelectable",this).call(this,!1)}}])&&wre(t.prototype,n),i&&wre(t,i),o}(Wee);function Rre(e){return(Rre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xre(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ere(e,t,n){return(Ere="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$re(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Dre(e,t){return(Dre=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$re(e);if(t){var r=$re(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Are(this,n)}}function Are(e,t){return!t||"object"!==Rre(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $re(e){return($re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dre(e,t)}(o,e);var t,n,i,r=Fre(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).displayStyle=o.DisplayStyle.DASHBOARD,e}return t=o,(n=[{key:"_renderProperties",value:function(){Ere($re(o.prototype),"_renderProperties",this).call(this),this._renderFieldLabelVisible()}},{key:"_renderDisplayStyle",value:function(){Ere($re(o.prototype),"_renderDisplayStyle",this).call(this),this.$container.toggleClass("dashboard",this.displayStyle===o.DisplayStyle.DASHBOARD)}},{key:"_renderFieldLabelVisible",value:function(){this.displayStyle===o.DisplayStyle.DASHBOARD&&this.tileWidget instanceof bG&&this.tileWidget.$container.toggleClass("no-padding",!this.tileWidget.labelVisible&&!this.tileWidget.errorStatus)}},{key:"_onFieldPropertyChange",value:function(e){"labelVisible"!==e.propertyName&&"errorStatus"!==e.propertyName||this.rendered&&this._renderFieldLabelVisible()}}])&&xre(t.prototype,n),i&&xre(t,i),o}(dre);function Mre(e){return(Mre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ire(e,t){return(Ire=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Nre(e);if(t){var r=Nre(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Bre(this,n)}}function Bre(e,t){return!t||"object"!==Mre(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nre(e){return(Nre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(jre,"DisplayStyle",{DEFAULT:Wee.DisplayStyle.DEFAULT,PLAIN:Wee.DisplayStyle.PLAIN,DASHBOARD:"dashboard"});var Hre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ire(e,t)}(n,e);var t=Lre(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Yee);function Vre(e){return(Vre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wre(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zre(e,t,n){return(zre="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qre(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Gre(e,t){return(Gre=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ure(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=qre(e);if(t){var r=qre(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Kre(this,n)}}function Kre(e,t){return!t||"object"!==Vre(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qre(e){return(qre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gre(e,t)}(o,e);var t,n,i,r=Ure(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).processButton=!1,e}return t=o,(n=[{key:"_render",value:function(){if(this.parent.displayStyle===jre.DisplayStyle.DASHBOARD){var e=this.$parent.makeDiv();this.$buttonLabel=e.appendSpan("label"),this.addContainer(this.$parent,"tile-button"),this.addField(e),this.htmlComp.setLayout(new ya),this.$container.on("click",this._onClick.bind(this)).unfocusable()}else zre(qre(o.prototype),"_render",this).call(this)}},{key:"_remove",value:function(){this.$iconContainer=null,zre(qre(o.prototype),"_remove",this).call(this)}},{key:"_renderIconId",value:function(){this.parent.displayStyle===jre.DisplayStyle.DASHBOARD?(this.$field.removeClass("with-icon without-icon"),this.iconId?(this.$iconContainer||(this.$iconContainer=this.$field.prependDiv("icon-container")),this.$iconContainer.icon(this.iconId),this.$field.addClass("with-icon")):(this.$iconContainer&&(this.$iconContainer.remove(),this.$iconContainer=null),this.$field.addClass("without-icon")),this.invalidateLayoutTree()):zre(qre(o.prototype),"_renderIconId",this).call(this)}},{key:"_renderTooltipText",value:function(){En.hasText(this.tooltipText)?dh.install(this.$container,{parent:this,text:this.tooltipText}):dh.uninstall(this.$container)}}])&&Wre(t.prototype,n),i&&Wre(t,i),o}(WG);function Xre(e){return(Xre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jre(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zre(e,t,n){return(Zre="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ioe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Qre(e,t){return(Qre=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eoe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ioe(e);if(t){var r=ioe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return toe(this,n)}}function toe(e,t){return!t||"object"!==Xre(t)&&"function"!=typeof t?noe(e):t}function noe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ioe(e){return(ioe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var roe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qre(e,t)}(o,e);var t,n,i,r=eoe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._tableBlurHandler=e._onTableBlur.bind(noe(e)),e._tableFocusHandler=e._onTableFocus.bind(noe(e)),e._menuBarPropertyChangeHandler=e._onMenuBarPropertyChange.bind(noe(e)),e}return t=o,(n=[{key:"_renderTable",value:function(){Zre(ioe(o.prototype),"_renderTable",this).call(this),this.parent.displayStyle===jre.DisplayStyle.DASHBOARD&&this.table&&(this.table.setHeaderMenusEnabled(!1),this.table.setSortEnabled(!1),this.table.$container.on("blur",this._tableBlurHandler).on("focus",this._tableFocusHandler),this.table.menuBar.on("propertyChange",this._menuBarPropertyChangeHandler),this._toggleHasMenuBar(),document.activeElement!==this.table.$container[0]&&this._hideMenuBar(!0))}},{key:"_removeTable",value:function(){this.parent.displayStyle===jre.DisplayStyle.DASHBOARD&&(this.table&&(this.table.$container.off("blur",this._tableBlurHandler).off("focus",this._tableFocusHandler),this.table.menuBar.off("propertyChange",this._menuBarPropertyChangeHandler)),Zre(ioe(o.prototype),"_removeTable",this).call(this))}},{key:"_onTableBlur",value:function(e){var t=s()(".popup").data("widget");this.has(t)||this._hideMenuBar(!0)}},{key:"_onTableFocus",value:function(e){this._hideMenuBar(!1)}},{key:"_hideMenuBar",value:function(e){this.table.menuBar.hiddenByUi=e,this.table.menuBar.updateVisibility()}},{key:"_onMenuBarPropertyChange",value:function(e){"visible"===e.propertyName&&this._toggleHasMenuBar()}},{key:"_toggleHasMenuBar",value:function(){(this.rendered||this.rendering)&&this.$container.toggleClass("has-menubar",this.table.menuBar.visible)}}])&&Jre(t.prototype,n),i&&Jre(t,i),o}(N6);function ooe(e){return(ooe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function soe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aoe(e,t,n){return(aoe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hoe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function uoe(e,t){return(uoe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function loe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=hoe(e);if(t){var r=hoe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return coe(this,n)}}function coe(e,t){return!t||"object"!==ooe(t)&&"function"!=typeof t?foe(e):t}function foe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hoe(e){return(hoe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function doe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var poe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uoe(e,t)}(o,e);var t,n,i,r=loe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).desktopStyle=o.DisplayStyle.DEFAULT,e.title=null,e.selectViewTabsKeyStrokesEnabled=!0,e.selectViewTabsKeyStrokeModifier="control",e.cacheSplitterPosition=!0,e.browserHistoryEntry=null,e.logoId=null,e.navigationVisible=!0,e.navigationHandleVisible=!0,e.logoActionEnabled=!1,e.benchVisible=!0,e.headerVisible=!0,e.geolocationServiceAvailable=Mt.get().supportsGeolocation(),e.benchLayoutData=null,e.menus=[],e.addOns=[],e.dialogs=[],e.views=[],e.keyStrokes=[],e.viewButtons=[],e.messageBoxes=[],e.fileChoosers=[],e.outline=null,e.activeForm=null,e.selectedViewTabs=[],e.notifications=[],e.navigation=null,e.header=null,e.bench=null,e.splitter=null,e.splitterVisible=!1,e.formController=null,e.messageBoxController=null,e.fileChooserController=null,e.initialFormRendering=!1,e.offline=!1,e.inBackground=!1,e.openUriHandler=null,e.theme=null,e.dense=!1,e._glassPaneTargetFilters=[],e.url=null,e._addWidgetProperties(["viewButtons","menus","views","selectedViewTabs","dialogs","outline","messageBoxes","notifications","fileChoosers","addOns","keyStrokes","activeForm"]),e._benchActiveViewChangedHandler=e._onBenchActivateViewChanged.bind(foe(e)),e}return t=o,(n=[{key:"_init",value:function(e){(e.session||e.parent.session).desktop=this,aoe(hoe(o.prototype),"_init",this).call(this,e),this.url=new Li,this._initTheme(),this.formController=O.create("DesktopFormController",{displayParent:this,session:this.session}),this.messageBoxController=new bz(this,this.session),this.fileChooserController=new ES(this,this.session),this._resizeHandler=this.onResize.bind(this),this._popstateHandler=this.onPopstate.bind(this),this.updateSplitterVisibility(),this.resolveTextKeys(["title"]),this._setViews(this.views),this._setViewButtons(this.viewButtons),this._setMenus(this.menus),this._setKeyStrokes(this.keyStrokes),this._setBenchLayoutData(this.benchLayoutData),this._setDisplayStyle(this.displayStyle),this._setDense(this.dense),this.openUriHandler=O.create("OpenUriHandler",{session:this.session}),this._glassPaneTargetFilters.push((function(e,t){var n=O.widget(e);return!t.has(n)}))}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){aoe(hoe(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.keyStrokeContext.registerKeyStroke([new Zoe(this),new Yse(this)])}},{key:"_onBenchActivateViewChanged",value:function(e){if(!this.initialFormRendering){var t=e.view;t instanceof ZO&&this.bench.outlineContent!==t&&!t.detailForm&&this._setFormActivated(t)}}},{key:"_render",value:function(){this.$container=this.$parent,this.$container.addClass("desktop"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.$container.window().on("resize",this._resizeHandler).on("popstate",this._popstateHandler),this.$overlaySeparator=this.$container.appendDiv("overlay-separator").setVisible(!1),this._renderNavigationVisible(),this._renderHeaderVisible(),this._renderBenchVisible(),this._renderTitle(),this._renderLogoUrl(),this._renderSplitterVisible(),this._renderInBackground(),this._renderNavigationHandleVisible(),this._renderNotifications(),this._renderBrowserHistoryEntry(),this._renderDense(),this.addOns.forEach((function(e){e.render()}),this),this._setupDragAndDrop(),this._disableContextMenu()}},{key:"_remove",value:function(){this.formController.remove(),this.messageBoxController.remove(),this.fileChooserController.remove(),this.$container.window().off("resize",this._resizeHandler).off("popstate",this._popstateHandler),aoe(hoe(o.prototype),"_remove",this).call(this)}},{key:"_postRender",value:function(){aoe(hoe(o.prototype),"_postRender",this).call(this),this.initialFormRendering=!0,this._renderDisplayChildrenOfOutline(),this.formController.render(),this.messageBoxController.render(),this.fileChooserController.render(),this.initialFormRendering=!1}},{key:"_setDisplayStyle",value:function(e){this._setProperty("displayStyle",e);var t=this.displayStyle===o.DisplayStyle.COMPACT;this.header&&(this.header.setToolBoxVisible(!t),this.header.animateRemoval=t),this.navigation&&(this.navigation.setToolBoxVisible(t),this.navigation.htmlComp.layoutData.fullWidth=t),this.bench&&this.bench.setOutlineContentVisible(!t),this.outline&&(this.outline.setCompact(t),this.outline.setEmbedDetailContent(t))}},{key:"setDense",value:function(e){this.setProperty("dense",e)}},{key:"_setDense",value:function(e){this._setProperty("dense",e),$i.clearCache(),Vo.get().init(this.dense?"dense":null)}},{key:"_renderDense",value:function(){this.$container.toggleClass("dense",this.dense)}},{key:"_createLayout",value:function(){return new Loe(this)}},{key:"_renderDisplayChildrenOfOutline",value:function(){this.outline&&(this.outline.formController.render(),this.outline.messageBoxController.render(),this.outline.fileChooserController.render(),this.outline.selectedViewTabs?this.outline.selectedViewTabs.forEach(function(e){this.formController._activateView(e)}.bind(this)):this.outline.views.filter((function(e){return e.modal})).forEach(this.formController._activateView.bind(this.formController)))}},{key:"_removeDisplayChildrenOfOutline",value:function(){this.outline&&(this.outline.formController.remove(),this.outline.messageBoxController.remove(),this.outline.fileChooserController.remove())}},{key:"computeParentForDisplayParent",value:function(e){var t=e;return e instanceof ahe&&(t=this),t}},{key:"_renderTitle",value:function(){var e=this.title;if(null!=e){var t=s()("div.scout");t.length<=1&&(t.document(!0).title=e)}}},{key:"_renderActiveForm",value:function(){}},{key:"_renderBench",value:function(){this.bench||(this.bench=O.create("DesktopBench",{parent:this,animateRemoval:!0,headerTabArea:this.header?this.header.tabArea:void 0,outlineContentVisible:this.displayStyle!==o.DisplayStyle.COMPACT}),this.bench.on("viewActivate",this._benchActiveViewChangedHandler),this.bench.render(),this.bench.$container.insertBefore(this.$overlaySeparator),this.invalidateLayoutTree())}},{key:"_removeBench",value:function(){this.bench&&(this.bench.off("viewActivate",this._benchActiveViewChangedHandler),this.bench.on("destroy",function(){this.bench=null,this.invalidateLayoutTree()}.bind(this)),this.bench.destroy())}},{key:"_renderBenchVisible",value:function(){this.animateLayoutChange=this.rendered,this.benchVisible?(this._renderBench(),this._renderInBackground()):this._removeBench()}},{key:"_renderNavigation",value:function(){this.navigation||(this.navigation=O.create("DesktopNavigation",{parent:this,outline:this.outline,toolBoxVisible:this.displayStyle===o.DisplayStyle.COMPACT,layoutData:{fullWidth:this.displayStyle===o.DisplayStyle.COMPACT}}),this.navigation.render(),this.navigation.$container.prependTo(this.$container),this.invalidateLayoutTree())}},{key:"_removeNavigation",value:function(){this.navigation&&(this.navigation.destroy(),this.navigation=null,this.invalidateLayoutTree())}},{key:"_renderNavigationVisible",value:function(){this.animateLayoutChange=this.rendered,this.navigationVisible?this._renderNavigation():this.animateLayoutChange?this.invalidateLayoutTree():this._removeNavigation()}},{key:"_renderHeader",value:function(){this.header||(this.header=O.create("DesktopHeader",{parent:this,logoUrl:this.logoUrl,animateRemoval:this.displayStyle===o.DisplayStyle.COMPACT,toolBoxVisible:this.displayStyle!==o.DisplayStyle.COMPACT}),this.header.render(),this.navigation&&this.navigation.rendered?this.header.$container.insertAfter(this.navigation.$container):this.header.$container.prependTo(this.$container),this.bench&&this.bench._setTabArea(this.header.tabArea),this.invalidateLayoutTree())}},{key:"_removeHeader",value:function(){this.header&&(this.header.on("destroy",function(){this.invalidateLayoutTree(),this.header=null}.bind(this)),this.header.destroy())}},{key:"_renderHeaderVisible",value:function(){this.headerVisible?this._renderHeader():this._removeHeader()}},{key:"_renderLogoUrl",value:function(){this.header&&this.header.setLogoUrl(this.logoUrl)}},{key:"_renderSplitterVisible",value:function(){this.splitterVisible?this._renderSplitter():this._removeSplitter()}},{key:"_renderSplitter",value:function(){!this.splitter&&this.navigation&&(this.splitter=O.create("Splitter",{parent:this,$anchor:this.navigation.$container,$root:this.$container}),this.splitter.render(),this.splitter.$container.insertBefore(this.$overlaySeparator),this.splitter.on("move",this._onSplitterMove.bind(this)),this.splitter.on("moveEnd",this._onSplitterMoveEnd.bind(this)),this.splitter.on("positionChange",this._onSplitterPositionChange.bind(this)),this.updateSplitterPosition())}},{key:"_removeSplitter",value:function(){this.splitter&&(this.splitter.destroy(),this.splitter=null)}},{key:"_renderInBackground",value:function(){this.bench&&this.bench.$container.toggleClass("drop-shadow",this.inBackground)}},{key:"_renderBrowserHistoryEntry",value:function(){if(Mt.get().supportsHistoryApi()){var e=this.$container.window(!0),t=this.browserHistoryEntry;if(t){var n=this._createHistoryPath(t);(this.rendered?e.history.pushState:e.history.replaceState).bind(e.history)({deepLinkPath:t.deepLinkPath},t.title,n)}}}},{key:"_createHistoryPath",value:function(e){if(!e.pathVisible)return"";var t=e.path,n=this.url.clone();if(n.removeParameter("dl"),n.removeParameter("i"),oi.countOwnProperties(n.parameterMap)>0){var i=new Li(t);for(var r in n.parameterMap)i.addParameter(r,n.getParameter(r));t=i.toString({alwaysFirst:["dl","i"]})}return t}},{key:"_setupDragAndDrop",value:function(){var e=function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="none"};this.$container.on("dragenter",e),this.$container.on("dragover",e),this.$container.on("drop",(function(e){e.stopPropagation(),e.preventDefault()}))}},{key:"updateSplitterVisibility",value:function(){this.setSplitterVisible(this.navigationVisible&&this.benchVisible&&this.displayStyle!==o.DisplayStyle.COMPACT)}},{key:"setSplitterVisible",value:function(e){this.setProperty("splitterVisible",e)}},{key:"updateSplitterPosition",value:function(){if(this.splitter){var e=this.cacheSplitterPosition&&this._loadCachedSplitterPosition();if(e){var t=parseInt(e,10);this.splitter.setPosition(t),this.invalidateLayoutTree()}else this.splitter.setPosition(),this.invalidateLayoutTree()}}},{key:"_disableContextMenu",value:function(){this.$container.on("contextmenu",(function(e){"INPUT"===e.target.nodeName||"TEXTAREA"===e.target.nodeName||e.target.isContentEditable||e.preventDefault()}))}},{key:"setOutline",value:function(e){if(this.outline!==e)try{this.bench&&this.bench.setChanging(!0),this.rendered&&this._removeDisplayChildrenOfOutline(),this.outline=e,this._setDisplayStyle(this.displayStyle),this._setOutlineActivated(),this.navigation&&this.navigation.setOutline(this.outline),this.trigger("outlineChange"),this.rendered&&this._renderDisplayChildrenOfOutline()}finally{this.bench&&this.bench.setChanging(!1)}}},{key:"_setViews",value:function(e){e&&e.forEach(function(e){e.setDisplayParent(this)}.bind(this)),this._setProperty("views",e)}},{key:"_setViewButtons",value:function(e){this.updateKeyStrokes(e,this.viewButtons),this._setProperty("viewButtons",e)}},{key:"setMenus",value:function(e){this.header&&this.header.setMenus(e)}},{key:"_setMenus",value:function(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e)}},{key:"_setKeyStrokes",value:function(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}},{key:"setNavigationHandleVisible",value:function(e){this.setProperty("navigationHandleVisible",e)}},{key:"_renderNavigationHandleVisible",value:function(){this.$container.toggleClass("has-navigation-handle",this.navigationHandleVisible)}},{key:"setNavigationVisible",value:function(e){this.setProperty("navigationVisible",e),this.updateSplitterVisibility()}},{key:"setBenchVisible",value:function(e){this.setProperty("benchVisible",e),this.updateSplitterVisibility()}},{key:"setHeaderVisible",value:function(e){this.setProperty("headerVisible",e)}},{key:"_setBenchLayoutData",value:function(e){e=Fse.ensure(e),this._setProperty("benchLayoutData",e)}},{key:"_setInBackground",value:function(e){this._setProperty("inBackground",e)}},{key:"outlineDisplayStyle",value:function(){if(this.outline)return this.outline.displayStyle}},{key:"shrinkNavigation",value:function(){this.outline.toggleBreadcrumbStyleEnabled&&this.navigationVisible&&this.outlineDisplayStyle()===NL.DisplayStyle.DEFAULT?this.outline.setDisplayStyle(NL.DisplayStyle.BREADCRUMB):this.setNavigationVisible(!1)}},{key:"enlargeNavigation",value:function(){this.navigationVisible&&this.outlineDisplayStyle()===NL.DisplayStyle.BREADCRUMB?this.outline.setDisplayStyle(NL.DisplayStyle.DEFAULT):(this.setNavigationVisible(!0),this.validateLayoutTree())}},{key:"switchToBench",value:function(){this.setHeaderVisible(!0),this.setBenchVisible(!0),this.setNavigationVisible(!1)}},{key:"switchToNavigation",value:function(){this.setNavigationVisible(!0),this.setHeaderVisible(!1),this.setBenchVisible(!1)}},{key:"revalidateHeaderLayout",value:function(){this.header&&this.header.revalidateLayout()}},{key:"goOffline",value:function(){this.offline||(this.offline=!0,this._removeOfflineNotification(),this._offlineNotification=O.create("DesktopNotification:Offline",{parent:this}),this._offlineNotification.show())}},{key:"goOnline",value:function(){this._removeOfflineNotification()}},{key:"_removeOfflineNotification",value:function(){this._offlineNotification&&(setTimeout(this.removeNotification.bind(this,this._offlineNotification),3e3),this._offlineNotification=null)}},{key:"addNotification",value:function(e){e&&(this.notifications.push(e),this.rendered&&this._renderNotification(e))}},{key:"_renderNotification",value:function(e){this.$notifications?this.$notifications.appendTo(this.$container):this.$notifications=this.$container.appendDiv("desktop-notifications"),e.fadeIn(this.$notifications),e.duration>0&&(e.removeTimeout=setTimeout(e.hide.bind(e),e.duration),e.one("remove",function(){this.removeNotification(e)}.bind(this)))}},{key:"_renderNotifications",value:function(){this.notifications.forEach(function(e){this._renderNotification(e)}.bind(this))}},{key:"removeNotification",value:function(e){if("string"==typeof e){var t=e;e=et.find(this.notifications,(function(e){return t===e.id}))}e&&(e.removeTimeout&&clearTimeout(e.removeTimeout),et.remove(this.notifications,e),this.rendered&&this.$notifications&&(e.fadeOut(),e.one("remove",this._onNotificationRemove.bind(this,e))))}},{key:"getPopupsFor",value:function(e){var t=[];return this.$container.children(".popup").each((function(n,i){var r=s()(i),o=ye.get(r);e.has(o)&&t.push(o)})),t}},{key:"destroyPopupsFor",value:function(e){this.getPopupsFor(e).forEach((function(e){e.destroy()}))}},{key:"openUri",value:function(e,t){this.rendered?this.openUriHandler.openUri(e,t):this._postRenderActions.push(this.openUri.bind(this,e,t))}},{key:"bringOutlineToFront",value:function(){this.rendered?this.inBackground&&this.displayStyle!==o.DisplayStyle.BENCH&&(this._setInBackground(!1),this._setOutlineActivated(),this.navigationVisible&&this.navigation.bringToFront(),this.benchVisible&&this.bench.bringToFront(),this.headerVisible&&this.header.bringToFront(),this._renderInBackground()):this._postRenderActions.push(this.bringOutlineToFront.bind(this))}},{key:"sendOutlineToBack",value:function(){this.inBackground||(this._setInBackground(!0),this.navigationVisible&&this.navigation.sendToBack(),this.benchVisible&&this.bench.sendToBack(),this.headerVisible&&this.header.sendToBack(),this._renderInBackground())}},{key:"inFront",value:function(){return!0}},{key:"_glassPaneTargets",value:function(e){var t,n=this.$container.children().not(".splitter").not(".desktop-notifications").not(".overlay-separator");if(e){e.$container&&(n=n.not(e.$container));var i=this.$overlaySeparator.nextAll().toArray(),r=[];e.$container&&i.indexOf(e.$container[0])>-1&&(r=e.$container.nextAll().toArray());var o=null;if(i.length)for(var a=i.length-1;a>=0;a--){var u=i[a];if(this._isGlassPaneTargetFiltered(u,e)){o=u;break}}n=n.filter(function(t,n){return!(r.indexOf(n)>-1)&&n!==o&&this._isGlassPaneTargetFiltered(n,e)}.bind(this))}return e instanceof ZO&&e.displayHint===ZO.DisplayHint.VIEW?(n=n.not(".desktop-bench").not(".desktop-header"),this.header&&this.header.toolBox&&this.header.toolBox.$container&&n.push(this.header.toolBox.$container),t=s.a.makeArray(n),et.pushAll(t,this._getBenchGlassPaneTargetsForView(e))):t=s.a.makeArray(n),this._pushPopupWindowGlassPaneTargets(t,e),t}},{key:"_isGlassPaneTargetFiltered",value:function(e,t){return this._glassPaneTargetFilters.every((function(n){return n(e,t)}),this)}},{key:"addGlassPaneTargetFilter",value:function(e){this._glassPaneTargetFilters.push(e)}},{key:"removeGlassPaneTargetFilter",value:function(e){et.remove(this._glassPaneTargetFilters,e)}},{key:"_deferredGlassPaneTarget",value:function(e){var t=new Ic;return e.one("init",(function(){t.ready([e.$container])})),t}},{key:"_getBenchGlassPaneTargetsForView",value:function(e){var t=[];return t=t.concat(this._getTabGlassPaneTargetsForView(e,this.header)),this.bench&&this.bench.visibleTabBoxes().forEach((function(n){n.rendered&&(n.hasView(e)?t=t.concat(this._getTabGlassPaneTargetsForView(e,n)):t.push(n.$container))}),this),t}},{key:"_getTabGlassPaneTargetsForView",value:function(e,t){var n=[];return t&&t.tabArea&&t.tabArea.tabs.forEach((function(t){t.view!==e&&(n.push(t.$container),t.$container.addClass("no-hover"))})),n}},{key:"_pushPopupWindowGlassPaneTargets",value:function(e,t){this.formController._popupWindows.forEach((function(n){t!==n.form&&e.push(n.initialized?n.$container[0]:this._deferredGlassPaneTarget(n))}),this)}},{key:"showForm",value:function(e,t){var n=e.displayParent||this;e.setDisplayParent(n),this._setFormActivated(e),n.formController.registerAndRender(e,t,!0)}},{key:"hideForm",value:function(e){if(e.displayParent){if(this.displayStyle===o.DisplayStyle.COMPACT&&e.isView()&&this.benchVisible){var t=this.bench.getViews().slice();et.remove(t,e),0===t.length&&this.switchToNavigation()}e.displayParent.formController.unregisterAndRemove(e),this.benchVisible&&0!==this.bench.getViews().length||this.bringOutlineToFront()}}},{key:"activateForm",value:function(e){(e.displayParent||this).formController.activateForm(e),this._setFormActivated(e),e.dialogs.forEach((function(e){e.modal&&this.activateForm(e)}),this)}},{key:"_setOutlineActivated",value:function(){this._setFormActivated(null),this.outline&&this.outline.activateCurrentPage()}},{key:"_setFormActivated",value:function(e){this.rendered&&!this.initialFormRendering&&this.activeForm!==e&&(this.activeForm=e,e?e.displayHint===ZO.DisplayHint.VIEW&&!e.detailForm&&this.bench&&this.bench.hasView(e)&&this.sendOutlineToBack():this.bringOutlineToFront(),this.triggerFormActivate(e))}},{key:"triggerFormActivate",value:function(e){this.trigger("formActivate",{form:e})}},{key:"cancelViews",value:function(e){var t=new Kt;t.forms=e,this.trigger("cancelForms",t),t.defaultPrevented||this._cancelViews(e)}},{key:"_cancelViews",value:function(e){if(1!==(e=e.filter((function(e){return!et.find(e.views,(function(e){return e.modal}))}))).length){var t=e.filter((function(e){var t=!1;return e.visitDisplayChildren((function(e){e.lifecycle.requiresSave()&&(t=!0)}),(function(e){return e instanceof ZO})),e.lifecycle.requiresSave()||t})),n=s.a.resolvedPromise();if(t.length>0){var i=O.create("scout.UnsavedFormChangesForm",{parent:this,session:this.session,displayParent:this,unsavedForms:t});i.open(),n=i.whenSave().then((function(){var e=i.openFormsField.value;return e.forEach((function(e){e.visitDisplayChildren((function(e){e instanceof ZO?e.ok():e.close()})),e.ok()})),e}))}n.then((function(t){t&&et.removeAll(e,t),e.forEach((function(e){e.visitDisplayChildren((function(e){e.close()})),e.close()}))}))}else e[0].cancel()}},{key:"onLayoutAnimationComplete",value:function(){this.headerVisible||this._removeHeader(),this.navigationVisible||this._removeNavigation(),this.benchVisible||this._removeBench(),this.trigger("animationEnd"),this.animateLayoutChange=!1}},{key:"onLayoutAnimationStep",value:function(){this.repositionTooltips()}},{key:"onResize",value:function(e){this.revalidateLayoutTree()}},{key:"resetPopstateHandler",value:function(){this.setPopstateHandler(this.onPopstate.bind(this))}},{key:"setPopstateHandler",value:function(e){if(this.rendered||this.rendering){var t=this.$container.window();this._popstateHandler&&t.off("popstate",this._popstateHandler),e&&t.on("popstate",e)}this._popstateHandler=e}},{key:"onPopstate",value:function(e){var t=e.originalEvent.state;t&&t.deepLinkPath&&this.trigger("historyEntryActivate",t)}},{key:"_onSplitterMove",value:function(e){this.resizing=!0;var t=Math.floor(this.$container.outerWidth(!0)/2);e.position>t&&e.setPosition(t)}},{key:"_onSplitterPositionChange",value:function(e){this.htmlComp.layouting||this.revalidateLayout()}},{key:"_onSplitterMoveEnd",value:function(e){var t=e.position;this.cacheSplitterPosition&&this._storeCachedSplitterPosition(this.splitter.position),t<Eae.BREADCRUMB_STYLE_WIDTH?this.navigation.$container.animate({width:Eae.BREADCRUMB_STYLE_WIDTH},{progress:function(){this.resizing=!0,this.splitter.setPosition(),this.revalidateLayout(),this.resizing=!1}.bind(this),complete:function(){this.resizing=!0,this.splitter.setPosition(),this._storeCachedSplitterPosition(this.splitter.position),this.revalidateLayout(),this.resizing=!1}.bind(this)}):this.resizing=!1}},{key:"_loadCachedSplitterPosition",value:function(){return Gi.getItem(sessionStorage,"scout:desktopSplitterPosition")||Gi.getItem(localStorage,"scout:desktopSplitterPosition:"+window.location.pathname)}},{key:"_storeCachedSplitterPosition",value:function(e){Gi.setItem(sessionStorage,"scout:desktopSplitterPosition",e),Gi.setItem(localStorage,"scout:desktopSplitterPosition:"+window.location.pathname,e)}},{key:"_onNotificationRemove",value:function(e){0===this.notifications.length&&this.$notifications&&(this.$notifications.remove(),this.$notifications=null)}},{key:"onReconnecting",value:function(){this.offline&&this._offlineNotification.reconnect()}},{key:"onReconnectingSucceeded",value:function(){this.offline&&(this.offline=!1,this._offlineNotification.reconnectSucceeded(),this._removeOfflineNotification())}},{key:"onReconnectingFailed",value:function(){this.offline&&this._offlineNotification.reconnectFailed()}},{key:"dataChange",value:function(e){this.events.trigger("dataChange",e)}},{key:"_activeTheme",value:function(){return Ui.get("scout.ui.theme")||o.DEFAULT_THEME}},{key:"logoAction",value:function(){this.logoActionEnabled&&this.trigger("logoAction")}},{key:"_initTheme",value:function(){var e=this.theme;this.url.hasParameter("theme")?e=En.nullIfEmpty(this.url.getParameter("theme"))||o.DEFAULT_THEME:null===e&&(e=this._activeTheme()),this.setTheme(e)}},{key:"setTheme",value:function(e){this.setProperty("theme",e),this.theme!==this._activeTheme()&&this._switchTheme(e)}},{key:"_switchTheme",value:function(e){Ui.set("scout.ui.theme",e,2592e3),s()("body").setVisible(!1);var t={clearBody:!1};this.url.hasParameter("theme")&&(this.url.removeParameter("theme"),t.redirectUrl=this.url.toString()),O.reloadPage(t)}},{key:"moveOverlaysBehindAndFocus",value:function(e,t){(t=s.a.ensure(t)).nextAll().toArray().forEach((function(n){et.containsAll(e,[n])&&s()(n).insertBefore(t)})),t.isOrHas(t.activeElement())||this.session.focusManager.activateFocusContext(t)}},{key:"repositionTooltips",value:function(){this.$container.children(".tooltip").each((function(){O.widget(s()(this)).position()}))}}])&&soe(t.prototype,n),i&&soe(t,i),o}(de);function yoe(e){return(yoe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function voe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function boe(e,t,n){return(boe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=woe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function goe(e,t){return(goe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function moe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=woe(e);if(t){var r=woe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _oe(this,n)}}function _oe(e,t){return!t||"object"!==yoe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function woe(e){return(woe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}doe(poe,"DisplayStyle",{DEFAULT:"default",BENCH:"bench",COMPACT:"compact"}),doe(poe,"UriAction",{DOWNLOAD:"download",OPEN:"open",NEW_WINDOW:"newWindow",POPUP_WINDOW:"popupWindow",SAME_WINDOW:"sameWindow"}),doe(poe,"DEFAULT_THEME","default");var koe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&goe(e,t)}(o,e);var t,n,i,r=moe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addRemoteProperties(["benchVisible","navigationVisible","navigationHandleVisible","headerVisible","geolocationServiceAvailable","inBackground"]),e}return t=o,(n=[{key:"_goOffline",value:function(){this.widget.goOffline()}},{key:"_goOnline",value:function(){this.widget.goOnline()}},{key:"_onWidgetHistoryEntryActivate",value:function(e){this._send("historyEntryActivate",{deepLinkPath:e.deepLinkPath})}},{key:"_onWidgetFormActivate",value:function(e){e.form&&!e.form.modelAdapter||this._sendFormActivate(e.form)}},{key:"_sendFormActivate",value:function(e){var t={formId:e?e.modelAdapter.id:null};this._send("formActivate",t,{coalesce:function(e){return this.target===e.target&&this.type===e.type&&!(null===e.formId&&null!==this.formId)}})}},{key:"_logoAction",value:function(e){this._send("logoAction")}},{key:"_onWidgetEvent",value:function(e){"formActivate"===e.type?this._onWidgetFormActivate(e):"historyEntryActivate"===e.type?this._onWidgetHistoryEntryActivate(e):"logoAction"===e.type?this._logoAction(e):"cancelForms"===e.type?this._onWidgetCancelAllForms(e):boe(woe(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onFormShow",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&((t=this.session.getOrCreateWidget(e.form,n.widget)).setDisplayParent(n.widget),this.session.asyncEvents.some((function(e){return"formActivate"===e.type&&e.target===this.id}),this)||this.addFilterForWidgetEvent((function(e){return"formActivate"===e.type&&e.form===t})),this.widget.showForm(t,e.position))}},{key:"_onFormHide",value:function(e){var t;this.session.getModelAdapter(e.displayParent)&&(t=this.session.getModelAdapter(e.form),this.widget.hideForm(t.widget))}},{key:"_onFormActivate",value:function(e){var t=this.session.getWidget(e.form);this.widget.activateForm(t)}},{key:"_onWidgetCancelAllForms",value:function(e){e.preventDefault();var t=[];e.forms&&(t=e.forms.map((function(e){return e.modelAdapter.id}))),this._send("cancelForms",{formIds:t})}},{key:"_onMessageBoxShow",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&((t=this.session.getOrCreateWidget(e.messageBox,n.widget)).setDisplayParent(n.widget),n.widget.messageBoxController.registerAndRender(t))}},{key:"_onMessageBoxHide",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&(t=this.session.getModelAdapter(e.messageBox),n.widget.messageBoxController.unregisterAndRemove(t.widget))}},{key:"_onFileChooserShow",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&((t=this.session.getOrCreateWidget(e.fileChooser,n.widget)).setDisplayParent(n.widget),n.widget.fileChooserController.registerAndRender(t))}},{key:"_onFileChooserHide",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&(t=this.session.getModelAdapter(e.fileChooser),n.widget.fileChooserController.unregisterAndRemove(t.widget))}},{key:"_onOpenUri",value:function(e){this.widget.openUri(e.uri,e.action)}},{key:"_onOutlineChanged",value:function(e){var t=this.session.getOrCreateWidget(e.outline,this.widget);this.widget.setOutline(t)}},{key:"_onAddNotification",value:function(e){var t=this.session.getOrCreateWidget(e.notification,this.widget);this.widget.addNotification(t)}},{key:"_onRemoveNotification",value:function(e){this.widget.removeNotification(e.notification)}},{key:"_onOutlineContentActivate",value:function(e){this.widget.bringOutlineToFront()}},{key:"_onRequestGeolocation",value:function(e){if(navigator.geolocation){var t=function(e){this._send("geolocationDetermined",{latitude:e.coords.latitude,longitude:e.coords.longitude})}.bind(this),n=function(e){this._send("geolocationDetermined",{errorCode:e.code,errorMessage:e.message})}.bind(this);navigator.geolocation.getCurrentPosition(t,n)}}},{key:"onModelAction",value:function(e){"formShow"===e.type?this._onFormShow(e):"formHide"===e.type?this._onFormHide(e):"formActivate"===e.type?this._onFormActivate(e):"messageBoxShow"===e.type?this._onMessageBoxShow(e):"messageBoxHide"===e.type?this._onMessageBoxHide(e):"fileChooserShow"===e.type?this._onFileChooserShow(e):"fileChooserHide"===e.type?this._onFileChooserHide(e):"openUri"===e.type?this._onOpenUri(e):"outlineChanged"===e.type?this._onOutlineChanged(e):"outlineContentActivate"===e.type?this._onOutlineContentActivate(e):"addNotification"===e.type?this._onAddNotification(e):"removeNotification"===e.type?this._onRemoveNotification(e):"requestGeolocation"===e.type?this._onRequestGeolocation(e):boe(woe(o.prototype),"onModelAction",this).call(this,e)}}])&&voe(t.prototype,n),i&&voe(t,i),o}(fe);function Soe(e){return(Soe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ooe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Toe(e,t,n){return(Toe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Eoe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Coe(e,t){return(Coe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Poe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Eoe(e);if(t){var r=Eoe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Roe(this,n)}}function Roe(e,t){return!t||"object"!==Soe(t)&&"function"!=typeof t?xoe(e):t}function xoe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eoe(e){return(Eoe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Doe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Coe(e,t)}(o,e);var t,n,i,r=Poe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).desktop=null,e.clickable=!1,e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(xoe(e)),e._clickHandler=e._onClick.bind(xoe(e)),e}return t=o,(n=[{key:"_init",value:function(e){Toe(Eoe(o.prototype),"_init",this).call(this,e),this.desktop=this.session.desktop,this.clickable=this.desktop.logoActionEnabled,this.url=e.url}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("desktop-logo"),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}},{key:"_renderProperties",value:function(){Toe(Eoe(o.prototype),"_renderProperties",this).call(this),this._renderUrl(),this._renderClickable()}},{key:"_remove",value:function(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),Toe(Eoe(o.prototype),"_remove",this).call(this)}},{key:"_renderUrl",value:function(){this.$container.css("backgroundImage","url("+this.url+")")}},{key:"_renderClickable",value:function(){this.$container.toggleClass("clickable",this.clickable),this.clickable?this.$container.on("click",this._clickHandler):this.$container.off("click",this._clickHandler)}},{key:"setUrl",value:function(e){this.setProperty("url",e)}},{key:"setClickable",value:function(e){this.setProperty("clickable",e)}},{key:"_onDesktopPropertyChange",value:function(e){"logoActionEnabled"===e.propertyName&&this.setClickable(e.newValue)}},{key:"_onClick",value:function(e){this.desktop.logoAction()}}])&&Ooe(t.prototype,n),i&&Ooe(t,i),o}(de);function Foe(e){return(Foe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Aoe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $oe(e,t){return($oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function joe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ioe(e);if(t){var r=Ioe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Moe(this,n)}}function Moe(e,t){return!t||"object"!==Foe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ioe(e){return(Ioe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Loe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$oe(e,t)}(o,e);var t,n,i,r=joe(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).desktop=e,t}return t=o,(n=[{key:"layout",value:function(e){var t,n,i,r,o,s,a,u=0,l=0,c=this.desktop,f=c.navigation,h=c.header,d=c.bench,p=c.animateLayoutChange,y=this.containerSize(),v=f&&f.htmlComp.layoutData.fullWidth;if(lP.get().handleResponsive(c,e.width()),f&&(u=this.calculateNavigationWidth(y),c.splitter&&c.splitter.setPosition(u),c.navigationVisible&&(s=f.htmlComp,t=new Co(u,y.height).subtract(s.margins()),s.setSize(t))),h&&(l=(i=h.htmlComp).$comp.outerHeight(!0),c.headerVisible&&(p||h.$container.cssLeft(u),n=new Co(y.width-u,l).subtract(i.margins()),p&&!v||i.setSize(n),p&&(g(a={left:y.width},i,n),this._animate(a,i,n)))),d&&(r=d.htmlComp,c.benchVisible)){if(d.$container.cssTop(l),p||d.$container.cssLeft(u),o=new Co(y.width-u,y.height-l).subtract(r.margins()),!p||v){var b=r.size();r.setSize(o),r.size().equals(b)||c.repositionTooltips()}p&&(g(a={left:y.width},r,o),this._animate(a,r,o))}function g(e,t,n){v?t.$comp.cssLeft(y.width):(e.width=n.width,t.setSize(n)),e.left=u}}},{key:"_animate",value:function(e,t,n){function i(){t.$comp.stop().animate(e,{complete:this.desktop.onLayoutAnimationComplete.bind(this.desktop),step:this.desktop.onLayoutAnimationStep.bind(this.desktop)})}t.$comp.is(":animated")?i.call(this):setTimeout(i.bind(this))}},{key:"containerSize",value:function(){var e=this.desktop.htmlComp,t=e.availableSize({exact:!0});return t.subtract(e.insets())}},{key:"calculateNavigationWidth",value:function(e){if(!this.desktop.navigationVisible)return 0;if(this.desktop.navigation.htmlComp.layoutData.fullWidth)return e.width;var t=0;this.desktop.splitter&&(t=this.desktop.splitter.position);var n=this.desktop.outline;return!this.desktop.resizing&&n&&n.toggleBreadcrumbStyleEnabled&&(n.displayStyle===NL.DisplayStyle.BREADCRUMB?t=Eae.BREADCRUMB_STYLE_WIDTH:Math.floor(t)<=Eae.BREADCRUMB_STYLE_WIDTH&&(t=Eae.DEFAULT_STYLE_WIDTH)),Math.max(t,Eae.MIN_WIDTH)}}])&&Aoe(t.prototype,n),i&&Aoe(t,i),o}(zo);function Boe(e){return(Boe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Noe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hoe(e,t){return(Hoe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Voe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zoe(e);if(t){var r=zoe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Woe(this,n)}}function Woe(e,t){return!t||"object"!==Boe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zoe(e){return(zoe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Goe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hoe(e,t)}(o,e);var t,n,i,r=Voe(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_createTab",value:function(e){return O.create("DesktopTab",{parent:this.tabArea,view:e})}}])&&Noe(t.prototype,n),i&&Noe(t,i),o}(Na);function Uoe(e){return(Uoe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Koe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qoe(e,t){return(qoe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yoe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Joe(e);if(t){var r=Joe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Xoe(this,n)}}function Xoe(e,t){return!t||"object"!==Uoe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Joe(e){return(Joe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zoe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qoe(e,t)}(o,e);var t,n,i,r=Yoe(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.F5],t.preventDefault=!0,t.keyStrokeFirePolicy=Eh.KeyStrokeFirePolicy.ALWAYS,t.renderingHints.render=!1,t}return t=o,(n=[{key:"handle",value:function(e){}}])&&Koe(t.prototype,n),i&&Koe(t,i),o}($u);function Qoe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ese=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myWindow=t,this.form=n,this.session=n.session,this.events=new Yt,this.initialized=!1,this.$container=null,this.htmlComp=null,n.popupWindow=this,t.popupWindow=this,t.name="Scout popup-window "+n.modelClass}var t,n,i;return t=e,(n=[{key:"_onUnload",value:function(){s.a.log.isDebugEnabled()&&s.a.log.debug("stored form ID "+this.form.id+" to session storage"),this.form.destroyed?s.a.log.isDebugEnabled()&&s.a.log.debug("form ID "+this.form.id+" is already destroyed - don't trigger unload event"):this.events.trigger("popupWindowUnload",this)}},{key:"_onReady",value:function(){var e=this.myWindow.document,t=s()(this.myWindow),n=s()(e);if(this.myWindow.popupWindow=this,si.install(this.myWindow),O.prepareDOM(e),this.$container=s()(".scout",e),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new xa),this.$container.height(t.height()),this.form.render(this.$container),this.resizeToPrefSize){var i=this.htmlComp.prefSize(),r=new Co(this.myWindow.outerWidth,this.myWindow.outerHeight),o=new Co(n.width(),n.height()),a=r.width-o.width,u=r.height-o.height;this.myWindow.resizeTo(i.width+a,i.height+u),this.resizeToPrefSize=!1}this.form.htmlComp.validateLayout(),this.session.keyStrokeManager.installTopLevelKeyStrokeHandlers(this.$container),this.session.focusManager.installTopLevelMouseHandlers(this.$container),O.installGlobalMouseDownInterceptor(e),s()(this.myWindow).on("unload",this._onUnload.bind(this)).on("resize",this._onResize.bind(this)),this.myWindow.opener&&(this.myWindow.onerror=this.myWindow.opener.onerror),this.initialized=!0,this.events.trigger("init")}},{key:"_onResize",value:function(){var e=s()(this.myWindow),t=e.width(),n=e.height(),i=this.myWindow.screenX,r=this.myWindow.screenY;s.a.log.isDebugEnabled()&&s.a.log.debug("popup-window resize: width="+t+" height="+n+" top="+r+" left="+i),this.form.storeCacheBounds(new Fo(i,r,t,n));var o=new Co(e.width(),e.height());this.htmlComp.setSize(o)}},{key:"isClosed",value:function(){return this.myWindow.closed}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"close",value:function(){this.myWindow.close()}},{key:"title",value:function(e){this.myWindow.document.title=e}}])&&Qoe(t.prototype,n),i&&Qoe(t,i),e}();function tse(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var nse=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"init",value:function(e){this.session=e.session}},{key:"openUri",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("(OpenUriHandler#openUri) uri="+e+" action="+t),e&&((t=O.nvl(t,poe.UriAction.OPEN))===poe.UriAction.DOWNLOAD?this.handleUriActionDownload(e):t===poe.UriAction.OPEN?this.handleUriActionOpen(e):t===poe.UriAction.NEW_WINDOW?this.handleUriActionNewWindow(e):t===poe.UriAction.POPUP_WINDOW?this.handleUriActionPopupWindow(e):t===poe.UriAction.SAME_WINDOW&&this.handleUriActionSameWindow(e))}},{key:"handleUriActionDownload",value:function(e){Mt.get().isIos()?Mt.get().isStandalone()?this.openUriInSameWindow(e):this.openUriAsNewWindow(e):Mt.get().browser===Mt.Browser.CHROME?this.openUriInSameWindow(e):this.openUriInIFrame(e)}},{key:"isUriWithExternallyHandledProtocol",value:function(e){return/^(callto|facetime|fax|geo|mailto|maps|notes|sip|skype|tel|google.navigation):/.test(e)}},{key:"handleUriActionOpen",value:function(e){Mt.get().isIos()?this.openUriInSameWindow(e):this.isUriWithExternallyHandledProtocol(e)?Mt.get().browser===Mt.Browser.CHROME?this.openUriInSameWindow(e):this.openUriInIFrame(e):this.openUriAsNewWindow(e)}},{key:"handleUriActionNewWindow",value:function(e){this.openUriAsNewWindow(e)}},{key:"handleUriActionPopupWindow",value:function(e){this.openUriAsPopupWindow(e)}},{key:"handleUriActionSameWindow",value:function(e){this.openUriInSameWindow(e)}},{key:"openUriInSameWindow",value:function(e){window.location.assign(e)}},{key:"openUriInIFrame",value:function(e){var t=this.session.$entryPoint.appendElement("<iframe>","download-frame").attr("tabindex",-1).attr("src",e);setTimeout((function(){t.remove()}),1e4)}},{key:"openUriAsNewWindow",value:function(e){var t=new jue(this.session);Mt.get().isInternetExplorer()?t.openWindow(e,null,"location=yes,toolbar=yes,menubar=yes,resizable=yes,scrollbars=yes"):t.openWindow(e)}},{key:"openUriAsPopupWindow",value:function(e){new jue(this.session).openWindow(e,null,"location=no,toolbar=no,menubar=no,resizable=yes,scrollbars=yes")}}])&&tse(t.prototype,n),i&&tse(t,i),e}();function ise(e){return(ise="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rse(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ose(e,t,n){return(ose="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cse(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function sse(e,t){return(sse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ase(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=cse(e);if(t){var r=cse(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return use(this,n)}}function use(e,t){return!t||"object"!==ise(t)&&"function"!=typeof t?lse(e):t}function lse(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cse(e){return(cse=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fse(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sse(e,t)}(o,e);var t,n,i,r=ase(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).columns=[],e.components=null,e.tabBoxMap={},e._removeViewInProgress=0,e.changingCounter=0,e.changed=!1,e.layoutCacheKey=[],e._desktopOutlineChangeHandler=e._onDesktopOutlineChange.bind(lse(e)),e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(lse(e)),e._outlineNodesSelectedHandler=e._onOutlineNodesSelected.bind(lse(e)),e._outlinePageChangedHandler=e._onOutlinePageChanged.bind(lse(e)),e._outlinePropertyChangeHandler=e._onOutlinePropertyChange.bind(lse(e)),e._outlineContentDestroyHandler=e._onoutlineContentDestroy.bind(lse(e)),e._viewAddHandler=e._onViewAdd.bind(lse(e)),e._viewRemoveHandler=e._onViewRemove.bind(lse(e)),e._viewActivateHandler=e._onViewActivate.bind(lse(e)),e._viewDeactivateHandler=e._onViewDeactivate.bind(lse(e)),e._desktopAnimationEndHandler=e._onDesktopAnimationEnd.bind(lse(e)),e}return t=o,(n=[{key:"_init",value:function(e){ose(cse(o.prototype),"_init",this).call(this,e),o.VIEW_MIN_HEIGHT=s.a.pxToNumber($i.get("view-tab-box","min-height").minHeight),o.VIEW_MIN_WIDTH=s.a.pxToNumber($i.get("view-tab-box","min-width").minWidth),this.desktop=this.session.desktop,this.setLayoutData(this.desktop.benchLayoutData),this._createColumns(),this.headerTabArea=e.headerTabArea,this.headerTabArea&&(this.headerTabAreaController=O.create("HeaderTabBoxController"),this.headerTabAreaController.install(this,this.headerTabArea)),this.outlineContentVisible=O.nvl(e.outlineContentVisible,!0),this.setOutline(this.desktop.outline),this.updateNavigationHandleVisibility()}},{key:"_setTabArea",value:function(e){if(this.headerTabArea=e,this.headerTabAreaController){this.headerTabAreaController.install(this,this.headerTabArea);var t=this.getTabBox("C");t.viewStack.slice().reverse().forEach((function(e){this.headerTabAreaController._onViewAdd({view:e}),t.currentView===e&&this.headerTabAreaController._onViewActivate({view:e})}),this),this.headerTabAreaController._onViewsChanged(),this.validateLayoutTree()}}},{key:"_createColumns",value:function(){var e=[];this.getLayoutData()&&(e=this.getLayoutData().getColumns());for(var t=0;t<3;t++){var n=this.layoutCacheKey.slice();n.length>0&&n.push("column"+t);var i=O.create("BenchColumn",{parent:this,layoutData:e[t],cacheKey:n,cssClass:o.VIEW_AREA_COLUMN_CLASSES[t]});i.on("viewAdd",this._viewAddHandler),i.on("viewRemove",this._viewRemoveHandler),i.on("viewActivate",this._viewActivateHandler),i.on("viewDeactivate",this._viewDeactivateHandler),this.columns.push(i)}}},{key:"_initKeyStrokeContext",value:function(){ose(cse(o.prototype),"_initKeyStrokeContext",this).call(this),this.desktopKeyStrokeContext=new Ou,this.desktopKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.desktopKeyStrokeContext.$bindTarget=this.desktop.$container,this.desktopKeyStrokeContext.$scopeTarget=this.desktop.$container,this.desktopKeyStrokeContext.registerKeyStroke(new Hse(this.desktop))}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("desktop-bench"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.layoutData=this.getLayoutData(),this._renderColumns(),this._revalidateSplitters(),this._renderNavigationHandleVisible(),this.session.keyStrokeManager.installKeyStrokeContext(this.desktopKeyStrokeContext),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler),this.desktop.on("outlineChange",this._desktopOutlineChangeHandler),this.desktop.on("animationEnd",this._desktopAnimationEndHandler)}},{key:"_createLayout",value:function(){return new Ma(Ma.Direction.ROW,this.layoutCacheKey)}},{key:"visibleColumns",value:function(){return this.columns.filter((function(e){return e.hasViews()}))}},{key:"_renderColumns",value:function(){this.visibleColumns().forEach((function(e){this._renderColumn(e)}),this),this.updateFirstLastMarker()}},{key:"_renderColumn",value:function(e){e&&!e.rendered&&e.render()}},{key:"_remove",value:function(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),this.desktop.off("outlineChange",this._desktopOutlineChangeHandler),this.desktop.off("animationEnd",this._desktopAnimationEndHandler),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.desktopKeyStrokeContext),ose(cse(o.prototype),"_remove",this).call(this)}},{key:"updateFirstLastMarker",value:function(){ye.updateFirstLastMarker(this.visibleColumns())}},{key:"_renderOutlineContent",value:function(){this.outlineContent&&(delete this.outlineContent.title,delete this.outlineContent.subTitle,delete this.outlineContent.iconId,this.addView(this.outlineContent,!this.desktop.inBackground),this.desktop.rendered&&this.session.focusManager.validateFocus())}},{key:"_removeOutlineContent",value:function(){this.outlineContent&&this.removeView(this.outlineContent,!1)}},{key:"_createNavigationHandle",value:function(){return O.create("DesktopNavigationHandle",{parent:this,leftVisible:!1})}},{key:"_renderNavigationHandle",value:function(){this.navigationHandle||(this.navigationHandle=this._createNavigationHandle(),this.navigationHandle.render(),this.navigationHandle.addCssClass("navigation-closed"),this.navigationHandle.on("action",this._onNavigationHandleAction.bind(this)))}},{key:"_removeNavigationHandle",value:function(){this.navigationHandle&&(this.navigationHandle.destroy(),this.navigationHandle=null)}},{key:"_renderNavigationHandleVisible",value:function(){this.navigationHandleVisible?this._renderNavigationHandle():this._removeNavigationHandle(),this.$container.toggleClass("has-navigation-handle",this.navigationHandleVisible)}},{key:"postRender",value:function(){this.columns.forEach((function(e){e.postRender()}))}},{key:"setChanging",value:function(e){e?this.changingCounter++:this.changingCounter--,0===this.changingCounter&&this.changed&&this.rendered&&(this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree(),this.htmlComp.validateLayoutTree(),this.changed=!1)}},{key:"updateLayoutData",value:function(e){if(this.getLayoutData()!==e){this.setLayoutData(e);var t=e.getColumns();this.columns.forEach(function(e,n){var i;this.layoutCacheKey&&this.layoutCacheKey.length>0&&(i=this.layoutCacheKey.slice()).push("column"+n),e.updateLayoutData(t[n],i)}.bind(this)),this.rendered&&(this.htmlComp.layout.setCacheKey(this.layoutCacheKey),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree(),this.htmlComp.validateLayoutTree()),this._updateSplitterMovable()}}},{key:"setLayoutData",value:function(e){this.layoutData!==e&&(ose(cse(o.prototype),"setLayoutData",this).call(this,e),this.layoutData=e,this.layoutCacheKey=[],e.cacheKey&&this.layoutCacheKey.push(e.cacheKey))}},{key:"getLayoutData",value:function(){return this.layoutData}},{key:"setNavigationHandleVisible",value:function(e){this.setProperty("navigationHandleVisible",e)}},{key:"setOutline",value:function(e){this.outline&&(this.outline.off("nodesSelected",this._outlineNodesSelectedHandler),this.outline.off("pageChanged",this._outlinePageChangedHandler),this.outline.off("propertyChange",this._outlinePropertyChangeHandler)),this._setProperty("outline",e),this.outline&&(this.outline.on("nodesSelected",this._outlineNodesSelectedHandler),this.outline.on("pageChanged",this._outlinePageChangedHandler),this.outline.on("propertyChange",this._outlinePropertyChangeHandler)),this.updateOutlineContent()}},{key:"setOutlineContent",value:function(e){var t=this.outlineContent;this.outlineContent!==e&&(t&&t.off("destroy",this._outlineContentDestroyHandler),this.rendered&&this._removeOutlineContent(),e&&e.one("destroy",this._outlineContentDestroyHandler),this._setProperty("outlineContent",e),this.desktop.header&&this.desktop.header.onBenchOutlineContentChange(e,t),this._renderOutlineContent())}},{key:"setOutlineContentVisible",value:function(e){e!==this.outlineContentVisible&&(this._setProperty("outlineContentVisible",e),this.updateOutlineContent())}},{key:"bringToFront",value:function(){this.outlineContent&&this._renderOutlineContent()}},{key:"sendToBack",value:function(){}},{key:"_computeDefaultDetailForm",value:function(){return this.outline.defaultDetailForm}},{key:"_computeOutlineOverview",value:function(){return this.outline.outlineOverview}},{key:"_computeDetailContentForPage",value:function(e){if(!e)throw new Error("called _showDetailContentForPage without node");var t;return e.detailForm&&e.detailFormVisible&&e.detailFormVisibleByUi?(t=e.detailForm).uiCssClass="detail-form":e.detailTable&&e.detailTableVisible&&((t=e.detailTable).uiCssClass="detail-table"),t}},{key:"updateOutlineContent",value:function(){if(this.outlineContentVisible&&this.outline){var e,t=this.outline.selectedNode();t?e=this._computeDetailContentForPage(t):this.outline.defaultDetailForm?e=this._computeDefaultDetailForm():this.outline.outlineOverview&&(e=this._computeOutlineOverview()),e&&(e instanceof ZP&&e.menuBar.setCssClass("main-menubar"),e.displayViewId="C"),this.setOutlineContent(e)}}},{key:"updateOutlineContentDebounced",value:function(){clearTimeout(this._updateOutlineContentTimeout),this._updateOutlineContentTimeout=setTimeout(function(){this.updateOutlineContent()}.bind(this),300)}},{key:"updateNavigationHandleVisibility",value:function(){this.setNavigationHandleVisible(this.desktop.navigationHandleVisible&&!this.desktop.navigationVisible)}},{key:"_onDesktopOutlineChange",value:function(e){this.setOutline(this.desktop.outline),this.updateNavigationHandleVisibility()}},{key:"_onoutlineContentDestroy",value:function(e){this.setOutlineContent(null)}},{key:"_onOutlineNodesSelected",value:function(e){e.debounce?this.updateOutlineContentDebounced():this.updateOutlineContent()}},{key:"_onOutlinePageChanged",value:function(e){var t=this.outline.selectedNode();(e.page||t)&&e.page!==t||this.updateOutlineContent()}},{key:"_onOutlinePropertyChange",value:function(e){O.isOneOf(e.propertyName,["defaultDetailForm","outlineOverview"])&&this.updateOutlineContent()}},{key:"_onDesktopNavigationVisibleChange",value:function(e){this.desktop.navigationVisible&&this.updateNavigationHandleVisibility()}},{key:"_onDesktopNavigationHandleVisibleChange",value:function(e){this.updateNavigationHandleVisibility()}},{key:"_onDesktopAnimationEnd",value:function(e){this.desktop.navigationVisible||this.updateNavigationHandleVisibility()}},{key:"_onBenchLayoutDataChange",value:function(e){this.updateLayoutData(this.desktop.benchLayoutData)}},{key:"_onDesktopPropertyChange",value:function(e){"navigationVisible"===e.propertyName?this._onDesktopNavigationVisibleChange():"navigationHandleVisible"===e.propertyName&&this._onDesktopNavigationHandleVisibleChange(),"benchLayoutData"===e.propertyName&&this._onBenchLayoutDataChange()}},{key:"_onNavigationHandleAction",value:function(e){this.desktop.enlargeNavigation()}},{key:"_revalidateSplitters",value:function(){this.components&&this.components.forEach((function(e){e instanceof Ff&&e.destroy()})),this.components=this.visibleColumns().reduce(function(e,t){if(e.length>0){var n=O.create("Splitter",{parent:this,$anchor:e[e.length-1].$container,$root:this.$container,maxRatio:1});n.render(),n.setLayoutData(La.fixed().withOrder(t.getLayoutData().order-1)),n.$container.addClass("line"),e.push(n)}return e.push(t),e}.bind(this),[]),this.components.filter((function(e){return e instanceof kse})).reduce((function(e,t,n){return n>0&&t.$container.insertAfter(e.$container),t}),void 0),this._updateSplitterMovable()}},{key:"_updateSplitterMovable",value:function(){this.components&&this.components.forEach(function(e,t){if(e instanceof Ff){var n=this.components.slice(0,t).reverse(),i=this.components.slice(t+1);if(n.filter((function(e){return e.getLayoutData().shrink>0})).length>0&&i.filter((function(e){return e.getLayoutData().grow>0})).length>0)return e.setEnabled(!0),void e.on("move",this._onSplitterMove.bind(this));if(n.filter((function(e){return e.getLayoutData().grow>0})).length>0&&i.filter((function(e){return e.getLayoutData().shrink>0})).length>0)return e.setEnabled(!0),void e.on("move",this._onSplitterMove.bind(this));e.setEnabled(!1)}}.bind(this))}},{key:"_onSplitterMove",value:function(e){var t=e.source,n=e.position-t.htmlComp.location().x-t.htmlComp.margins().left-t.htmlComp.insets().left;t.getLayoutData().diff=n,this.revalidateLayout(),t.getLayoutData().diff=null,e.preventDefault()}},{key:"_onViewAdd",value:function(e){this.trigger("viewAdd",{view:e.view})}},{key:"_onViewRemove",value:function(e){this.trigger("viewRemove",{view:e.view})}},{key:"_onViewActivate",value:function(e){var t=e.view;this.outlineContent===t&&this.desktop.bringOutlineToFront(),this.trigger("viewActivate",{view:t})}},{key:"_onViewDeactivate",value:function(e){this.outlineContent===e.view&&this.desktop.sendOutlineToBack(),this.trigger("viewDeactivate",{view:e.view})}},{key:"addView",value:function(e,t){switch(e.displayViewId){case"NW":case"W":case"SW":case"N":case"C":case"S":case"NE":case"E":case"SE":break;default:e.displayViewId="C"}var n=this._getColumn(e.displayViewId);this.tabBoxMap[e.id]=n,n.addView(e,t),this.rendered&&1===n.viewCount()&&(this._renderColumn(n),this._revalidateSplitters(),this.updateFirstLastMarker(),this.changingCounter>0?this.changed=!0:(this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree(),this.htmlComp.validateLayoutTree()))}},{key:"activateView",value:function(e){if(this.hasView(e)){var t=this._getColumn(e.displayViewId);t&&t.activateView(e)}}},{key:"_getColumn",value:function(e){var t;switch(e){case"NW":case"W":case"SW":t=this.columns[o.VIEW_AREA_COLUMN_INDEX.LEFT];break;case"NE":case"E":case"SE":t=this.columns[o.VIEW_AREA_COLUMN_INDEX.RIGHT];break;default:t=this.columns[o.VIEW_AREA_COLUMN_INDEX.CENTER]}return t}},{key:"removeView",value:function(e,t){var n=this.tabBoxMap[e.id];n&&(this._removeViewInProgress++,n.removeView(e,t),this._removeViewInProgress--,delete this.tabBoxMap[e.id],this.rendered&&0===n.viewCount()&&0===this._removeViewInProgress&&(n.remove(),this._revalidateSplitters(),this.updateFirstLastMarker(),this.changingCounter>0?this.changed=!0:(this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree(),this.htmlComp.validateLayoutTree())))}},{key:"getComponents",value:function(){return this.components}},{key:"getTabBox",value:function(e){var t=this._getColumn(e);if(t)return t.getTabBox(e)}},{key:"visibleTabBoxes",value:function(){return this.visibleColumns().reduce((function(e,t){return et.pushAll(e,t.visibleTabBoxes()),e}),[])}},{key:"hasView",value:function(e){return this.columns.filter((function(t){return t.hasView(e)})).length>0}},{key:"getViews",value:function(e){return this.columns.reduce((function(t,n){return et.pushAll(t,n.getViews(e)),t}),[])}},{key:"getViewTab",value:function(e){var t=null;return this.getTabs().some((function(n){return n.view===e&&(t=n,!0)})),t}},{key:"getTabs",value:function(){var e=[];return e=(e=(e=(e=e.concat(this.getTabBox("NW").getController().getTabs())).concat(this.getTabBox("W").getController().getTabs())).concat(this.getTabBox("SW").getController().getTabs())).concat(this.getTabBox("N").getController().getTabs()),e=(e=(e=(e=(e=this.headerTabAreaController?e.concat(this.headerTabAreaController.getTabs()):e.concat(this.getTabBox("C").getController().getTabs())).concat(this.getTabBox("S").getController().getTabs())).concat(this.getTabBox("NE").getController().getTabs())).concat(this.getTabBox("E").getController().getTabs())).concat(this.getTabBox("SE").getController().getTabs())}},{key:"activeViews",value:function(){var e=[];return this.visibleColumns().forEach((function(t){t.visibleTabBoxes().forEach((function(t){e.push(t.currentView)}))})),e}}])&&rse(t.prototype,n),i&&rse(t,i),o}(de);function dse(e){return(dse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pse(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yse(e,t,n){return(yse="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_se(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function vse(e,t){return(vse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bse(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_se(e);if(t){var r=_se(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gse(this,n)}}function gse(e,t){return!t||"object"!==dse(t)&&"function"!=typeof t?mse(e):t}function mse(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _se(e){return(_se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wse(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}fse(hse,"VIEW_MIN_HEIGHT",null),fse(hse,"VIEW_MIN_WIDTH",null),fse(hse,"VIEW_AREA_COLUMN_INDEX",{LEFT:0,CENTER:1,RIGHT:2}),fse(hse,"VIEW_AREA_COLUMN_CLASSES",["west","center","east"]);var kse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vse(e,t)}(o,e);var t,n,i,r=bse(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).tabBoxes=[],e._widgetToTabBox={},e.components=null,e._removeViewInProgress=0,e.layoutData,e._viewAddHandler=e._onViewAdd.bind(mse(e)),e._viewRemoveHandler=e._onViewRemove.bind(mse(e)),e._viewActivateHandler=e._onViewActivate.bind(mse(e)),e._viewDeactivateHandler=e._onViewDeactivate.bind(mse(e)),e}return t=o,(n=[{key:"_init",value:function(e){yse(_se(o.prototype),"_init",this).call(this,e),this.layoutData=e.layoutData,this.layoutCacheKey=e.cacheKey,this.cssClass=e.cssClass,this._createTabBoxes()}},{key:"_keyStrokeBindTarget",value:function(){return this.$container}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("bench-column"),this.cssClass&&this.$container.addClass(this.cssClass),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.layoutData=this.getLayoutData()}},{key:"_renderProperties",value:function(){yse(_se(o.prototype),"_renderProperties",this).call(this),this._renderTabBoxes(),this._revalidateSplitters()}},{key:"_renderTabBoxes",value:function(){this.visibleTabBoxes().forEach(function(e){this._renderTabBox(e)}.bind(this)),this.updateFirstLastMarker()}},{key:"_renderTabBox",value:function(e){e.rendered||e.render()}},{key:"postRender",value:function(){this.tabBoxes.forEach((function(e){e.postRender()}))}},{key:"_createLayout",value:function(){return new Ma(Ma.Direction.COLUMN,this.layoutCacheKey)}},{key:"updateLayoutData",value:function(e,t){if(this.getLayoutData()!==e){this.layoutCacheKey=t,this.setLayoutData(e);var n=this.layoutData.getRows();this.tabBoxes.forEach((function(e,t){e.setLayoutData(n[t])})),this._updateSplitterMovable(),this.rendered&&(this.htmlComp.layout.setCacheKey(this.layoutCacheKey),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree())}}},{key:"setLayoutData",value:function(e){yse(_se(o.prototype),"setLayoutData",this).call(this,e),this.layoutData=e}},{key:"getLayoutData",value:function(){return this.layoutData}},{key:"_onViewAdd",value:function(e){this.trigger("viewAdd",{view:e.view})}},{key:"_onViewRemove",value:function(e){this.trigger("viewRemove",{view:e.view})}},{key:"_onViewActivate",value:function(e){this.trigger("viewActivate",{view:e.view})}},{key:"_onViewDeactivate",value:function(e){this.trigger("viewDeactivate",{view:e.view})}},{key:"activateView",value:function(e){this.getTabBox(e.displayViewId).activateView(e)}},{key:"_createTabBoxes",value:function(){var e=[];this.layoutData&&(e=this.layoutData.getRows());for(var t=0;t<3;t++){var n=O.create("SimpleTabBox",{parent:this,cssClass:En.join(" ","view-tab-box",o.TAB_BOX_CLASSES[t]),controller:O.create("DesktopTabBoxController")});n.setLayoutData(e[t]),n.on("viewAdd",this._viewAddHandler),n.on("viewRemove",this._viewRemoveHandler),n.on("viewActivate",this._viewActivateHandler),n.on("viewDeactivate",this._viewDeactivateHandler),this.tabBoxes.push(n)}}},{key:"_revalidateSplitters",value:function(e){this.components&&this.components.forEach((function(e){e instanceof Ff&&e.destroy()})),this.components=this.visibleTabBoxes().reduce(function(e,t){if(e.length>0){var n=O.create("Splitter",{parent:this,$anchor:e[e.length-1].$container,$root:this.$container,splitHorizontal:!1,maxRatio:1});n.render(),n.setLayoutData(La.fixed().withOrder(t.getLayoutData().order-1)),n.$container.addClass("line"),e.push(n)}return e.push(t),e}.bind(this),[]),this.components.filter((function(e){return e instanceof qa})).reduce((function(e,t,n){return n>0&&t.$container.insertAfter(e.$container),t}),void 0),this._updateSplitterMovable()}},{key:"_updateSplitterMovable",value:function(){this.components&&this.components.forEach(function(e,t){if(e instanceof Ff){var n=this.components.slice(0,t).reverse(),i=this.components.slice(t+1);if(n.filter((function(e){return e.getLayoutData().shrink>0})).length>0&&i.filter((function(e){return e.getLayoutData().grow>0})).length>0)return e.setEnabled(!0),void e.on("move",this._onSplitterMove.bind(this));if(n.filter((function(e){return e.getLayoutData().grow>0})).length>0&&i.filter((function(e){return e.getLayoutData().shrink>0})).length>0)return e.setEnabled(!0),void e.on("move",this._onSplitterMove.bind(this));e.setEnabled(!1)}}.bind(this))}},{key:"_onSplitterMove",value:function(e){var t=e.source,n=e.position-t.htmlComp.location().y-t.htmlComp.margins().top-t.htmlComp.insets().top;t.getLayoutData().diff=n,this.revalidateLayout(),t.getLayoutData().diff=null,e.preventDefault()}},{key:"addView",value:function(e,t){var n=this.getTabBox(e.displayViewId);this._widgetToTabBox[e.id]=n,n.addView(e,t),this.rendered&&1===n.viewCount()&&(n.rendered||n.render(),this._revalidateSplitters(!0),this.updateFirstLastMarker(),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree())}},{key:"getTabBox",value:function(e){var t;switch(e){case"NW":case"N":case"NE":t=this.tabBoxes[o.TAB_BOX_INDEX.TOP];break;case"SW":case"S":case"SE":t=this.tabBoxes[o.TAB_BOX_INDEX.BOTTOM];break;default:t=this.tabBoxes[o.TAB_BOX_INDEX.CENTER]}return t}},{key:"removeView",value:function(e,t){var n=this._widgetToTabBox[e.id];n&&(this._removeViewInProgress++,n.removeView(e,t),this._removeViewInProgress--,delete this._widgetToTabBox[e.id],this.rendered&&0===n.viewCount()&&0===this._removeViewInProgress&&(n.remove(),this._revalidateSplitters(!0),this.updateFirstLastMarker(),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree()))}},{key:"viewCount",value:function(){return this.tabBoxes.map((function(e){return e.viewCount()})).reduce((function(e,t){return e+t}),0)}},{key:"hasView",value:function(e){return this.tabBoxes.filter((function(t){return t.hasView(e)})).length>0}},{key:"hasViews",value:function(){return this.viewCount()>0}},{key:"getViews",value:function(e){return this.tabBoxes.reduce((function(t,n){return et.pushAll(t,n.getViews(e)),t}),[])}},{key:"getComponents",value:function(){return this.components}},{key:"visibleTabBoxes",value:function(){return this.tabBoxes.filter((function(e){return e.hasViews()}))}},{key:"updateFirstLastMarker",value:function(){ye.updateFirstLastMarker(this.visibleTabBoxes())}}])&&pse(t.prototype,n),i&&pse(t,i),o}(de);function Sse(e){return(Sse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ose(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Tse(e,t,n){return(Tse="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xse(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Cse(e,t){return(Cse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pse(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=xse(e);if(t){var r=xse(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Rse(this,n)}}function Rse(e,t){return!t||"object"!==Sse(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xse(e){return(xse=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}wse(kse,"TAB_BOX_INDEX",{TOP:0,CENTER:1,BOTTOM:2}),wse(kse,"TAB_BOX_CLASSES",["north","center","south"]);var Ese=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cse(e,t)}(o,e);var t,n,i,r=Pse(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e))._ensureRows(),t}return t=o,(n=[{key:"_prepare",value:function(){Tse(xse(o.prototype),"_prepare",this).call(this),this.rows=[null,null,null]}},{key:"getRows",value:function(){return this.rows}},{key:"_ensureRows",value:function(){this.rows=this.rows.map((function(e,t){return new La(e).withOrder(2*t)}))}},{key:"updateVisibilities",value:function(e){e.forEach(function(e,t){this.rows[t].visible=e.rendered}.bind(this))}}])&&Ose(t.prototype,n),i&&Ose(t,i),o}(La);function Dse(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Fse=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.columns=[null,null,null],s.a.extend(this,t),this._ensureColumns()}var t,n,i;return t=e,i=[{key:"ensure",value:function(t){return t?t instanceof e?t:new e(t):t=new e}}],(n=[{key:"_ensureColumns",value:function(){this.columns=this.columns.map((function(e,t){return new Ese(e).withOrder(2*t)}))}},{key:"getColumns",value:function(){return this.columns}}])&&Dse(t.prototype,n),i&&Dse(t,i),e}();function Ase(e){return(Ase="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $se(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jse(e,t,n){return(jse="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Nse(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Mse(e,t){return(Mse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ise(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Nse(e);if(t){var r=Nse(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Lse(this,n)}}function Lse(e,t){return!t||"object"!==Ase(t)&&"function"!=typeof t?Bse(e):t}function Bse(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nse(e){return(Nse=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mse(e,t)}(o,e);var t,n,i,r=Ise(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.parseAndSetKeyStroke(e.selectViewTabsKeyStrokeModifier),t.registerRange(pu[1],function(){return pu[Math.min(this._viewTabs().length,9)]}.bind(Bse(t))),t.renderingHints.hAlign=Ni.RIGHT,t.renderingHints.$drawingArea=function(e,t){var n=t.which-pu[1];return this._viewTabs()[n].$container}.bind(Bse(t)),t}return t=o,(n=[{key:"_isEnabled",value:function(){return jse(Nse(o.prototype),"_isEnabled",this).call(this)&&this.field.selectViewTabsKeyStrokesEnabled&&this._viewTabs().length>0}},{key:"handle",value:function(e){var t=e.which-pu[1];if(this._viewTabs().length&&t<this._viewTabs().length){var n=this._viewTabs()[t];this.field.bench&&this.field.bench.activateView(n.view)}}},{key:"_viewTabs",value:function(){return this.field.bench?this.field.bench.getTabs():[]}}])&&$se(t.prototype,n),i&&$se(t,i),o}(Hu);function Vse(e){return(Vse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wse(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zse(e,t,n){return(zse="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qse(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Gse(e,t){return(Gse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Use(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=qse(e);if(t){var r=qse(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Kse(this,n)}}function Kse(e,t){return!t||"object"!==Vse(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qse(e){return(qse=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gse(e,t)}(o,e);var t,n,i,r=Use(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.parseAndSetKeyStroke(e.selectViewTabsKeyStrokeModifier),t.registerRange(pu[1],pu[9]),t.renderingHints.render=!1,t.preventDefault=!0,t}return t=o,(n=[{key:"_isEnabled",value:function(){return zse(qse(o.prototype),"_isEnabled",this).call(this)&&this.field.selectViewTabsKeyStrokesEnabled}},{key:"handle",value:function(e){}}])&&Wse(t.prototype,n),i&&Wse(t,i),o}(Hu);function Xse(e){return(Xse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jse(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zse(e,t,n){return(Zse="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iae(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Qse(e,t){return(Qse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=iae(e);if(t){var r=iae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return tae(this,n)}}function tae(e,t){return!t||"object"!==Xse(t)&&"function"!=typeof t?nae(e):t}function nae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iae(e){return(iae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qse(e,t)}(o,e);var t,n,i,r=eae(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).tabArea=null,e.toolBoxVisible=!0,e.viewButtonBox=null,e.viewButtonBoxVisible=!1,e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(nae(e)),e._desktopAnimationEndHandler=e._onDesktopAnimationEnd.bind(nae(e)),e._outlineContentMenuBarPropertyChangeHandler=e._onOutlineContentMenuBarPropertyChange.bind(nae(e)),e._viewButtonBoxPropertyChangeHandler=e._onViewButtonBoxPropertyChange.bind(nae(e)),e}return t=o,(n=[{key:"_init",value:function(e){Zse(iae(o.prototype),"_init",this).call(this,e),this.desktop=this.session.desktop,this.updateViewButtonBoxVisibility(),this.tabArea=O.create("SimpleTabArea",{parent:this})}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("desktop-header"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new _ae(this)),this._renderViewButtonBoxVisible(),this._renderViewTabs(),this._renderToolBoxVisible(),this._renderLogoUrl(),this._renderInBackground(),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler),this.desktop.on("animationEnd",this._desktopAnimationEndHandler),this.desktop.bench&&(this.outlineContent=this.desktop.bench.outlineContent),this._attachOutlineContentMenuBarHandler()}},{key:"_remove",value:function(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),this.desktop.off("animationEnd",this._desktopAnimationEndHandler),this._detachOutlineContentMenuBarHandler(),this.outlineContent=null,Zse(iae(o.prototype),"_remove",this).call(this)}},{key:"_renderViewTabs",value:function(){this.tabArea.render()}},{key:"_renderToolBox",value:function(){this.toolBox||(this.toolBox=O.create("DesktopToolBox",{parent:this,menus:this.desktop.menus}),this.toolBox.render())}},{key:"_removeToolBox",value:function(){this.toolBox&&(this.toolBox.destroy(),this.toolBox=null)}},{key:"_renderToolBoxVisible",value:function(){this.toolBoxVisible?this._renderToolBox():this._removeToolBox(),this.invalidateLayoutTree()}},{key:"_renderLogoUrl",value:function(){this.logoUrl?this._renderLogo():this._removeLogo(),this.invalidateLayoutTree()}},{key:"_renderLogo",value:function(){this.desktop.displayStyle!==poe.DisplayStyle.COMPACT&&(this.logo?this.logo.setUrl(this.logoUrl):(this.logo=O.create("DesktopLogo",{parent:this,url:this.logoUrl}),this.logo.render()))}},{key:"_removeLogo",value:function(){this.logo&&(this.logo.destroy(),this.logo=null)}},{key:"_renderViewButtonBox",value:function(){this.viewButtonBox||(this.viewButtonBox=O.create("ViewButtonBox",{parent:this,viewButtons:this.desktop.viewButtons}),this.viewButtonBox.on("propertyChange",this._viewButtonBoxPropertyChangeHandler),this.viewButtonBox.render(),this.viewButtonBox.$container.prependTo(this.$container),this.desktop.inBackground&&this.viewButtonBox.sendToBack(),this.updateViewButtonStyling())}},{key:"_removeViewButtonBox",value:function(){this.viewButtonBox&&(this.viewButtonBox.off("propertyChange",this._viewButtonBoxPropertyChangeHandler),this.viewButtonBox.destroy(),this.viewButtonBox=null)}},{key:"_renderViewButtonBoxVisible",value:function(){this.viewButtonBoxVisible?this._renderViewButtonBox():this._removeViewButtonBox(),this.invalidateLayoutTree()}},{key:"sendToBack",value:function(){this.viewButtonBox&&this.viewButtonBox.sendToBack(),this.rendered&&this._renderInBackground()}},{key:"bringToFront",value:function(){this.viewButtonBox&&this.viewButtonBox.bringToFront(),this.rendered&&this._renderInBackground()}},{key:"_renderInBackground",value:function(){this.$container.toggleClass("in-background",this.desktop.inBackground)}},{key:"setLogoUrl",value:function(e){this.setProperty("logoUrl",e)}},{key:"setToolBoxVisible",value:function(e){this.setProperty("toolBoxVisible",e)}},{key:"setViewButtonBoxVisible",value:function(e){this.setProperty("viewButtonBoxVisible",e)}},{key:"setMenus",value:function(e){this.toolBox&&this.toolBox.setMenus(e)}},{key:"updateViewButtonBoxVisibility",value:function(){this.setViewButtonBoxVisible(this.desktop.viewButtons.length>0&&!this.desktop.navigationVisible&&this.desktop.displayStyle!==poe.DisplayStyle.COMPACT)}},{key:"_attachOutlineContentMenuBarHandler",value:function(){if(this.outlineContent){var e=this._outlineContentMenuBar(this.outlineContent);e&&e.on("propertyChange",this._outlineContentMenuBarPropertyChangeHandler)}}},{key:"_detachOutlineContentMenuBarHandler",value:function(){if(this.outlineContent){var e=this._outlineContentMenuBar(this.outlineContent);e&&e.off("propertyChange",this._outlineContentMenuBarPropertyChangeHandler)}}},{key:"_outlineContentMenuBar",value:function(e){return e instanceof ZO?e.rootGroupBox.menuBar:e.menuBar}},{key:"updateViewButtonStyling",value:function(){if(this.viewButtonBoxVisible&&this.desktop.bench&&this.desktop.bench.outlineContentVisible){var e=this.desktop.bench.outlineContent;if(e){var t=!1;if(e instanceof ZO&&e.detailForm){var n=e.rootGroupBox;t=n.menuBar&&n.menuBarVisible&&n.menuBar.visible}else t=e.menuBar&&e.menuBar.visible;this.$container.toggleClass("outline-content-has-menubar",!!t)}}}},{key:"_onDesktopNavigationVisibleChange",value:function(e){this.desktop.navigationVisible&&this.updateViewButtonBoxVisibility()}},{key:"_onDesktopAnimationEnd",value:function(e){this.updateViewButtonBoxVisibility()}},{key:"onBenchOutlineContentChange",value:function(e){this._detachOutlineContentMenuBarHandler(),this.outlineContent=e,this.updateViewButtonStyling(),this._attachOutlineContentMenuBarHandler()}},{key:"_onDesktopPropertyChange",value:function(e){"navigationVisible"===e.propertyName&&this._onDesktopNavigationVisibleChange()}},{key:"_onOutlineContentMenuBarPropertyChange",value:function(e){"visible"===e.propertyName&&this.updateViewButtonStyling()}},{key:"_onViewButtonBoxPropertyChange",value:function(e){"menuButtons"!==e.propertyName&&"tabButtons"!==e.propertyName||this.invalidateLayoutTree()}}])&&Jse(t.prototype,n),i&&Jse(t,i),o}(de);function oae(e){return(oae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aae(e,t,n){return(aae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hae(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function uae(e,t){return(uae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=hae(e);if(t){var r=hae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return cae(this,n)}}function cae(e,t){return!t||"object"!==oae(t)&&"function"!=typeof t?fae(e):t}function fae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hae(e){return(hae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uae(e,t)}(o,e);var t,n,i,r=lae(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).bench=null,e._viewsChangedHandler=e._onViewsChanged.bind(fae(e)),e.tabAreaCenter=null,e.tabAreaInHeader=!1,e}return t=o,(n=[{key:"install",value:function(e,t){this.bench=O.assertParameter("bench",e);var n=this.bench.getTabBox("C");this.tabAreaCenter=n.tabArea,aae(hae(o.prototype),"install",this).call(this,n,t)}},{key:"_installListeners",value:function(){aae(hae(o.prototype),"_installListeners",this).call(this),this.bench.on("viewAdd",this._viewsChangedHandler),this.bench.on("viewRemove",this._viewsChangedHandler)}},{key:"_onViewsChanged",value:function(){this.bench.getViews().some((function(e){return"C"!==e.displayViewId}))?this._setViewTabAreaInHeader(!1):this._setViewTabAreaInHeader(!0)}},{key:"_setViewTabAreaInHeader",value:function(e){this.tabAreaInHeader=e,this.tabAreaCenter.setVisible(!e),this.tabArea.setVisible(e)}},{key:"getTabs",value:function(){return this.tabAreaInHeader?this.tabArea.getTabs():this.tabAreaCenter.getTabs()}}])&&sae(t.prototype,n),i&&sae(t,i),o}(Goe);function pae(e){return(pae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vae(e,t){return(vae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=mae(e);if(t){var r=mae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return gae(this,n)}}function gae(e,t){return!t||"object"!==pae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mae(e){return(mae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vae(e,t)}(o,e);var t,n,i,r=bae(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).header=e,t.desktop=e.desktop,t}return t=o,(n=[{key:"layout",value:function(e){var t,n,i=this.header.htmlComp,r=i.size(),o=this.header.toolBox,s=this.header.viewButtonBox,a=this.header.tabArea,u=a.htmlComp.layout.smallPrefSize(),l=a.htmlComp.prefSize(),c=0,f=0,h=0,d=0;if(r=r.subtract(i.insets()),this.header.logo&&(f=No.size(this.header.logo.$container,!0).width),s&&(t=s.htmlComp.prefSize(),h=t.width,s.htmlComp.setSize(t.subtract(s.htmlComp.margins()))),a.htmlComp.$comp.cssLeft(h),o&&(n=o.htmlComp.prefSize(),d=n.width,v(),b()),(c=p())>=u.width)return c=Math.min(l.width,c),void a.htmlComp.setSize(new Co(c,l.height));if(o&&(n=o.htmlComp.layout.compactPrefSize(),d=n.width,v(),b()),(c=p())>=u.width)return a.htmlComp.setSize(u),void y();function p(){return r.width-d-f-h}function y(){a.htmlComp.setSize(new Co(c,l.height))}function v(){o.htmlComp.setSize(new Co(d,n.height).subtract(o.htmlComp.margins()))}function b(){o.htmlComp.$comp.cssLeft(r.width-d-f)}o&&(n=o.htmlComp.layout.shrinkPrefSize(),d=n.width,v(),b()),c=p(),c=Math.min(u.width,c),c=Math.max(c,a.tabs.length?Xfe.OVERFLOW_MENU_WIDTH:0),y(),o&&c<=Xfe.OVERFLOW_MENU_WIDTH&&(d=r.width-c-f-h,v(),d=o.htmlComp.layout.actualPrefSize().width,v(),b())}}])&&yae(t.prototype,n),i&&yae(t,i),o}(zo);function wae(e){return(wae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Sae(e,t,n){return(Sae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rae(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Oae(e,t){return(Oae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Rae(e);if(t){var r=Rae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Cae(this,n)}}function Cae(e,t){return!t||"object"!==wae(t)&&"function"!=typeof t?Pae(e):t}function Pae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rae(e){return(Rae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Eae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oae(e,t)}(o,e);var t,n,i,r=Tae(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).$body=null,e.layoutData={},e.toolBoxVisible=!1,e.viewButtonBox=null,e._outlinePropertyChangeHandler=e._onOutlinePropertyChange.bind(Pae(e)),e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(Pae(e)),e._viewButtonBoxPropertyChangeHandler=e._onViewButtonBoxPropertyChange.bind(Pae(e)),e}return t=o,(n=[{key:"_init",value:function(e){Sae(Rae(o.prototype),"_init",this).call(this,e),o.MIN_WIDTH=$i.getSize("desktop-navigation","min-width","minWidth",49),o.DEFAULT_STYLE_WIDTH=$i.getSize("desktop-navigation","width","width",290),o.BREADCRUMB_STYLE_WIDTH=$i.getSize("desktop-navigation-breadcrumb","width","width",240),this.desktop=this.parent,this.updateHandleVisibility(),this._setOutline(e.outline),this.viewButtonBox=O.create("ViewButtonBox",{parent:this,viewButtons:this.desktop.viewButtons,singleViewButton:this.singleViewButton}),this.viewButtonBox.on("propertyChange",this._viewButtonBoxPropertyChangeHandler),this._updateSingleViewButton()}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("desktop-navigation"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new Gae(this)),this.htmlComp.layoutData=this.layoutData,this.$body=this.$container.appendDiv("navigation-body").on("mousedown",this._onNavigationBodyMouseDown.bind(this)),this.htmlCompBody=Uo.install(this.$body,this.session),this.htmlCompBody.setLayout(new xa(null,{exact:!0})),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}},{key:"_remove",value:function(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),Sae(Rae(o.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){Sae(Rae(o.prototype),"_renderProperties",this).call(this),this._renderViewButtonBox(),this._renderToolBoxVisible(),this._renderOutline(),this._renderHandleVisible(),this._renderSingleViewButton()}},{key:"_renderViewButtonBox",value:function(){this.viewButtonBox.render()}},{key:"_removeOutline",value:function(){this.outline&&this.outline.remove()}},{key:"_renderOutline",value:function(){this.outline&&(this.outline.render(this.$body),this.outline.invalidateLayoutTree(),this.rendered&&(this.outline.validateLayoutTree(),this.outline.validateFocus()))}},{key:"setOutline",value:function(e){this.setProperty("outline",e)}},{key:"_setOutline",value:function(e){var t=this.outline;this.outline&&this.outline.off("propertyChange",this._outlinePropertyChangeHandler),this.rendered&&this._removeOutline(),this.outline=e,this.outline&&(this.outline.setIconVisible(this.singleViewButton),this.outline.setParent(this),this.outline.setBreadcrumbTogglingThreshold(o.BREADCRUMB_STYLE_WIDTH),this.outline.toggleBreadcrumbStyleEnabled&&t&&t.toggleBreadcrumbStyleEnabled&&t.displayStyle&&this.outline.setDisplayStyle(t.displayStyle),this.outline.inBackground=this.desktop.inBackground,this.outline.on("propertyChange",this._outlinePropertyChangeHandler),this._updateHandle())}},{key:"_updateSingleViewButton",value:function(){if(this.desktop.displayStyle!==poe.DisplayStyle.COMPACT){var e=this.viewButtonBox.menuButtons.length,t=this.viewButtonBox.tabButtons.length;e+t>1?(e>0&&t++,this.setSingleViewButton(t<2)):this.setSingleViewButton(!1)}else this.setSingleViewButton(!1)}},{key:"setSingleViewButton",value:function(e){this.setProperty("singleViewButton",e),this.outline&&this.outline.setIconVisible(this.singleViewButton),this.viewButtonBox.setMenuTabVisible(!e)}},{key:"_renderSingleViewButton",value:function(){this.$container.toggleClass("single-view-button",this.singleViewButton),this.invalidateLayoutTree()}},{key:"sendToBack",value:function(){this.viewButtonBox&&this.viewButtonBox.sendToBack(),this.outline&&this.outline.sendToBack()}},{key:"bringToFront",value:function(){this.viewButtonBox&&this.viewButtonBox.bringToFront(),this.outline&&this.outline.bringToFront()}},{key:"setToolBoxVisible",value:function(e){this.setProperty("toolBoxVisible",e)}},{key:"setHandleVisible",value:function(e){this.setProperty("handleVisible",e)}},{key:"_updateHandle",value:function(){this.handle&&this.handle.setRightVisible(this.outline&&this.outline.toggleBreadcrumbStyleEnabled&&this.desktop.outlineDisplayStyle()===NL.DisplayStyle.BREADCRUMB)}},{key:"updateHandleVisibility",value:function(){this.setHandleVisible(this.desktop.navigationHandleVisible)}},{key:"_renderToolBoxVisible",value:function(){this.toolBoxVisible?this._renderToolBox():this._removeToolBox()}},{key:"_renderToolBox",value:function(){this.toolBox||(this.toolBox=O.create("DesktopToolBox",{parent:this,menus:this.desktop.menus}),this.toolBox.render())}},{key:"_removeToolBox",value:function(){this.toolBox&&(this.toolBox.destroy(),this.toolBox=null)}},{key:"_renderHandleVisible",value:function(){this.handleVisible?this._renderHandle():this._removeHandle()}},{key:"_createHandle",value:function(){return O.create("DesktopNavigationHandle",{parent:this,rightVisible:!1,horizontalAlignment:_c.HorizontalAlignment.RIGHT})}},{key:"_renderHandle",value:function(){this.handle||(this.handle=this._createHandle(),this.handle.render(),this.handle.addCssClass("navigation-open"),this.handle.on("action",this._onHandleAction.bind(this)),this._updateHandle())}},{key:"_removeHandle",value:function(){this.handle&&(this.handle.destroy(),this.handle=null)}},{key:"_onNavigationBodyMouseDown",value:function(e){this.desktop.bringOutlineToFront()}},{key:"_onViewButtonBoxPropertyChange",value:function(e){"menuButtons"!==e.propertyName&&"tabButtons"!==e.propertyName||this._updateSingleViewButton()}},{key:"_onOutlinePropertyChange",value:function(e){"displayStyle"===e.propertyName&&this._updateHandle()}},{key:"_onDesktopPropertyChange",value:function(e){"navigationHandleVisible"===e.propertyName&&this.updateHandleVisibility()}},{key:"_onHandleAction",value:function(e){e.left?this.desktop.shrinkNavigation():this.desktop.enlargeNavigation()}}])&&kae(t.prototype,n),i&&kae(t,i),o}(de);function Dae(e){return(Dae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Aae(e,t,n){return(Aae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Iae(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function $ae(e,t){return($ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Iae(e);if(t){var r=Iae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Mae(this,n)}}function Mae(e,t){return!t||"object"!==Dae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Iae(e){return(Iae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}xae(Eae,"DEFAULT_STYLE_WIDTH",null),xae(Eae,"BREADCRUMB_STYLE_WIDTH",null),xae(Eae,"MIN_WIDTH",null);var Lae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$ae(e,t)}(o,e);var t,n,i,r=jae(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_initKeyStrokeContext",value:function(){Aae(Iae(o.prototype),"_initKeyStrokeContext",this).call(this),this.desktopKeyStrokeContext=new Ou,this.desktopKeyStrokeContext.$bindTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.$scopeTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.registerKeyStroke([new eue(this),new lue(this)])}},{key:"_render",value:function(){Aae(Iae(o.prototype),"_render",this).call(this),this.$container.addClass("desktop-navigation-handle"),this.session.keyStrokeManager.installKeyStrokeContext(this.desktopKeyStrokeContext)}},{key:"_remove",value:function(){Aae(Iae(o.prototype),"_remove",this).call(this),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.desktopKeyStrokeContext)}}])&&Fae(t.prototype,n),i&&Fae(t,i),o}(_c);function Bae(e){return(Bae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hae(e,t){return(Hae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zae(e);if(t){var r=zae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Wae(this,n)}}function Wae(e,t){return!t||"object"!==Bae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zae(e){return(zae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hae(e,t)}(o,e);var t,n,i,r=Vae(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).navigation=e,t}return t=o,(n=[{key:"layout",value:function(e){var t,n,i,r=this.navigation.htmlComp,o=r.size({exact:!0}),s=this.navigation.htmlCompBody,a=this.navigation.toolBox,u=this.navigation.viewButtonBox,l=0,c=0;o=o.subtract(r.insets()),u.visible&&(l=(i=u.htmlComp.prefSize()).height,c=o.width,a&&(c=i.width),n=new Co(c,l).subtract(u.htmlComp.margins()),u.htmlComp.setSize(n)),a&&(a.$container.cssLeft(c),a.htmlComp.setSize(new Co(o.width-c,l))),t=new Co(o.width,o.height).subtract(s.margins()),this.navigation.singleViewButton?s.$comp.cssTop(0):(s.$comp.cssTop(l),t.height-=l),s.setSize(t)}},{key:"preferredLayoutSize",value:function(e){var t=this.navigation.htmlComp,n=this.navigation.htmlCompBody,i=this.navigation.toolBox,r=this.navigation.viewButtonBox,o=n.prefSize(),s=new Co(0,0);if(r){var a=r.htmlComp.prefSize();s.width+=a.width,s.height=Math.max(s.height,a.height)}if(i){var u=i.htmlComp.prefSize();s.width+=u.width,s.height=Math.max(s.height,u.height)}return o.height+=s.height,o.width=Math.max(o.width,s.width),o=o.add(t.insets())}}])&&Nae(t.prototype,n),i&&Nae(t,i),o}(zo);function Uae(e){return(Uae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qae(e,t,n){return(qae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qae(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Yae(e,t){return(Yae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Qae(e);if(t){var r=Qae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Jae(this,n)}}function Jae(e,t){return!t||"object"!==Uae(t)&&"function"!=typeof t?Zae(e):t}function Zae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qae(e){return(Qae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yae(e,t)}(o,e);var t,n,i,r=Xae(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.desktop=e.session.desktop,t.ctrl=!0,t.which=[pu.forBrowser(pu.ANGULAR_BRACKET)],t.renderingHints.$drawingArea=function(e,t){return this.desktop.$container}.bind(Zae(t)),t}return t=o,(n=[{key:"_isEnabled",value:function(){return qae(Qae(o.prototype),"_isEnabled",this).call(this)&&this.field.leftVisible}},{key:"handle",value:function(e){this.desktop.shrinkNavigation()}},{key:"_postRenderKeyBox",value:function(e,t){var n,i,r,o=this.field;t.addClass("navigation-handle-key-box left"),i=(n=o.$left.offsetTo(this.desktop.$container)).left-t.outerWidth(!0),r=n.top,t.cssLeft(i).cssTop(r)}}])&&Kae(t.prototype,n),i&&Kae(t,i),o}($u);function tue(e){return(tue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iue(e,t,n){return(iue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uue(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function rue(e,t){return(rue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=uue(e);if(t){var r=uue(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sue(this,n)}}function sue(e,t){return!t||"object"!==tue(t)&&"function"!=typeof t?aue(e):t}function aue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uue(e){return(uue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rue(e,t)}(o,e);var t,n,i,r=oue(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.desktop=e.session.desktop,t.ctrl=!0,t.shift=!0,t.which=[pu.forBrowser(pu.ANGULAR_BRACKET)],t.renderingHints.$drawingArea=function(e,t){return this.desktop.$container}.bind(aue(t)),t}return t=o,(n=[{key:"_isEnabled",value:function(){return iue(uue(o.prototype),"_isEnabled",this).call(this)&&this.field.rightVisible}},{key:"handle",value:function(e){this.desktop.enlargeNavigation()}},{key:"_postRenderKeyBox",value:function(e,t){var n,i,r,o=this.field;t.addClass("navigation-handle-key-box right"),i=(n=o.$right.offsetTo(this.desktop.$container)).left+o.$right.outerWidth(),r=n.top,t.cssLeft(i).cssTop(r)}}])&&nue(t.prototype,n),i&&nue(t,i),o}($u);function cue(e){return(cue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hue(e,t,n){return(hue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vue(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function due(e,t){return(due=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=vue(e);if(t){var r=vue(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return yue(this,n)}}function yue(e,t){return!t||"object"!==cue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vue(e){return(vue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&due(e,t)}(o,e);var t,n,i,r=pue(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).closable=!0,e.duration=5e3,e.htmlEnabled=!1,e.removeTimeout,e._removing=!1,e}return t=o,(n=[{key:"_init",value:function(e){hue(vue(o.prototype),"_init",this).call(this,e)}},{key:"_render",value:function(){this.$container=this.$parent.prependDiv("desktop-notification"),this.$content=this.$container.appendDiv("desktop-notification-content"),this.$messageText=this.$content.appendDiv("desktop-notification-message"),this.$loader=this.$content.appendDiv("desktop-notification-loader"),Mt.get().supportsCssAnimation()&&this.$loader.addClass("animated")}},{key:"_remove",value:function(){hue(vue(o.prototype),"_remove",this).call(this),this._removeCloser()}},{key:"_renderProperties",value:function(){hue(vue(o.prototype),"_renderProperties",this).call(this),this._renderClosable()}},{key:"_renderMessage",value:function(){var e=this.status.message||"";this.htmlEnabled?(this.$messageText.html(e),this.$messageText.find(".app-link").on("click",this._onAppLinkAction.bind(this))):this.$messageText.html(En.nl2br(e))}},{key:"_renderLoading",value:function(){this.$container.toggleClass("loading",this.loading),this.$loader.setVisible(this.loading)}},{key:"setClosable",value:function(e){this.setProperty("closable",e)}},{key:"_renderClosable",value:function(){this.$content.toggleClass("closable",this.closable),this.closable?this._renderCloser():this._removeCloser()}},{key:"_removeCloser",value:function(){this.$closer&&(this.$closer.remove(),this.$closer=null)}},{key:"_renderCloser",value:function(){this.$closer||(this.$closer=this.$content.appendDiv("closer").on("click",this._onCloseIconClick.bind(this)))}},{key:"_onCloseIconClick",value:function(){this.hide()}},{key:"show",value:function(){this.session.desktop.addNotification(this)}},{key:"hide",value:function(){this._removing||(this.trigger("close"),this.session.desktop.removeNotification(this))}},{key:"fadeIn",value:function(e){this.render(e),Mt.get().supportsCssAnimation()&&this.$container.addClassForAnimation("desktop-notification-slide-in")}},{key:"fadeOut",value:function(){Mt.get().supportsCssAnimation()?this.rendered&&(this._removing||(this._removing=!0,this.$container.addClass("desktop-notification-fade-out"),this.$container.oneAnimationEnd(function(){this.destroy()}.bind(this)))):this.destroy()}},{key:"invalidateLayoutTree",value:function(){}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}}])&&fue(t.prototype,n),i&&fue(t,i),o}(lb);function gue(e){return(gue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _ue(e,t,n){return(_ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Oue(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function wue(e,t){return(wue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Oue(e);if(t){var r=Oue(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Sue(this,n)}}function Sue(e,t){return!t||"object"!==gue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oue(e){return(Oue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(bue,"INFINITE",-1);var Tue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wue(e,t)}(o,e);var t,n,i,r=kue(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_onWidgetClose",value:function(e){this._send("close",{ref:e.ref})}},{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"close"===e.type?this._onWidgetClose(e):"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):_ue(Oue(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&mue(t.prototype,n),i&&mue(t,i),o}(yb);function Cue(e){return(Cue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Rue(e,t,n){return(Rue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fue(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function xue(e,t){return(xue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Eue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Fue(e);if(t){var r=Fue(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Due(this,n)}}function Due(e,t){return!t||"object"!==Cue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fue(e){return(Fue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Aue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xue(e,t)}(o,e);var t,n,i,r=Eue(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).connectFailedReset=null,e}return t=o,(n=[{key:"_init",value:function(e){Rue(Fue(o.prototype),"_init",this).call(this,e),this.closable=!1,this.duration=bue.INFINITE,this.status=new pi({message:this.session.text("ui.ConnectionInterrupted"),severity:pi.Severity.ERROR})}},{key:"_render",value:function(){Rue(Fue(o.prototype),"_render",this).call(this),this.$content.addClass("offline-message"),this.$messageText.addClass("offline-message-text"),this.$loader.text(this.session.text("ui.Reconnecting_"))}},{key:"reconnect",value:function(){this.setLoading(!0),this.connectFailedReset&&clearTimeout(this.connectFailedReset),this.$messageText.hide()}},{key:"reconnectFailed",value:function(){this.connectFailedReset=setTimeout(function(){this.connectFailedReset=null,this.setLoading(!1),this.$messageText.show()}.bind(this),1100)}},{key:"reconnectSucceeded",value:function(){this.setLoading(!1),this.connectFailedReset&&clearTimeout(this.connectFailedReset),this.setStatus({message:this.session.text("ui.ConnectionReestablished"),severity:pi.Severity.OK}),this.$messageText.show()}}])&&Pue(t.prototype,n),i&&Pue(t,i),o}(bue);function $ue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jue=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=t,this.preserveOpener=n}var t,n,i;return t=e,(n=[{key:"openWindow",value:function(e,t,n,i){t=t||"scout_"+(new Date).getTime();var r=window.open("",t,n);if(r){this.preserveOpener||(r.opener=null);try{r.window.location.href=e}catch(t){return void this._handleInvalidUri(e,r,t)}i&&i(r)}else s.a.log.warn("Popup-blocker detected! Show link to open window manually"),this.showNotification(function(){this.openWindow(e,t,n,i)}.bind(this))}},{key:"showNotification",value:function(e){var t,n,i=this.session.desktop;"string"==typeof e&&(n=e),t=O.create("DesktopNotification:PopupBlocker",{parent:i,linkUrl:n,preserveOpener:this.preserveOpener}),!n&&s.a.isFunction(e)&&t.on("linkClick",e),t.show()}},{key:"_handleInvalidUri",value:function(e,t,n){O.create("ErrorHandler",{logError:!0,displayError:!1,sendError:!1}).handle(n),t.close(),mz.createOk(this.session.desktop).withHeader(this.session.text("ui.UnexpectedProblem")).withBody(this.session.text("ui.InvalidUriMsg")).withSeverity(pi.Severity.ERROR).buildAndOpen()}}])&&$ue(t.prototype,n),i&&$ue(t,i),e}();function Mue(e){return(Mue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Iue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Lue(e,t,n){return(Lue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vue(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Bue(e,t){return(Bue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Vue(e);if(t){var r=Vue(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Hue(this,n)}}function Hue(e,t){return!t||"object"!==Mue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vue(e){return(Vue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bue(e,t)}(o,e);var t,n,i,r=Nue(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).duration=bue.INFINITE,e.linkUrl,e.preserveOpener=!1,e}return t=o,(n=[{key:"_init",value:function(e){Lue(Vue(o.prototype),"_init",this).call(this,e),this.linkText=O.nvl(this.linkText,this.session.text("ui.OpenManually")),this._setStatus({message:this.session.text("ui.PopupBlockerDetected"),severity:pi.Severity.WARNING})}},{key:"_render",value:function(){Lue(Vue(o.prototype),"_render",this).call(this),this.$messageText.addClass("popup-blocked-title"),this.$link=this.$content.appendElement("<a>","popup-blocked-link").text(this.linkText).on("click",this._onLinkClick.bind(this))}},{key:"_renderProperties",value:function(){Lue(Vue(o.prototype),"_renderProperties",this).call(this),this._renderLinkUrl()}},{key:"_renderLinkUrl",value:function(){this.linkUrl?(this.$link.attr("href",this.linkUrl).attr("target","_blank"),this.preserveOpener||this.$link.attr("rel","noreferrer noopener")):this.$link.removeAttr("href").removeAttr("target")}},{key:"_onLinkClick",value:function(){this.trigger("linkClick"),this.hide()}}])&&Iue(t.prototype,n),i&&Iue(t,i),o}(bue);function zue(e){return(zue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Uue(e,t,n){return(Uue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xue(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Kue(e,t){return(Kue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function que(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Xue(e);if(t){var r=Xue(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Yue(this,n)}}function Yue(e,t){return!t||"object"!==zue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xue(e){return(Xue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kue(e,t)}(o,e);var t,n,i,r=que(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_init",value:function(e){e.uiMenuCssClass=En.join(" ",e.uiMenuCssClass,"desktop-tool-box-item"),Uue(Xue(o.prototype),"_init",this).call(this,e)}},{key:"_initMenu",value:function(e){Uue(Xue(o.prototype),"_initMenu",this).call(this,e),e.popupHorizontalAlignment=kd.Alignment.RIGHTEDGE}},{key:"_render",value:function(){Uue(Xue(o.prototype),"_render",this).call(this),this.$container.addClass("desktop-tool-box")}}])&&Gue(t.prototype,n),i&&Gue(t,i),o}(a_);function Zue(e){return(Zue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Que(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ele(e,t,n){return(ele="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rle(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function tle(e,t){return(tle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=rle(e);if(t){var r=rle(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ile(this,n)}}function ile(e,t){return!t||"object"!==Zue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rle(e){return(rle=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ole=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tle(e,t)}(o,e);var t,n,i,r=nle(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"_postRenderKeyBox",value:function(e){if(this.field.iconId&&!this.field._isMenuItem){var t=e.outerWidth()/2-e.find(".key-box").outerWidth()/2;e.find(".key-box").cssLeft(t)}}},{key:"renderKeyBox",value:function(e,t){return this.field._isMenuItem&&(this.renderingHints.hAlign=Ni.RIGHT),ele(rle(o.prototype),"renderKeyBox",this).call(this,e,t)}}])&&Que(t.prototype,n),i&&Que(t,i),o}(Uh);function sle(e){return(sle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ale(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ule(e,t,n){return(ule="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hle(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function lle(e,t){return(lle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=hle(e);if(t){var r=hle(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fle(this,n)}}function fle(e,t){return!t||"object"!==sle(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hle(e){return(hle=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dle=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lle(e,t)}(o,e);var t,n,i,r=cle(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).showTooltipWhenSelected=!1,e.displayStyle="TAB",e._renderedAsMenu=!1,e}return t=o,(n=[{key:"renderAsMenuItem",value:function(e){this._renderedAsMenu=!0,ule(hle(o.prototype),"render",this).call(this,e)}},{key:"renderAsTab",value:function(e){this._renderedAsMenu=!1,ule(hle(o.prototype),"render",this).call(this,e)}},{key:"_render",value:function(){this._renderedAsMenu?this._renderAsMenuItem():this._renderAsTab()}},{key:"_renderAsMenuItem",value:function(){this.$container=this.$parent.appendDiv("view-menu-item").on("click",this._onMouseEvent.bind(this))}},{key:"_renderAsTab",value:function(){this.$container=this.$parent.appendDiv("view-button-tab").on("mousedown",this._onMouseEvent.bind(this))}},{key:"_renderText",value:function(){this._renderedAsMenu&&ule(hle(o.prototype),"_renderText",this).call(this)}},{key:"setDisplayStyle",value:function(e){this.setProperty("displayStyle",e)}},{key:"last",value:function(){this.$container.addClass("last")}},{key:"tab",value:function(){this.$container.addClass("view-tab")}},{key:"_onMouseEvent",value:function(e){this.doAction()}},{key:"_createActionKeyStroke",value:function(){return new ole(this)}}])&&ale(t.prototype,n),i&&ale(t,i),o}(Eh);function ple(e){return(ple="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yle(e,t){return(yle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=gle(e);if(t){var r=gle(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ble(this,n)}}function ble(e,t){return!t||"object"!==ple(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gle(e){return(gle=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mle=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yle(e,t)}(n,e);var t=vle(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Lh);function _le(e){return(_le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wle(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kle(e,t,n){return(kle="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ple(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Sle(e,t){return(Sle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ole(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ple(e);if(t){var r=Ple(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Tle(this,n)}}function Tle(e,t){return!t||"object"!==_le(t)&&"function"!=typeof t?Cle(e):t}function Cle(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ple(e){return(Ple=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rle=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sle(e,t)}(o,e);var t,n,i,r=Ole(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).viewMenuTab=null,e.viewButtons=[],e.menuButtons=[],e.tabButtons=[],e._desktopOutlineChangeHandler=e._onDesktopOutlineChange.bind(Cle(e)),e._viewButtonPropertyChangeHandler=e._onViewButtonPropertyChange.bind(Cle(e)),e._addWidgetProperties(["tabButtons"]),e}return t=o,(n=[{key:"_init",value:function(e){kle(Ple(o.prototype),"_init",this).call(this,e),this.desktop=this.session.desktop,this.viewMenuTab=O.create("ViewMenuTab",{parent:this}),this._setViewButtons(this.viewButtons),this.desktop.on("outlineChange",this._desktopOutlineChangeHandler)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("view-button-box"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new jle(this)),this.viewMenuTab.render(),this._onDesktopOutlineChange()}},{key:"_renderProperties",value:function(){kle(Ple(o.prototype),"_renderProperties",this).call(this),this._renderTabButtons()}},{key:"_remove",value:function(){this.desktop.off("outlineChange",this._desktopOutlineChangeHandler),this.viewButtons.forEach((function(e){e.off("selected",this._viewButtonPropertyChangeHandler)}),this),kle(Ple(o.prototype),"_remove",this).call(this)}},{key:"setMenuTabVisible",value:function(e){this.viewMenuTab.setViewTabVisible(e),this.invalidateLayoutTree()}},{key:"setViewButtons",value:function(e){this.setProperty("viewButtons",e)}},{key:"_setViewButtons",value:function(e){this.viewButtons&&this.viewButtons.forEach((function(e){e.off("propertyChange",this._viewButtonPropertyChangeHandler)}),this),this._setProperty("viewButtons",e),this.viewButtons.forEach((function(e){e.on("propertyChange",this._viewButtonPropertyChangeHandler)}),this),this._updateViewButtons()}},{key:"setTabButtons",value:function(e){this.setProperty("tabButtons",e)}},{key:"_renderTabButtons",value:function(){this.tabButtons.forEach((function(e,t){e.renderAsTab(),e.tab(),t===this.tabButtons.length-1&&e.last()}),this)}},{key:"_updateViewButtons",value:function(){var e=this.viewButtons.filter((function(e){return e.visible})),t=e.filter((function(e){return"MENU"===e.displayStyle})),n=null;t.length>1?n=e.filter((function(e){return"TAB"===e.displayStyle})):(n=e,t=[]),this._setMenuButtons(t),this.setTabButtons(n),this._updateVisibility()}},{key:"_updateVisibility",value:function(e){this.setVisible(this.tabButtons.length+this.menuButtons.length>1)}},{key:"setMenuButtons",value:function(e){this.setProperty("menuButtons",e),this._updateVisibility()}},{key:"_setMenuButtons",value:function(e){this._setProperty("menuButtons",e),this.viewMenuTab.setViewButtons(this.menuButtons)}},{key:"sendToBack",value:function(){this.viewMenuTab.sendToBack()}},{key:"bringToFront",value:function(){this.viewMenuTab.bringToFront()}},{key:"_onDesktopOutlineChange",value:function(e){var t=this.desktop.outline;this.viewButtons.forEach((function(e){e instanceof $he&&e.onOutlineChange(t)}))}},{key:"_onViewButtonSelected",value:function(e){this.viewButtons.forEach((function(t){t!==e.source&&t.isToggleAction()&&t.setSelected(!1)}),this),this.viewMenuTab.onViewButtonSelected()}},{key:"_onViewButtonPropertyChange",value:function(e){"selected"===e.propertyName?this._onViewButtonSelected(e):"visible"!==e.propertyName&&"displayStyle"!==e.propertyName||this._updateViewButtons()}}])&&wle(t.prototype,n),i&&wle(t,i),o}(de);function xle(e){return(xle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ele(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Dle(e,t){return(Dle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=$le(e);if(t){var r=$le(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ale(this,n)}}function Ale(e,t){return!t||"object"!==xle(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $le(e){return($le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jle=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dle(e,t)}(o,e);var t,n,i,r=Fle(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).viewButtonBox=e,t}return t=o,(n=[{key:"layout",value:function(e){var t=this.viewButtonBox.tabButtons.filter((function(e){return e.visible})),n=this.viewButtonBox.viewMenuTab,i=this.viewButtonBox.htmlComp.size().width,r=i/t.length;n.visible&&n.selectedButton.rendered&&(n.selectedButton&&(r=(i-No.size(n.dropdown.$container,{exact:!0}).width)/(t.length+1),n.selectedButton.$container.cssWidth(r)),i-=No.size(n.$container,{exact:!0}).width),t.forEach((function(e,n){t.length-1===n?e.$container.cssWidth(Math.ceil(100*i)/100):(e.$container.cssWidth(r),i-=e.$container.cssWidth())}),this)}},{key:"preferredLayoutSize",value:function(e){return No.prefSize(e,{useCssSize:!0})}}])&&Ele(t.prototype,n),i&&Ele(t,i),o}(zo);function Mle(e){return(Mle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ile(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Lle(e,t){return(Lle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ble(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Vle(e);if(t){var r=Vle(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Nle(this,n)}}function Nle(e,t){return!t||"object"!==Mle(t)&&"function"!=typeof t?Hle(e):t}function Hle(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vle(e){return(Vle=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wle=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lle(e,t)}(o,e);var t,n,i,r=Ble(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.which=[pu.F2],t.stopPropagation=!0,t.renderingHints.$drawingArea=function(e,t){return this.field.$container}.bind(Hle(t)),t}return t=o,(n=[{key:"handle",value:function(e){this.field.selected&&!this.field.inBackground?this.field.togglePopup():this.field.selectedButton&&this.field.selectedButton.doAction()}},{key:"_postRenderKeyBox",value:function(e){var t=e.find(".key-box").outerWidth(),n=this.field.dropdown.$container.outerWidth();this.field.selected&&!this.field.inBackground?n/=2:this.field.selectedButton&&(n+=this.field.selectedButton.$container.outerWidth()/2),n-=t/2,e.find(".key-box").cssLeft(n)}}])&&Ile(t.prototype,n),i&&Ile(t,i),o}($u);function zle(e){return(zle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gle(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ule(e,t,n){return(Ule="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Jle(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Kle(e,t){return(Kle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Jle(e);if(t){var r=Jle(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Yle(this,n)}}function Yle(e,t){return!t||"object"!==zle(t)&&"function"!=typeof t?Xle(e):t}function Xle(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jle(e){return(Jle=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zle=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kle(e,t)}(o,e);var t,n,i,r=qle(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).$tab,e.$headBlueprint,e.viewMenus,e.viewButtonBoxBounds,e._addWidgetProperties("viewMenus"),e._viewMenuActionHandler=e._onViewMenuAction.bind(Xle(e)),e}return t=o,(n=[{key:"_init",value:function(e){e.focusableContainer=!0,Ule(Jle(o.prototype),"_init",this).call(this,e),this.$tab=e.$tab,this.$headBlueprint=this.$tab,this.viewButtonBoxBounds=e.naviBounds}},{key:"_createLayout",value:function(){return new sce(this)}},{key:"_initKeyStrokeContext",value:function(){Ule(Jle(o.prototype),"_initKeyStrokeContext",this).call(this),Rm.registerKeyStrokes(this.keyStrokeContext,this,"view-menu-item")}},{key:"_render",value:function(){Ule(Jle(o.prototype),"_render",this).call(this),this.viewMenus.forEach((function(e){e.renderAsMenuItem(this.$body),e.on("action",this._viewMenuActionHandler)}),this),et.findFromReverse(this.viewMenus,this.viewMenus.length-1,(function(e){return e.visible}),this).$container.addClass("last"),this._installScrollbars({axis:"y"})}},{key:"_remove",value:function(){this.viewMenus.forEach((function(e){e.off("action",this._viewMenuActionHandler)}),this),Ule(Jle(o.prototype),"_remove",this).call(this)}},{key:"get$Scrollable",value:function(){return this.$body}},{key:"_renderHead",value:function(){Ule(Jle(o.prototype),"_renderHead",this).call(this),this._copyCssClassToHead("view-menu"),this._copyCssClassToHead("unfocusable"),this.$head.removeClass("popup-head"),this.$head.addClass("view-menu-popup-head")}},{key:"_modifyBody",value:function(){this.$body.removeClass("popup-body"),this.$body.addClass("view-menu-popup-body")}},{key:"position",value:function(){var e=this.$tab.offset(),t=No.size(this.$tab,!0),n=t.height;No.setBounds(this.$head,e.left,e.top,t.width,t.height),this.$deco.cssLeft(e.left),this.$deco.cssTop(0),this.$deco.cssWidth(t.width-1),this.$head.cssTop(-n),this.$body.cssTop(0),this.$container.cssMarginTop(t.height),this.setLocation(new Eo(0,0))}},{key:"_onViewMenuAction",value:function(e){this.close()}}])&&Gle(t.prototype,n),i&&Gle(t,i),o}(op);function Qle(e){return(Qle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ece(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tce(e,t,n){return(tce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oce(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function nce(e,t){return(nce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ice(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oce(e);if(t){var r=oce(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rce(this,n)}}function rce(e,t){return!t||"object"!==Qle(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oce(e){return(oce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Zle,"MAX_MENU_WIDTH",300);var sce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nce(e,t)}(o,e);var t,n,i,r=ice(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"preferredLayoutSize",value:function(e){var t=tce(oce(o.prototype),"preferredLayoutSize",this).call(this,e);return t.width>=this.popup.viewButtonBoxBounds.width||(t.width=Math.min(Zle.MAX_MENU_WIDTH,this.popup.viewButtonBoxBounds.width)),t}}])&&ece(t.prototype,n),i&&ece(t,i),o}(dp);function ace(e){return(ace="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lce(e,t,n){return(lce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dce(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function cce(e,t){return(cce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=dce(e);if(t){var r=dce(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return hce(this,n)}}function hce(e,t){return!t||"object"!==ace(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dce(e){return(dce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cce(e,t)}(o,e);var t,n,i,r=fce(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).viewButtons=[],e.selected=!1,e.selectedButton=null,e.viewTabVisible=!0,e.defaultIconId=sn.FOLDER,e._addWidgetProperties(["selectedButton"]),e}return t=o,(n=[{key:"_init",value:function(e){lce(dce(o.prototype),"_init",this).call(this,e),this.dropdown=O.create("Menu",{parent:this,iconId:sn.ANGLE_DOWN,tabbable:!1,cssClass:"view-menu"}),this.dropdown.on("action",this.togglePopup.bind(this)),this._setViewButtons(this.viewButtons)}},{key:"_initKeyStrokeContext",value:function(){lce(dce(o.prototype),"_initKeyStrokeContext",this).call(this),this.desktopKeyStrokeContext=new Ou,this.desktopKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.desktopKeyStrokeContext.$bindTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.$scopeTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.registerKeyStroke([new Wle(this)])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("view-tab"),this.htmlComp=Uo.install(this.$container,this.session),this.dropdown.render(this.$container),this.session.keyStrokeManager.installKeyStrokeContext(this.desktopKeyStrokeContext)}},{key:"_remove",value:function(){this.session.keyStrokeManager.uninstallKeyStrokeContext(this.desktopKeyStrokeContext),lce(dce(o.prototype),"_remove",this).call(this),this.selectedButton&&this.selectedButton.remove()}},{key:"_renderProperties",value:function(){lce(dce(o.prototype),"_renderProperties",this).call(this),this._updateSelectedButton()}},{key:"setViewButtons",value:function(e){this.setProperty("viewButtons",e)}},{key:"_setViewButtons",value:function(e){this._setProperty("viewButtons",e),this.setVisible(this.viewButtons.length>0);var t=this._findSelectedViewButton();t?this.setSelectedButton(t):this.setSelectedButton(this.viewButtons[0]),this.setSelected(!!t)}},{key:"setSelectedButton",value:function(e){this.selectedButton&&this.selectedButton.cloneOf===e||e&&this.setProperty("selectedButton",e)}},{key:"_setSelectedButton",value:function(e){(e=e.clone({parent:this,displayStyle:"TAB"},{delegateEventsToOriginal:["acceptInput","action"],delegateAllPropertiesToClone:!0,delegateAllPropertiesToOriginal:!0,excludePropertiesToOriginal:["selected"]})).iconId=e.iconId||this.defaultIconId,this._setProperty("selectedButton",e)}},{key:"_renderSelectedButton",value:function(){this._updateSelectedButton()}},{key:"_updateSelectedButton",value:function(){this.selectedButton&&(this.viewTabVisible?this.selectedButton.rendered||(this.selectedButton.render(this.$container),this.invalidateLayoutTree()):this.selectedButton.rendered&&(this.selectedButton.remove(),this.invalidateLayoutTree()))}},{key:"setViewTabVisible",value:function(e){this.setProperty("viewTabVisible",e),this.rendered&&this._updateSelectedButton()}},{key:"_renderSelected",value:function(){this.$container.select(this.selected)}},{key:"_findSelectedViewButton",value:function(){for(var e,t=0;t<this.viewButtons.length;t++)if((e=this.viewButtons[t]).selected)return e;return null}},{key:"togglePopup",value:function(){this.popup?this._closePopup():this._openPopup()}},{key:"_openPopup",value:function(){if(!this.popup){var e=No.bounds(this.$container.parent(),!0);this.popup=O.create("ViewMenuPopup",{parent:this,$tab:this.dropdown.$container,viewMenus:this.viewButtons,naviBounds:e}),this.$container.addClass("popup-open"),this.popup.headText=this.text,this.popup.open(),this.popup.on("remove",function(e){this.$container.removeClass("popup-open"),this.popup=null}.bind(this))}}},{key:"_closePopup",value:function(){this.popup&&this.popup.close()}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"sendToBack",value:function(){this._closePopup()}},{key:"bringToFront",value:function(){}},{key:"onViewButtonSelected",value:function(){var e=this._findSelectedViewButton();e&&this.setSelectedButton(this._findSelectedViewButton()),this.setSelected(!!e),this._closePopup()}}])&&uce(t.prototype,n),i&&uce(t,i),o}(de);function yce(e){return(yce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bce(e,t,n){return(bce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wce(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function gce(e,t){return(gce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=wce(e);if(t){var r=wce(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _ce(this,n)}}function _ce(e,t){return!t||"object"!==yce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wce(e){return(wce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gce(e,t)}(o,e);var t,n,i,r=mce(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).nodeType=null,e.detailTable=null,e.detailTableVisible=!0,e.detailForm=null,e.detailFormVisible=!0,e.detailFormVisibleByUi=!0,e.navigateButtonsVisible=!0,e.detailFormType=null,e.tableStatusVisible=!0,e.drillDownOnRowClick=!1,e.overviewIconId=null,e}return t=o,(n=[{key:"createDetailForm",value:function(){return null}},{key:"_init",value:function(e){bce(wce(o.prototype),"_init",this).call(this,e),sn.resolveIconProperty(this,"overviewIconId"),this._internalInitTable(),this._internalInitDetailForm()}},{key:"_destroy",value:function(){bce(wce(o.prototype),"_destroy",this).call(this),this.detailTable&&this.detailTable.destroy(),this.detailForm&&this.detailForm.destroy()}},{key:"_internalInitTable",value:function(){var e=this.detailTable;e=e?this.getOutline()._createChild(e):this._createTable(),this.setDetailTable(e)}},{key:"_internalInitDetailForm",value:function(){var e=this.detailForm;e&&(e=this.getOutline()._createChild(e)),this.setDetailForm(e)}},{key:"_createTable",value:function(){return null}},{key:"_initTable",value:function(e){e.menuBar.setPosition(O_.Position.TOP),e.on("filter",this._onTableFilter.bind(this)),this.drillDownOnRowClick&&(e.on("rowClick",this._onTableRowClick.bind(this)),e.setMultiSelect(!1))}},{key:"_ensureDetailForm",value:function(){if(!this.detailForm){var e=this.createDetailForm();e&&!e.displayParent&&e.setDisplayParent(this.getOutline()),this.setDetailForm(e)}}},{key:"activate",value:function(){this._ensureDetailForm()}},{key:"deactivate",value:function(){}},{key:"getOutline",value:function(){return this.parent}},{key:"pagesForTableRows",value:function(e){return e.map(this.pageForTableRow)}},{key:"pageForTableRow",value:function(e){if(!e.page)throw new Error("Table-row is not linked to a page");return e.page}},{key:"setDetailForm",value:function(e){this.detailForm=e,this.detailForm&&this.detailForm.setModal(!1),this.detailForm instanceof scout.TileOverviewForm&&this.detailForm.setPage(this)}},{key:"setDetailTable",value:function(e){e&&(this._initTable(e),e.setTableStatusVisible(this.tableStatusVisible)),this.detailTable=e}},{key:"updatePagesFromTableRows",value:function(e){return e.map((function(e){var t=e.page;return t.updatePageFromTableRow(e),t}))}},{key:"updatePageFromTableRow",value:function(e){var t=e.page;return t.enabled=e.enabled,t.text=t.computeTextForRow(e),e.cells.length>=1&&(t.htmlEnabled=e.cells[0].htmlEnabled,t.cssClass=e.cells[0].cssClass),t}},{key:"computeTextForRow",value:function(e){var t="";return e.cells.length>=1&&(t=e.cells[0].text),t}},{key:"_pageParam",value:function(e){var t={parent:this.getOutline()};return s.a.extend(t,e),t}},{key:"reloadPage",value:function(){this.getOutline()&&this.loadChildren()}},{key:"linkWithRow",value:function(e){this.row=e,e.page=this,this.getOutline().trigger("pageRowLink",{page:this,row:e})}},{key:"unlinkWithRow",value:function(e){delete this.row,delete e.page}},{key:"_onTableFilter",value:function(e){this.getOutline().mediator.onTableFilter(e,this)}},{key:"_onTableRowClick",value:function(e){if(this.drillDownOnRowClick){var t=e.row,n=this.pageForTableRow(t);this.getOutline().selectNode(n),this.detailTable.deselectRow(t)}}}])&&vce(t.prototype,n),i&&vce(t,i),o}(XL);function Sce(e){return(Sce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Tce(e,t){return(Tce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Rce(e);if(t){var r=Rce(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Pce(this,n)}}function Pce(e,t){return!t||"object"!==Sce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rce(e){return(Rce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(kce,"NodeType",{NODES:"nodes",TABLE:"table"});var xce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tce(e,t)}(o,e);var t,n,i,r=Cce(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).nodeType=kce.NodeType.NODES,e}return t=o,(n=[{key:"_createTable",value:function(){var e=O.create("Column",{id:"NodeColumn",session:this.session}),t=O.create("Table",{parent:this.parent,id:"PageWithNodesTable",autoResizeColumns:!0,headerVisible:!1,columns:[e]});return t.menuBar.setPosition(O_.Position.TOP),t.on("rowAction",this._onDetailTableRowAction.bind(this)),t}},{key:"_onDetailTableRowAction",value:function(e){this.getOutline().mediator.onTableRowAction(e,this)}},{key:"_rebuildDetailTable",value:function(e){var t=this.detailTable;this._unlinkAllTableRows(t.rows),t.deleteAllRows();var n=this._createTableRowsForChildPages(e);t.insertRows(n)}},{key:"_unlinkAllTableRows",value:function(e){e.forEach((function(e){e.page&&e.page.unlinkWithRow(e)}))}},{key:"_createTableRowsForChildPages",value:function(e){return e.map((function(e){var t=O.create("TableRow",{parent:this.detailTable,cells:[e.text]});return e.linkWithRow(t),t}),this)}},{key:"loadChildren",value:function(){return this.childrenLoaded=!1,this._createChildPages().done(function(e){this._rebuildDetailTable(e),e.length>0&&this.getOutline().insertNodes(e,this),this.childrenLoaded=!0}.bind(this))}},{key:"_createChildPages",value:function(){return s.a.resolvedDeferred(this.childNodes)}}])&&Oce(t.prototype,n),i&&Oce(t,i),o}(kce);function Ece(e){return(Ece="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fce(e,t,n){return(Fce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mce(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ace(e,t){return(Ace=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Mce(e);if(t){var r=Mce(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jce(this,n)}}function jce(e,t){return!t||"object"!==Ece(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mce(e){return(Mce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ice=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ace(e,t)}(o,e);var t,n,i,r=$ce(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).nodeType=kce.NodeType.TABLE,e.alwaysCreateChildPage=!1,e}return t=o,(n=[{key:"_initTable",value:function(e){Fce(Mce(o.prototype),"_initTable",this).call(this,e),e.on("rowsDeleted allRowsDeleted",this._onTableRowsDeleted.bind(this)),e.on("rowsInserted",this._onTableRowsInserted.bind(this)),e.on("rowsUpdated",this._onTableRowsUpdated.bind(this)),e.on("rowAction",this._onTableRowAction.bind(this)),e.on("rowOrderChanged",this._onTableRowOrderChanged.bind(this)),e.on("reload",this.loadTableData.bind(this)),e.hasReloadHandler=!0}},{key:"_onTableRowsDeleted",value:function(e){if(!this.leaf){var t=et.ensure(e.rows),n=t.map((function(e){var t=e.page;return t.unlinkWithRow(e),t}),this);this.getOutline().mediator.onTableRowsDeleted(t,n,this)}}},{key:"_onTableRowsInserted",value:function(e){if(!this.leaf){var t=et.ensure(e.rows),n=t.map((function(e){return this._createChildPageInternal(e)}),this);this.getOutline().mediator.onTableRowsInserted(t,n,this)}}},{key:"_onTableRowsUpdated",value:function(e){this.getOutline().mediator.onTableRowsUpdated(e,this)}},{key:"_onTableRowAction",value:function(e){this.getOutline().mediator.onTableRowAction(e,this)}},{key:"_onTableRowOrderChanged",value:function(e){e.animating||this.getOutline().mediator.onTableRowOrderChanged(e,this)}},{key:"_createChildPageInternal",value:function(e){var t=this.createChildPage(e);return null===t&&this.alwaysCreateChildPage&&(t=this.createDefaultChildPage(e)),t.linkWithRow(e),t=t.updatePageFromTableRow(e)}},{key:"createChildPage",value:function(e){return null}},{key:"createDefaultChildPage",value:function(e){return O.create("AutoLeafPageWithNodes",{parent:this.getOutline(),row:e})}},{key:"loadChildren",value:function(){return this.detailTable?this.loadTableData():s.a.resolvedDeferred()}},{key:"_createSearchFilter",value:function(){var e=et.find(this.detailTable.tableControls,(function(e){return e.form}));return e?e.form.exportData():null}},{key:"loadTableData",value:function(){return this.detailTable.deleteAllRows(),this.detailTable.setLoading(!0),this._loadTableData(this._createSearchFilter()).then(this._onLoadTableDataDone.bind(this)).catch(this._onLoadTableDataFail.bind(this)).then(this._onLoadTableDataAlways.bind(this))}},{key:"_loadTableData",value:function(e){return s.a.resolvedDeferred()}},{key:"_onLoadTableDataDone",value:function(e){var t=this._transformTableDataToTableRows(e);t&&t.length>0&&this.detailTable.insertRows(t)}},{key:"_onLoadTableDataFail",value:function(e){this.detailTable.setTableStatus(pi.error({message:this.session.text("ErrorWhileLoadingData")})),s.a.log.error("Failed to load tableData. error=",e)}},{key:"_onLoadTableDataAlways",value:function(){this.childrenLoaded=!0,this.detailTable.setLoading(!1)}},{key:"_transformTableDataToTableRows",value:function(e){return e}}])&&Dce(t.prototype,n),i&&Dce(t,i),o}(kce);function Lce(e){return(Lce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nce(e,t,n){return(Nce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zce(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Hce(e,t){return(Hce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zce(e);if(t){var r=zce(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Wce(this,n)}}function Wce(e,t){return!t||"object"!==Lce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zce(e){return(zce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hce(e,t)}(o,e);var t,n,i,r=Vce(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).page=null,e}return t=o,(n=[{key:"_init",value:function(e){Nce(zce(o.prototype),"_init",this).call(this,e),this.label=this.page.text,this.iconId=this.page.overviewIconId,this.labelHtmlEnabled=this.page.htmlEnabled,this.on("click",function(e){this.outline.selectNode(this.page)}.bind(this))}},{key:"notifyPageChanged",value:function(){this.setLabel(this.page.text),this.setIconId(this.page.overviewIconId),this.setLabelHtmlEnabled(this.page.htmlEnabled)}}])&&Bce(t.prototype,n),i&&Bce(t,i),o}(Yre);function Uce(e){return(Uce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kce(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qce(e,t,n){return(qce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qce(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Yce(e,t){return(Yce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Qce(e);if(t){var r=Qce(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Jce(this,n)}}function Jce(e,t){return!t||"object"!==Uce(t)&&"function"!=typeof t?Zce(e):t}function Zce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qce(e){return(Qce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var efe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yce(e,t)}(o,e);var t,n,i,r=Xce(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).outline=null,e.page=null,e.nodes=null,e.withPlaceholders=!0,e.scrollable=!1,e.renderAnimationEnabled=!0,e.startupAnimationEnabled=!0,e._outlineNodeChangedHandler=e._onOutlineNodeChanged.bind(Zce(e)),e._outlineStructureChangedHandler=e._onOutlineStructureChanged.bind(Zce(e)),e}return t=o,(n=[{key:"_init",value:function(e){qce(Qce(o.prototype),"_init",this).call(this,e),this.nodes=this.nodes||this.page&&this.page.childNodes||this.outline&&this.outline.nodes,this.setOutline(this.outline),this.setPage(this.page),this.setNodes(this.nodes)}},{key:"_destroy",value:function(){this.setOutline(null),this.setPage(null),this.setNodes(null),qce(Qce(o.prototype),"_destroy",this).call(this)}},{key:"_createKeyStrokeContext",value:function(){return new Ou}},{key:"_initKeyStrokeContext",value:function(){qce(Qce(o.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.$bindTarget=this.session.$entryPoint,this.keyStrokeContext.registerKeyStroke([new lfe(this)])}},{key:"setOutline",value:function(e){this.outline&&(this.outline.off("nodeChanged pageChanged",this._outlineNodeChangedHandler),this.outline.off("nodesDeleted",this._outlineStructureChangedHandler),this.outline.off("nodesInserted",this._outlineStructureChangedHandler),this.outline.off("allChildNodesDeleted",this._outlineStructureChangedHandler),this.outline.off("childNodeOrderChanged",this._outlineStructureChangedHandler)),this._setProperty("outline",e),this.outline&&(this.outline.on("nodeChanged pageChanged",this._outlineNodeChangedHandler),this.outline.on("nodesDeleted",this._outlineStructureChangedHandler),this.outline.on("nodesInserted",this._outlineStructureChangedHandler),this.outline.on("allChildNodesDeleted",this._outlineStructureChangedHandler),this.outline.on("childNodeOrderChanged",this._outlineStructureChangedHandler))}},{key:"setPage",value:function(e){this._setProperty("page",e)}},{key:"setNodes",value:function(e){this._setProperty("nodes",e),this._rebuild()}},{key:"_createPageTiles",value:function(e){return(e||[]).map((function(e){return this._createPageTile(e)}),this)}},{key:"_createPageTile",value:function(e){var t=O.create("PageTileButton",{parent:this,outline:this.outline,page:e}),n=O.create("FormFieldTile",{parent:this,colorScheme:"default-inverted",tileWidget:t});return e.tile=n,n}},{key:"_rebuild",value:function(){this.setTiles(this._createPageTiles(this.nodes))}},{key:"_onOutlineNodeChanged",value:function(e){var t=(e.node||e.page).tile;t&&t.tileWidget.notifyPageChanged()}},{key:"_onOutlineStructureChanged",value:function(e){this.page?this.page===e.parentNode&&this.setNodes(this.page.childNodes):(e.nodes&&e.nodes.some((function(e){return!e.parentNode}))||"allChildNodesDeleted"===e.type)&&this.setNodes(this.outline.nodes)}}])&&Kce(t.prototype,n),i&&Kce(t,i),o}(rte);function tfe(e){return(tfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nfe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ife(e,t,n){return(ife="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ufe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function rfe(e,t){return(rfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ofe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ufe(e);if(t){var r=ufe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sfe(this,n)}}function sfe(e,t){return!t||"object"!==tfe(t)&&"function"!=typeof t?afe(e):t}function afe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ufe(e){return(ufe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rfe(e,t)}(o,e);var t,n,i,r=ofe(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).field=e,t.registerRange(pu[1],function(){return pu[Math.min(this._tiles().length,9)]}.bind(afe(t))),t.renderingHints.$drawingArea=function(e,t){var n=t.which-pu[1],i=this._tiles();return n<i.length&&i[n].tileWidget instanceof Yre?i[n].tileWidget.$fieldContainer:null}.bind(afe(t)),t}return t=o,(n=[{key:"_accept",value:function(e){if(!ife(ufe(o.prototype),"_accept",this).call(this,e))return!1;var t=pu.codesToKeys[e.which]-1,n=this._tiles();return!!(t<n.length&&n[t].tileWidget instanceof Yre&&(e._$element=n[t].$container,e._$element))}},{key:"handle",value:function(e){e._$element.data("widget").tileWidget.doAction()}},{key:"_tiles",value:function(){return this.field.tiles}}])&&nfe(t.prototype,n),i&&nfe(t,i),o}(Hu);function cfe(e){return(cfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ffe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hfe(e,t,n){return(hfe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vfe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function dfe(e,t){return(dfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=vfe(e);if(t){var r=vfe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return yfe(this,n)}}function yfe(e,t){return!t||"object"!==cfe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vfe(e){return(vfe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dfe(e,t)}(o,e);var t,n,i,r=pfe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).leaf=!0,e}return t=o,(n=[{key:"_init",value:function(e){O.assertParameter("row",e.row,uR),hfe(vfe(o.prototype),"_init",this).call(this,e),this.text=this.row.cells[0].text}}])&&ffe(t.prototype,n),i&&ffe(t,i),o}(kce);function gfe(e){return(gfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mfe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _fe(e,t,n){return(_fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Tfe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function wfe(e,t){return(wfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Tfe(e);if(t){var r=Tfe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Sfe(this,n)}}function Sfe(e,t){return!t||"object"!==gfe(t)&&"function"!=typeof t?Ofe(e):t}function Ofe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tfe(e){return(Tfe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wfe(e,t)}(o,e);var t,n,i,r=kfe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).view=null,e.title=null,e.subTitle=null,e.iconId=null,e.cssClass=null,e.closable=!1,e.saveNeeded=!1,e.saveNeededVisible=!1,e.status=null,e.selected=!1,e.$title=null,e.$subTitle=null,e.$iconContainer=null,e.$statusContainer=null,e._statusContainerUsageCounter=0,e._statusIconDivs=[],e._viewPropertyChangeListener=e._onViewPropertyChange.bind(Ofe(e)),e._viewRemoveListener=e._onViewRemove.bind(Ofe(e)),e._glassPaneContribution=function(e){return this.$statusContainer}.bind(Ofe(e)),e}return t=o,(n=[{key:"_init",value:function(e){_fe(Tfe(o.prototype),"_init",this).call(this,e),this.view=e.view,this.title=this.view?this.view.title:e.title,this.subTitle=this.view?this.view.subTitle:e.subTitle,this.iconId=this.view?this.view.iconId:e.iconId,this.cssClass=this.view?this.view.cssClass:e.cssClass,this.closable=this.view?this.view.closable:e.closable,this.saveNeeded=this.view?this.view.saveNeeded:e.saveNeeded,this.saveNeededVisible=this.view?this.view.saveNeededVisible:e.saveNeededVisible,this.status=this.view?this.view.status:e.status,this.view&&(this._installViewListeners(),this.view.addGlassPaneContribution(this._glassPaneContribution))}},{key:"renderAfter",value:function(e,t){this.render(e),t&&this.$container.insertAfter(t.$container)}},{key:"_render",value:function(){this.$container=this.$parent.prependDiv("simple-tab"),this.$container.on("mousedown",this._onMouseDown.bind(this))}},{key:"_renderProperties",value:function(){_fe(Tfe(o.prototype),"_renderProperties",this).call(this),this._renderTitle(),this._renderSubTitle(),this._renderIconId(),this._renderCssClass(),this._renderClosable(),this._renderSaveNeeded(),this._renderStatus(),this._renderSelected()}},{key:"_remove",value:function(){this._remove$Title(),this._remove$SubTitle(),this._remove$IconContainer(),this._remove$StatusContainer(),this.$close=null,_fe(Tfe(o.prototype),"_remove",this).call(this)}},{key:"_getOrCreate$Title",value:function(){return this.$title||(this.$title=this.$container.makeDiv("title"),dh.installForEllipsis(this.$title,{parent:this}),this.$subTitle?this.$title.insertBefore(this.$subTitle):this.$iconContainer?this.$title.insertAfter(this.$iconContainer):this.$statusContainer?this.$title.insertAfter(this.$statusContainer):this.$title.appendTo(this.$container)),this.$title}},{key:"_getOrCreate$SubTitle",value:function(){return this.$subTitle||(this.$subTitle=this.$container.makeDiv("sub-title"),dh.installForEllipsis(this.$subTitle,{parent:this}),this.$title?this.$subTitle.insertAfter(this.$title):this.$iconContainer?this.$subTitle.insertAfter(this.$iconContainer):this.$statusContainer?this.$subTitle.insertAfter(this.$statusContainer):this.$subTitle.appendTo(this.$container)),this.$subTitle}},{key:"_getOrCreate$IconContainer",value:function(){return this.$iconContainer||(this.$iconContainer=this.$container.makeDiv("icon-container"),this.$title?this.$iconContainer.insertBefore(this.$title):this.$subTitle?this.$iconContainer.insertBefore(this.$subTitle):this.$statusContainer?this.$iconContainer.insertAfter(this.$statusContainer):this.$iconContainer.appendTo(this.$container)),this.$iconContainer}},{key:"_getOrCreate$StatusContainer",value:function(){return this.$statusContainer||(this.$statusContainer=this.$container.prependDiv("status-container")),this.$statusContainer}},{key:"_remove$Title",value:function(){this.$title&&(dh.uninstall(this.$title),this.$title.remove(),this.$title=null)}},{key:"_remove$SubTitle",value:function(){this.$subTitle&&(dh.uninstall(this.$subTitle),this.$subTitle.remove(),this.$subTitle=null)}},{key:"_remove$IconContainer",value:function(){this.$iconContainer&&(this.$iconContainer.remove(),this.$iconContainer=null)}},{key:"_remove$StatusContainer",value:function(){this.$statusContainer&&(this.$statusContainer.remove(),this.$statusContainer=null)}},{key:"setTitle",value:function(e){this.setProperty("title",e)}},{key:"_renderTitle",value:function(){this.title||this.subTitle?this._getOrCreate$Title().textOrNbsp(this.title):this._remove$Title()}},{key:"setSubTitle",value:function(e){this.setProperty("subTitle",e)}},{key:"_renderSubTitle",value:function(){this.subTitle?(this.title||this._renderTitle(),this._getOrCreate$SubTitle().textOrNbsp(this.subTitle)):(this.title||this._renderTitle(),this._remove$SubTitle())}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(e){this.iconId?this._getOrCreate$IconContainer().icon(this.iconId):this._remove$IconContainer()}},{key:"setClosable",value:function(e){this.setProperty("closable",e)}},{key:"_renderClosable",value:function(){if(this.closable){if(this.$close)return;this.$container.addClass("closable"),this.$close=this._getOrCreate$StatusContainer().appendDiv("status closer").on("click",this._onClose.bind(this)),this._statusContainerUsageCounter++}else{if(!this.$close)return;this.$container.removeClass("closable"),this.$close.remove(),this.$close=null,this._statusContainerUsageCounter--,0===this._statusContainerUsageCounter&&this._remove$StatusContainer()}}},{key:"setSaveNeededVisible",value:function(e){this.saveNeededVisible!==e&&(this._setProperty("saveNeededVisible",e),this.rendered&&this._renderSaveNeeded())}},{key:"setSaveNeeded",value:function(e){this.saveNeeded!==e&&(this._setProperty("saveNeeded",e),this.rendered&&this._renderSaveNeeded())}},{key:"_renderSaveNeeded",value:function(){if(this.saveNeeded&&this.saveNeededVisible){if(this.$container.addClass("save-needed"),this.$saveNeeded)return;this.$saveNeeded=this._getOrCreate$StatusContainer().prependDiv("status save-needer"),this._statusContainerUsageCounter++}else{if(!this.$saveNeeded)return;this.$container.removeClass("save-needed"),this.$saveNeeded.remove(),this.$saveNeeded=null,this._statusContainerUsageCounter--,0===this._statusContainerUsageCounter&&this._remove$StatusContainer()}}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"_renderStatus",value:function(){this._statusContainerUsageCounter-=0===this._statusIconDivs.length?0:1,this._statusIconDivs.forEach((function(e){e.remove()})),this._statusIconDivs=[],this.status&&this.status.asFlatList().forEach(function(e){if(e&&e.iconId){var t=this._getOrCreate$StatusContainer().appendIcon(e.iconId,"status");e.cssClass()&&t.addClass(e.cssClass()),this._statusIconDivs.push(t)}}.bind(this)),this._statusContainerUsageCounter+=0===this._statusIconDivs.length?0:1,0===this._statusContainerUsageCounter&&this._remove$StatusContainer()}},{key:"select",value:function(){this.setSelected(!0)}},{key:"deselect",value:function(){this.setSelected(!1)}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.select(this.selected)}},{key:"_onMouseDown",value:function(e){this.trigger("click"),this.$title&&(dh.cancel(this.$title),dh.close(this.$title)),this.$subTitle&&(dh.cancel(this.$subTitle),dh.close(this.$subTitle)),e.preventDefault()}},{key:"_onClose",value:function(){this.view&&this.view.abort()}},{key:"getMenuText",value:function(){return En.join(" – ",this.title,this.subTitle)}},{key:"_installViewListeners",value:function(){this.view.on("propertyChange",this._viewPropertyChangeListener),this.view.on("remove",this._viewRemoveListener)}},{key:"_uninstallViewListeners",value:function(){this.view.off("propertyChange",this._viewPropertyChangeListener),this.view.off("remove",this._viewRemoveListener)}},{key:"_onViewPropertyChange",value:function(e){"title"===e.propertyName?this.setTitle(this.view.title):"subTitle"===e.propertyName?this.setSubTitle(this.view.subTitle):"iconId"===e.propertyName?this.setIconId(this.view.iconId):"cssClass"===e.propertyName?this.setCssClass(e.newValue):"saveNeeded"===e.propertyName?this.setSaveNeeded(e.newValue):"saveNeededVisible"===e.propertyName?this.setSaveNeededVisible(e.newValue):"closable"===e.propertyName?this.setClosable(e.newValue):"status"===e.propertyName&&this.setStatus(e.newValue)}},{key:"_onViewRemove",value:function(){this._uninstallViewListeners(),this.rendered?this.remove():this.trigger("remove")}}])&&mfe(t.prototype,n),i&&mfe(t,i),o}(de);function Pfe(e){return(Pfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rfe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xfe(e,t,n){return(xfe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Afe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Efe(e,t){return(Efe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Afe(e);if(t){var r=Afe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ffe(this,n)}}function Ffe(e,t){return!t||"object"!==Pfe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Afe(e){return(Afe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Efe(e,t)}(o,e);var t,n,i,r=Dfe(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_render",value:function(){xfe(Afe(o.prototype),"_render",this).call(this),this.$container.addClass("desktop-tab"),this.$container.on("contextmenu",this._onContextMenu.bind(this))}},{key:"_onContextMenu",value:function(e){var t=O.create("Menu",{parent:this,text:this.session.text("ui.CloseAllTabs")});t.on("action",this._onCloseAll.bind(this));var n=O.create("Menu",{parent:this,text:this.session.text("ui.CloseOtherTabs"),enabled:this.parent.tabs.length>1});n.on("action",this._onCloseOther.bind(this)),O.create("ContextMenuPopup",{parent:this,menuItems:[t,n],cloneMenuItems:!1,location:{x:e.pageX,y:e.pageY}}).open()}},{key:"_onCloseAll",value:function(){var e=this.parent.tabs.map((function(e){return e.view}));this.session.desktop.cancelViews(e)}},{key:"_onCloseOther",value:function(){var e=this.parent.tabs.map((function(e){return e.view}));et.remove(e,this.view),this.session.desktop.cancelViews(e)}}])&&Rfe(t.prototype,n),i&&Rfe(t,i),o}(Cfe);function jfe(e){return(jfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mfe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ife(e,t,n){return(Ife="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Hfe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Lfe(e,t){return(Lfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Hfe(e);if(t){var r=Hfe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Nfe(this,n)}}function Nfe(e,t){return!t||"object"!==jfe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hfe(e){return(Hfe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lfe(e,t)}(o,e);var t,n,i,r=Bfe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).tabs=[],e._selectedViewTab=null,e}return t=o,(n=[{key:"_init",value:function(e){Ife(Hfe(o.prototype),"_init",this).call(this,e),this._tabClickHandler=this._onTabClick.bind(this)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("simple-tab-area"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new Xfe(this))}},{key:"_renderProperties",value:function(){Ife(Hfe(o.prototype),"_renderProperties",this).call(this),this._renderTabs()}},{key:"_renderTabs",value:function(){this.tabs.slice().reverse().forEach(function(e){this._renderTab(e)}.bind(this))}},{key:"_renderTab",value:function(e){e.renderAfter(this.$container)}},{key:"_renderVisible",value:function(){this.visible&&this.tabs.length>0?this.attach():this.detach(),this.invalidateLayoutTree()}},{key:"_attach",value:function(){this.$parent.prepend(this.$container),this.invalidateLayoutTree(!1),Ife(Hfe(o.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.$container.detach(),Ife(Hfe(o.prototype),"_detach",this).call(this),this.invalidateLayoutTree(!1)}},{key:"_onTabClick",value:function(e){this.selectTab(e.source)}},{key:"getTabs",value:function(){return this.tabs}},{key:"selectTab",value:function(e){this._selectedViewTab!==e&&(this.deselectTab(this._selectedViewTab),this._selectedViewTab=e,e&&e.select(),this.trigger("tabSelect",{viewTab:e}),e&&e.rendered&&!e.$container.isVisible()&&this.invalidateLayoutTree())}},{key:"deselectTab",value:function(e){e&&this._selectedViewTab===e&&this._selectedViewTab.deselect()}},{key:"getSelectedTab",value:function(){return this._selectedViewTab}},{key:"addTab",value:function(e,t){var n=-1;t&&(n=this.tabs.indexOf(t)),this.tabs.splice(n+1,0,e),e.on("click",this._tabClickHandler),this.rendered&&(this._renderVisible(),e.renderAfter(this.$container,t),this.invalidateLayoutTree())}},{key:"destroyTab",value:function(e){var t=this.tabs.indexOf(e);t>-1&&(this.tabs.splice(t,1),e.destroy(),e.off("click",this._tabClickHandler),this._renderVisible(),this.invalidateLayoutTree())}}])&&Mfe(t.prototype,n),i&&Mfe(t,i),o}(de);function Wfe(e){return(Wfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zfe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Gfe(e,t){return(Gfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ufe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=qfe(e);if(t){var r=qfe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Kfe(this,n)}}function Kfe(e,t){return!t||"object"!==Wfe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qfe(e){return(qfe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yfe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gfe(e,t)}(o,e);var t,n,i,r=Ufe(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tabArea=e,t._$overflowTab=null,t._overflowTabsIndizes=[],t}return t=o,(n=[{key:"layout",value:function(e){var t,n=this.tabArea.htmlComp,i=n.size({exact:!0}),r=n.$comp.find(".simple-tab"),a=this.tabArea.getTabs().length,u=this.smallPrefSize();if(i=i.subtract(n.insets()),this._$overflowTab&&this._$overflowTab.remove(),r.setVisible(!0),this._overflowTabsIndizes=[],u.width<=i.width)return t=Math.min(o.TAB_WIDTH_LARGE,i.width/a),void r.each((function(){s()(this).outerWidth(t)}));i.width-=o.OVERFLOW_MENU_WIDTH;var l=Math.floor(i.width/o.TAB_WIDTH_SMALL),c=a-l,f=0,h=0;r.each((function(){s()(this).hasClass("selected")&&(h=f),f++}));var d,p=h-Math.floor(l/2);p<0?(p=0,d=l-1):(d=p+l-1)>a-1&&(p=(d=a-1)-l+1),this._$overflowTab=n.$comp.appendDiv("simple-overflow-tab-item").on("mousedown",this._onMouseDownOverflow.bind(this)),this._$overflowTab.appendDiv("num-tabs").text(c);var y=this;t=o.TAB_WIDTH_SMALL,f=0,r.each((function(){f>=p&&f<=d?s()(this).outerWidth(t):(s()(this).setVisible(!1),y._overflowTabsIndizes.push(f)),f++}))}},{key:"smallPrefSize",value:function(){var e=this.tabArea.getTabs().length;return new Co(e*o.TAB_WIDTH_SMALL,this.tabArea.htmlComp.$comp.outerHeight(!0))}},{key:"preferredLayoutSize",value:function(e){var t=this.tabArea.getTabs().length;return new Co(t*o.TAB_WIDTH_LARGE,No.prefSize(this.tabArea.htmlComp.$comp,{includeMargin:!0,useCssSize:!0}).height)}},{key:"_onMouseDownOverflow",value:function(e){var t,n,i=this.tabArea,r=[];this._overflowTabsIndizes.forEach((function(e){n=this.tabArea.getTabs()[e],(t=O.create("Menu",{parent:this.tabArea,text:n.getMenuText(),tab:n})).on("action",function(){s.a.log.isDebugEnabled()&&s.a.log.debug("(SimpleTabAreaLayout#_onMouseDownOverflow) tab="+this),i.selectTab(this)}.bind(n)),r.push(t)}),this),O.create("ContextMenuPopup",{parent:this.tabArea,menuItems:r,cloneMenuItems:!1,location:{x:e.pageX,y:e.pageY}}).open()}}])&&zfe(t.prototype,n),i&&zfe(t,i),o}(zo);function Jfe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Yfe(Xfe,"TAB_WIDTH_LARGE",220),Yfe(Xfe,"TAB_WIDTH_SMALL",130),Yfe(Xfe,"OVERFLOW_MENU_WIDTH",30);var Zfe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"accept",value:function(e){return!e.parentNode||!!e.parentNode.filterAccepted&&(!e.parentNode.detailTable||!e.row||e.row.filterAccepted)}}])&&Jfe(t.prototype,n),i&&Jfe(t,i),e}();function Qfe(e){return(Qfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ehe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function the(e,t,n){return(the="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=she(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function nhe(e,t){return(nhe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ihe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=she(e);if(t){var r=she(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rhe(this,n)}}function rhe(e,t){return!t||"object"!==Qfe(t)&&"function"!=typeof t?ohe(e):t}function ohe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function she(e){return(she=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ahe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nhe(e,t)}(o,e);var t,n,i,r=ihe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).compact=!1,e.defaultDetailForm=null,e.embedDetailContent=!1,e.inBackground=!1,e.mediator=null,e.navigateButtonsVisible=!0,e.navigateUpInProgress=!1,e.outlineOverview=null,e.outlineOverviewVisible=!0,e.toggleBreadcrumbStyleEnabled=!0,e.titleVisible=!0,e.menus=[],e.titleMenuBar=null,e.nodeMenuBar=null,e.nodeMenuBarVisible=!1,e.detailMenuBar=null,e.detailMenuBarVisible=!1,e.dialogs=[],e.views=[],e.messageBoxes=[],e.fileChoosers=[],e.formController=null,e.messageBoxController=null,e.fileChooserController=null,e._detailContentDestroyHandler=e._onDetailContentDestroy.bind(ohe(e)),e._detailMenusNodesSelectedHandler=null,e._additionalContainerClasses+=" outline",e.nodePaddingLevelCheckable=20,e.nodePaddingLevelNotCheckable=20,e._scrolldirections="y",e._addWidgetProperties(["defaultDetailForm","views","selectedViewTabs","dialogs","messageBoxes","fileChoosers"]),e}return t=o,(n=[{key:"_init",value:function(e){this.addFilter(new Zfe,!0),the(she(o.prototype),"_init",this).call(this,e),this.mediator=this._createMediator(),this.formController=O.create("FormController",{displayParent:this,session:this.session}),this.messageBoxController=new bz(this,this.session),this.fileChooserController=new ES(this,this.session),this.resolveTextKeys(["title"]),this.titleMenuBar=O.create("MenuBar",{parent:this,menuOrder:new xY}),this.nodeMenuBar=O.create("MenuBar",{parent:this,position:O_.Position.BOTTOM,menuOrder:new xY}),this.detailMenuBar=O.create("MenuBar",{parent:this,position:O_.Position.BOTTOM,menuOrder:new xY}),this._setDefaultDetailForm(this.defaultDetailForm),this._setOutlineOverviewVisible(this.outlineOverviewVisible),this._setOutlineOverview(this.outlineOverview),this._updateOutlineOverview(),this._setViews(this.views),this._setMenus(this.menus),this.updateDetailContent()}},{key:"_createMediator",value:function(){return O.create("OutlineMediator")}},{key:"_createTreeNode",value:function(e){var t=s.a.extend({objectType:"Page"},e);return this._createChild(t)}},{key:"_applyNodeDefaultValues",value:function(e){Pt.applyTo(e,"Page")}},{key:"_createKeyStrokeContext",value:function(){return new cpe(this)}},{key:"_filterMenus",value:function(e,t,n,i){return[]}},{key:"_initTreeKeyStrokeContext",value:function(){var e=gu.CTRL|gu.SHIFT;this.keyStrokeContext.registerKeyStroke([new DB(this,e),new BB(this,e),new gpe(this,e),new KB(this,e),new lN(this,e),new gN(this,e)]),this.keyStrokeContext.$bindTarget=function(){return this.session.$entryPoint}.bind(this)}},{key:"_render",value:function(){the(she(o.prototype),"_render",this).call(this),this.htmlComp.setLayout(new Che(this)),this._renderCompact(),this._renderEmbedDetailContent(),this._renderDetailContent(),this._renderDetailMenuBarVisible(),this._renderNodeMenuBarVisible()}},{key:"_renderProperties",value:function(){the(she(o.prototype),"_renderProperties",this).call(this),this._renderTitle(),this._updateIcon(),this._renderTitleMenuBar()}},{key:"_computeNodePaddingLeft",value:function(e){return this._computeNodePaddings(),this.compact?e.row&&e.getOutline().selectedNode()!==e?e.row._hierarchyLevel*this.nodePaddingLevel:0:the(she(o.prototype),"_computeNodePaddingLeft",this).call(this,e)}},{key:"_remove",value:function(){the(she(o.prototype),"_remove",this).call(this),this._removeTitle(),this._removeIcon()}},{key:"_renderTitle",value:function(){this.titleVisible&&(this.$title||(this.$title=this.$container.prependDiv("outline-title").on("mousedown",this._onTitleMouseDown.bind(this)).toggleClass("touch",Mt.get().supportsOnlyTouch()),this.$titleText=this.$title.prependDiv("outline-title-text")),this.$titleText.text(this.title))}},{key:"_removeTitle",value:function(){this.titleVisible&&(this.$title.remove(),this.$title=null)}},{key:"setIconVisible",value:function(e){this.setProperty("iconVisible",e),this.rendered&&this._updateIcon()}},{key:"setIconId",value:function(e){this.setProperty("iconId",e),this.rendered&&this._updateIcon()}},{key:"_updateIcon",value:function(){if(this.titleVisible&&this.iconVisible&&this.iconId){if(this.icon)return void this.icon.setIconDesc(this.iconId);this.icon=O.create("Icon",{parent:this,iconDesc:this.iconId,prepend:!0}),this.icon.render(this.$title)}else{if(!this.icon)return;this.icon.remove(),this.icon=null}}},{key:"_removeIcon",value:function(){this.icon&&(this.icon.remove(),this.icon=null)}},{key:"_renderTitleMenuBar",value:function(){this.titleVisible&&(this.titleMenuBar.render(this.$title),this.titleMenuBar.$container.addClass("prevent-initial-focus"))}},{key:"_renderEnabled",value:function(){the(she(o.prototype),"_renderEnabled",this).call(this),this.$container.setTabbable(!1)}},{key:"_initTreeNodeInternal",value:function(e,t){the(she(o.prototype),"_initTreeNodeInternal",this).call(this,e,t),this._initDetailTableAndForm(e),this.trigger("pageInit",{page:e})}},{key:"_initDetailTableAndForm",value:function(e){e.detailTable&&this._initDetailTable(e),e.detailForm&&this._initDetailForm(e)}},{key:"_initDetailTable",value:function(e){this.navigateButtonsVisible&&e.navigateButtonsVisible&&this._appendNavigateButtonsForDetailTable(e)}},{key:"_initDetailForm",value:function(e){this.navigateButtonsVisible&&e.navigateButtonsVisible&&this._appendNavigateButtonsForDetailForm(e),e.detailForm.detailForm=!0,e.detailForm.one("destroy",function(){e.detailForm=null,this._triggerPageChanged(e)}.bind(this))}},{key:"_decorateNode",value:function(e){the(she(o.prototype),"_decorateNode",this).call(this,e),this.session.inspector&&an.applyInfo(e,e.$node)}},{key:"_createNavigateButtons",value:function(e,t){var n=et.ensure(t.staticMenus);if(!this._hasMenu(n,npe)){var i=O.create("NavigateUpButton",{parent:t,altKeyStrokeContext:t.keyStrokeContext,outline:this,node:e});n.push(i)}if(!this._hasMenu(n,qde)){var r=O.create("NavigateDownButton",{parent:t,altKeyStrokeContext:t.keyStrokeContext,outline:this,node:e});n.push(r)}return n}},{key:"_getMenu",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n]instanceof t)return e[n];return null}},{key:"_hasMenu",value:function(e,t){return null!==this._getMenu(e,t)}},{key:"_onTitleMouseDown",value:function(e){this.titleMenuBar.rendered&&this.titleMenuBar.$container.isOrHas(e.target)||this.navigateToTop()}},{key:"navigateToTop",value:function(){this.deselectAll(),this.handleInitialExpanded(),this.setScrollTop(0)}},{key:"handleInitialExpanded",value:function(){this.visitNodes(function(e){this.setNodeExpanded(e,e.initialExpanded,{renderExpansion:!0})}.bind(this))}},{key:"_onNodeDeleted",value:function(e){e.detailTable&&(e.detailTable.destroy(),e.detailTable=null)}},{key:"selectNodes",value:function(e,t){(e=et.ensure(e)).length>0&&this.isNodeSelected(e[0])||0===e.length&&0===this.selectedNodes.length||(this.navigateUpInProgress?this.navigateUpInProgress=!1:1===e.length&&this.setDetailFormVisibleByUi(e[0],!0),the(she(o.prototype),"selectNodes",this).call(this,e,t))}},{key:"_setSelectedNodes",value:function(e,t){the(she(o.prototype),"_setSelectedNodes",this).call(this,e,t),this.updateDetailContent()}},{key:"_nodesSelectedInternal",value:function(){var e=this.activePage();e&&(e.activate(),e.ensureLoadChildren().done(this._onLoadChildrenDone.bind(this,e)))}},{key:"_renderSelection",value:function(){the(she(o.prototype),"_renderSelection",this).call(this),this.$container.toggleClass("node-selected",this.selectedNodes.length>0)}},{key:"setDefaultDetailForm",value:function(e){this.setProperty("defaultDetailForm",e),this._updateOutlineOverview()}},{key:"_setDefaultDetailForm",value:function(e){this.defaultDetailForm&&(this.defaultDetailForm.detailForm=!1),this._setProperty("defaultDetailForm",e),this.defaultDetailForm&&(this.defaultDetailForm.detailForm=!0)}},{key:"setOutlineOverviewVisible",value:function(e){this.setProperty("outlineOverviewVisible",e),this._updateOutlineOverview()}},{key:"_setOutlineOverviewVisible",value:function(e){this._setProperty("outlineOverviewVisible",e)}},{key:"setOutlineOverview",value:function(e){this.setProperty("outlineOverview",e),this._updateOutlineOverview()}},{key:"_setOutlineOverview",value:function(e){e&&(e=this._createChild(e)),this._setProperty("outlineOverview",e)}},{key:"_updateOutlineOverview",value:function(){this.defaultDetailForm?this.outlineOverview&&(this.outlineOverview.destroy(),this._setOutlineOverview(null)):this.outlineOverviewVisible?this.outlineOverview||this._setOutlineOverview(this._createOutlineOverview()):this.outlineOverview&&(this.outlineOverview.destroy(),this._setOutlineOverview(null))}},{key:"_createOutlineOverview",value:function(){return O.create("TileOutlineOverview",{parent:this,outline:this})}},{key:"setNavigateButtonsVisible",value:function(e){this.setProperty("navigateButtonsVisible",e)}},{key:"_setNavigateButtonsVisible",value:function(e){this._setProperty("navigateButtonsVisible",e),this.visitNodes(this._setNavigateButtonsVisibleForNode.bind(this))}},{key:"_setNavigateButtonsVisibleForNode",value:function(e,t){this.navigateButtonsVisible?(e.detailForm&&this._appendNavigateButtonsForDetailForm(e),e.detailTable&&this._appendNavigateButtonsForDetailTable(e)):(e.detailForm&&this._removeNavigateButtonsForDetailForm(e),e.detailTable&&this._removeNavigateButtonsForDetailTable(e))}},{key:"_appendNavigateButtonsForDetailForm",value:function(e){var t=this._createNavigateButtons(e,e.detailForm.rootGroupBox);e.detailForm.rootGroupBox.setStaticMenus(t)}},{key:"_appendNavigateButtonsForDetailTable",value:function(e){var t=this._createNavigateButtons(e,e.detailTable);e.detailTable.setStaticMenus(t)}},{key:"_removeNavigateButtonsForDetailForm",value:function(e){var t=e.detailForm.rootGroupBox.staticMenus.filter((function(e){return!(e instanceof Bde)}));e.detailForm.rootGroupBox.setStaticMenus(t)}},{key:"_removeNavigateButtonsForDetailTable",value:function(e){var t=e.detailTable.staticMenus.filter((function(e){return!(e instanceof Bde)}));e.detailTable.setStaticMenus(t)}},{key:"selectedRow",value:function(){var e=this.selectedNode();return e&&e.detailTable?e.detailTable.selectedRow():null}},{key:"_isGroupingEnd",value:function(e){return e.nodeType===kce.NodeType.TABLE}},{key:"_isTruncatedNodeTooltipEnabled",value:function(){return!1}},{key:"setDetailFormVisibleByUi",value:function(e,t){e.detailFormVisibleByUi=t,this._triggerPageChanged(e)}},{key:"validateFocus",value:function(){this.session.focusManager.validateFocus()}},{key:"sendToBack",value:function(){this.inBackground=!0,this._renderInBackground(),this.formController.detachDialogs(),this.messageBoxController.detach(),this.fileChooserController.detach()}},{key:"bringToFront",value:function(){this.inBackground=!1,this._renderInBackground(),this.formController.attachDialogs(),this.messageBoxController.attach(),this.fileChooserController.attach()}},{key:"_renderInBackground",value:function(){this.$container.toggleClass("in-background",this.inBackground)}},{key:"_renderCompact",value:function(){this.$container.toggleClass("compact",this.compact),this.invalidateLayoutTree()}},{key:"_renderEmbedDetailContent",value:function(){this.$data.toggleClass("has-detail-content",this.embedDetailContent),this.invalidateLayoutTree()}},{key:"_renderDetailContent",value:function(){if(this.detailContent&&!this.detailContent.rendered){var e=this.selectedNode();e.rendered&&(this.detailContent.render(e.$node),this.detailContent.htmlComp&&(this.detailContent.htmlComp.validateRoot=!1),this._ensurePageLayout(e),this.$data.addClass("detail-content-visible"))}}},{key:"_ensurePageLayout",value:function(e){e.htmlComp=Uo.install(e.$node,this.session),e.htmlComp.setLayout(new ade(this,e))}},{key:"_removeDetailContent",value:function(){this.detailContent&&(this.detailContent.remove(),this.$data.removeClass("detail-content-visible"))}},{key:"_postRenderViewRange",value:function(){the(she(o.prototype),"_postRenderViewRange",this).call(this),this._renderDetailContent(),this._renderDetailMenuBarVisible(),this._renderNodeMenuBarVisible()}},{key:"setCompact",value:function(e){this.setProperty("compact",e)}},{key:"setEmbedDetailContent",value:function(e){this.setProperty("embedDetailContent",e),this.updateDetailContent()}},{key:"_onDetailContentDestroy",value:function(e){this.setDetailContent(null),this.updateDetailMenus()}},{key:"setDetailContent",value:function(e){this.detailContent!==e&&(this.rendered&&this._removeDetailContent(),this.detailContent&&this.detailContent.off("destroy",this._detailContentDestroyHandler),this.detailContent instanceof RE&&this.detailContent.destroy(),this._setProperty("detailContent",e),e&&e.on("destroy",this._detailContentDestroyHandler),this.rendered&&this._renderDetailContent(),this.invalidateLayoutTree())}},{key:"updateDetailContent",value:function(){if(!this.embedDetailContent)return this.setDetailContent(null),void this.setDetailMenus([]);this.setDetailMenuBarVisible(!1),this.setNodeMenuBarVisible(!1),this.setDetailContent(this._computeDetailContent()),this.updateDetailMenus()}},{key:"_updateScrollTopAfterSelection",value:function(){if(the(she(o.prototype),"_updateScrollTopAfterSelection",this).call(this),this.embedDetailContent&&(this.validateLayoutTree(),this.selectedNodes[0]&&this.selectedNodes[0].parentNode)){if(this.prevSelectedNode&&this.prevSelectedNode.isDescendantOf(this.selectedNodes[0]))return;this.scrollTo(this.selectedNodes[0].parentNode,{align:"top",animate:!0})}}},{key:"_computeDetailContent",value:function(){var e=this.selectedNode();return e?e.detailForm&&e.detailFormVisible&&e.detailFormVisibleByUi?e.detailForm:e.row&&e.parentNode.nodeType===kce.NodeType.TABLE?O.create("TableRowDetail",{parent:this,table:e.parentNode.detailTable,page:e}):null:null}},{key:"updateDetailMenus",value:function(){if(this.embedDetailContent){var e,t=this.selectedNodes[0],n=[],i=[],r=[],o=[];if(this.detailContent&&this.detailContent instanceof ZO){var s=this.detailContent.rootGroupBox;n=s.processMenus.concat(s.menus),s.setMenuBarVisible(!1),this._attachDetailMenusListener(s)}else if(t){t.detailTable&&(e=t.detailTable,n=mb.filter(e.menus,["Table.EmptySpace"],!1,!0),i=e.tableControls,e.setMenuBarVisible(!1),this._attachDetailMenusListener(e));var a=t.parentNode;a&&a.detailTable&&(e=a.detailTable,n=n.concat(mb.filter(e.menus,["Table.SingleSelection"],!1,!0)),e.setMenuBarVisible(!1),this._attachDetailMenusListener(e))}i.forEach((function(e){var t=O.create("TableControlAdapterMenu",ZF.adaptTableControlProperties(e,{parent:this,tableControl:e,horizontalAlignment:1}));r.push(t)}),this),n.forEach((function(e){1===e.horizontalAlignment?r.push(e):o.push(e)}),this),this.setNodeMenus(r),this.setDetailMenus(o)}}},{key:"_attachDetailMenusListener",value:function(e){this._detailMenusChangeHandler||(this._detailMenusChangeHandler=function(e){"menus"!==e.propertyName&&"tableControls"!==e.propertyName||this.updateDetailMenus()}.bind(this)),this._detailMenusDestroyHandler||(this._detailMenusDestroyHandler=function(){e.off("propertyChange",this._detailMenusChangeHandler)}.bind(this)),e.off("propertyChange",this._detailMenusChangeHandler),e.on("propertyChange",this._detailMenusChangeHandler),e.off("destroy",this._detailMenusDestroyHandler),e.one("destroy",this._detailMenusDestroyHandler),this._detailMenusNodesSelectedHandler||(this._detailMenusNodesSelectedHandler={outline:this,menuContainers:[],addMenuContainer:function(e){this.menuContainers.indexOf(e)>-1||this.menuContainers.push(e)},func:function(e){"nodesSelected"===e.type&&(this.menuContainers.forEach((function(e){e.off("propertyChange",this.outline._detailMenusChangeHandler),e.off("destroy",this.outline._detailMenusDestroyHandler)}),this),this.menuContainers=[])}},this.addListener(this._detailMenusNodesSelectedHandler)),this._detailMenusNodesSelectedHandler.addMenuContainer(e)}},{key:"setDetailMenus",value:function(e){this.detailMenuBar.setMenuItems([]),this.detailMenuBar.setMenuItems(e),this.setDetailMenuBarVisible(this.detailMenuBar.menuItems.length>0)}},{key:"_renderDetailMenuBarVisible",value:function(){this.detailMenuBarVisible?this._renderDetailMenuBar():this._removeDetailMenuBar()}},{key:"_renderDetailMenuBar",value:function(){if(!this.detailMenuBar.rendered){var e=this.selectedNode();e&&e.rendered&&(this.detailMenuBar.render(e.$node),this.detailMenuBar.$container.addClass("detail-menubar"),this.detailContent&&this.detailContent.rendered&&this.detailMenuBar.$container.insertBefore(this.detailContent.$container),this._ensurePageLayout(e),this.invalidateLayoutTree())}}},{key:"_removeDetailMenuBar",value:function(){this.detailMenuBar.rendered&&(this.detailMenuBar.remove(),this.invalidateLayoutTree())}},{key:"setDetailMenuBarVisible",value:function(e){this.setProperty("detailMenuBarVisible",e)}},{key:"setNodeMenus",value:function(e){this.nodeMenuBar.setMenuItems([]),this.nodeMenuBar.setMenuItems(e),this.setNodeMenuBarVisible(this.nodeMenuBar.menuItems.length>0)}},{key:"_renderNodeMenuBarVisible",value:function(){this.nodeMenuBarVisible?this._renderNodeMenuBar():this._removeNodeMenuBar()}},{key:"_renderNodeMenuBar",value:function(){if(!this.nodeMenuBar.rendered){var e=this.selectedNode();if(e&&e.rendered){var t=e.$text;this.nodeMenuBar.render(e.$node),this.nodeMenuBar.$container.addClass("node-menubar"),this.nodeMenuBar.$container.insertAfter(t),this.invalidateLayoutTree()}}}},{key:"_removeNodeMenuBar",value:function(){this.nodeMenuBar.rendered&&(this.nodeMenuBar.remove(),this.invalidateLayoutTree())}},{key:"setNodeMenuBarVisible",value:function(e){this.setProperty("nodeMenuBarVisible",e)}},{key:"glassPaneTargets",value:function(){return this._glassPaneTargets()}},{key:"_glassPaneTargets",value:function(e){var t=this.session.desktop,n=[];return t.navigation&&n.push(t.navigation.$body),t.bench&&e instanceof ZO&&e.displayHint===ZO.DisplayHint.VIEW&&et.pushAll(n,this._getBenchGlassPaneTargetsForView(e)),t.bench&&t.bench.outlineContent&&et.pushAll(n,t.bench.outlineContent.glassPaneTargets(e)),n}},{key:"_getBenchGlassPaneTargetsForView",value:function(e){var t=[];return t=t.concat(this._getTabGlassPaneTargetsForView(e,this.session.desktop.header)),this.session.desktop.bench.visibleTabBoxes().forEach((function(n){n.hasView(e)?et.pushAll(t,this._getTabGlassPaneTargetsForView(e,n)):n.$container&&t.push(n.$container)}),this),t}},{key:"_getTabGlassPaneTargetsForView",value:function(e,t){var n=[];return t.tabArea.tabs.forEach(function(t){t.view!==e&&t.view.displayParent===this&&(n.push(t.$container),t.$container.addClass("no-hover"))}.bind(this)),n}},{key:"_onGlassPaneMouseDown",value:function(e,t){var n=this.session.desktop;n.navigation&&t.parent()[0]===n.navigation.$body[0]&&n.bringOutlineToFront()}},{key:"inFront",value:function(){return this.session.desktop.outline===this&&!this.inBackground}},{key:"acceptDialog",value:function(e){return this.session.desktop.outline===this}},{key:"acceptView",value:function(e){return this.session.desktop.outline===this}},{key:"activateCurrentPage",value:function(){var e=this.activePage();e&&e.activate()}},{key:"activePage",value:function(){return this.selectedNode()}},{key:"_setViews",value:function(e){e&&e.forEach(function(e){e.setDisplayParent(this)}.bind(this)),this._setProperty("views",e)}},{key:"_setMenus",value:function(e){var t=this.menus;if(this.updateKeyStrokes(e,t),this._setProperty("menus",e),this.titleMenuBar){var n=mb.filter(this.menus,["Tree.Header"]);this.titleMenuBar.setMenuItems(n)}}},{key:"_triggerPageChanged",value:function(e){this.trigger("pageChanged",{page:e})}},{key:"_onLoadChildrenDone",value:function(e){e&&this._initDetailTableAndForm(e)}},{key:"pageChanged",value:function(e){e&&this._initDetailTableAndForm(e);var t=this.selectedNode();(e||t)&&e!==t||this.updateDetailContent(),this._triggerPageChanged(e)}}])&&ehe(t.prototype,n),i&&ehe(t,i),o}(NL);function uhe(e){return(uhe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lhe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function che(e,t,n){return(che="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yhe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function fhe(e,t){return(fhe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hhe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=yhe(e);if(t){var r=yhe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dhe(this,n)}}function dhe(e,t){return!t||"object"!==uhe(t)&&"function"!=typeof t?phe(e):t}function phe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yhe(e){return(yhe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vhe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fhe(e,t)}(o,e);var t,n,i,r=hhe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._nodeIdToRowMap={},e._detailTableRowInitHandler=e._onDetailTableRowInit.bind(phe(e)),e}return t=o,i=[{key:"modifyOutlinePrototype",value:function(){x.get().remote&&(oi.replacePrototypeFunction(ahe,"_computeDetailContent",o._computeDetailContentRemote,!0),oi.replacePrototypeFunction(ahe,"updateDetailMenus",o.updateDetailMenusRemote,!0))}},{key:"_computeDetailContentRemote",value:function(){if(!this.modelAdapter)return this._computeDetailContentOrig();var e=this.selectedNode();return e?e.detailForm||e.detailFormResolved?(e.detailFormResolved=!0,this._computeDetailContentOrig()):this.session.areRequestsPending()||this.session.areEventsQueued()?void this.session.listen().done(function(e){e.detailFormResolved||(e.detailFormResolved=!0,this.updateDetailContent())}.bind(this,e)):(e.detailFormResolved=!0,this._computeDetailContentOrig()):null}},{key:"updateDetailMenusRemote",value:function(){return this.modelAdapter?this.selectedNode()&&this.selectedNode().detailFormResolved?this.updateDetailMenusOrig():void 0:this.updateDetailMenusOrig()}}],(n=[{key:"_postCreateWidget",value:function(){this.widget.visitNodes(this._onWidgetPageInit.bind(this))}},{key:"_onPageChanged",value:function(e){var t=this.widget._nodeById(e.nodeId);t.overviewIconId=e.overviewIconId,t.detailFormVisible=e.detailFormVisible;var n=this.session.getOrCreateWidget(e.detailForm,this.widget);n!==t.detailForm&&t.setDetailForm(n),t.navigateButtonsVisible=e.navigateButtonsVisible,t.detailTableVisible=e.detailTableVisible;var i=this.session.getOrCreateWidget(e.detailTable,this.widget);t.detailTable!==i&&(t.detailTable&&this._destroyDetailTable(t),t.setDetailTable(i),t.detailTable&&this._initDetailTable(t)),this.widget.pageChanged(t)}},{key:"_onWidgetEvent",value:function(e){"pageInit"===e.type?this._onWidgetPageInit(e.page):che(yhe(o.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"onModelAction",value:function(e){"pageChanged"===e.type?this._onPageChanged(e):che(yhe(o.prototype),"onModelAction",this).call(this,e)}},{key:"_onWidgetPageInit",value:function(e){e.detailTable&&this._initDetailTable(e),this._linkNodeWithRowLater(e)}},{key:"_initDetailTable",value:function(e){e.detailTable.rows.forEach(this._linkNodeWithRow.bind(this)),e.detailTable.on("rowInit",this._detailTableRowInitHandler)}},{key:"_destroyDetailTable",value:function(e){this._nodeIdToRowMap={},e.detailTable.rows.forEach(this._unlinkNodeWithRow.bind(this)),e.detailTable.off("rowInit",this._detailTableRowInitHandler)}},{key:"_linkNodeWithRow",value:function(e){O.assertParameter("row",e);var t,n=e.nodeId;void 0!==n&&((t=this.widget.nodesMap[n])?t.linkWithRow(e):this._nodeIdToRowMap[n]=e)}},{key:"_unlinkNodeWithRow",value:function(e){var t=this.widget.nodesMap[e.nodeId];t&&t.unlinkWithRow(e)}},{key:"_onDetailTableRowInit",value:function(e){var t,n=this.widget,i=e.row.nodeId;this._linkNodeWithRow(e.row),t=this.widget.nodesMap[i],n.rendered&&t&&n._applyFiltersForNode(t)&&(t.isFilterAccepted()?n._addToVisibleFlatList(t,!1):n._removeFromFlatList(t,!1)),this.widget.isSelectedNode(t)&&!this.widget.detailContent&&this.widget.updateDetailContent()}},{key:"_linkNodeWithRowLater",value:function(e){if(e.parentNode&&e.parentNode.detailTable&&this._nodeIdToRowMap.hasOwnProperty(e.id)){var t=this._nodeIdToRowMap[e.id];e.linkWithRow(t),delete this._nodeIdToRowMap[e.id]}}}])&&lhe(t.prototype,n),i&&lhe(t,i),o}(qL);function bhe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}x.addListener("bootstrap",vhe.modifyOutlinePrototype);var ghe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"init",value:function(e){}},{key:"_skipEvent",value:function(e){return null===e||null===e.getOutline()||e.leaf}},{key:"onTableRowsInserted",value:function(e,t,n){this._skipEvent(n)||n.getTree().insertNodes(t,n)}},{key:"onTableRowsDeleted",value:function(e,t,n){this._skipEvent(n)||n.getTree().deleteNodes(t,n)}},{key:"onTableRowsUpdated",value:function(e,t){if(!this._skipEvent(t)){var n=t.updatePagesFromTableRows(e.rows);t.getTree().updateNodes(n)}}},{key:"onTableRowAction",value:function(e,t){var n=e.row.page;if(n){var i=n.getOutline();i&&(i.selectNode(n),i.setNodeExpanded(n,!0))}}},{key:"onTableRowOrderChanged",value:function(e,t){if(!this._skipEvent(t)){var n=e.source,i=t.pagesForTableRows(n.rows);t.getOutline().updateNodeOrder(i,t)}}},{key:"onTableFilter",value:function(e,t){t.getOutline().filter()}}])&&bhe(t.prototype,n),i&&bhe(t,i),e}();function mhe(e){return(mhe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _he(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function whe(e,t,n){return(whe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=The(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function khe(e,t){return(khe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function She(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=The(e);if(t){var r=The(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ohe(this,n)}}function Ohe(e,t){return!t||"object"!==mhe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function The(e){return(The=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Che=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&khe(e,t)}(o,e);var t,n,i,r=She(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).outline=e,t}return t=o,(n=[{key:"_layout",value:function(e){var t,n=this.outline.htmlComp;if(whe(The(o.prototype),"_layout",this).call(this,e),t=n.availableSize().subtract(n.insets()),this.outline.embedDetailContent){var i=this.outline.selectedNodes[0];if(i&&i.rendered){var r=i.htmlComp;if(r){r.$comp.cssWidth(t.width);var s=r.prefSize();r.setSize(new Co(t.width,s.height)),i.height=s.height+r.margins().vertical()}}this.outline.visibleNodesFlat.forEach((function(e){var t=e.$node;t&&!t.isSelected()&&t[0].style.height&&"auto"!==t[0].style.height&&(t.css("height","auto").css("width","auto"),e.height=t.outerHeight(!0))}))}this.outline.titleMenuBar.validateLayout(),this.outline.nodeMenuBar.validateLayout(),this.outline.detailMenuBar.validateLayout()}},{key:"_setDataHeight",value:function(e){var t=null;this.outline.titleVisible&&(t=No.size(this.outline.$title,!0)),whe(The(o.prototype),"_setDataHeight",this).call(this,e+(null===t?0:t.height))}}])&&_he(t.prototype,n),i&&_he(t,i),o}(iB);function Phe(e){return(Phe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rhe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xhe(e,t,n){return(xhe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ahe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ehe(e,t){return(Ehe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dhe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ahe(e);if(t){var r=Ahe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Fhe(this,n)}}function Fhe(e,t){return!t||"object"!==Phe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ahe(e){return(Ahe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $he=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ehe(e,t)}(o,e);var t,n,i,r=Dhe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties("outline"),e._addPreserveOnPropertyChangeProperties(["outline"]),e._addCloneProperties(["outline"]),e}return t=o,(n=[{key:"_init",value:function(e){xhe(Ahe(o.prototype),"_init",this).call(this,e),this._setOutline(this.outline)}},{key:"_setOutline",value:function(e){this._setProperty("outline",e),this.outline&&this.outline.setIconId(this.iconId)}},{key:"_setIconId",value:function(e){this._setProperty("iconId",e),this.outline&&this.outline.setIconId(this.iconId)}},{key:"_doAction",value:function(){xhe(Ahe(o.prototype),"_doAction",this).call(this),this.outline&&(this.session.desktop.setOutline(this.outline),this.session.desktop.bringOutlineToFront())}},{key:"onOutlineChange",value:function(e){var t=!!e&&this.outline===e;this.setSelected(t)}}])&&Rhe(t.prototype,n),i&&Rhe(t,i),o}(dle);function jhe(e){return(jhe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mhe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ihe(e,t){return(Ihe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lhe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Nhe(e);if(t){var r=Nhe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Bhe(this,n)}}function Bhe(e,t){return!t||"object"!==jhe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nhe(e){return(Nhe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hhe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ihe(e,t)}(o,e);var t,n,i,r=Lhe(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_goOffline",value:function(){this.widget.outline||(this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1))}},{key:"_goOnline",value:function(){this.widget.outline||this.widget.setEnabled(this._enabledBeforeOffline)}}])&&Mhe(t.prototype,n),i&&Mhe(t,i),o}(mle);function Vhe(e){return(Vhe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Whe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zhe(e,t){return(zhe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ghe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Khe(e);if(t){var r=Khe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Uhe(this,n)}}function Uhe(e,t){return!t||"object"!==Vhe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Khe(e){return(Khe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qhe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zhe(e,t)}(o,e);var t,n,i,r=Ghe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).outline=null,e.tileOutlineOverview=null,e}return t=o,(n=[{key:"_render",value:function(){this._ensureTileOutlineOverview(),this.addContainer(this.$parent,"outline-tile-field"),this.tileOutlineOverview.render(this.$container),this.addField(this.tileOutlineOverview.$container)}},{key:"_ensureTileOutlineOverview",value:function(){if(!this.tileOutlineOverview){var e=this.outline?this.session.getWidget(this.outline):null;this.tileOutlineOverview=O.create("TileOutlineOverview",{parent:this,outline:e})}}}])&&Whe(t.prototype,n),i&&Whe(t,i),o}(GH);function Yhe(e){return(Yhe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xhe(e,t){return(Xhe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jhe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Qhe(e);if(t){var r=Qhe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Zhe(this,n)}}function Zhe(e,t){return!t||"object"!==Yhe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qhe(e){return(Qhe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ede=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xhe(e,t)}(n,e);var t=Jhe(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function tde(e){return(tde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nde(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ide(e,t){return(ide=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=sde(e);if(t){var r=sde(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ode(this,n)}}function ode(e,t){return!t||"object"!==tde(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sde(e){return(sde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ade=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ide(e,t)}(o,e);var t,n,i,r=rde(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this)).outline=e,n.page=t,n}return t=o,(n=[{key:"layout",value:function(e){var t,n,i=this.page.htmlComp,r=this.page.$text,o=this.page.$icon(),s=0,a=0,u=this.outline.nodeMenuBar,l=0,c=this.outline.detailMenuBar,f=0,h=0;h=(t=i.availableSize().subtract(i.insets())).width,o.length>0&&(h-=No.prefSize(o).width),u.visible&&(l=u.htmlComp.prefSize(),u.htmlComp.setSize(l),h-=l.add(u.htmlComp.margins()).width),r.cssWidth(h),c.visible&&(f=c.htmlComp.prefSize().height,n=new Co(t.width,f).subtract(c.htmlComp.margins()),c.htmlComp.setSize(n)),this.outline.detailContent&&(o.length>0&&(a=o.outerHeight(!0)),s=Math.max(r.outerHeight(!0),a),this.outline.detailContent.htmlComp.setSize(new Co(t.width,t.height-s-f)))}},{key:"preferredLayoutSize",value:function(e){var t,n,i=0,r=this.page.htmlComp,o=new Co,s=this.page.$text,a=this.page.$icon(),u=this.outline.detailMenuBar,l=new Co,c=this.outline.nodeMenuBar,f=0;return f=r.size().subtract(r.insets()).width,a.length>0&&(f-=No.prefSize(a).width),c.visible&&c.rendered&&(f-=c.htmlComp.prefSize().width),t=No.prefSize(s,{includeMargin:!0,widthHint:f}).height,a.length>0&&(i=a.outerHeight(!0)),n=Math.max(t,i),u.visible&&u.rendered&&(l=u.htmlComp.prefSize()),this.outline.detailContent&&(o=this.outline.detailContent.htmlComp.prefSize()),new Co(Math.max(o.width,l.width),n+l.height+o.height).add(r.insets())}}])&&nde(t.prototype,n),i&&nde(t,i),o}(zo);function ude(e){return(ude="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lde(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cde(e,t,n){return(cde="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pde(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function fde(e,t){return(fde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pde(e);if(t){var r=pde(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dde(this,n)}}function dde(e,t){return!t||"object"!==ude(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pde(e){return(pde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yde=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fde(e,t)}(o,e);var t,n,i,r=hde(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).hasText=!1,e.$searchPanel=null,e.$clearIcon=null,e.$searchStatus=null,e.$queryField=null,e}return t=o,(n=[{key:"_initKeyStrokeContext",value:function(){cde(pde(o.prototype),"_initKeyStrokeContext",this).call(this),this.searchFieldKeyStrokeContext=this._createKeyStrokeContextForSearchField()}},{key:"_createKeyStrokeContextForSearchField",value:function(){var e=new Fu;return e.$scopeTarget=function(){return this.$searchPanel}.bind(this),e.$bindTarget=function(){return this.$queryField}.bind(this),e.registerStopPropagationKeys(gu.NONE,[pu.ENTER,pu.BACKSPACE]),e}},{key:"_render",value:function(){cde(pde(o.prototype),"_render",this).call(this),this.htmlComp.setLayout(new Dde(this)),this.$container.addClass("search-outline"),this.$searchPanel=this.$container.prependDiv("search-outline-panel"),this.$queryField=this.$searchPanel.appendElement("<input>","search-outline-field").on("input",this._createOnQueryFieldInputFunction().bind(this)).on("keypress",this._onQueryFieldKeyPress.bind(this)),this.$clearIcon=this.$searchPanel.appendSpan("clear-icon unfocusable needsclick").on("mousedown",this._onClearIconMouseDown.bind(this)),this.$searchStatus=this.$searchPanel.appendDiv("search-outline-status").on("mousedown",this._onTitleMouseDown.bind(this)),this.session.keyStrokeManager.installKeyStrokeContext(this.searchFieldKeyStrokeContext)}},{key:"_remove",value:function(){this.session.keyStrokeManager.uninstallKeyStrokeContext(this.searchFieldKeyStrokeContext),this.$searchPanel.remove(),cde(pde(o.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){cde(pde(o.prototype),"_renderProperties",this).call(this),this._renderSearchQuery(),this._renderSearchStatus(),this._updateHasText()}},{key:"_renderTitle",value:function(){cde(pde(o.prototype),"_renderTitle",this).call(this),this.titleVisible&&this.$title.insertBefore(this.$searchPanel)}},{key:"_renderSearchQuery",value:function(){this.$queryField.val(this.searchQuery)}},{key:"_renderSearchStatus",value:function(){var e=this.rendered;this.searchStatus&&!this.$searchStatus.isVisible()?e?this.$searchStatus.slideDown({duration:200,progress:this.revalidateLayout.bind(this)}):this.$searchStatus.show():!this.searchStatus&&this.$searchStatus.isVisible()&&(e?this.$searchStatus.slideUp({duration:200,progress:this.revalidateLayout.bind(this)}):this.$searchStatus.hide()),this.$searchStatus.textOrNbsp(this.searchStatus),this.$searchPanel.toggleClass("has-status",!!this.searchStatus)}},{key:"focusQueryField",value:function(){this.validateFocus()}},{key:"_triggerSearch",value:function(){this.trigger("search",{query:O.nvl(this.searchQuery,"")})}},{key:"_createOnQueryFieldInputFunction",value:function(e){var t=s.a.debounce(this._search.bind(this));return function(e){this._updateHasText(),t()}}},{key:"_onClearIconMouseDown",value:function(e){this.$queryField.val(""),this._updateHasText(),this._search(),this.$queryField.focus(),e.preventDefault()}},{key:"_onQueryFieldKeyPress",value:function(e){e.which===pu.ENTER&&(this._setSearchQuery(this.$queryField.val()),this._triggerSearch())}},{key:"_search",value:function(e){var t=this.$queryField.val();this.searchQuery!==t&&(this._setSearchQuery(t),this._triggerSearch())}},{key:"_setSearchQuery",value:function(e){this.searchQuery=e}},{key:"_updateHasText",value:function(){this.$queryField.toggleClass("has-text",!!this.$queryField.val())}},{key:"validateFocus",value:function(){if(this.rendered){var e=this.$queryField[0];this.session.focusManager.requestFocus(e)&&e.select()}}}])&&lde(t.prototype,n),i&&lde(t,i),o}(ahe);function vde(e){return(vde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bde(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gde(e,t,n){return(gde="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kde(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function mde(e,t){return(mde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=kde(e);if(t){var r=kde(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wde(this,n)}}function wde(e,t){return!t||"object"!==vde(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kde(e){return(kde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sde=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mde(e,t)}(o,e);var t,n,i,r=_de(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_initProperties",value:function(e){void 0!==e.requestFocusQueryField&&delete e.requestFocusQueryField}},{key:"_syncRequestFocusQueryField",value:function(){this.widget.focusQueryField()}},{key:"_onWidgetSearch",value:function(e){this._send("search",{query:e.query},{showBusyIndicator:!1})}},{key:"_onWidgetEvent",value:function(e){"search"===e.type?this._onWidgetSearch(e):gde(kde(o.prototype),"_onWidgetEvent",this).call(this,e)}}])&&bde(t.prototype,n),i&&bde(t,i),o}(vhe);function Ode(e){return(Ode="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tde(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cde(e,t,n){return(Cde="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ede(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Pde(e,t){return(Pde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ede(e);if(t){var r=Ede(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xde(this,n)}}function xde(e,t){return!t||"object"!==Ode(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ede(e){return(Ede=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dde=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pde(e,t)}(o,e);var t,n,i,r=Rde(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).outline=e,t}return t=o,(n=[{key:"_setDataHeight",value:function(e){e+=No.size(this.outline.$searchPanel,!0).height,Cde(Ede(o.prototype),"_setDataHeight",this).call(this,e)}}])&&Tde(t.prototype,n),i&&Tde(t,i),o}(Che);function Fde(e){return(Fde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ade(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $de(e,t,n){return($de="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lde(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function jde(e,t){return(jde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Lde(e);if(t){var r=Lde(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ide(this,n)}}function Ide(e,t){return!t||"object"!==Fde(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lde(e){return(Lde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Bde=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jde(e,t)}(o,e);var t,n,i,r=Mde(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).node=null,e.outline=null,e.actionStyle=Eh.ActionStyle.BUTTON,e._additionalCssClass="",e._addCloneProperties(["node","outline","altKeyStrokeContext"]),e.inheritAccessibility=!1,e}return t=o,(n=[{key:"_render",value:function(){this.overflow?(this.text=this.session.text(this._defaultText),this.iconId=null):(this.text=null,this.iconId=this._defaultIconId),this.updateEnabled(),$de(Lde(o.prototype),"_render",this).call(this),this.$container.addClass("navigate-button small"),this.$container.addClass(this._additionalCssClass),this.altKeyStrokeContext.registerKeyStroke(this)}},{key:"_remove",value:function(){$de(Lde(o.prototype),"_remove",this).call(this),this.altKeyStrokeContext.unregisterKeyStroke(this)}},{key:"_setDetailVisible",value:function(){var e=this._toggleDetail();s.a.log.isDebugEnabled()&&s.a.log.debug("show detail-"+(e?"form":"table")),this.outline.setDetailFormVisibleByUi(this.node,e)}},{key:"_doAction",value:function(){$de(Lde(o.prototype),"_doAction",this).call(this),this._isDetail()?this._setDetailVisible():this._drill()}},{key:"updateEnabled",value:function(){this.setEnabled(this._buttonEnabled())}}])&&Ade(t.prototype,n),i&&Ade(t,i),o}(xb);function Nde(e){return(Nde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hde(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Vde(e,t,n){return(Vde="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kde(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Wde(e,t){return(Wde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Kde(e);if(t){var r=Kde(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gde(this,n)}}function Gde(e,t){return!t||"object"!==Nde(t)&&"function"!=typeof t?Ude(e):t}function Ude(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kde(e){return(Kde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qde=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wde(e,t)}(o,e);var t,n,i,r=zde(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._defaultIconId=sn.ANGLE_DOWN,e._defaultText="ui.Continue",e.iconId=e._defaultIconId,e.keyStroke="enter",e._detailTableRowsSelectedHandler=e._onDetailTableRowsSelected.bind(Ude(e)),e._outlinePageRowLinkHandler=e._onOutlinePageRowLink.bind(Ude(e)),e}return t=o,(n=[{key:"_init",value:function(e){Vde(Kde(o.prototype),"_init",this).call(this,e),this.node.detailTable&&this.node.detailTable.on("rowsSelected",this._detailTableRowsSelectedHandler),this.outline.on("pageRowLink",this._outlinePageRowLinkHandler)}},{key:"_destroy",value:function(){this.node.detailTable&&this.node.detailTable.off("rowsSelected",this._detailTableRowsSelectedHandler),this.outline.off("pageRowLink",this._outlinePageRowLinkHandler),Vde(Kde(o.prototype),"_destroy",this).call(this)}},{key:"_render",value:function(){Vde(Kde(o.prototype),"_render",this).call(this),this.$container.addClass("down")}},{key:"_isDetail",value:function(){return!!(this.node.detailFormVisible&&this.node.detailForm&&this.node.detailTableVisible&&this.node.detailTable&&this.node.detailFormVisibleByUi)}},{key:"_toggleDetail",value:function(){return!1}},{key:"_buttonEnabled",value:function(){if(this._isDetail())return!0;if(this.node.leaf)return!1;var e=this.node.detailTable;return!e||1===e.selectedRows.length&&!!e.selectedRows[0].page}},{key:"_drill",value:function(){var e;if(this.node.detailTable){var t=this.node.detailTable.selectedRow();e=this.node.pageForTableRow(t)}else e=this.node.childNodes[0];if(e){s.a.log.isDebugEnabled()&&s.a.log.debug("drill down to node "+e);var n=e.parentNode;n&&n.childNodes.forEach(function(t){t.expanded&&t!==e&&this.outline.collapseNode(t,{animateExpansion:!1})}.bind(this)),this.outline.selectNodes(e),n&&n.nodeType===kce.NodeType.TABLE&&this.outline.expandNode(e)}}},{key:"_onDetailTableRowsSelected",value:function(e){this.updateEnabled()}},{key:"_onOutlinePageRowLink",value:function(e){var t=this.node.detailTable;t&&1===t.selectedRows.length&&t.selectedRows[0].page===e.page&&this.updateEnabled()}}])&&Hde(t.prototype,n),i&&Hde(t,i),o}(Bde);function Yde(e){return(Yde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xde(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jde(e,t,n){return(Jde="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tpe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Zde(e,t){return(Zde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=tpe(e);if(t){var r=tpe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return epe(this,n)}}function epe(e,t){return!t||"object"!==Yde(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tpe(e){return(tpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var npe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zde(e,t)}(o,e);var t,n,i,r=Qde(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._defaultIconId=sn.ANGLE_UP,e._defaultText="ui.Up",e._additionalCssClass="small-gap",e.iconId=e._defaultIconId,e.keyStroke="backspace",e}return t=o,(n=[{key:"_render",value:function(){Jde(tpe(o.prototype),"_render",this).call(this),this.$container.addClass("up")}},{key:"_isDetail",value:function(){return!(!(this.node.detailFormVisible&&this.node.detailForm&&this.node.detailTableVisible&&this.node.detailTable)||this.node.detailFormVisibleByUi)}},{key:"_toggleDetail",value:function(){return!0}},{key:"_buttonEnabled",value:function(){return!!this.node.parentNode||!!this.outline.defaultDetailForm||!!this.outline.outlineOverview}},{key:"_drill",value:function(){var e=this.node.parentNode;e?(s.a.log.isDebugEnabled()&&s.a.log.debug("drill up to node "+e),this.outline.navigateUpInProgress=!0,this.outline.selectNodes(e),this.outline.collapseNode(e,{collapseChildNodes:!0})):(s.a.log.isDebugEnabled()&&s.a.log.debug("drill up to top"),this.outline.navigateToTop())}}])&&Xde(t.prototype,n),i&&Xde(t,i),o}(Bde);function ipe(e){return(ipe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rpe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ope(e,t,n){return(ope="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lpe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function spe(e,t){return(spe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ape(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=lpe(e);if(t){var r=lpe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return upe(this,n)}}function upe(e,t){return!t||"object"!==ipe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lpe(e){return(lpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cpe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&spe(e,t)}(o,e);var t,n,i,r=ape(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this))._outline=e,t}return t=o,(n=[{key:"accept",value:function(e){return!this._outline.inBackground&&!this.isFormMenuOpen()&&ope(lpe(o.prototype),"accept",this).call(this,e)}},{key:"isFormMenuOpen",value:function(){return this._outline.session.desktop.menus.some((function(e){return e.popup&&e.popup.$container&&e.popup.$container.isAttached()}),this)}}])&&rpe(t.prototype,n),i&&rpe(t,i),o}(Ou);function fpe(e){return(fpe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hpe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dpe(e,t){return(dpe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ppe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=bpe(e);if(t){var r=bpe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ype(this,n)}}function ype(e,t){return!t||"object"!==fpe(t)&&"function"!=typeof t?vpe(e):t}function vpe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bpe(e){return(bpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gpe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dpe(e,t)}(o,e);var t,n,i,r=ppe(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).which=[pu.HOME],n.renderingHints.hAlign=Ni.RIGHT,n.renderingHints.$drawingArea=function(e,t){return this.field.$title||this.field.$data}.bind(vpe(n)),n}return t=o,(n=[{key:"handle",value:function(e){this.field.navigateToTop()}}])&&hpe(t.prototype,n),i&&hpe(t,i),o}(yB);function mpe(e){return(mpe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _pe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wpe(e,t,n){return(wpe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Tpe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function kpe(e,t){return(kpe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Spe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Tpe(e);if(t){var r=Tpe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ope(this,n)}}function Ope(e,t){return!t||"object"!==mpe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tpe(e){return(Tpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cpe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kpe(e,t)}(o,e);var t,n,i,r=Spe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).outline=null,e}return t=o,(n=[{key:"_init",value:function(e){wpe(Tpe(o.prototype),"_init",this).call(this,e),!this.outline&&this.parent instanceof ahe&&(this.outline=this.parent),O.assertProperty(this,"outline",ahe)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("outline-overview"),this.htmlComp=Uo.install(this.$container,this.session),this.$content=this.$container.appendDiv("outline-overview-content"),this.$content.appendDiv("outline-overview-icon").icon(this.outline.iconId),this.$content.appendDiv("outline-overview-title").text(this.outline.title)}},{key:"_attach",value:function(){this.$parent.append(this.$container);var e=this.htmlComp.getParent();this.htmlComp.setSize(e.size()),wpe(Tpe(o.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.$container.detach(),wpe(Tpe(o.prototype),"_detach",this).call(this)}}])&&_pe(t.prototype,n),i&&_pe(t,i),o}(de);function Ppe(e){return(Ppe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rpe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xpe(e,t,n){return(xpe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ape(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Epe(e,t){return(Epe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dpe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ape(e);if(t){var r=Ape(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Fpe(this,n)}}function Fpe(e,t){return!t||"object"!==Ppe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ape(e){return(Ape=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Epe(e,t)}(o,e);var t,n,i,r=Dpe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).pageTileGrid=null,e.scrollable=!0,e._addWidgetProperties(["pageTileGrid"]),e}return t=o,(n=[{key:"_init",value:function(e){xpe(Ape(o.prototype),"_init",this).call(this,e),this.pageTileGrid||(this.pageTileGrid=this._createPageTileGrid())}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tile-overview"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new zte(this)),this.$content=this.$container.appendDiv("tile-overview-content"),this.contentHtmlComp=Uo.install(this.$content,this.session),this.$title=this.$content.appendDiv("tile-overview-title").text(this.outline.title)}},{key:"_renderProperties",value:function(){xpe(Ape(o.prototype),"_renderProperties",this).call(this),this._renderPageTileGrid(),this._renderScrollable()}},{key:"_renderPageTileGrid",value:function(){this.pageTileGrid.render(this.$content)}},{key:"_createPageTileGrid",value:function(){return O.create("PageTileGrid",{parent:this,outline:this.outline})}},{key:"_renderScrollable",value:function(){this.scrollable?this._installScrollbars({axis:"y"}):this._uninstallScrollbars()}}])&&Rpe(t.prototype,n),i&&Rpe(t,i),o}(Cpe);function jpe(e){return(jpe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mpe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ipe(e,t,n){return(Ipe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vpe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Lpe(e,t){return(Lpe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bpe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Vpe(e);if(t){var r=Vpe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Npe(this,n)}}function Npe(e,t){return!t||"object"!==jpe(t)&&"function"!=typeof t?Hpe(e):t}function Hpe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vpe(e){return(Vpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wpe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lpe(e,t)}(o,e);var t,n,i,r=Bpe(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).desktop=e.displayParent,t._popupWindows=[],t._documentPopupWindowReadyHandler=t._onDocumentPopupWindowReady.bind(Hpe(t)),s()(document).on("popupWindowReady",t._documentPopupWindowReadyHandler),t}return t=o,(n=[{key:"render",value:function(){Ipe(Vpe(o.prototype),"render",this).call(this);var e=this.desktop.activeForm;e?e.activate():this.desktop.bringOutlineToFront()}},{key:"_renderViews",value:function(){Ipe(Vpe(o.prototype),"_renderViews",this).call(this),this.desktop.selectedViewTabs&&this.desktop.selectedViewTabs.forEach(function(e){this._activateView(e)}.bind(this)),this.desktop.bench&&(this.desktop.bench.postRender(),this.desktop.bench.htmlComp.validateLayoutTree())}},{key:"_renderPopupWindow",value:function(e){var t,n,i=e.readCacheBounds();if(i)t="left="+i.x+",top="+i.y+",width="+i.width+",height="+i.height,n=!1;else{var r=s()(document),o=new Co(r.width(),r.height());t="left=0,top=0,width="+o.width+",height="+o.height,n=!0}t+=",location=no,toolbar=no,menubar=no,resizable=yes";var a=new jue(this.session,!0),u="popup-window.html?formId="+e.id;a.openWindow(u,"_blank",t,function(t){this._addPopupWindow(t,e,n)}.bind(this))}},{key:"_addPopupWindow",value:function(e,t,n){var i=new ese(e,t);i.resizeToPrefSize=n,i.events.on("popupWindowUnload",this._onPopupWindowUnload.bind(this)),this._popupWindows.push(i),s.a.log.isDebugEnabled()&&s.a.log.debug("Opened new popup window for form ID "+t.id)}},{key:"_onDocumentPopupWindowReady",value:function(e,t){var n;if(s.a.log.isDebugEnabled()&&s.a.log.debug("(FormController#_onDocumentPopupWindowReady) data="+t),t.formId){var i,r=t.formId;for(s.a.log.isDebugEnabled()&&s.a.log.debug("Popup window for form ID "+r+" has been reloaded"),i=0;i<this._popupWindows.length&&(n=this._popupWindows[i]).form.id!==r;i++);if(!n)throw new Error("Couldn't find popupWindow reference while popup window was reloaded")}else{if(!t.popupWindow)throw new Error("Neither property 'formId' nor 'popupWindow' exists on data parameter");n=t.popupWindow}n._onReady()}},{key:"_onPopupWindowUnload",value:function(e){var t=e.form;s.a.log.isDebugEnabled()&&s.a.log.debug("Popup window for form ID "+t.id+" is unloaded - don't know if its closed or reloaded yet"),t.remove(),setTimeout((function(){e.isClosed()&&(s.a.log.isDebugEnabled()&&s.a.log.debug("Popup window for form ID "+t.id+" has been closed"),t.close())}),250)}},{key:"closePopupWindows",value:function(){this._popupWindows.forEach((function(e){this._removePopupWindow(e.form)}),this),this._popupWindows=[]}},{key:"_removePopupWindow",value:function(e){var t=e.popupWindow;if(!t)throw new Error("Form has no popupWindow reference");delete e.popupWindow,et.remove(this._popupWindows,t),e.rendered&&(e.remove(),t.close())}},{key:"dispose",value:function(){s()(document).off("popupWindowReady",this._documentPopupWindowReadyHandler)}}])&&Mpe(t.prototype,n),i&&Mpe(t,i),o}(QW);function zpe(e){return(zpe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gpe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Upe(e,t,n){return(Upe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xpe(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Kpe(e,t){return(Kpe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qpe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Xpe(e);if(t){var r=Xpe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ype(this,n)}}function Ype(e,t){return!t||"object"!==zpe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xpe(e){return(Xpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jpe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kpe(e,t)}(o,e);var t,n,i,r=qpe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).gridColumnCount=1,e.cssClass="filter-fields",e}return t=o,(n=[{key:"_init",value:function(e){Upe(Xpe(o.prototype),"_init",this).call(this,e),this.filter.addFilterFields(this)}},{key:"_renderProperties",value:function(e){Upe(Xpe(o.prototype),"_renderProperties",this).call(this,e),this.filter.modifyFilterFields()}},{key:"addFilterField",value:function(e,t){var n=O.create(e,{parent:this,label:this.session.text(t),statusVisible:!1,labelWidthInPixel:50,maxLength:100,updateDisplayTextOnModify:!0});return this.addField0(n),n}},{key:"addField0",value:function(e){this.fields.push(e),this._prepareFields()}}])&&Gpe(t.prototype,n),i&&Gpe(t,i),o}(rY);function Zpe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qpe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eye=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O.assertParameter("model",t),O.assertParameter("$container",t.$container),this.$container=t.$container,this.$window=t.$container.window(),this.setModes(t.modes),this.setBoundaries(t.boundaries),this.$resizableS=null,this.$resizableE=null,this.$resizableSE=null,this.$resizableW=null,this.$resizableSW=null,this.$resizableN=null,this.$resizableNW=null,this.$resizableNE=null,this._context=null,this._mouseDownHandler=this._onMouseDown.bind(this),this._mouseUpHandler=this._onMouseUp.bind(this),this._mousemoveHandler=this._onMousemove.bind(this),this._resizeHandler=this._resize.bind(this)}var t,n,i;return t=e,(n=[{key:"setModes",value:function(t){var n=t||[e.MODES.SOUTH,e.MODES.EAST,e.MODES.WEST,e.MODES.NORTH];et.equals(n,this.modes)||(this.modes=n,this._calculateResizeHandlersVisibility())}},{key:"setBoundaries",value:function(e){this.boundaries=s.a.extend(new Ro,e),this._boundaryValueSet(this.boundaries.left)&&(this.boundaries.left-=this.$container.cssMarginLeft()),this._boundaryValueSet(this.boundaries.right)&&(this.boundaries.right-=this.$container.cssMarginRight()),this._boundaryValueSet(this.boundaries.top)&&(this.boundaries.top-=this.$container.cssMarginTop()),this._boundaryValueSet(this.boundaries.bottom)&&(this.boundaries.bottom-=this.$container.cssMarginBottom())}},{key:"_appendResizeHandles",value:function(){this.$resizableS=this.$container.appendDiv("resizable-handle resizable-s").data("edge","s").on("mousedown.resizable",this._mouseDownHandler),this.$resizableE=this.$container.appendDiv("resizable-handle resizable-e").data("edge","e").on("mousedown.resizable",this._mouseDownHandler),this.$resizableSE=this.$container.appendDiv("resizable-handle resizable-se").data("edge","se").on("mousedown.resizable",this._mouseDownHandler),this.$resizableW=this.$container.appendDiv("resizable-handle resizable-w").data("edge","w").on("mousedown.resizable",this._mouseDownHandler),this.$resizableSW=this.$container.appendDiv("resizable-handle resizable-sw").data("edge","sw").on("mousedown.resizable",this._mouseDownHandler),this.$resizableN=this.$container.appendDiv("resizable-handle resizable-n").data("edge","n").on("mousedown.resizable",this._mouseDownHandler),this.$resizableNW=this.$container.appendDiv("resizable-handle resizable-nw").data("edge","nw").on("mousedown.resizable",this._mouseDownHandler),this.$resizableNE=this.$container.appendDiv("resizable-handle resizable-ne").data("edge","ne").on("mousedown.resizable",this._mouseDownHandler),this._calculateResizeHandlersVisibility()}},{key:"_calculateResizeHandlersVisibility",value:function(){this.$resizableS&&this.$resizableS.setVisible(this._hasMode(e.MODES.SOUTH)),this.$resizableE&&this.$resizableE.setVisible(this._hasMode(e.MODES.EAST)),this.$resizableSE&&this.$resizableSE.setVisible(this._hasMode(e.MODES.SOUTH)&&this._hasMode(e.MODES.EAST)),this.$resizableW&&this.$resizableW.setVisible(this._hasMode(e.MODES.WEST)),this.$resizableSW&&this.$resizableSW.setVisible(this._hasMode(e.MODES.SOUTH)&&this._hasMode(e.MODES.WEST)),this.$resizableN&&this.$resizableN.setVisible(this._hasMode(e.MODES.NORTH)),this.$resizableNW&&this.$resizableNW.setVisible(this._hasMode(e.MODES.NORTH)&&this._hasMode(e.MODES.WEST)),this.$resizableNE&&this.$resizableNE.setVisible(this._hasMode(e.MODES.NORTH)&&this._hasMode(e.MODES.EAST))}},{key:"_hasMode",value:function(e){return this.modes.some((function(t){return t===e}))}},{key:"init",value:function(){this.$container.addClass("resizable"),this._appendResizeHandles(),this._installRemoveHandler()}},{key:"_installRemoveHandler",value:function(){this.$container.on("remove",this.destroy.bind(this))}},{key:"destroy",value:function(){this.$resizableS&&(this.$resizableS.remove(),this.$resizableS=null),this.$resizableE&&(this.$resizableE.remove(),this.$resizableE=null),this.$resizableSE&&(this.$resizableSE.remove(),this.$resizableSE=null),this.$resizableW&&(this.$resizableW.remove(),this.$resizableW=null),this.$resizableSW&&(this.$resizableSW.remove(),this.$resizableSW=null),this.$resizableN&&(this.$resizableN.remove(),this.$resizableN=null),this.$resizableNW&&(this.$resizableNW.remove(),this.$resizableNW=null),this.$resizableNE&&(this.$resizableNE.remove(),this.$resizableNE=null),this.$container&&this.$container.removeClass("resizable"),this.$window.off("mouseup.resizable",this._mouseUpHandler).off("mousemove.resizable",this._mousemoveHandler)}},{key:"_onMouseDown",value:function(e){var t=this.$container,n=t.window(),i=s()(e.target),r=t.cssMinWidth(),o=t.cssMinHeight(),a=t.cssMaxWidth(),u=t.cssMaxHeight(),l=No.bounds(t,{exact:!0});this._context={initialBounds:l,minBounds:new Fo(l.right()-r,l.bottom()-o,r,o),maxBounds:new Fo(Math.max(-t.cssMarginLeft(),l.right()-a),Math.max(-t.cssMarginTop(),l.bottom()-u),Math.min(n.width()-t[0].offsetLeft,a),Math.min(n.height()-t[0].offsetTop,u)),distance:[0,0],edge:i.data("edge"),mousedownEvent:e},t.addClass("resizable-resizing"),this.$window.off("mouseup.resizable",this._mouseUpHandler).off("mousemove.resizable",this._mousemoveHandler).on("mouseup.resizable",this._mouseUpHandler).on("mousemove.resizable",this._mousemoveHandler),s()("iframe").addClass("dragging-in-progress")}},{key:"_onMouseUp",value:function(e){this.$container.removeClass("resizable-resizing"),this.$window.off("mouseup.resizable",this._mouseUpHandler).off("mousemove.resizable",this._mousemoveHandler),s()("iframe").removeClass("dragging-in-progress"),this._context=null}},{key:"_onMousemove",value:function(t){var n=this._context,i=n.initialBounds.clone(),r=this._calcDistance(n.mousedownEvent,t);O.isOneOf(n.edge,"ne","e","se")?i.width=Math.max(n.minBounds.width,Math.min(n.maxBounds.width,n.initialBounds.width+r[0])):O.isOneOf(n.edge,"nw","w","sw")&&(i.x=Math.min(n.minBounds.x,Math.max(n.maxBounds.x,n.initialBounds.x+r[0])),i.width+=n.initialBounds.x-i.x),O.isOneOf(n.edge,"sw","s","se")?i.height=Math.max(n.minBounds.height,Math.min(n.maxBounds.height,n.initialBounds.height+r[1])):O.isOneOf(n.edge,"nw","n","ne")&&(i.y=Math.min(n.minBounds.y,Math.max(n.maxBounds.y,n.initialBounds.y+r[1])),i.height+=n.initialBounds.y-i.y),s.a.throttle(this._resizeHandler,e.FPS)(i)}},{key:"_resize",value:function(e){this._cropToBoundaries(e),No.setBounds(this.$container,e),this.$container.trigger("resize",{newBounds:e,initialBounds:this._context.initialBounds})}},{key:"_cropToBoundaries",value:function(e){this._boundaryValueSet(this.boundaries.left)&&e.x>this.boundaries.left&&(e.width-=this.boundaries.left-e.x,e.x=this.boundaries.left),this._boundaryValueSet(this.boundaries.right)&&e.x+e.width<this.boundaries.right&&(e.width=this.boundaries.right-e.x),this._boundaryValueSet(this.boundaries.top)&&e.y>this.boundaries.top&&(e.height-=this.boundaries.top-e.y,e.y=this.boundaries.top),this._boundaryValueSet(this.boundaries.bottom)&&e.y+e.height<this.boundaries.bottom&&(e.height=this.boundaries.bottom-e.y)}},{key:"_boundaryValueSet",value:function(e){return e>0}},{key:"_calcDistance",value:function(e,t){return[t.pageX-e.pageX,t.pageY-e.pageY]}}])&&Zpe(t.prototype,n),i&&Zpe(t,i),e}();function tye(e){return(tye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iye(e,t,n){return(iye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aye(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function rye(e,t){return(rye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=aye(e);if(t){var r=aye(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sye(this,n)}}function sye(e,t){return!t||"object"!==tye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aye(e){return(aye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Qpe(eye,"MODES",{SOUTH:"s",EAST:"e",WEST:"w",NORTH:"n"}),Qpe(eye,"FPS",1e3/15);var uye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rye(e,t)}(o,e);var t,n,i,r=oye(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).unsavedForms=[],e}return t=o,i=[{key:"getFormDisplayName",value:function(e){return[e.title,e.name,e.subTitle].filter(Boolean).join(" - ")}}],(n=[{key:"_jsonModel",value:function(){return{id:"scout.UnsavedFormChangesForm",objectType:"Form",type:"model",title:"${textKey:SaveChangesOfSelectedItems}",askIfNeedSave:!1,rootGroupBox:{id:"MainBox",objectType:"GroupBox",menus:[{id:"OkMenu",objectType:"OkMenu"},{id:"CancelMenu",objectType:"CancelMenu"}],fields:[{id:"UnsavedChangesBox",objectType:"GroupBox",labelVisible:!1,gridColumnCount:1,fields:[{id:"OpenFormsField",objectType:"ListBox",gridDataHints:{h:5},labelVisible:!1}]}]}}}},{key:"_init",value:function(e){iye(aye(o.prototype),"_init",this).call(this,e),this.openFormsField=this.widget("OpenFormsField"),this.openFormsField.setLookupCall(O.create("scout.UnsavedFormsLookupCall",{session:this.session,unsavedForms:this.unsavedForms})),this.openFormsField.table.one("rowsInserted",(function(e){e.source.checkAll(!0)}));var t=O.create("Menu",{parent:this.openFormsField.table,id:"CheckAllMenu",menuTypes:["Table.EmptySpace"],text:"${textKey:CheckAll}"});t.on("action",function(e){this.openFormsField.table.checkAll(!0)}.bind(this));var n=O.create("Menu",{parent:this.openFormsField.table,id:"UncheckAllMenu",menuTypes:["Table.EmptySpace"],text:"${textKey:UncheckAll}"});n.on("action",function(e){this.openFormsField.table.uncheckAll()}.bind(this)),this.openFormsField.table.setMenus([t,n]),this.on("postLoad",function(e){this.touch()}.bind(this))}},{key:"_validate",value:function(e){var t=this.getInvalidForms();if(t.length>0){var n=[];return n.push("<p><b>",this.session.text("NotAllCheckedFormsCanBeSaved"),"</b></p>"),n.push(this.session.text("FormsCannotBeSaved"),"<br><br>"),t.forEach((function(e){n.push("- ",o.getFormDisplayName(e),"<br>")}),this),pi.error({message:n.join("")})}return pi.ok()}},{key:"getInvalidForms",value:function(){var e=[];return this.openFormsField.value.forEach((function(t){var n=t.lifecycle._invalidElements().missingElements.slice(),i=t.lifecycle._invalidElements().invalidElements.slice();t.visitDisplayChildren((function(e){var t=e.lifecycle._invalidElements();et.pushAll(n,t.missingElements),et.pushAll(i,t.invalidElements)}),(function(e){return e instanceof ZO})),(n.length>0||i.length>0)&&e.push(t)})),e}}])&&nye(t.prototype,n),i&&nye(t,i),o}(ZO);function lye(e){return(lye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fye(e,t){return(fye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pye(e);if(t){var r=pye(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dye(this,n)}}function dye(e,t){return!t||"object"!==lye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pye(e){return(pye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fye(e,t)}(o,e);var t,n,i,r=hye(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).unsavedForms=[],e}return t=o,(n=[{key:"_data",value:function(){return this.unsavedForms.map((function(e){return[e,uye.getFormDisplayName(e)]}))}}])&&cye(t.prototype,n),i&&cye(t,i),o}(Rr);function vye(e){return(vye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gye(e,t,n){return(gye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sye(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function mye(e,t){return(mye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Sye(e);if(t){var r=Sye(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wye(this,n)}}function wye(e,t){return!t||"object"!==vye(t)&&"function"!=typeof t?kye(e):t}function kye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sye(e){return(Sye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mye(e,t)}(o,e);var t,n,i,r=_ye(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).table=null,e.labelVisible=!1,e.statusVisible=!1,e.gridColumnCount=7,e.bodyLayoutConfig={hgap:8},e.groupByField=null,e.sortByField=null,e._tableGroupHandler=e._onTableGroup.bind(kye(e)),e._tableSortHandler=e._onTableSort.bind(kye(e)),e._destroyHandler=e._uninstallListeners.bind(kye(e)),e}return t=o,(n=[{key:"_installListeners",value:function(){this.table.on("group",this._tableGroupHandler),this.table.on("sort",this._tableSortHandler),this.table.one("destroy",this._destroyHandler)}},{key:"_uninstallListeners",value:function(){this.table.off("group",this._tableGroupHandler),this.table.off("sort",this._tableSortHandler)}},{key:"_init",value:function(e){gye(Sye(o.prototype),"_init",this).call(this,e),this.table=this.parent,this._installListeners(),this.insertField(O.create("PlaceholderField",{id:"PlaceholderField",parent:this,gridDataHints:{w:5}})),this.groupByField=O.create("SmartField",{id:"GroupByField",parent:this,label:this.session.text("GroupBy"),labelPosition:GH.LabelPosition.ON_FIELD,clearable:GV.Clearable.ALWAYS,statusVisible:!1,displayStyle:B0.DisplayStyle.DROPDOWN}),this.groupByField.setLookupCall(this._createGroupByLookupCall()),this.groupByField.setVisible(!et.empty(this.groupByField.lookupCall.data)),this.groupByField.on("propertyChange",this._onGroupingChange.bind(this)),this.insertField(this.groupByField),this.sortByField=O.create("SmartField",{id:"SortByField",parent:this,label:this.session.text("SortBy"),labelPosition:GH.LabelPosition.ON_FIELD,clearable:GV.Clearable.ALWAYS,statusVisible:!1,displayStyle:B0.DisplayStyle.DROPDOWN}),this.sortByField.setLookupCall(this._createSortByLookupCall()),this.sortByField.setVisible(!et.empty(this.sortByField.lookupCall.data)),this.sortByField.on("propertyChange",this._onSortingChange.bind(this)),this.insertField(this.sortByField),this._syncSortingGroupingFields()}},{key:"_findSortByLookupRowForKey",value:function(e){return this.sortByField.lookupCall.data.map((function(e){return e[0]})).find((function(t){return t.column===e.column&&t.asc===e.asc}),this)}},{key:"_createGroupByLookupCall",value:function(){return O.create("TileTableHeaderGroupByLookupCall",{session:this.session,table:this.table})}},{key:"_createSortByLookupCall",value:function(){return O.create("TileTableHeaderSortByLookupCall",{session:this.session,table:this.table})}},{key:"_onGroupingChange",value:function(e){if(this.table.tileMode&&"value"===e.propertyName){var t;if(this.isGrouping=!0,null!==e.newValue){var n=(t=e.newValue).sortIndex>=0&&!t.sortAscending?"desc":"asc";this.table.groupColumn(t,!1,n,!1)}else t=e.oldValue,this.table.groupColumn(t,!1,null,!0);this.isGrouping=!1}}},{key:"_onSortingChange",value:function(e){this.table.tileMode&&"value"===e.propertyName&&(this.isSorting=!0,null!==e.newValue?(e.newValue.column,e.newValue.column,this.table.sort(e.newValue.column,e.newValue.asc?"asc":"desc",!1,!1)):this.table.sort(e.oldValue,null,!1,!0),this.isSorting=!1)}},{key:"_syncSortingGroupingFields",value:function(){var e=et.find(this.table.visibleColumns(),(function(e){return e.grouped&&0===e.sortIndex}));e?this.groupByField.setValue(e):this.groupByField.setValue(null);var t=et.find(this.table.visibleColumns(),(function(e){return e.sortActive&&0===e.sortIndex}));t?this.sortByField.setValue(this._findSortByLookupRowForKey({column:t,asc:t.sortAscending})):this.sortByField.setValue(null)}},{key:"_onTableGroup",value:function(e){this.isGrouping||this._syncSortingGroupingFields()}},{key:"_onTableSort",value:function(e){this.isSorting||this._syncSortingGroupingFields()}}])&&bye(t.prototype,n),i&&bye(t,i),o}(rY);function Tye(e){return(Tye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pye(e,t){return(Pye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Eye(e);if(t){var r=Eye(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xye(this,n)}}function xye(e,t){return!t||"object"!==Tye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Eye(e){return(Eye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pye(e,t)}(o,e);var t,n,i,r=Rye(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_prepareEssentials",value:function(e){Z.get().init()}},{key:"_doBootstrap",value:function(e){return[]}},{key:"_init",value:function(e){(e=e||{}).texts=s.a.extend({},th.readFromDOM(),e.texts),this._prepareDOM(),O.create("LoginBox",e).render(s()("body").addClass("login-body"))}}])&&Cye(t.prototype,n),i&&Cye(t,i),o}(x);function Fye(e){return(Fye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Aye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $ye(e,t,n){return($ye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bye(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function jye(e,t){return(jye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Bye(e);if(t){var r=Bye(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Iye(this,n)}}function Iye(e,t){return!t||"object"!==Fye(t)&&"function"!=typeof t?Lye(e):t}function Lye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bye(e){return(Bye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jye(e,t)}(o,e);var t,n,i,r=Mye(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).ajaxOptions={type:"POST"},e.authUrl="auth",e.onPostDoneFunc=e.redirect.bind(Lye(e)),e.redirectUrl=null,e.logoUrl="logo.png",e.userDataKey="user",e.passwordDataKey="password",e.additionalData={},e.prepareRedirectUrlFunc=o.prepareRedirectUrl,e.messageKey=null,e.texts={"ui.Login":"Login","ui.LoginFailed":"Login failed","ui.User":"Username","ui.Password":"Password"},e}return t=o,i=[{key:"prepareRedirectUrl",value:function(e){var t=/^([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e||"");return t[1].replace(/login.html$/,"").replace(/login$/,"").replace(/logout$/,"")+(t[2]?t[2]:"")+(t[3]?t[3]:"")}}],(n=[{key:"init",value:function(e){(e=e||{}).texts=new Wf(s.a.extend(this.texts,e.texts)),e.ajaxOptions=s.a.extend(this.ajaxOptions,e.ajaxOptions),s.a.extend(this,e)}},{key:"_render",value:function(){$ye(Bye(o.prototype),"_render",this).call(this),this.$container.addClass("login-box"),this.$content.addClass("login-box-content "),this.$form=s()("<form>").attr("action",this.authUrl).attr("method","post").submit(this._onLoginFormSubmit.bind(this)).appendTo(this.$content),this.messageKey&&(this.$message=s()("<div>").attr("id","message-box").html(En.nl2br(this.texts.get(this.messageKey))).appendTo(this.$form)),this.$user=s()("<input>").attr("type","text").attr("autocapitalize","off").attr("autocorrect","off").placeholder(this.texts.get("ui.User")).addClass("alternative").appendTo(this.$form),this.$password=s()("<input>").attr("type","password").placeholder(this.texts.get("ui.Password")).addClass("alternative").appendTo(this.$form),this.$button=s()("<button>").attr("type","submit").addClass("login-button button default").text(this.texts.get("ui.Login")).appendTo(this.$form),this.$user.focus()}},{key:"_resetButtonText",value:function(){this.$button.text(this.texts.get("ui.Login")).removeClass("login-error")}},{key:"data",value:function(){var e={};return e[this.userDataKey]=this.$user.val(),e[this.passwordDataKey]=this.$password.val(),s.a.extend(e,this.additionalData),e}},{key:"_onLoginFormSubmit",value:function(e){e.preventDefault();var t=this.$form.attr("action"),n=this.data();this.$button.removeClass("login-error").setEnabled(!1),this.$user.off("input.resetLoginError"),this.$password.off("input.resetLoginError"),Mt.get().supportsCssAnimation()&&this.$button.html("").append(s()("<div>").addClass("login-button-loading"));var i=s.a.extend({},this.ajaxOptions,{url:t,data:n});s.a.ajax(i).done(this._onPostDone.bind(this)).fail(this._onPostFail.bind(this))}},{key:"redirect",value:function(e){var t=this.redirectUrl;t||(t=(window.location.href||"").trim(),t=this.prepareRedirectUrlFunc(t)),t?window.location.href=t:window.location.reload()}},{key:"_onPostDone",value:function(e){this.remove(),this.onPostDoneFunc.call(this,e)}},{key:"_onPostFail",value:function(e,t,n){setTimeout(this._onPostFailImpl.bind(this,e,t,n),300)}},{key:"_onPostFailImpl",value:function(e,t,n){this.$button.setEnabled(!0).html("").text(this.texts.get("ui.LoginFailed")).addClass("login-error"),this.$user.val("").focus(),this.$password.val(""),setTimeout(function(){this.$user.one("input.resetLoginError",this._resetButtonText.bind(this)),this.$password.one("input.resetLoginError",this._resetButtonText.bind(this))}.bind(this))}}])&&Aye(t.prototype,n),i&&Aye(t,i),o}(qh);function Hye(e){return(Hye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wye(e,t){return(Wye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Uye(e);if(t){var r=Uye(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gye(this,n)}}function Gye(e,t){return!t||"object"!==Hye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uye(e){return(Uye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wye(e,t)}(o,e);var t,n,i,r=zye(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"_prepareEssentials",value:function(e){Z.get().init()}},{key:"_doBootstrap",value:function(e){return[]}},{key:"_init",value:function(e){(e=e||{}).texts=s.a.extend({},th.readFromDOM(),e.texts),this._prepareDOM(),O.create("LogoutBox",e).render(s()("body").addClass("logout-body"))}}])&&Vye(t.prototype,n),i&&Vye(t,i),o}(x);function qye(e){return(qye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xye(e,t,n){return(Xye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eve(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Jye(e,t){return(Jye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=eve(e);if(t){var r=eve(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Qye(this,n)}}function Qye(e,t){return!t||"object"!==qye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eve(e){return(eve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jye(e,t)}(o,e);var t,n,i,r=Zye(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this)}return t=o,(n=[{key:"init",value:function(e){var t={loginUrl:Gi.getItem(sessionStorage,"scout:loginUrl")||"./",logoUrl:"logo.png"};this.options=s.a.extend({},t,e),this.options.texts=s.a.extend({},{"ui.LogoutSuccessful":"Good bye!","ui.LoginAgain":"Login again"},e.texts),this.texts=new Wf(this.options.texts),this.loginUrl=this.options.loginUrl,this.logoUrl=this.options.logoUrl}},{key:"_render",value:function(){Xye(eve(o.prototype),"_render",this).call(this),this.$content.addClass("small centered").appendDiv().html(En.nl2br(this.texts.get("ui.LogoutSuccessful"))),this.$buttonBar=s()("<div>").addClass("button-bar").appendTo(this.$content),s()("<button>").addClass("button").text(this.texts.get("ui.LoginAgain")).on("click",this._loginAgain.bind(this)).appendTo(this.$buttonBar)}},{key:"_loginAgain",value:function(){window.location=this.loginUrl}}])&&Yye(t.prototype,n),i&&Yye(t,i),o}(qh);function nve(e){return(nve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ive(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rve(e,t,n){return(rve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uve(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function ove(e,t){return(ove=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=uve(e);if(t){var r=uve(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ave(this,n)}}function ave(e,t){return!t||"object"!==nve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uve(e){return(uve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ove(e,t)}(o,e);var t,n,i,r=sve(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).ref=null,e}return t=o,(n=[{key:"_render",value:function(){rve(uve(o.prototype),"_render",this).call(this),this.$container.addClass("breadcrumb-item")}},{key:"_renderText",value:function(){var e=this.text||"";e&&this.textVisible?(this.$text||(this.$text=this.$container.appendSpan("content text"),Uo.install(this.$text,this.session)),this.$text.text(e)):this._removeText()}}])&&ive(t.prototype,n),i&&ive(t,i),o}(Eh);function cve(e){return(cve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fve(e,t){return(fve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=pve(e);if(t){var r=pve(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dve(this,n)}}function dve(e,t){return!t||"object"!==cve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pve(e){return(pve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fve(e,t)}(n,e);var t=hve(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Lh);function vve(e){return(vve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gve(e,t,n){return(gve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kve(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function mve(e,t){return(mve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=kve(e);if(t){var r=kve(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wve(this,n)}}function wve(e,t){return!t||"object"!==vve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kve(e){return(kve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mve(e,t)}(o,e);var t,n,i,r=_ve(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).breadcrumbItems=[],e._ellipsisBreadcrumbItem=null,e._addWidgetProperties(["breadcrumbItems"]),e}return t=o,(n=[{key:"_init",value:function(e){gve(kve(o.prototype),"_init",this).call(this,e),this._setBreadcrumbItems(this.breadcrumbItems)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("breadcrumb-bar"),this.htmlComp=Uo.install(this.$container,this.session),this.htmlComp.setLayout(new Fve(this))}},{key:"_renderProperties",value:function(){gve(kve(o.prototype),"_renderProperties",this).call(this),this._renderBreadcrumbItems()}},{key:"setBreadcrumbItems",value:function(e){this.setProperty("breadcrumbItems",e)}},{key:"_setBreadcrumbItems",value:function(e){this._setProperty("breadcrumbItems",et.ensure(e))}},{key:"_renderBreadcrumbItems",value:function(){var e=this;this.breadcrumbItems.forEach((function(t,n){1===n&&e._renderEllipsis(),t.render()}),this),this._updateMarkers(),this.htmlComp.invalidateLayoutTree()}},{key:"_renderEllipsis",value:function(){this._ellipsisBreadcrumbItem&&this._ellipsisBreadcrumbItem.destroy(),this.breadcrumbItems.length<=2||(this._ellipsisBreadcrumbItem=O.create("BreadcrumbItem",{parent:this,text:"...",enabled:!1}),this._ellipsisBreadcrumbItem.render())}},{key:"_updateMarkers",value:function(){var e=[];this.breadcrumbItems.forEach((function(t){t.rendered&&(t.$container.removeClass("first last"),t.isVisible()&&e.push(t))})),e.length&&(e[0].$container.addClass("first"),e[e.length-1].$container.addClass("last"))}}])&&bve(t.prototype,n),i&&bve(t,i),o}(de);function Ove(e){return(Ove="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cve(e,t){return(Cve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Eve(e);if(t){var r=Eve(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Rve(this,n)}}function Rve(e,t){return!t||"object"!==Ove(t)&&"function"!=typeof t?xve(e):t}function xve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eve(e){return(Eve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cve(e,t)}(o,e);var t,n,i,r=Pve(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Dve(xve(t=r.call(this)),"_collapse",(function(e,t){for(var n=this._visibleBreadcrumbItems(),i=this._actualPrefSize(n,!0);i.width>t.width&&1<n.length-1;){var r=n[1];r.$container.hide(),r._layHidden=!0,n.splice(1,1),i=this._actualPrefSize(n,!0)}})),Dve(xve(t),"_breadcrumbItemsWidth",(function(e,t){var n=0;return(e=e||this._visibleBreadcrumbItems()).forEach((function(e){e.rendered&&(n+=e.$container.outerWidth(!0))}),this),t&&this._breadcrumbBar._ellipsisBreadcrumbItem&&this._breadcrumbBar._ellipsisBreadcrumbItem.rendered&&(n+=this._breadcrumbBar._ellipsisBreadcrumbItem.$container.outerWidth(!0)),n})),t._breadcrumbBar=e,t}return t=o,(n=[{key:"layout",value:function(e){this._undoCollapse(this._breadcrumbBar.breadcrumbItems);var t=this._visibleBreadcrumbItems(),n=this._breadcrumbBar.htmlComp.size();this._actualPrefSize(t,!1).width<=n.width?this._applyToEllipsis((function(e){e.setVisible(!1)})):(this._applyToEllipsis((function(e){e.setVisible(!0)})),this._collapse(t,n))}},{key:"_applyToEllipsis",value:function(e){this._breadcrumbBar._ellipsisBreadcrumbItem&&e(this._breadcrumbBar._ellipsisBreadcrumbItem)}},{key:"_undoCollapse",value:function(){et.ensure(this._breadcrumbBar.breadcrumbItems).forEach((function(e){e.$container.show(),e._layHidden=!1}))}},{key:"preferredLayoutSize",value:function(e){var t=this._visibleBreadcrumbItems();return this._undoCollapse(t),this._actualPrefSize()}},{key:"_breadcrumbSize",value:function(e){var t=e.$container.attr("class");e.$container.removeClass("hidden"),e.htmlComp.invalidateLayout();var n=e.htmlComp.prefSize({useCssSize:!0,exact:!0}).add(No.margins(e.$container));return e.$container.attrOrRemove("class",t),n}},{key:"_visibleBreadcrumbItems",value:function(){return this._breadcrumbBar.breadcrumbItems.filter((function(e){return e.visible}),this)}},{key:"_actualPrefSize",value:function(e,t){e=e||this._visibleBreadcrumbItems();var n=this._breadcrumbItemsWidth(e,t),i=No.prefSize(this._breadcrumbBar.$container,{includeMargin:!0,useCssSize:!0});return i.width=n+this._breadcrumbBar.htmlComp.insets().horizontal(),i}}])&&Tve(t.prototype,n),i&&Tve(t,i),o}(zo);function Ave(e){return(Ave="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $ve(e,t){return($ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Ive(e);if(t){var r=Ive(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Mve(this,n)}}function Mve(e,t){return!t||"object"!==Ave(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ive(e){return(Ive=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$ve(e,t)}(n,e);var t=jve(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(fe);function Bve(e){return(Bve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hve(e,t){return(Hve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=zve(e);if(t){var r=zve(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Wve(this,n)}}function Wve(e,t){return!t||"object"!==Bve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zve(e){return(zve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hve(e,t)}(o,e);var t,n,i,r=Vve(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this))._addWidgetProperties(["breadcrumbBar"]),e}return t=o,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"breadcrumb-bar-field"),this.breadcrumbBar&&this._renderBreadcrumbBar()}},{key:"_renderBreadcrumbBar",value:function(){this.breadcrumbBar.render(),this.addLabel(),this.addMandatoryIndicator(),this.addField(this.breadcrumbBar.$container),this.addStatus()}},{key:"setBreadcrumbBar",value:function(e){this._setBreadcrumbBar(e)}},{key:"setBreadcrumbItems",value:function(e){this.breadcrumbBar.setBreadcrumbItems(e)}},{key:"_removeBreadcrumbBar",value:function(){this.breadcrumbBar.remove(),this._removeField()}}])&&Nve(t.prototype,n),i&&Nve(t,i),o}(GH);function Uve(e){return(Uve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kve(e,t){return(Kve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Xve(e);if(t){var r=Xve(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Yve(this,n)}}function Yve(e,t){return!t||"object"!==Uve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xve(e){return(Xve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kve(e,t)}(n,e);var t=qve(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ZH);function Zve(e){return(Zve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qve(e){var t=[];return e.forEach((function(e){"margin"===e||"padding"===e?(t.push(e+"-top"),t.push(e+"-right"),t.push(e+"-bottom"),t.push(e+"-left")):"border"===e?(t.push("border-top-style"),t.push("border-right-style"),t.push("border-bottom-style"),t.push("border-left-style"),t.push("border-top-color"),t.push("border-right-color"),t.push("border-bottom-color"),t.push("border-left-color"),t.push("border-top-width"),t.push("border-right-width"),t.push("border-bottom-width"),t.push("border-left-width")):t.push(e)})),t}function ebe(e){return oi.isNumber(e)?Math.ceil(e):e}O.addObjectFactories({KeyStroke:function(){return new Eh},KeyStrokeAdapter:function(){return new Lh},ComposerField:function(){return new h8},ComposerFieldAdapter:function(){return new g8}});var tbe=s.a.cleanData;s.a.cleanData=function(e){var t,n,i;for(i=0;n=e[i];i++)try{(t=s.a._data(n,"events"))&&t.remove&&s()(n).triggerHandler("remove")}catch(e){}tbe(e)},s.a.removeThis=function(){s()(this).remove()},s.a.suppressEvent=function(e){e&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())},s.a.suppressEventIfDisabled=function(e,t){return!(t=t||s()(e.target)).isEnabled()&&(s.a.suppressEvent(e),!0)},s.a.debounce=function(e,t){"number"==typeof t&&(t={delay:t}),t=s.a.extend({delay:250,reschedule:!0},t);var n=null,i=function(){var i=this,r=arguments;n&&!t.reschedule||(n&&clearTimeout(n),n=setTimeout((function(){n=null,e.apply(i,r)}),t.delay))};return i.cancel=function(){return!!n&&(clearTimeout(n),n=null,!0)},i},s.a.throttle=function(e,t){t=void 0!==t?t:250;var n,i=null;return function(){var r=this,o=arguments,s=(new Date).getTime(),a=function(){n=s,e.apply(r,o)};n&&n+t>s?(clearTimeout(i),i=setTimeout((function(){a()}),t)):a()}},s.a.negate=function(e){return function(){return!e.apply(this,arguments)}},s.a.colorOpacity=function(e,t){(e=String(e).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;for(var n="#",i=0;i<3;i++){var r=parseInt(e.substr(2*i,2),16);n+=("00"+(r=Math.round(Math.min(Math.max(0,255-(255-r)*t),255)).toString(16))).substr(r.length)}return n},s.a.injectScript=function(e,t){t=t||{};var n=s.a.Deferred(),i=t.document||window.document,r=i.createElement("script");return s()(r).attr("src",e).attr("async",!0).on("load error",(function(e){t.removeTag&&i.head.removeChild(r),"error"===e.type?n.reject(s()(r)):n.resolve(s()(r))})),i.head.appendChild(r),n.promise()},s.a.injectStyleSheet=function(e,t){t=t||{};var n=s.a.Deferred(),i=t.document||window.document,r=i.createElement("link");return s()(r).attr("rel","stylesheet").attr("type","text/css").attr("href",e).on("load error",(function(e){"error"===e.type?n.reject(s()(r)):n.resolve(s()(r))})),i.head.appendChild(r),n.promise()},s.a.injectStyle=function(e,t){var n=(t=t||{}).document||window.document,i=n.createElement("style"),r=s()(i);return r.attr("type","text/css").html(e),n.head.appendChild(i),r},s.a.pxToNumber=function(e){return e?parseFloat(e):0},s.a.resolvedDeferred=function(){var e=s.a.Deferred();return e.resolve.apply(e,arguments),e},s.a.resolvedPromise=function(){var e=s.a.Deferred();return e.resolve.apply(e,arguments),e.promise()},s.a.rejectedPromise=function(){var e=s.a.Deferred();return e.reject.apply(e,arguments),e.promise()},s.a.promiseAll=function(e,t){t=O.nvl(t,!1),e=et.ensure(e);var n=s.a.Deferred();return s.a.when.apply(s.a,e).done((function(){t?n.resolve(oi.argumentsToArray(arguments)):n.resolve.apply(this,arguments)})).fail((function(){n.reject.apply(this,arguments)})),n.promise()},s.a.ajaxJson=function(e){return s.a.ajax({url:e,dataType:"json",contentType:"application/json; charset=UTF-8"}).catch((function(){var e=oi.argumentsToArray(arguments);return e.push(this),s.a.rejectedPromise.apply(s.a,e)}))},s.a.ensure=function(e){return e instanceof s.a?e:s()(e)},s.a.isJqXHR=function(e){return"object"===Zve(e)&&e.hasOwnProperty("readyState")&&e.hasOwnProperty("status")&&e.hasOwnProperty("statusText")},s.a.fn.nvl=function(e){return!this.length&&e instanceof s.a?e:this},s.a.fn.makeElement=function(e,t,n){var i=this.document(!0);if(void 0===i||void 0===e)return new Error("missing arguments: document, element");var r=s()(e,i);return t&&r.addClass(t),n&&r.text(n),r},s.a.fn.makeDiv=function(e,t){return this.makeElement("<div>",e,t)},s.a.fn.makeSpan=function(e,t){return this.makeElement("<span>",e,t)},s.a.fn.document=function(e){var t=this.length?this[0]instanceof Document?this[0]:this[0].ownerDocument:null;return e?t:s()(t)},s.a.fn.window=function(e){var t=this.document(!0),n=t?t.defaultView:null;return e?n:s()(n)},s.a.fn.activeElement=function(e){var t=this.document(!0),n=t?t.activeElement:null;return e?n:s()(n)},s.a.fn.body=function(e){var t=s()("body",this.document(!0));return e?t[0]:t},s.a.fn.entryPoint=function(e){var t=this.closest(".scout");return e?t[0]:t},s.a.fn.windowSize=function(){var e=this.window();return new Co(e.width(),e.height())},s.a.fn.elementFromPoint=function(e,t,n){var i,r=s()(this),o=r.document(!0),a=[],u=0;if(o||(o=r[0]),!o)return s()();for(;0!==(i=s()(o.elementFromPoint(e,t))).length&&i[0]!==o.documentElement&&(!r.isOrHas(i)||n&&!i.is(n));)if(a.push(i),i.addClass("invisible"),++u>1e3){s.a.log.warn("Infinite loop aborted",i),i=s()();break}return i[0]===o.documentElement&&r[0]!==o&&(i=s()()),a.forEach((function(e){e.removeClass("invisible")})),i},s.a.fn.prependDiv=function(e,t){return this.makeDiv(e,t).prependTo(this)},s.a.fn.appendDiv=function(e,t){return this.makeDiv(e,t).appendTo(this)},s.a.fn.prependElement=function(e,t,n){return this.makeElement(e,t,n).prependTo(this)},s.a.fn.appendElement=function(e,t,n){return this.makeElement(e,t,n).appendTo(this)},s.a.fn.afterDiv=function(e,t){return this.makeDiv(e,t).insertAfter(this)},s.a.fn.beforeDiv=function(e,t){return this.makeDiv(e,t).insertBefore(this)},s.a.fn.appendSpan=function(e,t){return this.makeSpan(e,t).appendTo(this)},s.a.fn.appendBr=function(e){return this.makeElement("<br>",e).appendTo(this)},s.a.fn.appendTextNode=function(e){return s()(this.document(!0).createTextNode(e)).appendTo(this)},s.a.fn.appendIcon=function(e,t){return e?(n=e instanceof Bv?e:sn.parseIconId(e)).isFontIcon()?this.makeSpan(t,n.iconCharacter).addClass("icon").addClass(n.appendCssClass("font-icon")).appendTo(this):this.appendImg(n.iconUrl,t).addClass("icon image-icon"):this.appendSpan(t).addClass("icon");var n},s.a.fn.appendImg=function(e,t){var n=this.appendElement("<img>",t);return e&&n.attr("src",e),n},s.a.fn.makeSVG=function(e,t,n,i){var r=this.document(!0);if(void 0===r||void 0===e)return new Error("missing arguments: document, type");var o=s()(r.createElementNS("http://www.w3.org/2000/svg",e));return t&&o.attr("class",t),n&&o.text(n),void 0!==i&&o.attr("id",i),o},s.a.fn.appendSVG=function(e,t,n,i){return this.makeSVG(e,t,n,i).appendTo(this)},s.a.fn.attrXLINK=function(e,t){return 0===this.length?this:1===this.length?(this[0].setAttributeNS("http://www.w3.org/1999/xlink","xlink:"+e,t),this):this.each((function(){this.setAttributeNS("http://www.w3.org/1999/xlink","xlink:"+e,t)}))},s.a.fn.addDeviceClass=function(){var e=Mt.get();return e.isInternetExplorer()&&(this.addClass("ie"),9===e.browserVersion&&this.addClass("ie9")),e.isIos()&&this.addClass("ios"),this},s.a.fn.selectOne=function(){return this.siblings().removeClass("selected"),this.addClass("selected"),this},s.a.fn.select=function(e){return this.toggleClass("selected",!!e)},s.a.fn.isSelected=function(){return this.hasClass("selected")},s.a.fn.setEnabled=function(e){return e=!!e,this.toggleClass("disabled",!e),this.is("button, input, select, textarea, optgroup, option, fieldset")&&this.toggleAttr("disabled",!e),this.trigger(e?"enable":"disable"),this},s.a.fn.isEnabled=function(){return!this.hasClass("disabled")},s.a.fn.setVisible=function(e){return!this.hasClass("hidden")===e||(e?(this.removeClass("hidden"),this.trigger("show")):(this.addClass("hidden"),this.trigger("hide"))),this},s.a.fn.isDisplayNone=function(){return"none"===this.css("display")},s.a.fn.setTabbable=function(e){return this.attr("tabIndex",e?0:null)},s.a.fn.isTabbable=function(){return this.attr("tabIndex")>=0},s.a.fn.icon=function(e,t){var n,i=this.data("$icon");return e?(n=sn.parseIconId(e)).isFontIcon()?r.call(this,i,"<span>",t).addClass("icon").addClass(n.appendCssClass("font-icon")).text(n.iconCharacter):r.call(this,i,"<img>",t).attr("src",n.iconUrl).addClass("icon image-icon"):o.call(this,i),this;function r(e,t,n){return e&&!e.is(t.replace(/[<>]/g,""))&&(o.call(this,e),e=null),e||(e=s()(t),this.data("$icon",e),n?n.call(this,e):this.prepend(e)),e}function o(e){e&&e.remove(),this.removeData("$icon")}},s.a.fn.placeholder=function(e){return this.toggleAttr("placeholder",!!e,e)},s.a.fn.isVisible=function(){return!this.hasClass("hidden")&&function(e){if(!e||n(e.style))return!1;var t=(e instanceof Document?e:e.ownerDocument).defaultView;return!!t&&!n(t.getComputedStyle(e));function n(e){return"none"===e.display}}(this[0])},s.a.fn.isEveryParentVisible=function(){var e=!0;return this.parents().each((function(){if(!s()(this).isVisible())return e=!1,!1})),e},s.a.fn.isAttached=function(){return s.a.contains(this.document(!0).documentElement,this[0])},s.a.fn.scrollParent=function(){for(var e=this;e.length>0;){if(e.data("scrollable"))return e;e=e.parent()}return s()()},s.a.fn.scrollParents=function(){for(var e=s()(),t=this;t.length>0;)t.data("scrollable")&&e.push(t),t=t.parent();return e},s.a.fn.animateAVCSD=function(e,t,n,i,r){var o={},s={};return o[e]=t,n&&(s.complete=n),i&&(s.step=i),r&&(s.duration=r),s.queue=!1,this.animate(o,s),this},s.a.fn.animateSVG=function(e,t,n,i,r){return this.each((function(){var o=parseFloat(s()(this).attr(e));if(r){var a=i;i=function(){a&&a.call(this),s()(this).removeAttr("tabindex")}}s()(this).animate({tabIndex:0},{step:function(n,i){this.setAttribute(e,o+(t-o)*i.pos)},duration:n,complete:i,queue:!1})}))},s.a.fn.addClassForAnimation=function(e,t){var n={classesToRemove:e};return t=s.a.extend({},n,t),this.addClass(e),this.oneAnimationEnd(function(){this.removeClass(t.classesToRemove)}.bind(this)),this},s.a.fn.oneAnimationEnd=function(e,t,n){return this.one("animationend webkitAnimationEnd",e,t,n)},s.a.fn.hasAnimationClass=function(){return/(^|\s)animate-/.test(this.attr("class"))},s.a.fn.cssWidthAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.cssWidth(e),this.animate({width:t},n),this},s.a.fn.cssHeightAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.cssHeight(e),this.animate({height:t},n),this},s.a.fn.cssLeftAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.cssLeft(e),this.animate({left:t},n),this},s.a.fn.cssTopAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.cssTop(e),this.animate({top:t},n),this},s.a.fn.cssAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.css(e),this.animate(t,n),this},s.a.fn.widthToContent=function(e){var t=this.outerWidth(),n=this.css("width","auto").outerWidth();return this.cssWidthAnimated(t,n,e),this},s.a.fn.offsetTo=function(e){var t=e.offset(),n=this.offset();return{top:n.top-t.top,left:n.left-t.left}},s.a.fn.cssPxValue=function(e,t){return void 0===t?s.a.pxToNumber(this.css(e)):(null===t&&(t=""),"string"==typeof t?this.css(e,t):this.css(e,t+"px"))},s.a.fn.cssLeft=function(e){return this.cssPxValue("left",e)},s.a.fn.cssTop=function(e){return this.cssPxValue("top",e)},s.a.fn.cssPosition=function(e){return this.cssLeft(e.x).cssTop(e.y)},s.a.fn.cssBottom=function(e){return this.cssPxValue("bottom",e)},s.a.fn.cssRight=function(e){return this.cssPxValue("right",e)},s.a.fn.cssWidth=function(e){return this.cssPxValue("width",e)},s.a.fn.cssMinWidth=function(e){if(void 0===e){var t=this.css("min-width");return"auto"===t||-1!==t.indexOf("%")?0:s.a.pxToNumber(t)}return this.cssPxValue("min-width",e)},s.a.fn.cssMaxWidth=function(e){if(void 0===e){var t=this.css("max-width");return"none"===t||-1!==t.indexOf("%")?Number.MAX_VALUE:s.a.pxToNumber(t)}return this.cssPxValue("max-width",e)},s.a.fn.cssHeight=function(e){return this.cssPxValue("height",e)},s.a.fn.cssMinHeight=function(e){if(void 0===e){var t=this.css("min-height");return"auto"===t||-1!==t.indexOf("%")?0:s.a.pxToNumber(t)}return this.cssPxValue("min-height",e)},s.a.fn.cssMaxHeight=function(e){if(void 0===e){var t=this.css("max-height");return"none"===t||-1!==t.indexOf("%")?Number.MAX_VALUE:s.a.pxToNumber(t)}return this.cssPxValue("max-height",e)},s.a.fn.cssLineHeight=function(e){return this.cssPxValue("line-height",e)},s.a.fn.cssMarginLeft=function(e){return this.cssPxValue("margin-left",e)},s.a.fn.cssMarginBottom=function(e){return this.cssPxValue("margin-bottom",e)},s.a.fn.cssMarginRight=function(e){return this.cssPxValue("margin-right",e)},s.a.fn.cssMarginTop=function(e){return this.cssPxValue("margin-top",e)},s.a.fn.cssMarginX=function(e){return void 0===e?this.cssMarginLeft()+this.cssMarginRight():(this.cssMarginLeft(e),this.cssMarginRight(e),this)},s.a.fn.cssMarginY=function(e){return void 0===e?this.cssMarginTop()+this.cssMarginBottom():(this.cssMarginTop(e),this.cssMarginBottom(e),this)},s.a.fn.cssPaddingTop=function(e){return this.cssPxValue("padding-top",e)},s.a.fn.cssPaddingRight=function(e){return this.cssPxValue("padding-right",e)},s.a.fn.cssPaddingBottom=function(e){return this.cssPxValue("padding-bottom",e)},s.a.fn.cssPaddingLeft=function(e){return this.cssPxValue("padding-left",e)},s.a.fn.cssPaddingX=function(e){return void 0===e?this.cssPaddingLeft()+this.cssPaddingRight():(this.cssPaddingLeft(e),this.cssPaddingRight(e),this)},s.a.fn.cssPaddingY=function(e){return void 0===e?this.cssPaddingTop()+this.cssPaddingBottom():(this.cssPaddingTop(e),this.cssPaddingBottom(e),this)},s.a.fn.cssBorderBottomWidth=function(e){return this.cssPxValue("border-bottom-width",e)},s.a.fn.cssBorderLeftWidth=function(e){return this.cssPxValue("border-left-width",e)},s.a.fn.cssBorderRightWidth=function(e){return this.cssPxValue("border-right-width",e)},s.a.fn.cssBorderTopWidth=function(e){return this.cssPxValue("border-top-width",e)},s.a.fn.cssBorderWidthY=function(e){if(void 0===e)return this.cssBorderTopWidth()+this.cssBorderBottomWidth();this.cssBorderTopWidth(e),this.cssBorderBottomWidth(e)},s.a.fn.cssBorderWidthX=function(e){if(void 0===e)return this.cssBorderLeftWidth()+this.cssBorderRightWidth();this.cssBorderLeftWidth(e),this.cssBorderRightWidth(e)},s.a.fn.innerBottom=function(){return this.position().top+this.outerHeight(!0)-this.cssMarginBottom()-this.cssBorderBottomWidth()},s.a.fn.innerRight=function(){return this.position().left+this.outerWidth(!0)-this.cssMarginRight()-this.cssBorderRightWidth()},s.a.fn.copyCss=function(e,t){var n=t.split(" "),i=this;return(n=Qve(n)).forEach((function(t){i.css(t,e.css(t))})),i},s.a.fn.copyCssIfGreater=function(e,t){var n=t.split(" "),i=this;return(n=Qve(n)).forEach((function(t){var n=s.a.pxToNumber(e.css(t));n>s.a.pxToNumber(i.css(t))&&i.css(t,n+"px")})),i},s.a.fn.copyCssClasses=function(e,t){var n=t.split(" "),i=this;return n.forEach((function(t){e.hasClass(t)&&i.addClass(t)})),i},s.a.fn.disableSpellcheck=function(){return this.attr("spellcheck",!1)},s.a.fn.isOrHas=function(e){return e instanceof s.a&&(e=e[0]),this[0]===e||this.has(e).length>0},s.a.fn.resizable=function(e){var t=s()(this),n=t.data("resizable");return n||(n=O.create("Resizable",s.a.extend(e,{$container:t})),t.data("resizable",n)),this},s.a.fn.unresizable=function(){var e=s()(this),t=e.data("resizable");return t&&(t.destroy(),e.removeData("resizable")),this},s.a.fn.draggable=function(e,t){var n=this;return(e=e||n).on("mousedown.draggable",(function(i){s()("iframe").addClass("dragging-in-progress");var r=n.offset(),o=i,a=e.width(),u=e.window().width(),l=e.window().height();e.parents().on("mousemove.dragging",(function(e){var i=r.top+(e.pageY-o.pageY),s=r.left+(e.pageX-o.pageX);s=Math.max(100-a,s),s=Math.min(u-100,s),i=Math.max(0,i);var c={top:i=Math.min(l-100,i),left:s};n.offset(c),t&&t(c)})).on("mouseup.dragging",(function(t){e.parents().off(".dragging"),s()("iframe").removeClass("dragging-in-progress")})),i.preventDefault()}))},s.a.fn.undraggable=function(e){return(e=e||this).off("mousedown.draggable")},s.a.fn.fadeOutAndRemove=function(e,t){return void 0===t&&"function"==typeof e&&(t=e,e=void 0),e=O.nvl(e,150),this.stop(!0).fadeOut(e,(function(){s()(this).remove(),t&&t.call(this)}))},s.a.fn.removeAnimated=function(e,t){void 0===t&&"function"==typeof e&&(t=e,e=void 0),this.isDisplayNone()?(this.remove(),t&&t.call(this)):Mt.get().supportsCssAnimation()?(this.addClass(e||"animate-remove"),this.oneAnimationEnd((function(){s()(this).remove(),t&&t.call(this)}))):this.fadeOutAndRemove(t)};var nbe=s.a.fn.hide;s.a.fn.hide=function(){return this.trigger("hide"),nbe.apply(this,arguments)};var ibe=s.a.fn.width;s.a.fn.width=function(){return ebe(ibe.apply(this,arguments))};var rbe=s.a.fn.outerWidth;s.a.fn.outerWidth=function(){return ebe(rbe.apply(this,arguments))};var obe=s.a.fn.height;s.a.fn.height=function(){return ebe(obe.apply(this,arguments))};var sbe=s.a.fn.outerHeight;function abe(e,t){var n=e.nodeName.toLowerCase();return(/input|select|textarea|button|object/.test(n)?!e.disabled:"a"===n&&e.href||t)&&function(e){return s.a.expr.filters.visible(e)&&!s()(e).parents().addBack().filter((function(){return"hidden"===s.a.css(this,"visibility")})).length}(e)}function ube(){return(ube=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function lbe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function cbe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}s.a.fn.outerHeight=function(){return ebe(sbe.apply(this,arguments))},s.a.fn.textOrNbsp=function(e,t){return this.contentOrNbsp(!1,e,t)},s.a.fn.htmlOrNbsp=function(e,t){return this.contentOrNbsp(!0,e,t)},s.a.fn.contentOrNbsp=function(e,t,n){var i=e?this.html:this.text;return En.hasText(t)?(i.call(this,t),n&&this.removeClass(n)):(this.html("&nbsp;"),n&&this.addClass(n)),this},s.a.fn.toggleAttr=function(e,t,n){return e?(void 0===n&&(n=e),this.each((function(){var i=s()(this);void 0===t&&(t=void 0===i.attr(e)),t?i.attr(e,n):i.removeAttr(e)}))):this},s.a.fn.backupSelection=function(){var e=this[0];return e&&e===this.activeElement(!0)?{selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,selectionDirection:e.selectionDirection}:null},s.a.fn.restoreSelection=function(e){var t=this[0];return t&&t===this.activeElement(!0)&&e&&t.setSelectionRange(e.selectionStart,e.selectionEnd,e.selectionDirection),this},s.a.fn.attrOrRemove=function(e,t){return t?this.attr(e,t):this.removeAttr(e),this},s.a.fn.appendAppLink=function(e,t){return this.appendSpan().appLink(e,t)},s.a.fn.appLink=function(e,t){return t?"object"===Zve(t)&&t._onAppLinkAction&&(t=t._onAppLinkAction.bind(t)):t=function(e){var t=O.widget(this);t&&t._onAppLinkAction&&t._onAppLinkAction(e)}.bind(this),this.addClass("app-link").attr("tabindex","0").unfocusable().on("click",t),"string"==typeof e?this.attr("data-ref",e):this.text(e.name).attr("data-ref",e.ref),this},s.a.fn.unfocusable=function(){return this.addClass("unfocusable")},s.a.fn.selectAllText=function(){var e,t=this.document(!0),n=this.window(!0),i=this[0];return t&&t.body&&n&&i?t.body.createTextRange?((e=t.body.createTextRange()).moveToElementText(i),e.select(),this):(n.getSelection&&((e=t.createRange()).selectNodeContents(i),n.getSelection().removeAllRanges(),n.getSelection().addRange(e)),this):this},s.a.fn._getClientAndScrollWidthRounded=function(){var e=this[0],t=Mt.get();return t.isInternetExplorer()||t.isEdge()?{clientWidth:Math.ceil(e.getBoundingClientRect().width)-this.cssBorderWidthX(),scrollWidth:e.scrollWidth}:{clientWidth:e.clientWidth,scrollWidth:e.scrollWidth}},s.a.fn._getClientAndScrollWidthReliable=function(){var e=this._getClientAndScrollWidthRounded();if(!Mt.get().isScrollWidthIncludingPadding())return e;if(e.scrollWidth>e.clientWidth)return e;var t=this.cssPaddingRight(),n=this.attr("style");if(t>0&&(this.css({width:e.clientWidth-t,paddingRight:"0px"}),e=this._getClientAndScrollWidthRounded(),this.attrOrRemove("style",n),e.scrollWidth>e.clientWidth))return e;var i=this[0].getBoundingClientRect().width;this.css("width","auto"),this.css("max-width","none");var r=this[0].getBoundingClientRect().width;return this.attrOrRemove("style",n),{clientWidth:i,scrollWidth:r}},s.a.fn.isContentTruncated=function(){var e=this._getClientAndScrollWidthReliable();if(e.scrollWidth>e.clientWidth)return!0},s.a.fn.onSingleOrDoubleClick=function(e,t,n){return this.each((function(){var n=this,i=0,r=O.nvl(r,300);s()(this).on("click",(function(o){1===++i&&setTimeout((function(){1===i?e.call(n,o):t.call(n,o),i=0}),r)}))}))},s.a.fn.onPassive=function(e,t){var n=Ft.passiveOptions();return this[0].addEventListener(e,t,n),this},s.a.fn.offPassive=function(e,t){var n=Ft.passiveOptions();return this[0].removeEventListener(e,t,n),this},s.a.fn.appendTable=function(e){return this.appendElement("<table>",e)},s.a.fn.appendColgroup=function(e){return this.appendElement("<colgroup>",e)},s.a.fn.appendCol=function(e){return this.appendElement("<col>",e)},s.a.fn.appendTr=function(e){return this.appendElement("<tr>",e)},s.a.fn.appendTd=function(e,t){return this.appendElement("<td>",e,t)},s.a.fn.appendTh=function(e,t){return this.appendElement("<th>",e,t)},s.a.fn.appendUl=function(e){return this.appendElement("<ul>",e)},s.a.fn.appendLi=function(e,t){return this.appendElement("<li>",e,t)},s.a.extend(s.a.easing,{easeOutQuart:function(e){return 1-Math.pow(1-e,4)}}),s.a.ajaxTransport("+binary",(function(e,t,n){if(window.FormData&&(e.dataType&&"binary"===e.dataType||e.data&&(window.ArrayBuffer&&e.data instanceof ArrayBuffer||window.Blob&&e.data instanceof Blob)))return{send:function(t,n){var i=new XMLHttpRequest,r=e.url,o=e.type,s=e.async||!0,a=e.responseType||"blob",u=e.data||null,l=e.username||null,c=e.password||null;for(var f in i.addEventListener("load",(function(){var t={};t[e.dataType]=i.response,n(i.status,i.statusText,t,i.getAllResponseHeaders())})),i.open(o,r,s,l,c),t)i.setRequestHeader(f,t[f]);if(e.xhrFields)for(var h in e.xhrFields)i[h]=e.xhrFields[h];i.responseType=a,i.send(u)},abort:function(){}}})),window.$!==s.a&&(window.$=s.a),s.a.extend(s.a.expr[":"],{focusable:function(e){return abe(e,!isNaN(s.a.attr(e,"tabindex")))},tabbable:function(e){var t=s.a.attr(e,"tabindex"),n=isNaN(t);return(n||t>=0)&&abe(e,!n)}}),n.d(t,"scout",(function(){return O})),n.d(t,"App",(function(){return x})),n.d(t,"ErrorHandler",(function(){return I})),n.d(t,"RemoteApp",(function(){return G})),n.d(t,"Extension",(function(){return K})),n.d(t,"TypeDescriptor",(function(){return Y})),n.d(t,"ObjectFactory",(function(){return Z})),n.d(t,"LoadingSupport",(function(){return te})),n.d(t,"SimpleLoadingSupport",(function(){return ue})),n.d(t,"ModelAdapter",(function(){return fe})),n.d(t,"Widget",(function(){return de})),n.d(t,"widgets",(function(){return ye})),n.d(t,"Composite",(function(){return Se})),n.d(t,"NullWidget",(function(){return Ee})),n.d(t,"NullWidgetAdapter",(function(){return Me})),n.d(t,"arrays",(function(){return et})),n.d(t,"Call",(function(){return nt})),n.d(t,"clipboard",(function(){return ot})),n.d(t,"EventDelegator",(function(){return at})),n.d(t,"dates",(function(){return wt})),n.d(t,"defaultValues",(function(){return Pt})),n.d(t,"events",(function(){return Ft})),n.d(t,"Device",(function(){return Mt})),n.d(t,"DoubleClickSupport",(function(){return Lt})),n.d(t,"DragAndDropHandler",(function(){return Nt})),n.d(t,"dragAndDrop",(function(){return Gt})),n.d(t,"Event",(function(){return Kt})),n.d(t,"EventSupport",(function(){return Yt})),n.d(t,"fonts",(function(){return nn})),n.d(t,"icons",(function(){return sn})),n.d(t,"inspector",(function(){return an})),n.d(t,"locales",(function(){return bn})),n.d(t,"logging",(function(){return Mn})),n.d(t,"NullLogger",(function(){return Ln})),n.d(t,"mimeTypes",(function(){return Bn})),n.d(t,"models",(function(){return Vn})),n.d(t,"numbers",(function(){return Gn})),n.d(t,"RoundingMode",(function(){return Un})),n.d(t,"objects",(function(){return oi})),n.d(t,"polyfills",(function(){return si})),n.d(t,"PromiseCreator",(function(){return ui})),n.d(t,"promises",(function(){return li})),n.d(t,"Range",(function(){return fi})),n.d(t,"Status",(function(){return pi})),n.d(t,"CachedElement",(function(){return vi})),n.d(t,"PlainTextEncoder",(function(){return gi})),n.d(t,"HtmlEncoder",(function(){return _i})),n.d(t,"strings",(function(){return En})),n.d(t,"styles",(function(){return $i})),n.d(t,"TreeSet",(function(){return Mi})),n.d(t,"URL",(function(){return Li})),n.d(t,"filters",(function(){return Bi})),n.d(t,"HAlign",(function(){return Ni})),n.d(t,"aggregation",(function(){return zi})),n.d(t,"webstorage",(function(){return Gi})),n.d(t,"cookies",(function(){return Ui})),n.d(t,"ajax",(function(){return Ji})),n.d(t,"AjaxCall",(function(){return or})),n.d(t,"AjaxError",(function(){return sr})),n.d(t,"LookupCall",(function(){return ur})),n.d(t,"LookupRow",(function(){return cr})),n.d(t,"RemoteLookupCall",(function(){return br})),n.d(t,"RemoteLookupRequest",(function(){return mr})),n.d(t,"QueryBy",(function(){return _r})),n.d(t,"StaticLookupCall",(function(){return Rr})),n.d(t,"HierarchicalLookupResultBuilder",(function(){return Er})),n.d(t,"Code",(function(){return Ar})),n.d(t,"CodeType",(function(){return jr})),n.d(t,"codes",(function(){return zr})),n.d(t,"CodeLookupCall",(function(){return Jr})),n.d(t,"BackgroundJobPollingStatus",(function(){return Zr})),n.d(t,"BackgroundJobPollingSupport",(function(){return eo})),n.d(t,"BusyIndicator",(function(){return uo})),n.d(t,"RemoteEvent",(function(){return lo})),n.d(t,"Locale",(function(){return fo})),n.d(t,"PropertyChangeEventFilter",(function(){return po})),n.d(t,"Reconnector",(function(){return vo})),n.d(t,"ResponseQueue",(function(){return go})),n.d(t,"Session",(function(){return wo})),n.d(t,"UserAgent",(function(){return ko})),n.d(t,"WidgetEventTypeFilter",(function(){return Oo})),n.d(t,"Dimension",(function(){return Co})),n.d(t,"Insets",(function(){return Ro})),n.d(t,"Point",(function(){return Eo})),n.d(t,"Rectangle",(function(){return Fo})),n.d(t,"graphics",(function(){return No})),n.d(t,"HtmlEnvironment",(function(){return Vo})),n.d(t,"AbstractLayout",(function(){return zo})),n.d(t,"HtmlComponent",(function(){return Uo})),n.d(t,"LayoutConstants",(function(){return Ko})),n.d(t,"LayoutValidator",(function(){return Yo})),n.d(t,"LogicalGrid",(function(){return Jo})),n.d(t,"LogicalGridConfig",(function(){return Qo})),n.d(t,"LogicalGridData",(function(){return ts})),n.d(t,"LogicalGridLayout",(function(){return ls})),n.d(t,"LogicalGridLayoutConfig",(function(){return fs})),n.d(t,"LogicalGridLayoutInfo",(function(){return ds})),n.d(t,"AbstractGrid",(function(){return _s})),n.d(t,"HorizontalGrid",(function(){return Ps})),n.d(t,"VerticalSmartGrid",(function(){return $s})),n.d(t,"LogicalGridMatrix",(function(){return Ms})),n.d(t,"LogicalGridMatrixCell",(function(){return Ls})),n.d(t,"LogicalGridMatrixCursor",(function(){return Hs})),n.d(t,"HorizontalGridMatrix",(function(){return qs})),n.d(t,"VerticalGridMatrix",(function(){return ta})),n.d(t,"ColumnLayout",(function(){return ua})),n.d(t,"NullLayout",(function(){return ya})),n.d(t,"RowLayout",(function(){return ka})),n.d(t,"SingleLayout",(function(){return xa})),n.d(t,"FlexboxLayout",(function(){return Ma})),n.d(t,"FlexboxLayoutData",(function(){return La})),n.d(t,"SimpleTabBoxController",(function(){return Na})),n.d(t,"SimpleTabBox",(function(){return qa})),n.d(t,"SimpleTabBoxLayout",(function(){return tu})),n.d(t,"SimpleTabViewContentLayout",(function(){return uu})),n.d(t,"keys",(function(){return pu})),n.d(t,"Key",(function(){return vu})),n.d(t,"keyStrokeModifier",(function(){return gu})),n.d(t,"VirtualKeyStrokeEvent",(function(){return _u})),n.d(t,"KeyStrokeManager",(function(){return ku})),n.d(t,"KeyStrokeContext",(function(){return Ou})),n.d(t,"InputFieldKeyStrokeContext",(function(){return Fu})),n.d(t,"KeyStroke",(function(){return $u})),n.d(t,"RangeKeyStroke",(function(){return Hu})),n.d(t,"ContextMenuKeyStroke",(function(){return Yu})),n.d(t,"ClickActiveElementKeyStroke",(function(){return il})),n.d(t,"FocusAdjacentElementKeyStroke",(function(){return cl})),n.d(t,"CloseKeyStroke",(function(){return bl})),n.d(t,"AbortKeyStroke",(function(){return Ol})),n.d(t,"TabItemKeyStroke",(function(){return Fl})),n.d(t,"Accordion",(function(){return Hl})),n.d(t,"AccordionAdapter",(function(){return Kl})),n.d(t,"BoxButtons",(function(){return Yl})),n.d(t,"Carousel",(function(){return ic})),n.d(t,"CarouselLayout",(function(){return cc})),n.d(t,"Cell",(function(){return hc})),n.d(t,"CollapseHandle",(function(){return _c})),n.d(t,"FocusManager",(function(){return kc})),n.d(t,"FocusContext",(function(){return Oc})),n.d(t,"focusUtils",(function(){return Cc})),n.d(t,"FocusRule",(function(){return Pc})),n.d(t,"GlassPane",(function(){return jc})),n.d(t,"DeferredGlassPaneTarget",(function(){return Ic})),n.d(t,"GlassPaneRenderer",(function(){return Bc})),n.d(t,"IFrame",(function(){return qc})),n.d(t,"Scrollbar",(function(){return rf})),n.d(t,"scrollbars",(function(){return wf})),n.d(t,"VirtualScrolling",(function(){return Sf})),n.d(t,"Splitter",(function(){return Ff})),n.d(t,"DateFormatPatternType",(function(){return Af})),n.d(t,"DateFormatPatternDefinition",(function(){return jf})),n.d(t,"DateFormat",(function(){return If})),n.d(t,"DecimalFormat",(function(){return Bf})),n.d(t,"TextMap",(function(){return Wf})),n.d(t,"texts",(function(){return th})),n.d(t,"Tooltip",(function(){return lh})),n.d(t,"TooltipSupport",(function(){return fh})),n.d(t,"tooltips",(function(){return dh})),n.d(t,"WidgetTooltip",(function(){return wh})),n.d(t,"Action",(function(){return Eh})),n.d(t,"ActionAdapter",(function(){return Lh})),n.d(t,"ActionKeyStroke",(function(){return Uh})),n.d(t,"Box",(function(){return qh})),n.d(t,"Label",(function(){return nd})),n.d(t,"LabelAdapter",(function(){return cd})),n.d(t,"Popup",(function(){return kd})),n.d(t,"PopupAdapter",(function(){return Ed})),n.d(t,"PopupLayout",(function(){return Id})),n.d(t,"PopupManager",(function(){return Gd})),n.d(t,"PopupManagerAdapter",(function(){return Jd})),n.d(t,"PopupWithHead",(function(){return op})),n.d(t,"PopupWithHeadLayout",(function(){return dp})),n.d(t,"MobilePopup",(function(){return wp})),n.d(t,"MobilePopupLayout",(function(){return xp})),n.d(t,"TouchPopup",(function(){return Lp})),n.d(t,"TouchPopupLayout",(function(){return Up})),n.d(t,"WidgetPopup",(function(){return ty})),n.d(t,"WidgetPopupAdapter",(function(){return ay})),n.d(t,"WidgetPopupLayout",(function(){return yy})),n.d(t,"DatePicker",(function(){return Sy})),n.d(t,"DatePickerPopup",(function(){return Dy})),n.d(t,"DatePickerPopupLayout",(function(){return By})),n.d(t,"DatePickerTouchPopup",(function(){return Ky})),n.d(t,"DatePickerTouchPopupLayout",(function(){return ev})),n.d(t,"Group",(function(){return uv})),n.d(t,"GroupAdapter",(function(){return pv})),n.d(t,"GroupLayout",(function(){return wv})),n.d(t,"GroupToggleCollapseKeyStroke",(function(){return Rv})),n.d(t,"Icon",(function(){return Mv})),n.d(t,"IconDesc",(function(){return Bv})),n.d(t,"Image",(function(){return Kv})),n.d(t,"ImageLayout",(function(){return tb})),n.d(t,"Notification",(function(){return lb})),n.d(t,"NotificationAdapter",(function(){return yb})),n.d(t,"menus",(function(){return mb})),n.d(t,"MenuDestinations",(function(){return _b})),n.d(t,"Menu",(function(){return xb})),n.d(t,"EllipsisMenu",(function(){return Ib})),n.d(t,"MenuAdapter",(function(){return Wb})),n.d(t,"MenuKeyStroke",(function(){return Jb})),n.d(t,"MenuExecKeyStroke",(function(){return og})),n.d(t,"MenuItemsOrder",(function(){return ag})),n.d(t,"ComboMenu",(function(){return pg})),n.d(t,"ComboMenuAdapter",(function(){return _g})),n.d(t,"ContextMenuPopup",(function(){return Rg})),n.d(t,"ContextMenuPopupLayout",(function(){return Mg})),n.d(t,"MenuNavigationKeyStroke",(function(){return zg})),n.d(t,"MenuNavigationExecKeyStroke",(function(){return Jg})),n.d(t,"MenuExecByNumberKeyStroke",(function(){return om})),n.d(t,"MenuNavigationDownKeyStroke",(function(){return hm})),n.d(t,"MenuNavigationUpKeyStroke",(function(){return mm})),n.d(t,"SubCloseKeyStroke",(function(){return Pm})),n.d(t,"menuNavigationKeyStrokes",(function(){return Rm})),n.d(t,"ButtonAdapterMenu",(function(){return Im})),n.d(t,"FormFieldMenu",(function(){return Gm})),n.d(t,"FormFieldMenuAdapter",(function(){return Qm})),n.d(t,"MenuBox",(function(){return a_})),n.d(t,"MenuBoxLayout",(function(){return p_})),n.d(t,"MenuBar",(function(){return O_})),n.d(t,"MenuBarLayout",(function(){return D_})),n.d(t,"MenuBarLeftKeyStroke",(function(){return L_})),n.d(t,"MenuBarRightKeyStroke",(function(){return G_})),n.d(t,"MenuBarPopup",(function(){return ew})),n.d(t,"MenubarBox",(function(){return lw})),n.d(t,"MenubarBoxLayout",(function(){return vw})),n.d(t,"Calendar",(function(){return Tw})),n.d(t,"CalendarAdapter",(function(){return Aw})),n.d(t,"CalendarComponent",(function(){return Hw})),n.d(t,"CalendarComponentAdapter",(function(){return Kw})),n.d(t,"CalendarListComponent",(function(){return Yw})),n.d(t,"CalendarLayout",(function(){return nk})),n.d(t,"CalendarModeMenu",(function(){return lk})),n.d(t,"CalendarModesMenu",(function(){return bk})),n.d(t,"DateRange",(function(){return mk})),n.d(t,"YearPanel",(function(){return Pk})),n.d(t,"Lifecycle",(function(){return xk})),n.d(t,"Planner",(function(){return Lk})),n.d(t,"PlannerAdapter",(function(){return Uk})),n.d(t,"PlannerHeader",(function(){return Qk})),n.d(t,"PlannerLayout",(function(){return sS})),n.d(t,"PlannerMenuItemsOrder",(function(){return hS})),n.d(t,"FileChooser",(function(){return _S})),n.d(t,"FileChooserAdapter",(function(){return RS})),n.d(t,"FileChooserController",(function(){return ES})),n.d(t,"FileInput",(function(){return LS})),n.d(t,"Route",(function(){return NS})),n.d(t,"router",(function(){return US})),n.d(t,"Slider",(function(){return eO})),n.d(t,"SliderAdapter",(function(){return sO})),n.d(t,"SliderLayout",(function(){return dO})),n.d(t,"Mode",(function(){return wO})),n.d(t,"ModeAdapter",(function(){return PO})),n.d(t,"ModeSelector",(function(){return MO})),n.d(t,"ModeSelectorLayout",(function(){return zO})),n.d(t,"Form",(function(){return ZO})),n.d(t,"FormAdapter",(function(){return sT})),n.d(t,"FormGrid",(function(){return dT})),n.d(t,"FormLayout",(function(){return _T})),n.d(t,"FormMenuActionKeyStroke",(function(){return PT})),n.d(t,"FormMenu",(function(){return jT})),n.d(t,"FormMenuAdapter",(function(){return HT})),n.d(t,"FormMenuPopup",(function(){return XT})),n.d(t,"FormMenuPopupLayout",(function(){return rC})),n.d(t,"FormLifecycle",(function(){return hC})),n.d(t,"CancelMenu",(function(){return _C})),n.d(t,"CloseMenu",(function(){return RC})),n.d(t,"OkMenu",(function(){return MC})),n.d(t,"ResetMenu",(function(){return zC})),n.d(t,"SaveMenu",(function(){return ZC})),n.d(t,"DialogLayout",(function(){return aP})),n.d(t,"ResponsiveManager",(function(){return lP})),n.d(t,"ResponsiveHandler",(function(){return fP})),n.d(t,"GroupBoxResponsiveHandler",(function(){return _P})),n.d(t,"DesktopResponsiveHandler",(function(){return RP})),n.d(t,"TileOverviewForm",(function(){return MP})),n.d(t,"TileOverviewFormAdapter",(function(){return VP})),n.d(t,"Table",(function(){return ZP})),n.d(t,"TableAdapter",(function(){return sR})),n.d(t,"TableRow",(function(){return uR})),n.d(t,"TableMatrix",(function(){return fR})),n.d(t,"TableFooter",(function(){return _R})),n.d(t,"TableFooterLayout",(function(){return PR})),n.d(t,"TableInfoFilterTooltip",(function(){return jR})),n.d(t,"TableInfoLoadTooltip",(function(){return WR})),n.d(t,"TableInfoSelectionTooltip",(function(){return JR})),n.d(t,"TableHeader",(function(){return sx})),n.d(t,"TableHeaderMenu",(function(){return vx})),n.d(t,"TableHeaderMenuLayout",(function(){return Ox})),n.d(t,"TableHeaderMenuGroup",(function(){return Fx})),n.d(t,"TableHeaderMenuButton",(function(){return Nx})),n.d(t,"TableHeaderMenuButtonKeyStroke",(function(){return Kx})),n.d(t,"TableLayout",(function(){return tE})),n.d(t,"TableSelectionHandler",(function(){return iE})),n.d(t,"TableTileGridMediator",(function(){return hE})),n.d(t,"TableTileGridMediatorAdapter",(function(){return mE})),n.d(t,"TableRowDetail",(function(){return RE})),n.d(t,"TableRowTileMapping",(function(){return $E})),n.d(t,"TableRowTileMappingAdapter",(function(){return NE})),n.d(t,"TableTooltip",(function(){return qE})),n.d(t,"TableUpdateBuffer",(function(){return XE})),n.d(t,"TileTableHeaderGroupByLookupCall",(function(){return rD})),n.d(t,"TileTableHeaderSortByLookupCall",(function(){return hD})),n.d(t,"comparators",(function(){return yD})),n.d(t,"Column",(function(){return gD})),n.d(t,"ColumnOptimalWidthMeasurer",(function(){return _D})),n.d(t,"AlphanumericSortingStringColumn",(function(){return CD})),n.d(t,"BeanColumn",(function(){return $D})),n.d(t,"BooleanColumn",(function(){return VD})),n.d(t,"DateColumn",(function(){return XD})),n.d(t,"IconColumn",(function(){return rF})),n.d(t,"NumberColumn",(function(){return hF})),n.d(t,"SmartColumn",(function(){return _F})),n.d(t,"TableControlActionKeyStroke",(function(){return PF})),n.d(t,"TableControl",(function(){return MF})),n.d(t,"TableControlAdapter",(function(){return WF})),n.d(t,"TableControlAdapterMenu",(function(){return ZF})),n.d(t,"AggregateTableControl",(function(){return aA})),n.d(t,"AggregateTableControlAdapter",(function(){return pA})),n.d(t,"FormTableControl",(function(){return SA})),n.d(t,"FormTableControlAdapter",(function(){return xA})),n.d(t,"FormTableControlLayout",(function(){return MA})),n.d(t,"CellEditorPopup",(function(){return GA})),n.d(t,"CellEditorPopupLayout",(function(){return ZA})),n.d(t,"CellEditorCancelEditKeyStroke",(function(){return o$})),n.d(t,"CellEditorCompleteEditKeyStroke",(function(){return h$})),n.d(t,"CellEditorTabKeyStroke",(function(){return _$})),n.d(t,"AbstractTableNavigationKeyStroke",(function(){return R$})),n.d(t,"TableControlCloseKeyStroke",(function(){return j$})),n.d(t,"TableCopyKeyStroke",(function(){return V$})),n.d(t,"TableNavigationCollapseKeyStroke",(function(){return J$})),n.d(t,"TableNavigationExpandKeyStroke",(function(){return sj})),n.d(t,"TableSelectAllKeyStroke",(function(){return pj})),n.d(t,"TableStartCellEditKeyStroke",(function(){return Sj})),n.d(t,"TableRefreshKeyStroke",(function(){return Fj})),n.d(t,"TableToggleRowKeyStroke",(function(){return Nj})),n.d(t,"TableNavigationUpKeyStroke",(function(){return qj})),n.d(t,"TableNavigationDownKeyStroke",(function(){return nM})),n.d(t,"TableNavigationHomeKeyStroke",(function(){return cM})),n.d(t,"TableNavigationEndKeyStroke",(function(){return gM})),n.d(t,"TableNavigationPageUpKeyStroke",(function(){return CM})),n.d(t,"TableNavigationPageDownKeyStroke",(function(){return $M})),n.d(t,"TableFocusFilterFieldKeyStroke",(function(){return HM})),n.d(t,"TableFilter",(function(){return WM})),n.d(t,"TableUserFilter",(function(){return XM})),n.d(t,"ColumnUserFilter",(function(){return rI})),n.d(t,"DateColumnUserFilter",(function(){return hI})),n.d(t,"NumberColumnUserFilter",(function(){return _I})),n.d(t,"TextColumnUserFilter",(function(){return RI})),n.d(t,"TableTextUserFilter",(function(){return MI})),n.d(t,"TileTableHierarchyFilter",(function(){return zI})),n.d(t,"TimePicker",(function(){return ZI})),n.d(t,"TimePickerPopup",(function(){return sL})),n.d(t,"TimePickerPopupLayout",(function(){return pL})),n.d(t,"TimePickerTouchPopup",(function(){return kL})),n.d(t,"TimePickerTouchPopupLayout",(function(){return EL})),n.d(t,"Tree",(function(){return NL})),n.d(t,"TreeAdapter",(function(){return qL})),n.d(t,"TreeNode",(function(){return XL})),n.d(t,"TreeLayout",(function(){return iB})),n.d(t,"LazyNodeFilter",(function(){return oB})),n.d(t,"TreeBreadcrumbFilter",(function(){return aB})),n.d(t,"AbstractTreeNavigationKeyStroke",(function(){return yB})),n.d(t,"TreeSpaceKeyStroke",(function(){return SB})),n.d(t,"TreeNavigationUpKeyStroke",(function(){return DB})),n.d(t,"TreeNavigationDownKeyStroke",(function(){return BB})),n.d(t,"TreeNavigationEndKeyStroke",(function(){return KB})),n.d(t,"TreeCollapseAllKeyStroke",(function(){return tN})),n.d(t,"TreeCollapseOrDrillUpKeyStroke",(function(){return lN})),n.d(t,"TreeExpandOrDrillDownKeyStroke",(function(){return gN})),n.d(t,"CompactTree",(function(){return CN})),n.d(t,"CompactTreeNode",(function(){return AN})),n.d(t,"AbstractCompactTreeControlKeyStroke",(function(){return HN})),n.d(t,"CompactTreeUpKeyStroke",(function(){return qN})),n.d(t,"CompactTreeDownKeyStroke",(function(){return tH})),n.d(t,"CompactTreeLeftKeyStroke",(function(){return uH})),n.d(t,"CompactTreeRightKeyStroke",(function(){return yH})),n.d(t,"fields",(function(){return gH})),n.d(t,"AppLinkKeyStroke",(function(){return CH})),n.d(t,"FieldStatus",(function(){return jH})),n.d(t,"FormField",(function(){return GH})),n.d(t,"FormFieldAdapter",(function(){return ZH})),n.d(t,"FormFieldLayout",(function(){return sV})),n.d(t,"StatusMenuMapping",(function(){return pV})),n.d(t,"StatusMenuMappingAdapter",(function(){return _V})),n.d(t,"GridData",(function(){return kV})),n.d(t,"CompositeField",(function(){return EV})),n.d(t,"CompositeFieldAdapter",(function(){return MV})),n.d(t,"ValueField",(function(){return GV})),n.d(t,"ValueFieldAdapter",(function(){return QV})),n.d(t,"BasicField",(function(){return aW})),n.d(t,"BasicFieldAdapter",(function(){return dW})),n.d(t,"WidgetField",(function(){return wW})),n.d(t,"WidgetFieldAdapter",(function(){return PW})),n.d(t,"WidgetFieldLayout",(function(){return jW})),n.d(t,"LookupBox",(function(){return WW})),n.d(t,"LookupBoxLayout",(function(){return XW})),n.d(t,"TreeVisitResult",(function(){return JW})),n.d(t,"FormController",(function(){return QW})),n.d(t,"MessageBox",(function(){return az})),n.d(t,"MessageBoxAdapter",(function(){return yz})),n.d(t,"MessageBoxController",(function(){return bz})),n.d(t,"MessageBoxes",(function(){return mz})),n.d(t,"MessageBoxLayout",(function(){return Cz})),n.d(t,"CopyKeyStroke",(function(){return Az})),n.d(t,"AccordionField",(function(){return Hz})),n.d(t,"AccordionFieldAdapter",(function(){return Kz})),n.d(t,"BeanField",(function(){return tG})),n.d(t,"BeanFieldAdapter",(function(){return lG})),n.d(t,"BrowserField",(function(){return bG})),n.d(t,"BrowserFieldAdapter",(function(){return TG})),n.d(t,"BrowserFieldLayout",(function(){return AG})),n.d(t,"Button",(function(){return WG})),n.d(t,"ButtonLayout",(function(){return JG})),n.d(t,"ButtonAdapter",(function(){return oU})),n.d(t,"ButtonKeyStroke",(function(){return pU})),n.d(t,"CalendarField",(function(){return wU})),n.d(t,"CalendarFieldAdapter",(function(){return PU})),n.d(t,"CarouselField",(function(){return $U})),n.d(t,"CheckBoxField",(function(){return WU})),n.d(t,"CheckBoxFieldAdapter",(function(){return YU})),n.d(t,"CheckBoxToggleKeyStroke",(function(){return iK})),n.d(t,"ClipboardField",(function(){return hK})),n.d(t,"ClipboardFieldAdapter",(function(){return gK})),n.d(t,"ColorField",(function(){return TK})),n.d(t,"ColorFieldAdapter",(function(){return DK})),n.d(t,"DateField",(function(){return BK})),n.d(t,"DateFieldAdapter",(function(){return KK})),n.d(t,"DateTimeCompositeLayout",(function(){return tq})),n.d(t,"FileChooserButton",(function(){return lq})),n.d(t,"FileChooserButtonAdapter",(function(){return bq})),n.d(t,"FileChooserField",(function(){return Tq})),n.d(t,"FileChooserFieldAdapter",(function(){return Aq})),n.d(t,"FileChooserFieldBrowseKeyStroke",(function(){return Hq})),n.d(t,"FileChooserFieldDeleteKeyStroke",(function(){return Yq})),n.d(t,"GroupBox",(function(){return rY})),n.d(t,"GroupBoxGridConfig",(function(){return fY})),n.d(t,"GroupBoxAdapter",(function(){return mY})),n.d(t,"GroupBoxLayout",(function(){return PY})),n.d(t,"GroupBoxMenuItemsOrder",(function(){return xY})),n.d(t,"HtmlField",(function(){return IY})),n.d(t,"HtmlFieldAdapter",(function(){return GY})),n.d(t,"ImageField",(function(){return QY})),n.d(t,"ImageFieldAdapter",(function(){return aX})),n.d(t,"ImageFieldLayout",(function(){return yX})),n.d(t,"LabelField",(function(){return SX})),n.d(t,"LabelFieldAdapter",(function(){return DX})),n.d(t,"ListBox",(function(){return BX})),n.d(t,"ListBoxAdapter",(function(){return GX})),n.d(t,"ListBoxLayout",(function(){return JX})),n.d(t,"lookupField",(function(){return QX})),n.d(t,"LookupFieldAdapter",(function(){return sJ})),n.d(t,"ModeSelectorField",(function(){return pJ})),n.d(t,"ModeSelectorFieldAdapter",(function(){return kJ})),n.d(t,"NumberField",(function(){return EJ})),n.d(t,"NumberFieldAdapter",(function(){return LJ})),n.d(t,"Calculator",(function(){return NJ})),n.d(t,"IntegerField",(function(){return YJ})),n.d(t,"PlaceholderField",(function(){return nZ})),n.d(t,"PlaceholderFieldAdapter",(function(){return uZ})),n.d(t,"PlannerField",(function(){return yZ})),n.d(t,"PlannerFieldAdapter",(function(){return wZ})),n.d(t,"RadioButton",(function(){return EZ})),n.d(t,"RadioButtonLayout",(function(){return LZ})),n.d(t,"RadioButtonAdapter",(function(){return zZ})),n.d(t,"RadioButtonGroup",(function(){return eQ})),n.d(t,"RadioButtonGroupAdapter",(function(){return uQ})),n.d(t,"RadioButtonGroupGridConfig",(function(){return yQ})),n.d(t,"RadioButtonGroupLayout",(function(){return SQ})),n.d(t,"RadioButtonGroupLeftKeyStroke",(function(){return EQ})),n.d(t,"RadioButtonGroupRightKeyStroke",(function(){return IQ})),n.d(t,"RadioButtonKeyStroke",(function(){return GQ})),n.d(t,"SequenceBox",(function(){return QQ})),n.d(t,"SequenceBoxGridConfig",(function(){return s0})),n.d(t,"SequenceBoxLayout",(function(){return p0})),n.d(t,"SequenceBoxAdapter",(function(){return k0})),n.d(t,"SliderField",(function(){return E0})),n.d(t,"SmartField",(function(){return B0})),n.d(t,"SmartFieldAdapter",(function(){return K0})),n.d(t,"SmartFieldLayout",(function(){return t1})),n.d(t,"SmartFieldCancelKeyStroke",(function(){return c1})),n.d(t,"SmartFieldPopup",(function(){return g1})),n.d(t,"SmartFieldTouchPopup",(function(){return C1})),n.d(t,"SmartFieldPopupLayout",(function(){return $1})),n.d(t,"SmartFieldMultiline",(function(){return V1})),n.d(t,"SmartFieldMultilineAdapter",(function(){return q1})),n.d(t,"SmartFieldMultilineLayout",(function(){return n2})),n.d(t,"ProposalField",(function(){return c2})),n.d(t,"ProposalFieldAdapter",(function(){return v2})),n.d(t,"ProposalTreeNode",(function(){return O2})),n.d(t,"ProposalChooser",(function(){return F2})),n.d(t,"ProposalChooserLayout",(function(){return B2})),n.d(t,"TableProposalChooser",(function(){return U2})),n.d(t,"TableLayoutResetter",(function(){return q2})),n.d(t,"TreeProposalChooser",(function(){return t3})),n.d(t,"TreeLayoutResetter",(function(){return i3})),n.d(t,"SplitBox",(function(){return h3})),n.d(t,"SplitBoxAdapter",(function(){return _3})),n.d(t,"SplitBoxCollapseKeyStroke",(function(){return P3})),n.d(t,"SplitBoxFirstCollapseKeyStroke",(function(){return $3})),n.d(t,"SplitBoxSecondCollapseKeyStroke",(function(){return H3})),n.d(t,"SplitBoxLayout",(function(){return q3})),n.d(t,"StringField",(function(){return r5})),n.d(t,"StringFieldLayout",(function(){return h5})),n.d(t,"StringFieldAdapter",(function(){return _5})),n.d(t,"StringFieldEnterKeyStroke",(function(){return R5})),n.d(t,"StringFieldCtrlEnterKeyStroke",(function(){return M5})),n.d(t,"TabBox",(function(){return G5})),n.d(t,"TabAreaLeftKeyStroke",(function(){return Z5})),n.d(t,"TabAreaRightKeyStroke",(function(){return o4})),n.d(t,"TabBoxAdapter",(function(){return d4})),n.d(t,"TabBoxHeaderLayout",(function(){return w4})),n.d(t,"TabBoxHeader",(function(){return E4})),n.d(t,"Tab",(function(){return B4})),n.d(t,"TabArea",(function(){return q4})),n.d(t,"TabAreaLayout",(function(){return n6})),n.d(t,"TabBoxLayout",(function(){return c6})),n.d(t,"TabItem",(function(){return g6})),n.d(t,"TabItemAdapter",(function(){return O6})),n.d(t,"TabItemLayout",(function(){return D6})),n.d(t,"TableField",(function(){return N6})),n.d(t,"TableFieldAdapter",(function(){return U6})),n.d(t,"TagChooserPopup",(function(){return e9})),n.d(t,"TagChooserPopupLayout",(function(){return u9})),n.d(t,"TagField",(function(){return v9})),n.d(t,"TagFieldAdapter",(function(){return O9})),n.d(t,"TagFieldCancelKeyStroke",(function(){return A9})),n.d(t,"TagFieldEnterKeyStroke",(function(){return H9})),n.d(t,"TagFieldDeleteKeyStroke",(function(){return Y9})),n.d(t,"TagFieldNavigationKeyStroke",(function(){return i7})),n.d(t,"TagFieldOpenPopupKeyStroke",(function(){return f7})),n.d(t,"TagFieldLayout",(function(){return g7})),n.d(t,"TagFieldContainerLayout",(function(){return T7})),n.d(t,"TileField",(function(){return A7})),n.d(t,"TileFieldAdapter",(function(){return B7})),n.d(t,"TreeBox",(function(){return K7})),n.d(t,"TreeBoxAdapter",(function(){return Q7})),n.d(t,"TreeBoxLayout",(function(){return o8})),n.d(t,"TreeField",(function(){return h8})),n.d(t,"TreeFieldAdapter",(function(){return g8})),n.d(t,"WizardProgressField",(function(){return C8})),n.d(t,"WizardProgressFieldAdapter",(function(){return $8})),n.d(t,"WizardProgressFieldLayout",(function(){return V8})),n.d(t,"WrappedFormField",(function(){return J8})),n.d(t,"WrappedFormFieldAdapter",(function(){return iee})),n.d(t,"Switch",(function(){return fee})),n.d(t,"TagBar",(function(){return mee})),n.d(t,"TagBarLayout",(function(){return Cee})),n.d(t,"TagBarOverflowPopup",(function(){return $ee})),n.d(t,"Tile",(function(){return Wee})),n.d(t,"TileAdapter",(function(){return Yee})),n.d(t,"TileGrid",(function(){return rte})),n.d(t,"TileGridAdapter",(function(){return hte})),n.d(t,"TileGridGridConfig",(function(){return mte})),n.d(t,"TileGridLayout",(function(){return Pte})),n.d(t,"TileGridLayoutConfig",(function(){return jte})),n.d(t,"TileGridSelectionHandler",(function(){return Ite})),n.d(t,"TileOverviewLayout",(function(){return zte})),n.d(t,"HtmlTile",(function(){return Zte})),n.d(t,"HtmlTileAdapter",(function(){return rne})),n.d(t,"BeanTile",(function(){return hne})),n.d(t,"BeanTileAdapter",(function(){return _ne})),n.d(t,"TileAccordion",(function(){return xne})),n.d(t,"TileAccordionAdapter",(function(){return Ine})),n.d(t,"TileAccordionSelectionHandler",(function(){return zne})),n.d(t,"TileGridSelectKeyStroke",(function(){return Qne})),n.d(t,"TileGridSelectAllKeyStroke",(function(){return uie})),n.d(t,"TileGridSelectLeftKeyStroke",(function(){return vie})),n.d(t,"TileGridSelectRightKeyStroke",(function(){return Oie})),n.d(t,"TileGridSelectDownKeyStroke",(function(){return Fie})),n.d(t,"TileGridSelectUpKeyStroke",(function(){return Nie})),n.d(t,"TileGridSelectFirstKeyStroke",(function(){return qie})),n.d(t,"TileGridSelectLastKeyStroke",(function(){return nre})),n.d(t,"RemoteTileFilter",(function(){return rre})),n.d(t,"WidgetTile",(function(){return dre})),n.d(t,"WidgetTileAdapter",(function(){return mre})),n.d(t,"PlaceholderTile",(function(){return Pre})),n.d(t,"FormFieldTile",(function(){return jre})),n.d(t,"FormFieldTileAdapter",(function(){return Hre})),n.d(t,"TileButton",(function(){return Yre})),n.d(t,"TileTableField",(function(){return roe})),n.d(t,"Desktop",(function(){return poe})),n.d(t,"DesktopAdapter",(function(){return koe})),n.d(t,"DesktopLogo",(function(){return Doe})),n.d(t,"DesktopLayout",(function(){return Loe})),n.d(t,"DesktopTabBoxController",(function(){return Goe})),n.d(t,"DisableBrowserF5ReloadKeyStroke",(function(){return Zoe})),n.d(t,"PopupWindow",(function(){return ese})),n.d(t,"OpenUriHandler",(function(){return nse})),n.d(t,"DesktopBench",(function(){return hse})),n.d(t,"BenchColumn",(function(){return kse})),n.d(t,"BenchRowLayoutData",(function(){return Ese})),n.d(t,"BenchColumnLayoutData",(function(){return Fse})),n.d(t,"DesktopTabSelectKeyStroke",(function(){return Hse})),n.d(t,"DisableBrowserTabSwitchingKeyStroke",(function(){return Yse})),n.d(t,"DesktopHeader",(function(){return rae})),n.d(t,"HeaderTabBoxController",(function(){return dae})),n.d(t,"DesktopHeaderLayout",(function(){return _ae})),n.d(t,"DesktopNavigation",(function(){return Eae})),n.d(t,"DesktopNavigationHandle",(function(){return Lae})),n.d(t,"DesktopNavigationLayout",(function(){return Gae})),n.d(t,"ShrinkNavigationKeyStroke",(function(){return eue})),n.d(t,"EnlargeNavigationKeyStroke",(function(){return lue})),n.d(t,"DesktopNotification",(function(){return bue})),n.d(t,"DesktopNotificationAdapter",(function(){return Tue})),n.d(t,"OfflineDesktopNotification",(function(){return Aue})),n.d(t,"PopupBlockerHandler",(function(){return jue})),n.d(t,"PopupBlockerDesktopNotification",(function(){return Wue})),n.d(t,"DesktopToolBox",(function(){return Jue})),n.d(t,"ViewButtonActionKeyStroke",(function(){return ole})),n.d(t,"ViewButton",(function(){return dle})),n.d(t,"ViewButtonAdapter",(function(){return mle})),n.d(t,"ViewButtonBox",(function(){return Rle})),n.d(t,"ViewButtonBoxLayout",(function(){return jle})),n.d(t,"ViewMenuOpenKeyStroke",(function(){return Wle})),n.d(t,"ViewMenuPopup",(function(){return Zle})),n.d(t,"ViewMenuPopupLayout",(function(){return sce})),n.d(t,"ViewMenuTab",(function(){return pce})),n.d(t,"Page",(function(){return kce})),n.d(t,"PageWithNodes",(function(){return xce})),n.d(t,"PageWithTable",(function(){return Ice})),n.d(t,"PageTileButton",(function(){return Gce})),n.d(t,"PageTileGrid",(function(){return efe})),n.d(t,"PageTileGridSelectKeyStroke",(function(){return lfe})),n.d(t,"AutoLeafPageWithNodes",(function(){return bfe})),n.d(t,"SimpleTab",(function(){return Cfe})),n.d(t,"DesktopTab",(function(){return $fe})),n.d(t,"SimpleTabArea",(function(){return Vfe})),n.d(t,"SimpleTabAreaLayout",(function(){return Xfe})),n.d(t,"DetailTableTreeFilter",(function(){return Zfe})),n.d(t,"Outline",(function(){return ahe})),n.d(t,"OutlineAdapter",(function(){return vhe})),n.d(t,"OutlineMediator",(function(){return ghe})),n.d(t,"OutlineLayout",(function(){return Che})),n.d(t,"OutlineViewButton",(function(){return $he})),n.d(t,"OutlineViewButtonAdapter",(function(){return Hhe})),n.d(t,"OutlineTileField",(function(){return qhe})),n.d(t,"OutlineTileFieldAdapter",(function(){return ede})),n.d(t,"PageLayout",(function(){return ade})),n.d(t,"SearchOutline",(function(){return yde})),n.d(t,"SearchOutlineAdapter",(function(){return Sde})),n.d(t,"SearchOutlineLayout",(function(){return Dde})),n.d(t,"NavigateButton",(function(){return Bde})),n.d(t,"NavigateDownButton",(function(){return qde})),n.d(t,"NavigateUpButton",(function(){return npe})),n.d(t,"OutlineKeyStrokeContext",(function(){return cpe})),n.d(t,"OutlineNavigateToTopKeyStroke",(function(){return gpe})),n.d(t,"OutlineOverview",(function(){return Cpe})),n.d(t,"TileOutlineOverview",(function(){return $pe})),n.d(t,"DesktopFormController",(function(){return Wpe})),n.d(t,"FilterFieldsGroupBox",(function(){return Jpe})),n.d(t,"Resizable",(function(){return eye})),n.d(t,"UnsavedFormChangesForm",(function(){return uye})),n.d(t,"UnsavedFormsLookupCall",(function(){return yye})),n.d(t,"TileTableHeaderBox",(function(){return Oye})),n.d(t,"LoginApp",(function(){return Dye})),n.d(t,"LoginBox",(function(){return Nye})),n.d(t,"LogoutApp",(function(){return Kye})),n.d(t,"LogoutBox",(function(){return tve})),n.d(t,"BreadcrumbItem",(function(){return lve})),n.d(t,"BreadcrumbItemAdapter",(function(){return yve})),n.d(t,"BreadcrumbBar",(function(){return Sve})),n.d(t,"BreadcrumbBarLayout",(function(){return Fve})),n.d(t,"BreadcrumbBarAdapter",(function(){return Lve})),n.d(t,"BreadcrumbBarField",(function(){return Gve})),n.d(t,"BreadcrumbBarFieldAdapter",(function(){return Jve}));var fbe=t.default=r,hbe=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lbe(Object(n),!0).forEach((function(t){cbe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lbe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r,{},i);window.scout=ube(window.scout||{},hbe)}])}));
//# sourceMappingURL=eclipse-scout-core-a6cc455544c1c6f3cee3.min.js.map